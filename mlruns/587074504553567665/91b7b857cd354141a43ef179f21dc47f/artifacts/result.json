{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8207015846235056, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.982256418466568, "policy_loss": -0.006848533715916953, "vf_loss": 9.987161303559938, "vf_explained_var": -0.00010825544595718383, "kl": 0.00971840274257166, "entropy": 1.5996874200801054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7006512790760666, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987930464870715, "policy_loss": -0.007047713223583602, "vf_loss": 9.99338785454079, "vf_explained_var": -9.595054798025303e-06, "kl": 0.00795155301096216, "entropy": 1.6014526120569341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -133.31088454824436, "episode_reward_min": -9317.555949266416, "episode_reward_mean": -6072.694918872432, "episode_len_mean": 183.6315789473684, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3489, "policy_reward_min": {"agent_policy": 12.864047280725583, "adversary_policy": -9317.555949266416}, "policy_reward_max": {"agent_policy": 8170.440815931349, "adversary_policy": -12.864047280725583}, "policy_reward_mean": {"agent_policy": 3273.3152317226773, "adversary_policy": -4673.005075297555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7089.023994392326, -4311.6869429648, -8148.25254014192, -7477.095300803994, -6360.082852303557, -9317.555949266416, -9156.987884236263, -3184.0952933207645, -7275.863446479523, -4806.411900424186, -7811.6901579494925, -6439.6961680732575, -4740.588664850282, -9137.778924635693, -4257.812921048579, -3812.001925297063, -6137.7336121461185, -5783.534095693735, -133.31088454824436], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 6], "policy_agent_policy_reward": [3669.9625766311137, 3623.9344539914596, 1684.7533007579295, 1797.2775799208925, 1772.4319881660401, 2509.0656935790835, 6049.954973951053, 2060.3907345863745, 4844.097609263973, 2433.7405079928085, 6670.594241879644, 2684.912467555396, 2128.050748685148, 8170.440815931349, 321.67038789499725, 2873.6188421488732, 4967.060624347934, 3918.1678081660757, 12.864047280725583], "policy_adversary_policy_reward": [-7089.023994392324, -3669.9625766311137, -4082.188553742054, -3853.4328432142056, -1684.7533007579295, -8148.25254014192, -7477.095300803994, -1797.2775799208925, -6360.082852303555, -1772.4319881660401, -9317.555949266416, -2509.0656935790835, -6049.954973951053, -9156.987884236263, -3176.4625440182735, -2068.023483888866, -7275.863446479525, -4844.097609263973, -4806.411900424187, -2433.7405079928085, -6777.054039488983, -7705.230360340154, -6439.6961680732575, -2684.912467555396, -4717.630037291588, -2151.009376243843, -8270.533620645085, -9037.686119921955, -321.67038789499725, -4257.812921048579, -3083.363381852763, -3602.257385593173, -5495.825921429628, -5608.968315064421, -4554.008838447558, -5147.69306541225, -133.31088454824433, -12.864047280725583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4096433053436973, "mean_inference_ms": 1.0126719846418768, "mean_action_processing_ms": 0.17339785462771626, "mean_env_wait_ms": 0.055026928139727815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004974791878148129, "StateBufferConnector_ms": 0.002849729437577097, "ViewRequirementAgentConnector_ms": 0.0717137989244963}, "num_episodes": 19, "episode_return_max": -133.31088454824436, "episode_return_min": -9317.555949266416, "episode_return_mean": -6072.694918872432}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.27455438229083, "num_env_steps_trained_throughput_per_sec": 497.27455438229083, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8043.853, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8043.81, "sample_time_ms": 762.721, "learn_time_ms": 7270.181, "learn_throughput": 550.193, "synch_weights_time_ms": 10.245}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "3439d_00000", "date": "2024-08-09_15-26-14", "timestamp": 1723231574, "time_this_iter_s": 8.053221940994263, "time_total_s": 8.053221940994263, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3279bedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8.053221940994263, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.475, "ram_util_percent": 82.20833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7370505074039102, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995727431774139, "policy_loss": -0.00727809559951614, "vf_loss": 10.0, "vf_explained_var": -2.4067113796869912e-05, "kl": 0.01502759030360418, "entropy": 1.5888078302145003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6823184799738031, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998270828509456, "policy_loss": -0.00443919537682579, "vf_loss": 10.0, "vf_explained_var": -4.142311515000762e-05, "kl": 0.013550177793802014, "entropy": 1.5954624568343794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -133.31088454824436, "episode_reward_min": -9317.555949266416, "episode_reward_mean": -6491.073786822703, "episode_len_mean": 191.81578947368422, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 7289, "policy_reward_min": {"agent_policy": 12.864047280725583, "adversary_policy": -9317.555949266416}, "policy_reward_max": {"agent_policy": 8170.440815931349, "adversary_policy": -12.864047280725583}, "policy_reward_mean": {"agent_policy": 4009.5779637663377, "adversary_policy": -5250.325875294521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7089.023994392326, -4311.6869429648, -8148.25254014192, -7477.095300803994, -6360.082852303557, -9317.555949266416, -9156.987884236263, -3184.0952933207645, -7275.863446479523, -4806.411900424186, -7811.6901579494925, -6439.6961680732575, -4740.588664850282, -9137.778924635693, -4257.812921048579, -3812.001925297063, -6137.7336121461185, -5783.534095693735, -133.31088454824436, -5551.263320925318, -6986.519257492214, -3905.0564891366707, -6956.875764330207, -7665.43525834084, -6558.467580332849, -7162.767323029165, -7334.187120065112, -6679.920947503538, -7424.728721450095, -5570.638384539604, -7760.619005046082, -6460.309658143296, -7841.237267641249, -7285.020446882705, -7978.475589473112, -7113.6547601547745, -6339.824093311889, -8704.599452887798], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3669.9625766311137, 3623.9344539914596, 1684.7533007579295, 1797.2775799208925, 1772.4319881660401, 2509.0656935790835, 6049.954973951053, 2060.3907345863745, 4844.097609263973, 2433.7405079928085, 6670.594241879644, 2684.912467555396, 2128.050748685148, 8170.440815931349, 321.67038789499725, 2873.6188421488732, 4967.060624347934, 3918.1678081660757, 12.864047280725583, 4151.4458620012565, 6384.672829396107, 1693.8237463397088, 5793.435834444566, 5059.11419274415, 4217.021311875523, 2661.434826663664, 3875.3718618523526, 5782.389685360602, 6683.416934354065, 1442.4755954366608, 5972.298537271508, 4629.985044783829, 4729.0565487174335, 6617.953368595668, 7206.170150089373, 3661.0566720696265, 5041.3505741022955, 4568.499644291615], "policy_adversary_policy_reward": [-7089.023994392324, -3669.9625766311137, -4082.188553742054, -3853.4328432142056, -1684.7533007579295, -8148.25254014192, -7477.095300803994, -1797.2775799208925, -6360.082852303555, -1772.4319881660401, -9317.555949266416, -2509.0656935790835, -6049.954973951053, -9156.987884236263, -3176.4625440182735, -2068.023483888866, -7275.863446479525, -4844.097609263973, -4806.411900424187, -2433.7405079928085, -6777.054039488983, -7705.230360340154, -6439.6961680732575, -2684.912467555396, -4717.630037291588, -2151.009376243843, -8270.533620645085, -9037.686119921955, -321.67038789499725, -4257.812921048579, -3083.363381852763, -3602.257385593173, -5495.825921429628, -5608.968315064421, -4554.008838447558, -5147.69306541225, -133.31088454824433, -12.864047280725583, -4634.785072801582, -5067.924110124997, -6719.569867067116, -6651.6222198212035, -3636.5287910284255, -1962.3514444479558, -6447.914758630076, -6302.396840144693, -6729.816605518344, -5994.732845566649, -6557.475289600122, -4218.01360260825, -2661.434826663664, -7162.767323029165, -7334.187120065113, -3875.3718618523526, -5951.128128990068, -6511.1825038740735, -7288.994872966698, -6819.1507828374615, -5570.638384539604, -1442.4755954366608, -7733.86208258498, -5999.055459732611, -4629.985044783829, -6460.309658143296, -7841.237267641248, -4729.0565487174335, -7055.470414558628, -6847.503400919744, -7489.335177204115, -7695.310562358371, -7113.654760154774, -3661.0566720696265, -5070.269542342327, -6310.905125071857, -8704.599452887796, -4568.499644291615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4211325063059186, "mean_inference_ms": 1.0411062093368224, "mean_action_processing_ms": 0.17896095194020173, "mean_env_wait_ms": 0.05667050676215916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005007103869789525, "StateBufferConnector_ms": 0.0030266611199629935, "ViewRequirementAgentConnector_ms": 0.0766004386701082}, "num_episodes": 19, "episode_return_max": -133.31088454824436, "episode_return_min": -9317.555949266416, "episode_return_mean": -6491.073786822703}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 567.3408750564898, "num_env_steps_trained_throughput_per_sec": 567.3408750564898, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 7547.148, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7547.108, "sample_time_ms": 825.626, "learn_time_ms": 6711.029, "learn_throughput": 596.034, "synch_weights_time_ms": 9.905}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "3439d_00000", "date": "2024-08-09_15-26-21", "timestamp": 1723231581, "time_this_iter_s": 7.052869081497192, "time_total_s": 15.106091022491455, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a5f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15.106091022491455, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.28, "ram_util_percent": 80.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7162008786884447, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995167263348897, "policy_loss": -0.002841682684083935, "vf_loss": 9.995158389210701, "vf_explained_var": 2.9106934865315754e-05, "kl": 0.014252772280209077, "entropy": 1.5896330529203018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6873582844854031, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997679740663559, "policy_loss": -0.0024551427811039268, "vf_loss": 9.99760737292981, "vf_explained_var": 4.362498641644836e-05, "kl": 0.012637615127725496, "entropy": 1.5916937775082058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -133.31088454824436, "episode_reward_min": -9317.555949266416, "episode_reward_mean": -6464.370426497308, "episode_len_mean": 192.140350877193, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10952, "policy_reward_min": {"agent_policy": 12.864047280725583, "adversary_policy": -9317.555949266416}, "policy_reward_max": {"agent_policy": 8184.980402496591, "adversary_policy": -12.864047280725583}, "policy_reward_mean": {"agent_policy": 3977.6153297060396, "adversary_policy": -5220.992878101673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7089.023994392326, -4311.6869429648, -8148.25254014192, -7477.095300803994, -6360.082852303557, -9317.555949266416, -9156.987884236263, -3184.0952933207645, -7275.863446479523, -4806.411900424186, -7811.6901579494925, -6439.6961680732575, -4740.588664850282, -9137.778924635693, -4257.812921048579, -3812.001925297063, -6137.7336121461185, -5783.534095693735, -133.31088454824436, -5551.263320925318, -6986.519257492214, -3905.0564891366707, -6956.875764330207, -7665.43525834084, -6558.467580332849, -7162.767323029165, -7334.187120065112, -6679.920947503538, -7424.728721450095, -5570.638384539604, -7760.619005046082, -6460.309658143296, -7841.237267641249, -7285.020446882705, -7978.475589473112, -7113.6547601547745, -6339.824093311889, -8704.599452887798, -5300.640085418871, -7377.462482630398, -7188.146022677402, -7023.962728040555, -8847.833267380222, -5240.585685944394, -794.3664280725445, -9008.021201662737, -8980.511989800678, -6514.328031088467, -3840.5167149450335, -6728.7271517710915, -6154.73476463931, -7129.28374606964, -3092.9013692047247, -5959.53488381606, -7865.700590095138, -7110.543853006535, -7650.509414819986], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3669.9625766311137, 3623.9344539914596, 1684.7533007579295, 1797.2775799208925, 1772.4319881660401, 2509.0656935790835, 6049.954973951053, 2060.3907345863745, 4844.097609263973, 2433.7405079928085, 6670.594241879644, 2684.912467555396, 2128.050748685148, 8170.440815931349, 321.67038789499725, 2873.6188421488732, 4967.060624347934, 3918.1678081660757, 12.864047280725583, 4151.4458620012565, 6384.672829396107, 1693.8237463397088, 5793.435834444566, 5059.11419274415, 4217.021311875523, 2661.434826663664, 3875.3718618523526, 5782.389685360602, 6683.416934354065, 1442.4755954366608, 5972.298537271508, 4629.985044783829, 4729.0565487174335, 6617.953368595668, 7206.170150089373, 3661.0566720696265, 5041.3505741022955, 4568.499644291615, 3855.2247973749145, 5791.34901169208, 4970.6861547190865, 3895.238019915671, 4676.509398498803, 3898.216121662549, 374.85078209010334, 8184.980402496591, 3728.467141904249, 5177.36513798584, 2015.2761294464744, 2110.1138491371985, 2078.9649589127716, 3409.5313671472754, 1942.5062847579045, 1527.6531087245369, 5303.046113376566, 6360.963902187471, 5059.168488093291], "policy_adversary_policy_reward": [-7089.023994392324, -3669.9625766311137, -4082.188553742054, -3853.4328432142056, -1684.7533007579295, -8148.25254014192, -7477.095300803994, -1797.2775799208925, -6360.082852303555, -1772.4319881660401, -9317.555949266416, -2509.0656935790835, -6049.954973951053, -9156.987884236263, -3176.4625440182735, -2068.023483888866, -7275.863446479525, -4844.097609263973, -4806.411900424187, -2433.7405079928085, -6777.054039488983, -7705.230360340154, -6439.6961680732575, -2684.912467555396, -4717.630037291588, -2151.009376243843, -8270.533620645085, -9037.686119921955, -321.67038789499725, -4257.812921048579, -3083.363381852763, -3602.257385593173, -5495.825921429628, -5608.968315064421, -4554.008838447558, -5147.69306541225, -133.31088454824433, -12.864047280725583, -4634.785072801582, -5067.924110124997, -6719.569867067116, -6651.6222198212035, -3636.5287910284255, -1962.3514444479558, -6447.914758630076, -6302.396840144693, -6729.816605518344, -5994.732845566649, -6557.475289600122, -4218.01360260825, -2661.434826663664, -7162.767323029165, -7334.187120065113, -3875.3718618523526, -5951.128128990068, -6511.1825038740735, -7288.994872966698, -6819.1507828374615, -5570.638384539604, -1442.4755954366608, -7733.86208258498, -5999.055459732611, -4629.985044783829, -6460.309658143296, -7841.237267641248, -4729.0565487174335, -7055.470414558628, -6847.503400919744, -7489.335177204115, -7695.310562358371, -7113.654760154774, -3661.0566720696265, -5070.269542342327, -6310.905125071857, -8704.599452887796, -4568.499644291615, -4700.912566133336, -4454.9523166604495, -5827.889590122921, -7340.921904199556, -4970.6861547190865, -7188.146022677402, -7023.785744558397, -3895.415003397828, -8847.833267380222, -4676.509398498803, -3898.216121662549, -5240.585685944394, -374.85078209010334, -794.3664280725445, -8968.468812978617, -8224.53279118071, -8980.511989800678, -3728.467141904249, -6499.1463275048645, -5192.546841569445, -3524.589987726642, -2331.202856664868, -6728.7271517710915, -2110.1138491371985, -6154.734764639311, -2078.9649589127716, -3409.5313671472754, -7129.28374606964, -3090.1114481106456, -1945.2962058519847, -1527.6531087245369, -5959.53488381606, -7865.700590095139, -5303.046113376566, -7097.611505776619, -6373.896249417384, -7650.509414819985, -5059.168488093291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41941185218309235, "mean_inference_ms": 1.039780421187044, "mean_action_processing_ms": 0.1786419084433831, "mean_env_wait_ms": 0.056369594842492064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004853072919343647, "StateBufferConnector_ms": 0.0028066467820552356, "ViewRequirementAgentConnector_ms": 0.07937414604320861}, "num_episodes": 19, "episode_return_max": -133.31088454824436, "episode_return_min": -9317.555949266416, "episode_return_mean": -6464.370426497308}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 568.9481157333477, "num_env_steps_trained_throughput_per_sec": 568.9481157333477, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7374.94, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7374.904, "sample_time_ms": 819.213, "learn_time_ms": 6545.422, "learn_throughput": 611.114, "synch_weights_time_ms": 9.761}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "3439d_00000", "date": "2024-08-09_15-26-28", "timestamp": 1723231588, "time_this_iter_s": 7.033059120178223, "time_total_s": 22.139150142669678, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a5f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22.139150142669678, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.136363636363637, "ram_util_percent": 79.84545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7064061193106075, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99241446852684, "policy_loss": 0.0009662243372683103, "vf_loss": 9.988875208298365, "vf_explained_var": -1.9200146198272704e-06, "kl": 0.012865175503247884, "entropy": 1.5887102797627448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6852570430942313, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992771378269902, "policy_loss": -0.003928811036336122, "vf_loss": 9.994466257347632, "vf_explained_var": -2.9990691987295e-05, "kl": 0.011169651170413962, "entropy": 1.5950551226025536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -133.31088454824436, "episode_reward_min": -9317.555949266416, "episode_reward_mean": -6205.576827397622, "episode_len_mean": 191.4935064935065, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 14745, "policy_reward_min": {"agent_policy": 12.864047280725583, "adversary_policy": -9317.555949266416}, "policy_reward_max": {"agent_policy": 8184.980402496591, "adversary_policy": -12.864047280725583}, "policy_reward_mean": {"agent_policy": 3781.7612524751057, "adversary_policy": -4993.669039936362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7089.023994392326, -4311.6869429648, -8148.25254014192, -7477.095300803994, -6360.082852303557, -9317.555949266416, -9156.987884236263, -3184.0952933207645, -7275.863446479523, -4806.411900424186, -7811.6901579494925, -6439.6961680732575, -4740.588664850282, -9137.778924635693, -4257.812921048579, -3812.001925297063, -6137.7336121461185, -5783.534095693735, -133.31088454824436, -5551.263320925318, -6986.519257492214, -3905.0564891366707, -6956.875764330207, -7665.43525834084, -6558.467580332849, -7162.767323029165, -7334.187120065112, -6679.920947503538, -7424.728721450095, -5570.638384539604, -7760.619005046082, -6460.309658143296, -7841.237267641249, -7285.020446882705, -7978.475589473112, -7113.6547601547745, -6339.824093311889, -8704.599452887798, -5300.640085418871, -7377.462482630398, -7188.146022677402, -7023.962728040555, -8847.833267380222, -5240.585685944394, -794.3664280725445, -9008.021201662737, -8980.511989800678, -6514.328031088467, -3840.5167149450335, -6728.7271517710915, -6154.73476463931, -7129.28374606964, -3092.9013692047247, -5959.53488381606, -7865.700590095138, -7110.543853006535, -7650.509414819986, -5888.279884736402, -7235.17305882549, -5447.699680103971, -1276.8096218942314, -5070.20986937884, -4773.0337030612745, -5096.922112713237, -5494.245522881314, -5257.988681834698, -5783.297653650899, -2995.17631217306, -4995.139676323032, -3464.986438930044, -6908.7708286255665, -5677.643241399045, -8635.352816399996, -7230.465199443027, -6921.90223522653, -4388.3798093402065, -6818.825052329379], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3669.9625766311137, 3623.9344539914596, 1684.7533007579295, 1797.2775799208925, 1772.4319881660401, 2509.0656935790835, 6049.954973951053, 2060.3907345863745, 4844.097609263973, 2433.7405079928085, 6670.594241879644, 2684.912467555396, 2128.050748685148, 8170.440815931349, 321.67038789499725, 2873.6188421488732, 4967.060624347934, 3918.1678081660757, 12.864047280725583, 4151.4458620012565, 6384.672829396107, 1693.8237463397088, 5793.435834444566, 5059.11419274415, 4217.021311875523, 2661.434826663664, 3875.3718618523526, 5782.389685360602, 6683.416934354065, 1442.4755954366608, 5972.298537271508, 4629.985044783829, 4729.0565487174335, 6617.953368595668, 7206.170150089373, 3661.0566720696265, 5041.3505741022955, 4568.499644291615, 3855.2247973749145, 5791.34901169208, 4970.6861547190865, 3895.238019915671, 4676.509398498803, 3898.216121662549, 374.85078209010334, 8184.980402496591, 3728.467141904249, 5177.36513798584, 2015.2761294464744, 2110.1138491371985, 2078.9649589127716, 3409.5313671472754, 1942.5062847579045, 1527.6531087245369, 5303.046113376566, 6360.963902187471, 5059.168488093291, 3821.914448678006, 3256.475276723207, 4112.803964659223, 498.1756596313691, 2554.6768443812243, 2418.4308476500814, 3496.3705318234433, 2331.370741197046, 4422.0468837568, 4545.324162095344, 2007.6926601064627, 3611.577378474194, 524.742631724803, 3245.0062737632747, 4202.810960115903, 7197.805239231974, 2422.960860498273, 2903.90822253598, 2668.2685028806113, 4229.180557411664], "policy_adversary_policy_reward": [-7089.023994392324, -3669.9625766311137, -4082.188553742054, -3853.4328432142056, -1684.7533007579295, -8148.25254014192, -7477.095300803994, -1797.2775799208925, -6360.082852303555, -1772.4319881660401, -9317.555949266416, -2509.0656935790835, -6049.954973951053, -9156.987884236263, -3176.4625440182735, -2068.023483888866, -7275.863446479525, -4844.097609263973, -4806.411900424187, -2433.7405079928085, -6777.054039488983, -7705.230360340154, -6439.6961680732575, -2684.912467555396, -4717.630037291588, -2151.009376243843, -8270.533620645085, -9037.686119921955, -321.67038789499725, -4257.812921048579, -3083.363381852763, -3602.257385593173, -5495.825921429628, -5608.968315064421, -4554.008838447558, -5147.69306541225, -133.31088454824433, -12.864047280725583, -4634.785072801582, -5067.924110124997, -6719.569867067116, -6651.6222198212035, -3636.5287910284255, -1962.3514444479558, -6447.914758630076, -6302.396840144693, -6729.816605518344, -5994.732845566649, -6557.475289600122, -4218.01360260825, -2661.434826663664, -7162.767323029165, -7334.187120065113, -3875.3718618523526, -5951.128128990068, -6511.1825038740735, -7288.994872966698, -6819.1507828374615, -5570.638384539604, -1442.4755954366608, -7733.86208258498, -5999.055459732611, -4629.985044783829, -6460.309658143296, -7841.237267641248, -4729.0565487174335, -7055.470414558628, -6847.503400919744, -7489.335177204115, -7695.310562358371, -7113.654760154774, -3661.0566720696265, -5070.269542342327, -6310.905125071857, -8704.599452887796, -4568.499644291615, -4700.912566133336, -4454.9523166604495, -5827.889590122921, -7340.921904199556, -4970.6861547190865, -7188.146022677402, -7023.785744558397, -3895.415003397828, -8847.833267380222, -4676.509398498803, -3898.216121662549, -5240.585685944394, -374.85078209010334, -794.3664280725445, -8968.468812978617, -8224.53279118071, -8980.511989800678, -3728.467141904249, -6499.1463275048645, -5192.546841569445, -3524.589987726642, -2331.202856664868, -6728.7271517710915, -2110.1138491371985, -6154.734764639311, -2078.9649589127716, -3409.5313671472754, -7129.28374606964, -3090.1114481106456, -1945.2962058519847, -1527.6531087245369, -5959.53488381606, -7865.700590095139, -5303.046113376566, -7097.611505776619, -6373.896249417384, -7650.509414819985, -5059.168488093291, -5730.257939733668, -3979.936393680745, -3256.475276723207, -7235.17305882549, -5431.848182663115, -4128.655462100077, -626.4987484991864, -1148.4865330264147, -2554.6768443812243, -5070.20986937884, -4773.0337030612745, -2418.4308476500814, -5005.360266337178, -3587.9323781995004, -5494.245522881315, -2331.370741197046, -4982.578765901848, -4697.456799689651, -5506.474228694679, -4822.147587051559, -2765.371103637814, -2237.4978686417116, -3832.343582649981, -4774.373472147244, -524.742631724803, -3464.986438930044, -6908.770828625566, -3245.0062737632747, -5670.485453011215, -4209.968748503731, -8417.207963660025, -7415.950091971937, -2422.960860498273, -7230.465199443027, -6451.004419479827, -3374.8060382826784, -2668.2685028806113, -4388.3798093402065, -5777.846536626244, -5270.1590731148035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4245343127549774, "mean_inference_ms": 1.0525213281655523, "mean_action_processing_ms": 0.17998456945784896, "mean_env_wait_ms": 0.05675323725309603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005432692441073331, "StateBufferConnector_ms": 0.0028650481979568283, "ViewRequirementAgentConnector_ms": 0.08037183191869166}, "num_episodes": 20, "episode_return_max": -133.31088454824436, "episode_return_min": -9317.555949266416, "episode_return_mean": -6205.576827397622}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.8151619746345, "num_env_steps_trained_throughput_per_sec": 549.8151619746345, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7350.0, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7349.964, "sample_time_ms": 851.765, "learn_time_ms": 6487.984, "learn_throughput": 616.524, "synch_weights_time_ms": 9.728}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "3439d_00000", "date": "2024-08-09_15-26-36", "timestamp": 1723231596, "time_this_iter_s": 7.2775750160217285, "time_total_s": 29.416725158691406, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3279bedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29.416725158691406, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 31.4, "ram_util_percent": 79.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6652045281293492, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994192903240522, "policy_loss": 0.0010087706818012522, "vf_loss": 9.987790305415789, "vf_explained_var": -1.1023258169492086e-05, "kl": 0.026969102603228143, "entropy": 1.5632136159886916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6604165604190221, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993984804708491, "policy_loss": -0.0030177376208403123, "vf_loss": 9.99369991746529, "vf_explained_var": -2.103514141506619e-05, "kl": 0.016513198154372355, "entropy": 1.5923655105015588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -133.31088454824436, "episode_reward_min": -11134.429396091886, "episode_reward_mean": -6349.924814938057, "episode_len_mean": 191.14, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 19114, "policy_reward_min": {"agent_policy": 12.864047280725583, "adversary_policy": -10339.493061768833}, "policy_reward_max": {"agent_policy": 9187.608876511562, "adversary_policy": -12.864047280725583}, "policy_reward_mean": {"agent_policy": 3920.3202541735795, "adversary_policy": -5135.122534555819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4311.6869429648, -8148.25254014192, -7477.095300803994, -6360.082852303557, -9317.555949266416, -9156.987884236263, -3184.0952933207645, -7275.863446479523, -4806.411900424186, -7811.6901579494925, -6439.6961680732575, -4740.588664850282, -9137.778924635693, -4257.812921048579, -3812.001925297063, -6137.7336121461185, -5783.534095693735, -133.31088454824436, -5551.263320925318, -6986.519257492214, -3905.0564891366707, -6956.875764330207, -7665.43525834084, -6558.467580332849, -7162.767323029165, -7334.187120065112, -6679.920947503538, -7424.728721450095, -5570.638384539604, -7760.619005046082, -6460.309658143296, -7841.237267641249, -7285.020446882705, -7978.475589473112, -7113.6547601547745, -6339.824093311889, -8704.599452887798, -5300.640085418871, -7377.462482630398, -7188.146022677402, -7023.962728040555, -8847.833267380222, -5240.585685944394, -794.3664280725445, -9008.021201662737, -8980.511989800678, -6514.328031088467, -3840.5167149450335, -6728.7271517710915, -6154.73476463931, -7129.28374606964, -3092.9013692047247, -5959.53488381606, -7865.700590095138, -7110.543853006535, -7650.509414819986, -5888.279884736402, -7235.17305882549, -5447.699680103971, -1276.8096218942314, -5070.20986937884, -4773.0337030612745, -5096.922112713237, -5494.245522881314, -5257.988681834698, -5783.297653650899, -2995.17631217306, -4995.139676323032, -3464.986438930044, -6908.7708286255665, -5677.643241399045, -8635.352816399996, -7230.465199443027, -6921.90223522653, -4388.3798093402065, -6818.825052329379, -9566.54951893524, -7785.619202149349, -5526.172430330826, -6224.341072136242, -8714.439033964287, -9358.112018689058, -9496.341638823396, -7082.56502664177, -7898.728808274661, -1182.884153823161, -4162.632509902565, -3223.2255081154294, -8035.89271208903, -6779.9704592566095, -5130.362507442561, -6456.800059475952, -11134.429396091886, -6119.528655666, -8533.893294590984, -2288.521430194055, -6197.4530851758, -5086.750040544011, -9556.393478112768, -8710.483738155644], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 83, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200], "policy_agent_policy_reward": [3623.9344539914596, 1684.7533007579295, 1797.2775799208925, 1772.4319881660401, 2509.0656935790835, 6049.954973951053, 2060.3907345863745, 4844.097609263973, 2433.7405079928085, 6670.594241879644, 2684.912467555396, 2128.050748685148, 8170.440815931349, 321.67038789499725, 2873.6188421488732, 4967.060624347934, 3918.1678081660757, 12.864047280725583, 4151.4458620012565, 6384.672829396107, 1693.8237463397088, 5793.435834444566, 5059.11419274415, 4217.021311875523, 2661.434826663664, 3875.3718618523526, 5782.389685360602, 6683.416934354065, 1442.4755954366608, 5972.298537271508, 4629.985044783829, 4729.0565487174335, 6617.953368595668, 7206.170150089373, 3661.0566720696265, 5041.3505741022955, 4568.499644291615, 3855.2247973749145, 5791.34901169208, 4970.6861547190865, 3895.238019915671, 4676.509398498803, 3898.216121662549, 374.85078209010334, 8184.980402496591, 3728.467141904249, 5177.36513798584, 2015.2761294464744, 2110.1138491371985, 2078.9649589127716, 3409.5313671472754, 1942.5062847579045, 1527.6531087245369, 5303.046113376566, 6360.963902187471, 5059.168488093291, 3821.914448678006, 3256.475276723207, 4112.803964659223, 498.1756596313691, 2554.6768443812243, 2418.4308476500814, 3496.3705318234433, 2331.370741197046, 4422.0468837568, 4545.324162095344, 2007.6926601064627, 3611.577378474194, 524.742631724803, 3245.0062737632747, 4202.810960115903, 7197.805239231974, 2422.960860498273, 2903.90822253598, 2668.2685028806113, 4229.180557411664, 8108.5531506667285, 2240.8730799096897, 3453.415906257983, 3201.865895599999, 1387.0035392485229, 6305.828705763685, 7244.601954190345, 5928.156309101989, 5264.330640291667, 729.9130270355726, 2786.5559673831467, 2315.2297276382033, 4152.802097508683, 5526.117754856198, 3308.1126196987816, 5172.370043541044, 9187.608876511562, 4674.83735416606, 4162.694107031812, 366.53084096159523, 5226.181578183905, 3158.1643350764143, 3223.215440873118, 7381.408601909262], "policy_adversary_policy_reward": [-4082.188553742054, -3853.4328432142056, -1684.7533007579295, -8148.25254014192, -7477.095300803994, -1797.2775799208925, -6360.082852303555, -1772.4319881660401, -9317.555949266416, -2509.0656935790835, -6049.954973951053, -9156.987884236263, -3176.4625440182735, -2068.023483888866, -7275.863446479525, -4844.097609263973, -4806.411900424187, -2433.7405079928085, -6777.054039488983, -7705.230360340154, -6439.6961680732575, -2684.912467555396, -4717.630037291588, -2151.009376243843, -8270.533620645085, -9037.686119921955, -321.67038789499725, -4257.812921048579, -3083.363381852763, -3602.257385593173, -5495.825921429628, -5608.968315064421, -4554.008838447558, -5147.69306541225, -133.31088454824433, -12.864047280725583, -4634.785072801582, -5067.924110124997, -6719.569867067116, -6651.6222198212035, -3636.5287910284255, -1962.3514444479558, -6447.914758630076, -6302.396840144693, -6729.816605518344, -5994.732845566649, -6557.475289600122, -4218.01360260825, -2661.434826663664, -7162.767323029165, -7334.187120065113, -3875.3718618523526, -5951.128128990068, -6511.1825038740735, -7288.994872966698, -6819.1507828374615, -5570.638384539604, -1442.4755954366608, -7733.86208258498, -5999.055459732611, -4629.985044783829, -6460.309658143296, -7841.237267641248, -4729.0565487174335, -7055.470414558628, -6847.503400919744, -7489.335177204115, -7695.310562358371, -7113.654760154774, -3661.0566720696265, -5070.269542342327, -6310.905125071857, -8704.599452887796, -4568.499644291615, -4700.912566133336, -4454.9523166604495, -5827.889590122921, -7340.921904199556, -4970.6861547190865, -7188.146022677402, -7023.785744558397, -3895.415003397828, -8847.833267380222, -4676.509398498803, -3898.216121662549, -5240.585685944394, -374.85078209010334, -794.3664280725445, -8968.468812978617, -8224.53279118071, -8980.511989800678, -3728.467141904249, -6499.1463275048645, -5192.546841569445, -3524.589987726642, -2331.202856664868, -6728.7271517710915, -2110.1138491371985, -6154.734764639311, -2078.9649589127716, -3409.5313671472754, -7129.28374606964, -3090.1114481106456, -1945.2962058519847, -1527.6531087245369, -5959.53488381606, -7865.700590095139, -5303.046113376566, -7097.611505776619, -6373.896249417384, -7650.509414819985, -5059.168488093291, -5730.257939733668, -3979.936393680745, -3256.475276723207, -7235.17305882549, -5431.848182663115, -4128.655462100077, -626.4987484991864, -1148.4865330264147, -2554.6768443812243, -5070.20986937884, -4773.0337030612745, -2418.4308476500814, -5005.360266337178, -3587.9323781995004, -5494.245522881315, -2331.370741197046, -4982.578765901848, -4697.456799689651, -5506.474228694679, -4822.147587051559, -2765.371103637814, -2237.4978686417116, -3832.343582649981, -4774.373472147244, -524.742631724803, -3464.986438930044, -6908.770828625566, -3245.0062737632747, -5670.485453011215, -4209.968748503731, -8417.207963660025, -7415.950091971937, -2422.960860498273, -7230.465199443027, -6451.004419479827, -3374.8060382826784, -2668.2685028806113, -4388.3798093402065, -5777.846536626244, -5270.1590731148035, -8108.5531506667285, -9566.54951893524, -7785.619202149348, -2240.8730799096897, -3453.415906257983, -5526.172430330826, -3201.865895599999, -6224.341072136242, -1387.0035392485229, -8714.439033964287, -9358.112018689055, -6305.828705763685, -7244.695200296213, -9496.248392717527, -7082.5650266417715, -5928.156309101989, -7898.728808274659, -5264.330640291667, -1145.3784223192845, -767.418758539449, -4162.632509902565, -2786.5559673831467, -2379.8913440916554, -3158.5638916619773, -8033.82172479264, -4154.873084805072, -5619.481458344023, -6686.606755768783, -4102.164283858588, -4336.310843282762, -5816.382438968601, -5812.7876640483955, -9982.545210834616, -10339.493061768833, -4674.866178817712, -6119.499831014348, -4162.694107031812, -8533.893294590984, -2288.5214301940555, -366.53084096159523, -5277.260872036565, -6146.373791323139, -4869.2726015340095, -3375.641774086417, -9556.393478112768, -3223.215440873118, -7381.467203329365, -8710.425136735543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42518777369134186, "mean_inference_ms": 1.0524652025690642, "mean_action_processing_ms": 0.17979640830885985, "mean_env_wait_ms": 0.05657939201391913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050220489501953125, "StateBufferConnector_ms": 0.0027618408203125, "ViewRequirementAgentConnector_ms": 0.07657718658447266}, "num_episodes": 24, "episode_return_max": -133.31088454824436, "episode_return_min": -11134.429396091886, "episode_return_mean": -6349.924814938057}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.4560322664968, "num_env_steps_trained_throughput_per_sec": 553.4560322664968, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7325.464, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7325.428, "sample_time_ms": 834.972, "learn_time_ms": 6480.26, "learn_throughput": 617.259, "synch_weights_time_ms": 9.716}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "3439d_00000", "date": "2024-08-09_15-26-43", "timestamp": 1723231603, "time_this_iter_s": 7.230156898498535, "time_total_s": 36.64688205718994, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ab3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.64688205718994, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.5, "ram_util_percent": 79.55454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6529245671505729, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.01187835931778, "policy_loss": 0.011781107141481091, "vf_loss": 9.99196990331014, "vf_explained_var": -6.056639055411021e-06, "kl": 0.027091217236981418, "entropy": 1.559435915077726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6497660764783778, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992453931374525, "policy_loss": -0.006790757299494491, "vf_loss": 9.995642403193882, "vf_explained_var": -2.3866235894500895e-05, "kl": 0.01801141367377664, "entropy": 1.5898776938044836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -794.3664280725445, "episode_reward_min": -11134.429396091886, "episode_reward_mean": -6452.348096176624, "episode_len_mean": 194.19, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19419, "policy_reward_min": {"agent_policy": 366.53084096159523, "adversary_policy": -10339.493061768833}, "policy_reward_max": {"agent_policy": 9187.608876511562, "adversary_policy": -366.53084096159523}, "policy_reward_mean": {"agent_policy": 4053.6966986190855, "adversary_policy": -5253.022397397854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6986.519257492214, -3905.0564891366707, -6956.875764330207, -7665.43525834084, -6558.467580332849, -7162.767323029165, -7334.187120065112, -6679.920947503538, -7424.728721450095, -5570.638384539604, -7760.619005046082, -6460.309658143296, -7841.237267641249, -7285.020446882705, -7978.475589473112, -7113.6547601547745, -6339.824093311889, -8704.599452887798, -5300.640085418871, -7377.462482630398, -7188.146022677402, -7023.962728040555, -8847.833267380222, -5240.585685944394, -794.3664280725445, -9008.021201662737, -8980.511989800678, -6514.328031088467, -3840.5167149450335, -6728.7271517710915, -6154.73476463931, -7129.28374606964, -3092.9013692047247, -5959.53488381606, -7865.700590095138, -7110.543853006535, -7650.509414819986, -5888.279884736402, -7235.17305882549, -5447.699680103971, -1276.8096218942314, -5070.20986937884, -4773.0337030612745, -5096.922112713237, -5494.245522881314, -5257.988681834698, -5783.297653650899, -2995.17631217306, -4995.139676323032, -3464.986438930044, -6908.7708286255665, -5677.643241399045, -8635.352816399996, -7230.465199443027, -6921.90223522653, -4388.3798093402065, -6818.825052329379, -9566.54951893524, -7785.619202149349, -5526.172430330826, -6224.341072136242, -8714.439033964287, -9358.112018689058, -9496.341638823396, -7082.56502664177, -7898.728808274661, -1182.884153823161, -4162.632509902565, -3223.2255081154294, -8035.89271208903, -6779.9704592566095, -5130.362507442561, -6456.800059475952, -11134.429396091886, -6119.528655666, -8533.893294590984, -2288.521430194055, -6197.4530851758, -5086.750040544011, -9556.393478112768, -8710.483738155644, -8873.728293021704, -8824.528528425131, -8567.572094527666, -5294.444619924618, -6272.163349404653, -5158.937782455464, -3719.743451319118, -7244.357628549774, -9696.2475051519, -7470.033673159397, -4031.9005221462303, -6235.869721982604, -4372.3817432299875, -6908.464295370896, -5337.871725646377, -6291.635837143556, -4861.342662356066, -7022.134390087882, -7902.41308506275], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6384.672829396107, 1693.8237463397088, 5793.435834444566, 5059.11419274415, 4217.021311875523, 2661.434826663664, 3875.3718618523526, 5782.389685360602, 6683.416934354065, 1442.4755954366608, 5972.298537271508, 4629.985044783829, 4729.0565487174335, 6617.953368595668, 7206.170150089373, 3661.0566720696265, 5041.3505741022955, 4568.499644291615, 3855.2247973749145, 5791.34901169208, 4970.6861547190865, 3895.238019915671, 4676.509398498803, 3898.216121662549, 374.85078209010334, 8184.980402496591, 3728.467141904249, 5177.36513798584, 2015.2761294464744, 2110.1138491371985, 2078.9649589127716, 3409.5313671472754, 1942.5062847579045, 1527.6531087245369, 5303.046113376566, 6360.963902187471, 5059.168488093291, 3821.914448678006, 3256.475276723207, 4112.803964659223, 498.1756596313691, 2554.6768443812243, 2418.4308476500814, 3496.3705318234433, 2331.370741197046, 4422.0468837568, 4545.324162095344, 2007.6926601064627, 3611.577378474194, 524.742631724803, 3245.0062737632747, 4202.810960115903, 7197.805239231974, 2422.960860498273, 2903.90822253598, 2668.2685028806113, 4229.180557411664, 8108.5531506667285, 2240.8730799096897, 3453.415906257983, 3201.865895599999, 1387.0035392485229, 6305.828705763685, 7244.601954190345, 5928.156309101989, 5264.330640291667, 729.9130270355726, 2786.5559673831467, 2315.2297276382033, 4152.802097508683, 5526.117754856198, 3308.1126196987816, 5172.370043541044, 9187.608876511562, 4674.83735416606, 4162.694107031812, 366.53084096159523, 5226.181578183905, 3158.1643350764143, 3223.215440873118, 7381.408601909262, 6625.122530082086, 3797.198997822147, 2334.6754012240203, 3795.4405603882183, 3636.6928597218603, 2255.8023455232683, 3069.5148731872814, 2447.121294073097, 6754.7594240423805, 6374.780388115642, 1922.393608961909, 3152.679139130617, 1740.7095787491721, 5805.240227791901, 2143.9094351398553, 4018.2870586158215, 4441.8541250921135, 4768.139879957747, 6927.795405032416], "policy_adversary_policy_reward": [-6719.569867067116, -6651.6222198212035, -3636.5287910284255, -1962.3514444479558, -6447.914758630076, -6302.396840144693, -6729.816605518344, -5994.732845566649, -6557.475289600122, -4218.01360260825, -2661.434826663664, -7162.767323029165, -7334.187120065113, -3875.3718618523526, -5951.128128990068, -6511.1825038740735, -7288.994872966698, -6819.1507828374615, -5570.638384539604, -1442.4755954366608, -7733.86208258498, -5999.055459732611, -4629.985044783829, -6460.309658143296, -7841.237267641248, -4729.0565487174335, -7055.470414558628, -6847.503400919744, -7489.335177204115, -7695.310562358371, -7113.654760154774, -3661.0566720696265, -5070.269542342327, -6310.905125071857, -8704.599452887796, -4568.499644291615, -4700.912566133336, -4454.9523166604495, -5827.889590122921, -7340.921904199556, -4970.6861547190865, -7188.146022677402, -7023.785744558397, -3895.415003397828, -8847.833267380222, -4676.509398498803, -3898.216121662549, -5240.585685944394, -374.85078209010334, -794.3664280725445, -8968.468812978617, -8224.53279118071, -8980.511989800678, -3728.467141904249, -6499.1463275048645, -5192.546841569445, -3524.589987726642, -2331.202856664868, -6728.7271517710915, -2110.1138491371985, -6154.734764639311, -2078.9649589127716, -3409.5313671472754, -7129.28374606964, -3090.1114481106456, -1945.2962058519847, -1527.6531087245369, -5959.53488381606, -7865.700590095139, -5303.046113376566, -7097.611505776619, -6373.896249417384, -7650.509414819985, -5059.168488093291, -5730.257939733668, -3979.936393680745, -3256.475276723207, -7235.17305882549, -5431.848182663115, -4128.655462100077, -626.4987484991864, -1148.4865330264147, -2554.6768443812243, -5070.20986937884, -4773.0337030612745, -2418.4308476500814, -5005.360266337178, -3587.9323781995004, -5494.245522881315, -2331.370741197046, -4982.578765901848, -4697.456799689651, -5506.474228694679, -4822.147587051559, -2765.371103637814, -2237.4978686417116, -3832.343582649981, -4774.373472147244, -524.742631724803, -3464.986438930044, -6908.770828625566, -3245.0062737632747, -5670.485453011215, -4209.968748503731, -8417.207963660025, -7415.950091971937, -2422.960860498273, -7230.465199443027, -6451.004419479827, -3374.8060382826784, -2668.2685028806113, -4388.3798093402065, -5777.846536626244, -5270.1590731148035, -8108.5531506667285, -9566.54951893524, -7785.619202149348, -2240.8730799096897, -3453.415906257983, -5526.172430330826, -3201.865895599999, -6224.341072136242, -1387.0035392485229, -8714.439033964287, -9358.112018689055, -6305.828705763685, -7244.695200296213, -9496.248392717527, -7082.5650266417715, -5928.156309101989, -7898.728808274659, -5264.330640291667, -1145.3784223192845, -767.418758539449, -4162.632509902565, -2786.5559673831467, -2379.8913440916554, -3158.5638916619773, -8033.82172479264, -4154.873084805072, -5619.481458344023, -6686.606755768783, -4102.164283858588, -4336.310843282762, -5816.382438968601, -5812.7876640483955, -9982.545210834616, -10339.493061768833, -4674.866178817712, -6119.499831014348, -4162.694107031812, -8533.893294590984, -2288.5214301940555, -366.53084096159523, -5277.260872036565, -6146.373791323139, -4869.2726015340095, -3375.641774086417, -9556.393478112768, -3223.215440873118, -7381.467203329365, -8710.425136735543, -7644.363450585418, -7854.487372518374, -8824.528528425131, -3797.198997822147, -2334.6754012240203, -8567.572094527666, -4474.888456542351, -4614.996723770484, -6272.163349404653, -3636.6928597218603, -5158.937782455464, -2255.8023455232683, -3150.4949052601696, -3638.763419246229, -7244.357628549773, -2447.121294073097, -7079.345603579668, -9371.661325614616, -6969.7587634433985, -6875.055297831643, -1923.1513988277318, -4031.1427322804075, -6235.869721982603, -3152.679139130617, -3833.3702709429017, -2279.721051036257, -6898.969364843653, -5814.735158319146, -5337.572805687572, -2144.2083550986595, -4018.2870586158215, -6291.635837143556, -4754.804473174553, -4548.392314273626, -4768.139879957747, -7022.134390087882, -6975.09345401175, -7855.115036083416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4262869801620993, "mean_inference_ms": 1.054559908398759, "mean_action_processing_ms": 0.1798473750071561, "mean_env_wait_ms": 0.05641831550167195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004668712615966797, "StateBufferConnector_ms": 0.0026732683181762695, "ViewRequirementAgentConnector_ms": 0.07555139064788818}, "num_episodes": 19, "episode_return_max": -794.3664280725445, "episode_return_min": -11134.429396091886, "episode_return_mean": -6452.348096176624}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 573.4538351337861, "num_env_steps_trained_throughput_per_sec": 573.4538351337861, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7267.101, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7267.066, "sample_time_ms": 819.899, "learn_time_ms": 6436.975, "learn_throughput": 621.41, "synch_weights_time_ms": 9.723}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "3439d_00000", "date": "2024-08-09_15-26-50", "timestamp": 1723231610, "time_this_iter_s": 6.978105068206787, "time_total_s": 43.62498712539673, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ab1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43.62498712539673, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.860000000000003, "ram_util_percent": 78.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7375041558096807, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.977912173668544, "policy_loss": 0.0017256882468548913, "vf_loss": 9.969001006086668, "vf_explained_var": -2.73682177066803e-05, "kl": 0.01596777684656748, "entropy": 1.5280822073419889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6945267538387309, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.979785745610636, "policy_loss": -0.0051199829731895415, "vf_loss": 9.982685350488733, "vf_explained_var": -0.0002607475828241419, "kl": 0.01110185072658751, "entropy": 1.5906482523080534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -206.98584781312837, "episode_reward_min": -11134.429396091886, "episode_reward_mean": -6060.118965085399, "episode_len_mean": 188.02, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18802, "policy_reward_min": {"agent_policy": 40.97150223501714, "adversary_policy": -10339.493061768833}, "policy_reward_max": {"agent_policy": 9187.608876511562, "adversary_policy": -40.97150223501714}, "policy_reward_mean": {"agent_policy": 3634.8968935196554, "adversary_policy": -4847.507929302527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5240.585685944394, -794.3664280725445, -9008.021201662737, -8980.511989800678, -6514.328031088467, -3840.5167149450335, -6728.7271517710915, -6154.73476463931, -7129.28374606964, -3092.9013692047247, -5959.53488381606, -7865.700590095138, -7110.543853006535, -7650.509414819986, -5888.279884736402, -7235.17305882549, -5447.699680103971, -1276.8096218942314, -5070.20986937884, -4773.0337030612745, -5096.922112713237, -5494.245522881314, -5257.988681834698, -5783.297653650899, -2995.17631217306, -4995.139676323032, -3464.986438930044, -6908.7708286255665, -5677.643241399045, -8635.352816399996, -7230.465199443027, -6921.90223522653, -4388.3798093402065, -6818.825052329379, -9566.54951893524, -7785.619202149349, -5526.172430330826, -6224.341072136242, -8714.439033964287, -9358.112018689058, -9496.341638823396, -7082.56502664177, -7898.728808274661, -1182.884153823161, -4162.632509902565, -3223.2255081154294, -8035.89271208903, -6779.9704592566095, -5130.362507442561, -6456.800059475952, -11134.429396091886, -6119.528655666, -8533.893294590984, -2288.521430194055, -6197.4530851758, -5086.750040544011, -9556.393478112768, -8710.483738155644, -8873.728293021704, -8824.528528425131, -8567.572094527666, -5294.444619924618, -6272.163349404653, -5158.937782455464, -3719.743451319118, -7244.357628549774, -9696.2475051519, -7470.033673159397, -4031.9005221462303, -6235.869721982604, -4372.3817432299875, -6908.464295370896, -5337.871725646377, -6291.635837143556, -4861.342662356066, -7022.134390087882, -7902.41308506275, -4892.988218828698, -5971.6313387000655, -4005.268015153384, -5607.357968533119, -6211.995347025583, -9384.700826415848, -2364.7789709205213, -5089.367221663714, -5118.430668110352, -2750.568545745603, -7688.308813171369, -5905.6479635186915, -5373.581515118274, -3658.023934869883, -6951.632647235478, -206.98584781312837, -3241.1598699681813, -6345.875079009049, -8678.946355770784, -5751.5135002435545, -5731.032914911769, -4211.1324933128135, -7102.540540746385], "episode_lengths": [200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 194, 200, 200, 74, 200, 200, 200, 77, 200, 10, 92, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3898.216121662549, 374.85078209010334, 8184.980402496591, 3728.467141904249, 5177.36513798584, 2015.2761294464744, 2110.1138491371985, 2078.9649589127716, 3409.5313671472754, 1942.5062847579045, 1527.6531087245369, 5303.046113376566, 6360.963902187471, 5059.168488093291, 3821.914448678006, 3256.475276723207, 4112.803964659223, 498.1756596313691, 2554.6768443812243, 2418.4308476500814, 3496.3705318234433, 2331.370741197046, 4422.0468837568, 4545.324162095344, 2007.6926601064627, 3611.577378474194, 524.742631724803, 3245.0062737632747, 4202.810960115903, 7197.805239231974, 2422.960860498273, 2903.90822253598, 2668.2685028806113, 4229.180557411664, 8108.5531506667285, 2240.8730799096897, 3453.415906257983, 3201.865895599999, 1387.0035392485229, 6305.828705763685, 7244.601954190345, 5928.156309101989, 5264.330640291667, 729.9130270355726, 2786.5559673831467, 2315.2297276382033, 4152.802097508683, 5526.117754856198, 3308.1126196987816, 5172.370043541044, 9187.608876511562, 4674.83735416606, 4162.694107031812, 366.53084096159523, 5226.181578183905, 3158.1643350764143, 3223.215440873118, 7381.408601909262, 6625.122530082086, 3797.198997822147, 2334.6754012240203, 3795.4405603882183, 3636.6928597218603, 2255.8023455232683, 3069.5148731872814, 2447.121294073097, 6754.7594240423805, 6374.780388115642, 1922.393608961909, 3152.679139130617, 1740.7095787491721, 5805.240227791901, 2143.9094351398553, 4018.2870586158215, 4441.8541250921135, 4768.139879957747, 6927.795405032416, 928.3278056803963, 4262.572647504261, 2751.6540156494716, 3479.988844455477, 1818.123439076985, 4025.801236693017, 1839.2934642511295, 3421.4529269073005, 1992.8654396696757, 1009.383706454256, 4530.2624171438765, 1405.042997057659, 4402.5989077476825, 792.0777596638333, 4564.919951238106, 40.97150223501714, 1307.8286048122109, 5584.681721246727, 7288.1956254663055, 2792.689006792787, 4791.588712610158, 1800.1700525529416, 2498.063445737059], "policy_adversary_policy_reward": [-3898.216121662549, -5240.585685944394, -374.85078209010334, -794.3664280725445, -8968.468812978617, -8224.53279118071, -8980.511989800678, -3728.467141904249, -6499.1463275048645, -5192.546841569445, -3524.589987726642, -2331.202856664868, -6728.7271517710915, -2110.1138491371985, -6154.734764639311, -2078.9649589127716, -3409.5313671472754, -7129.28374606964, -3090.1114481106456, -1945.2962058519847, -1527.6531087245369, -5959.53488381606, -7865.700590095139, -5303.046113376566, -7097.611505776619, -6373.896249417384, -7650.509414819985, -5059.168488093291, -5730.257939733668, -3979.936393680745, -3256.475276723207, -7235.17305882549, -5431.848182663115, -4128.655462100077, -626.4987484991864, -1148.4865330264147, -2554.6768443812243, -5070.20986937884, -4773.0337030612745, -2418.4308476500814, -5005.360266337178, -3587.9323781995004, -5494.245522881315, -2331.370741197046, -4982.578765901848, -4697.456799689651, -5506.474228694679, -4822.147587051559, -2765.371103637814, -2237.4978686417116, -3832.343582649981, -4774.373472147244, -524.742631724803, -3464.986438930044, -6908.770828625566, -3245.0062737632747, -5670.485453011215, -4209.968748503731, -8417.207963660025, -7415.950091971937, -2422.960860498273, -7230.465199443027, -6451.004419479827, -3374.8060382826784, -2668.2685028806113, -4388.3798093402065, -5777.846536626244, -5270.1590731148035, -8108.5531506667285, -9566.54951893524, -7785.619202149348, -2240.8730799096897, -3453.415906257983, -5526.172430330826, -3201.865895599999, -6224.341072136242, -1387.0035392485229, -8714.439033964287, -9358.112018689055, -6305.828705763685, -7244.695200296213, -9496.248392717527, -7082.5650266417715, -5928.156309101989, -7898.728808274659, -5264.330640291667, -1145.3784223192845, -767.418758539449, -4162.632509902565, -2786.5559673831467, -2379.8913440916554, -3158.5638916619773, -8033.82172479264, -4154.873084805072, -5619.481458344023, -6686.606755768783, -4102.164283858588, -4336.310843282762, -5816.382438968601, -5812.7876640483955, -9982.545210834616, -10339.493061768833, -4674.866178817712, -6119.499831014348, -4162.694107031812, -8533.893294590984, -2288.5214301940555, -366.53084096159523, -5277.260872036565, -6146.373791323139, -4869.2726015340095, -3375.641774086417, -9556.393478112768, -3223.215440873118, -7381.467203329365, -8710.425136735543, -7644.363450585418, -7854.487372518374, -8824.528528425131, -3797.198997822147, -2334.6754012240203, -8567.572094527666, -4474.888456542351, -4614.996723770484, -6272.163349404653, -3636.6928597218603, -5158.937782455464, -2255.8023455232683, -3150.4949052601696, -3638.763419246229, -7244.357628549773, -2447.121294073097, -7079.345603579668, -9371.661325614616, -6969.7587634433985, -6875.055297831643, -1923.1513988277318, -4031.1427322804075, -6235.869721982603, -3152.679139130617, -3833.3702709429017, -2279.721051036257, -6898.969364843653, -5814.735158319146, -5337.572805687572, -2144.2083550986595, -4018.2870586158215, -6291.635837143556, -4754.804473174553, -4548.392314273626, -4768.139879957747, -7022.134390087882, -6975.09345401175, -7855.115036083416, -4892.988218828698, -928.3278056803963, -5792.2941601726125, -4441.909826031714, -3674.0530067798322, -3082.8690240230226, -3502.8103023156855, -5584.5365106729105, -1818.123439076985, -6211.995347025583, -9384.700826415848, -4025.801236693017, -2129.8693443407537, -2074.203090830898, -5085.22382627851, -3425.5963222925047, -5118.430668110352, -1992.8654396696757, -1009.383706454256, -2750.568545745604, -7681.405971836476, -4537.165258478769, -5905.647963518691, -1405.042997057659, -4504.568547964421, -5271.611874901536, -792.0777596638333, -3658.023934869883, -6951.632647235476, -4564.919951238106, -40.97150223501714, -206.98584781312837, -1307.8286048122109, -3241.1598699681813, -5696.366375331723, -6234.190424924054, -8618.064940541568, -7349.07704069552, -5751.513500243556, -2792.689006792787, -4791.956915789578, -5730.664711732349, -2102.913273706037, -3908.3892721597163, -7102.540540746384, -2498.063445737059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42235088098338863, "mean_inference_ms": 1.0416084614269434, "mean_action_processing_ms": 0.17758861352089148, "mean_env_wait_ms": 0.05535665651668062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004404306411743164, "StateBufferConnector_ms": 0.002530813217163086, "ViewRequirementAgentConnector_ms": 0.07000565528869629}, "num_episodes": 23, "episode_return_max": -206.98584781312837, "episode_return_min": -11134.429396091886, "episode_return_mean": -6060.118965085399}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.6830843447855, "num_env_steps_trained_throughput_per_sec": 548.6830843447855, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7270.399, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7270.365, "sample_time_ms": 803.66, "learn_time_ms": 6456.571, "learn_throughput": 619.524, "synch_weights_time_ms": 9.679}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "3439d_00000", "date": "2024-08-09_15-26-57", "timestamp": 1723231617, "time_this_iter_s": 7.29294490814209, "time_total_s": 50.91793203353882, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3279bedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.91793203353882, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.590000000000003, "ram_util_percent": 78.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7391831589862704, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98560520807902, "policy_loss": -0.001572460277141848, "vf_loss": 9.983006390929223, "vf_explained_var": -0.0003863753130038579, "kl": 0.009269466889478887, "entropy": 1.5091695044189692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.693091173572515, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98594171130468, "policy_loss": -0.006396635087877117, "vf_loss": 9.989871156278742, "vf_explained_var": -0.00013402274676731655, "kl": 0.012336029212369964, "entropy": 1.5885982385388127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -199.36951725062042, "episode_reward_min": -11134.429396091886, "episode_reward_mean": -6080.056273712897, "episode_len_mean": 185.92, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18592, "policy_reward_min": {"agent_policy": 40.97150223501714, "adversary_policy": -10339.493061768833}, "policy_reward_max": {"agent_policy": 9187.608876511562, "adversary_policy": -40.97150223501714}, "policy_reward_mean": {"agent_policy": 3715.2272631876826, "adversary_policy": -4897.6417684502885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5494.245522881314, -5257.988681834698, -5783.297653650899, -2995.17631217306, -4995.139676323032, -3464.986438930044, -6908.7708286255665, -5677.643241399045, -8635.352816399996, -7230.465199443027, -6921.90223522653, -4388.3798093402065, -6818.825052329379, -9566.54951893524, -7785.619202149349, -5526.172430330826, -6224.341072136242, -8714.439033964287, -9358.112018689058, -9496.341638823396, -7082.56502664177, -7898.728808274661, -1182.884153823161, -4162.632509902565, -3223.2255081154294, -8035.89271208903, -6779.9704592566095, -5130.362507442561, -6456.800059475952, -11134.429396091886, -6119.528655666, -8533.893294590984, -2288.521430194055, -6197.4530851758, -5086.750040544011, -9556.393478112768, -8710.483738155644, -8873.728293021704, -8824.528528425131, -8567.572094527666, -5294.444619924618, -6272.163349404653, -5158.937782455464, -3719.743451319118, -7244.357628549774, -9696.2475051519, -7470.033673159397, -4031.9005221462303, -6235.869721982604, -4372.3817432299875, -6908.464295370896, -5337.871725646377, -6291.635837143556, -4861.342662356066, -7022.134390087882, -7902.41308506275, -4892.988218828698, -5971.6313387000655, -4005.268015153384, -5607.357968533119, -6211.995347025583, -9384.700826415848, -2364.7789709205213, -5089.367221663714, -5118.430668110352, -2750.568545745603, -7688.308813171369, -5905.6479635186915, -5373.581515118274, -3658.023934869883, -6951.632647235478, -206.98584781312837, -3241.1598699681813, -6345.875079009049, -8678.946355770784, -5751.5135002435545, -5731.032914911769, -4211.1324933128135, -7102.540540746385, -3121.14246045246, -2562.0425217765246, -5984.900150832929, -199.36951725062042, -7079.764816027023, -4167.467131248534, -5189.630633976203, -7580.405750116055, -10135.863660457213, -7792.052531863002, -6967.111709589295, -5815.556586307009, -6088.414472667406, -6353.652368249042, -8188.689509109174, -5035.423835122578, -8650.520348028846, -5889.19925884171, -428.35874976738324, -8742.690994573652, -6879.867612142818], "episode_lengths": [200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 194, 200, 200, 74, 200, 200, 200, 77, 200, 10, 92, 200, 200, 200, 200, 200, 200, 200, 92, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200], "policy_agent_policy_reward": [2331.370741197046, 4422.0468837568, 4545.324162095344, 2007.6926601064627, 3611.577378474194, 524.742631724803, 3245.0062737632747, 4202.810960115903, 7197.805239231974, 2422.960860498273, 2903.90822253598, 2668.2685028806113, 4229.180557411664, 8108.5531506667285, 2240.8730799096897, 3453.415906257983, 3201.865895599999, 1387.0035392485229, 6305.828705763685, 7244.601954190345, 5928.156309101989, 5264.330640291667, 729.9130270355726, 2786.5559673831467, 2315.2297276382033, 4152.802097508683, 5526.117754856198, 3308.1126196987816, 5172.370043541044, 9187.608876511562, 4674.83735416606, 4162.694107031812, 366.53084096159523, 5226.181578183905, 3158.1643350764143, 3223.215440873118, 7381.408601909262, 6625.122530082086, 3797.198997822147, 2334.6754012240203, 3795.4405603882183, 3636.6928597218603, 2255.8023455232683, 3069.5148731872814, 2447.121294073097, 6754.7594240423805, 6374.780388115642, 1922.393608961909, 3152.679139130617, 1740.7095787491721, 5805.240227791901, 2143.9094351398553, 4018.2870586158215, 4441.8541250921135, 4768.139879957747, 6927.795405032416, 928.3278056803963, 4262.572647504261, 2751.6540156494716, 3479.988844455477, 1818.123439076985, 4025.801236693017, 1839.2934642511295, 3421.4529269073005, 1992.8654396696757, 1009.383706454256, 4530.2624171438765, 1405.042997057659, 4402.5989077476825, 792.0777596638333, 4564.919951238106, 40.97150223501714, 1307.8286048122109, 5584.681721246727, 7288.1956254663055, 2792.689006792787, 4791.588712610158, 1800.1700525529416, 2498.063445737059, 2343.9980385468225, 635.2166211267908, 2643.3434515254876, 92.30234751397377, 5065.096549912349, 2787.942856308048, 3963.111661447335, 5540.548526001881, 6722.548743591061, 6801.820073805365, 4345.720600070208, 4863.0162040237565, 3527.9988600102124, 5414.106445264015, 4785.300524677653, 1352.9439341859395, 4679.945969562245, 4212.643178506244, 119.26656503268897, 5270.175329534249, 4195.941847625761], "policy_adversary_policy_reward": [-5494.245522881315, -2331.370741197046, -4982.578765901848, -4697.456799689651, -5506.474228694679, -4822.147587051559, -2765.371103637814, -2237.4978686417116, -3832.343582649981, -4774.373472147244, -524.742631724803, -3464.986438930044, -6908.770828625566, -3245.0062737632747, -5670.485453011215, -4209.968748503731, -8417.207963660025, -7415.950091971937, -2422.960860498273, -7230.465199443027, -6451.004419479827, -3374.8060382826784, -2668.2685028806113, -4388.3798093402065, -5777.846536626244, -5270.1590731148035, -8108.5531506667285, -9566.54951893524, -7785.619202149348, -2240.8730799096897, -3453.415906257983, -5526.172430330826, -3201.865895599999, -6224.341072136242, -1387.0035392485229, -8714.439033964287, -9358.112018689055, -6305.828705763685, -7244.695200296213, -9496.248392717527, -7082.5650266417715, -5928.156309101989, -7898.728808274659, -5264.330640291667, -1145.3784223192845, -767.418758539449, -4162.632509902565, -2786.5559673831467, -2379.8913440916554, -3158.5638916619773, -8033.82172479264, -4154.873084805072, -5619.481458344023, -6686.606755768783, -4102.164283858588, -4336.310843282762, -5816.382438968601, -5812.7876640483955, -9982.545210834616, -10339.493061768833, -4674.866178817712, -6119.499831014348, -4162.694107031812, -8533.893294590984, -2288.5214301940555, -366.53084096159523, -5277.260872036565, -6146.373791323139, -4869.2726015340095, -3375.641774086417, -9556.393478112768, -3223.215440873118, -7381.467203329365, -8710.425136735543, -7644.363450585418, -7854.487372518374, -8824.528528425131, -3797.198997822147, -2334.6754012240203, -8567.572094527666, -4474.888456542351, -4614.996723770484, -6272.163349404653, -3636.6928597218603, -5158.937782455464, -2255.8023455232683, -3150.4949052601696, -3638.763419246229, -7244.357628549773, -2447.121294073097, -7079.345603579668, -9371.661325614616, -6969.7587634433985, -6875.055297831643, -1923.1513988277318, -4031.1427322804075, -6235.869721982603, -3152.679139130617, -3833.3702709429017, -2279.721051036257, -6898.969364843653, -5814.735158319146, -5337.572805687572, -2144.2083550986595, -4018.2870586158215, -6291.635837143556, -4754.804473174553, -4548.392314273626, -4768.139879957747, -7022.134390087882, -6975.09345401175, -7855.115036083416, -4892.988218828698, -928.3278056803963, -5792.2941601726125, -4441.909826031714, -3674.0530067798322, -3082.8690240230226, -3502.8103023156855, -5584.5365106729105, -1818.123439076985, -6211.995347025583, -9384.700826415848, -4025.801236693017, -2129.8693443407537, -2074.203090830898, -5085.22382627851, -3425.5963222925047, -5118.430668110352, -1992.8654396696757, -1009.383706454256, -2750.568545745604, -7681.405971836476, -4537.165258478769, -5905.647963518691, -1405.042997057659, -4504.568547964421, -5271.611874901536, -792.0777596638333, -3658.023934869883, -6951.632647235476, -4564.919951238106, -40.97150223501714, -206.98584781312837, -1307.8286048122109, -3241.1598699681813, -5696.366375331723, -6234.190424924054, -8618.064940541568, -7349.07704069552, -5751.513500243556, -2792.689006792787, -4791.956915789578, -5730.664711732349, -2102.913273706037, -3908.3892721597163, -7102.540540746384, -2498.063445737059, -2855.313714519523, -2609.826784479759, -635.2166211267908, -2562.0425217765255, -2643.3434515254876, -5984.900150832933, -105.0558195742877, -186.6160451903065, -7076.476819716888, -5068.384546222485, -3613.1051552619974, -3342.3048322945842, -4996.3244313427385, -4156.417864080796, -5543.6185585146895, -7577.335717603247, -6722.548743591061, -10135.863660457213, -7135.657483471194, -7458.2151221971735, -4641.918347925464, -6670.913961734038, -5059.559683887672, -5619.013106443095, -5946.259961158419, -3670.153371519197, -5772.813474601507, -5994.9453389115515, -8188.689509109175, -4785.300524677653, -5035.423835122578, -1352.9439341859395, -8573.161322667736, -4757.304994923351, -4376.703181592493, -5725.13925575546, -428.35874976738324, -119.26656503268897, -5270.175329534249, -8742.690994573652, -6879.867612142818, -4195.941847625761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41923039188416256, "mean_inference_ms": 1.0300631961182638, "mean_action_processing_ms": 0.1762251832582483, "mean_env_wait_ms": 0.05458289333087583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00425267219543457, "StateBufferConnector_ms": 0.0025696754455566406, "ViewRequirementAgentConnector_ms": 0.07040691375732422}, "num_episodes": 21, "episode_return_max": -199.36951725062042, "episode_return_min": -11134.429396091886, "episode_return_mean": -6080.056273712897}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 560.9846533199936, "num_env_steps_trained_throughput_per_sec": 560.9846533199936, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7252.89, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7252.856, "sample_time_ms": 795.031, "learn_time_ms": 6447.76, "learn_throughput": 620.371, "synch_weights_time_ms": 9.617}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-05", "timestamp": 1723231625, "time_this_iter_s": 7.133036851882935, "time_total_s": 58.05096888542175, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327aaf040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58.05096888542175, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.67, "ram_util_percent": 78.13000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7145002710012098, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990476729472478, "policy_loss": -0.005443573994853068, "vf_loss": 9.99074917534987, "vf_explained_var": -0.00011438050617774327, "kl": 0.011491449683671818, "entropy": 1.4919055435806512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6915090105520985, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988048817367151, "policy_loss": -0.009393990817652256, "vf_loss": 9.994594921636834, "vf_explained_var": -0.00017999139412370308, "kl": 0.014239370816746953, "entropy": 1.5869963801096356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -199.36951725062042, "episode_reward_min": -11134.429396091886, "episode_reward_mean": -6046.685624965562, "episode_len_mean": 183.97, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18397, "policy_reward_min": {"agent_policy": 40.97150223501714, "adversary_policy": -11082.457814580179}, "policy_reward_max": {"agent_policy": 9187.608876511562, "adversary_policy": -40.97150223501714}, "policy_reward_mean": {"agent_policy": 3675.176883132185, "adversary_policy": -4860.931254048874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1182.884153823161, -4162.632509902565, -3223.2255081154294, -8035.89271208903, -6779.9704592566095, -5130.362507442561, -6456.800059475952, -11134.429396091886, -6119.528655666, -8533.893294590984, -2288.521430194055, -6197.4530851758, -5086.750040544011, -9556.393478112768, -8710.483738155644, -8873.728293021704, -8824.528528425131, -8567.572094527666, -5294.444619924618, -6272.163349404653, -5158.937782455464, -3719.743451319118, -7244.357628549774, -9696.2475051519, -7470.033673159397, -4031.9005221462303, -6235.869721982604, -4372.3817432299875, -6908.464295370896, -5337.871725646377, -6291.635837143556, -4861.342662356066, -7022.134390087882, -7902.41308506275, -4892.988218828698, -5971.6313387000655, -4005.268015153384, -5607.357968533119, -6211.995347025583, -9384.700826415848, -2364.7789709205213, -5089.367221663714, -5118.430668110352, -2750.568545745603, -7688.308813171369, -5905.6479635186915, -5373.581515118274, -3658.023934869883, -6951.632647235478, -206.98584781312837, -3241.1598699681813, -6345.875079009049, -8678.946355770784, -5751.5135002435545, -5731.032914911769, -4211.1324933128135, -7102.540540746385, -3121.14246045246, -2562.0425217765246, -5984.900150832929, -199.36951725062042, -7079.764816027023, -4167.467131248534, -5189.630633976203, -7580.405750116055, -10135.863660457213, -7792.052531863002, -6967.111709589295, -5815.556586307009, -6088.414472667406, -6353.652368249042, -8188.689509109174, -5035.423835122578, -8650.520348028846, -5889.19925884171, -428.35874976738324, -8742.690994573652, -6879.867612142818, -4809.55960387695, -11082.457814580179, -4161.5782140281235, -4495.726533706723, -8800.633970001329, -656.0189758232382, -8983.822618286264, -4364.330358996827, -6080.154032534528, -1623.564052955254, -8768.919244776996, -6829.6585331912975, -6960.350468467689, -2891.422284512832, -5915.992841560923, -6378.970814720156, -10174.255458241652, -7412.811809297399, -9667.696349899525, -9721.128884637563, -6274.246976071573, -6834.677503601233], "episode_lengths": [115, 200, 200, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 194, 200, 200, 74, 200, 200, 200, 77, 200, 10, 92, 200, 200, 200, 200, 200, 200, 200, 92, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 75, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [729.9130270355726, 2786.5559673831467, 2315.2297276382033, 4152.802097508683, 5526.117754856198, 3308.1126196987816, 5172.370043541044, 9187.608876511562, 4674.83735416606, 4162.694107031812, 366.53084096159523, 5226.181578183905, 3158.1643350764143, 3223.215440873118, 7381.408601909262, 6625.122530082086, 3797.198997822147, 2334.6754012240203, 3795.4405603882183, 3636.6928597218603, 2255.8023455232683, 3069.5148731872814, 2447.121294073097, 6754.7594240423805, 6374.780388115642, 1922.393608961909, 3152.679139130617, 1740.7095787491721, 5805.240227791901, 2143.9094351398553, 4018.2870586158215, 4441.8541250921135, 4768.139879957747, 6927.795405032416, 928.3278056803963, 4262.572647504261, 2751.6540156494716, 3479.988844455477, 1818.123439076985, 4025.801236693017, 1839.2934642511295, 3421.4529269073005, 1992.8654396696757, 1009.383706454256, 4530.2624171438765, 1405.042997057659, 4402.5989077476825, 792.0777596638333, 4564.919951238106, 40.97150223501714, 1307.8286048122109, 5584.681721246727, 7288.1956254663055, 2792.689006792787, 4791.588712610158, 1800.1700525529416, 2498.063445737059, 2343.9980385468225, 635.2166211267908, 2643.3434515254876, 92.30234751397377, 5065.096549912349, 2787.942856308048, 3963.111661447335, 5540.548526001881, 6722.548743591061, 6801.820073805365, 4345.720600070208, 4863.0162040237565, 3527.9988600102124, 5414.106445264015, 4785.300524677653, 1352.9439341859395, 4679.945969562245, 4212.643178506244, 119.26656503268897, 5270.175329534249, 4195.941847625761, 3187.547057004094, 1536.47511283818, 2198.9600050333083, 1614.260894366498, 8227.263465068208, 132.6368444263422, 6427.88220857493, 2756.359264936791, 1948.2955189868644, 769.8150550880716, 4824.295307199007, 4669.710830620647, 3327.6170464146708, 2361.237991546015, 3462.6267007326564, 5501.346871140964, 7142.132248821141, 5314.905115842735, 8296.477880013937, 2776.7472835449585, 5099.489966485717, 1866.2035805874555], "policy_adversary_policy_reward": [-1145.3784223192845, -767.418758539449, -4162.632509902565, -2786.5559673831467, -2379.8913440916554, -3158.5638916619773, -8033.82172479264, -4154.873084805072, -5619.481458344023, -6686.606755768783, -4102.164283858588, -4336.310843282762, -5816.382438968601, -5812.7876640483955, -9982.545210834616, -10339.493061768833, -4674.866178817712, -6119.499831014348, -4162.694107031812, -8533.893294590984, -2288.5214301940555, -366.53084096159523, -5277.260872036565, -6146.373791323139, -4869.2726015340095, -3375.641774086417, -9556.393478112768, -3223.215440873118, -7381.467203329365, -8710.425136735543, -7644.363450585418, -7854.487372518374, -8824.528528425131, -3797.198997822147, -2334.6754012240203, -8567.572094527666, -4474.888456542351, -4614.996723770484, -6272.163349404653, -3636.6928597218603, -5158.937782455464, -2255.8023455232683, -3150.4949052601696, -3638.763419246229, -7244.357628549773, -2447.121294073097, -7079.345603579668, -9371.661325614616, -6969.7587634433985, -6875.055297831643, -1923.1513988277318, -4031.1427322804075, -6235.869721982603, -3152.679139130617, -3833.3702709429017, -2279.721051036257, -6898.969364843653, -5814.735158319146, -5337.572805687572, -2144.2083550986595, -4018.2870586158215, -6291.635837143556, -4754.804473174553, -4548.392314273626, -4768.139879957747, -7022.134390087882, -6975.09345401175, -7855.115036083416, -4892.988218828698, -928.3278056803963, -5792.2941601726125, -4441.909826031714, -3674.0530067798322, -3082.8690240230226, -3502.8103023156855, -5584.5365106729105, -1818.123439076985, -6211.995347025583, -9384.700826415848, -4025.801236693017, -2129.8693443407537, -2074.203090830898, -5085.22382627851, -3425.5963222925047, -5118.430668110352, -1992.8654396696757, -1009.383706454256, -2750.568545745604, -7681.405971836476, -4537.165258478769, -5905.647963518691, -1405.042997057659, -4504.568547964421, -5271.611874901536, -792.0777596638333, -3658.023934869883, -6951.632647235476, -4564.919951238106, -40.97150223501714, -206.98584781312837, -1307.8286048122109, -3241.1598699681813, -5696.366375331723, -6234.190424924054, -8618.064940541568, -7349.07704069552, -5751.513500243556, -2792.689006792787, -4791.956915789578, -5730.664711732349, -2102.913273706037, -3908.3892721597163, -7102.540540746384, -2498.063445737059, -2855.313714519523, -2609.826784479759, -635.2166211267908, -2562.0425217765255, -2643.3434515254876, -5984.900150832933, -105.0558195742877, -186.6160451903065, -7076.476819716888, -5068.384546222485, -3613.1051552619974, -3342.3048322945842, -4996.3244313427385, -4156.417864080796, -5543.6185585146895, -7577.335717603247, -6722.548743591061, -10135.863660457213, -7135.657483471194, -7458.2151221971735, -4641.918347925464, -6670.913961734038, -5059.559683887672, -5619.013106443095, -5946.259961158419, -3670.153371519197, -5772.813474601507, -5994.9453389115515, -8188.689509109175, -4785.300524677653, -5035.423835122578, -1352.9439341859395, -8573.161322667736, -4757.304994923351, -4376.703181592493, -5725.13925575546, -428.35874976738324, -119.26656503268897, -5270.175329534249, -8742.690994573652, -6879.867612142818, -4195.941847625761, -3189.865276424048, -4807.241384456996, -1536.47511283818, -11082.457814580179, -4160.684216935385, -2199.854002126047, -3260.561422921355, -2849.4260051518654, -8748.108092196337, -8279.789342873204, -132.6368444263422, -656.0189758232382, -8983.822618286264, -6427.88220857493, -2980.04699642505, -4140.642627508568, -6080.154032534529, -1948.2955189868644, -1623.564052955254, -769.8150550880716, -4824.295307199007, -8768.919244776996, -4703.931925895086, -6795.437437916863, -3401.4385216165547, -6886.528993265804, -2729.5081772216013, -2523.1520988372463, -3999.0478607163823, -5379.5716815771975, -5531.136703095553, -6349.180982765568, -10174.25545824165, -7142.132248821141, -6145.718262609963, -6581.998662530173, -9654.17910106139, -8309.995128852072, -9721.128884637563, -2776.7472835449585, -5839.382843600282, -5534.354098957005, -6834.677503601234, -1866.2035805874555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41274059397142693, "mean_inference_ms": 1.012095504860807, "mean_action_processing_ms": 0.17361436927741067, "mean_env_wait_ms": 0.05348731880699043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475189208984375, "StateBufferConnector_ms": 0.002408266067504883, "ViewRequirementAgentConnector_ms": 0.06781876087188721}, "num_episodes": 22, "episode_return_max": -199.36951725062042, "episode_return_min": -11134.429396091886, "episode_return_mean": -6046.685624965562}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.405764122055, "num_env_steps_trained_throughput_per_sec": 552.405764122055, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7251.575, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7251.542, "sample_time_ms": 786.105, "learn_time_ms": 6455.0, "learn_throughput": 619.675, "synch_weights_time_ms": 9.944}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-12", "timestamp": 1723231632, "time_this_iter_s": 7.244485139846802, "time_total_s": 65.29545402526855, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a4a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.29545402526855, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.036363636363635, "ram_util_percent": 77.83636363636366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7018955769793441, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994272464513779, "policy_loss": 5.198010039748624e-05, "vf_loss": 9.989143906037013, "vf_explained_var": -1.9195427497227988e-05, "kl": 0.01128123889163059, "entropy": 1.5005904567738375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6867909661203465, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992230660574776, "policy_loss": -0.0045828704757951005, "vf_loss": 9.994446514775513, "vf_explained_var": -0.0001563087026908915, "kl": 0.011835079313940787, "entropy": 1.5899481245449611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -199.36951725062042, "episode_reward_min": -11082.457814580179, "episode_reward_mean": -6103.3609770472885, "episode_len_mean": 185.53, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18553, "policy_reward_min": {"agent_policy": 40.97150223501714, "adversary_policy": -11082.457814580179}, "policy_reward_max": {"agent_policy": 8296.477880013937, "adversary_policy": -40.97150223501714}, "policy_reward_mean": {"agent_policy": 3774.7795691611364, "adversary_policy": -4939.070273104212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3719.743451319118, -7244.357628549774, -9696.2475051519, -7470.033673159397, -4031.9005221462303, -6235.869721982604, -4372.3817432299875, -6908.464295370896, -5337.871725646377, -6291.635837143556, -4861.342662356066, -7022.134390087882, -7902.41308506275, -4892.988218828698, -5971.6313387000655, -4005.268015153384, -5607.357968533119, -6211.995347025583, -9384.700826415848, -2364.7789709205213, -5089.367221663714, -5118.430668110352, -2750.568545745603, -7688.308813171369, -5905.6479635186915, -5373.581515118274, -3658.023934869883, -6951.632647235478, -206.98584781312837, -3241.1598699681813, -6345.875079009049, -8678.946355770784, -5751.5135002435545, -5731.032914911769, -4211.1324933128135, -7102.540540746385, -3121.14246045246, -2562.0425217765246, -5984.900150832929, -199.36951725062042, -7079.764816027023, -4167.467131248534, -5189.630633976203, -7580.405750116055, -10135.863660457213, -7792.052531863002, -6967.111709589295, -5815.556586307009, -6088.414472667406, -6353.652368249042, -8188.689509109174, -5035.423835122578, -8650.520348028846, -5889.19925884171, -428.35874976738324, -8742.690994573652, -6879.867612142818, -4809.55960387695, -11082.457814580179, -4161.5782140281235, -4495.726533706723, -8800.633970001329, -656.0189758232382, -8983.822618286264, -4364.330358996827, -6080.154032534528, -1623.564052955254, -8768.919244776996, -6829.6585331912975, -6960.350468467689, -2891.422284512832, -5915.992841560923, -6378.970814720156, -10174.255458241652, -7412.811809297399, -9667.696349899525, -9721.128884637563, -6274.246976071573, -6834.677503601233, -5171.263779785763, -4681.994622184108, -6480.338290415964, -6038.712668550548, -10218.310162005615, -7846.146055764947, -5079.168954576456, -6230.35601703147, -7166.590633474727, -8647.971870867173, -6637.960587904138, -6052.1174671357785, -5716.123114736644, -5705.414764783861, -6075.112766064008, -4921.126424770805, -7008.093186669153, -3262.7354282009683, -10575.936352951216, -10161.520121999163, -7581.137634695774], "episode_lengths": [200, 200, 200, 200, 200, 200, 194, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 194, 200, 200, 74, 200, 200, 200, 77, 200, 10, 92, 200, 200, 200, 200, 200, 200, 200, 92, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 75, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200], "policy_agent_policy_reward": [3069.5148731872814, 2447.121294073097, 6754.7594240423805, 6374.780388115642, 1922.393608961909, 3152.679139130617, 1740.7095787491721, 5805.240227791901, 2143.9094351398553, 4018.2870586158215, 4441.8541250921135, 4768.139879957747, 6927.795405032416, 928.3278056803963, 4262.572647504261, 2751.6540156494716, 3479.988844455477, 1818.123439076985, 4025.801236693017, 1839.2934642511295, 3421.4529269073005, 1992.8654396696757, 1009.383706454256, 4530.2624171438765, 1405.042997057659, 4402.5989077476825, 792.0777596638333, 4564.919951238106, 40.97150223501714, 1307.8286048122109, 5584.681721246727, 7288.1956254663055, 2792.689006792787, 4791.588712610158, 1800.1700525529416, 2498.063445737059, 2343.9980385468225, 635.2166211267908, 2643.3434515254876, 92.30234751397377, 5065.096549912349, 2787.942856308048, 3963.111661447335, 5540.548526001881, 6722.548743591061, 6801.820073805365, 4345.720600070208, 4863.0162040237565, 3527.9988600102124, 5414.106445264015, 4785.300524677653, 1352.9439341859395, 4679.945969562245, 4212.643178506244, 119.26656503268897, 5270.175329534249, 4195.941847625761, 3187.547057004094, 1536.47511283818, 2198.9600050333083, 1614.260894366498, 8227.263465068208, 132.6368444263422, 6427.88220857493, 2756.359264936791, 1948.2955189868644, 769.8150550880716, 4824.295307199007, 4669.710830620647, 3327.6170464146708, 2361.237991546015, 3462.6267007326564, 5501.346871140964, 7142.132248821141, 5314.905115842735, 8296.477880013937, 2776.7472835449585, 5099.489966485717, 1866.2035805874555, 4478.92429680574, 2036.1119395962921, 5411.20642339552, 5224.610616525741, 7633.251729829819, 5231.90211906102, 4006.334788734343, 4312.20374393014, 4395.3960065133215, 3881.790028221383, 4688.100379136953, 4262.01420645432, 4672.252306113098, 3804.125987205728, 3098.5743395843224, 1682.1968509702253, 4080.242162802611, 2081.559615312904, 6436.750249097599, 7464.903304429594, 4894.492576311428], "policy_adversary_policy_reward": [-3150.4949052601696, -3638.763419246229, -7244.357628549773, -2447.121294073097, -7079.345603579668, -9371.661325614616, -6969.7587634433985, -6875.055297831643, -1923.1513988277318, -4031.1427322804075, -6235.869721982603, -3152.679139130617, -3833.3702709429017, -2279.721051036257, -6898.969364843653, -5814.735158319146, -5337.572805687572, -2144.2083550986595, -4018.2870586158215, -6291.635837143556, -4754.804473174553, -4548.392314273626, -4768.139879957747, -7022.134390087882, -6975.09345401175, -7855.115036083416, -4892.988218828698, -928.3278056803963, -5792.2941601726125, -4441.909826031714, -3674.0530067798322, -3082.8690240230226, -3502.8103023156855, -5584.5365106729105, -1818.123439076985, -6211.995347025583, -9384.700826415848, -4025.801236693017, -2129.8693443407537, -2074.203090830898, -5085.22382627851, -3425.5963222925047, -5118.430668110352, -1992.8654396696757, -1009.383706454256, -2750.568545745604, -7681.405971836476, -4537.165258478769, -5905.647963518691, -1405.042997057659, -4504.568547964421, -5271.611874901536, -792.0777596638333, -3658.023934869883, -6951.632647235476, -4564.919951238106, -40.97150223501714, -206.98584781312837, -1307.8286048122109, -3241.1598699681813, -5696.366375331723, -6234.190424924054, -8618.064940541568, -7349.07704069552, -5751.513500243556, -2792.689006792787, -4791.956915789578, -5730.664711732349, -2102.913273706037, -3908.3892721597163, -7102.540540746384, -2498.063445737059, -2855.313714519523, -2609.826784479759, -635.2166211267908, -2562.0425217765255, -2643.3434515254876, -5984.900150832933, -105.0558195742877, -186.6160451903065, -7076.476819716888, -5068.384546222485, -3613.1051552619974, -3342.3048322945842, -4996.3244313427385, -4156.417864080796, -5543.6185585146895, -7577.335717603247, -6722.548743591061, -10135.863660457213, -7135.657483471194, -7458.2151221971735, -4641.918347925464, -6670.913961734038, -5059.559683887672, -5619.013106443095, -5946.259961158419, -3670.153371519197, -5772.813474601507, -5994.9453389115515, -8188.689509109175, -4785.300524677653, -5035.423835122578, -1352.9439341859395, -8573.161322667736, -4757.304994923351, -4376.703181592493, -5725.13925575546, -428.35874976738324, -119.26656503268897, -5270.175329534249, -8742.690994573652, -6879.867612142818, -4195.941847625761, -3189.865276424048, -4807.241384456996, -1536.47511283818, -11082.457814580179, -4160.684216935385, -2199.854002126047, -3260.561422921355, -2849.4260051518654, -8748.108092196337, -8279.789342873204, -132.6368444263422, -656.0189758232382, -8983.822618286264, -6427.88220857493, -2980.04699642505, -4140.642627508568, -6080.154032534529, -1948.2955189868644, -1623.564052955254, -769.8150550880716, -4824.295307199007, -8768.919244776996, -4703.931925895086, -6795.437437916863, -3401.4385216165547, -6886.528993265804, -2729.5081772216013, -2523.1520988372463, -3999.0478607163823, -5379.5716815771975, -5531.136703095553, -6349.180982765568, -10174.25545824165, -7142.132248821141, -6145.718262609963, -6581.998662530173, -9654.17910106139, -8309.995128852072, -9721.128884637563, -2776.7472835449585, -5839.382843600282, -5534.354098957005, -6834.677503601234, -1866.2035805874555, -5009.249713221931, -4640.938363369572, -2036.1119395962921, -4681.994622184108, -6456.582013071444, -5434.96270074004, -5615.2162508511465, -5648.107034225141, -7633.251729829819, -10218.310162005615, -5254.578249810558, -7823.4699250154035, -4781.263470124022, -4304.240273186779, -5733.9711652555725, -4808.58859570604, -7165.754567705023, -4396.2320722830245, -3889.219268188077, -8640.54263090048, -4824.569246642469, -6501.491720398622, -4263.086771593111, -6051.044901996987, -5020.0362410666075, -5368.339179783134, -5443.431953151485, -4066.1087988381046, -3098.5743395843224, -6075.112766064008, -1682.1968509702253, -4921.126424770805, -7008.0931866691535, -4080.242162802611, -2082.4519438457987, -3261.843099668074, -6436.750249097599, -10575.936352951216, -7464.903304429594, -10161.520121999163, -4894.492576311428, -7581.137634695775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41369903669209684, "mean_inference_ms": 1.0116124118004024, "mean_action_processing_ms": 0.1736154738548668, "mean_env_wait_ms": 0.05330598299457431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035120248794555664, "StateBufferConnector_ms": 0.0026673078536987305, "ViewRequirementAgentConnector_ms": 0.08340275287628174}, "num_episodes": 21, "episode_return_max": -199.36951725062042, "episode_return_min": -11082.457814580179, "episode_return_mean": -6103.3609770472885}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 528.7405572791324, "num_env_steps_trained_throughput_per_sec": 528.7405572791324, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 7282.933, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7282.9, "sample_time_ms": 821.268, "learn_time_ms": 6451.198, "learn_throughput": 620.04, "synch_weights_time_ms": 9.951}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-20", "timestamp": 1723231640, "time_this_iter_s": 7.567899703979492, "time_total_s": 72.86335372924805, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327abf280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.86335372924805, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.04545454545455, "ram_util_percent": 77.96363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7284970279938231, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.982595626513163, "policy_loss": 0.0015507500516832805, "vf_loss": 9.975502484043439, "vf_explained_var": -0.0001580873504281044, "kl": 0.01231651571385252, "entropy": 1.4506231779853502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6961208777610587, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983943113700423, "policy_loss": -0.006224786292111117, "vf_loss": 9.987250135815334, "vf_explained_var": -0.00010391429618552879, "kl": 0.014589004180635566, "entropy": 1.599814397317392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -199.36951725062042, "episode_reward_min": -11082.457814580179, "episode_reward_mean": -6275.988716339552, "episode_len_mean": 181.39, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18139, "policy_reward_min": {"agent_policy": 12.101104445587415, "adversary_policy": -11082.457814580179}, "policy_reward_max": {"agent_policy": 8668.12748457827, "adversary_policy": -12.101104445587415}, "policy_reward_mean": {"agent_policy": 3834.2332773062003, "adversary_policy": -5055.1109968228775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2750.568545745603, -7688.308813171369, -5905.6479635186915, -5373.581515118274, -3658.023934869883, -6951.632647235478, -206.98584781312837, -3241.1598699681813, -6345.875079009049, -8678.946355770784, -5751.5135002435545, -5731.032914911769, -4211.1324933128135, -7102.540540746385, -3121.14246045246, -2562.0425217765246, -5984.900150832929, -199.36951725062042, -7079.764816027023, -4167.467131248534, -5189.630633976203, -7580.405750116055, -10135.863660457213, -7792.052531863002, -6967.111709589295, -5815.556586307009, -6088.414472667406, -6353.652368249042, -8188.689509109174, -5035.423835122578, -8650.520348028846, -5889.19925884171, -428.35874976738324, -8742.690994573652, -6879.867612142818, -4809.55960387695, -11082.457814580179, -4161.5782140281235, -4495.726533706723, -8800.633970001329, -656.0189758232382, -8983.822618286264, -4364.330358996827, -6080.154032534528, -1623.564052955254, -8768.919244776996, -6829.6585331912975, -6960.350468467689, -2891.422284512832, -5915.992841560923, -6378.970814720156, -10174.255458241652, -7412.811809297399, -9667.696349899525, -9721.128884637563, -6274.246976071573, -6834.677503601233, -5171.263779785763, -4681.994622184108, -6480.338290415964, -6038.712668550548, -10218.310162005615, -7846.146055764947, -5079.168954576456, -6230.35601703147, -7166.590633474727, -8647.971870867173, -6637.960587904138, -6052.1174671357785, -5716.123114736644, -5705.414764783861, -6075.112766064008, -4921.126424770805, -7008.093186669153, -3262.7354282009683, -10575.936352951216, -10161.520121999163, -7581.137634695774, -6444.233818166579, -9788.54867617828, -9773.633476953939, -8129.203061015205, -9705.701332194647, -6987.034132772635, -7317.41274115019, -6485.465328261838, -5824.862841885328, -217.90145721909713, -6396.690687610964, -10914.838157548997, -9021.420271450741, -4848.512390655709, -1542.7310033212234, -6571.555075298295, -8120.803197221528, -7107.093933492799, -7079.3397077753725, -6440.759471109767, -6163.692734300007, -2122.255250201234], "episode_lengths": [74, 200, 200, 200, 77, 200, 10, 92, 200, 200, 200, 200, 200, 200, 200, 92, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 75, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 170, 6, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 84], "policy_agent_policy_reward": [1009.383706454256, 4530.2624171438765, 1405.042997057659, 4402.5989077476825, 792.0777596638333, 4564.919951238106, 40.97150223501714, 1307.8286048122109, 5584.681721246727, 7288.1956254663055, 2792.689006792787, 4791.588712610158, 1800.1700525529416, 2498.063445737059, 2343.9980385468225, 635.2166211267908, 2643.3434515254876, 92.30234751397377, 5065.096549912349, 2787.942856308048, 3963.111661447335, 5540.548526001881, 6722.548743591061, 6801.820073805365, 4345.720600070208, 4863.0162040237565, 3527.9988600102124, 5414.106445264015, 4785.300524677653, 1352.9439341859395, 4679.945969562245, 4212.643178506244, 119.26656503268897, 5270.175329534249, 4195.941847625761, 3187.547057004094, 1536.47511283818, 2198.9600050333083, 1614.260894366498, 8227.263465068208, 132.6368444263422, 6427.88220857493, 2756.359264936791, 1948.2955189868644, 769.8150550880716, 4824.295307199007, 4669.710830620647, 3327.6170464146708, 2361.237991546015, 3462.6267007326564, 5501.346871140964, 7142.132248821141, 5314.905115842735, 8296.477880013937, 2776.7472835449585, 5099.489966485717, 1866.2035805874555, 4478.92429680574, 2036.1119395962921, 5411.20642339552, 5224.610616525741, 7633.251729829819, 5231.90211906102, 4006.334788734343, 4312.20374393014, 4395.3960065133215, 3881.790028221383, 4688.100379136953, 4262.01420645432, 4672.252306113098, 3804.125987205728, 3098.5743395843224, 1682.1968509702253, 4080.242162802611, 2081.559615312904, 6436.750249097599, 7464.903304429594, 4894.492576311428, 5737.134410211515, 3164.63097546942, 8668.12748457827, 2432.874396474441, 4705.808044606465, 5473.921922900952, 2544.705917576933, 5377.983930491152, 2699.2282687716247, 12.101104445587415, 1633.660511129712, 4940.582105340393, 7629.4893085144095, 2518.4294285596366, 241.89167663637664, 3488.641325746678, 6799.273265350933, 6513.066111041597, 1966.2377527550584, 4522.7335939397435, 1920.5206396945082, 1041.592898048661], "policy_adversary_policy_reward": [-1009.383706454256, -2750.568545745604, -7681.405971836476, -4537.165258478769, -5905.647963518691, -1405.042997057659, -4504.568547964421, -5271.611874901536, -792.0777596638333, -3658.023934869883, -6951.632647235476, -4564.919951238106, -40.97150223501714, -206.98584781312837, -1307.8286048122109, -3241.1598699681813, -5696.366375331723, -6234.190424924054, -8618.064940541568, -7349.07704069552, -5751.513500243556, -2792.689006792787, -4791.956915789578, -5730.664711732349, -2102.913273706037, -3908.3892721597163, -7102.540540746384, -2498.063445737059, -2855.313714519523, -2609.826784479759, -635.2166211267908, -2562.0425217765255, -2643.3434515254876, -5984.900150832933, -105.0558195742877, -186.6160451903065, -7076.476819716888, -5068.384546222485, -3613.1051552619974, -3342.3048322945842, -4996.3244313427385, -4156.417864080796, -5543.6185585146895, -7577.335717603247, -6722.548743591061, -10135.863660457213, -7135.657483471194, -7458.2151221971735, -4641.918347925464, -6670.913961734038, -5059.559683887672, -5619.013106443095, -5946.259961158419, -3670.153371519197, -5772.813474601507, -5994.9453389115515, -8188.689509109175, -4785.300524677653, -5035.423835122578, -1352.9439341859395, -8573.161322667736, -4757.304994923351, -4376.703181592493, -5725.13925575546, -428.35874976738324, -119.26656503268897, -5270.175329534249, -8742.690994573652, -6879.867612142818, -4195.941847625761, -3189.865276424048, -4807.241384456996, -1536.47511283818, -11082.457814580179, -4160.684216935385, -2199.854002126047, -3260.561422921355, -2849.4260051518654, -8748.108092196337, -8279.789342873204, -132.6368444263422, -656.0189758232382, -8983.822618286264, -6427.88220857493, -2980.04699642505, -4140.642627508568, -6080.154032534529, -1948.2955189868644, -1623.564052955254, -769.8150550880716, -4824.295307199007, -8768.919244776996, -4703.931925895086, -6795.437437916863, -3401.4385216165547, -6886.528993265804, -2729.5081772216013, -2523.1520988372463, -3999.0478607163823, -5379.5716815771975, -5531.136703095553, -6349.180982765568, -10174.25545824165, -7142.132248821141, -6145.718262609963, -6581.998662530173, -9654.17910106139, -8309.995128852072, -9721.128884637563, -2776.7472835449585, -5839.382843600282, -5534.354098957005, -6834.677503601234, -1866.2035805874555, -5009.249713221931, -4640.938363369572, -2036.1119395962921, -4681.994622184108, -6456.582013071444, -5434.96270074004, -5615.2162508511465, -5648.107034225141, -7633.251729829819, -10218.310162005615, -5254.578249810558, -7823.4699250154035, -4781.263470124022, -4304.240273186779, -5733.9711652555725, -4808.58859570604, -7165.754567705023, -4396.2320722830245, -3889.219268188077, -8640.54263090048, -4824.569246642469, -6501.491720398622, -4263.086771593111, -6051.044901996987, -5020.0362410666075, -5368.339179783134, -5443.431953151485, -4066.1087988381046, -3098.5743395843224, -6075.112766064008, -1682.1968509702253, -4921.126424770805, -7008.0931866691535, -4080.242162802611, -2082.4519438457987, -3261.843099668074, -6436.750249097599, -10575.936352951216, -7464.903304429594, -10161.520121999163, -4894.492576311428, -7581.137634695775, -6192.673470740706, -5988.694757637389, -3164.63097546942, -9788.54867617828, -8680.845978142055, -9760.914983390154, -8129.203061015206, -2432.874396474441, -9705.701332194645, -4705.808044606465, -6960.977667235438, -5499.978388438149, -3061.1402922268053, -6800.978366500314, -6209.269584551226, -5654.179674201762, -2699.2282687716247, -5824.862841885328, -217.90145721909713, -12.101104445587415, -5020.368363999312, -3009.9828347413645, -4940.582105340393, -10914.838157548998, -8800.834674843465, -7850.074905121684, -2556.7114135834754, -4810.23040563187, -241.89167663637664, -1542.7310033212234, -3490.4411893678152, -6569.755211677157, -6799.273265350933, -8120.803197221527, -6636.097847130126, -6984.062197404268, -7079.339707775372, -1966.2377527550584, -4536.785417598986, -6426.707647450525, -6154.5000187860605, -1929.7133552084542, -1041.592898048661, -2122.255250201234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4154564546792837, "mean_inference_ms": 1.0139600328389466, "mean_action_processing_ms": 0.17382931149966085, "mean_env_wait_ms": 0.05316159846185808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035657882690429688, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.08312666416168213}, "num_episodes": 22, "episode_return_max": -199.36951725062042, "episode_return_min": -11082.457814580179, "episode_return_mean": -6275.988716339552}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.177744302257, "num_env_steps_trained_throughput_per_sec": 558.177744302257, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 7195.166, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7195.134, "sample_time_ms": 817.182, "learn_time_ms": 6367.624, "learn_throughput": 628.178, "synch_weights_time_ms": 9.868}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 11, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-27", "timestamp": 1723231647, "time_this_iter_s": 7.168890953063965, "time_total_s": 80.03224468231201, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327aaf040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80.03224468231201, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.660000000000004, "ram_util_percent": 78.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7051831124660869, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992730535070102, "policy_loss": -0.003650698229224266, "vf_loss": 9.993486672639847, "vf_explained_var": -0.00010067249337832133, "kl": 0.006432372688868782, "entropy": 1.4190270182987055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6635899306447418, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995684842205552, "policy_loss": -0.0033384532137975963, "vf_loss": 9.996593220524057, "vf_explained_var": 1.0130865864022067e-05, "kl": 0.012150355848537945, "entropy": 1.5986633945394446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -135.94900100260267, "episode_reward_min": -11082.457814580179, "episode_reward_mean": -6785.701030310352, "episode_len_mean": 187.77, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18777, "policy_reward_min": {"agent_policy": 12.101104445587415, "adversary_policy": -11082.457814580179}, "policy_reward_max": {"agent_policy": 9179.401644151912, "adversary_policy": -12.101104445587415}, "policy_reward_mean": {"agent_policy": 4246.88205999403, "adversary_policy": -5516.29154515219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10135.863660457213, -7792.052531863002, -6967.111709589295, -5815.556586307009, -6088.414472667406, -6353.652368249042, -8188.689509109174, -5035.423835122578, -8650.520348028846, -5889.19925884171, -428.35874976738324, -8742.690994573652, -6879.867612142818, -4809.55960387695, -11082.457814580179, -4161.5782140281235, -4495.726533706723, -8800.633970001329, -656.0189758232382, -8983.822618286264, -4364.330358996827, -6080.154032534528, -1623.564052955254, -8768.919244776996, -6829.6585331912975, -6960.350468467689, -2891.422284512832, -5915.992841560923, -6378.970814720156, -10174.255458241652, -7412.811809297399, -9667.696349899525, -9721.128884637563, -6274.246976071573, -6834.677503601233, -5171.263779785763, -4681.994622184108, -6480.338290415964, -6038.712668550548, -10218.310162005615, -7846.146055764947, -5079.168954576456, -6230.35601703147, -7166.590633474727, -8647.971870867173, -6637.960587904138, -6052.1174671357785, -5716.123114736644, -5705.414764783861, -6075.112766064008, -4921.126424770805, -7008.093186669153, -3262.7354282009683, -10575.936352951216, -10161.520121999163, -7581.137634695774, -6444.233818166579, -9788.54867617828, -9773.633476953939, -8129.203061015205, -9705.701332194647, -6987.034132772635, -7317.41274115019, -6485.465328261838, -5824.862841885328, -217.90145721909713, -6396.690687610964, -10914.838157548997, -9021.420271450741, -4848.512390655709, -1542.7310033212234, -6571.555075298295, -8120.803197221528, -7107.093933492799, -7079.3397077753725, -6440.759471109767, -6163.692734300007, -2122.255250201234, -8032.5310353631785, -4259.458953745547, -7782.416575102606, -9220.695399483398, -6855.600628661613, -135.94900100260267, -7487.527506617018, -8624.490505664946, -6351.143136373291, -10804.953478551086, -10272.684049672589, -8234.270963011499, -5764.645535370009, -4623.815698943307, -7455.500736707847, -6936.634031275464, -8911.532579409683, -5417.997556206386, -6159.848378773057, -9625.13378668665, -7668.396124672045, -9827.678738901286], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 75, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 170, 6, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 84, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6722.548743591061, 6801.820073805365, 4345.720600070208, 4863.0162040237565, 3527.9988600102124, 5414.106445264015, 4785.300524677653, 1352.9439341859395, 4679.945969562245, 4212.643178506244, 119.26656503268897, 5270.175329534249, 4195.941847625761, 3187.547057004094, 1536.47511283818, 2198.9600050333083, 1614.260894366498, 8227.263465068208, 132.6368444263422, 6427.88220857493, 2756.359264936791, 1948.2955189868644, 769.8150550880716, 4824.295307199007, 4669.710830620647, 3327.6170464146708, 2361.237991546015, 3462.6267007326564, 5501.346871140964, 7142.132248821141, 5314.905115842735, 8296.477880013937, 2776.7472835449585, 5099.489966485717, 1866.2035805874555, 4478.92429680574, 2036.1119395962921, 5411.20642339552, 5224.610616525741, 7633.251729829819, 5231.90211906102, 4006.334788734343, 4312.20374393014, 4395.3960065133215, 3881.790028221383, 4688.100379136953, 4262.01420645432, 4672.252306113098, 3804.125987205728, 3098.5743395843224, 1682.1968509702253, 4080.242162802611, 2081.559615312904, 6436.750249097599, 7464.903304429594, 4894.492576311428, 5737.134410211515, 3164.63097546942, 8668.12748457827, 2432.874396474441, 4705.808044606465, 5473.921922900952, 2544.705917576933, 5377.983930491152, 2699.2282687716247, 12.101104445587415, 1633.660511129712, 4940.582105340393, 7629.4893085144095, 2518.4294285596366, 241.89167663637664, 3488.641325746678, 6799.273265350933, 6513.066111041597, 1966.2377527550584, 4522.7335939397435, 1920.5206396945082, 1041.592898048661, 4994.01209026533, 3470.464855400777, 6904.19470258531, 2666.1923249530246, 5962.709815287816, 42.22195279182752, 6102.077303200512, 6538.144135475947, 4338.692974125628, 3632.977282159848, 9179.401644151912, 3885.2451920891654, 1850.200899117651, 3102.4311795526546, 4764.975910373595, 5913.620317523608, 7964.322102096817, 3385.8406815419853, 4512.072244330644, 2799.694175249632, 6330.317643850279, 8805.103305800269], "policy_adversary_policy_reward": [-6722.548743591061, -10135.863660457213, -7135.657483471194, -7458.2151221971735, -4641.918347925464, -6670.913961734038, -5059.559683887672, -5619.013106443095, -5946.259961158419, -3670.153371519197, -5772.813474601507, -5994.9453389115515, -8188.689509109175, -4785.300524677653, -5035.423835122578, -1352.9439341859395, -8573.161322667736, -4757.304994923351, -4376.703181592493, -5725.13925575546, -428.35874976738324, -119.26656503268897, -5270.175329534249, -8742.690994573652, -6879.867612142818, -4195.941847625761, -3189.865276424048, -4807.241384456996, -1536.47511283818, -11082.457814580179, -4160.684216935385, -2199.854002126047, -3260.561422921355, -2849.4260051518654, -8748.108092196337, -8279.789342873204, -132.6368444263422, -656.0189758232382, -8983.822618286264, -6427.88220857493, -2980.04699642505, -4140.642627508568, -6080.154032534529, -1948.2955189868644, -1623.564052955254, -769.8150550880716, -4824.295307199007, -8768.919244776996, -4703.931925895086, -6795.437437916863, -3401.4385216165547, -6886.528993265804, -2729.5081772216013, -2523.1520988372463, -3999.0478607163823, -5379.5716815771975, -5531.136703095553, -6349.180982765568, -10174.25545824165, -7142.132248821141, -6145.718262609963, -6581.998662530173, -9654.17910106139, -8309.995128852072, -9721.128884637563, -2776.7472835449585, -5839.382843600282, -5534.354098957005, -6834.677503601234, -1866.2035805874555, -5009.249713221931, -4640.938363369572, -2036.1119395962921, -4681.994622184108, -6456.582013071444, -5434.96270074004, -5615.2162508511465, -5648.107034225141, -7633.251729829819, -10218.310162005615, -5254.578249810558, -7823.4699250154035, -4781.263470124022, -4304.240273186779, -5733.9711652555725, -4808.58859570604, -7165.754567705023, -4396.2320722830245, -3889.219268188077, -8640.54263090048, -4824.569246642469, -6501.491720398622, -4263.086771593111, -6051.044901996987, -5020.0362410666075, -5368.339179783134, -5443.431953151485, -4066.1087988381046, -3098.5743395843224, -6075.112766064008, -1682.1968509702253, -4921.126424770805, -7008.0931866691535, -4080.242162802611, -2082.4519438457987, -3261.843099668074, -6436.750249097599, -10575.936352951216, -7464.903304429594, -10161.520121999163, -4894.492576311428, -7581.137634695775, -6192.673470740706, -5988.694757637389, -3164.63097546942, -9788.54867617828, -8680.845978142055, -9760.914983390154, -8129.203061015206, -2432.874396474441, -9705.701332194645, -4705.808044606465, -6960.977667235438, -5499.978388438149, -3061.1402922268053, -6800.978366500314, -6209.269584551226, -5654.179674201762, -2699.2282687716247, -5824.862841885328, -217.90145721909713, -12.101104445587415, -5020.368363999312, -3009.9828347413645, -4940.582105340393, -10914.838157548998, -8800.834674843465, -7850.074905121684, -2556.7114135834754, -4810.23040563187, -241.89167663637664, -1542.7310033212234, -3490.4411893678152, -6569.755211677157, -6799.273265350933, -8120.803197221527, -6636.097847130126, -6984.062197404268, -7079.339707775372, -1966.2377527550584, -4536.785417598986, -6426.707647450525, -6154.5000187860605, -1929.7133552084542, -1041.592898048661, -2122.255250201234, -4994.01209026533, -8032.5310353631785, -4224.2013251741255, -3505.722483972199, -7454.747417694826, -7231.863859993086, -9220.695399483398, -2666.1923249530246, -6049.050838046406, -6769.259605903023, -42.22195279182752, -135.94900100260267, -6137.53405576017, -7452.0707540573585, -6538.144135475947, -8624.490505664946, -4340.772391184261, -6349.063719314658, -3632.977282159848, -10804.953478551084, -10131.940656329778, -9320.145037494725, -7092.478942234558, -5027.03721286611, -1850.200899117651, -5764.645535370009, -4623.815698943308, -3102.4311795526546, -6349.2281087665115, -5871.248538314929, -6807.213686240182, -6043.040662558887, -8797.682412483233, -8078.172269023268, -5241.445555575953, -3562.392682172427, -5518.55757827723, -5153.363044826464, -9625.13378668665, -2799.694175249632, -7667.955984284527, -6330.757784237799, -9763.054971066127, -8869.727073635431]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41763784705989876, "mean_inference_ms": 1.019371613318938, "mean_action_processing_ms": 0.1746356750245184, "mean_env_wait_ms": 0.053387494470767266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00355684757232666, "StateBufferConnector_ms": 0.0028187036514282227, "ViewRequirementAgentConnector_ms": 0.08816695213317871}, "num_episodes": 22, "episode_return_max": -135.94900100260267, "episode_return_min": -11082.457814580179, "episode_return_mean": -6785.701030310352}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 559.3009378346195, "num_env_steps_trained_throughput_per_sec": 559.3009378346195, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7205.301, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7205.269, "sample_time_ms": 808.661, "learn_time_ms": 6386.067, "learn_throughput": 626.364, "synch_weights_time_ms": 10.071}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 12, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-34", "timestamp": 1723231654, "time_this_iter_s": 7.15490984916687, "time_total_s": 87.18715453147888, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ea05e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.18715453147888, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.672727272727272, "ram_util_percent": 78.15454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6863676902061949, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991797951857249, "policy_loss": 0.0007231378915700285, "vf_loss": 9.9863132139047, "vf_explained_var": -3.253786514202754e-05, "kl": 0.01058129806284948, "entropy": 1.4425028063356877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7085994516100202, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991980879142801, "policy_loss": -0.0037174172466620803, "vf_loss": 9.993184998426488, "vf_explained_var": 5.1740994529118614e-05, "kl": 0.012566504926573505, "entropy": 1.5915872834346914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -135.94900100260267, "episode_reward_min": -11079.482961023954, "episode_reward_mean": -6986.258623591733, "episode_len_mean": 186.68, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18668, "policy_reward_min": {"agent_policy": 8.684364518716157, "adversary_policy": -11079.482961023956}, "policy_reward_max": {"agent_policy": 9179.401644151912, "adversary_policy": -8.684364518716157}, "policy_reward_mean": {"agent_policy": 4311.85298795772, "adversary_policy": -5649.055805774727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1623.564052955254, -8768.919244776996, -6829.6585331912975, -6960.350468467689, -2891.422284512832, -5915.992841560923, -6378.970814720156, -10174.255458241652, -7412.811809297399, -9667.696349899525, -9721.128884637563, -6274.246976071573, -6834.677503601233, -5171.263779785763, -4681.994622184108, -6480.338290415964, -6038.712668550548, -10218.310162005615, -7846.146055764947, -5079.168954576456, -6230.35601703147, -7166.590633474727, -8647.971870867173, -6637.960587904138, -6052.1174671357785, -5716.123114736644, -5705.414764783861, -6075.112766064008, -4921.126424770805, -7008.093186669153, -3262.7354282009683, -10575.936352951216, -10161.520121999163, -7581.137634695774, -6444.233818166579, -9788.54867617828, -9773.633476953939, -8129.203061015205, -9705.701332194647, -6987.034132772635, -7317.41274115019, -6485.465328261838, -5824.862841885328, -217.90145721909713, -6396.690687610964, -10914.838157548997, -9021.420271450741, -4848.512390655709, -1542.7310033212234, -6571.555075298295, -8120.803197221528, -7107.093933492799, -7079.3397077753725, -6440.759471109767, -6163.692734300007, -2122.255250201234, -8032.5310353631785, -4259.458953745547, -7782.416575102606, -9220.695399483398, -6855.600628661613, -135.94900100260267, -7487.527506617018, -8624.490505664946, -6351.143136373291, -10804.953478551086, -10272.684049672589, -8234.270963011499, -5764.645535370009, -4623.815698943307, -7455.500736707847, -6936.634031275464, -8911.532579409683, -5417.997556206386, -6159.848378773057, -9625.13378668665, -7668.396124672045, -9827.678738901286, -9815.631279190251, -4436.1644308146215, -7672.124599002975, -7471.275038985261, -2022.536368463268, -7905.814140909957, -8090.53522232538, -7632.4188597335005, -3843.1973049366525, -7979.429531359928, -8787.626955739988, -8725.823073441032, -8292.08626370723, -6169.182756794117, -9432.367640362638, -8666.25476589837, -7908.09106839353, -9139.536088472112, -11079.482961023954, -5538.6344429267765, -9676.664277139062, -172.5660170709618], "episode_lengths": [75, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 170, 6, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 84, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4], "policy_agent_policy_reward": [769.8150550880716, 4824.295307199007, 4669.710830620647, 3327.6170464146708, 2361.237991546015, 3462.6267007326564, 5501.346871140964, 7142.132248821141, 5314.905115842735, 8296.477880013937, 2776.7472835449585, 5099.489966485717, 1866.2035805874555, 4478.92429680574, 2036.1119395962921, 5411.20642339552, 5224.610616525741, 7633.251729829819, 5231.90211906102, 4006.334788734343, 4312.20374393014, 4395.3960065133215, 3881.790028221383, 4688.100379136953, 4262.01420645432, 4672.252306113098, 3804.125987205728, 3098.5743395843224, 1682.1968509702253, 4080.242162802611, 2081.559615312904, 6436.750249097599, 7464.903304429594, 4894.492576311428, 5737.134410211515, 3164.63097546942, 8668.12748457827, 2432.874396474441, 4705.808044606465, 5473.921922900952, 2544.705917576933, 5377.983930491152, 2699.2282687716247, 12.101104445587415, 1633.660511129712, 4940.582105340393, 7629.4893085144095, 2518.4294285596366, 241.89167663637664, 3488.641325746678, 6799.273265350933, 6513.066111041597, 1966.2377527550584, 4522.7335939397435, 1920.5206396945082, 1041.592898048661, 4994.01209026533, 3470.464855400777, 6904.19470258531, 2666.1923249530246, 5962.709815287816, 42.22195279182752, 6102.077303200512, 6538.144135475947, 4338.692974125628, 3632.977282159848, 9179.401644151912, 3885.2451920891654, 1850.200899117651, 3102.4311795526546, 4764.975910373595, 5913.620317523608, 7964.322102096817, 3385.8406815419853, 4512.072244330644, 2799.694175249632, 6330.317643850279, 8805.103305800269, 4470.632317234494, 2788.4837900970197, 5181.764331880587, 5433.904396417672, 352.8474452478696, 1513.5083219426394, 6856.98129940344, 2477.1227733631645, 721.2463164318583, 6096.899290544689, 5486.675379055709, 7384.948317330895, 7155.922572936845, 1944.168511022486, 3743.4235144502004, 3073.068078959967, 5742.095260592175, 8548.475610514872, 4660.251265253131, 2544.3378101464914, 4632.760476148653, 8.684364518716157], "policy_adversary_policy_reward": [-1623.564052955254, -769.8150550880716, -4824.295307199007, -8768.919244776996, -4703.931925895086, -6795.437437916863, -3401.4385216165547, -6886.528993265804, -2729.5081772216013, -2523.1520988372463, -3999.0478607163823, -5379.5716815771975, -5531.136703095553, -6349.180982765568, -10174.25545824165, -7142.132248821141, -6145.718262609963, -6581.998662530173, -9654.17910106139, -8309.995128852072, -9721.128884637563, -2776.7472835449585, -5839.382843600282, -5534.354098957005, -6834.677503601234, -1866.2035805874555, -5009.249713221931, -4640.938363369572, -2036.1119395962921, -4681.994622184108, -6456.582013071444, -5434.96270074004, -5615.2162508511465, -5648.107034225141, -7633.251729829819, -10218.310162005615, -5254.578249810558, -7823.4699250154035, -4781.263470124022, -4304.240273186779, -5733.9711652555725, -4808.58859570604, -7165.754567705023, -4396.2320722830245, -3889.219268188077, -8640.54263090048, -4824.569246642469, -6501.491720398622, -4263.086771593111, -6051.044901996987, -5020.0362410666075, -5368.339179783134, -5443.431953151485, -4066.1087988381046, -3098.5743395843224, -6075.112766064008, -1682.1968509702253, -4921.126424770805, -7008.0931866691535, -4080.242162802611, -2082.4519438457987, -3261.843099668074, -6436.750249097599, -10575.936352951216, -7464.903304429594, -10161.520121999163, -4894.492576311428, -7581.137634695775, -6192.673470740706, -5988.694757637389, -3164.63097546942, -9788.54867617828, -8680.845978142055, -9760.914983390154, -8129.203061015206, -2432.874396474441, -9705.701332194645, -4705.808044606465, -6960.977667235438, -5499.978388438149, -3061.1402922268053, -6800.978366500314, -6209.269584551226, -5654.179674201762, -2699.2282687716247, -5824.862841885328, -217.90145721909713, -12.101104445587415, -5020.368363999312, -3009.9828347413645, -4940.582105340393, -10914.838157548998, -8800.834674843465, -7850.074905121684, -2556.7114135834754, -4810.23040563187, -241.89167663637664, -1542.7310033212234, -3490.4411893678152, -6569.755211677157, -6799.273265350933, -8120.803197221527, -6636.097847130126, -6984.062197404268, -7079.339707775372, -1966.2377527550584, -4536.785417598986, -6426.707647450525, -6154.5000187860605, -1929.7133552084542, -1041.592898048661, -2122.255250201234, -4994.01209026533, -8032.5310353631785, -4224.2013251741255, -3505.722483972199, -7454.747417694826, -7231.863859993086, -9220.695399483398, -2666.1923249530246, -6049.050838046406, -6769.259605903023, -42.22195279182752, -135.94900100260267, -6137.53405576017, -7452.0707540573585, -6538.144135475947, -8624.490505664946, -4340.772391184261, -6349.063719314658, -3632.977282159848, -10804.953478551084, -10131.940656329778, -9320.145037494725, -7092.478942234558, -5027.03721286611, -1850.200899117651, -5764.645535370009, -4623.815698943308, -3102.4311795526546, -6349.2281087665115, -5871.248538314929, -6807.213686240182, -6043.040662558887, -8797.682412483233, -8078.172269023268, -5241.445555575953, -3562.392682172427, -5518.55757827723, -5153.363044826464, -9625.13378668665, -2799.694175249632, -7667.955984284527, -6330.757784237799, -9763.054971066127, -8869.727073635431, -9815.631279190251, -4470.632317234494, -3970.432121943104, -3254.2160989685367, -5181.764331880587, -7672.124599002975, -7463.329237307484, -5441.85019809545, -2022.5363684632675, -352.8474452478696, -1513.5083219426394, -7905.814140909957, -6858.445943588027, -8089.070578140794, -2477.1227733631645, -7632.4188597335005, -721.2463164318583, -3843.1973049366525, -6683.583340696277, -7392.745481208341, -8787.626955739988, -5486.675379055709, -8083.1213045557815, -8027.650086216144, -8257.47734969489, -7190.531486949186, -6169.182756794117, -1944.168511022486, -3743.4235144502004, -9432.367640362638, -8666.254765898371, -3073.068078959967, -5742.095260592175, -7908.091068393531, -8977.211649111065, -8710.80004987592, -11079.482961023956, -4660.251265253131, -2545.4672518206094, -5537.505001252659, -4632.760476148653, -9676.664277139062, -8.684364518716157, -172.5660170709618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42051905226759806, "mean_inference_ms": 1.0256300928268234, "mean_action_processing_ms": 0.17546449277557152, "mean_env_wait_ms": 0.05354726641437365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035037994384765625, "StateBufferConnector_ms": 0.0028210878372192383, "ViewRequirementAgentConnector_ms": 0.08652043342590332}, "num_episodes": 22, "episode_return_max": -135.94900100260267, "episode_return_min": -11079.482961023954, "episode_return_mean": -6986.258623591733}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.0382617985812, "num_env_steps_trained_throughput_per_sec": 554.0382617985812, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 7224.221, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7224.189, "sample_time_ms": 801.716, "learn_time_ms": 6411.944, "learn_throughput": 623.836, "synch_weights_time_ms": 10.062}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 13, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-42", "timestamp": 1723231662, "time_this_iter_s": 7.2224297523498535, "time_total_s": 94.40958428382874, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ea0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.40958428382874, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 27.27, "ram_util_percent": 78.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7103402204190691, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985173388322194, "policy_loss": -0.001963338984448152, "vf_loss": 9.981609136859577, "vf_explained_var": -2.387911081314087e-05, "kl": 0.012283559913824623, "entropy": 1.4961081821471454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7011324485773762, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98798722211646, "policy_loss": -0.005174766449755422, "vf_loss": 9.99078468998904, "vf_explained_var": -6.325336360426807e-05, "kl": 0.011886510363085166, "entropy": 1.5882351326564002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -135.94900100260267, "episode_reward_min": -11278.004932687, "episode_reward_mean": -7019.477223739717, "episode_len_mean": 185.21, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18521, "policy_reward_min": {"agent_policy": 8.684364518716157, "adversary_policy": -11079.482961023956}, "policy_reward_max": {"agent_policy": 9179.401644151912, "adversary_policy": -8.684364518716157}, "policy_reward_mean": {"agent_policy": 4297.683935135465, "adversary_policy": -5658.58057943759}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8647.971870867173, -6637.960587904138, -6052.1174671357785, -5716.123114736644, -5705.414764783861, -6075.112766064008, -4921.126424770805, -7008.093186669153, -3262.7354282009683, -10575.936352951216, -10161.520121999163, -7581.137634695774, -6444.233818166579, -9788.54867617828, -9773.633476953939, -8129.203061015205, -9705.701332194647, -6987.034132772635, -7317.41274115019, -6485.465328261838, -5824.862841885328, -217.90145721909713, -6396.690687610964, -10914.838157548997, -9021.420271450741, -4848.512390655709, -1542.7310033212234, -6571.555075298295, -8120.803197221528, -7107.093933492799, -7079.3397077753725, -6440.759471109767, -6163.692734300007, -2122.255250201234, -8032.5310353631785, -4259.458953745547, -7782.416575102606, -9220.695399483398, -6855.600628661613, -135.94900100260267, -7487.527506617018, -8624.490505664946, -6351.143136373291, -10804.953478551086, -10272.684049672589, -8234.270963011499, -5764.645535370009, -4623.815698943307, -7455.500736707847, -6936.634031275464, -8911.532579409683, -5417.997556206386, -6159.848378773057, -9625.13378668665, -7668.396124672045, -9827.678738901286, -9815.631279190251, -4436.1644308146215, -7672.124599002975, -7471.275038985261, -2022.536368463268, -7905.814140909957, -8090.53522232538, -7632.4188597335005, -3843.1973049366525, -7979.429531359928, -8787.626955739988, -8725.823073441032, -8292.08626370723, -6169.182756794117, -9432.367640362638, -8666.25476589837, -7908.09106839353, -9139.536088472112, -11079.482961023954, -5538.6344429267765, -9676.664277139062, -172.5660170709618, -6521.8241110328345, -8140.108298635251, -5669.1130570373825, -9179.173818664403, -3905.4599294232994, -6510.115421444335, -5834.989982781467, -338.099744787575, -6233.710726519882, -8261.666119537853, -6565.869790107992, -3608.8809573153503, -6617.588941421909, -11278.004932687, -3737.5651323425786, -5523.163719050278, -7318.929028543672, -9936.35262011174, -9748.392308739702, -8726.054738831512, -9780.73269755187, -8252.640343954212], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 170, 6, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 84, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 105, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3881.790028221383, 4688.100379136953, 4262.01420645432, 4672.252306113098, 3804.125987205728, 3098.5743395843224, 1682.1968509702253, 4080.242162802611, 2081.559615312904, 6436.750249097599, 7464.903304429594, 4894.492576311428, 5737.134410211515, 3164.63097546942, 8668.12748457827, 2432.874396474441, 4705.808044606465, 5473.921922900952, 2544.705917576933, 5377.983930491152, 2699.2282687716247, 12.101104445587415, 1633.660511129712, 4940.582105340393, 7629.4893085144095, 2518.4294285596366, 241.89167663637664, 3488.641325746678, 6799.273265350933, 6513.066111041597, 1966.2377527550584, 4522.7335939397435, 1920.5206396945082, 1041.592898048661, 4994.01209026533, 3470.464855400777, 6904.19470258531, 2666.1923249530246, 5962.709815287816, 42.22195279182752, 6102.077303200512, 6538.144135475947, 4338.692974125628, 3632.977282159848, 9179.401644151912, 3885.2451920891654, 1850.200899117651, 3102.4311795526546, 4764.975910373595, 5913.620317523608, 7964.322102096817, 3385.8406815419853, 4512.072244330644, 2799.694175249632, 6330.317643850279, 8805.103305800269, 4470.632317234494, 2788.4837900970197, 5181.764331880587, 5433.904396417672, 352.8474452478696, 1513.5083219426394, 6856.98129940344, 2477.1227733631645, 721.2463164318583, 6096.899290544689, 5486.675379055709, 7384.948317330895, 7155.922572936845, 1944.168511022486, 3743.4235144502004, 3073.068078959967, 5742.095260592175, 8548.475610514872, 4660.251265253131, 2544.3378101464914, 4632.760476148653, 8.684364518716157, 4484.632098686119, 5374.408867182578, 4468.944255447169, 5096.26596002113, 2660.204509727338, 4849.902852289253, 3664.323481701466, 163.74290031715975, 3904.7983203549384, 5281.2895416902875, 4091.7334826086185, 809.9931635888014, 4984.327929632344, 9143.321467347574, 1947.4896721347286, 2482.927179333049, 4499.3305372579325, 8661.006486008357, 6350.263101056086, 3613.378292524998, 5125.731502131049, 5067.626659163374], "policy_adversary_policy_reward": [-3889.219268188077, -8640.54263090048, -4824.569246642469, -6501.491720398622, -4263.086771593111, -6051.044901996987, -5020.0362410666075, -5368.339179783134, -5443.431953151485, -4066.1087988381046, -3098.5743395843224, -6075.112766064008, -1682.1968509702253, -4921.126424770805, -7008.0931866691535, -4080.242162802611, -2082.4519438457987, -3261.843099668074, -6436.750249097599, -10575.936352951216, -7464.903304429594, -10161.520121999163, -4894.492576311428, -7581.137634695775, -6192.673470740706, -5988.694757637389, -3164.63097546942, -9788.54867617828, -8680.845978142055, -9760.914983390154, -8129.203061015206, -2432.874396474441, -9705.701332194645, -4705.808044606465, -6960.977667235438, -5499.978388438149, -3061.1402922268053, -6800.978366500314, -6209.269584551226, -5654.179674201762, -2699.2282687716247, -5824.862841885328, -217.90145721909713, -12.101104445587415, -5020.368363999312, -3009.9828347413645, -4940.582105340393, -10914.838157548998, -8800.834674843465, -7850.074905121684, -2556.7114135834754, -4810.23040563187, -241.89167663637664, -1542.7310033212234, -3490.4411893678152, -6569.755211677157, -6799.273265350933, -8120.803197221527, -6636.097847130126, -6984.062197404268, -7079.339707775372, -1966.2377527550584, -4536.785417598986, -6426.707647450525, -6154.5000187860605, -1929.7133552084542, -1041.592898048661, -2122.255250201234, -4994.01209026533, -8032.5310353631785, -4224.2013251741255, -3505.722483972199, -7454.747417694826, -7231.863859993086, -9220.695399483398, -2666.1923249530246, -6049.050838046406, -6769.259605903023, -42.22195279182752, -135.94900100260267, -6137.53405576017, -7452.0707540573585, -6538.144135475947, -8624.490505664946, -4340.772391184261, -6349.063719314658, -3632.977282159848, -10804.953478551084, -10131.940656329778, -9320.145037494725, -7092.478942234558, -5027.03721286611, -1850.200899117651, -5764.645535370009, -4623.815698943308, -3102.4311795526546, -6349.2281087665115, -5871.248538314929, -6807.213686240182, -6043.040662558887, -8797.682412483233, -8078.172269023268, -5241.445555575953, -3562.392682172427, -5518.55757827723, -5153.363044826464, -9625.13378668665, -2799.694175249632, -7667.955984284527, -6330.757784237799, -9763.054971066127, -8869.727073635431, -9815.631279190251, -4470.632317234494, -3970.432121943104, -3254.2160989685367, -5181.764331880587, -7672.124599002975, -7463.329237307484, -5441.85019809545, -2022.5363684632675, -352.8474452478696, -1513.5083219426394, -7905.814140909957, -6858.445943588027, -8089.070578140794, -2477.1227733631645, -7632.4188597335005, -721.2463164318583, -3843.1973049366525, -6683.583340696277, -7392.745481208341, -8787.626955739988, -5486.675379055709, -8083.1213045557815, -8027.650086216144, -8257.47734969489, -7190.531486949186, -6169.182756794117, -1944.168511022486, -3743.4235144502004, -9432.367640362638, -8666.254765898371, -3073.068078959967, -5742.095260592175, -7908.091068393531, -8977.211649111065, -8710.80004987592, -11079.482961023956, -4660.251265253131, -2545.4672518206094, -5537.505001252659, -4632.760476148653, -9676.664277139062, -8.684364518716157, -172.5660170709618, -6515.595268815318, -4490.860940903634, -5374.408867182578, -8140.108298635251, -4473.481730732065, -5664.575581752488, -5096.26596002113, -9179.173818664403, -2732.0553031674717, -3833.609135983166, -5078.837949833927, -6281.180323899662, -3665.0962556959907, -5834.217208786942, -163.74290031715975, -338.099744787575, -5872.839763923591, -4265.6692829512285, -5281.2895416902875, -8261.666119537853, -4368.785201889719, -6288.81807082689, -3608.8809573153503, -809.9931635888014, -6596.572165240343, -5005.34470581391, -9383.626210595648, -11037.70018943892, -2838.639969402985, -2846.4148350743217, -4830.804448863004, -3175.2864495203203, -7318.92902854367, -4499.3305372579325, -9936.352620111738, -8661.006486008357, -9748.3923087397, -6350.263101056086, -8726.05473883151, -3613.378292524998, -9780.732697551872, -5125.731502131049, -8252.640343954212, -5067.626659163374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42146371502133706, "mean_inference_ms": 1.0276942521128638, "mean_action_processing_ms": 0.17584104737240844, "mean_env_wait_ms": 0.05336274140044368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034935474395751953, "StateBufferConnector_ms": 0.0026543140411376953, "ViewRequirementAgentConnector_ms": 0.07484614849090576}, "num_episodes": 22, "episode_return_max": -135.94900100260267, "episode_return_min": -11278.004932687, "episode_return_mean": -7019.477223739717}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.8644119972988, "num_env_steps_trained_throughput_per_sec": 557.8644119972988, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 7213.724, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7213.692, "sample_time_ms": 778.689, "learn_time_ms": 6424.206, "learn_throughput": 622.645, "synch_weights_time_ms": 10.335}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 14, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-49", "timestamp": 1723231669, "time_this_iter_s": 7.174858093261719, "time_total_s": 101.58444237709045, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ea0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.58444237709045, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.26, "ram_util_percent": 78.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7075802553755541, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.980530314644177, "policy_loss": -0.0030502332437511845, "vf_loss": 9.97614489197731, "vf_explained_var": -0.00042815177390972774, "kl": 0.016523723237332887, "entropy": 1.468673999607563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.71677182617957, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988838252819404, "policy_loss": -0.001796016269227953, "vf_loss": 9.987979413088036, "vf_explained_var": -5.516829314055266e-05, "kl": 0.013274223345612722, "entropy": 1.583110558292853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -135.94900100260267, "episode_reward_min": -11278.004932687, "episode_reward_mean": -6866.994219668799, "episode_len_mean": 182.35, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18235, "policy_reward_min": {"agent_policy": 8.684364518716157, "adversary_policy": -11079.482961023956}, "policy_reward_max": {"agent_policy": 9179.401644151912, "adversary_policy": -8.684364518716157}, "policy_reward_mean": {"agent_policy": 4209.675405391156, "adversary_policy": -5538.334812529978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5824.862841885328, -217.90145721909713, -6396.690687610964, -10914.838157548997, -9021.420271450741, -4848.512390655709, -1542.7310033212234, -6571.555075298295, -8120.803197221528, -7107.093933492799, -7079.3397077753725, -6440.759471109767, -6163.692734300007, -2122.255250201234, -8032.5310353631785, -4259.458953745547, -7782.416575102606, -9220.695399483398, -6855.600628661613, -135.94900100260267, -7487.527506617018, -8624.490505664946, -6351.143136373291, -10804.953478551086, -10272.684049672589, -8234.270963011499, -5764.645535370009, -4623.815698943307, -7455.500736707847, -6936.634031275464, -8911.532579409683, -5417.997556206386, -6159.848378773057, -9625.13378668665, -7668.396124672045, -9827.678738901286, -9815.631279190251, -4436.1644308146215, -7672.124599002975, -7471.275038985261, -2022.536368463268, -7905.814140909957, -8090.53522232538, -7632.4188597335005, -3843.1973049366525, -7979.429531359928, -8787.626955739988, -8725.823073441032, -8292.08626370723, -6169.182756794117, -9432.367640362638, -8666.25476589837, -7908.09106839353, -9139.536088472112, -11079.482961023954, -5538.6344429267765, -9676.664277139062, -172.5660170709618, -6521.8241110328345, -8140.108298635251, -5669.1130570373825, -9179.173818664403, -3905.4599294232994, -6510.115421444335, -5834.989982781467, -338.099744787575, -6233.710726519882, -8261.666119537853, -6565.869790107992, -3608.8809573153503, -6617.588941421909, -11278.004932687, -3737.5651323425786, -5523.163719050278, -7318.929028543672, -9936.35262011174, -9748.392308739702, -8726.054738831512, -9780.73269755187, -8252.640343954212, -6388.729537475348, -5913.286033979639, -7813.639782028535, -8795.08242706058, -9347.198739695077, -5387.677318482692, -7792.806578690928, -4589.54056965216, -3591.0668065581585, -8779.344669878315, -4097.858107502804, -6270.211622659771, -8142.122474231084, -9341.107600459984, -8361.791193302503, -7761.03412114779, -942.7202198698308, -3114.158419092227, -7099.2944179921815, -8199.511240620412], "episode_lengths": [170, 6, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 84, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 105, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 196, 145, 200, 200, 200, 200, 200, 200, 200, 45, 97, 200, 200], "policy_agent_policy_reward": [2699.2282687716247, 12.101104445587415, 1633.660511129712, 4940.582105340393, 7629.4893085144095, 2518.4294285596366, 241.89167663637664, 3488.641325746678, 6799.273265350933, 6513.066111041597, 1966.2377527550584, 4522.7335939397435, 1920.5206396945082, 1041.592898048661, 4994.01209026533, 3470.464855400777, 6904.19470258531, 2666.1923249530246, 5962.709815287816, 42.22195279182752, 6102.077303200512, 6538.144135475947, 4338.692974125628, 3632.977282159848, 9179.401644151912, 3885.2451920891654, 1850.200899117651, 3102.4311795526546, 4764.975910373595, 5913.620317523608, 7964.322102096817, 3385.8406815419853, 4512.072244330644, 2799.694175249632, 6330.317643850279, 8805.103305800269, 4470.632317234494, 2788.4837900970197, 5181.764331880587, 5433.904396417672, 352.8474452478696, 1513.5083219426394, 6856.98129940344, 2477.1227733631645, 721.2463164318583, 6096.899290544689, 5486.675379055709, 7384.948317330895, 7155.922572936845, 1944.168511022486, 3743.4235144502004, 3073.068078959967, 5742.095260592175, 8548.475610514872, 4660.251265253131, 2544.3378101464914, 4632.760476148653, 8.684364518716157, 4484.632098686119, 5374.408867182578, 4468.944255447169, 5096.26596002113, 2660.204509727338, 4849.902852289253, 3664.323481701466, 163.74290031715975, 3904.7983203549384, 5281.2895416902875, 4091.7334826086185, 809.9931635888014, 4984.327929632344, 9143.321467347574, 1947.4896721347286, 2482.927179333049, 4499.3305372579325, 8661.006486008357, 6350.263101056086, 3613.378292524998, 5125.731502131049, 5067.626659163374, 5151.161844056222, 2972.6452911253814, 3452.6220134589526, 7418.610865183406, 5305.640014495033, 2396.7978429638542, 7149.00318535921, 1593.8190651684015, 1659.812133377796, 7045.961255735108, 2139.927547665136, 3678.3681355271256, 6090.811635089415, 5841.905733511943, 5373.852682038602, 6517.791659133673, 186.93056716233716, 1149.6325710212188, 1761.0046687671083, 3465.0374026786517], "policy_adversary_policy_reward": [-2699.2282687716247, -5824.862841885328, -217.90145721909713, -12.101104445587415, -5020.368363999312, -3009.9828347413645, -4940.582105340393, -10914.838157548998, -8800.834674843465, -7850.074905121684, -2556.7114135834754, -4810.23040563187, -241.89167663637664, -1542.7310033212234, -3490.4411893678152, -6569.755211677157, -6799.273265350933, -8120.803197221527, -6636.097847130126, -6984.062197404268, -7079.339707775372, -1966.2377527550584, -4536.785417598986, -6426.707647450525, -6154.5000187860605, -1929.7133552084542, -1041.592898048661, -2122.255250201234, -4994.01209026533, -8032.5310353631785, -4224.2013251741255, -3505.722483972199, -7454.747417694826, -7231.863859993086, -9220.695399483398, -2666.1923249530246, -6049.050838046406, -6769.259605903023, -42.22195279182752, -135.94900100260267, -6137.53405576017, -7452.0707540573585, -6538.144135475947, -8624.490505664946, -4340.772391184261, -6349.063719314658, -3632.977282159848, -10804.953478551084, -10131.940656329778, -9320.145037494725, -7092.478942234558, -5027.03721286611, -1850.200899117651, -5764.645535370009, -4623.815698943308, -3102.4311795526546, -6349.2281087665115, -5871.248538314929, -6807.213686240182, -6043.040662558887, -8797.682412483233, -8078.172269023268, -5241.445555575953, -3562.392682172427, -5518.55757827723, -5153.363044826464, -9625.13378668665, -2799.694175249632, -7667.955984284527, -6330.757784237799, -9763.054971066127, -8869.727073635431, -9815.631279190251, -4470.632317234494, -3970.432121943104, -3254.2160989685367, -5181.764331880587, -7672.124599002975, -7463.329237307484, -5441.85019809545, -2022.5363684632675, -352.8474452478696, -1513.5083219426394, -7905.814140909957, -6858.445943588027, -8089.070578140794, -2477.1227733631645, -7632.4188597335005, -721.2463164318583, -3843.1973049366525, -6683.583340696277, -7392.745481208341, -8787.626955739988, -5486.675379055709, -8083.1213045557815, -8027.650086216144, -8257.47734969489, -7190.531486949186, -6169.182756794117, -1944.168511022486, -3743.4235144502004, -9432.367640362638, -8666.254765898371, -3073.068078959967, -5742.095260592175, -7908.091068393531, -8977.211649111065, -8710.80004987592, -11079.482961023956, -4660.251265253131, -2545.4672518206094, -5537.505001252659, -4632.760476148653, -9676.664277139062, -8.684364518716157, -172.5660170709618, -6515.595268815318, -4490.860940903634, -5374.408867182578, -8140.108298635251, -4473.481730732065, -5664.575581752488, -5096.26596002113, -9179.173818664403, -2732.0553031674717, -3833.609135983166, -5078.837949833927, -6281.180323899662, -3665.0962556959907, -5834.217208786942, -163.74290031715975, -338.099744787575, -5872.839763923591, -4265.6692829512285, -5281.2895416902875, -8261.666119537853, -4368.785201889719, -6288.81807082689, -3608.8809573153503, -809.9931635888014, -6596.572165240343, -5005.34470581391, -9383.626210595648, -11037.70018943892, -2838.639969402985, -2846.4148350743217, -4830.804448863004, -3175.2864495203203, -7318.92902854367, -4499.3305372579325, -9936.352620111738, -8661.006486008357, -9748.3923087397, -6350.263101056086, -8726.05473883151, -3613.378292524998, -9780.732697551872, -5125.731502131049, -8252.640343954212, -5067.626659163374, -6184.086627155887, -5355.804754375683, -2975.149292965945, -5910.7820321390745, -3481.390466559728, -7784.87132892776, -7799.975063826392, -8413.71822841759, -9347.198739695079, -5305.640014495033, -2631.5387542553285, -5152.936407191215, -7295.583090897009, -7646.226673153129, -4589.54056965216, -1593.8190651684015, -1659.812133377796, -3591.0668065581585, -8071.71952726014, -7753.586398353289, -2619.7358915121067, -3618.049763655832, -4139.881516045902, -5808.698242140996, -8142.122474231084, -6090.811635089415, -5841.905733511943, -9341.107600459985, -5373.852682038602, -8361.7911933025, -7076.108555947925, -7202.717224333541, -942.7202198698308, -186.93056716233716, -3114.158419092227, -1149.6325710212188, -2910.217202189828, -5950.081884569459, -3465.0374026786517, -8199.511240620412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4192306365359287, "mean_inference_ms": 1.0231015118358349, "mean_action_processing_ms": 0.17554137555557284, "mean_env_wait_ms": 0.053178807203668084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033538341522216797, "StateBufferConnector_ms": 0.0025932788848876953, "ViewRequirementAgentConnector_ms": 0.07185566425323486}, "num_episodes": 20, "episode_return_max": -135.94900100260267, "episode_return_min": -11278.004932687, "episode_return_mean": -6866.994219668799}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.8594624775231, "num_env_steps_trained_throughput_per_sec": 441.8594624775231, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 7396.258, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7396.213, "sample_time_ms": 780.604, "learn_time_ms": 6601.089, "learn_throughput": 605.961, "synch_weights_time_ms": 13.953}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 15, "trial_id": "3439d_00000", "date": "2024-08-09_15-27-58", "timestamp": 1723231678, "time_this_iter_s": 9.081585884094238, "time_total_s": 110.66602826118469, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a4ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 110.66602826118469, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.035714285714285, "ram_util_percent": 79.60714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6681153456214816, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988495716452599, "policy_loss": -0.006286839233750167, "vf_loss": 9.989723966519039, "vf_explained_var": 2.5808314482371013e-05, "kl": 0.011241354235486748, "entropy": 1.4772147766004007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6812738424255734, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992629138502494, "policy_loss": -0.003274096499280955, "vf_loss": 9.993472860729884, "vf_explained_var": 6.15259326954998e-05, "kl": 0.01215164925848878, "entropy": 1.5790521033857234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -14.514164537286927, "episode_reward_min": -11278.004932687, "episode_reward_mean": -6760.6264566740765, "episode_len_mean": 186.17, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18617, "policy_reward_min": {"agent_policy": 8.684364518716157, "adversary_policy": -11079.482961023956}, "policy_reward_max": {"agent_policy": 9179.401644151912, "adversary_policy": -8.684364518716157}, "policy_reward_mean": {"agent_policy": 4036.560949628019, "adversary_policy": -5398.5937031510475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10804.953478551086, -10272.684049672589, -8234.270963011499, -5764.645535370009, -4623.815698943307, -7455.500736707847, -6936.634031275464, -8911.532579409683, -5417.997556206386, -6159.848378773057, -9625.13378668665, -7668.396124672045, -9827.678738901286, -9815.631279190251, -4436.1644308146215, -7672.124599002975, -7471.275038985261, -2022.536368463268, -7905.814140909957, -8090.53522232538, -7632.4188597335005, -3843.1973049366525, -7979.429531359928, -8787.626955739988, -8725.823073441032, -8292.08626370723, -6169.182756794117, -9432.367640362638, -8666.25476589837, -7908.09106839353, -9139.536088472112, -11079.482961023954, -5538.6344429267765, -9676.664277139062, -172.5660170709618, -6521.8241110328345, -8140.108298635251, -5669.1130570373825, -9179.173818664403, -3905.4599294232994, -6510.115421444335, -5834.989982781467, -338.099744787575, -6233.710726519882, -8261.666119537853, -6565.869790107992, -3608.8809573153503, -6617.588941421909, -11278.004932687, -3737.5651323425786, -5523.163719050278, -7318.929028543672, -9936.35262011174, -9748.392308739702, -8726.054738831512, -9780.73269755187, -8252.640343954212, -6388.729537475348, -5913.286033979639, -7813.639782028535, -8795.08242706058, -9347.198739695077, -5387.677318482692, -7792.806578690928, -4589.54056965216, -3591.0668065581585, -8779.344669878315, -4097.858107502804, -6270.211622659771, -8142.122474231084, -9341.107600459984, -8361.791193302503, -7761.03412114779, -942.7202198698308, -3114.158419092227, -7099.2944179921815, -8199.511240620412, -4952.344136974699, -4752.540147594697, -7875.892942483355, -6321.63847172708, -5250.785579865145, -8781.951623469096, -4513.0601221690595, -5725.020608206235, -8967.001561587136, -5784.464038416094, -7419.148575196511, -3474.4391875453966, -7648.086282299512, -2998.7633861550657, -1620.1259789661422, -8046.308650170757, -5773.221874663994, -7237.825891885324, -8052.468160683125, -5714.106036044033, -14.514164537286927, -6959.196655085482, -2602.5885459078354], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 105, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 196, 145, 200, 200, 200, 200, 200, 200, 200, 45, 97, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 99, 200, 200, 200, 200, 200, 5, 200, 200], "policy_agent_policy_reward": [3632.977282159848, 9179.401644151912, 3885.2451920891654, 1850.200899117651, 3102.4311795526546, 4764.975910373595, 5913.620317523608, 7964.322102096817, 3385.8406815419853, 4512.072244330644, 2799.694175249632, 6330.317643850279, 8805.103305800269, 4470.632317234494, 2788.4837900970197, 5181.764331880587, 5433.904396417672, 352.8474452478696, 1513.5083219426394, 6856.98129940344, 2477.1227733631645, 721.2463164318583, 6096.899290544689, 5486.675379055709, 7384.948317330895, 7155.922572936845, 1944.168511022486, 3743.4235144502004, 3073.068078959967, 5742.095260592175, 8548.475610514872, 4660.251265253131, 2544.3378101464914, 4632.760476148653, 8.684364518716157, 4484.632098686119, 5374.408867182578, 4468.944255447169, 5096.26596002113, 2660.204509727338, 4849.902852289253, 3664.323481701466, 163.74290031715975, 3904.7983203549384, 5281.2895416902875, 4091.7334826086185, 809.9931635888014, 4984.327929632344, 9143.321467347574, 1947.4896721347286, 2482.927179333049, 4499.3305372579325, 8661.006486008357, 6350.263101056086, 3613.378292524998, 5125.731502131049, 5067.626659163374, 5151.161844056222, 2972.6452911253814, 3452.6220134589526, 7418.610865183406, 5305.640014495033, 2396.7978429638542, 7149.00318535921, 1593.8190651684015, 1659.812133377796, 7045.961255735108, 2139.927547665136, 3678.3681355271256, 6090.811635089415, 5841.905733511943, 5373.852682038602, 6517.791659133673, 186.93056716233716, 1149.6325710212188, 1761.0046687671083, 3465.0374026786517, 1382.9590828572755, 3959.5629128904607, 2851.3806794885986, 4060.769499567819, 4602.445815070196, 4067.7202999919336, 2470.8201178575564, 4539.753152439218, 6021.846727866647, 2049.3630243771254, 2068.6736153082747, 2408.4011297425204, 4367.525363123724, 1713.6064269250683, 1296.9566258593773, 2893.4727796974244, 1794.7050312698677, 5512.285127736505, 3394.7890937619454, 3277.6670174400424, 9.231756115374413, 2926.343681652422, 1964.4336067079623], "policy_adversary_policy_reward": [-3632.977282159848, -10804.953478551084, -10131.940656329778, -9320.145037494725, -7092.478942234558, -5027.03721286611, -1850.200899117651, -5764.645535370009, -4623.815698943308, -3102.4311795526546, -6349.2281087665115, -5871.248538314929, -6807.213686240182, -6043.040662558887, -8797.682412483233, -8078.172269023268, -5241.445555575953, -3562.392682172427, -5518.55757827723, -5153.363044826464, -9625.13378668665, -2799.694175249632, -7667.955984284527, -6330.757784237799, -9763.054971066127, -8869.727073635431, -9815.631279190251, -4470.632317234494, -3970.432121943104, -3254.2160989685367, -5181.764331880587, -7672.124599002975, -7463.329237307484, -5441.85019809545, -2022.5363684632675, -352.8474452478696, -1513.5083219426394, -7905.814140909957, -6858.445943588027, -8089.070578140794, -2477.1227733631645, -7632.4188597335005, -721.2463164318583, -3843.1973049366525, -6683.583340696277, -7392.745481208341, -8787.626955739988, -5486.675379055709, -8083.1213045557815, -8027.650086216144, -8257.47734969489, -7190.531486949186, -6169.182756794117, -1944.168511022486, -3743.4235144502004, -9432.367640362638, -8666.254765898371, -3073.068078959967, -5742.095260592175, -7908.091068393531, -8977.211649111065, -8710.80004987592, -11079.482961023956, -4660.251265253131, -2545.4672518206094, -5537.505001252659, -4632.760476148653, -9676.664277139062, -8.684364518716157, -172.5660170709618, -6515.595268815318, -4490.860940903634, -5374.408867182578, -8140.108298635251, -4473.481730732065, -5664.575581752488, -5096.26596002113, -9179.173818664403, -2732.0553031674717, -3833.609135983166, -5078.837949833927, -6281.180323899662, -3665.0962556959907, -5834.217208786942, -163.74290031715975, -338.099744787575, -5872.839763923591, -4265.6692829512285, -5281.2895416902875, -8261.666119537853, -4368.785201889719, -6288.81807082689, -3608.8809573153503, -809.9931635888014, -6596.572165240343, -5005.34470581391, -9383.626210595648, -11037.70018943892, -2838.639969402985, -2846.4148350743217, -4830.804448863004, -3175.2864495203203, -7318.92902854367, -4499.3305372579325, -9936.352620111738, -8661.006486008357, -9748.3923087397, -6350.263101056086, -8726.05473883151, -3613.378292524998, -9780.732697551872, -5125.731502131049, -8252.640343954212, -5067.626659163374, -6184.086627155887, -5355.804754375683, -2975.149292965945, -5910.7820321390745, -3481.390466559728, -7784.87132892776, -7799.975063826392, -8413.71822841759, -9347.198739695079, -5305.640014495033, -2631.5387542553285, -5152.936407191215, -7295.583090897009, -7646.226673153129, -4589.54056965216, -1593.8190651684015, -1659.812133377796, -3591.0668065581585, -8071.71952726014, -7753.586398353289, -2619.7358915121067, -3618.049763655832, -4139.881516045902, -5808.698242140996, -8142.122474231084, -6090.811635089415, -5841.905733511943, -9341.107600459985, -5373.852682038602, -8361.7911933025, -7076.108555947925, -7202.717224333541, -942.7202198698308, -186.93056716233716, -3114.158419092227, -1149.6325710212188, -2910.217202189828, -5950.081884569459, -3465.0374026786517, -8199.511240620412, -1382.9590828572755, -4952.344136974699, -4048.2617234768777, -4663.841337008282, -7875.892942483355, -2851.3806794885986, -4372.933575381195, -6009.4743959137095, -5023.716274025095, -4829.515120910246, -4067.7202999919336, -8781.951623469096, -2470.8201178575564, -4513.0601221690595, -4748.680791366263, -5516.092969279189, -8967.001561587136, -6021.846727866647, -5733.289404063987, -2100.5376587292353, -2068.6736153082747, -7419.148575196511, -3001.062482433555, -2881.777834854361, -4367.525363123724, -7648.086282299511, -1752.4381661354853, -2959.9316469446485, -1611.4814414557525, -1305.6011633697665, -8045.325045815359, -2894.4563840528235, -5151.401297499864, -2416.5256084340026, -7237.8258918853235, -5512.285127736505, -8052.468160683125, -3394.7890937619454, -3277.6670174400424, -5714.106036044033, -9.231756115374413, -14.514164537286927, -6959.196655085482, -2926.343681652422, -2333.6557828588448, -2233.36636975695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41901047026488286, "mean_inference_ms": 1.0226707391339611, "mean_action_processing_ms": 0.17547423252478103, "mean_env_wait_ms": 0.05293893727847117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033397674560546875, "StateBufferConnector_ms": 0.002755284309387207, "ViewRequirementAgentConnector_ms": 0.07279253005981445}, "num_episodes": 23, "episode_return_max": -14.514164537286927, "episode_return_min": -11278.004932687, "episode_return_mean": -6760.6264566740765}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.3723749714204, "num_env_steps_trained_throughput_per_sec": 470.3723749714204, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 7549.122, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7549.075, "sample_time_ms": 799.597, "learn_time_ms": 6734.622, "learn_throughput": 593.946, "synch_weights_time_ms": 14.291}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 16, "trial_id": "3439d_00000", "date": "2024-08-09_15-28-07", "timestamp": 1723231687, "time_this_iter_s": 8.509115934371948, "time_total_s": 119.17514419555664, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ea0f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.17514419555664, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.566666666666666, "ram_util_percent": 80.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7267854859276365, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987091543277105, "policy_loss": -0.0009460889874996307, "vf_loss": 9.98435320854187, "vf_explained_var": 2.9536585013071696e-06, "kl": 0.008187585713070196, "entropy": 1.493873405084014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.683756638535116, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98918531256378, "policy_loss": -0.005445191447706844, "vf_loss": 9.992010897177238, "vf_explained_var": 8.97211057168466e-05, "kl": 0.013098005425658019, "entropy": 1.5760048505490418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -14.514164537286927, "episode_reward_min": -11278.004932687, "episode_reward_mean": -6519.521854218868, "episode_len_mean": 186.13, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18613, "policy_reward_min": {"agent_policy": 8.684364518716157, "adversary_policy": -11079.482961023956}, "policy_reward_max": {"agent_policy": 9143.321467347574, "adversary_policy": -8.684364518716157}, "policy_reward_mean": {"agent_policy": 3872.084696465991, "adversary_policy": -5195.803275342429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7632.4188597335005, -3843.1973049366525, -7979.429531359928, -8787.626955739988, -8725.823073441032, -8292.08626370723, -6169.182756794117, -9432.367640362638, -8666.25476589837, -7908.09106839353, -9139.536088472112, -11079.482961023954, -5538.6344429267765, -9676.664277139062, -172.5660170709618, -6521.8241110328345, -8140.108298635251, -5669.1130570373825, -9179.173818664403, -3905.4599294232994, -6510.115421444335, -5834.989982781467, -338.099744787575, -6233.710726519882, -8261.666119537853, -6565.869790107992, -3608.8809573153503, -6617.588941421909, -11278.004932687, -3737.5651323425786, -5523.163719050278, -7318.929028543672, -9936.35262011174, -9748.392308739702, -8726.054738831512, -9780.73269755187, -8252.640343954212, -6388.729537475348, -5913.286033979639, -7813.639782028535, -8795.08242706058, -9347.198739695077, -5387.677318482692, -7792.806578690928, -4589.54056965216, -3591.0668065581585, -8779.344669878315, -4097.858107502804, -6270.211622659771, -8142.122474231084, -9341.107600459984, -8361.791193302503, -7761.03412114779, -942.7202198698308, -3114.158419092227, -7099.2944179921815, -8199.511240620412, -4952.344136974699, -4752.540147594697, -7875.892942483355, -6321.63847172708, -5250.785579865145, -8781.951623469096, -4513.0601221690595, -5725.020608206235, -8967.001561587136, -5784.464038416094, -7419.148575196511, -3474.4391875453966, -7648.086282299512, -2998.7633861550657, -1620.1259789661422, -8046.308650170757, -5773.221874663994, -7237.825891885324, -8052.468160683125, -5714.106036044033, -14.514164537286927, -6959.196655085482, -2602.5885459078354, -7457.491136923929, -8957.987855551915, -6308.677475671223, -7776.794896106739, -4969.706019362931, -3299.3702077387093, -2455.947625686977, -6582.846093210099, -7266.081042665637, -5081.942932329125, -7170.700386164598, -6290.407266294098, -6150.274338129143, -3724.3989587605633, -6510.139838611117, -3958.2190280000277, -8261.497451044654, -8420.824406910511, -8871.443679925482, -5491.961853264228], "episode_lengths": [200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 105, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 196, 145, 200, 200, 200, 200, 200, 200, 200, 45, 97, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 99, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 170, 102, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2477.1227733631645, 721.2463164318583, 6096.899290544689, 5486.675379055709, 7384.948317330895, 7155.922572936845, 1944.168511022486, 3743.4235144502004, 3073.068078959967, 5742.095260592175, 8548.475610514872, 4660.251265253131, 2544.3378101464914, 4632.760476148653, 8.684364518716157, 4484.632098686119, 5374.408867182578, 4468.944255447169, 5096.26596002113, 2660.204509727338, 4849.902852289253, 3664.323481701466, 163.74290031715975, 3904.7983203549384, 5281.2895416902875, 4091.7334826086185, 809.9931635888014, 4984.327929632344, 9143.321467347574, 1947.4896721347286, 2482.927179333049, 4499.3305372579325, 8661.006486008357, 6350.263101056086, 3613.378292524998, 5125.731502131049, 5067.626659163374, 5151.161844056222, 2972.6452911253814, 3452.6220134589526, 7418.610865183406, 5305.640014495033, 2396.7978429638542, 7149.00318535921, 1593.8190651684015, 1659.812133377796, 7045.961255735108, 2139.927547665136, 3678.3681355271256, 6090.811635089415, 5841.905733511943, 5373.852682038602, 6517.791659133673, 186.93056716233716, 1149.6325710212188, 1761.0046687671083, 3465.0374026786517, 1382.9590828572755, 3959.5629128904607, 2851.3806794885986, 4060.769499567819, 4602.445815070196, 4067.7202999919336, 2470.8201178575564, 4539.753152439218, 6021.846727866647, 2049.3630243771254, 2068.6736153082747, 2408.4011297425204, 4367.525363123724, 1713.6064269250683, 1296.9566258593773, 2893.4727796974244, 1794.7050312698677, 5512.285127736505, 3394.7890937619454, 3277.6670174400424, 9.231756115374413, 2926.343681652422, 1964.4336067079623, 6306.285746242562, 6889.281889036278, 3654.2912928583805, 6488.036201268131, 3048.2265849132077, 2547.2493484584015, 1148.755233337584, 2420.8351672621234, 3795.09849295701, 2454.7629001833548, 4145.312631709087, 2415.412951023507, 4621.462543131448, 898.1336063374944, 2695.9733049179613, 2252.560889654204, 3454.123819640751, 5924.005264279768, 7725.733891916651, 3391.1574047310246], "policy_adversary_policy_reward": [-2477.1227733631645, -7632.4188597335005, -721.2463164318583, -3843.1973049366525, -6683.583340696277, -7392.745481208341, -8787.626955739988, -5486.675379055709, -8083.1213045557815, -8027.650086216144, -8257.47734969489, -7190.531486949186, -6169.182756794117, -1944.168511022486, -3743.4235144502004, -9432.367640362638, -8666.254765898371, -3073.068078959967, -5742.095260592175, -7908.091068393531, -8977.211649111065, -8710.80004987592, -11079.482961023956, -4660.251265253131, -2545.4672518206094, -5537.505001252659, -4632.760476148653, -9676.664277139062, -8.684364518716157, -172.5660170709618, -6515.595268815318, -4490.860940903634, -5374.408867182578, -8140.108298635251, -4473.481730732065, -5664.575581752488, -5096.26596002113, -9179.173818664403, -2732.0553031674717, -3833.609135983166, -5078.837949833927, -6281.180323899662, -3665.0962556959907, -5834.217208786942, -163.74290031715975, -338.099744787575, -5872.839763923591, -4265.6692829512285, -5281.2895416902875, -8261.666119537853, -4368.785201889719, -6288.81807082689, -3608.8809573153503, -809.9931635888014, -6596.572165240343, -5005.34470581391, -9383.626210595648, -11037.70018943892, -2838.639969402985, -2846.4148350743217, -4830.804448863004, -3175.2864495203203, -7318.92902854367, -4499.3305372579325, -9936.352620111738, -8661.006486008357, -9748.3923087397, -6350.263101056086, -8726.05473883151, -3613.378292524998, -9780.732697551872, -5125.731502131049, -8252.640343954212, -5067.626659163374, -6184.086627155887, -5355.804754375683, -2975.149292965945, -5910.7820321390745, -3481.390466559728, -7784.87132892776, -7799.975063826392, -8413.71822841759, -9347.198739695079, -5305.640014495033, -2631.5387542553285, -5152.936407191215, -7295.583090897009, -7646.226673153129, -4589.54056965216, -1593.8190651684015, -1659.812133377796, -3591.0668065581585, -8071.71952726014, -7753.586398353289, -2619.7358915121067, -3618.049763655832, -4139.881516045902, -5808.698242140996, -8142.122474231084, -6090.811635089415, -5841.905733511943, -9341.107600459985, -5373.852682038602, -8361.7911933025, -7076.108555947925, -7202.717224333541, -942.7202198698308, -186.93056716233716, -3114.158419092227, -1149.6325710212188, -2910.217202189828, -5950.081884569459, -3465.0374026786517, -8199.511240620412, -1382.9590828572755, -4952.344136974699, -4048.2617234768777, -4663.841337008282, -7875.892942483355, -2851.3806794885986, -4372.933575381195, -6009.4743959137095, -5023.716274025095, -4829.515120910246, -4067.7202999919336, -8781.951623469096, -2470.8201178575564, -4513.0601221690595, -4748.680791366263, -5516.092969279189, -8967.001561587136, -6021.846727866647, -5733.289404063987, -2100.5376587292353, -2068.6736153082747, -7419.148575196511, -3001.062482433555, -2881.777834854361, -4367.525363123724, -7648.086282299511, -1752.4381661354853, -2959.9316469446485, -1611.4814414557525, -1305.6011633697665, -8045.325045815359, -2894.4563840528235, -5151.401297499864, -2416.5256084340026, -7237.8258918853235, -5512.285127736505, -8052.468160683125, -3394.7890937619454, -3277.6670174400424, -5714.106036044033, -9.231756115374413, -14.514164537286927, -6959.196655085482, -2926.343681652422, -2333.6557828588448, -2233.36636975695, -7384.132410827789, -6379.644472338701, -8746.479847794555, -7100.78989679364, -3963.468608434448, -5999.500160095156, -6987.106345620674, -7277.724751754194, -3115.264352316437, -4902.668251959702, -2744.9932032387073, -3101.626352958403, -2019.0020344316254, -1585.7008245929378, -5069.474640310388, -3934.206620161837, -3795.09849295701, -7266.081042665637, -5081.942932329126, -2454.7629001833548, -4163.598308683435, -7152.4147091902505, -2415.412951023507, -6290.407266294098, -6147.016416272373, -4624.720464988216, -3606.4321332315862, -1016.1004318664718, -6257.074505263532, -2949.038638265543, -3728.3565089489016, -2482.423408705329, -8261.497451044655, -3454.123819640751, -8420.824406910511, -5924.005264279768, -7989.122852543474, -8608.054719298656, -5491.961853264229, -3391.1574047310246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41873819562527287, "mean_inference_ms": 1.021680092730338, "mean_action_processing_ms": 0.17546443105219253, "mean_env_wait_ms": 0.05304002512020036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034776926040649414, "StateBufferConnector_ms": 0.0027620792388916016, "ViewRequirementAgentConnector_ms": 0.07407867908477783}, "num_episodes": 20, "episode_return_max": -14.514164537286927, "episode_return_min": -11278.004932687, "episode_return_mean": -6519.521854218868}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.4218847878173, "num_env_steps_trained_throughput_per_sec": 508.4218847878173, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 7606.852, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7606.805, "sample_time_ms": 809.684, "learn_time_ms": 6782.075, "learn_throughput": 589.79, "synch_weights_time_ms": 14.475}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 17, "trial_id": "3439d_00000", "date": "2024-08-09_15-28-15", "timestamp": 1723231695, "time_this_iter_s": 7.872701168060303, "time_total_s": 127.04784536361694, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.04784536361694, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.709090909090904, "ram_util_percent": 80.51818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8291436589788646, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98372428715229, "policy_loss": -0.0011274600440325836, "vf_loss": 9.980114269256593, "vf_explained_var": 0.00011400052656730016, "kl": 0.010527778597800836, "entropy": 1.5209155209362506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6647975197860173, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98606272298823, "policy_loss": -0.007159472781445378, "vf_loss": 9.990091292567985, "vf_explained_var": -0.0002414885021391369, "kl": 0.015654504063376595, "entropy": 1.5792636464512537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -14.514164537286927, "episode_reward_min": -11278.004932687, "episode_reward_mean": -6445.207835759028, "episode_len_mean": 188.11, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18811, "policy_reward_min": {"agent_policy": 9.231756115374413, "adversary_policy": -11037.70018943892}, "policy_reward_max": {"agent_policy": 9143.321467347574, "adversary_policy": -9.231756115374413}, "policy_reward_mean": {"agent_policy": 3870.9775035986704, "adversary_policy": -5158.092669678849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5834.989982781467, -338.099744787575, -6233.710726519882, -8261.666119537853, -6565.869790107992, -3608.8809573153503, -6617.588941421909, -11278.004932687, -3737.5651323425786, -5523.163719050278, -7318.929028543672, -9936.35262011174, -9748.392308739702, -8726.054738831512, -9780.73269755187, -8252.640343954212, -6388.729537475348, -5913.286033979639, -7813.639782028535, -8795.08242706058, -9347.198739695077, -5387.677318482692, -7792.806578690928, -4589.54056965216, -3591.0668065581585, -8779.344669878315, -4097.858107502804, -6270.211622659771, -8142.122474231084, -9341.107600459984, -8361.791193302503, -7761.03412114779, -942.7202198698308, -3114.158419092227, -7099.2944179921815, -8199.511240620412, -4952.344136974699, -4752.540147594697, -7875.892942483355, -6321.63847172708, -5250.785579865145, -8781.951623469096, -4513.0601221690595, -5725.020608206235, -8967.001561587136, -5784.464038416094, -7419.148575196511, -3474.4391875453966, -7648.086282299512, -2998.7633861550657, -1620.1259789661422, -8046.308650170757, -5773.221874663994, -7237.825891885324, -8052.468160683125, -5714.106036044033, -14.514164537286927, -6959.196655085482, -2602.5885459078354, -7457.491136923929, -8957.987855551915, -6308.677475671223, -7776.794896106739, -4969.706019362931, -3299.3702077387093, -2455.947625686977, -6582.846093210099, -7266.081042665637, -5081.942932329125, -7170.700386164598, -6290.407266294098, -6150.274338129143, -3724.3989587605633, -6510.139838611117, -3958.2190280000277, -8261.497451044654, -8420.824406910511, -8871.443679925482, -5491.961853264228, -5492.443590534042, -9796.474627663982, -10219.679317797105, -9017.536755873567, -3544.9226386414603, -7607.0993834555475, -5597.948413212328, -6978.243236509445, -10815.424840580896, -4810.542796986371, -8024.38002905223, -7984.275104088801, -4003.668928132944, -4359.208129112232, -7791.904146454751, -8990.656920506854, -5188.914657280769, -3545.437650380988, -3613.7169647725595, -8070.0609973106375, -10085.215668906014], "episode_lengths": [200, 20, 200, 200, 200, 105, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 196, 145, 200, 200, 200, 200, 200, 200, 200, 45, 97, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 99, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 170, 102, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 200, 200, 178, 156, 200, 200], "policy_agent_policy_reward": [3664.323481701466, 163.74290031715975, 3904.7983203549384, 5281.2895416902875, 4091.7334826086185, 809.9931635888014, 4984.327929632344, 9143.321467347574, 1947.4896721347286, 2482.927179333049, 4499.3305372579325, 8661.006486008357, 6350.263101056086, 3613.378292524998, 5125.731502131049, 5067.626659163374, 5151.161844056222, 2972.6452911253814, 3452.6220134589526, 7418.610865183406, 5305.640014495033, 2396.7978429638542, 7149.00318535921, 1593.8190651684015, 1659.812133377796, 7045.961255735108, 2139.927547665136, 3678.3681355271256, 6090.811635089415, 5841.905733511943, 5373.852682038602, 6517.791659133673, 186.93056716233716, 1149.6325710212188, 1761.0046687671083, 3465.0374026786517, 1382.9590828572755, 3959.5629128904607, 2851.3806794885986, 4060.769499567819, 4602.445815070196, 4067.7202999919336, 2470.8201178575564, 4539.753152439218, 6021.846727866647, 2049.3630243771254, 2068.6736153082747, 2408.4011297425204, 4367.525363123724, 1713.6064269250683, 1296.9566258593773, 2893.4727796974244, 1794.7050312698677, 5512.285127736505, 3394.7890937619454, 3277.6670174400424, 9.231756115374413, 2926.343681652422, 1964.4336067079623, 6306.285746242562, 6889.281889036278, 3654.2912928583805, 6488.036201268131, 3048.2265849132077, 2547.2493484584015, 1148.755233337584, 2420.8351672621234, 3795.09849295701, 2454.7629001833548, 4145.312631709087, 2415.412951023507, 4621.462543131448, 898.1336063374944, 2695.9733049179613, 2252.560889654204, 3454.123819640751, 5924.005264279768, 7725.733891916651, 3391.1574047310246, 4276.640882627666, 7897.885711637895, 7095.945592998669, 5961.1159823308235, 2938.3327758034006, 2565.587801487765, 1768.4236652419836, 5578.147430833289, 2992.580022523358, 2212.183062156598, 7207.212125918199, 5745.5531569717305, 2419.614234701477, 1993.4143542830104, 5322.449797661407, 2408.829665788494, 4612.42850940523, 2972.3784510252485, 2036.161761093308, 6121.527904482594, 6917.305908919314], "policy_adversary_policy_reward": [-3665.0962556959907, -5834.217208786942, -163.74290031715975, -338.099744787575, -5872.839763923591, -4265.6692829512285, -5281.2895416902875, -8261.666119537853, -4368.785201889719, -6288.81807082689, -3608.8809573153503, -809.9931635888014, -6596.572165240343, -5005.34470581391, -9383.626210595648, -11037.70018943892, -2838.639969402985, -2846.4148350743217, -4830.804448863004, -3175.2864495203203, -7318.92902854367, -4499.3305372579325, -9936.352620111738, -8661.006486008357, -9748.3923087397, -6350.263101056086, -8726.05473883151, -3613.378292524998, -9780.732697551872, -5125.731502131049, -8252.640343954212, -5067.626659163374, -6184.086627155887, -5355.804754375683, -2975.149292965945, -5910.7820321390745, -3481.390466559728, -7784.87132892776, -7799.975063826392, -8413.71822841759, -9347.198739695079, -5305.640014495033, -2631.5387542553285, -5152.936407191215, -7295.583090897009, -7646.226673153129, -4589.54056965216, -1593.8190651684015, -1659.812133377796, -3591.0668065581585, -8071.71952726014, -7753.586398353289, -2619.7358915121067, -3618.049763655832, -4139.881516045902, -5808.698242140996, -8142.122474231084, -6090.811635089415, -5841.905733511943, -9341.107600459985, -5373.852682038602, -8361.7911933025, -7076.108555947925, -7202.717224333541, -942.7202198698308, -186.93056716233716, -3114.158419092227, -1149.6325710212188, -2910.217202189828, -5950.081884569459, -3465.0374026786517, -8199.511240620412, -1382.9590828572755, -4952.344136974699, -4048.2617234768777, -4663.841337008282, -7875.892942483355, -2851.3806794885986, -4372.933575381195, -6009.4743959137095, -5023.716274025095, -4829.515120910246, -4067.7202999919336, -8781.951623469096, -2470.8201178575564, -4513.0601221690595, -4748.680791366263, -5516.092969279189, -8967.001561587136, -6021.846727866647, -5733.289404063987, -2100.5376587292353, -2068.6736153082747, -7419.148575196511, -3001.062482433555, -2881.777834854361, -4367.525363123724, -7648.086282299511, -1752.4381661354853, -2959.9316469446485, -1611.4814414557525, -1305.6011633697665, -8045.325045815359, -2894.4563840528235, -5151.401297499864, -2416.5256084340026, -7237.8258918853235, -5512.285127736505, -8052.468160683125, -3394.7890937619454, -3277.6670174400424, -5714.106036044033, -9.231756115374413, -14.514164537286927, -6959.196655085482, -2926.343681652422, -2333.6557828588448, -2233.36636975695, -7384.132410827789, -6379.644472338701, -8746.479847794555, -7100.78989679364, -3963.468608434448, -5999.500160095156, -6987.106345620674, -7277.724751754194, -3115.264352316437, -4902.668251959702, -2744.9932032387073, -3101.626352958403, -2019.0020344316254, -1585.7008245929378, -5069.474640310388, -3934.206620161837, -3795.09849295701, -7266.081042665637, -5081.942932329126, -2454.7629001833548, -4163.598308683435, -7152.4147091902505, -2415.412951023507, -6290.407266294098, -6147.016416272373, -4624.720464988216, -3606.4321332315862, -1016.1004318664718, -6257.074505263532, -2949.038638265543, -3728.3565089489016, -2482.423408705329, -8261.497451044655, -3454.123819640751, -8420.824406910511, -5924.005264279768, -7989.122852543474, -8608.054719298656, -5491.961853264229, -3391.1574047310246, -4396.150633634168, -5372.933839527539, -7897.885711637895, -9796.47462766398, -10219.679317797109, -7095.945592998669, -8458.639603825222, -6520.013134379171, -2976.5558023661915, -3506.6996120786685, -7607.0993834555475, -2565.587801487765, -5597.948413212328, -1768.4236652419836, -6169.046920510087, -6387.343746832645, -10815.424840580898, -2992.580022523358, -4810.542796986371, -2212.183062156598, -7574.90600901533, -7656.686145955098, -7630.683271976488, -6099.144989084055, -4003.6689281329436, -2419.614234701477, -1993.4143542830104, -4359.208129112232, -5322.449797661407, -7791.90414645475, -8990.656920506854, -2408.829665788494, -5097.95388838829, -4703.389278297709, -3374.6845387857143, -3143.131562620523, -3613.71696477256, -2036.161761093308, -6121.527904482594, -8070.0609973106375, -9867.150706551305, -7135.370871274019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41971518043947315, "mean_inference_ms": 1.025674929248172, "mean_action_processing_ms": 0.17588287320380286, "mean_env_wait_ms": 0.05321280366508303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00357973575592041, "StateBufferConnector_ms": 0.0028009414672851562, "ViewRequirementAgentConnector_ms": 0.08276152610778809}, "num_episodes": 21, "episode_return_max": -14.514164537286927, "episode_return_min": -11278.004932687, "episode_return_mean": -6445.207835759028}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.7412672481278, "num_env_steps_trained_throughput_per_sec": 472.7412672481278, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 7739.949, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7739.832, "sample_time_ms": 833.438, "learn_time_ms": 6890.134, "learn_throughput": 580.54, "synch_weights_time_ms": 15.518}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 18, "trial_id": "3439d_00000", "date": "2024-08-09_15-28-24", "timestamp": 1723231704, "time_this_iter_s": 8.497021198272705, "time_total_s": 135.54486656188965, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.54486656188965, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.86666666666667, "ram_util_percent": 80.58333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7614163936581463, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.976968444387118, "policy_loss": -0.0033634196331452887, "vf_loss": 9.97698356906573, "vf_explained_var": -0.0004341639578342438, "kl": 0.007440658479269283, "entropy": 1.5142787884920836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7231344718150992, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983433351062594, "policy_loss": -0.00782926139771623, "vf_loss": 9.988420651955579, "vf_explained_var": -7.092795044026047e-06, "kl": 0.014209725196281123, "entropy": 1.58649131936371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -14.514164537286927, "episode_reward_min": -10815.424840580896, "episode_reward_mean": -6226.414770504916, "episode_len_mean": 184.91, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18491, "policy_reward_min": {"agent_policy": 9.231756115374413, "adversary_policy": -10815.424840580898}, "policy_reward_max": {"agent_policy": 7897.885711637895, "adversary_policy": -9.231756115374413}, "policy_reward_mean": {"agent_policy": 3717.1301686982533, "adversary_policy": -4971.772469601585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4589.54056965216, -3591.0668065581585, -8779.344669878315, -4097.858107502804, -6270.211622659771, -8142.122474231084, -9341.107600459984, -8361.791193302503, -7761.03412114779, -942.7202198698308, -3114.158419092227, -7099.2944179921815, -8199.511240620412, -4952.344136974699, -4752.540147594697, -7875.892942483355, -6321.63847172708, -5250.785579865145, -8781.951623469096, -4513.0601221690595, -5725.020608206235, -8967.001561587136, -5784.464038416094, -7419.148575196511, -3474.4391875453966, -7648.086282299512, -2998.7633861550657, -1620.1259789661422, -8046.308650170757, -5773.221874663994, -7237.825891885324, -8052.468160683125, -5714.106036044033, -14.514164537286927, -6959.196655085482, -2602.5885459078354, -7457.491136923929, -8957.987855551915, -6308.677475671223, -7776.794896106739, -4969.706019362931, -3299.3702077387093, -2455.947625686977, -6582.846093210099, -7266.081042665637, -5081.942932329125, -7170.700386164598, -6290.407266294098, -6150.274338129143, -3724.3989587605633, -6510.139838611117, -3958.2190280000277, -8261.497451044654, -8420.824406910511, -8871.443679925482, -5491.961853264228, -5492.443590534042, -9796.474627663982, -10219.679317797105, -9017.536755873567, -3544.9226386414603, -7607.0993834555475, -5597.948413212328, -6978.243236509445, -10815.424840580896, -4810.542796986371, -8024.38002905223, -7984.275104088801, -4003.668928132944, -4359.208129112232, -7791.904146454751, -8990.656920506854, -5188.914657280769, -3545.437650380988, -3613.7169647725595, -8070.0609973106375, -10085.215668906014, -4934.406872195088, -9074.786768965649, -6489.545607653751, -344.15451998157783, -7421.964737479286, -6419.543082594805, -6415.84076644893, -7213.199311531795, -9008.843482372959, -6220.040221918668, -5642.762854260601, -117.24388255170994, -125.39713214013639, -8913.091872929695, -9772.412215976301, -7850.7101466337335, -3674.3394737358008, -4952.658222472965, -8612.57913120041, -6695.636650592771, -9140.014298830509, -6666.015999370593, -5616.568424448301], "episode_lengths": [196, 145, 200, 200, 200, 200, 200, 200, 200, 45, 97, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 99, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 170, 102, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 200, 200, 178, 156, 200, 200, 200, 200, 200, 9, 200, 200, 189, 200, 200, 200, 200, 17, 10, 200, 200, 200, 200, 139, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1593.8190651684015, 1659.812133377796, 7045.961255735108, 2139.927547665136, 3678.3681355271256, 6090.811635089415, 5841.905733511943, 5373.852682038602, 6517.791659133673, 186.93056716233716, 1149.6325710212188, 1761.0046687671083, 3465.0374026786517, 1382.9590828572755, 3959.5629128904607, 2851.3806794885986, 4060.769499567819, 4602.445815070196, 4067.7202999919336, 2470.8201178575564, 4539.753152439218, 6021.846727866647, 2049.3630243771254, 2068.6736153082747, 2408.4011297425204, 4367.525363123724, 1713.6064269250683, 1296.9566258593773, 2893.4727796974244, 1794.7050312698677, 5512.285127736505, 3394.7890937619454, 3277.6670174400424, 9.231756115374413, 2926.343681652422, 1964.4336067079623, 6306.285746242562, 6889.281889036278, 3654.2912928583805, 6488.036201268131, 3048.2265849132077, 2547.2493484584015, 1148.755233337584, 2420.8351672621234, 3795.09849295701, 2454.7629001833548, 4145.312631709087, 2415.412951023507, 4621.462543131448, 898.1336063374944, 2695.9733049179613, 2252.560889654204, 3454.123819640751, 5924.005264279768, 7725.733891916651, 3391.1574047310246, 4276.640882627666, 7897.885711637895, 7095.945592998669, 5961.1159823308235, 2938.3327758034006, 2565.587801487765, 1768.4236652419836, 5578.147430833289, 2992.580022523358, 2212.183062156598, 7207.212125918199, 5745.5531569717305, 2419.614234701477, 1993.4143542830104, 5322.449797661407, 2408.829665788494, 4612.42850940523, 2972.3784510252485, 2036.161761093308, 6121.527904482594, 6917.305908919314, 4059.8257799845105, 6294.344494339709, 5223.420417985497, 24.91920000132361, 3936.866100382367, 5557.506319079317, 3463.154944662807, 3074.4478193857217, 7312.309989313101, 4253.6987039531905, 4931.0300383600525, 66.04907650932856, 29.941019138244496, 4096.649844728185, 2655.2218789861113, 6323.991510175346, 2707.285182228519, 1024.1875845134591, 3475.591162720978, 5682.172587352418, 7283.266874451207, 4599.580417145454, 2177.5703380542805], "policy_adversary_policy_reward": [-4589.54056965216, -1593.8190651684015, -1659.812133377796, -3591.0668065581585, -8071.71952726014, -7753.586398353289, -2619.7358915121067, -3618.049763655832, -4139.881516045902, -5808.698242140996, -8142.122474231084, -6090.811635089415, -5841.905733511943, -9341.107600459985, -5373.852682038602, -8361.7911933025, -7076.108555947925, -7202.717224333541, -942.7202198698308, -186.93056716233716, -3114.158419092227, -1149.6325710212188, -2910.217202189828, -5950.081884569459, -3465.0374026786517, -8199.511240620412, -1382.9590828572755, -4952.344136974699, -4048.2617234768777, -4663.841337008282, -7875.892942483355, -2851.3806794885986, -4372.933575381195, -6009.4743959137095, -5023.716274025095, -4829.515120910246, -4067.7202999919336, -8781.951623469096, -2470.8201178575564, -4513.0601221690595, -4748.680791366263, -5516.092969279189, -8967.001561587136, -6021.846727866647, -5733.289404063987, -2100.5376587292353, -2068.6736153082747, -7419.148575196511, -3001.062482433555, -2881.777834854361, -4367.525363123724, -7648.086282299511, -1752.4381661354853, -2959.9316469446485, -1611.4814414557525, -1305.6011633697665, -8045.325045815359, -2894.4563840528235, -5151.401297499864, -2416.5256084340026, -7237.8258918853235, -5512.285127736505, -8052.468160683125, -3394.7890937619454, -3277.6670174400424, -5714.106036044033, -9.231756115374413, -14.514164537286927, -6959.196655085482, -2926.343681652422, -2333.6557828588448, -2233.36636975695, -7384.132410827789, -6379.644472338701, -8746.479847794555, -7100.78989679364, -3963.468608434448, -5999.500160095156, -6987.106345620674, -7277.724751754194, -3115.264352316437, -4902.668251959702, -2744.9932032387073, -3101.626352958403, -2019.0020344316254, -1585.7008245929378, -5069.474640310388, -3934.206620161837, -3795.09849295701, -7266.081042665637, -5081.942932329126, -2454.7629001833548, -4163.598308683435, -7152.4147091902505, -2415.412951023507, -6290.407266294098, -6147.016416272373, -4624.720464988216, -3606.4321332315862, -1016.1004318664718, -6257.074505263532, -2949.038638265543, -3728.3565089489016, -2482.423408705329, -8261.497451044655, -3454.123819640751, -8420.824406910511, -5924.005264279768, -7989.122852543474, -8608.054719298656, -5491.961853264229, -3391.1574047310246, -4396.150633634168, -5372.933839527539, -7897.885711637895, -9796.47462766398, -10219.679317797109, -7095.945592998669, -8458.639603825222, -6520.013134379171, -2976.5558023661915, -3506.6996120786685, -7607.0993834555475, -2565.587801487765, -5597.948413212328, -1768.4236652419836, -6169.046920510087, -6387.343746832645, -10815.424840580898, -2992.580022523358, -4810.542796986371, -2212.183062156598, -7574.90600901533, -7656.686145955098, -7630.683271976488, -6099.144989084055, -4003.6689281329436, -2419.614234701477, -1993.4143542830104, -4359.208129112232, -5322.449797661407, -7791.90414645475, -8990.656920506854, -2408.829665788494, -5097.95388838829, -4703.389278297709, -3374.6845387857143, -3143.131562620523, -3613.71696477256, -2036.161761093308, -6121.527904482594, -8070.0609973106375, -9867.150706551305, -7135.370871274019, -4930.58998329027, -4063.6426688893293, -6295.541511673621, -9073.589751631738, -6450.646032964834, -5262.319992674414, -344.1545199815779, -24.91920000132361, -3936.866100382367, -7421.964737479286, -6255.658432070695, -5721.390969603428, -3825.2969641103114, -6053.698747001426, -3074.4478193857217, -7213.199311531795, -7319.714437100469, -9001.439034585592, -5367.8396626716685, -5105.899263200187, -5031.239575464993, -5542.55331715566, -107.54694948218983, -75.74600957884867, -29.941019138244496, -125.39713214013639, -4096.649844728185, -8913.091872929695, -9772.412215976301, -2655.2218789861113, -6597.6956961646, -7577.00596064448, -3110.7518459626494, -3270.8728100016697, -4952.6582224729655, -1024.1875845134591, -3475.591162720978, -8612.57913120041, -5908.387432701343, -6469.4218052438455, -7293.263094128921, -9130.018079152793, -6511.947035767225, -4753.649380748827, -5508.563293735042, -2285.575468767539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42221089101650167, "mean_inference_ms": 1.0307813071330212, "mean_action_processing_ms": 0.1771106814828161, "mean_env_wait_ms": 0.05367803109551273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004171609878540039, "StateBufferConnector_ms": 0.002951502799987793, "ViewRequirementAgentConnector_ms": 0.08563613891601562}, "num_episodes": 23, "episode_return_max": -14.514164537286927, "episode_return_min": -10815.424840580896, "episode_return_mean": -6226.414770504916}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.2418334388515, "num_env_steps_trained_throughput_per_sec": 459.2418334388515, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 7886.846, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7886.727, "sample_time_ms": 853.398, "learn_time_ms": 7017.098, "learn_throughput": 570.036, "synch_weights_time_ms": 15.534}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 19, "trial_id": "3439d_00000", "date": "2024-08-09_15-28-32", "timestamp": 1723231712, "time_this_iter_s": 8.71468210220337, "time_total_s": 144.25954866409302, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac03a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.25954866409302, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.753846153846155, "ram_util_percent": 80.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.748634025019904, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983391360441844, "policy_loss": -0.0040002951136557385, "vf_loss": 9.984088522195815, "vf_explained_var": 0.00016367832819620768, "kl": 0.007340297956640522, "entropy": 1.5015353509535392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.701015507086875, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988024462846221, "policy_loss": -0.007172265253522527, "vf_loss": 9.99175026252787, "vf_explained_var": 6.314651675955959e-05, "kl": 0.01723238967615303, "entropy": 1.5723183969971994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -14.514164537286927, "episode_reward_min": -10815.424840580896, "episode_reward_mean": -6158.3859710760935, "episode_len_mean": 185.09, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18509, "policy_reward_min": {"agent_policy": 9.231756115374413, "adversary_policy": -10815.424840580898}, "policy_reward_max": {"agent_policy": 8847.435066537757, "adversary_policy": -9.231756115374413}, "policy_reward_mean": {"agent_policy": 3785.4125466881724, "adversary_policy": -4971.899258882133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8967.001561587136, -5784.464038416094, -7419.148575196511, -3474.4391875453966, -7648.086282299512, -2998.7633861550657, -1620.1259789661422, -8046.308650170757, -5773.221874663994, -7237.825891885324, -8052.468160683125, -5714.106036044033, -14.514164537286927, -6959.196655085482, -2602.5885459078354, -7457.491136923929, -8957.987855551915, -6308.677475671223, -7776.794896106739, -4969.706019362931, -3299.3702077387093, -2455.947625686977, -6582.846093210099, -7266.081042665637, -5081.942932329125, -7170.700386164598, -6290.407266294098, -6150.274338129143, -3724.3989587605633, -6510.139838611117, -3958.2190280000277, -8261.497451044654, -8420.824406910511, -8871.443679925482, -5491.961853264228, -5492.443590534042, -9796.474627663982, -10219.679317797105, -9017.536755873567, -3544.9226386414603, -7607.0993834555475, -5597.948413212328, -6978.243236509445, -10815.424840580896, -4810.542796986371, -8024.38002905223, -7984.275104088801, -4003.668928132944, -4359.208129112232, -7791.904146454751, -8990.656920506854, -5188.914657280769, -3545.437650380988, -3613.7169647725595, -8070.0609973106375, -10085.215668906014, -4934.406872195088, -9074.786768965649, -6489.545607653751, -344.15451998157783, -7421.964737479286, -6419.543082594805, -6415.84076644893, -7213.199311531795, -9008.843482372959, -6220.040221918668, -5642.762854260601, -117.24388255170994, -125.39713214013639, -8913.091872929695, -9772.412215976301, -7850.7101466337335, -3674.3394737358008, -4952.658222472965, -8612.57913120041, -6695.636650592771, -9140.014298830509, -6666.015999370593, -5616.568424448301, -4761.646748812497, -8916.858679577279, -6004.489467919894, -9016.695873332395, -5321.372994127331, -9500.142558316375, -4129.573932460184, -6000.429135445313, -1332.03064458536, -5048.286661049689, -8077.89283199116, -2891.421730055976, -9893.648961873276, -1058.2286444498925, -4618.425398250481, -8339.524351711483, -6451.455241604805, -4222.366177499283, -2876.8618289298965, -4689.963376776747, -8508.799913805076], "episode_lengths": [200, 200, 200, 200, 200, 200, 99, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 170, 102, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 200, 200, 178, 156, 200, 200, 200, 200, 200, 9, 200, 200, 189, 200, 200, 200, 200, 17, 10, 200, 200, 200, 200, 139, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 133, 200, 200, 116, 200, 52, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6021.846727866647, 2049.3630243771254, 2068.6736153082747, 2408.4011297425204, 4367.525363123724, 1713.6064269250683, 1296.9566258593773, 2893.4727796974244, 1794.7050312698677, 5512.285127736505, 3394.7890937619454, 3277.6670174400424, 9.231756115374413, 2926.343681652422, 1964.4336067079623, 6306.285746242562, 6889.281889036278, 3654.2912928583805, 6488.036201268131, 3048.2265849132077, 2547.2493484584015, 1148.755233337584, 2420.8351672621234, 3795.09849295701, 2454.7629001833548, 4145.312631709087, 2415.412951023507, 4621.462543131448, 898.1336063374944, 2695.9733049179613, 2252.560889654204, 3454.123819640751, 5924.005264279768, 7725.733891916651, 3391.1574047310246, 4276.640882627666, 7897.885711637895, 7095.945592998669, 5961.1159823308235, 2938.3327758034006, 2565.587801487765, 1768.4236652419836, 5578.147430833289, 2992.580022523358, 2212.183062156598, 7207.212125918199, 5745.5531569717305, 2419.614234701477, 1993.4143542830104, 5322.449797661407, 2408.829665788494, 4612.42850940523, 2972.3784510252485, 2036.161761093308, 6121.527904482594, 6917.305908919314, 4059.8257799845105, 6294.344494339709, 5223.420417985497, 24.91920000132361, 3936.866100382367, 5557.506319079317, 3463.154944662807, 3074.4478193857217, 7312.309989313101, 4253.6987039531905, 4931.0300383600525, 66.04907650932856, 29.941019138244496, 4096.649844728185, 2655.2218789861113, 6323.991510175346, 2707.285182228519, 1024.1875845134591, 3475.591162720978, 5682.172587352418, 7283.266874451207, 4599.580417145454, 2177.5703380542805, 2941.8534486192566, 5464.773147258216, 3496.4963344782545, 4655.237149528085, 2526.0659527954776, 8847.435066537757, 2671.5956836346445, 3972.0005281147737, 730.9780674320297, 2107.0072429312445, 7075.12271102508, 2066.2186574753946, 8128.610642778837, 279.6661906561898, 3286.286074561491, 6456.850473256837, 4452.610268627005, 3073.5562397057142, 1457.5258797633642, 4231.048376277087, 3347.566280574738], "policy_adversary_policy_reward": [-8967.001561587136, -6021.846727866647, -5733.289404063987, -2100.5376587292353, -2068.6736153082747, -7419.148575196511, -3001.062482433555, -2881.777834854361, -4367.525363123724, -7648.086282299511, -1752.4381661354853, -2959.9316469446485, -1611.4814414557525, -1305.6011633697665, -8045.325045815359, -2894.4563840528235, -5151.401297499864, -2416.5256084340026, -7237.8258918853235, -5512.285127736505, -8052.468160683125, -3394.7890937619454, -3277.6670174400424, -5714.106036044033, -9.231756115374413, -14.514164537286927, -6959.196655085482, -2926.343681652422, -2333.6557828588448, -2233.36636975695, -7384.132410827789, -6379.644472338701, -8746.479847794555, -7100.78989679364, -3963.468608434448, -5999.500160095156, -6987.106345620674, -7277.724751754194, -3115.264352316437, -4902.668251959702, -2744.9932032387073, -3101.626352958403, -2019.0020344316254, -1585.7008245929378, -5069.474640310388, -3934.206620161837, -3795.09849295701, -7266.081042665637, -5081.942932329126, -2454.7629001833548, -4163.598308683435, -7152.4147091902505, -2415.412951023507, -6290.407266294098, -6147.016416272373, -4624.720464988216, -3606.4321332315862, -1016.1004318664718, -6257.074505263532, -2949.038638265543, -3728.3565089489016, -2482.423408705329, -8261.497451044655, -3454.123819640751, -8420.824406910511, -5924.005264279768, -7989.122852543474, -8608.054719298656, -5491.961853264229, -3391.1574047310246, -4396.150633634168, -5372.933839527539, -7897.885711637895, -9796.47462766398, -10219.679317797109, -7095.945592998669, -8458.639603825222, -6520.013134379171, -2976.5558023661915, -3506.6996120786685, -7607.0993834555475, -2565.587801487765, -5597.948413212328, -1768.4236652419836, -6169.046920510087, -6387.343746832645, -10815.424840580898, -2992.580022523358, -4810.542796986371, -2212.183062156598, -7574.90600901533, -7656.686145955098, -7630.683271976488, -6099.144989084055, -4003.6689281329436, -2419.614234701477, -1993.4143542830104, -4359.208129112232, -5322.449797661407, -7791.90414645475, -8990.656920506854, -2408.829665788494, -5097.95388838829, -4703.389278297709, -3374.6845387857143, -3143.131562620523, -3613.71696477256, -2036.161761093308, -6121.527904482594, -8070.0609973106375, -9867.150706551305, -7135.370871274019, -4930.58998329027, -4063.6426688893293, -6295.541511673621, -9073.589751631738, -6450.646032964834, -5262.319992674414, -344.1545199815779, -24.91920000132361, -3936.866100382367, -7421.964737479286, -6255.658432070695, -5721.390969603428, -3825.2969641103114, -6053.698747001426, -3074.4478193857217, -7213.199311531795, -7319.714437100469, -9001.439034585592, -5367.8396626716685, -5105.899263200187, -5031.239575464993, -5542.55331715566, -107.54694948218983, -75.74600957884867, -29.941019138244496, -125.39713214013639, -4096.649844728185, -8913.091872929695, -9772.412215976301, -2655.2218789861113, -6597.6956961646, -7577.00596064448, -3110.7518459626494, -3270.8728100016697, -4952.6582224729655, -1024.1875845134591, -3475.591162720978, -8612.57913120041, -5908.387432701343, -6469.4218052438455, -7293.263094128921, -9130.018079152793, -6511.947035767225, -4753.649380748827, -5508.563293735042, -2285.575468767539, -2979.4507313156546, -4724.049466116099, -5466.008434868543, -8915.623391966952, -6004.1495140119605, -3496.8362883861873, -4655.237149528085, -9016.695873332395, -2531.5081427721807, -5315.930804150627, -9348.274978049167, -8999.302646804965, -2697.3028238495544, -4103.866792245273, -4762.747672095626, -5209.68199146446, -1163.55514950256, -899.45356251483, -5047.7514902558205, -2107.542413725113, -7102.400006896231, -8050.615536120009, -2066.2186574753946, -2891.421730055976, -8131.070253563687, -9891.189351088426, -279.6661906561898, -1058.2286444498925, -4533.28249647307, -3371.4289763388992, -6497.283458884284, -8299.091366084036, -6451.455241604806, -4452.610268627005, -3543.3643009907396, -3752.558116214259, -1659.060034783773, -2675.3276739094886, -4646.0447523309, -4274.967000722936, -3347.566280574738, -8508.799913805076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42510832973350815, "mean_inference_ms": 1.0376632278825633, "mean_action_processing_ms": 0.17852327012583138, "mean_env_wait_ms": 0.05420487494191307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004411816596984863, "StateBufferConnector_ms": 0.002999424934387207, "ViewRequirementAgentConnector_ms": 0.092507004737854}, "num_episodes": 21, "episode_return_max": -14.514164537286927, "episode_return_min": -10815.424840580896, "episode_return_mean": -6158.3859710760935}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 469.59727758562985, "num_env_steps_trained_throughput_per_sec": 469.59727758562985, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 7982.125, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7982.006, "sample_time_ms": 832.909, "learn_time_ms": 7132.533, "learn_throughput": 560.811, "synch_weights_time_ms": 15.865}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 20, "trial_id": "3439d_00000", "date": "2024-08-09_15-28-41", "timestamp": 1723231721, "time_this_iter_s": 8.523053169250488, "time_total_s": 152.7826018333435, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.7826018333435, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.88333333333333, "ram_util_percent": 79.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7195089279984435, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.977777899305027, "policy_loss": -0.0021850288995968487, "vf_loss": 9.975674987832706, "vf_explained_var": -2.5037800272305808e-05, "kl": 0.009528778500680346, "entropy": 1.459901118154327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7551091436828886, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98836598219695, "policy_loss": -0.00244493855042728, "vf_loss": 9.987794723207989, "vf_explained_var": 5.108906478478164e-06, "kl": 0.015080871744938787, "entropy": 1.5774485277120398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -117.24388255170994, "episode_reward_min": -10815.424840580896, "episode_reward_mean": -6357.0210804868475, "episode_len_mean": 185.56, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18556, "policy_reward_min": {"agent_policy": 24.91920000132361, "adversary_policy": -10815.424840580898}, "policy_reward_max": {"agent_policy": 8847.435066537757, "adversary_policy": -24.91920000132361}, "policy_reward_mean": {"agent_policy": 3868.514819573994, "adversary_policy": -5112.767950030421}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2455.947625686977, -6582.846093210099, -7266.081042665637, -5081.942932329125, -7170.700386164598, -6290.407266294098, -6150.274338129143, -3724.3989587605633, -6510.139838611117, -3958.2190280000277, -8261.497451044654, -8420.824406910511, -8871.443679925482, -5491.961853264228, -5492.443590534042, -9796.474627663982, -10219.679317797105, -9017.536755873567, -3544.9226386414603, -7607.0993834555475, -5597.948413212328, -6978.243236509445, -10815.424840580896, -4810.542796986371, -8024.38002905223, -7984.275104088801, -4003.668928132944, -4359.208129112232, -7791.904146454751, -8990.656920506854, -5188.914657280769, -3545.437650380988, -3613.7169647725595, -8070.0609973106375, -10085.215668906014, -4934.406872195088, -9074.786768965649, -6489.545607653751, -344.15451998157783, -7421.964737479286, -6419.543082594805, -6415.84076644893, -7213.199311531795, -9008.843482372959, -6220.040221918668, -5642.762854260601, -117.24388255170994, -125.39713214013639, -8913.091872929695, -9772.412215976301, -7850.7101466337335, -3674.3394737358008, -4952.658222472965, -8612.57913120041, -6695.636650592771, -9140.014298830509, -6666.015999370593, -5616.568424448301, -4761.646748812497, -8916.858679577279, -6004.489467919894, -9016.695873332395, -5321.372994127331, -9500.142558316375, -4129.573932460184, -6000.429135445313, -1332.03064458536, -5048.286661049689, -8077.89283199116, -2891.421730055976, -9893.648961873276, -1058.2286444498925, -4618.425398250481, -8339.524351711483, -6451.455241604805, -4222.366177499283, -2876.8618289298965, -4689.963376776747, -8508.799913805076, -8737.366234553874, -6991.1047341798085, -8377.198535028952, -8853.556653429525, -9896.291092050385, -3559.11880928892, -941.5458504808645, -7320.581439867516, -6206.036482356432, -7527.453991024638, -3460.091677000305, -6906.905026309044, -7733.679909848654, -9313.650048956042, -5173.877699047021, -4089.2909579165616, -8541.288995252475, -5628.366208998122, -9983.619195529802, -4275.8367738831985, -7428.937206572414], "episode_lengths": [102, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 200, 200, 178, 156, 200, 200, 200, 200, 200, 9, 200, 200, 189, 200, 200, 200, 200, 17, 10, 200, 200, 200, 200, 139, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 133, 200, 200, 116, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 39, 200, 200, 157, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1148.755233337584, 2420.8351672621234, 3795.09849295701, 2454.7629001833548, 4145.312631709087, 2415.412951023507, 4621.462543131448, 898.1336063374944, 2695.9733049179613, 2252.560889654204, 3454.123819640751, 5924.005264279768, 7725.733891916651, 3391.1574047310246, 4276.640882627666, 7897.885711637895, 7095.945592998669, 5961.1159823308235, 2938.3327758034006, 2565.587801487765, 1768.4236652419836, 5578.147430833289, 2992.580022523358, 2212.183062156598, 7207.212125918199, 5745.5531569717305, 2419.614234701477, 1993.4143542830104, 5322.449797661407, 2408.829665788494, 4612.42850940523, 2972.3784510252485, 2036.161761093308, 6121.527904482594, 6917.305908919314, 4059.8257799845105, 6294.344494339709, 5223.420417985497, 24.91920000132361, 3936.866100382367, 5557.506319079317, 3463.154944662807, 3074.4478193857217, 7312.309989313101, 4253.6987039531905, 4931.0300383600525, 66.04907650932856, 29.941019138244496, 4096.649844728185, 2655.2218789861113, 6323.991510175346, 2707.285182228519, 1024.1875845134591, 3475.591162720978, 5682.172587352418, 7283.266874451207, 4599.580417145454, 2177.5703380542805, 2941.8534486192566, 5464.773147258216, 3496.4963344782545, 4655.237149528085, 2526.0659527954776, 8847.435066537757, 2671.5956836346445, 3972.0005281147737, 730.9780674320297, 2107.0072429312445, 7075.12271102508, 2066.2186574753946, 8128.610642778837, 279.6661906561898, 3286.286074561491, 6456.850473256837, 4452.610268627005, 3073.5562397057142, 1457.5258797633642, 4231.048376277087, 3347.566280574738, 1349.2004023226923, 4157.179074964962, 4592.5080817322, 5666.28462603847, 7913.8705845843115, 1956.7460289669564, 199.65841402074514, 6539.9970647080845, 1636.5899852529071, 1415.1287290573182, 2526.3401344979306, 2841.278185626914, 6627.8602177102775, 5903.186317058643, 3190.4614341892584, 3342.8419676870444, 3679.2231274201363, 1829.2681416351022, 4390.551298102536, 2932.79840200567, 6251.927141361177], "policy_adversary_policy_reward": [-2019.0020344316254, -1585.7008245929378, -5069.474640310388, -3934.206620161837, -3795.09849295701, -7266.081042665637, -5081.942932329126, -2454.7629001833548, -4163.598308683435, -7152.4147091902505, -2415.412951023507, -6290.407266294098, -6147.016416272373, -4624.720464988216, -3606.4321332315862, -1016.1004318664718, -6257.074505263532, -2949.038638265543, -3728.3565089489016, -2482.423408705329, -8261.497451044655, -3454.123819640751, -8420.824406910511, -5924.005264279768, -7989.122852543474, -8608.054719298656, -5491.961853264229, -3391.1574047310246, -4396.150633634168, -5372.933839527539, -7897.885711637895, -9796.47462766398, -10219.679317797109, -7095.945592998669, -8458.639603825222, -6520.013134379171, -2976.5558023661915, -3506.6996120786685, -7607.0993834555475, -2565.587801487765, -5597.948413212328, -1768.4236652419836, -6169.046920510087, -6387.343746832645, -10815.424840580898, -2992.580022523358, -4810.542796986371, -2212.183062156598, -7574.90600901533, -7656.686145955098, -7630.683271976488, -6099.144989084055, -4003.6689281329436, -2419.614234701477, -1993.4143542830104, -4359.208129112232, -5322.449797661407, -7791.90414645475, -8990.656920506854, -2408.829665788494, -5097.95388838829, -4703.389278297709, -3374.6845387857143, -3143.131562620523, -3613.71696477256, -2036.161761093308, -6121.527904482594, -8070.0609973106375, -9867.150706551305, -7135.370871274019, -4930.58998329027, -4063.6426688893293, -6295.541511673621, -9073.589751631738, -6450.646032964834, -5262.319992674414, -344.1545199815779, -24.91920000132361, -3936.866100382367, -7421.964737479286, -6255.658432070695, -5721.390969603428, -3825.2969641103114, -6053.698747001426, -3074.4478193857217, -7213.199311531795, -7319.714437100469, -9001.439034585592, -5367.8396626716685, -5105.899263200187, -5031.239575464993, -5542.55331715566, -107.54694948218983, -75.74600957884867, -29.941019138244496, -125.39713214013639, -4096.649844728185, -8913.091872929695, -9772.412215976301, -2655.2218789861113, -6597.6956961646, -7577.00596064448, -3110.7518459626494, -3270.8728100016697, -4952.6582224729655, -1024.1875845134591, -3475.591162720978, -8612.57913120041, -5908.387432701343, -6469.4218052438455, -7293.263094128921, -9130.018079152793, -6511.947035767225, -4753.649380748827, -5508.563293735042, -2285.575468767539, -2979.4507313156546, -4724.049466116099, -5466.008434868543, -8915.623391966952, -6004.1495140119605, -3496.8362883861873, -4655.237149528085, -9016.695873332395, -2531.5081427721807, -5315.930804150627, -9348.274978049167, -8999.302646804965, -2697.3028238495544, -4103.866792245273, -4762.747672095626, -5209.68199146446, -1163.55514950256, -899.45356251483, -5047.7514902558205, -2107.542413725113, -7102.400006896231, -8050.615536120009, -2066.2186574753946, -2891.421730055976, -8131.070253563687, -9891.189351088426, -279.6661906561898, -1058.2286444498925, -4533.28249647307, -3371.4289763388992, -6497.283458884284, -8299.091366084036, -6451.455241604806, -4452.610268627005, -3543.3643009907396, -3752.558116214259, -1659.060034783773, -2675.3276739094886, -4646.0447523309, -4274.967000722936, -3347.566280574738, -8508.799913805076, -8737.366234553872, -1349.2004023226923, -6991.104734179808, -4157.179074964962, -8377.19853502895, -4592.5080817322, -5666.28462603847, -8853.556653429525, -9896.291092050387, -7913.8705845843115, -1956.7460289669564, -3559.11880928892, -199.65841402074514, -941.5458504808645, -6841.405483592264, -7019.173020983334, -6206.036482356431, -1636.5899852529071, -1415.1287290573182, -7527.453991024638, -3430.702243544536, -2555.729567953699, -6906.905026309043, -2841.278185626914, -7695.769290584251, -6665.770836974685, -6950.43182911202, -8266.40453690267, -3786.3859949741336, -4577.953138262144, -3661.185996272939, -3770.9469293306665, -3679.2231274201363, -8541.288995252475, -2427.78298190653, -5029.851368726696, -4390.551298102536, -9983.619195529802, -3805.8965250589927, -3402.7386508298764, -6460.48385769417, -7220.380490239421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42686083933403085, "mean_inference_ms": 1.0424045937703195, "mean_action_processing_ms": 0.17923489035210405, "mean_env_wait_ms": 0.05446958158031321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004221081733703613, "StateBufferConnector_ms": 0.002762317657470703, "ViewRequirementAgentConnector_ms": 0.09116637706756592}, "num_episodes": 21, "episode_return_max": -117.24388255170994, "episode_return_min": -10815.424840580896, "episode_return_mean": -6357.0210804868475}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.9582833777237, "num_env_steps_trained_throughput_per_sec": 485.9582833777237, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 8088.623, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8088.504, "sample_time_ms": 833.411, "learn_time_ms": 7238.203, "learn_throughput": 552.623, "synch_weights_time_ms": 16.194}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 21, "trial_id": "3439d_00000", "date": "2024-08-09_15-28-49", "timestamp": 1723231729, "time_this_iter_s": 8.236956119537354, "time_total_s": 161.01955795288086, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 161.01955795288086, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.65833333333333, "ram_util_percent": 79.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7305676154792309, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97907652358214, "policy_loss": -0.003971894695617569, "vf_loss": 9.979061890641848, "vf_explained_var": 5.7855931421120964e-05, "kl": 0.00885895585330824, "entropy": 1.4205628720422585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7740839016185236, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988046417539081, "policy_loss": -0.005021259242486425, "vf_loss": 9.989602957831488, "vf_explained_var": -0.000102477508877951, "kl": 0.01732377530070682, "entropy": 1.5736578588763241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -117.24388255170994, "episode_reward_min": -10085.215668906014, "episode_reward_mean": -6212.047825517926, "episode_len_mean": 181.54, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18154, "policy_reward_min": {"agent_policy": 24.91920000132361, "adversary_policy": -9983.619195529802}, "policy_reward_max": {"agent_policy": 8847.435066537757, "adversary_policy": -24.91920000132361}, "policy_reward_mean": {"agent_policy": 3827.243295585633, "adversary_policy": -5019.645560551779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4810.542796986371, -8024.38002905223, -7984.275104088801, -4003.668928132944, -4359.208129112232, -7791.904146454751, -8990.656920506854, -5188.914657280769, -3545.437650380988, -3613.7169647725595, -8070.0609973106375, -10085.215668906014, -4934.406872195088, -9074.786768965649, -6489.545607653751, -344.15451998157783, -7421.964737479286, -6419.543082594805, -6415.84076644893, -7213.199311531795, -9008.843482372959, -6220.040221918668, -5642.762854260601, -117.24388255170994, -125.39713214013639, -8913.091872929695, -9772.412215976301, -7850.7101466337335, -3674.3394737358008, -4952.658222472965, -8612.57913120041, -6695.636650592771, -9140.014298830509, -6666.015999370593, -5616.568424448301, -4761.646748812497, -8916.858679577279, -6004.489467919894, -9016.695873332395, -5321.372994127331, -9500.142558316375, -4129.573932460184, -6000.429135445313, -1332.03064458536, -5048.286661049689, -8077.89283199116, -2891.421730055976, -9893.648961873276, -1058.2286444498925, -4618.425398250481, -8339.524351711483, -6451.455241604805, -4222.366177499283, -2876.8618289298965, -4689.963376776747, -8508.799913805076, -8737.366234553874, -6991.1047341798085, -8377.198535028952, -8853.556653429525, -9896.291092050385, -3559.11880928892, -941.5458504808645, -7320.581439867516, -6206.036482356432, -7527.453991024638, -3460.091677000305, -6906.905026309044, -7733.679909848654, -9313.650048956042, -5173.877699047021, -4089.2909579165616, -8541.288995252475, -5628.366208998122, -9983.619195529802, -4275.8367738831985, -7428.937206572414, -7112.597799932104, -7225.164626611676, -5711.635347907509, -5123.363151136232, -5214.440043682835, -8620.256063782232, -566.3626739714698, -9209.007501686005, -5856.096943948653, -7774.113259821924, -1357.7072331836728, -4232.565295838555, -8877.095451311689, -3105.050449162949, -459.0259945096208, -5221.623962570112, -7185.16051131576, -8384.862293081931, -8698.440808888476, -8510.151081556784, -5208.872867191665, -7477.509455774947, -9678.029391505643], "episode_lengths": [161, 200, 200, 200, 200, 200, 200, 200, 178, 156, 200, 200, 200, 200, 200, 9, 200, 200, 189, 200, 200, 200, 200, 17, 10, 200, 200, 200, 200, 139, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 133, 200, 200, 116, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 39, 200, 200, 157, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 91, 200, 200, 149, 20, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2212.183062156598, 7207.212125918199, 5745.5531569717305, 2419.614234701477, 1993.4143542830104, 5322.449797661407, 2408.829665788494, 4612.42850940523, 2972.3784510252485, 2036.161761093308, 6121.527904482594, 6917.305908919314, 4059.8257799845105, 6294.344494339709, 5223.420417985497, 24.91920000132361, 3936.866100382367, 5557.506319079317, 3463.154944662807, 3074.4478193857217, 7312.309989313101, 4253.6987039531905, 4931.0300383600525, 66.04907650932856, 29.941019138244496, 4096.649844728185, 2655.2218789861113, 6323.991510175346, 2707.285182228519, 1024.1875845134591, 3475.591162720978, 5682.172587352418, 7283.266874451207, 4599.580417145454, 2177.5703380542805, 2941.8534486192566, 5464.773147258216, 3496.4963344782545, 4655.237149528085, 2526.0659527954776, 8847.435066537757, 2671.5956836346445, 3972.0005281147737, 730.9780674320297, 2107.0072429312445, 7075.12271102508, 2066.2186574753946, 8128.610642778837, 279.6661906561898, 3286.286074561491, 6456.850473256837, 4452.610268627005, 3073.5562397057142, 1457.5258797633642, 4231.048376277087, 3347.566280574738, 1349.2004023226923, 4157.179074964962, 4592.5080817322, 5666.28462603847, 7913.8705845843115, 1956.7460289669564, 199.65841402074514, 6539.9970647080845, 1636.5899852529071, 1415.1287290573182, 2526.3401344979306, 2841.278185626914, 6627.8602177102775, 5903.186317058643, 3190.4614341892584, 3342.8419676870444, 3679.2231274201363, 1829.2681416351022, 4390.551298102536, 2932.79840200567, 6251.927141361177, 2801.505178382746, 4332.264810692946, 4127.408989253012, 4417.0365000864185, 2122.5529685737683, 6978.720419900755, 46.61927486383762, 3195.8228996195357, 4894.847162411852, 3795.852828792505, 689.5061574683341, 1928.525992351611, 7593.398294938565, 1254.219769589634, 72.00813707345345, 3293.5999114207602, 6267.550187389077, 5820.871545631386, 2652.1668486059257, 3908.446059111241, 2590.1689209270844, 5130.389727632345, 6377.352983013962], "policy_adversary_policy_reward": [-4810.542796986371, -2212.183062156598, -7574.90600901533, -7656.686145955098, -7630.683271976488, -6099.144989084055, -4003.6689281329436, -2419.614234701477, -1993.4143542830104, -4359.208129112232, -5322.449797661407, -7791.90414645475, -8990.656920506854, -2408.829665788494, -5097.95388838829, -4703.389278297709, -3374.6845387857143, -3143.131562620523, -3613.71696477256, -2036.161761093308, -6121.527904482594, -8070.0609973106375, -9867.150706551305, -7135.370871274019, -4930.58998329027, -4063.6426688893293, -6295.541511673621, -9073.589751631738, -6450.646032964834, -5262.319992674414, -344.1545199815779, -24.91920000132361, -3936.866100382367, -7421.964737479286, -6255.658432070695, -5721.390969603428, -3825.2969641103114, -6053.698747001426, -3074.4478193857217, -7213.199311531795, -7319.714437100469, -9001.439034585592, -5367.8396626716685, -5105.899263200187, -5031.239575464993, -5542.55331715566, -107.54694948218983, -75.74600957884867, -29.941019138244496, -125.39713214013639, -4096.649844728185, -8913.091872929695, -9772.412215976301, -2655.2218789861113, -6597.6956961646, -7577.00596064448, -3110.7518459626494, -3270.8728100016697, -4952.6582224729655, -1024.1875845134591, -3475.591162720978, -8612.57913120041, -5908.387432701343, -6469.4218052438455, -7293.263094128921, -9130.018079152793, -6511.947035767225, -4753.649380748827, -5508.563293735042, -2285.575468767539, -2979.4507313156546, -4724.049466116099, -5466.008434868543, -8915.623391966952, -6004.1495140119605, -3496.8362883861873, -4655.237149528085, -9016.695873332395, -2531.5081427721807, -5315.930804150627, -9348.274978049167, -8999.302646804965, -2697.3028238495544, -4103.866792245273, -4762.747672095626, -5209.68199146446, -1163.55514950256, -899.45356251483, -5047.7514902558205, -2107.542413725113, -7102.400006896231, -8050.615536120009, -2066.2186574753946, -2891.421730055976, -8131.070253563687, -9891.189351088426, -279.6661906561898, -1058.2286444498925, -4533.28249647307, -3371.4289763388992, -6497.283458884284, -8299.091366084036, -6451.455241604806, -4452.610268627005, -3543.3643009907396, -3752.558116214259, -1659.060034783773, -2675.3276739094886, -4646.0447523309, -4274.967000722936, -3347.566280574738, -8508.799913805076, -8737.366234553872, -1349.2004023226923, -6991.104734179808, -4157.179074964962, -8377.19853502895, -4592.5080817322, -5666.28462603847, -8853.556653429525, -9896.291092050387, -7913.8705845843115, -1956.7460289669564, -3559.11880928892, -199.65841402074514, -941.5458504808645, -6841.405483592264, -7019.173020983334, -6206.036482356431, -1636.5899852529071, -1415.1287290573182, -7527.453991024638, -3430.702243544536, -2555.729567953699, -6906.905026309043, -2841.278185626914, -7695.769290584251, -6665.770836974685, -6950.43182911202, -8266.40453690267, -3786.3859949741336, -4577.953138262144, -3661.185996272939, -3770.9469293306665, -3679.2231274201363, -8541.288995252475, -2427.78298190653, -5029.851368726696, -4390.551298102536, -9983.619195529802, -3805.8965250589927, -3402.7386508298764, -6460.48385769417, -7220.380490239421, -2801.505178382746, -7112.597799932104, -4595.023218985945, -6962.406218318677, -4278.544934360246, -5560.499402800275, -4667.567635778267, -4872.832015444386, -4531.708358870713, -2805.284653385886, -8619.46612264022, -6979.510361042764, -46.61927486383762, -566.3626739714698, -3195.8228996195357, -9209.007501686005, -5802.918049666087, -4948.026056694418, -7774.113259821924, -3795.852828792505, -1172.851221607477, -874.3621690445303, -1929.6198580182702, -4231.471430171897, -8798.337031817995, -7672.156714432255, -1254.219769589634, -3105.050449162949, -72.00813707345345, -459.0259945096208, -3557.456791531097, -4957.767082459772, -6278.355480699553, -7174.355218005285, -6984.056669328373, -7221.67716938495, -2652.1668486059257, -8698.440808888476, -4219.193571666529, -8199.403569001495, -2590.1689209270844, -5208.872867191665, -5304.683348400688, -7303.215835006606, -9678.029391505643, -6377.352983013962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4295761509854688, "mean_inference_ms": 1.0499688253181383, "mean_action_processing_ms": 0.18060873605993608, "mean_env_wait_ms": 0.05487578239320811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004948973655700684, "StateBufferConnector_ms": 0.002980828285217285, "ViewRequirementAgentConnector_ms": 0.09209263324737549}, "num_episodes": 23, "episode_return_max": -117.24388255170994, "episode_return_min": -10085.215668906014, "episode_return_mean": -6212.047825517926}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.35183543292084, "num_env_steps_trained_throughput_per_sec": 503.35183543292084, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 8168.118, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8167.999, "sample_time_ms": 858.964, "learn_time_ms": 7291.972, "learn_throughput": 548.548, "synch_weights_time_ms": 16.38}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 22, "trial_id": "3439d_00000", "date": "2024-08-09_15-28-57", "timestamp": 1723231737, "time_this_iter_s": 7.951758146286011, "time_total_s": 168.97131609916687, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a4a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.97131609916687, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.108333333333334, "ram_util_percent": 79.50833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7178876262779037, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99485012392203, "policy_loss": -0.001145277473066623, "vf_loss": 9.990615079800287, "vf_explained_var": -8.079285422960918e-06, "kl": 0.011956235130977195, "entropy": 1.3884970902154843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7634320171421798, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991766089989394, "policy_loss": -0.0056583869298082335, "vf_loss": 9.99522355700296, "vf_explained_var": -0.00012799425730629572, "kl": 0.011004691020087906, "entropy": 1.5567338148752847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": -117.24388255170994, "episode_reward_min": -11221.963157425105, "episode_reward_mean": -6452.888620804192, "episode_len_mean": 183.63, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18363, "policy_reward_min": {"agent_policy": 29.941019138244496, "adversary_policy": -10676.594891029106}, "policy_reward_max": {"agent_policy": 8847.435066537757, "adversary_policy": -29.941019138244496}, "policy_reward_mean": {"agent_policy": 3881.2930280175265, "adversary_policy": -5167.090824410859}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5642.762854260601, -117.24388255170994, -125.39713214013639, -8913.091872929695, -9772.412215976301, -7850.7101466337335, -3674.3394737358008, -4952.658222472965, -8612.57913120041, -6695.636650592771, -9140.014298830509, -6666.015999370593, -5616.568424448301, -4761.646748812497, -8916.858679577279, -6004.489467919894, -9016.695873332395, -5321.372994127331, -9500.142558316375, -4129.573932460184, -6000.429135445313, -1332.03064458536, -5048.286661049689, -8077.89283199116, -2891.421730055976, -9893.648961873276, -1058.2286444498925, -4618.425398250481, -8339.524351711483, -6451.455241604805, -4222.366177499283, -2876.8618289298965, -4689.963376776747, -8508.799913805076, -8737.366234553874, -6991.1047341798085, -8377.198535028952, -8853.556653429525, -9896.291092050385, -3559.11880928892, -941.5458504808645, -7320.581439867516, -6206.036482356432, -7527.453991024638, -3460.091677000305, -6906.905026309044, -7733.679909848654, -9313.650048956042, -5173.877699047021, -4089.2909579165616, -8541.288995252475, -5628.366208998122, -9983.619195529802, -4275.8367738831985, -7428.937206572414, -7112.597799932104, -7225.164626611676, -5711.635347907509, -5123.363151136232, -5214.440043682835, -8620.256063782232, -566.3626739714698, -9209.007501686005, -5856.096943948653, -7774.113259821924, -1357.7072331836728, -4232.565295838555, -8877.095451311689, -3105.050449162949, -459.0259945096208, -5221.623962570112, -7185.16051131576, -8384.862293081931, -8698.440808888476, -8510.151081556784, -5208.872867191665, -7477.509455774947, -9678.029391505643, -8509.607583275987, -6244.980018514064, -7502.3704885788275, -10417.1192745315, -7389.079270063395, -9162.805455358806, -6871.239897557249, -9035.09506850628, -9409.762497544265, -7240.102716627298, -6738.774579177495, -3415.59261595691, -6678.758004348296, -4497.421346102285, -10141.987791300093, -5809.615780686315, -11221.963157425105, -5160.899811301011, -4041.9181181034214, -6673.644418361681, -8423.814188449862, -9507.834810984044], "episode_lengths": [200, 17, 10, 200, 200, 200, 200, 139, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 133, 200, 200, 116, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 39, 200, 200, 157, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 91, 200, 200, 149, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 133, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4931.0300383600525, 66.04907650932856, 29.941019138244496, 4096.649844728185, 2655.2218789861113, 6323.991510175346, 2707.285182228519, 1024.1875845134591, 3475.591162720978, 5682.172587352418, 7283.266874451207, 4599.580417145454, 2177.5703380542805, 2941.8534486192566, 5464.773147258216, 3496.4963344782545, 4655.237149528085, 2526.0659527954776, 8847.435066537757, 2671.5956836346445, 3972.0005281147737, 730.9780674320297, 2107.0072429312445, 7075.12271102508, 2066.2186574753946, 8128.610642778837, 279.6661906561898, 3286.286074561491, 6456.850473256837, 4452.610268627005, 3073.5562397057142, 1457.5258797633642, 4231.048376277087, 3347.566280574738, 1349.2004023226923, 4157.179074964962, 4592.5080817322, 5666.28462603847, 7913.8705845843115, 1956.7460289669564, 199.65841402074514, 6539.9970647080845, 1636.5899852529071, 1415.1287290573182, 2526.3401344979306, 2841.278185626914, 6627.8602177102775, 5903.186317058643, 3190.4614341892584, 3342.8419676870444, 3679.2231274201363, 1829.2681416351022, 4390.551298102536, 2932.79840200567, 6251.927141361177, 2801.505178382746, 4332.264810692946, 4127.408989253012, 4417.0365000864185, 2122.5529685737683, 6978.720419900755, 46.61927486383762, 3195.8228996195357, 4894.847162411852, 3795.852828792505, 689.5061574683341, 1928.525992351611, 7593.398294938565, 1254.219769589634, 72.00813707345345, 3293.5999114207602, 6267.550187389077, 5820.871545631386, 2652.1668486059257, 3908.446059111241, 2590.1689209270844, 5130.389727632345, 6377.352983013962, 5629.812986887492, 4949.607301999719, 4322.841304709601, 5936.88757853271, 6157.830371683263, 3204.6705614551875, 2133.2421782983342, 7958.206064298761, 4676.403908074996, 1848.6362652584305, 5314.3083867222385, 1826.245198511628, 3932.164814107162, 3507.576807222021, 6578.917512384654, 3916.567916802233, 8295.899615966866, 3787.6128855638003, 2699.266925133293, 1604.551445315758, 4248.742726165032, 6044.5331895902755], "policy_adversary_policy_reward": [-5031.239575464993, -5542.55331715566, -107.54694948218983, -75.74600957884867, -29.941019138244496, -125.39713214013639, -4096.649844728185, -8913.091872929695, -9772.412215976301, -2655.2218789861113, -6597.6956961646, -7577.00596064448, -3110.7518459626494, -3270.8728100016697, -4952.6582224729655, -1024.1875845134591, -3475.591162720978, -8612.57913120041, -5908.387432701343, -6469.4218052438455, -7293.263094128921, -9130.018079152793, -6511.947035767225, -4753.649380748827, -5508.563293735042, -2285.575468767539, -2979.4507313156546, -4724.049466116099, -5466.008434868543, -8915.623391966952, -6004.1495140119605, -3496.8362883861873, -4655.237149528085, -9016.695873332395, -2531.5081427721807, -5315.930804150627, -9348.274978049167, -8999.302646804965, -2697.3028238495544, -4103.866792245273, -4762.747672095626, -5209.68199146446, -1163.55514950256, -899.45356251483, -5047.7514902558205, -2107.542413725113, -7102.400006896231, -8050.615536120009, -2066.2186574753946, -2891.421730055976, -8131.070253563687, -9891.189351088426, -279.6661906561898, -1058.2286444498925, -4533.28249647307, -3371.4289763388992, -6497.283458884284, -8299.091366084036, -6451.455241604806, -4452.610268627005, -3543.3643009907396, -3752.558116214259, -1659.060034783773, -2675.3276739094886, -4646.0447523309, -4274.967000722936, -3347.566280574738, -8508.799913805076, -8737.366234553872, -1349.2004023226923, -6991.104734179808, -4157.179074964962, -8377.19853502895, -4592.5080817322, -5666.28462603847, -8853.556653429525, -9896.291092050387, -7913.8705845843115, -1956.7460289669564, -3559.11880928892, -199.65841402074514, -941.5458504808645, -6841.405483592264, -7019.173020983334, -6206.036482356431, -1636.5899852529071, -1415.1287290573182, -7527.453991024638, -3430.702243544536, -2555.729567953699, -6906.905026309043, -2841.278185626914, -7695.769290584251, -6665.770836974685, -6950.43182911202, -8266.40453690267, -3786.3859949741336, -4577.953138262144, -3661.185996272939, -3770.9469293306665, -3679.2231274201363, -8541.288995252475, -2427.78298190653, -5029.851368726696, -4390.551298102536, -9983.619195529802, -3805.8965250589927, -3402.7386508298764, -6460.48385769417, -7220.380490239421, -2801.505178382746, -7112.597799932104, -4595.023218985945, -6962.406218318677, -4278.544934360246, -5560.499402800275, -4667.567635778267, -4872.832015444386, -4531.708358870713, -2805.284653385886, -8619.46612264022, -6979.510361042764, -46.61927486383762, -566.3626739714698, -3195.8228996195357, -9209.007501686005, -5802.918049666087, -4948.026056694418, -7774.113259821924, -3795.852828792505, -1172.851221607477, -874.3621690445303, -1929.6198580182702, -4231.471430171897, -8798.337031817995, -7672.156714432255, -1254.219769589634, -3105.050449162949, -72.00813707345345, -459.0259945096208, -3557.456791531097, -4957.767082459772, -6278.355480699553, -7174.355218005285, -6984.056669328373, -7221.67716938495, -2652.1668486059257, -8698.440808888476, -4219.193571666529, -8199.403569001495, -2590.1689209270844, -5208.872867191665, -5304.683348400688, -7303.215835006606, -9678.029391505643, -6377.352983013962, -8509.607583275987, -5629.812986887492, -5201.438377187489, -5993.148943326292, -4660.955417397236, -7164.256375891188, -10417.119274531502, -5936.88757853271, -7359.1282862672, -6187.781355479457, -9162.805455358804, -3204.6705614551875, -2463.521072615098, -6540.9610032404835, -8819.272230118555, -8174.02890268649, -4712.693593644715, -9373.472811974547, -7240.102716627298, -1848.6362652584305, -5314.3083867222385, -6738.774579177495, -2534.886334542946, -2706.9514799255917, -3932.164814107162, -6678.758004348296, -4274.788563467121, -3730.2095898571806, -6578.917512384654, -10141.987791300093, -4113.672552064891, -5612.511145423659, -8841.267882362858, -10676.594891029106, -3787.6128855638003, -5160.899811301011, -4027.2168256336226, -2713.9682176030915, -1604.551445315758, -6673.6444183616795, -4248.742726165032, -8423.814188449862, -9395.608963379556, -6156.759037194765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4312080849225541, "mean_inference_ms": 1.052490667568452, "mean_action_processing_ms": 0.1812017387937331, "mean_env_wait_ms": 0.05511807183914148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004790306091308594, "StateBufferConnector_ms": 0.0029505491256713867, "ViewRequirementAgentConnector_ms": 0.08476674556732178}, "num_episodes": 22, "episode_return_max": -117.24388255170994, "episode_return_min": -11221.963157425105, "episode_return_mean": -6452.888620804192}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.2401135650647, "num_env_steps_trained_throughput_per_sec": 523.2401135650647, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 8210.614, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8210.494, "sample_time_ms": 861.239, "learn_time_ms": 7331.805, "learn_throughput": 545.568, "synch_weights_time_ms": 16.768}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 23, "trial_id": "3439d_00000", "date": "2024-08-09_15-29-05", "timestamp": 1723231745, "time_this_iter_s": 7.650665998458862, "time_total_s": 176.62198209762573, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac08b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.62198209762573, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.763636363636362, "ram_util_percent": 79.26363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7274043958013257, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985075329740843, "policy_loss": 0.0008370964603576188, "vf_loss": 9.974963116645814, "vf_explained_var": -0.0003294928620258967, "kl": 0.020611278572080966, "entropy": 1.3444432272265354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7880272509875121, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983538332439604, "policy_loss": -0.004431503631480077, "vf_loss": 9.985246467085743, "vf_explained_var": -9.540010381627966e-05, "kl": 0.013616836656417166, "entropy": 1.5708878364512529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -68.04769951352975, "episode_reward_min": -11221.963157425105, "episode_reward_mean": -6479.337983286922, "episode_len_mean": 183.99, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18399, "policy_reward_min": {"agent_policy": 5.8023601890388345, "adversary_policy": -11069.425479911366}, "policy_reward_max": {"agent_policy": 8295.899615966866, "adversary_policy": -5.8023601890388345}, "policy_reward_mean": {"agent_policy": 3806.495725710758, "adversary_policy": -5142.916854498841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5048.286661049689, -8077.89283199116, -2891.421730055976, -9893.648961873276, -1058.2286444498925, -4618.425398250481, -8339.524351711483, -6451.455241604805, -4222.366177499283, -2876.8618289298965, -4689.963376776747, -8508.799913805076, -8737.366234553874, -6991.1047341798085, -8377.198535028952, -8853.556653429525, -9896.291092050385, -3559.11880928892, -941.5458504808645, -7320.581439867516, -6206.036482356432, -7527.453991024638, -3460.091677000305, -6906.905026309044, -7733.679909848654, -9313.650048956042, -5173.877699047021, -4089.2909579165616, -8541.288995252475, -5628.366208998122, -9983.619195529802, -4275.8367738831985, -7428.937206572414, -7112.597799932104, -7225.164626611676, -5711.635347907509, -5123.363151136232, -5214.440043682835, -8620.256063782232, -566.3626739714698, -9209.007501686005, -5856.096943948653, -7774.113259821924, -1357.7072331836728, -4232.565295838555, -8877.095451311689, -3105.050449162949, -459.0259945096208, -5221.623962570112, -7185.16051131576, -8384.862293081931, -8698.440808888476, -8510.151081556784, -5208.872867191665, -7477.509455774947, -9678.029391505643, -8509.607583275987, -6244.980018514064, -7502.3704885788275, -10417.1192745315, -7389.079270063395, -9162.805455358806, -6871.239897557249, -9035.09506850628, -9409.762497544265, -7240.102716627298, -6738.774579177495, -3415.59261595691, -6678.758004348296, -4497.421346102285, -10141.987791300093, -5809.615780686315, -11221.963157425105, -5160.899811301011, -4041.9181181034214, -6673.644418361681, -8423.814188449862, -9507.834810984044, -8701.135648897076, -6885.444861032273, -4479.804553861971, -6293.116512245045, -6508.480365900973, -5184.9520577225985, -4171.843213632437, -5574.101248978124, -7444.507789582455, -4823.371736983607, -8254.304100578662, -9413.18734641088, -11069.425479911366, -8282.691088018522, -7508.170473591528, -713.0200997491072, -6901.211813062919, -3243.073284435776, -6732.721068882986, -5848.438190736589, -7306.557954264921, -68.04769951352975], "episode_lengths": [200, 200, 116, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 39, 200, 200, 157, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 91, 200, 200, 149, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 133, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 141, 200, 200, 200, 4], "policy_agent_policy_reward": [2107.0072429312445, 7075.12271102508, 2066.2186574753946, 8128.610642778837, 279.6661906561898, 3286.286074561491, 6456.850473256837, 4452.610268627005, 3073.5562397057142, 1457.5258797633642, 4231.048376277087, 3347.566280574738, 1349.2004023226923, 4157.179074964962, 4592.5080817322, 5666.28462603847, 7913.8705845843115, 1956.7460289669564, 199.65841402074514, 6539.9970647080845, 1636.5899852529071, 1415.1287290573182, 2526.3401344979306, 2841.278185626914, 6627.8602177102775, 5903.186317058643, 3190.4614341892584, 3342.8419676870444, 3679.2231274201363, 1829.2681416351022, 4390.551298102536, 2932.79840200567, 6251.927141361177, 2801.505178382746, 4332.264810692946, 4127.408989253012, 4417.0365000864185, 2122.5529685737683, 6978.720419900755, 46.61927486383762, 3195.8228996195357, 4894.847162411852, 3795.852828792505, 689.5061574683341, 1928.525992351611, 7593.398294938565, 1254.219769589634, 72.00813707345345, 3293.5999114207602, 6267.550187389077, 5820.871545631386, 2652.1668486059257, 3908.446059111241, 2590.1689209270844, 5130.389727632345, 6377.352983013962, 5629.812986887492, 4949.607301999719, 4322.841304709601, 5936.88757853271, 6157.830371683263, 3204.6705614551875, 2133.2421782983342, 7958.206064298761, 4676.403908074996, 1848.6362652584305, 5314.3083867222385, 1826.245198511628, 3932.164814107162, 3507.576807222021, 6578.917512384654, 3916.567916802233, 8295.899615966866, 3787.6128855638003, 2699.266925133293, 1604.551445315758, 4248.742726165032, 6044.5331895902755, 2687.744297205355, 2546.640663784929, 2778.8016920564187, 4648.426515148206, 4304.42616630072, 4432.040780986445, 1222.9500111227721, 3576.5676072461424, 4625.394060965519, 4201.74516969391, 3735.352128877143, 2580.74163066068, 4173.228681420548, 4886.251350389962, 4305.137049873016, 323.90792623740697, 2874.8673544653125, 2490.2922010530338, 4735.345268870099, 5311.374626461769, 2432.205119076812, 5.8023601890388345], "policy_adversary_policy_reward": [-5047.7514902558205, -2107.542413725113, -7102.400006896231, -8050.615536120009, -2066.2186574753946, -2891.421730055976, -8131.070253563687, -9891.189351088426, -279.6661906561898, -1058.2286444498925, -4533.28249647307, -3371.4289763388992, -6497.283458884284, -8299.091366084036, -6451.455241604806, -4452.610268627005, -3543.3643009907396, -3752.558116214259, -1659.060034783773, -2675.3276739094886, -4646.0447523309, -4274.967000722936, -3347.566280574738, -8508.799913805076, -8737.366234553872, -1349.2004023226923, -6991.104734179808, -4157.179074964962, -8377.19853502895, -4592.5080817322, -5666.28462603847, -8853.556653429525, -9896.291092050387, -7913.8705845843115, -1956.7460289669564, -3559.11880928892, -199.65841402074514, -941.5458504808645, -6841.405483592264, -7019.173020983334, -6206.036482356431, -1636.5899852529071, -1415.1287290573182, -7527.453991024638, -3430.702243544536, -2555.729567953699, -6906.905026309043, -2841.278185626914, -7695.769290584251, -6665.770836974685, -6950.43182911202, -8266.40453690267, -3786.3859949741336, -4577.953138262144, -3661.185996272939, -3770.9469293306665, -3679.2231274201363, -8541.288995252475, -2427.78298190653, -5029.851368726696, -4390.551298102536, -9983.619195529802, -3805.8965250589927, -3402.7386508298764, -6460.48385769417, -7220.380490239421, -2801.505178382746, -7112.597799932104, -4595.023218985945, -6962.406218318677, -4278.544934360246, -5560.499402800275, -4667.567635778267, -4872.832015444386, -4531.708358870713, -2805.284653385886, -8619.46612264022, -6979.510361042764, -46.61927486383762, -566.3626739714698, -3195.8228996195357, -9209.007501686005, -5802.918049666087, -4948.026056694418, -7774.113259821924, -3795.852828792505, -1172.851221607477, -874.3621690445303, -1929.6198580182702, -4231.471430171897, -8798.337031817995, -7672.156714432255, -1254.219769589634, -3105.050449162949, -72.00813707345345, -459.0259945096208, -3557.456791531097, -4957.767082459772, -6278.355480699553, -7174.355218005285, -6984.056669328373, -7221.67716938495, -2652.1668486059257, -8698.440808888476, -4219.193571666529, -8199.403569001495, -2590.1689209270844, -5208.872867191665, -5304.683348400688, -7303.215835006606, -9678.029391505643, -6377.352983013962, -8509.607583275987, -5629.812986887492, -5201.438377187489, -5993.148943326292, -4660.955417397236, -7164.256375891188, -10417.119274531502, -5936.88757853271, -7359.1282862672, -6187.781355479457, -9162.805455358804, -3204.6705614551875, -2463.521072615098, -6540.9610032404835, -8819.272230118555, -8174.02890268649, -4712.693593644715, -9373.472811974547, -7240.102716627298, -1848.6362652584305, -5314.3083867222385, -6738.774579177495, -2534.886334542946, -2706.9514799255917, -3932.164814107162, -6678.758004348296, -4274.788563467121, -3730.2095898571806, -6578.917512384654, -10141.987791300093, -4113.672552064891, -5612.511145423659, -8841.267882362858, -10676.594891029106, -3787.6128855638003, -5160.899811301011, -4027.2168256336226, -2713.9682176030915, -1604.551445315758, -6673.6444183616795, -4248.742726165032, -8423.814188449862, -9395.608963379556, -6156.759037194765, -8701.135648897078, -2687.744297205355, -2546.640663784929, -6885.444861032273, -2801.3463272818003, -4457.25991863659, -5025.251871442268, -5916.291155950985, -5503.82946312938, -5309.077069072307, -4593.770447744364, -5023.222390964677, -2220.598946336681, -3174.194278418533, -5568.098289869723, -3582.5705663545446, -7319.163888175278, -4750.7379623726965, -4553.817534420106, -4471.299372257413, -7768.2051680374625, -4221.451061418341, -9413.187346410881, -2580.74163066068, -4173.228681420548, -11069.425479911366, -5592.662198039204, -7576.280240369275, -4325.476987244813, -7487.83053621973, -323.90792623740697, -713.0200997491072, -3914.4195961463065, -5861.659571381924, -2492.8531120795815, -3240.512373409228, -5103.618663926759, -6364.4476738263265, -5774.042042883054, -5385.770774315303, -7171.571666691019, -2567.191406650712, -5.8023601890388345, -68.04769951352975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43176947062743465, "mean_inference_ms": 1.0556291991255753, "mean_action_processing_ms": 0.18134391639733624, "mean_env_wait_ms": 0.05505415096106333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248261451721191, "StateBufferConnector_ms": 0.002831578254699707, "ViewRequirementAgentConnector_ms": 0.0806891918182373}, "num_episodes": 22, "episode_return_max": -68.04769951352975, "episode_return_min": -11221.963157425105, "episode_return_mean": -6479.337983286922}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.73221601569094, "num_env_steps_trained_throughput_per_sec": 446.73221601569094, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 8388.984, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8388.863, "sample_time_ms": 868.958, "learn_time_ms": 7501.576, "learn_throughput": 533.221, "synch_weights_time_ms": 17.508}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 24, "trial_id": "3439d_00000", "date": "2024-08-09_15-29-14", "timestamp": 1723231754, "time_this_iter_s": 9.017630100250244, "time_total_s": 185.63961219787598, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.63961219787598, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.4, "ram_util_percent": 80.00769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7114304429385812, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99882893661658, "policy_loss": 0.0006933395918167662, "vf_loss": 9.987800293167432, "vf_explained_var": 0.0004619115342696508, "kl": 0.015311559235366682, "entropy": 1.3362131539732218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7779332018560834, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98963403954077, "policy_loss": -0.006984154314600996, "vf_loss": 9.993867277720618, "vf_explained_var": -0.00011118514827950291, "kl": 0.013754612743292772, "entropy": 1.5600945459471809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -68.04769951352975, "episode_reward_min": -11221.963157425105, "episode_reward_mean": -6603.085541197347, "episode_len_mean": 186.03, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18603, "policy_reward_min": {"agent_policy": 5.8023601890388345, "adversary_policy": -11069.425479911366}, "policy_reward_max": {"agent_policy": 8295.899615966866, "adversary_policy": -5.8023601890388345}, "policy_reward_mean": {"agent_policy": 3837.237213769716, "adversary_policy": -5220.161377483531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6206.036482356432, -7527.453991024638, -3460.091677000305, -6906.905026309044, -7733.679909848654, -9313.650048956042, -5173.877699047021, -4089.2909579165616, -8541.288995252475, -5628.366208998122, -9983.619195529802, -4275.8367738831985, -7428.937206572414, -7112.597799932104, -7225.164626611676, -5711.635347907509, -5123.363151136232, -5214.440043682835, -8620.256063782232, -566.3626739714698, -9209.007501686005, -5856.096943948653, -7774.113259821924, -1357.7072331836728, -4232.565295838555, -8877.095451311689, -3105.050449162949, -459.0259945096208, -5221.623962570112, -7185.16051131576, -8384.862293081931, -8698.440808888476, -8510.151081556784, -5208.872867191665, -7477.509455774947, -9678.029391505643, -8509.607583275987, -6244.980018514064, -7502.3704885788275, -10417.1192745315, -7389.079270063395, -9162.805455358806, -6871.239897557249, -9035.09506850628, -9409.762497544265, -7240.102716627298, -6738.774579177495, -3415.59261595691, -6678.758004348296, -4497.421346102285, -10141.987791300093, -5809.615780686315, -11221.963157425105, -5160.899811301011, -4041.9181181034214, -6673.644418361681, -8423.814188449862, -9507.834810984044, -8701.135648897076, -6885.444861032273, -4479.804553861971, -6293.116512245045, -6508.480365900973, -5184.9520577225985, -4171.843213632437, -5574.101248978124, -7444.507789582455, -4823.371736983607, -8254.304100578662, -9413.18734641088, -11069.425479911366, -8282.691088018522, -7508.170473591528, -713.0200997491072, -6901.211813062919, -3243.073284435776, -6732.721068882986, -5848.438190736589, -7306.557954264921, -68.04769951352975, -5339.651385637366, -7303.985327967427, -8418.88511183724, -6410.9647896826855, -9730.48619679729, -7298.602018774585, -4796.1078913820165, -7286.449363303748, -5558.610649390846, -848.2155156996208, -7602.178261642406, -6741.833551528092, -6323.378728359886, -7890.444836424883, -9725.92647316375, -6443.0839324088365, -7517.15979833029, -6022.255971991692, -3592.2070078784145, -8877.967445718816], "episode_lengths": [200, 157, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 91, 200, 200, 149, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 133, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 141, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 113, 200], "policy_agent_policy_reward": [1636.5899852529071, 1415.1287290573182, 2526.3401344979306, 2841.278185626914, 6627.8602177102775, 5903.186317058643, 3190.4614341892584, 3342.8419676870444, 3679.2231274201363, 1829.2681416351022, 4390.551298102536, 2932.79840200567, 6251.927141361177, 2801.505178382746, 4332.264810692946, 4127.408989253012, 4417.0365000864185, 2122.5529685737683, 6978.720419900755, 46.61927486383762, 3195.8228996195357, 4894.847162411852, 3795.852828792505, 689.5061574683341, 1928.525992351611, 7593.398294938565, 1254.219769589634, 72.00813707345345, 3293.5999114207602, 6267.550187389077, 5820.871545631386, 2652.1668486059257, 3908.446059111241, 2590.1689209270844, 5130.389727632345, 6377.352983013962, 5629.812986887492, 4949.607301999719, 4322.841304709601, 5936.88757853271, 6157.830371683263, 3204.6705614551875, 2133.2421782983342, 7958.206064298761, 4676.403908074996, 1848.6362652584305, 5314.3083867222385, 1826.245198511628, 3932.164814107162, 3507.576807222021, 6578.917512384654, 3916.567916802233, 8295.899615966866, 3787.6128855638003, 2699.266925133293, 1604.551445315758, 4248.742726165032, 6044.5331895902755, 2687.744297205355, 2546.640663784929, 2778.8016920564187, 4648.426515148206, 4304.42616630072, 4432.040780986445, 1222.9500111227721, 3576.5676072461424, 4625.394060965519, 4201.74516969391, 3735.352128877143, 2580.74163066068, 4173.228681420548, 4886.251350389962, 4305.137049873016, 323.90792623740697, 2874.8673544653125, 2490.2922010530338, 4735.345268870099, 5311.374626461769, 2432.205119076812, 5.8023601890388345, 2036.5353557389296, 2314.2477756780654, 6822.411147962351, 5331.255617179203, 7873.7631308059445, 6288.07674498576, 3689.4538471025667, 5006.032412813814, 3759.172458446125, 135.47924673537582, 2585.373803662063, 1610.2725557616732, 3529.9856454130977, 6686.466849999023, 5135.160981401388, 5282.551475406789, 6600.885363096483, 3804.6754973050915, 1191.0995266975583, 1728.762684675939], "policy_adversary_policy_reward": [-6206.036482356431, -1636.5899852529071, -1415.1287290573182, -7527.453991024638, -3430.702243544536, -2555.729567953699, -6906.905026309043, -2841.278185626914, -7695.769290584251, -6665.770836974685, -6950.43182911202, -8266.40453690267, -3786.3859949741336, -4577.953138262144, -3661.185996272939, -3770.9469293306665, -3679.2231274201363, -8541.288995252475, -2427.78298190653, -5029.851368726696, -4390.551298102536, -9983.619195529802, -3805.8965250589927, -3402.7386508298764, -6460.48385769417, -7220.380490239421, -2801.505178382746, -7112.597799932104, -4595.023218985945, -6962.406218318677, -4278.544934360246, -5560.499402800275, -4667.567635778267, -4872.832015444386, -4531.708358870713, -2805.284653385886, -8619.46612264022, -6979.510361042764, -46.61927486383762, -566.3626739714698, -3195.8228996195357, -9209.007501686005, -5802.918049666087, -4948.026056694418, -7774.113259821924, -3795.852828792505, -1172.851221607477, -874.3621690445303, -1929.6198580182702, -4231.471430171897, -8798.337031817995, -7672.156714432255, -1254.219769589634, -3105.050449162949, -72.00813707345345, -459.0259945096208, -3557.456791531097, -4957.767082459772, -6278.355480699553, -7174.355218005285, -6984.056669328373, -7221.67716938495, -2652.1668486059257, -8698.440808888476, -4219.193571666529, -8199.403569001495, -2590.1689209270844, -5208.872867191665, -5304.683348400688, -7303.215835006606, -9678.029391505643, -6377.352983013962, -8509.607583275987, -5629.812986887492, -5201.438377187489, -5993.148943326292, -4660.955417397236, -7164.256375891188, -10417.119274531502, -5936.88757853271, -7359.1282862672, -6187.781355479457, -9162.805455358804, -3204.6705614551875, -2463.521072615098, -6540.9610032404835, -8819.272230118555, -8174.02890268649, -4712.693593644715, -9373.472811974547, -7240.102716627298, -1848.6362652584305, -5314.3083867222385, -6738.774579177495, -2534.886334542946, -2706.9514799255917, -3932.164814107162, -6678.758004348296, -4274.788563467121, -3730.2095898571806, -6578.917512384654, -10141.987791300093, -4113.672552064891, -5612.511145423659, -8841.267882362858, -10676.594891029106, -3787.6128855638003, -5160.899811301011, -4027.2168256336226, -2713.9682176030915, -1604.551445315758, -6673.6444183616795, -4248.742726165032, -8423.814188449862, -9395.608963379556, -6156.759037194765, -8701.135648897078, -2687.744297205355, -2546.640663784929, -6885.444861032273, -2801.3463272818003, -4457.25991863659, -5025.251871442268, -5916.291155950985, -5503.82946312938, -5309.077069072307, -4593.770447744364, -5023.222390964677, -2220.598946336681, -3174.194278418533, -5568.098289869723, -3582.5705663545446, -7319.163888175278, -4750.7379623726965, -4553.817534420106, -4471.299372257413, -7768.2051680374625, -4221.451061418341, -9413.187346410881, -2580.74163066068, -4173.228681420548, -11069.425479911366, -5592.662198039204, -7576.280240369275, -4325.476987244813, -7487.83053621973, -323.90792623740697, -713.0200997491072, -3914.4195961463065, -5861.659571381924, -2492.8531120795815, -3240.512373409228, -5103.618663926759, -6364.4476738263265, -5774.042042883054, -5385.770774315303, -7171.571666691019, -2567.191406650712, -5.8023601890388345, -68.04769951352975, -3368.8971100241874, -4007.2896313521187, -2325.121991594826, -7293.111112050667, -7816.6540822880515, -7424.642177511544, -5455.0083324772, -6287.212074384691, -9272.594548406605, -8331.654779196628, -6983.792354503013, -6602.88640925733, -4368.004285144602, -4117.557453339981, -5006.032412813814, -7286.449363303748, -3768.040145890658, -5549.742961946313, -135.47924673537582, -848.2155156996208, -7602.178261642406, -2585.373803662063, -1610.2725557616732, -6741.833551528092, -5811.129970045514, -4042.2344037274693, -7887.39902001946, -6689.512666404446, -9725.92647316375, -5135.160981401388, -6285.117600816183, -5440.517806999441, -7513.105881978234, -6604.939279448538, -5329.0947084215995, -4497.83676087519, -3592.207007878415, -1191.0995266975583, -1728.762684675939, -8877.967445718814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4352900533983096, "mean_inference_ms": 1.0632822095064443, "mean_action_processing_ms": 0.1826943882306313, "mean_env_wait_ms": 0.05561501300265369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006016850471496582, "StateBufferConnector_ms": 0.003043532371520996, "ViewRequirementAgentConnector_ms": 0.08929014205932617}, "num_episodes": 20, "episode_return_max": -68.04769951352975, "episode_return_min": -11221.963157425105, "episode_return_mean": -6603.085541197347}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.741134361768, "num_env_steps_trained_throughput_per_sec": 419.741134361768, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 8436.688, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8436.577, "sample_time_ms": 940.134, "learn_time_ms": 7481.186, "learn_throughput": 534.675, "synch_weights_time_ms": 14.417}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 25, "trial_id": "3439d_00000", "date": "2024-08-09_15-29-24", "timestamp": 1723231764, "time_this_iter_s": 9.567098140716553, "time_total_s": 195.20671033859253, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.20671033859253, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 41.521428571428565, "ram_util_percent": 81.77142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.685830267565325, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.007430758078893, "policy_loss": 0.0007458020957225623, "vf_loss": 9.99573029577732, "vf_explained_var": -0.0015393748258550962, "kl": 0.0162291761613839, "entropy": 1.2707660490026076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7422329042796736, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99683390067368, "policy_loss": -0.003313796120823888, "vf_loss": 9.997616892516929, "vf_explained_var": -0.0005889618207537939, "kl": 0.012654002692313895, "entropy": 1.5669713330647301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -68.04769951352975, "episode_reward_min": -11221.963157425105, "episode_reward_mean": -6595.141027579038, "episode_len_mean": 186.32, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 18632, "policy_reward_min": {"agent_policy": 5.8023601890388345, "adversary_policy": -11069.425479911366}, "policy_reward_max": {"agent_policy": 8295.899615966866, "adversary_policy": -5.8023601890388345}, "policy_reward_mean": {"agent_policy": 3832.299270636763, "adversary_policy": -5213.7201491079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-566.3626739714698, -9209.007501686005, -5856.096943948653, -7774.113259821924, -1357.7072331836728, -4232.565295838555, -8877.095451311689, -3105.050449162949, -459.0259945096208, -5221.623962570112, -7185.16051131576, -8384.862293081931, -8698.440808888476, -8510.151081556784, -5208.872867191665, -7477.509455774947, -9678.029391505643, -8509.607583275987, -6244.980018514064, -7502.3704885788275, -10417.1192745315, -7389.079270063395, -9162.805455358806, -6871.239897557249, -9035.09506850628, -9409.762497544265, -7240.102716627298, -6738.774579177495, -3415.59261595691, -6678.758004348296, -4497.421346102285, -10141.987791300093, -5809.615780686315, -11221.963157425105, -5160.899811301011, -4041.9181181034214, -6673.644418361681, -8423.814188449862, -9507.834810984044, -8701.135648897076, -6885.444861032273, -4479.804553861971, -6293.116512245045, -6508.480365900973, -5184.9520577225985, -4171.843213632437, -5574.101248978124, -7444.507789582455, -4823.371736983607, -8254.304100578662, -9413.18734641088, -11069.425479911366, -8282.691088018522, -7508.170473591528, -713.0200997491072, -6901.211813062919, -3243.073284435776, -6732.721068882986, -5848.438190736589, -7306.557954264921, -68.04769951352975, -5339.651385637366, -7303.985327967427, -8418.88511183724, -6410.9647896826855, -9730.48619679729, -7298.602018774585, -4796.1078913820165, -7286.449363303748, -5558.610649390846, -848.2155156996208, -7602.178261642406, -6741.833551528092, -6323.378728359886, -7890.444836424883, -9725.92647316375, -6443.0839324088365, -7517.15979833029, -6022.255971991692, -3592.2070078784145, -8877.967445718816, -7313.065053749971, -6650.916006465178, -7313.171463446795, -8566.878326469014, -4784.237177799571, -5328.656210409891, -3238.5653915899907, -4659.080292716998, -7451.683096394471, -6964.404250599442, -3980.6534832727384, -6611.530276423782, -7269.848895252736, -9300.684665869734, -8792.047285210932, -6826.9351213776035, -5844.807716517731, -8085.369837426628, -5499.505292923284], "episode_lengths": [13, 200, 200, 200, 91, 200, 200, 149, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 133, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 141, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 200, 200, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [46.61927486383762, 3195.8228996195357, 4894.847162411852, 3795.852828792505, 689.5061574683341, 1928.525992351611, 7593.398294938565, 1254.219769589634, 72.00813707345345, 3293.5999114207602, 6267.550187389077, 5820.871545631386, 2652.1668486059257, 3908.446059111241, 2590.1689209270844, 5130.389727632345, 6377.352983013962, 5629.812986887492, 4949.607301999719, 4322.841304709601, 5936.88757853271, 6157.830371683263, 3204.6705614551875, 2133.2421782983342, 7958.206064298761, 4676.403908074996, 1848.6362652584305, 5314.3083867222385, 1826.245198511628, 3932.164814107162, 3507.576807222021, 6578.917512384654, 3916.567916802233, 8295.899615966866, 3787.6128855638003, 2699.266925133293, 1604.551445315758, 4248.742726165032, 6044.5331895902755, 2687.744297205355, 2546.640663784929, 2778.8016920564187, 4648.426515148206, 4304.42616630072, 4432.040780986445, 1222.9500111227721, 3576.5676072461424, 4625.394060965519, 4201.74516969391, 3735.352128877143, 2580.74163066068, 4173.228681420548, 4886.251350389962, 4305.137049873016, 323.90792623740697, 2874.8673544653125, 2490.2922010530338, 4735.345268870099, 5311.374626461769, 2432.205119076812, 5.8023601890388345, 2036.5353557389296, 2314.2477756780654, 6822.411147962351, 5331.255617179203, 7873.7631308059445, 6288.07674498576, 3689.4538471025667, 5006.032412813814, 3759.172458446125, 135.47924673537582, 2585.373803662063, 1610.2725557616732, 3529.9856454130977, 6686.466849999023, 5135.160981401388, 5282.551475406789, 6600.885363096483, 3804.6754973050915, 1191.0995266975583, 1728.762684675939, 2788.211034535942, 3469.1301316055483, 2684.282583100244, 3658.016773753687, 2500.438606504167, 3801.9343904367665, 2331.0917627989006, 1954.8915813063318, 1472.903817302279, 2808.958006108835, 2474.3939547817417, 4812.697740956645, 5899.397517514531, 7665.635580052329, 4870.728689173797, 4849.067187704961, 4275.296163964534, 5245.55446675118, 3290.519646846779], "policy_adversary_policy_reward": [-46.61927486383762, -566.3626739714698, -3195.8228996195357, -9209.007501686005, -5802.918049666087, -4948.026056694418, -7774.113259821924, -3795.852828792505, -1172.851221607477, -874.3621690445303, -1929.6198580182702, -4231.471430171897, -8798.337031817995, -7672.156714432255, -1254.219769589634, -3105.050449162949, -72.00813707345345, -459.0259945096208, -3557.456791531097, -4957.767082459772, -6278.355480699553, -7174.355218005285, -6984.056669328373, -7221.67716938495, -2652.1668486059257, -8698.440808888476, -4219.193571666529, -8199.403569001495, -2590.1689209270844, -5208.872867191665, -5304.683348400688, -7303.215835006606, -9678.029391505643, -6377.352983013962, -8509.607583275987, -5629.812986887492, -5201.438377187489, -5993.148943326292, -4660.955417397236, -7164.256375891188, -10417.119274531502, -5936.88757853271, -7359.1282862672, -6187.781355479457, -9162.805455358804, -3204.6705614551875, -2463.521072615098, -6540.9610032404835, -8819.272230118555, -8174.02890268649, -4712.693593644715, -9373.472811974547, -7240.102716627298, -1848.6362652584305, -5314.3083867222385, -6738.774579177495, -2534.886334542946, -2706.9514799255917, -3932.164814107162, -6678.758004348296, -4274.788563467121, -3730.2095898571806, -6578.917512384654, -10141.987791300093, -4113.672552064891, -5612.511145423659, -8841.267882362858, -10676.594891029106, -3787.6128855638003, -5160.899811301011, -4027.2168256336226, -2713.9682176030915, -1604.551445315758, -6673.6444183616795, -4248.742726165032, -8423.814188449862, -9395.608963379556, -6156.759037194765, -8701.135648897078, -2687.744297205355, -2546.640663784929, -6885.444861032273, -2801.3463272818003, -4457.25991863659, -5025.251871442268, -5916.291155950985, -5503.82946312938, -5309.077069072307, -4593.770447744364, -5023.222390964677, -2220.598946336681, -3174.194278418533, -5568.098289869723, -3582.5705663545446, -7319.163888175278, -4750.7379623726965, -4553.817534420106, -4471.299372257413, -7768.2051680374625, -4221.451061418341, -9413.187346410881, -2580.74163066068, -4173.228681420548, -11069.425479911366, -5592.662198039204, -7576.280240369275, -4325.476987244813, -7487.83053621973, -323.90792623740697, -713.0200997491072, -3914.4195961463065, -5861.659571381924, -2492.8531120795815, -3240.512373409228, -5103.618663926759, -6364.4476738263265, -5774.042042883054, -5385.770774315303, -7171.571666691019, -2567.191406650712, -5.8023601890388345, -68.04769951352975, -3368.8971100241874, -4007.2896313521187, -2325.121991594826, -7293.111112050667, -7816.6540822880515, -7424.642177511544, -5455.0083324772, -6287.212074384691, -9272.594548406605, -8331.654779196628, -6983.792354503013, -6602.88640925733, -4368.004285144602, -4117.557453339981, -5006.032412813814, -7286.449363303748, -3768.040145890658, -5549.742961946313, -135.47924673537582, -848.2155156996208, -7602.178261642406, -2585.373803662063, -1610.2725557616732, -6741.833551528092, -5811.129970045514, -4042.2344037274693, -7887.39902001946, -6689.512666404446, -9725.92647316375, -5135.160981401388, -6285.117600816183, -5440.517806999441, -7513.105881978234, -6604.939279448538, -5329.0947084215995, -4497.83676087519, -3592.207007878415, -1191.0995266975583, -1728.762684675939, -8877.967445718814, -2788.211034535942, -7313.065053749973, -5010.035397749321, -5110.010740321404, -7313.171463446795, -2684.282583100244, -3658.016773753687, -8566.878326469014, -3579.2365882336403, -3705.439196070097, -3801.9343904367665, -5328.656210409891, -2332.158510655772, -3237.49864373312, -2036.947565142725, -4577.0243088806055, -1472.903817302279, -7451.683096394471, -3114.106978943388, -6659.255277764891, -2514.7667288858456, -3940.2807091686345, -6609.313345808196, -4814.914671572231, -6017.958074974018, -7151.28833779325, -7670.963674725963, -9295.356571196098, -8792.047285210936, -4870.728689173797, -4849.067187704961, -6826.9351213776035, -4302.109966371218, -5817.993914111047, -5245.55446675118, -8085.369837426628, -4932.370329247911, -3857.6546105221555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4378797476943533, "mean_inference_ms": 1.069602882827478, "mean_action_processing_ms": 0.18355918330923576, "mean_env_wait_ms": 0.0560318120735157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005959033966064453, "StateBufferConnector_ms": 0.003018617630004883, "ViewRequirementAgentConnector_ms": 0.08961021900177002}, "num_episodes": 19, "episode_return_max": -68.04769951352975, "episode_return_min": -11221.963157425105, "episode_return_mean": -6595.141027579038}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.9741761627281, "num_env_steps_trained_throughput_per_sec": 530.9741761627281, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 8339.629, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8339.52, "sample_time_ms": 922.574, "learn_time_ms": 7401.62, "learn_throughput": 540.422, "synch_weights_time_ms": 14.485}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 26, "trial_id": "3439d_00000", "date": "2024-08-09_15-29-32", "timestamp": 1723231772, "time_this_iter_s": 7.537999153137207, "time_total_s": 202.74470949172974, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 202.74470949172974, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.60909090909091, "ram_util_percent": 81.58181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.838330181253453, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.975211644172669, "policy_loss": -0.004713045598327881, "vf_loss": 9.97446781496207, "vf_explained_var": -0.00043704671164353687, "kl": 0.008084227004049656, "entropy": 1.2778478400160869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7663001499794148, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985691543357083, "policy_loss": -0.0029091652467965134, "vf_loss": 9.986096146497777, "vf_explained_var": -0.0008798306581204531, "kl": 0.012522682908271986, "entropy": 1.5710021733606934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -68.04769951352975, "episode_reward_min": -11221.963157425105, "episode_reward_mean": -6580.682818987462, "episode_len_mean": 187.9, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18790, "policy_reward_min": {"agent_policy": 5.8023601890388345, "adversary_policy": -11069.425479911366}, "policy_reward_max": {"agent_policy": 8295.899615966866, "adversary_policy": -5.8023601890388345}, "policy_reward_mean": {"agent_policy": 3832.032878742213, "adversary_policy": -5206.357848864839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6871.239897557249, -9035.09506850628, -9409.762497544265, -7240.102716627298, -6738.774579177495, -3415.59261595691, -6678.758004348296, -4497.421346102285, -10141.987791300093, -5809.615780686315, -11221.963157425105, -5160.899811301011, -4041.9181181034214, -6673.644418361681, -8423.814188449862, -9507.834810984044, -8701.135648897076, -6885.444861032273, -4479.804553861971, -6293.116512245045, -6508.480365900973, -5184.9520577225985, -4171.843213632437, -5574.101248978124, -7444.507789582455, -4823.371736983607, -8254.304100578662, -9413.18734641088, -11069.425479911366, -8282.691088018522, -7508.170473591528, -713.0200997491072, -6901.211813062919, -3243.073284435776, -6732.721068882986, -5848.438190736589, -7306.557954264921, -68.04769951352975, -5339.651385637366, -7303.985327967427, -8418.88511183724, -6410.9647896826855, -9730.48619679729, -7298.602018774585, -4796.1078913820165, -7286.449363303748, -5558.610649390846, -848.2155156996208, -7602.178261642406, -6741.833551528092, -6323.378728359886, -7890.444836424883, -9725.92647316375, -6443.0839324088365, -7517.15979833029, -6022.255971991692, -3592.2070078784145, -8877.967445718816, -7313.065053749971, -6650.916006465178, -7313.171463446795, -8566.878326469014, -4784.237177799571, -5328.656210409891, -3238.5653915899907, -4659.080292716998, -7451.683096394471, -6964.404250599442, -3980.6534832727384, -6611.530276423782, -7269.848895252736, -9300.684665869734, -8792.047285210932, -6826.9351213776035, -5844.807716517731, -8085.369837426628, -5499.505292923284, -9057.011897518185, -5980.360127279012, -4183.544946632683, -3797.4753146956073, -8634.964616426652, -6234.046752514979, -6032.659380446044, -7019.020926337767, -3960.5766328449386, -9959.205636827717, -2148.3833662385414, -5275.674029554446, -6293.84874607534, -8467.060832015586, -1625.5075493633906, -9292.639465801874, -8206.476723609776, -9343.571051345878, -5730.059875055594, -5430.275721847246, -7745.344468371935, -9461.223212167648, -5702.88513351429], "episode_lengths": [200, 200, 200, 169, 200, 133, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 141, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 200, 200, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 200, 200, 155, 200, 100, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2133.2421782983342, 7958.206064298761, 4676.403908074996, 1848.6362652584305, 5314.3083867222385, 1826.245198511628, 3932.164814107162, 3507.576807222021, 6578.917512384654, 3916.567916802233, 8295.899615966866, 3787.6128855638003, 2699.266925133293, 1604.551445315758, 4248.742726165032, 6044.5331895902755, 2687.744297205355, 2546.640663784929, 2778.8016920564187, 4648.426515148206, 4304.42616630072, 4432.040780986445, 1222.9500111227721, 3576.5676072461424, 4625.394060965519, 4201.74516969391, 3735.352128877143, 2580.74163066068, 4173.228681420548, 4886.251350389962, 4305.137049873016, 323.90792623740697, 2874.8673544653125, 2490.2922010530338, 4735.345268870099, 5311.374626461769, 2432.205119076812, 5.8023601890388345, 2036.5353557389296, 2314.2477756780654, 6822.411147962351, 5331.255617179203, 7873.7631308059445, 6288.07674498576, 3689.4538471025667, 5006.032412813814, 3759.172458446125, 135.47924673537582, 2585.373803662063, 1610.2725557616732, 3529.9856454130977, 6686.466849999023, 5135.160981401388, 5282.551475406789, 6600.885363096483, 3804.6754973050915, 1191.0995266975583, 1728.762684675939, 2788.211034535942, 3469.1301316055483, 2684.282583100244, 3658.016773753687, 2500.438606504167, 3801.9343904367665, 2331.0917627989006, 1954.8915813063318, 1472.903817302279, 2808.958006108835, 2474.3939547817417, 4812.697740956645, 5899.397517514531, 7665.635580052329, 4870.728689173797, 4849.067187704961, 4275.296163964534, 5245.55446675118, 3290.519646846779, 3269.3757576331873, 4346.924031571304, 2293.736807005814, 2132.9341724065694, 7542.124854915076, 5318.292169511457, 4305.864968266215, 5042.207032872293, 2259.3857344877706, 6893.50623395337, 1720.9796167238032, 2531.6343905909575, 5401.754422363601, 7148.557688609518, 456.23039787010725, 4025.9948938366188, 3150.6303447363007, 1947.6170610797128, 4241.187463287851, 2499.6154347790507, 4730.915685558481, 7016.951036123445, 1409.9374184717083], "policy_adversary_policy_reward": [-2463.521072615098, -6540.9610032404835, -8819.272230118555, -8174.02890268649, -4712.693593644715, -9373.472811974547, -7240.102716627298, -1848.6362652584305, -5314.3083867222385, -6738.774579177495, -2534.886334542946, -2706.9514799255917, -3932.164814107162, -6678.758004348296, -4274.788563467121, -3730.2095898571806, -6578.917512384654, -10141.987791300093, -4113.672552064891, -5612.511145423659, -8841.267882362858, -10676.594891029106, -3787.6128855638003, -5160.899811301011, -4027.2168256336226, -2713.9682176030915, -1604.551445315758, -6673.6444183616795, -4248.742726165032, -8423.814188449862, -9395.608963379556, -6156.759037194765, -8701.135648897078, -2687.744297205355, -2546.640663784929, -6885.444861032273, -2801.3463272818003, -4457.25991863659, -5025.251871442268, -5916.291155950985, -5503.82946312938, -5309.077069072307, -4593.770447744364, -5023.222390964677, -2220.598946336681, -3174.194278418533, -5568.098289869723, -3582.5705663545446, -7319.163888175278, -4750.7379623726965, -4553.817534420106, -4471.299372257413, -7768.2051680374625, -4221.451061418341, -9413.187346410881, -2580.74163066068, -4173.228681420548, -11069.425479911366, -5592.662198039204, -7576.280240369275, -4325.476987244813, -7487.83053621973, -323.90792623740697, -713.0200997491072, -3914.4195961463065, -5861.659571381924, -2492.8531120795815, -3240.512373409228, -5103.618663926759, -6364.4476738263265, -5774.042042883054, -5385.770774315303, -7171.571666691019, -2567.191406650712, -5.8023601890388345, -68.04769951352975, -3368.8971100241874, -4007.2896313521187, -2325.121991594826, -7293.111112050667, -7816.6540822880515, -7424.642177511544, -5455.0083324772, -6287.212074384691, -9272.594548406605, -8331.654779196628, -6983.792354503013, -6602.88640925733, -4368.004285144602, -4117.557453339981, -5006.032412813814, -7286.449363303748, -3768.040145890658, -5549.742961946313, -135.47924673537582, -848.2155156996208, -7602.178261642406, -2585.373803662063, -1610.2725557616732, -6741.833551528092, -5811.129970045514, -4042.2344037274693, -7887.39902001946, -6689.512666404446, -9725.92647316375, -5135.160981401388, -6285.117600816183, -5440.517806999441, -7513.105881978234, -6604.939279448538, -5329.0947084215995, -4497.83676087519, -3592.207007878415, -1191.0995266975583, -1728.762684675939, -8877.967445718814, -2788.211034535942, -7313.065053749973, -5010.035397749321, -5110.010740321404, -7313.171463446795, -2684.282583100244, -3658.016773753687, -8566.878326469014, -3579.2365882336403, -3705.439196070097, -3801.9343904367665, -5328.656210409891, -2332.158510655772, -3237.49864373312, -2036.947565142725, -4577.0243088806055, -1472.903817302279, -7451.683096394471, -3114.106978943388, -6659.255277764891, -2514.7667288858456, -3940.2807091686345, -6609.313345808196, -4814.914671572231, -6017.958074974018, -7151.28833779325, -7670.963674725963, -9295.356571196098, -8792.047285210936, -4870.728689173797, -4849.067187704961, -6826.9351213776035, -4302.109966371218, -5817.993914111047, -5245.55446675118, -8085.369837426628, -4932.370329247911, -3857.6546105221555, -9056.085863302787, -3270.3017918485875, -5831.55681681171, -4495.727342038605, -4183.544946632682, -2293.736807005814, -3746.4349327191467, -2183.9745543830295, -7563.184923566821, -8613.904547774906, -5579.738126124194, -5972.600795902244, -5682.973176307412, -4655.551172404847, -6857.090683515028, -5204.137275695033, -3553.2388741262935, -2666.723493206415, -9884.230853226705, -6968.481017554383, -1768.1159767829595, -2101.2470061793847, -2695.5892287201045, -5111.719191425299, -5430.674883997379, -6264.928284441564, -8457.277053673544, -7158.341466951559, -1625.5075493633906, -456.23039787010725, -4025.9948938366188, -9292.639465801874, -4013.3321194262694, -7343.774948919804, -9343.571051345882, -1947.6170610797128, -4563.782704759, -5407.464633584445, -5220.37830441827, -2709.5128522080267, -7745.344468371934, -4730.915685558481, -7102.033948837109, -9376.140299453986, -1409.9374184717083, -5702.885133514289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4398537700310933, "mean_inference_ms": 1.0723821945462069, "mean_action_processing_ms": 0.18422929682238134, "mean_env_wait_ms": 0.056419424148689536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005154132843017578, "StateBufferConnector_ms": 0.0027669668197631836, "ViewRequirementAgentConnector_ms": 0.08529031276702881}, "num_episodes": 23, "episode_return_max": -68.04769951352975, "episode_return_min": -11221.963157425105, "episode_return_mean": -6580.682818987462}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.5548270568371, "num_env_steps_trained_throughput_per_sec": 534.5548270568371, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 8301.167, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8301.058, "sample_time_ms": 910.679, "learn_time_ms": 7375.008, "learn_throughput": 542.372, "synch_weights_time_ms": 14.531}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 27, "trial_id": "3439d_00000", "date": "2024-08-09_15-29-40", "timestamp": 1723231780, "time_this_iter_s": 7.488667011260986, "time_total_s": 210.23337650299072, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ece1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.23337650299072, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.572727272727274, "ram_util_percent": 81.53636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7312017451195667, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990630175669988, "policy_loss": -0.001652114862614932, "vf_loss": 9.988079620401065, "vf_explained_var": -0.0003160726899902026, "kl": 0.006226178953753939, "entropy": 1.2404953551789124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7578337684589088, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990713672537021, "policy_loss": -0.005830009067529645, "vf_loss": 9.994078363691058, "vf_explained_var": -9.602314580685247e-05, "kl": 0.01232669182077405, "entropy": 1.5668430890986529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -68.04769951352975, "episode_reward_min": -11117.098869259391, "episode_reward_mean": -6733.702531785259, "episode_len_mean": 187.67, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18767, "policy_reward_min": {"agent_policy": 5.8023601890388345, "adversary_policy": -11117.098869259391}, "policy_reward_max": {"agent_policy": 9677.310269560012, "adversary_policy": -5.8023601890388345}, "policy_reward_mean": {"agent_policy": 4032.2289660310403, "adversary_policy": -5382.965748908149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5574.101248978124, -7444.507789582455, -4823.371736983607, -8254.304100578662, -9413.18734641088, -11069.425479911366, -8282.691088018522, -7508.170473591528, -713.0200997491072, -6901.211813062919, -3243.073284435776, -6732.721068882986, -5848.438190736589, -7306.557954264921, -68.04769951352975, -5339.651385637366, -7303.985327967427, -8418.88511183724, -6410.9647896826855, -9730.48619679729, -7298.602018774585, -4796.1078913820165, -7286.449363303748, -5558.610649390846, -848.2155156996208, -7602.178261642406, -6741.833551528092, -6323.378728359886, -7890.444836424883, -9725.92647316375, -6443.0839324088365, -7517.15979833029, -6022.255971991692, -3592.2070078784145, -8877.967445718816, -7313.065053749971, -6650.916006465178, -7313.171463446795, -8566.878326469014, -4784.237177799571, -5328.656210409891, -3238.5653915899907, -4659.080292716998, -7451.683096394471, -6964.404250599442, -3980.6534832727384, -6611.530276423782, -7269.848895252736, -9300.684665869734, -8792.047285210932, -6826.9351213776035, -5844.807716517731, -8085.369837426628, -5499.505292923284, -9057.011897518185, -5980.360127279012, -4183.544946632683, -3797.4753146956073, -8634.964616426652, -6234.046752514979, -6032.659380446044, -7019.020926337767, -3960.5766328449386, -9959.205636827717, -2148.3833662385414, -5275.674029554446, -6293.84874607534, -8467.060832015586, -1625.5075493633906, -9292.639465801874, -8206.476723609776, -9343.571051345878, -5730.059875055594, -5430.275721847246, -7745.344468371935, -9461.223212167648, -5702.88513351429, -4158.731261303645, -8045.025689249059, -8260.926141032885, -7052.549766194519, -7317.4433074612025, -7172.923201177303, -4477.709136548842, -3062.769800388018, -8274.847311252353, -6159.638005805825, -7423.420639504116, -5241.583962901566, -9068.69117821055, -4629.904523645677, -9322.040560798647, -6962.789466527731, -9466.276282727938, -9061.322214425905, -7437.678419430478, -11117.098869259391, -10417.505966777568, -9625.124762517848, -8639.172828362412], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 141, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 200, 200, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 200, 200, 155, 200, 100, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3576.5676072461424, 4625.394060965519, 4201.74516969391, 3735.352128877143, 2580.74163066068, 4173.228681420548, 4886.251350389962, 4305.137049873016, 323.90792623740697, 2874.8673544653125, 2490.2922010530338, 4735.345268870099, 5311.374626461769, 2432.205119076812, 5.8023601890388345, 2036.5353557389296, 2314.2477756780654, 6822.411147962351, 5331.255617179203, 7873.7631308059445, 6288.07674498576, 3689.4538471025667, 5006.032412813814, 3759.172458446125, 135.47924673537582, 2585.373803662063, 1610.2725557616732, 3529.9856454130977, 6686.466849999023, 5135.160981401388, 5282.551475406789, 6600.885363096483, 3804.6754973050915, 1191.0995266975583, 1728.762684675939, 2788.211034535942, 3469.1301316055483, 2684.282583100244, 3658.016773753687, 2500.438606504167, 3801.9343904367665, 2331.0917627989006, 1954.8915813063318, 1472.903817302279, 2808.958006108835, 2474.3939547817417, 4812.697740956645, 5899.397517514531, 7665.635580052329, 4870.728689173797, 4849.067187704961, 4275.296163964534, 5245.55446675118, 3290.519646846779, 3269.3757576331873, 4346.924031571304, 2293.736807005814, 2132.9341724065694, 7542.124854915076, 5318.292169511457, 4305.864968266215, 5042.207032872293, 2259.3857344877706, 6893.50623395337, 1720.9796167238032, 2531.6343905909575, 5401.754422363601, 7148.557688609518, 456.23039787010725, 4025.9948938366188, 3150.6303447363007, 1947.6170610797128, 4241.187463287851, 2499.6154347790507, 4730.915685558481, 7016.951036123445, 1409.9374184717083, 3615.9333534609896, 6899.385084466837, 6816.859207469119, 2799.3293199936656, 4587.425166566361, 5876.007835159257, 2548.724014460875, 486.43848950056673, 2806.4544658054488, 4280.863909263509, 2621.628505709282, 4379.560496041032, 7291.249016463985, 3401.464094145643, 1235.9527675192974, 3339.9062334600394, 5888.129148944072, 5161.761758232976, 1957.9949188170092, 9011.884551696, 9677.310269560012, 9035.62859810114, 7293.62349006584], "policy_adversary_policy_reward": [-5568.098289869723, -3582.5705663545446, -7319.163888175278, -4750.7379623726965, -4553.817534420106, -4471.299372257413, -7768.2051680374625, -4221.451061418341, -9413.187346410881, -2580.74163066068, -4173.228681420548, -11069.425479911366, -5592.662198039204, -7576.280240369275, -4325.476987244813, -7487.83053621973, -323.90792623740697, -713.0200997491072, -3914.4195961463065, -5861.659571381924, -2492.8531120795815, -3240.512373409228, -5103.618663926759, -6364.4476738263265, -5774.042042883054, -5385.770774315303, -7171.571666691019, -2567.191406650712, -5.8023601890388345, -68.04769951352975, -3368.8971100241874, -4007.2896313521187, -2325.121991594826, -7293.111112050667, -7816.6540822880515, -7424.642177511544, -5455.0083324772, -6287.212074384691, -9272.594548406605, -8331.654779196628, -6983.792354503013, -6602.88640925733, -4368.004285144602, -4117.557453339981, -5006.032412813814, -7286.449363303748, -3768.040145890658, -5549.742961946313, -135.47924673537582, -848.2155156996208, -7602.178261642406, -2585.373803662063, -1610.2725557616732, -6741.833551528092, -5811.129970045514, -4042.2344037274693, -7887.39902001946, -6689.512666404446, -9725.92647316375, -5135.160981401388, -6285.117600816183, -5440.517806999441, -7513.105881978234, -6604.939279448538, -5329.0947084215995, -4497.83676087519, -3592.207007878415, -1191.0995266975583, -1728.762684675939, -8877.967445718814, -2788.211034535942, -7313.065053749973, -5010.035397749321, -5110.010740321404, -7313.171463446795, -2684.282583100244, -3658.016773753687, -8566.878326469014, -3579.2365882336403, -3705.439196070097, -3801.9343904367665, -5328.656210409891, -2332.158510655772, -3237.49864373312, -2036.947565142725, -4577.0243088806055, -1472.903817302279, -7451.683096394471, -3114.106978943388, -6659.255277764891, -2514.7667288858456, -3940.2807091686345, -6609.313345808196, -4814.914671572231, -6017.958074974018, -7151.28833779325, -7670.963674725963, -9295.356571196098, -8792.047285210936, -4870.728689173797, -4849.067187704961, -6826.9351213776035, -4302.109966371218, -5817.993914111047, -5245.55446675118, -8085.369837426628, -4932.370329247911, -3857.6546105221555, -9056.085863302787, -3270.3017918485875, -5831.55681681171, -4495.727342038605, -4183.544946632682, -2293.736807005814, -3746.4349327191467, -2183.9745543830295, -7563.184923566821, -8613.904547774906, -5579.738126124194, -5972.600795902244, -5682.973176307412, -4655.551172404847, -6857.090683515028, -5204.137275695033, -3553.2388741262935, -2666.723493206415, -9884.230853226705, -6968.481017554383, -1768.1159767829595, -2101.2470061793847, -2695.5892287201045, -5111.719191425299, -5430.674883997379, -6264.928284441564, -8457.277053673544, -7158.341466951559, -1625.5075493633906, -456.23039787010725, -4025.9948938366188, -9292.639465801874, -4013.3321194262694, -7343.774948919804, -9343.571051345882, -1947.6170610797128, -4563.782704759, -5407.464633584445, -5220.37830441827, -2709.5128522080267, -7745.344468371934, -4730.915685558481, -7102.033948837109, -9376.140299453986, -1409.9374184717083, -5702.885133514289, -3683.2926744737056, -4091.371940290928, -7631.96466160136, -7312.446112114538, -7351.2450509948785, -7726.540297507125, -6995.3414567153395, -2856.5376294728453, -4588.150563765631, -7316.717910261935, -5898.374519989036, -7150.556516347524, -4326.599816916647, -2699.833334093072, -3062.7698003880178, -486.43848950056673, -7982.632121165344, -3098.6696558924573, -4436.4723031769945, -6004.029611892334, -7423.4206395041165, -2621.628505709282, -5226.393800620257, -4394.750658322342, -9068.691178210553, -7291.249016463985, -4569.116231024243, -3462.252386767077, -1235.9527675192974, -9322.040560798647, -6946.07786573318, -3356.6178342545895, -5888.129148944072, -9466.276282727938, -5161.761758232976, -9061.322214425905, -7437.67841943048, -1957.9949188170092, -9011.884551696, -11117.098869259391, -9683.138838931021, -10411.677397406558, -9455.144047774473, -9205.609312844519, -7298.702827271842, -8634.093491156413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44149028924243483, "mean_inference_ms": 1.0758978801378307, "mean_action_processing_ms": 0.18489738751035728, "mean_env_wait_ms": 0.05671704223323952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004977226257324219, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.08239853382110596}, "num_episodes": 23, "episode_return_max": -68.04769951352975, "episode_return_min": -11117.098869259391, "episode_return_mean": -6733.702531785259}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.0484913957198, "num_env_steps_trained_throughput_per_sec": 514.0484913957198, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 8233.175, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8233.136, "sample_time_ms": 886.765, "learn_time_ms": 7331.84, "learn_throughput": 545.566, "synch_weights_time_ms": 13.862}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 28, "trial_id": "3439d_00000", "date": "2024-08-09_15-29-47", "timestamp": 1723231787, "time_this_iter_s": 7.787018060684204, "time_total_s": 218.02039456367493, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a4a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.02039456367493, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 24.700000000000003, "ram_util_percent": 81.41818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7983694804521898, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.970154343048732, "policy_loss": -0.0046956267770535, "vf_loss": 9.970989320675532, "vf_explained_var": -0.0009279058625300726, "kl": 0.005719481239308758, "entropy": 1.2616033919155598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.762671485133272, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983034230792333, "policy_loss": -0.005643619550638413, "vf_loss": 9.985853885973572, "vf_explained_var": -0.00010253604126985741, "kl": 0.014119851506418653, "entropy": 1.5590577200607016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": -41.29021867338399, "episode_reward_min": -11117.098869259391, "episode_reward_mean": -6735.102083057305, "episode_len_mean": 184.57, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18457, "policy_reward_min": {"agent_policy": 7.691188194691836, "adversary_policy": -11117.098869259391}, "policy_reward_max": {"agent_policy": 9677.310269560012, "adversary_policy": -7.691188194691836}, "policy_reward_mean": {"agent_policy": 4032.927883498759, "adversary_policy": -5384.014983278033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-848.2155156996208, -7602.178261642406, -6741.833551528092, -6323.378728359886, -7890.444836424883, -9725.92647316375, -6443.0839324088365, -7517.15979833029, -6022.255971991692, -3592.2070078784145, -8877.967445718816, -7313.065053749971, -6650.916006465178, -7313.171463446795, -8566.878326469014, -4784.237177799571, -5328.656210409891, -3238.5653915899907, -4659.080292716998, -7451.683096394471, -6964.404250599442, -3980.6534832727384, -6611.530276423782, -7269.848895252736, -9300.684665869734, -8792.047285210932, -6826.9351213776035, -5844.807716517731, -8085.369837426628, -5499.505292923284, -9057.011897518185, -5980.360127279012, -4183.544946632683, -3797.4753146956073, -8634.964616426652, -6234.046752514979, -6032.659380446044, -7019.020926337767, -3960.5766328449386, -9959.205636827717, -2148.3833662385414, -5275.674029554446, -6293.84874607534, -8467.060832015586, -1625.5075493633906, -9292.639465801874, -8206.476723609776, -9343.571051345878, -5730.059875055594, -5430.275721847246, -7745.344468371935, -9461.223212167648, -5702.88513351429, -4158.731261303645, -8045.025689249059, -8260.926141032885, -7052.549766194519, -7317.4433074612025, -7172.923201177303, -4477.709136548842, -3062.769800388018, -8274.847311252353, -6159.638005805825, -7423.420639504116, -5241.583962901566, -9068.69117821055, -4629.904523645677, -9322.040560798647, -6962.789466527731, -9466.276282727938, -9061.322214425905, -7437.678419430478, -11117.098869259391, -10417.505966777568, -9625.124762517848, -8639.172828362412, -4404.145353693377, -6035.034343869311, -9188.105478675365, -9690.103118212915, -5099.236008197248, -9518.319081532685, -10391.899171305939, -371.31643440672445, -10433.180976953197, -8835.827076135443, -9277.961170165352, -6402.718181667005, -7216.34511495114, -6725.497886548036, -4407.149641835535, -41.29021867338399, -6627.084960723162, -2291.2337002283152, -7250.54989315804, -8823.127698781173, -284.36079075760705, -5374.872194015483, -7673.073137447963, -9104.095604744287], "episode_lengths": [23, 200, 200, 200, 200, 200, 200, 200, 200, 113, 200, 200, 200, 200, 200, 186, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 200, 200, 155, 200, 100, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 4, 200, 95, 200, 200, 10, 200, 200, 200], "policy_agent_policy_reward": [135.47924673537582, 2585.373803662063, 1610.2725557616732, 3529.9856454130977, 6686.466849999023, 5135.160981401388, 5282.551475406789, 6600.885363096483, 3804.6754973050915, 1191.0995266975583, 1728.762684675939, 2788.211034535942, 3469.1301316055483, 2684.282583100244, 3658.016773753687, 2500.438606504167, 3801.9343904367665, 2331.0917627989006, 1954.8915813063318, 1472.903817302279, 2808.958006108835, 2474.3939547817417, 4812.697740956645, 5899.397517514531, 7665.635580052329, 4870.728689173797, 4849.067187704961, 4275.296163964534, 5245.55446675118, 3290.519646846779, 3269.3757576331873, 4346.924031571304, 2293.736807005814, 2132.9341724065694, 7542.124854915076, 5318.292169511457, 4305.864968266215, 5042.207032872293, 2259.3857344877706, 6893.50623395337, 1720.9796167238032, 2531.6343905909575, 5401.754422363601, 7148.557688609518, 456.23039787010725, 4025.9948938366188, 3150.6303447363007, 1947.6170610797128, 4241.187463287851, 2499.6154347790507, 4730.915685558481, 7016.951036123445, 1409.9374184717083, 3615.9333534609896, 6899.385084466837, 6816.859207469119, 2799.3293199936656, 4587.425166566361, 5876.007835159257, 2548.724014460875, 486.43848950056673, 2806.4544658054488, 4280.863909263509, 2621.628505709282, 4379.560496041032, 7291.249016463985, 3401.464094145643, 1235.9527675192974, 3339.9062334600394, 5888.129148944072, 5161.761758232976, 1957.9949188170092, 9011.884551696, 9677.310269560012, 9035.62859810114, 7293.62349006584, 3004.959355989662, 3062.084063967979, 6659.221321049699, 6214.082302586869, 1961.4594888265017, 3034.3278203135806, 3422.9827827777035, 46.90582246394834, 8139.692540559281, 5171.552973726713, 3660.532978283825, 5617.695932711645, 5490.310156441206, 4640.906313301953, 3065.4508587854984, 7.691188194691836, 3418.332770930512, 1387.6479985202916, 4021.2425110308554, 7340.909114549241, 50.13407632605878, 2693.6131397295494, 3943.4966993354333, 7393.820562562378], "policy_adversary_policy_reward": [-135.47924673537582, -848.2155156996208, -7602.178261642406, -2585.373803662063, -1610.2725557616732, -6741.833551528092, -5811.129970045514, -4042.2344037274693, -7887.39902001946, -6689.512666404446, -9725.92647316375, -5135.160981401388, -6285.117600816183, -5440.517806999441, -7513.105881978234, -6604.939279448538, -5329.0947084215995, -4497.83676087519, -3592.207007878415, -1191.0995266975583, -1728.762684675939, -8877.967445718814, -2788.211034535942, -7313.065053749973, -5010.035397749321, -5110.010740321404, -7313.171463446795, -2684.282583100244, -3658.016773753687, -8566.878326469014, -3579.2365882336403, -3705.439196070097, -3801.9343904367665, -5328.656210409891, -2332.158510655772, -3237.49864373312, -2036.947565142725, -4577.0243088806055, -1472.903817302279, -7451.683096394471, -3114.106978943388, -6659.255277764891, -2514.7667288858456, -3940.2807091686345, -6609.313345808196, -4814.914671572231, -6017.958074974018, -7151.28833779325, -7670.963674725963, -9295.356571196098, -8792.047285210936, -4870.728689173797, -4849.067187704961, -6826.9351213776035, -4302.109966371218, -5817.993914111047, -5245.55446675118, -8085.369837426628, -4932.370329247911, -3857.6546105221555, -9056.085863302787, -3270.3017918485875, -5831.55681681171, -4495.727342038605, -4183.544946632682, -2293.736807005814, -3746.4349327191467, -2183.9745543830295, -7563.184923566821, -8613.904547774906, -5579.738126124194, -5972.600795902244, -5682.973176307412, -4655.551172404847, -6857.090683515028, -5204.137275695033, -3553.2388741262935, -2666.723493206415, -9884.230853226705, -6968.481017554383, -1768.1159767829595, -2101.2470061793847, -2695.5892287201045, -5111.719191425299, -5430.674883997379, -6264.928284441564, -8457.277053673544, -7158.341466951559, -1625.5075493633906, -456.23039787010725, -4025.9948938366188, -9292.639465801874, -4013.3321194262694, -7343.774948919804, -9343.571051345882, -1947.6170610797128, -4563.782704759, -5407.464633584445, -5220.37830441827, -2709.5128522080267, -7745.344468371934, -4730.915685558481, -7102.033948837109, -9376.140299453986, -1409.9374184717083, -5702.885133514289, -3683.2926744737056, -4091.371940290928, -7631.96466160136, -7312.446112114538, -7351.2450509948785, -7726.540297507125, -6995.3414567153395, -2856.5376294728453, -4588.150563765631, -7316.717910261935, -5898.374519989036, -7150.556516347524, -4326.599816916647, -2699.833334093072, -3062.7698003880178, -486.43848950056673, -7982.632121165344, -3098.6696558924573, -4436.4723031769945, -6004.029611892334, -7423.4206395041165, -2621.628505709282, -5226.393800620257, -4394.750658322342, -9068.691178210553, -7291.249016463985, -4569.116231024243, -3462.252386767077, -1235.9527675192974, -9322.040560798647, -6946.07786573318, -3356.6178342545895, -5888.129148944072, -9466.276282727938, -5161.761758232976, -9061.322214425905, -7437.67841943048, -1957.9949188170092, -9011.884551696, -11117.098869259391, -9683.138838931021, -10411.677397406558, -9455.144047774473, -9205.609312844519, -7298.702827271842, -8634.093491156413, -4353.115185469947, -3055.9895242130865, -6035.034343869312, -3062.084063967979, -6659.221321049699, -9188.105478675365, -6214.082302586869, -9690.103118212915, -3761.160336214365, -3299.5351608093865, -3034.3278203135806, -9518.319081532685, -3422.9827827777035, -10391.899171305939, -371.3164344067244, -46.90582246394834, -8725.837040251468, -9847.036477261012, -8835.827076135445, -5171.552973726713, -3660.532978283825, -9277.961170165352, -5738.862874556581, -6281.55123982207, -7165.171761131295, -5541.483510261053, -4640.906313301953, -6725.497886548036, -3658.9869887860687, -3813.613511834963, -7.691188194691836, -41.29021867338399, -6620.189442224286, -3425.2282894293885, -1387.6479985202916, -2291.2337002283152, -7208.139332586796, -4063.6530716020975, -7350.150264492918, -8813.886548837494, -284.360790757607, -50.13407632605878, -5364.263162825109, -2704.222170919925, -7673.073137447961, -3943.4966993354333, -8959.264223569196, -7538.651943737472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44151652719151857, "mean_inference_ms": 1.0754375930515914, "mean_action_processing_ms": 0.18454578482274842, "mean_env_wait_ms": 0.05672067614342615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004772663116455078, "StateBufferConnector_ms": 0.0026029348373413086, "ViewRequirementAgentConnector_ms": 0.07959556579589844}, "num_episodes": 24, "episode_return_max": -41.29021867338399, "episode_return_min": -11117.098869259391, "episode_return_mean": -6735.102083057305}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.08402472675436, "num_env_steps_trained_throughput_per_sec": 462.08402472675436, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 8227.816, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8227.779, "sample_time_ms": 866.471, "learn_time_ms": 7346.675, "learn_throughput": 544.464, "synch_weights_time_ms": 13.949}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 29, "trial_id": "3439d_00000", "date": "2024-08-09_15-29-56", "timestamp": 1723231796, "time_this_iter_s": 8.690319776535034, "time_total_s": 226.71071434020996, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ece3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.71071434020996, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 33.841666666666676, "ram_util_percent": 81.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7666304901863138, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.978135027488072, "policy_loss": -0.00427561787898109, "vf_loss": 9.977770145734151, "vf_explained_var": 0.0002636436993877093, "kl": 0.006874845810428572, "entropy": 1.244449302429954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.749953771930523, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98745332697712, "policy_loss": -0.004731927575819471, "vf_loss": 9.98844048939054, "vf_explained_var": -0.000679917436428171, "kl": 0.018723866665272645, "entropy": 1.5597032933008104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": -41.29021867338399, "episode_reward_min": -11325.053182368318, "episode_reward_mean": -6611.869568449665, "episode_len_mean": 182.01, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18201, "policy_reward_min": {"agent_policy": 2.389896701625678, "adversary_policy": -11325.053182368318}, "policy_reward_max": {"agent_policy": 9677.310269560012, "adversary_policy": -2.389896701625678}, "policy_reward_mean": {"agent_policy": 4013.245845672075, "adversary_policy": -5312.55770706087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6964.404250599442, -3980.6534832727384, -6611.530276423782, -7269.848895252736, -9300.684665869734, -8792.047285210932, -6826.9351213776035, -5844.807716517731, -8085.369837426628, -5499.505292923284, -9057.011897518185, -5980.360127279012, -4183.544946632683, -3797.4753146956073, -8634.964616426652, -6234.046752514979, -6032.659380446044, -7019.020926337767, -3960.5766328449386, -9959.205636827717, -2148.3833662385414, -5275.674029554446, -6293.84874607534, -8467.060832015586, -1625.5075493633906, -9292.639465801874, -8206.476723609776, -9343.571051345878, -5730.059875055594, -5430.275721847246, -7745.344468371935, -9461.223212167648, -5702.88513351429, -4158.731261303645, -8045.025689249059, -8260.926141032885, -7052.549766194519, -7317.4433074612025, -7172.923201177303, -4477.709136548842, -3062.769800388018, -8274.847311252353, -6159.638005805825, -7423.420639504116, -5241.583962901566, -9068.69117821055, -4629.904523645677, -9322.040560798647, -6962.789466527731, -9466.276282727938, -9061.322214425905, -7437.678419430478, -11117.098869259391, -10417.505966777568, -9625.124762517848, -8639.172828362412, -4404.145353693377, -6035.034343869311, -9188.105478675365, -9690.103118212915, -5099.236008197248, -9518.319081532685, -10391.899171305939, -371.31643440672445, -10433.180976953197, -8835.827076135443, -9277.961170165352, -6402.718181667005, -7216.34511495114, -6725.497886548036, -4407.149641835535, -41.29021867338399, -6627.084960723162, -2291.2337002283152, -7250.54989315804, -8823.127698781173, -284.36079075760705, -5374.872194015483, -7673.073137447963, -9104.095604744287, -6354.137474513265, -5862.112470970537, -4967.905696509458, -3473.9521227008368, -4529.437406277952, -9219.737877873913, -5702.288953338859, -2835.282429141497, -7535.102660179633, -5819.237803985707, -4606.969786090351, -9075.7561573793, -11325.053182368318, -8992.77113106318, -4084.465042811332, -508.7292532119367, -4581.657766369146, -42.96525505306541, -6645.320757654231, -8404.769853932024], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 200, 200, 155, 200, 100, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 4, 200, 95, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 116, 200, 200, 134, 200, 200, 200, 200, 14, 200, 2, 200, 200], "policy_agent_policy_reward": [2808.958006108835, 2474.3939547817417, 4812.697740956645, 5899.397517514531, 7665.635580052329, 4870.728689173797, 4849.067187704961, 4275.296163964534, 5245.55446675118, 3290.519646846779, 3269.3757576331873, 4346.924031571304, 2293.736807005814, 2132.9341724065694, 7542.124854915076, 5318.292169511457, 4305.864968266215, 5042.207032872293, 2259.3857344877706, 6893.50623395337, 1720.9796167238032, 2531.6343905909575, 5401.754422363601, 7148.557688609518, 456.23039787010725, 4025.9948938366188, 3150.6303447363007, 1947.6170610797128, 4241.187463287851, 2499.6154347790507, 4730.915685558481, 7016.951036123445, 1409.9374184717083, 3615.9333534609896, 6899.385084466837, 6816.859207469119, 2799.3293199936656, 4587.425166566361, 5876.007835159257, 2548.724014460875, 486.43848950056673, 2806.4544658054488, 4280.863909263509, 2621.628505709282, 4379.560496041032, 7291.249016463985, 3401.464094145643, 1235.9527675192974, 3339.9062334600394, 5888.129148944072, 5161.761758232976, 1957.9949188170092, 9011.884551696, 9677.310269560012, 9035.62859810114, 7293.62349006584, 3004.959355989662, 3062.084063967979, 6659.221321049699, 6214.082302586869, 1961.4594888265017, 3034.3278203135806, 3422.9827827777035, 46.90582246394834, 8139.692540559281, 5171.552973726713, 3660.532978283825, 5617.695932711645, 5490.310156441206, 4640.906313301953, 3065.4508587854984, 7.691188194691836, 3418.332770930512, 1387.6479985202916, 4021.2425110308554, 7340.909114549241, 50.13407632605878, 2693.6131397295494, 3943.4966993354333, 7393.820562562378, 2285.3428781785146, 4101.951357341146, 3775.7449142765586, 2480.9556927162935, 3705.835841330883, 3886.1082703450616, 3663.1706733919928, 961.1701603887074, 3612.852250438674, 4789.563770813946, 1494.8024953823463, 7243.337835443231, 1738.6794679213385, 7474.898119618714, 2088.7245466059157, 52.40393323843058, 2572.461373706301, 2.389896701625678, 2305.7793838769308, 2747.2376671133006], "policy_adversary_policy_reward": [-3114.106978943388, -6659.255277764891, -2514.7667288858456, -3940.2807091686345, -6609.313345808196, -4814.914671572231, -6017.958074974018, -7151.28833779325, -7670.963674725963, -9295.356571196098, -8792.047285210936, -4870.728689173797, -4849.067187704961, -6826.9351213776035, -4302.109966371218, -5817.993914111047, -5245.55446675118, -8085.369837426628, -4932.370329247911, -3857.6546105221555, -9056.085863302787, -3270.3017918485875, -5831.55681681171, -4495.727342038605, -4183.544946632682, -2293.736807005814, -3746.4349327191467, -2183.9745543830295, -7563.184923566821, -8613.904547774906, -5579.738126124194, -5972.600795902244, -5682.973176307412, -4655.551172404847, -6857.090683515028, -5204.137275695033, -3553.2388741262935, -2666.723493206415, -9884.230853226705, -6968.481017554383, -1768.1159767829595, -2101.2470061793847, -2695.5892287201045, -5111.719191425299, -5430.674883997379, -6264.928284441564, -8457.277053673544, -7158.341466951559, -1625.5075493633906, -456.23039787010725, -4025.9948938366188, -9292.639465801874, -4013.3321194262694, -7343.774948919804, -9343.571051345882, -1947.6170610797128, -4563.782704759, -5407.464633584445, -5220.37830441827, -2709.5128522080267, -7745.344468371934, -4730.915685558481, -7102.033948837109, -9376.140299453986, -1409.9374184717083, -5702.885133514289, -3683.2926744737056, -4091.371940290928, -7631.96466160136, -7312.446112114538, -7351.2450509948785, -7726.540297507125, -6995.3414567153395, -2856.5376294728453, -4588.150563765631, -7316.717910261935, -5898.374519989036, -7150.556516347524, -4326.599816916647, -2699.833334093072, -3062.7698003880178, -486.43848950056673, -7982.632121165344, -3098.6696558924573, -4436.4723031769945, -6004.029611892334, -7423.4206395041165, -2621.628505709282, -5226.393800620257, -4394.750658322342, -9068.691178210553, -7291.249016463985, -4569.116231024243, -3462.252386767077, -1235.9527675192974, -9322.040560798647, -6946.07786573318, -3356.6178342545895, -5888.129148944072, -9466.276282727938, -5161.761758232976, -9061.322214425905, -7437.67841943048, -1957.9949188170092, -9011.884551696, -11117.098869259391, -9683.138838931021, -10411.677397406558, -9455.144047774473, -9205.609312844519, -7298.702827271842, -8634.093491156413, -4353.115185469947, -3055.9895242130865, -6035.034343869312, -3062.084063967979, -6659.221321049699, -9188.105478675365, -6214.082302586869, -9690.103118212915, -3761.160336214365, -3299.5351608093865, -3034.3278203135806, -9518.319081532685, -3422.9827827777035, -10391.899171305939, -371.3164344067244, -46.90582246394834, -8725.837040251468, -9847.036477261012, -8835.827076135445, -5171.552973726713, -3660.532978283825, -9277.961170165352, -5738.862874556581, -6281.55123982207, -7165.171761131295, -5541.483510261053, -4640.906313301953, -6725.497886548036, -3658.9869887860687, -3813.613511834963, -7.691188194691836, -41.29021867338399, -6620.189442224286, -3425.2282894293885, -1387.6479985202916, -2291.2337002283152, -7208.139332586796, -4063.6530716020975, -7350.150264492918, -8813.886548837494, -284.360790757607, -50.13407632605878, -5364.263162825109, -2704.222170919925, -7673.073137447961, -3943.4966993354333, -8959.264223569196, -7538.651943737472, -5888.743577355037, -2750.736775336744, -4340.82076987022, -5623.243058441464, -4491.9449272642405, -4251.7056835217845, -2482.3578476352827, -3472.549967781847, -4171.907676350928, -4063.3655712579043, -3886.1082703450616, -9219.737877873913, -3928.93430612675, -5436.5253206041025, -970.4409712688306, -2826.011618261377, -3705.3700293525703, -7442.584881265738, -5081.07149958392, -5527.730075215733, -4606.969786090351, -1494.8024953823463, -8050.915074700669, -8268.178918121857, -1738.6794679213385, -11325.053182368318, -8992.771131063177, -7474.898119618714, -2091.967161587211, -4081.2224278300364, -508.7292532119367, -52.40393323843058, -4548.003728034484, -2606.1154120409633, -42.96525505306542, -2.389896701625678, -6645.320757654231, -2305.7793838769308, -2747.2376671133006, -8404.769853932024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43980624590409917, "mean_inference_ms": 1.0695958965166539, "mean_action_processing_ms": 0.183771780894403, "mean_env_wait_ms": 0.056454927689668984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003039717674255371, "StateBufferConnector_ms": 0.002419590950012207, "ViewRequirementAgentConnector_ms": 0.0660560131072998}, "num_episodes": 20, "episode_return_max": -41.29021867338399, "episode_return_min": -11325.053182368318, "episode_return_mean": -6611.869568449665}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.9289588209652, "num_env_steps_trained_throughput_per_sec": 513.9289588209652, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 8154.34, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8154.303, "sample_time_ms": 852.324, "learn_time_ms": 7287.23, "learn_throughput": 548.905, "synch_weights_time_ms": 14.069}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 30, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-04", "timestamp": 1723231804, "time_this_iter_s": 7.788679838180542, "time_total_s": 234.4993941783905, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ece550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.4993941783905, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 26.40833333333333, "ram_util_percent": 81.31666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7654096438549459, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987218085924784, "policy_loss": -0.007078984168523069, "vf_loss": 9.987342515587807, "vf_explained_var": -0.0003501369928320249, "kl": 0.010303021491078349, "entropy": 1.26503799756368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7562293315848345, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994201370521829, "policy_loss": -0.003706242489288487, "vf_loss": 9.994081700037396, "vf_explained_var": -0.0002760737345962928, "kl": 0.01912950053466139, "entropy": 1.5602794500885817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": -41.29021867338399, "episode_reward_min": -11325.053182368318, "episode_reward_mean": -6641.031678052514, "episode_len_mean": 180.18, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18018, "policy_reward_min": {"agent_policy": 2.389896701625678, "adversary_policy": -11325.053182368318}, "policy_reward_max": {"agent_policy": 9677.310269560012, "adversary_policy": -2.389896701625678}, "policy_reward_mean": {"agent_policy": 3990.969961795992, "adversary_policy": -5316.000819924253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6293.84874607534, -8467.060832015586, -1625.5075493633906, -9292.639465801874, -8206.476723609776, -9343.571051345878, -5730.059875055594, -5430.275721847246, -7745.344468371935, -9461.223212167648, -5702.88513351429, -4158.731261303645, -8045.025689249059, -8260.926141032885, -7052.549766194519, -7317.4433074612025, -7172.923201177303, -4477.709136548842, -3062.769800388018, -8274.847311252353, -6159.638005805825, -7423.420639504116, -5241.583962901566, -9068.69117821055, -4629.904523645677, -9322.040560798647, -6962.789466527731, -9466.276282727938, -9061.322214425905, -7437.678419430478, -11117.098869259391, -10417.505966777568, -9625.124762517848, -8639.172828362412, -4404.145353693377, -6035.034343869311, -9188.105478675365, -9690.103118212915, -5099.236008197248, -9518.319081532685, -10391.899171305939, -371.31643440672445, -10433.180976953197, -8835.827076135443, -9277.961170165352, -6402.718181667005, -7216.34511495114, -6725.497886548036, -4407.149641835535, -41.29021867338399, -6627.084960723162, -2291.2337002283152, -7250.54989315804, -8823.127698781173, -284.36079075760705, -5374.872194015483, -7673.073137447963, -9104.095604744287, -6354.137474513265, -5862.112470970537, -4967.905696509458, -3473.9521227008368, -4529.437406277952, -9219.737877873913, -5702.288953338859, -2835.282429141497, -7535.102660179633, -5819.237803985707, -4606.969786090351, -9075.7561573793, -11325.053182368318, -8992.77113106318, -4084.465042811332, -508.7292532119367, -4581.657766369146, -42.96525505306541, -6645.320757654231, -8404.769853932024, -9745.45282866019, -9096.943419962068, -6746.682114503552, -5830.851778996348, -9423.98553478366, -6448.893485975879, -4458.858420110676, -6017.852304849144, -9217.16705220174, -52.393466151306534, -10566.073713386815, -8921.85268602379, -8141.6507107672805, -5135.203624510606, -2371.41990514384, -7685.0227485808255, -3803.317552082887, -8945.192254401602, -200.2132122144785, -9072.134230961989, -4603.898857720268, -7889.861510487078], "episode_lengths": [200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 153, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 4, 200, 95, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 116, 200, 200, 134, 200, 200, 200, 200, 14, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200], "policy_agent_policy_reward": [5401.754422363601, 7148.557688609518, 456.23039787010725, 4025.9948938366188, 3150.6303447363007, 1947.6170610797128, 4241.187463287851, 2499.6154347790507, 4730.915685558481, 7016.951036123445, 1409.9374184717083, 3615.9333534609896, 6899.385084466837, 6816.859207469119, 2799.3293199936656, 4587.425166566361, 5876.007835159257, 2548.724014460875, 486.43848950056673, 2806.4544658054488, 4280.863909263509, 2621.628505709282, 4379.560496041032, 7291.249016463985, 3401.464094145643, 1235.9527675192974, 3339.9062334600394, 5888.129148944072, 5161.761758232976, 1957.9949188170092, 9011.884551696, 9677.310269560012, 9035.62859810114, 7293.62349006584, 3004.959355989662, 3062.084063967979, 6659.221321049699, 6214.082302586869, 1961.4594888265017, 3034.3278203135806, 3422.9827827777035, 46.90582246394834, 8139.692540559281, 5171.552973726713, 3660.532978283825, 5617.695932711645, 5490.310156441206, 4640.906313301953, 3065.4508587854984, 7.691188194691836, 3418.332770930512, 1387.6479985202916, 4021.2425110308554, 7340.909114549241, 50.13407632605878, 2693.6131397295494, 3943.4966993354333, 7393.820562562378, 2285.3428781785146, 4101.951357341146, 3775.7449142765586, 2480.9556927162935, 3705.835841330883, 3886.1082703450616, 3663.1706733919928, 961.1701603887074, 3612.852250438674, 4789.563770813946, 1494.8024953823463, 7243.337835443231, 1738.6794679213385, 7474.898119618714, 2088.7245466059157, 52.40393323843058, 2572.461373706301, 2.389896701625678, 2305.7793838769308, 2747.2376671133006, 4341.333909937304, 6709.526326247985, 5873.604331845632, 2705.971808306173, 2417.129767736575, 3672.129844223356, 2488.2532047929126, 4553.694157866163, 3651.209220627042, 2.5096432525994343, 8962.986264535366, 6359.522265401581, 5637.755522099973, 2030.5102581438282, 1559.4532999663795, 5236.354127742507, 3149.7342972196684, 7260.818555872389, 28.309294522783716, 6720.678573140977, 2439.5067761151927, 5820.634886588373], "policy_adversary_policy_reward": [-5430.674883997379, -6264.928284441564, -8457.277053673544, -7158.341466951559, -1625.5075493633906, -456.23039787010725, -4025.9948938366188, -9292.639465801874, -4013.3321194262694, -7343.774948919804, -9343.571051345882, -1947.6170610797128, -4563.782704759, -5407.464633584445, -5220.37830441827, -2709.5128522080267, -7745.344468371934, -4730.915685558481, -7102.033948837109, -9376.140299453986, -1409.9374184717083, -5702.885133514289, -3683.2926744737056, -4091.371940290928, -7631.96466160136, -7312.446112114538, -7351.2450509948785, -7726.540297507125, -6995.3414567153395, -2856.5376294728453, -4588.150563765631, -7316.717910261935, -5898.374519989036, -7150.556516347524, -4326.599816916647, -2699.833334093072, -3062.7698003880178, -486.43848950056673, -7982.632121165344, -3098.6696558924573, -4436.4723031769945, -6004.029611892334, -7423.4206395041165, -2621.628505709282, -5226.393800620257, -4394.750658322342, -9068.691178210553, -7291.249016463985, -4569.116231024243, -3462.252386767077, -1235.9527675192974, -9322.040560798647, -6946.07786573318, -3356.6178342545895, -5888.129148944072, -9466.276282727938, -5161.761758232976, -9061.322214425905, -7437.67841943048, -1957.9949188170092, -9011.884551696, -11117.098869259391, -9683.138838931021, -10411.677397406558, -9455.144047774473, -9205.609312844519, -7298.702827271842, -8634.093491156413, -4353.115185469947, -3055.9895242130865, -6035.034343869312, -3062.084063967979, -6659.221321049699, -9188.105478675365, -6214.082302586869, -9690.103118212915, -3761.160336214365, -3299.5351608093865, -3034.3278203135806, -9518.319081532685, -3422.9827827777035, -10391.899171305939, -371.3164344067244, -46.90582246394834, -8725.837040251468, -9847.036477261012, -8835.827076135445, -5171.552973726713, -3660.532978283825, -9277.961170165352, -5738.862874556581, -6281.55123982207, -7165.171761131295, -5541.483510261053, -4640.906313301953, -6725.497886548036, -3658.9869887860687, -3813.613511834963, -7.691188194691836, -41.29021867338399, -6620.189442224286, -3425.2282894293885, -1387.6479985202916, -2291.2337002283152, -7208.139332586796, -4063.6530716020975, -7350.150264492918, -8813.886548837494, -284.360790757607, -50.13407632605878, -5364.263162825109, -2704.222170919925, -7673.073137447961, -3943.4966993354333, -8959.264223569196, -7538.651943737472, -5888.743577355037, -2750.736775336744, -4340.82076987022, -5623.243058441464, -4491.9449272642405, -4251.7056835217845, -2482.3578476352827, -3472.549967781847, -4171.907676350928, -4063.3655712579043, -3886.1082703450616, -9219.737877873913, -3928.93430612675, -5436.5253206041025, -970.4409712688306, -2826.011618261377, -3705.3700293525703, -7442.584881265738, -5081.07149958392, -5527.730075215733, -4606.969786090351, -1494.8024953823463, -8050.915074700669, -8268.178918121857, -1738.6794679213385, -11325.053182368318, -8992.771131063177, -7474.898119618714, -2091.967161587211, -4081.2224278300364, -508.7292532119367, -52.40393323843058, -4548.003728034484, -2606.1154120409633, -42.96525505306542, -2.389896701625678, -6645.320757654231, -2305.7793838769308, -2747.2376671133006, -8404.769853932024, -4341.333909937304, -9745.452828660193, -8706.309492572243, -7100.1602536378105, -6738.37554493837, -5881.910901410814, -2705.971808306173, -5830.851778996348, -2417.129767736575, -9423.98553478366, -6448.893485975878, -3672.129844223356, -2488.6683083378343, -4458.443316565755, -4766.461993831479, -5805.084468883827, -3651.209220627042, -9217.16705220174, -52.39346615130653, -2.5096432525994343, -8963.354079184124, -10565.705898738057, -8921.852686023789, -6359.522265401581, -8140.77782972854, -5638.628403138713, -5105.738731079468, -2059.9751515749635, -2154.195999777592, -1776.6772053326313, -5249.75478183035, -7671.622094492983, -3572.113615391565, -3380.9382339109893, -8697.340539860166, -7508.67027041382, -200.2132122144785, -28.309294522783716, -6721.178471954414, -9071.634332148553, -4357.645580976581, -2685.7600528588796, -7852.424624332822, -5858.071772742628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.437921424935216, "mean_inference_ms": 1.065866250352077, "mean_action_processing_ms": 0.18300867412702237, "mean_env_wait_ms": 0.05619254422177442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030246973037719727, "StateBufferConnector_ms": 0.0024586915969848633, "ViewRequirementAgentConnector_ms": 0.06524264812469482}, "num_episodes": 22, "episode_return_max": -41.29021867338399, "episode_return_min": -11325.053182368318, "episode_return_mean": -6641.031678052514}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 526.0519508258599, "num_env_steps_trained_throughput_per_sec": 526.0519508258599, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 8091.605, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8091.568, "sample_time_ms": 850.967, "learn_time_ms": 7225.731, "learn_throughput": 553.577, "synch_weights_time_ms": 14.192}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 31, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-12", "timestamp": 1723231812, "time_this_iter_s": 7.609025955200195, "time_total_s": 242.1084201335907, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ece5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.1084201335907, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 22.33636363636364, "ram_util_percent": 81.46363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7675582608673721, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.969676368435223, "policy_loss": -0.001976011600345373, "vf_loss": 9.96764297882716, "vf_explained_var": -0.000540156103670597, "kl": 0.005939865114730007, "entropy": 1.236755257844925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.785813583394207, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983425401253674, "policy_loss": -0.0039736560434989986, "vf_loss": 9.983503844246032, "vf_explained_var": 5.5746142826383076e-05, "kl": 0.019476114089783066, "entropy": 1.575892338487837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": -41.29021867338399, "episode_reward_min": -11325.053182368318, "episode_reward_mean": -6541.570115786262, "episode_len_mean": 177.59, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17759, "policy_reward_min": {"agent_policy": 2.389896701625678, "adversary_policy": -11325.053182368318}, "policy_reward_max": {"agent_policy": 9677.310269560012, "adversary_policy": -2.389896701625678}, "policy_reward_mean": {"agent_policy": 4021.882188915498, "adversary_policy": -5281.72615235088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9068.69117821055, -4629.904523645677, -9322.040560798647, -6962.789466527731, -9466.276282727938, -9061.322214425905, -7437.678419430478, -11117.098869259391, -10417.505966777568, -9625.124762517848, -8639.172828362412, -4404.145353693377, -6035.034343869311, -9188.105478675365, -9690.103118212915, -5099.236008197248, -9518.319081532685, -10391.899171305939, -371.31643440672445, -10433.180976953197, -8835.827076135443, -9277.961170165352, -6402.718181667005, -7216.34511495114, -6725.497886548036, -4407.149641835535, -41.29021867338399, -6627.084960723162, -2291.2337002283152, -7250.54989315804, -8823.127698781173, -284.36079075760705, -5374.872194015483, -7673.073137447963, -9104.095604744287, -6354.137474513265, -5862.112470970537, -4967.905696509458, -3473.9521227008368, -4529.437406277952, -9219.737877873913, -5702.288953338859, -2835.282429141497, -7535.102660179633, -5819.237803985707, -4606.969786090351, -9075.7561573793, -11325.053182368318, -8992.77113106318, -4084.465042811332, -508.7292532119367, -4581.657766369146, -42.96525505306541, -6645.320757654231, -8404.769853932024, -9745.45282866019, -9096.943419962068, -6746.682114503552, -5830.851778996348, -9423.98553478366, -6448.893485975879, -4458.858420110676, -6017.852304849144, -9217.16705220174, -52.393466151306534, -10566.073713386815, -8921.85268602379, -8141.6507107672805, -5135.203624510606, -2371.41990514384, -7685.0227485808255, -3803.317552082887, -8945.192254401602, -200.2132122144785, -9072.134230961989, -4603.898857720268, -7889.861510487078, -5270.594745466986, -8057.223539980359, -5219.384396760338, -5244.344590296011, -10162.095424766747, -9939.804893772052, -9661.23771355955, -4651.825899316343, -970.1533226692773, -10542.718339245603, -4658.6088133050935, -7015.200104768302, -5284.147940345843, -9809.457909306446, -6050.005929725929, -4305.382236096936, -8552.146559997607, -6415.441031795696, -7684.80702255844, -517.1131425914124, -793.2595989222051, -7030.110569428969, -6165.241050686625], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 4, 200, 95, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 116, 200, 200, 134, 200, 200, 200, 200, 14, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 53, 200, 150, 200, 197, 200, 200, 200, 200, 200, 200, 15, 29, 200, 200], "policy_agent_policy_reward": [7291.249016463985, 3401.464094145643, 1235.9527675192974, 3339.9062334600394, 5888.129148944072, 5161.761758232976, 1957.9949188170092, 9011.884551696, 9677.310269560012, 9035.62859810114, 7293.62349006584, 3004.959355989662, 3062.084063967979, 6659.221321049699, 6214.082302586869, 1961.4594888265017, 3034.3278203135806, 3422.9827827777035, 46.90582246394834, 8139.692540559281, 5171.552973726713, 3660.532978283825, 5617.695932711645, 5490.310156441206, 4640.906313301953, 3065.4508587854984, 7.691188194691836, 3418.332770930512, 1387.6479985202916, 4021.2425110308554, 7340.909114549241, 50.13407632605878, 2693.6131397295494, 3943.4966993354333, 7393.820562562378, 2285.3428781785146, 4101.951357341146, 3775.7449142765586, 2480.9556927162935, 3705.835841330883, 3886.1082703450616, 3663.1706733919928, 961.1701603887074, 3612.852250438674, 4789.563770813946, 1494.8024953823463, 7243.337835443231, 1738.6794679213385, 7474.898119618714, 2088.7245466059157, 52.40393323843058, 2572.461373706301, 2.389896701625678, 2305.7793838769308, 2747.2376671133006, 4341.333909937304, 6709.526326247985, 5873.604331845632, 2705.971808306173, 2417.129767736575, 3672.129844223356, 2488.2532047929126, 4553.694157866163, 3651.209220627042, 2.5096432525994343, 8962.986264535366, 6359.522265401581, 5637.755522099973, 2030.5102581438282, 1559.4532999663795, 5236.354127742507, 3149.7342972196684, 7260.818555872389, 28.309294522783716, 6720.678573140977, 2439.5067761151927, 5820.634886588373, 2955.4743765148387, 5387.709190579685, 3421.812930115864, 2748.86754307325, 4915.818974648608, 8542.68740834303, 8548.121741457664, 1191.8209575668452, 777.7015323876585, 9663.960212684507, 2547.164041306672, 3966.655673499792, 1561.2382358972293, 8576.2133466037, 4898.585418962745, 3105.159320716712, 6625.484635026507, 1999.9690937651703, 3785.9895344092274, 68.6737537440455, 195.17603924032105, 4594.199487812506, 2760.740958207421], "policy_adversary_policy_reward": [-9068.691178210553, -7291.249016463985, -4569.116231024243, -3462.252386767077, -1235.9527675192974, -9322.040560798647, -6946.07786573318, -3356.6178342545895, -5888.129148944072, -9466.276282727938, -5161.761758232976, -9061.322214425905, -7437.67841943048, -1957.9949188170092, -9011.884551696, -11117.098869259391, -9683.138838931021, -10411.677397406558, -9455.144047774473, -9205.609312844519, -7298.702827271842, -8634.093491156413, -4353.115185469947, -3055.9895242130865, -6035.034343869312, -3062.084063967979, -6659.221321049699, -9188.105478675365, -6214.082302586869, -9690.103118212915, -3761.160336214365, -3299.5351608093865, -3034.3278203135806, -9518.319081532685, -3422.9827827777035, -10391.899171305939, -371.3164344067244, -46.90582246394834, -8725.837040251468, -9847.036477261012, -8835.827076135445, -5171.552973726713, -3660.532978283825, -9277.961170165352, -5738.862874556581, -6281.55123982207, -7165.171761131295, -5541.483510261053, -4640.906313301953, -6725.497886548036, -3658.9869887860687, -3813.613511834963, -7.691188194691836, -41.29021867338399, -6620.189442224286, -3425.2282894293885, -1387.6479985202916, -2291.2337002283152, -7208.139332586796, -4063.6530716020975, -7350.150264492918, -8813.886548837494, -284.360790757607, -50.13407632605878, -5364.263162825109, -2704.222170919925, -7673.073137447961, -3943.4966993354333, -8959.264223569196, -7538.651943737472, -5888.743577355037, -2750.736775336744, -4340.82076987022, -5623.243058441464, -4491.9449272642405, -4251.7056835217845, -2482.3578476352827, -3472.549967781847, -4171.907676350928, -4063.3655712579043, -3886.1082703450616, -9219.737877873913, -3928.93430612675, -5436.5253206041025, -970.4409712688306, -2826.011618261377, -3705.3700293525703, -7442.584881265738, -5081.07149958392, -5527.730075215733, -4606.969786090351, -1494.8024953823463, -8050.915074700669, -8268.178918121857, -1738.6794679213385, -11325.053182368318, -8992.771131063177, -7474.898119618714, -2091.967161587211, -4081.2224278300364, -508.7292532119367, -52.40393323843058, -4548.003728034484, -2606.1154120409633, -42.96525505306542, -2.389896701625678, -6645.320757654231, -2305.7793838769308, -2747.2376671133006, -8404.769853932024, -4341.333909937304, -9745.452828660193, -8706.309492572243, -7100.1602536378105, -6738.37554493837, -5881.910901410814, -2705.971808306173, -5830.851778996348, -2417.129767736575, -9423.98553478366, -6448.893485975878, -3672.129844223356, -2488.6683083378343, -4458.443316565755, -4766.461993831479, -5805.084468883827, -3651.209220627042, -9217.16705220174, -52.39346615130653, -2.5096432525994343, -8963.354079184124, -10565.705898738057, -8921.852686023789, -6359.522265401581, -8140.77782972854, -5638.628403138713, -5105.738731079468, -2059.9751515749635, -2154.195999777592, -1776.6772053326313, -5249.75478183035, -7671.622094492983, -3572.113615391565, -3380.9382339109893, -8697.340539860166, -7508.67027041382, -200.2132122144785, -28.309294522783716, -6721.178471954414, -9071.634332148553, -4357.645580976581, -2685.7600528588796, -7852.424624332822, -5858.071772742628, -3617.6639907333915, -4608.405131248433, -5387.709190579685, -8057.223539980359, -5173.98451903965, -3467.2128078365513, -5243.398481961357, -2749.813651407904, -10162.095424766747, -4915.818974648608, -9812.127926147654, -8670.364375967427, -8738.854558930114, -9470.504896087094, -1786.7849000243918, -4056.8619568587933, -803.3504378552783, -944.5044172016575, -10482.333025778535, -9724.345526151577, -2675.9329310159324, -4529.839923595833, -6926.655566207796, -4055.2002120602947, -1905.7950025830858, -4939.591173659985, -8778.015571462543, -9607.6556844476, -4956.887562046278, -5991.703786642396, -3999.1013203079033, -3411.4402365057445, -8552.146559997609, -6625.484635026507, -6415.441031795697, -1999.9690937651703, -7684.80702255844, -3785.9895344092274, -68.6737537440455, -517.1131425914124, -793.2595989222051, -195.17603924032105, -6859.408325692205, -4764.901731549274, -3179.365093469114, -5746.616915424934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4363716480121706, "mean_inference_ms": 1.05961799990665, "mean_action_processing_ms": 0.1822287260518829, "mean_env_wait_ms": 0.05592588019679079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031365156173706055, "StateBufferConnector_ms": 0.0025156736373901367, "ViewRequirementAgentConnector_ms": 0.0680915117263794}, "num_episodes": 23, "episode_return_max": -41.29021867338399, "episode_return_min": -11325.053182368318, "episode_return_mean": -6541.570115786262}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.2828149047075, "num_env_steps_trained_throughput_per_sec": 538.2828149047075, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 8040.037, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8039.999, "sample_time_ms": 820.008, "learn_time_ms": 7205.228, "learn_throughput": 555.152, "synch_weights_time_ms": 14.062}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 32, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-20", "timestamp": 1723231820, "time_this_iter_s": 7.436570167541504, "time_total_s": 249.5449903011322, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ece790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.5449903011322, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.1, "ram_util_percent": 81.23000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7291085051838309, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993585281570752, "policy_loss": 0.00015781339485935555, "vf_loss": 9.98993429640929, "vf_explained_var": -0.0002505036691824595, "kl": 0.00517511338184704, "entropy": 1.2543243490159512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.754498142413992, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992648145382997, "policy_loss": -0.005514805895404486, "vf_loss": 9.994969152016614, "vf_explained_var": 0.00020554671211848183, "kl": 0.015969061987504127, "entropy": 1.5725832133066087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": -41.29021867338399, "episode_reward_min": -11839.68424793641, "episode_reward_mean": -6501.8990509596015, "episode_len_mean": 177.94, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17794, "policy_reward_min": {"agent_policy": 2.389896701625678, "adversary_policy": -11837.43196864523}, "policy_reward_max": {"agent_policy": 9663.960212684507, "adversary_policy": -2.389896701625678}, "policy_reward_mean": {"agent_policy": 3908.0087544559087, "adversary_policy": -5204.953902707755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7216.34511495114, -6725.497886548036, -4407.149641835535, -41.29021867338399, -6627.084960723162, -2291.2337002283152, -7250.54989315804, -8823.127698781173, -284.36079075760705, -5374.872194015483, -7673.073137447963, -9104.095604744287, -6354.137474513265, -5862.112470970537, -4967.905696509458, -3473.9521227008368, -4529.437406277952, -9219.737877873913, -5702.288953338859, -2835.282429141497, -7535.102660179633, -5819.237803985707, -4606.969786090351, -9075.7561573793, -11325.053182368318, -8992.77113106318, -4084.465042811332, -508.7292532119367, -4581.657766369146, -42.96525505306541, -6645.320757654231, -8404.769853932024, -9745.45282866019, -9096.943419962068, -6746.682114503552, -5830.851778996348, -9423.98553478366, -6448.893485975879, -4458.858420110676, -6017.852304849144, -9217.16705220174, -52.393466151306534, -10566.073713386815, -8921.85268602379, -8141.6507107672805, -5135.203624510606, -2371.41990514384, -7685.0227485808255, -3803.317552082887, -8945.192254401602, -200.2132122144785, -9072.134230961989, -4603.898857720268, -7889.861510487078, -5270.594745466986, -8057.223539980359, -5219.384396760338, -5244.344590296011, -10162.095424766747, -9939.804893772052, -9661.23771355955, -4651.825899316343, -970.1533226692773, -10542.718339245603, -4658.6088133050935, -7015.200104768302, -5284.147940345843, -9809.457909306446, -6050.005929725929, -4305.382236096936, -8552.146559997607, -6415.441031795696, -7684.80702255844, -517.1131425914124, -793.2595989222051, -7030.110569428969, -6165.241050686625, -11839.68424793641, -7611.123276249147, -10456.983511382952, -9366.196846557827, -5474.360660642433, -7797.00460664524, -8336.250863618581, -8279.948551313311, -8341.504700059186, -5727.817221631958, -8543.176850982172, -10895.966183119648, -7064.373065727383, -9956.558992366095, -7313.860754888577, -7844.156386172167, -8923.572420053362, -6514.234463805319, -7730.353081118444, -7158.473953447795, -811.796240728971, -9234.513590159582, -6206.434516226129], "episode_lengths": [200, 200, 200, 4, 200, 95, 200, 200, 10, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 116, 200, 200, 134, 200, 200, 200, 200, 14, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 53, 200, 150, 200, 197, 200, 200, 200, 200, 200, 200, 15, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200], "policy_agent_policy_reward": [5490.310156441206, 4640.906313301953, 3065.4508587854984, 7.691188194691836, 3418.332770930512, 1387.6479985202916, 4021.2425110308554, 7340.909114549241, 50.13407632605878, 2693.6131397295494, 3943.4966993354333, 7393.820562562378, 2285.3428781785146, 4101.951357341146, 3775.7449142765586, 2480.9556927162935, 3705.835841330883, 3886.1082703450616, 3663.1706733919928, 961.1701603887074, 3612.852250438674, 4789.563770813946, 1494.8024953823463, 7243.337835443231, 1738.6794679213385, 7474.898119618714, 2088.7245466059157, 52.40393323843058, 2572.461373706301, 2.389896701625678, 2305.7793838769308, 2747.2376671133006, 4341.333909937304, 6709.526326247985, 5873.604331845632, 2705.971808306173, 2417.129767736575, 3672.129844223356, 2488.2532047929126, 4553.694157866163, 3651.209220627042, 2.5096432525994343, 8962.986264535366, 6359.522265401581, 5637.755522099973, 2030.5102581438282, 1559.4532999663795, 5236.354127742507, 3149.7342972196684, 7260.818555872389, 28.309294522783716, 6720.678573140977, 2439.5067761151927, 5820.634886588373, 2955.4743765148387, 5387.709190579685, 3421.812930115864, 2748.86754307325, 4915.818974648608, 8542.68740834303, 8548.121741457664, 1191.8209575668452, 777.7015323876585, 9663.960212684507, 2547.164041306672, 3966.655673499792, 1561.2382358972293, 8576.2133466037, 4898.585418962745, 3105.159320716712, 6625.484635026507, 1999.9690937651703, 3785.9895344092274, 68.6737537440455, 195.17603924032105, 4594.199487812506, 2760.740958207421, 8913.201827756273, 6660.997410136262, 2182.0009162310644, 2452.6738050101517, 4158.489661836115, 4039.475360731854, 5298.660445688393, 3438.219170285715, 2257.6169848873997, 2399.641543544925, 3632.4494063301245, 7544.613725781245, 3752.643735042076, 5721.742270324492, 2655.987914116346, 5253.229004524314, 6432.867769714552, 2709.6762478813584, 6630.054639363819, 6458.429855159561, 220.4390702559546, 6379.151871499414, 2710.7961482031646], "policy_adversary_policy_reward": [-7165.171761131295, -5541.483510261053, -4640.906313301953, -6725.497886548036, -3658.9869887860687, -3813.613511834963, -7.691188194691836, -41.29021867338399, -6620.189442224286, -3425.2282894293885, -1387.6479985202916, -2291.2337002283152, -7208.139332586796, -4063.6530716020975, -7350.150264492918, -8813.886548837494, -284.360790757607, -50.13407632605878, -5364.263162825109, -2704.222170919925, -7673.073137447961, -3943.4966993354333, -8959.264223569196, -7538.651943737472, -5888.743577355037, -2750.736775336744, -4340.82076987022, -5623.243058441464, -4491.9449272642405, -4251.7056835217845, -2482.3578476352827, -3472.549967781847, -4171.907676350928, -4063.3655712579043, -3886.1082703450616, -9219.737877873913, -3928.93430612675, -5436.5253206041025, -970.4409712688306, -2826.011618261377, -3705.3700293525703, -7442.584881265738, -5081.07149958392, -5527.730075215733, -4606.969786090351, -1494.8024953823463, -8050.915074700669, -8268.178918121857, -1738.6794679213385, -11325.053182368318, -8992.771131063177, -7474.898119618714, -2091.967161587211, -4081.2224278300364, -508.7292532119367, -52.40393323843058, -4548.003728034484, -2606.1154120409633, -42.96525505306542, -2.389896701625678, -6645.320757654231, -2305.7793838769308, -2747.2376671133006, -8404.769853932024, -4341.333909937304, -9745.452828660193, -8706.309492572243, -7100.1602536378105, -6738.37554493837, -5881.910901410814, -2705.971808306173, -5830.851778996348, -2417.129767736575, -9423.98553478366, -6448.893485975878, -3672.129844223356, -2488.6683083378343, -4458.443316565755, -4766.461993831479, -5805.084468883827, -3651.209220627042, -9217.16705220174, -52.39346615130653, -2.5096432525994343, -8963.354079184124, -10565.705898738057, -8921.852686023789, -6359.522265401581, -8140.77782972854, -5638.628403138713, -5105.738731079468, -2059.9751515749635, -2154.195999777592, -1776.6772053326313, -5249.75478183035, -7671.622094492983, -3572.113615391565, -3380.9382339109893, -8697.340539860166, -7508.67027041382, -200.2132122144785, -28.309294522783716, -6721.178471954414, -9071.634332148553, -4357.645580976581, -2685.7600528588796, -7852.424624332822, -5858.071772742628, -3617.6639907333915, -4608.405131248433, -5387.709190579685, -8057.223539980359, -5173.98451903965, -3467.2128078365513, -5243.398481961357, -2749.813651407904, -10162.095424766747, -4915.818974648608, -9812.127926147654, -8670.364375967427, -8738.854558930114, -9470.504896087094, -1786.7849000243918, -4056.8619568587933, -803.3504378552783, -944.5044172016575, -10482.333025778535, -9724.345526151577, -2675.9329310159324, -4529.839923595833, -6926.655566207796, -4055.2002120602947, -1905.7950025830858, -4939.591173659985, -8778.015571462543, -9607.6556844476, -4956.887562046278, -5991.703786642396, -3999.1013203079033, -3411.4402365057445, -8552.146559997609, -6625.484635026507, -6415.441031795697, -1999.9690937651703, -7684.80702255844, -3785.9895344092274, -68.6737537440455, -517.1131425914124, -793.2595989222051, -195.17603924032105, -6859.408325692205, -4764.901731549274, -3179.365093469114, -5746.616915424934, -11837.43196864523, -8915.454107047452, -7325.234888186363, -6946.885798199047, -2182.0009162310644, -10456.983511382952, -2452.6738050101517, -9366.196846557827, -4158.489661836115, -5474.360660642432, -7797.004606645241, -4039.475360731854, -8336.25086361858, -5298.660445688393, -6978.644385938378, -4739.523335660646, -2257.6169848873997, -8341.504700059186, -5727.817221631958, -2399.641543544925, -8448.433844014333, -3727.1924132979643, -7544.613725781245, -10895.96618311965, -3752.643735042076, -7064.373065727383, -9943.978340791084, -5734.322921899503, -7313.860754888578, -2655.987914116346, -7505.471590759998, -5591.913799936479, -8923.57242005336, -6432.867769714552, -6514.234463805319, -2709.6762478813584, -7682.617918126897, -6677.789802355367, -6476.061297899157, -7140.8425107081985, -220.4390702559546, -811.796240728971, -9234.513590159586, -6379.151871499414, -6206.434516226129, -2710.7961482031646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43500297124172815, "mean_inference_ms": 1.0545500948540374, "mean_action_processing_ms": 0.18155625261792085, "mean_env_wait_ms": 0.05564915691129878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003162980079650879, "StateBufferConnector_ms": 0.0025205612182617188, "ViewRequirementAgentConnector_ms": 0.0686957836151123}, "num_episodes": 23, "episode_return_max": -41.29021867338399, "episode_return_min": -11839.68424793641, "episode_return_mean": -6501.8990509596015}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.7080359754264, "num_env_steps_trained_throughput_per_sec": 525.7080359754264, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 8036.447, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8036.41, "sample_time_ms": 815.515, "learn_time_ms": 7206.135, "learn_throughput": 555.083, "synch_weights_time_ms": 14.058}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 33, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-27", "timestamp": 1723231827, "time_this_iter_s": 7.614377975463867, "time_total_s": 257.15936827659607, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ab9550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.15936827659607, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.590909090909086, "ram_util_percent": 80.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7017547799739987, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994878320892651, "policy_loss": 0.00020514378848019988, "vf_loss": 9.989694090684255, "vf_explained_var": -0.0007585657760500908, "kl": 0.007376408535249842, "entropy": 1.2786120157688856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7617666851748865, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997859930109096, "policy_loss": -0.00014915589203752538, "vf_loss": 9.994776044068512, "vf_explained_var": 0.0001276229739819885, "kl": 0.016165187116712332, "entropy": 1.550161906020351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": -42.96525505306541, "episode_reward_min": -11839.68424793641, "episode_reward_mean": -6681.477890728269, "episode_len_mean": 182.51, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 18251, "policy_reward_min": {"agent_policy": 2.389896701625678, "adversary_policy": -11837.43196864523}, "policy_reward_max": {"agent_policy": 9663.960212684507, "adversary_policy": -2.389896701625678}, "policy_reward_mean": {"agent_policy": 3949.029717458426, "adversary_policy": -5315.253804093348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2835.282429141497, -7535.102660179633, -5819.237803985707, -4606.969786090351, -9075.7561573793, -11325.053182368318, -8992.77113106318, -4084.465042811332, -508.7292532119367, -4581.657766369146, -42.96525505306541, -6645.320757654231, -8404.769853932024, -9745.45282866019, -9096.943419962068, -6746.682114503552, -5830.851778996348, -9423.98553478366, -6448.893485975879, -4458.858420110676, -6017.852304849144, -9217.16705220174, -52.393466151306534, -10566.073713386815, -8921.85268602379, -8141.6507107672805, -5135.203624510606, -2371.41990514384, -7685.0227485808255, -3803.317552082887, -8945.192254401602, -200.2132122144785, -9072.134230961989, -4603.898857720268, -7889.861510487078, -5270.594745466986, -8057.223539980359, -5219.384396760338, -5244.344590296011, -10162.095424766747, -9939.804893772052, -9661.23771355955, -4651.825899316343, -970.1533226692773, -10542.718339245603, -4658.6088133050935, -7015.200104768302, -5284.147940345843, -9809.457909306446, -6050.005929725929, -4305.382236096936, -8552.146559997607, -6415.441031795696, -7684.80702255844, -517.1131425914124, -793.2595989222051, -7030.110569428969, -6165.241050686625, -11839.68424793641, -7611.123276249147, -10456.983511382952, -9366.196846557827, -5474.360660642433, -7797.00460664524, -8336.250863618581, -8279.948551313311, -8341.504700059186, -5727.817221631958, -8543.176850982172, -10895.966183119648, -7064.373065727383, -9956.558992366095, -7313.860754888577, -7844.156386172167, -8923.572420053362, -6514.234463805319, -7730.353081118444, -7158.473953447795, -811.796240728971, -9234.513590159582, -6206.434516226129, -8609.545153947929, -5868.02127777497, -8273.333735920538, -8052.508489363261, -5985.613675450199, -5198.98241482318, -4868.345536718425, -3650.9712835270993, -6111.234540510183, -8693.602073050508, -8537.729155658139, -9185.840854879603, -7968.64650799496, -6960.200577223825, -4825.048134408597, -6127.424133179422, -1586.456981519562, -8281.791059837884, -5100.841235127324], "episode_lengths": [116, 200, 200, 134, 200, 200, 200, 200, 14, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 53, 200, 150, 200, 197, 200, 200, 200, 200, 200, 200, 15, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200], "policy_agent_policy_reward": [961.1701603887074, 3612.852250438674, 4789.563770813946, 1494.8024953823463, 7243.337835443231, 1738.6794679213385, 7474.898119618714, 2088.7245466059157, 52.40393323843058, 2572.461373706301, 2.389896701625678, 2305.7793838769308, 2747.2376671133006, 4341.333909937304, 6709.526326247985, 5873.604331845632, 2705.971808306173, 2417.129767736575, 3672.129844223356, 2488.2532047929126, 4553.694157866163, 3651.209220627042, 2.5096432525994343, 8962.986264535366, 6359.522265401581, 5637.755522099973, 2030.5102581438282, 1559.4532999663795, 5236.354127742507, 3149.7342972196684, 7260.818555872389, 28.309294522783716, 6720.678573140977, 2439.5067761151927, 5820.634886588373, 2955.4743765148387, 5387.709190579685, 3421.812930115864, 2748.86754307325, 4915.818974648608, 8542.68740834303, 8548.121741457664, 1191.8209575668452, 777.7015323876585, 9663.960212684507, 2547.164041306672, 3966.655673499792, 1561.2382358972293, 8576.2133466037, 4898.585418962745, 3105.159320716712, 6625.484635026507, 1999.9690937651703, 3785.9895344092274, 68.6737537440455, 195.17603924032105, 4594.199487812506, 2760.740958207421, 8913.201827756273, 6660.997410136262, 2182.0009162310644, 2452.6738050101517, 4158.489661836115, 4039.475360731854, 5298.660445688393, 3438.219170285715, 2257.6169848873997, 2399.641543544925, 3632.4494063301245, 7544.613725781245, 3752.643735042076, 5721.742270324492, 2655.987914116346, 5253.229004524314, 6432.867769714552, 2709.6762478813584, 6630.054639363819, 6458.429855159561, 220.4390702559546, 6379.151871499414, 2710.7961482031646, 5874.22519543059, 4461.142992076787, 5755.981074784882, 4100.173129345915, 3757.1557015860226, 2589.7609605439893, 2829.189285819258, 3035.174711894305, 3436.124168079939, 7197.907548866527, 6540.639178955471, 1506.9388430456938, 1971.907963267949, 5022.826418410053, 2279.4878674565016, 3942.004653188797, 996.3967178194825, 2814.2724854337634, 3343.452421533887], "policy_adversary_policy_reward": [-970.4409712688306, -2826.011618261377, -3705.3700293525703, -7442.584881265738, -5081.07149958392, -5527.730075215733, -4606.969786090351, -1494.8024953823463, -8050.915074700669, -8268.178918121857, -1738.6794679213385, -11325.053182368318, -8992.771131063177, -7474.898119618714, -2091.967161587211, -4081.2224278300364, -508.7292532119367, -52.40393323843058, -4548.003728034484, -2606.1154120409633, -42.96525505306542, -2.389896701625678, -6645.320757654231, -2305.7793838769308, -2747.2376671133006, -8404.769853932024, -4341.333909937304, -9745.452828660193, -8706.309492572243, -7100.1602536378105, -6738.37554493837, -5881.910901410814, -2705.971808306173, -5830.851778996348, -2417.129767736575, -9423.98553478366, -6448.893485975878, -3672.129844223356, -2488.6683083378343, -4458.443316565755, -4766.461993831479, -5805.084468883827, -3651.209220627042, -9217.16705220174, -52.39346615130653, -2.5096432525994343, -8963.354079184124, -10565.705898738057, -8921.852686023789, -6359.522265401581, -8140.77782972854, -5638.628403138713, -5105.738731079468, -2059.9751515749635, -2154.195999777592, -1776.6772053326313, -5249.75478183035, -7671.622094492983, -3572.113615391565, -3380.9382339109893, -8697.340539860166, -7508.67027041382, -200.2132122144785, -28.309294522783716, -6721.178471954414, -9071.634332148553, -4357.645580976581, -2685.7600528588796, -7852.424624332822, -5858.071772742628, -3617.6639907333915, -4608.405131248433, -5387.709190579685, -8057.223539980359, -5173.98451903965, -3467.2128078365513, -5243.398481961357, -2749.813651407904, -10162.095424766747, -4915.818974648608, -9812.127926147654, -8670.364375967427, -8738.854558930114, -9470.504896087094, -1786.7849000243918, -4056.8619568587933, -803.3504378552783, -944.5044172016575, -10482.333025778535, -9724.345526151577, -2675.9329310159324, -4529.839923595833, -6926.655566207796, -4055.2002120602947, -1905.7950025830858, -4939.591173659985, -8778.015571462543, -9607.6556844476, -4956.887562046278, -5991.703786642396, -3999.1013203079033, -3411.4402365057445, -8552.146559997609, -6625.484635026507, -6415.441031795697, -1999.9690937651703, -7684.80702255844, -3785.9895344092274, -68.6737537440455, -517.1131425914124, -793.2595989222051, -195.17603924032105, -6859.408325692205, -4764.901731549274, -3179.365093469114, -5746.616915424934, -11837.43196864523, -8915.454107047452, -7325.234888186363, -6946.885798199047, -2182.0009162310644, -10456.983511382952, -2452.6738050101517, -9366.196846557827, -4158.489661836115, -5474.360660642432, -7797.004606645241, -4039.475360731854, -8336.25086361858, -5298.660445688393, -6978.644385938378, -4739.523335660646, -2257.6169848873997, -8341.504700059186, -5727.817221631958, -2399.641543544925, -8448.433844014333, -3727.1924132979643, -7544.613725781245, -10895.96618311965, -3752.643735042076, -7064.373065727383, -9943.978340791084, -5734.322921899503, -7313.860754888578, -2655.987914116346, -7505.471590759998, -5591.913799936479, -8923.57242005336, -6432.867769714552, -6514.234463805319, -2709.6762478813584, -7682.617918126897, -6677.789802355367, -6476.061297899157, -7140.8425107081985, -220.4390702559546, -811.796240728971, -9234.513590159586, -6379.151871499414, -6206.434516226129, -2710.7961482031646, -5976.190325832156, -8507.580023546367, -4691.70813587806, -5637.456133973689, -8029.323255751483, -5999.9915549539355, -8052.50848936326, -4100.173129345915, -5985.444088299477, -3757.325288736744, -2589.7609605439893, -5198.98241482318, -4470.414826223535, -3227.119996314151, -3613.70780415719, -3072.4381912642148, -3436.124168079939, -6111.234540510183, -7198.3947787974175, -8693.114843119616, -8532.12610835212, -6546.242226261487, -9169.0473109453, -1523.7323869799989, -1971.907963267949, -7968.64650799496, -6606.814704197682, -5376.2122914362, -4825.048134408598, -2279.4878674565016, -6127.424133179422, -3942.004653188797, -1283.8216658675335, -1299.032033471511, -3080.554359967658, -8015.509185303991, -5003.753464795367, -3440.54019186584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43358897859080087, "mean_inference_ms": 1.05056976151318, "mean_action_processing_ms": 0.18095798653752973, "mean_env_wait_ms": 0.05546462916858843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034455060958862305, "StateBufferConnector_ms": 0.0025330781936645508, "ViewRequirementAgentConnector_ms": 0.0692746639251709}, "num_episodes": 19, "episode_return_max": -42.96525505306541, "episode_return_min": -11839.68424793641, "episode_return_mean": -6681.477890728269}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.6424180621176, "num_env_steps_trained_throughput_per_sec": 533.6424180621176, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 7890.622, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7890.586, "sample_time_ms": 806.678, "learn_time_ms": 7070.028, "learn_throughput": 565.769, "synch_weights_time_ms": 13.314}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 34, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-35", "timestamp": 1723231835, "time_this_iter_s": 7.50097393989563, "time_total_s": 264.6603422164917, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ece940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.6603422164917, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 22.88181818181818, "ram_util_percent": 80.32727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6764903454730908, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.962672494848569, "policy_loss": -0.009115794569758388, "vf_loss": 9.966231117645899, "vf_explained_var": -0.0007211816807587942, "kl": 0.008232841931264072, "entropy": 1.275404880568385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8016042932158425, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987176411744779, "policy_loss": 0.0006336145640089714, "vf_loss": 9.983643541386519, "vf_explained_var": -3.413242637795746e-05, "kl": 0.014496261050934513, "entropy": 1.546705340960669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": -23.049480775808032, "episode_reward_min": -11839.68424793641, "episode_reward_mean": -6524.764264106602, "episode_len_mean": 181.18, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18118, "policy_reward_min": {"agent_policy": 0.5363717960086838, "adversary_policy": -11837.43196864523}, "policy_reward_max": {"agent_policy": 9663.960212684507, "adversary_policy": -0.5363717960086838}, "policy_reward_mean": {"agent_policy": 3963.7231577509287, "adversary_policy": -5244.243710928764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8921.85268602379, -8141.6507107672805, -5135.203624510606, -2371.41990514384, -7685.0227485808255, -3803.317552082887, -8945.192254401602, -200.2132122144785, -9072.134230961989, -4603.898857720268, -7889.861510487078, -5270.594745466986, -8057.223539980359, -5219.384396760338, -5244.344590296011, -10162.095424766747, -9939.804893772052, -9661.23771355955, -4651.825899316343, -970.1533226692773, -10542.718339245603, -4658.6088133050935, -7015.200104768302, -5284.147940345843, -9809.457909306446, -6050.005929725929, -4305.382236096936, -8552.146559997607, -6415.441031795696, -7684.80702255844, -517.1131425914124, -793.2595989222051, -7030.110569428969, -6165.241050686625, -11839.68424793641, -7611.123276249147, -10456.983511382952, -9366.196846557827, -5474.360660642433, -7797.00460664524, -8336.250863618581, -8279.948551313311, -8341.504700059186, -5727.817221631958, -8543.176850982172, -10895.966183119648, -7064.373065727383, -9956.558992366095, -7313.860754888577, -7844.156386172167, -8923.572420053362, -6514.234463805319, -7730.353081118444, -7158.473953447795, -811.796240728971, -9234.513590159582, -6206.434516226129, -8609.545153947929, -5868.02127777497, -8273.333735920538, -8052.508489363261, -5985.613675450199, -5198.98241482318, -4868.345536718425, -3650.9712835270993, -6111.234540510183, -8693.602073050508, -8537.729155658139, -9185.840854879603, -7968.64650799496, -6960.200577223825, -4825.048134408597, -6127.424133179422, -1586.456981519562, -8281.791059837884, -5100.841235127324, -6317.965549834403, -8255.087495451533, -6071.529341694052, -2751.4581519497574, -8467.780665851882, -6747.216531825305, -6428.423519041302, -10315.558201901746, -6530.402843193976, -4776.9529647892805, -3637.193344765404, -5324.88065124069, -8546.372513831086, -8321.820716113505, -707.649711059031, -471.003587524001, -9445.992374488042, -3351.2433940478595, -8719.79073409448, -5423.156643971882, -23.049480775808032, -1871.2912304531226, -8467.615502215012, -5418.437386541282], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 158, 53, 200, 150, 200, 197, 200, 200, 200, 200, 200, 200, 15, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 200, 200, 92, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 37, 15, 200, 200, 200, 142, 1, 89, 200, 200], "policy_agent_policy_reward": [6359.522265401581, 5637.755522099973, 2030.5102581438282, 1559.4532999663795, 5236.354127742507, 3149.7342972196684, 7260.818555872389, 28.309294522783716, 6720.678573140977, 2439.5067761151927, 5820.634886588373, 2955.4743765148387, 5387.709190579685, 3421.812930115864, 2748.86754307325, 4915.818974648608, 8542.68740834303, 8548.121741457664, 1191.8209575668452, 777.7015323876585, 9663.960212684507, 2547.164041306672, 3966.655673499792, 1561.2382358972293, 8576.2133466037, 4898.585418962745, 3105.159320716712, 6625.484635026507, 1999.9690937651703, 3785.9895344092274, 68.6737537440455, 195.17603924032105, 4594.199487812506, 2760.740958207421, 8913.201827756273, 6660.997410136262, 2182.0009162310644, 2452.6738050101517, 4158.489661836115, 4039.475360731854, 5298.660445688393, 3438.219170285715, 2257.6169848873997, 2399.641543544925, 3632.4494063301245, 7544.613725781245, 3752.643735042076, 5721.742270324492, 2655.987914116346, 5253.229004524314, 6432.867769714552, 2709.6762478813584, 6630.054639363819, 6458.429855159561, 220.4390702559546, 6379.151871499414, 2710.7961482031646, 5874.22519543059, 4461.142992076787, 5755.981074784882, 4100.173129345915, 3757.1557015860226, 2589.7609605439893, 2829.189285819258, 3035.174711894305, 3436.124168079939, 7197.907548866527, 6540.639178955471, 1506.9388430456938, 1971.907963267949, 5022.826418410053, 2279.4878674565016, 3942.004653188797, 996.3967178194825, 2814.2724854337634, 3343.452421533887, 2094.4456612384542, 6446.07263082757, 5103.553558808723, 990.2321683045492, 4904.37542506784, 1879.704686857278, 5952.804702574932, 9597.036087419858, 4180.035173143134, 1257.8536188824733, 1395.257320033917, 1293.0339907166986, 7290.423624980294, 7714.244539330541, 434.8768571626413, 85.2053203728982, 6452.072980159351, 2723.512791613867, 5069.5115707328005, 2537.3515818635406, 0.5363717960086838, 1049.7449754921447, 3364.3362594331543, 2115.771513058209], "policy_adversary_policy_reward": [-8921.852686023789, -6359.522265401581, -8140.77782972854, -5638.628403138713, -5105.738731079468, -2059.9751515749635, -2154.195999777592, -1776.6772053326313, -5249.75478183035, -7671.622094492983, -3572.113615391565, -3380.9382339109893, -8697.340539860166, -7508.67027041382, -200.2132122144785, -28.309294522783716, -6721.178471954414, -9071.634332148553, -4357.645580976581, -2685.7600528588796, -7852.424624332822, -5858.071772742628, -3617.6639907333915, -4608.405131248433, -5387.709190579685, -8057.223539980359, -5173.98451903965, -3467.2128078365513, -5243.398481961357, -2749.813651407904, -10162.095424766747, -4915.818974648608, -9812.127926147654, -8670.364375967427, -8738.854558930114, -9470.504896087094, -1786.7849000243918, -4056.8619568587933, -803.3504378552783, -944.5044172016575, -10482.333025778535, -9724.345526151577, -2675.9329310159324, -4529.839923595833, -6926.655566207796, -4055.2002120602947, -1905.7950025830858, -4939.591173659985, -8778.015571462543, -9607.6556844476, -4956.887562046278, -5991.703786642396, -3999.1013203079033, -3411.4402365057445, -8552.146559997609, -6625.484635026507, -6415.441031795697, -1999.9690937651703, -7684.80702255844, -3785.9895344092274, -68.6737537440455, -517.1131425914124, -793.2595989222051, -195.17603924032105, -6859.408325692205, -4764.901731549274, -3179.365093469114, -5746.616915424934, -11837.43196864523, -8915.454107047452, -7325.234888186363, -6946.885798199047, -2182.0009162310644, -10456.983511382952, -2452.6738050101517, -9366.196846557827, -4158.489661836115, -5474.360660642432, -7797.004606645241, -4039.475360731854, -8336.25086361858, -5298.660445688393, -6978.644385938378, -4739.523335660646, -2257.6169848873997, -8341.504700059186, -5727.817221631958, -2399.641543544925, -8448.433844014333, -3727.1924132979643, -7544.613725781245, -10895.96618311965, -3752.643735042076, -7064.373065727383, -9943.978340791084, -5734.322921899503, -7313.860754888578, -2655.987914116346, -7505.471590759998, -5591.913799936479, -8923.57242005336, -6432.867769714552, -6514.234463805319, -2709.6762478813584, -7682.617918126897, -6677.789802355367, -6476.061297899157, -7140.8425107081985, -220.4390702559546, -811.796240728971, -9234.513590159586, -6379.151871499414, -6206.434516226129, -2710.7961482031646, -5976.190325832156, -8507.580023546367, -4691.70813587806, -5637.456133973689, -8029.323255751483, -5999.9915549539355, -8052.50848936326, -4100.173129345915, -5985.444088299477, -3757.325288736744, -2589.7609605439893, -5198.98241482318, -4470.414826223535, -3227.119996314151, -3613.70780415719, -3072.4381912642148, -3436.124168079939, -6111.234540510183, -7198.3947787974175, -8693.114843119616, -8532.12610835212, -6546.242226261487, -9169.0473109453, -1523.7323869799989, -1971.907963267949, -7968.64650799496, -6606.814704197682, -5376.2122914362, -4825.048134408598, -2279.4878674565016, -6127.424133179422, -3942.004653188797, -1283.8216658675335, -1299.032033471511, -3080.554359967658, -8015.509185303991, -5003.753464795367, -3440.54019186584, -2094.4456612384542, -6317.965549834402, -8255.08749545153, -6446.07263082757, -6061.908404868836, -5113.174495633938, -2751.4581519497574, -990.2321683045492, -8467.78066585188, -4904.37542506784, -1884.7627501502466, -6742.158468532338, -6046.697886892921, -6334.530334723314, -9926.748859777694, -9985.845429543908, -6530.402843193978, -4180.035173143134, -4776.9529647892805, -1257.8536188824733, -1678.5386208262557, -3353.9120439730646, -1296.8860744212875, -5321.028567536101, -8216.356381949268, -7620.439756862109, -7785.607387434968, -8250.457868009082, -434.8768571626413, -707.649711059031, -471.003587524001, -85.2053203728982, -9445.99237448804, -6452.072980159351, -2916.34006958601, -3158.416116075717, -8719.790734094482, -5069.5115707328005, -5423.156643971881, -2537.3515818635406, -0.5363717960086838, -23.049480775808032, -1751.296196381028, -1169.7400095642383, -8467.615502215012, -3364.3362594331543, -5136.830982745306, -2397.3779168541832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.431691515539483, "mean_inference_ms": 1.0454474143136627, "mean_action_processing_ms": 0.1800904116897673, "mean_env_wait_ms": 0.055102668065977196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.0024580955505371094, "ViewRequirementAgentConnector_ms": 0.06708192825317383}, "num_episodes": 24, "episode_return_max": -23.049480775808032, "episode_return_min": -11839.68424793641, "episode_return_mean": -6524.764264106602}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.836061886898, "num_env_steps_trained_throughput_per_sec": 530.836061886898, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 7691.181, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7691.148, "sample_time_ms": 730.1, "learn_time_ms": 6947.576, "learn_throughput": 575.74, "synch_weights_time_ms": 12.999}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 35, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-43", "timestamp": 1723231843, "time_this_iter_s": 7.540099859237671, "time_total_s": 272.20044207572937, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ececa0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.20044207572937, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 22.19090909090909, "ram_util_percent": 80.31818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7232005957979709, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.978104944030443, "policy_loss": -0.0022449703775540304, "vf_loss": 9.974903722604116, "vf_explained_var": -0.0013921922693649928, "kl": 0.008068413885484915, "entropy": 1.2909683836003145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7993685825476571, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988572607595454, "policy_loss": -0.0023493096435679094, "vf_loss": 9.987448002547815, "vf_explained_var": -0.00025025107873179924, "kl": 0.017369552571622152, "entropy": 1.5364816571669604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": -23.049480775808032, "episode_reward_min": -11839.68424793641, "episode_reward_mean": -6476.047736925081, "episode_len_mean": 180.85, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18085, "policy_reward_min": {"agent_policy": 0.47594799173031843, "adversary_policy": -11837.43196864523}, "policy_reward_max": {"agent_policy": 9597.036087419858, "adversary_policy": -0.47594799173031843}, "policy_reward_mean": {"agent_policy": 3908.5567978352155, "adversary_policy": -5192.302267380149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5284.147940345843, -9809.457909306446, -6050.005929725929, -4305.382236096936, -8552.146559997607, -6415.441031795696, -7684.80702255844, -517.1131425914124, -793.2595989222051, -7030.110569428969, -6165.241050686625, -11839.68424793641, -7611.123276249147, -10456.983511382952, -9366.196846557827, -5474.360660642433, -7797.00460664524, -8336.250863618581, -8279.948551313311, -8341.504700059186, -5727.817221631958, -8543.176850982172, -10895.966183119648, -7064.373065727383, -9956.558992366095, -7313.860754888577, -7844.156386172167, -8923.572420053362, -6514.234463805319, -7730.353081118444, -7158.473953447795, -811.796240728971, -9234.513590159582, -6206.434516226129, -8609.545153947929, -5868.02127777497, -8273.333735920538, -8052.508489363261, -5985.613675450199, -5198.98241482318, -4868.345536718425, -3650.9712835270993, -6111.234540510183, -8693.602073050508, -8537.729155658139, -9185.840854879603, -7968.64650799496, -6960.200577223825, -4825.048134408597, -6127.424133179422, -1586.456981519562, -8281.791059837884, -5100.841235127324, -6317.965549834403, -8255.087495451533, -6071.529341694052, -2751.4581519497574, -8467.780665851882, -6747.216531825305, -6428.423519041302, -10315.558201901746, -6530.402843193976, -4776.9529647892805, -3637.193344765404, -5324.88065124069, -8546.372513831086, -8321.820716113505, -707.649711059031, -471.003587524001, -9445.992374488042, -3351.2433940478595, -8719.79073409448, -5423.156643971882, -23.049480775808032, -1871.2912304531226, -8467.615502215012, -5418.437386541282, -7871.26500936531, -8539.82767446131, -8376.65378991224, -5457.296138642974, -7525.733144734104, -7527.954500016994, -37.43535779250541, -9271.004429148728, -5719.5709441462, -7095.869492921978, -2056.511716319538, -6882.42887432006, -7348.461435391742, -8189.872614681015, -7888.226502364181, -7124.801410164832, -5516.074701663328, -3664.8942650950585, -2548.1374531799215, -5556.836050622822, -5350.448275813403, -5330.361220833991, -8411.641357056986], "episode_lengths": [197, 200, 200, 200, 200, 200, 200, 15, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 200, 200, 92, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 37, 15, 200, 200, 200, 142, 1, 89, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 167, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 122, 200, 200], "policy_agent_policy_reward": [1561.2382358972293, 8576.2133466037, 4898.585418962745, 3105.159320716712, 6625.484635026507, 1999.9690937651703, 3785.9895344092274, 68.6737537440455, 195.17603924032105, 4594.199487812506, 2760.740958207421, 8913.201827756273, 6660.997410136262, 2182.0009162310644, 2452.6738050101517, 4158.489661836115, 4039.475360731854, 5298.660445688393, 3438.219170285715, 2257.6169848873997, 2399.641543544925, 3632.4494063301245, 7544.613725781245, 3752.643735042076, 5721.742270324492, 2655.987914116346, 5253.229004524314, 6432.867769714552, 2709.6762478813584, 6630.054639363819, 6458.429855159561, 220.4390702559546, 6379.151871499414, 2710.7961482031646, 5874.22519543059, 4461.142992076787, 5755.981074784882, 4100.173129345915, 3757.1557015860226, 2589.7609605439893, 2829.189285819258, 3035.174711894305, 3436.124168079939, 7197.907548866527, 6540.639178955471, 1506.9388430456938, 1971.907963267949, 5022.826418410053, 2279.4878674565016, 3942.004653188797, 996.3967178194825, 2814.2724854337634, 3343.452421533887, 2094.4456612384542, 6446.07263082757, 5103.553558808723, 990.2321683045492, 4904.37542506784, 1879.704686857278, 5952.804702574932, 9597.036087419858, 4180.035173143134, 1257.8536188824733, 1395.257320033917, 1293.0339907166986, 7290.423624980294, 7714.244539330541, 434.8768571626413, 85.2053203728982, 6452.072980159351, 2723.512791613867, 5069.5115707328005, 2537.3515818635406, 0.5363717960086838, 1049.7449754921447, 3364.3362594331543, 2115.771513058209, 6488.279738492422, 6901.541409288814, 2830.591264526334, 4818.039047854023, 6355.510407971268, 6218.6092504966455, 0.47594799173031843, 7865.256379888116, 2161.545481672634, 4391.400201912721, 545.0497031463918, 4649.298092531245, 3195.917670561498, 6692.685869351569, 4516.257792598887, 3325.1496650136205, 3688.377417408107, 2588.9732039267838, 1906.078680419741, 3951.591475221463, 2279.9597069243523, 3238.928619186206, 6784.919421036165], "policy_adversary_policy_reward": [-1905.7950025830858, -4939.591173659985, -8778.015571462543, -9607.6556844476, -4956.887562046278, -5991.703786642396, -3999.1013203079033, -3411.4402365057445, -8552.146559997609, -6625.484635026507, -6415.441031795697, -1999.9690937651703, -7684.80702255844, -3785.9895344092274, -68.6737537440455, -517.1131425914124, -793.2595989222051, -195.17603924032105, -6859.408325692205, -4764.901731549274, -3179.365093469114, -5746.616915424934, -11837.43196864523, -8915.454107047452, -7325.234888186363, -6946.885798199047, -2182.0009162310644, -10456.983511382952, -2452.6738050101517, -9366.196846557827, -4158.489661836115, -5474.360660642432, -7797.004606645241, -4039.475360731854, -8336.25086361858, -5298.660445688393, -6978.644385938378, -4739.523335660646, -2257.6169848873997, -8341.504700059186, -5727.817221631958, -2399.641543544925, -8448.433844014333, -3727.1924132979643, -7544.613725781245, -10895.96618311965, -3752.643735042076, -7064.373065727383, -9943.978340791084, -5734.322921899503, -7313.860754888578, -2655.987914116346, -7505.471590759998, -5591.913799936479, -8923.57242005336, -6432.867769714552, -6514.234463805319, -2709.6762478813584, -7682.617918126897, -6677.789802355367, -6476.061297899157, -7140.8425107081985, -220.4390702559546, -811.796240728971, -9234.513590159586, -6379.151871499414, -6206.434516226129, -2710.7961482031646, -5976.190325832156, -8507.580023546367, -4691.70813587806, -5637.456133973689, -8029.323255751483, -5999.9915549539355, -8052.50848936326, -4100.173129345915, -5985.444088299477, -3757.325288736744, -2589.7609605439893, -5198.98241482318, -4470.414826223535, -3227.119996314151, -3613.70780415719, -3072.4381912642148, -3436.124168079939, -6111.234540510183, -7198.3947787974175, -8693.114843119616, -8532.12610835212, -6546.242226261487, -9169.0473109453, -1523.7323869799989, -1971.907963267949, -7968.64650799496, -6606.814704197682, -5376.2122914362, -4825.048134408598, -2279.4878674565016, -6127.424133179422, -3942.004653188797, -1283.8216658675335, -1299.032033471511, -3080.554359967658, -8015.509185303991, -5003.753464795367, -3440.54019186584, -2094.4456612384542, -6317.965549834402, -8255.08749545153, -6446.07263082757, -6061.908404868836, -5113.174495633938, -2751.4581519497574, -990.2321683045492, -8467.78066585188, -4904.37542506784, -1884.7627501502466, -6742.158468532338, -6046.697886892921, -6334.530334723314, -9926.748859777694, -9985.845429543908, -6530.402843193978, -4180.035173143134, -4776.9529647892805, -1257.8536188824733, -1678.5386208262557, -3353.9120439730646, -1296.8860744212875, -5321.028567536101, -8216.356381949268, -7620.439756862109, -7785.607387434968, -8250.457868009082, -434.8768571626413, -707.649711059031, -471.003587524001, -85.2053203728982, -9445.99237448804, -6452.072980159351, -2916.34006958601, -3158.416116075717, -8719.790734094482, -5069.5115707328005, -5423.156643971881, -2537.3515818635406, -0.5363717960086838, -23.049480775808032, -1751.296196381028, -1169.7400095642383, -8467.615502215012, -3364.3362594331543, -5136.830982745306, -2397.3779168541832, -7832.18884032168, -6527.355907536052, -6901.541409288814, -8539.82767446131, -2830.591264526334, -8376.65378991224, -5043.395721198316, -5231.939465298681, -7509.934515730873, -6371.3090369745, -6234.771960158095, -7511.791790355544, -37.43535779250541, -0.47594799173031843, -9107.156873225984, -8029.103935810862, -2161.545481672634, -5719.5709441462, -4937.472149738554, -6549.797545096144, -545.0497031463918, -2056.511716319538, -4809.530818341159, -6722.196148510145, -3195.917670561498, -7348.461435391742, -6694.370867364641, -8188.187616667943, -4792.687279643843, -7611.797015319224, -3325.1496650136205, -7124.801410164832, -5498.673931622244, -3705.7781874491884, -2669.778568334744, -3584.0889006871, -2115.785296946615, -2338.430836653047, -3952.0470371053907, -5556.380488738894, -5350.448275813403, -2279.9597069243523, -5135.814053452147, -3433.4757865680485, -6946.98211280679, -8249.578665286359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4299228923946222, "mean_inference_ms": 1.0414088807640838, "mean_action_processing_ms": 0.1793266628225328, "mean_env_wait_ms": 0.05484537999646789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00361788272857666, "StateBufferConnector_ms": 0.0024541616439819336, "ViewRequirementAgentConnector_ms": 0.06610500812530518}, "num_episodes": 23, "episode_return_max": -23.049480775808032, "episode_return_min": -11839.68424793641, "episode_return_mean": -6476.047736925081}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.2326321530178, "num_env_steps_trained_throughput_per_sec": 536.2326321530178, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 7683.794, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7683.761, "sample_time_ms": 725.892, "learn_time_ms": 6944.513, "learn_throughput": 575.994, "synch_weights_time_ms": 12.883}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 36, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-50", "timestamp": 1723231850, "time_this_iter_s": 7.464497804641724, "time_total_s": 279.6649398803711, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327eced30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.6649398803711, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.200000000000003, "ram_util_percent": 79.99090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8326456335683664, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.95011449555556, "policy_loss": -0.0017547040959470905, "vf_loss": 9.948495317498843, "vf_explained_var": -0.0008133162433902422, "kl": 0.004998289422413412, "entropy": 1.2918796309580405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8155670294843653, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.975689014555917, "policy_loss": -0.002407998625415737, "vf_loss": 9.97399877972073, "vf_explained_var": 6.180780905264395e-06, "kl": 0.02049121716251922, "entropy": 1.5290887065034695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "env_runners": {"episode_reward_max": -23.049480775808032, "episode_reward_min": -10315.558201901746, "episode_reward_mean": -6003.669806799796, "episode_len_mean": 174.04, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17404, "policy_reward_min": {"agent_policy": 0.47594799173031843, "adversary_policy": -9992.168502178312}, "policy_reward_max": {"agent_policy": 9597.036087419858, "adversary_policy": -0.47594799173031843}, "policy_reward_mean": {"agent_policy": 3654.464509102565, "adversary_policy": -4829.06715795118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9956.558992366095, -7313.860754888577, -7844.156386172167, -8923.572420053362, -6514.234463805319, -7730.353081118444, -7158.473953447795, -811.796240728971, -9234.513590159582, -6206.434516226129, -8609.545153947929, -5868.02127777497, -8273.333735920538, -8052.508489363261, -5985.613675450199, -5198.98241482318, -4868.345536718425, -3650.9712835270993, -6111.234540510183, -8693.602073050508, -8537.729155658139, -9185.840854879603, -7968.64650799496, -6960.200577223825, -4825.048134408597, -6127.424133179422, -1586.456981519562, -8281.791059837884, -5100.841235127324, -6317.965549834403, -8255.087495451533, -6071.529341694052, -2751.4581519497574, -8467.780665851882, -6747.216531825305, -6428.423519041302, -10315.558201901746, -6530.402843193976, -4776.9529647892805, -3637.193344765404, -5324.88065124069, -8546.372513831086, -8321.820716113505, -707.649711059031, -471.003587524001, -9445.992374488042, -3351.2433940478595, -8719.79073409448, -5423.156643971882, -23.049480775808032, -1871.2912304531226, -8467.615502215012, -5418.437386541282, -7871.26500936531, -8539.82767446131, -8376.65378991224, -5457.296138642974, -7525.733144734104, -7527.954500016994, -37.43535779250541, -9271.004429148728, -5719.5709441462, -7095.869492921978, -2056.511716319538, -6882.42887432006, -7348.461435391742, -8189.872614681015, -7888.226502364181, -7124.801410164832, -5516.074701663328, -3664.8942650950585, -2548.1374531799215, -5556.836050622822, -5350.448275813403, -5330.361220833991, -8411.641357056986, -5088.236382383022, -7243.69454056087, -5798.606933971612, -5106.724057777516, -4924.7944487498635, -9169.658420280317, -7438.927979387258, -8160.692795400851, -9992.168502178312, -7331.265676621257, -492.38766301715197, -185.82372689792487, -5872.860515257461, -1085.1262223778551, -1222.4823610029753, -4190.626930780379, -1262.5899805727092, -249.6289147209442, -8522.799151933807, -4635.833259426991, -8275.633812476395, -6572.939414322227, -9260.526244543282, -3019.682630152757], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 200, 200, 92, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 37, 15, 200, 200, 200, 142, 1, 89, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 167, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 33, 12, 200, 76, 56, 170, 76, 17, 200, 200, 200, 200, 200, 99], "policy_agent_policy_reward": [5721.742270324492, 2655.987914116346, 5253.229004524314, 6432.867769714552, 2709.6762478813584, 6630.054639363819, 6458.429855159561, 220.4390702559546, 6379.151871499414, 2710.7961482031646, 5874.22519543059, 4461.142992076787, 5755.981074784882, 4100.173129345915, 3757.1557015860226, 2589.7609605439893, 2829.189285819258, 3035.174711894305, 3436.124168079939, 7197.907548866527, 6540.639178955471, 1506.9388430456938, 1971.907963267949, 5022.826418410053, 2279.4878674565016, 3942.004653188797, 996.3967178194825, 2814.2724854337634, 3343.452421533887, 2094.4456612384542, 6446.07263082757, 5103.553558808723, 990.2321683045492, 4904.37542506784, 1879.704686857278, 5952.804702574932, 9597.036087419858, 4180.035173143134, 1257.8536188824733, 1395.257320033917, 1293.0339907166986, 7290.423624980294, 7714.244539330541, 434.8768571626413, 85.2053203728982, 6452.072980159351, 2723.512791613867, 5069.5115707328005, 2537.3515818635406, 0.5363717960086838, 1049.7449754921447, 3364.3362594331543, 2115.771513058209, 6488.279738492422, 6901.541409288814, 2830.591264526334, 4818.039047854023, 6355.510407971268, 6218.6092504966455, 0.47594799173031843, 7865.256379888116, 2161.545481672634, 4391.400201912721, 545.0497031463918, 4649.298092531245, 3195.917670561498, 6692.685869351569, 4516.257792598887, 3325.1496650136205, 3688.377417408107, 2588.9732039267838, 1906.078680419741, 3951.591475221463, 2279.9597069243523, 3238.928619186206, 6784.919421036165, 1937.1419408962424, 6635.297977605765, 2573.4795016077014, 3084.9742201997897, 2696.6533466156434, 7026.689871496489, 5071.743634740777, 3767.869017187513, 4775.537811669045, 2513.573296820893, 225.6361635798504, 36.17452370288973, 2757.7014499423653, 380.18853841290513, 988.6229386119452, 1838.9460735145449, 613.8870119181014, 98.01233025461654, 5131.755379109612, 3294.9254614502106, 2863.2292424403227, 5063.730807953153, 4899.110550979962, 1218.0038536717386], "policy_adversary_policy_reward": [-9943.978340791084, -5734.322921899503, -7313.860754888578, -2655.987914116346, -7505.471590759998, -5591.913799936479, -8923.57242005336, -6432.867769714552, -6514.234463805319, -2709.6762478813584, -7682.617918126897, -6677.789802355367, -6476.061297899157, -7140.8425107081985, -220.4390702559546, -811.796240728971, -9234.513590159586, -6379.151871499414, -6206.434516226129, -2710.7961482031646, -5976.190325832156, -8507.580023546367, -4691.70813587806, -5637.456133973689, -8029.323255751483, -5999.9915549539355, -8052.50848936326, -4100.173129345915, -5985.444088299477, -3757.325288736744, -2589.7609605439893, -5198.98241482318, -4470.414826223535, -3227.119996314151, -3613.70780415719, -3072.4381912642148, -3436.124168079939, -6111.234540510183, -7198.3947787974175, -8693.114843119616, -8532.12610835212, -6546.242226261487, -9169.0473109453, -1523.7323869799989, -1971.907963267949, -7968.64650799496, -6606.814704197682, -5376.2122914362, -4825.048134408598, -2279.4878674565016, -6127.424133179422, -3942.004653188797, -1283.8216658675335, -1299.032033471511, -3080.554359967658, -8015.509185303991, -5003.753464795367, -3440.54019186584, -2094.4456612384542, -6317.965549834402, -8255.08749545153, -6446.07263082757, -6061.908404868836, -5113.174495633938, -2751.4581519497574, -990.2321683045492, -8467.78066585188, -4904.37542506784, -1884.7627501502466, -6742.158468532338, -6046.697886892921, -6334.530334723314, -9926.748859777694, -9985.845429543908, -6530.402843193978, -4180.035173143134, -4776.9529647892805, -1257.8536188824733, -1678.5386208262557, -3353.9120439730646, -1296.8860744212875, -5321.028567536101, -8216.356381949268, -7620.439756862109, -7785.607387434968, -8250.457868009082, -434.8768571626413, -707.649711059031, -471.003587524001, -85.2053203728982, -9445.99237448804, -6452.072980159351, -2916.34006958601, -3158.416116075717, -8719.790734094482, -5069.5115707328005, -5423.156643971881, -2537.3515818635406, -0.5363717960086838, -23.049480775808032, -1751.296196381028, -1169.7400095642383, -8467.615502215012, -3364.3362594331543, -5136.830982745306, -2397.3779168541832, -7832.18884032168, -6527.355907536052, -6901.541409288814, -8539.82767446131, -2830.591264526334, -8376.65378991224, -5043.395721198316, -5231.939465298681, -7509.934515730873, -6371.3090369745, -6234.771960158095, -7511.791790355544, -37.43535779250541, -0.47594799173031843, -9107.156873225984, -8029.103935810862, -2161.545481672634, -5719.5709441462, -4937.472149738554, -6549.797545096144, -545.0497031463918, -2056.511716319538, -4809.530818341159, -6722.196148510145, -3195.917670561498, -7348.461435391742, -6694.370867364641, -8188.187616667943, -4792.687279643843, -7611.797015319224, -3325.1496650136205, -7124.801410164832, -5498.673931622244, -3705.7781874491884, -2669.778568334744, -3584.0889006871, -2115.785296946615, -2338.430836653047, -3952.0470371053907, -5556.380488738894, -5350.448275813403, -2279.9597069243523, -5135.814053452147, -3433.4757865680485, -6946.98211280679, -8249.578665286359, -2788.708912403246, -4236.669410876019, -7139.428656303423, -6739.563861863209, -2588.420591139205, -5783.665844440109, -5074.406763150432, -3117.291514826872, -3432.3532473456307, -4189.094548019882, -7199.356043223219, -8996.992248553579, -7438.92797938726, -5071.743634740777, -3767.869017187513, -8160.692795400851, -9992.168502178312, -4775.537811669045, -2513.573296820893, -7331.265676621257, -471.7972213335088, -246.22660526349352, -36.17452370288973, -185.82372689792487, -2758.488624467936, -5872.07334073189, -611.8114616258586, -853.5032991649015, -1012.0693680709471, -1199.0359315439732, -4190.62693078038, -1838.9460735145449, -613.8870119181014, -1262.5899805727092, -249.62891472094418, -98.01233025461654, -7867.0169999384225, -5787.537531104985, -4469.8710935856925, -3460.8876272915113, -2880.0604883163323, -8258.802566600387, -6158.782414845462, -5477.8878074299155, -9260.526244543284, -4899.110550979962, -2919.8650432323816, -1317.821440592114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42810711714374444, "mean_inference_ms": 1.0382577683954337, "mean_action_processing_ms": 0.17885416177884006, "mean_env_wait_ms": 0.054580546114032714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004733681678771973, "StateBufferConnector_ms": 0.0024579763412475586, "ViewRequirementAgentConnector_ms": 0.06696474552154541}, "num_episodes": 24, "episode_return_max": -23.049480775808032, "episode_return_min": -10315.558201901746, "episode_return_mean": -6003.669806799796}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 522.3686705880708, "num_env_steps_trained_throughput_per_sec": 522.3686705880708, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 7701.25, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7701.218, "sample_time_ms": 732.105, "learn_time_ms": 6955.664, "learn_throughput": 575.071, "synch_weights_time_ms": 12.979}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "training_iteration": 37, "trial_id": "3439d_00000", "date": "2024-08-09_15-30-58", "timestamp": 1723231858, "time_this_iter_s": 7.662184953689575, "time_total_s": 287.32712483406067, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ece940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.32712483406067, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 23.38181818181818, "ram_util_percent": 79.67272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7962747238886853, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983982877930005, "policy_loss": -0.004262889636932717, "vf_loss": 9.986040101448696, "vf_explained_var": -0.0006799735128879547, "kl": 0.006535464162152493, "entropy": 1.3041784490148227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7871970360871976, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99483758230058, "policy_loss": -0.0017457034786246598, "vf_loss": 9.99309276600994, "vf_explained_var": -0.00010723534715238702, "kl": 0.01163501305229686, "entropy": 1.497734357314135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": -23.049480775808032, "episode_reward_min": -11739.671662688886, "episode_reward_mean": -5977.448129425217, "episode_len_mean": 174.18, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17418, "policy_reward_min": {"agent_policy": 0.47594799173031843, "adversary_policy": -11563.797401822118}, "policy_reward_max": {"agent_policy": 9597.036087419858, "adversary_policy": -0.47594799173031843}, "policy_reward_mean": {"agent_policy": 3683.354777156632, "adversary_policy": -4830.401453290924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4825.048134408597, -6127.424133179422, -1586.456981519562, -8281.791059837884, -5100.841235127324, -6317.965549834403, -8255.087495451533, -6071.529341694052, -2751.4581519497574, -8467.780665851882, -6747.216531825305, -6428.423519041302, -10315.558201901746, -6530.402843193976, -4776.9529647892805, -3637.193344765404, -5324.88065124069, -8546.372513831086, -8321.820716113505, -707.649711059031, -471.003587524001, -9445.992374488042, -3351.2433940478595, -8719.79073409448, -5423.156643971882, -23.049480775808032, -1871.2912304531226, -8467.615502215012, -5418.437386541282, -7871.26500936531, -8539.82767446131, -8376.65378991224, -5457.296138642974, -7525.733144734104, -7527.954500016994, -37.43535779250541, -9271.004429148728, -5719.5709441462, -7095.869492921978, -2056.511716319538, -6882.42887432006, -7348.461435391742, -8189.872614681015, -7888.226502364181, -7124.801410164832, -5516.074701663328, -3664.8942650950585, -2548.1374531799215, -5556.836050622822, -5350.448275813403, -5330.361220833991, -8411.641357056986, -5088.236382383022, -7243.69454056087, -5798.606933971612, -5106.724057777516, -4924.7944487498635, -9169.658420280317, -7438.927979387258, -8160.692795400851, -9992.168502178312, -7331.265676621257, -492.38766301715197, -185.82372689792487, -5872.860515257461, -1085.1262223778551, -1222.4823610029753, -4190.626930780379, -1262.5899805727092, -249.6289147209442, -8522.799151933807, -4635.833259426991, -8275.633812476395, -6572.939414322227, -9260.526244543282, -3019.682630152757, -8148.450039771439, -8686.45092886706, -8442.362226159437, -3224.5023697728698, -5137.571263779029, -6218.93894401526, -3614.4219599645826, -4978.145310681596, -5461.7490317492975, -10893.7239037913, -4552.698781704414, -8446.559220026416, -7430.379251738233, -8316.38844895956, -9541.62206632477, -11739.671662688886, -6217.662919409841, -5291.5636772729285, -6658.033610229366, -9741.070950122195, -7724.395489311741, -6069.272519445802, -5212.159436632241, -5288.56792593325], "episode_lengths": [200, 200, 166, 200, 200, 200, 200, 200, 92, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 37, 15, 200, 200, 200, 142, 1, 89, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 167, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 33, 12, 200, 76, 56, 170, 76, 17, 200, 200, 200, 200, 200, 99, 200, 200, 200, 83, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2279.4878674565016, 3942.004653188797, 996.3967178194825, 2814.2724854337634, 3343.452421533887, 2094.4456612384542, 6446.07263082757, 5103.553558808723, 990.2321683045492, 4904.37542506784, 1879.704686857278, 5952.804702574932, 9597.036087419858, 4180.035173143134, 1257.8536188824733, 1395.257320033917, 1293.0339907166986, 7290.423624980294, 7714.244539330541, 434.8768571626413, 85.2053203728982, 6452.072980159351, 2723.512791613867, 5069.5115707328005, 2537.3515818635406, 0.5363717960086838, 1049.7449754921447, 3364.3362594331543, 2115.771513058209, 6488.279738492422, 6901.541409288814, 2830.591264526334, 4818.039047854023, 6355.510407971268, 6218.6092504966455, 0.47594799173031843, 7865.256379888116, 2161.545481672634, 4391.400201912721, 545.0497031463918, 4649.298092531245, 3195.917670561498, 6692.685869351569, 4516.257792598887, 3325.1496650136205, 3688.377417408107, 2588.9732039267838, 1906.078680419741, 3951.591475221463, 2279.9597069243523, 3238.928619186206, 6784.919421036165, 1937.1419408962424, 6635.297977605765, 2573.4795016077014, 3084.9742201997897, 2696.6533466156434, 7026.689871496489, 5071.743634740777, 3767.869017187513, 4775.537811669045, 2513.573296820893, 225.6361635798504, 36.17452370288973, 2757.7014499423653, 380.18853841290513, 988.6229386119452, 1838.9460735145449, 613.8870119181014, 98.01233025461654, 5131.755379109612, 3294.9254614502106, 2863.2292424403227, 5063.730807953153, 4899.110550979962, 1218.0038536717386, 4291.780328658336, 7805.874375898835, 3063.624882164119, 1129.9689590444384, 4240.33082117102, 4992.741703841248, 2011.7892771852623, 2733.4245428338168, 2282.297654472248, 8855.254871463672, 1537.5239873245641, 6315.901780312307, 5333.770862604313, 5170.70283409145, 6353.769769115778, 9208.69840161002, 3047.077394659277, 2915.237961973998, 1898.3819556008223, 4588.031721971958, 6650.795467017584, 3929.424446573171, 4122.454218090758, 3661.6905508781333], "policy_adversary_policy_reward": [-4825.048134408598, -2279.4878674565016, -6127.424133179422, -3942.004653188797, -1283.8216658675335, -1299.032033471511, -3080.554359967658, -8015.509185303991, -5003.753464795367, -3440.54019186584, -2094.4456612384542, -6317.965549834402, -8255.08749545153, -6446.07263082757, -6061.908404868836, -5113.174495633938, -2751.4581519497574, -990.2321683045492, -8467.78066585188, -4904.37542506784, -1884.7627501502466, -6742.158468532338, -6046.697886892921, -6334.530334723314, -9926.748859777694, -9985.845429543908, -6530.402843193978, -4180.035173143134, -4776.9529647892805, -1257.8536188824733, -1678.5386208262557, -3353.9120439730646, -1296.8860744212875, -5321.028567536101, -8216.356381949268, -7620.439756862109, -7785.607387434968, -8250.457868009082, -434.8768571626413, -707.649711059031, -471.003587524001, -85.2053203728982, -9445.99237448804, -6452.072980159351, -2916.34006958601, -3158.416116075717, -8719.790734094482, -5069.5115707328005, -5423.156643971881, -2537.3515818635406, -0.5363717960086838, -23.049480775808032, -1751.296196381028, -1169.7400095642383, -8467.615502215012, -3364.3362594331543, -5136.830982745306, -2397.3779168541832, -7832.18884032168, -6527.355907536052, -6901.541409288814, -8539.82767446131, -2830.591264526334, -8376.65378991224, -5043.395721198316, -5231.939465298681, -7509.934515730873, -6371.3090369745, -6234.771960158095, -7511.791790355544, -37.43535779250541, -0.47594799173031843, -9107.156873225984, -8029.103935810862, -2161.545481672634, -5719.5709441462, -4937.472149738554, -6549.797545096144, -545.0497031463918, -2056.511716319538, -4809.530818341159, -6722.196148510145, -3195.917670561498, -7348.461435391742, -6694.370867364641, -8188.187616667943, -4792.687279643843, -7611.797015319224, -3325.1496650136205, -7124.801410164832, -5498.673931622244, -3705.7781874491884, -2669.778568334744, -3584.0889006871, -2115.785296946615, -2338.430836653047, -3952.0470371053907, -5556.380488738894, -5350.448275813403, -2279.9597069243523, -5135.814053452147, -3433.4757865680485, -6946.98211280679, -8249.578665286359, -2788.708912403246, -4236.669410876019, -7139.428656303423, -6739.563861863209, -2588.420591139205, -5783.665844440109, -5074.406763150432, -3117.291514826872, -3432.3532473456307, -4189.094548019882, -7199.356043223219, -8996.992248553579, -7438.92797938726, -5071.743634740777, -3767.869017187513, -8160.692795400851, -9992.168502178312, -4775.537811669045, -2513.573296820893, -7331.265676621257, -471.7972213335088, -246.22660526349352, -36.17452370288973, -185.82372689792487, -2758.488624467936, -5872.07334073189, -611.8114616258586, -853.5032991649015, -1012.0693680709471, -1199.0359315439732, -4190.62693078038, -1838.9460735145449, -613.8870119181014, -1262.5899805727092, -249.62891472094418, -98.01233025461654, -7867.0169999384225, -5787.537531104985, -4469.8710935856925, -3460.8876272915113, -2880.0604883163323, -8258.802566600387, -6158.782414845462, -5477.8878074299155, -9260.526244543284, -4899.110550979962, -2919.8650432323816, -1317.821440592114, -5560.340389223985, -6879.889979205778, -7815.330305943589, -8676.994998822305, -3063.624882164119, -8442.362226159437, -1129.9689590444384, -3224.50236977287, -4403.14104039242, -4974.761044557623, -5384.304699486929, -5827.375948369578, -3186.3107781421463, -2439.9004590076966, -3188.3358898378287, -4523.233963677581, -2333.43315801701, -5410.613528204534, -10893.7239037913, -8855.254871463672, -3429.8296656621383, -2660.3931033668428, -6315.901780312307, -8446.559220026416, -7410.338546081792, -5353.811568260754, -5192.654880914445, -8294.436402136567, -9541.62206632477, -6353.769769115778, -11563.797401822118, -9384.572662476787, -3069.7995617781617, -6194.940752290955, -4947.266254068076, -3259.5353851788486, -6658.033610229366, -1898.3819556008223, -4588.031721971958, -9741.070950122195, -7675.067110275952, -6700.123846053373, -5893.409477742113, -4105.287488276859, -4259.340030182338, -5075.27362454066, -3661.6905508781333, -5288.56792593325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4265010720259679, "mean_inference_ms": 1.0338083665709459, "mean_action_processing_ms": 0.17816198034242578, "mean_env_wait_ms": 0.054439441746021625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004928469657897949, "StateBufferConnector_ms": 0.0024480819702148438, "ViewRequirementAgentConnector_ms": 0.06685888767242432}, "num_episodes": 24, "episode_return_max": -23.049480775808032, "episode_return_min": -11739.671662688886, "episode_return_mean": -5977.448129425217}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 526.4646516502276, "num_env_steps_trained_throughput_per_sec": 526.4646516502276, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 7682.899, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7682.865, "sample_time_ms": 728.65, "learn_time_ms": 6940.369, "learn_throughput": 576.338, "synch_weights_time_ms": 13.37}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 38, "trial_id": "3439d_00000", "date": "2024-08-09_15-31-06", "timestamp": 1723231866, "time_this_iter_s": 7.6034440994262695, "time_total_s": 294.93056893348694, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327eceee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 294.93056893348694, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 26.181818181818183, "ram_util_percent": 79.38181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8477308111420522, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988024312257767, "policy_loss": -0.0016307291104264248, "vf_loss": 9.986924821138382, "vf_explained_var": -0.00030512753874063493, "kl": 0.008089585998095571, "entropy": 1.3251294317344824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7603622224753496, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992710200819388, "policy_loss": -0.0044435409153934825, "vf_loss": 9.993559857020303, "vf_explained_var": -0.00025006520054327746, "kl": 0.011979568818160308, "entropy": 1.4702588764448015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "env_runners": {"episode_reward_max": -23.049480775808032, "episode_reward_min": -11739.671662688886, "episode_reward_mean": -6052.647605430435, "episode_len_mean": 174.41, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 17441, "policy_reward_min": {"agent_policy": 0.47594799173031843, "adversary_policy": -11563.797401822118}, "policy_reward_max": {"agent_policy": 9208.69840161002, "adversary_policy": -0.47594799173031843}, "policy_reward_mean": {"agent_policy": 3705.5650398816197, "adversary_policy": -4879.106322656026}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-707.649711059031, -471.003587524001, -9445.992374488042, -3351.2433940478595, -8719.79073409448, -5423.156643971882, -23.049480775808032, -1871.2912304531226, -8467.615502215012, -5418.437386541282, -7871.26500936531, -8539.82767446131, -8376.65378991224, -5457.296138642974, -7525.733144734104, -7527.954500016994, -37.43535779250541, -9271.004429148728, -5719.5709441462, -7095.869492921978, -2056.511716319538, -6882.42887432006, -7348.461435391742, -8189.872614681015, -7888.226502364181, -7124.801410164832, -5516.074701663328, -3664.8942650950585, -2548.1374531799215, -5556.836050622822, -5350.448275813403, -5330.361220833991, -8411.641357056986, -5088.236382383022, -7243.69454056087, -5798.606933971612, -5106.724057777516, -4924.7944487498635, -9169.658420280317, -7438.927979387258, -8160.692795400851, -9992.168502178312, -7331.265676621257, -492.38766301715197, -185.82372689792487, -5872.860515257461, -1085.1262223778551, -1222.4823610029753, -4190.626930780379, -1262.5899805727092, -249.6289147209442, -8522.799151933807, -4635.833259426991, -8275.633812476395, -6572.939414322227, -9260.526244543282, -3019.682630152757, -8148.450039771439, -8686.45092886706, -8442.362226159437, -3224.5023697728698, -5137.571263779029, -6218.93894401526, -3614.4219599645826, -4978.145310681596, -5461.7490317492975, -10893.7239037913, -4552.698781704414, -8446.559220026416, -7430.379251738233, -8316.38844895956, -9541.62206632477, -11739.671662688886, -6217.662919409841, -5291.5636772729285, -6658.033610229366, -9741.070950122195, -7724.395489311741, -6069.272519445802, -5212.159436632241, -5288.56792593325, -9812.189960877522, -4283.771478704427, -3880.2610583244173, -8458.17045817345, -7679.480674842031, -6863.790922420416, -6287.261943844752, -8141.3541280813415, -5936.618461372344, -8217.871968033562, -7156.532963157916, -8159.370533418414, -5875.545375705419, -5265.133330098262, -1173.385816932006, -5430.37023086349, -6658.99722585217, -8874.026560774551, -7780.018544602028], "episode_lengths": [37, 15, 200, 200, 200, 142, 1, 89, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 167, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 33, 12, 200, 76, 56, 170, 76, 17, 200, 200, 200, 200, 200, 99, 200, 200, 200, 83, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 183, 200, 200, 200], "policy_agent_policy_reward": [434.8768571626413, 85.2053203728982, 6452.072980159351, 2723.512791613867, 5069.5115707328005, 2537.3515818635406, 0.5363717960086838, 1049.7449754921447, 3364.3362594331543, 2115.771513058209, 6488.279738492422, 6901.541409288814, 2830.591264526334, 4818.039047854023, 6355.510407971268, 6218.6092504966455, 0.47594799173031843, 7865.256379888116, 2161.545481672634, 4391.400201912721, 545.0497031463918, 4649.298092531245, 3195.917670561498, 6692.685869351569, 4516.257792598887, 3325.1496650136205, 3688.377417408107, 2588.9732039267838, 1906.078680419741, 3951.591475221463, 2279.9597069243523, 3238.928619186206, 6784.919421036165, 1937.1419408962424, 6635.297977605765, 2573.4795016077014, 3084.9742201997897, 2696.6533466156434, 7026.689871496489, 5071.743634740777, 3767.869017187513, 4775.537811669045, 2513.573296820893, 225.6361635798504, 36.17452370288973, 2757.7014499423653, 380.18853841290513, 988.6229386119452, 1838.9460735145449, 613.8870119181014, 98.01233025461654, 5131.755379109612, 3294.9254614502106, 2863.2292424403227, 5063.730807953153, 4899.110550979962, 1218.0038536717386, 4291.780328658336, 7805.874375898835, 3063.624882164119, 1129.9689590444384, 4240.33082117102, 4992.741703841248, 2011.7892771852623, 2733.4245428338168, 2282.297654472248, 8855.254871463672, 1537.5239873245641, 6315.901780312307, 5333.770862604313, 5170.70283409145, 6353.769769115778, 9208.69840161002, 3047.077394659277, 2915.237961973998, 1898.3819556008223, 4588.031721971958, 6650.795467017584, 3929.424446573171, 4122.454218090758, 3661.6905508781333, 3573.108936382044, 2899.4810220993527, 2958.655542121368, 3376.7817796059203, 5346.289152090986, 4085.4194653241993, 2681.225945467746, 7033.391676204477, 2865.885338011339, 3219.508549305769, 6466.804313214261, 4613.1679887517585, 5288.838692866424, 3485.175229901663, 866.5853473600732, 3321.892990312359, 5864.923976859185, 2366.5543314426254, 5382.023328795828], "policy_adversary_policy_reward": [-434.8768571626413, -707.649711059031, -471.003587524001, -85.2053203728982, -9445.99237448804, -6452.072980159351, -2916.34006958601, -3158.416116075717, -8719.790734094482, -5069.5115707328005, -5423.156643971881, -2537.3515818635406, -0.5363717960086838, -23.049480775808032, -1751.296196381028, -1169.7400095642383, -8467.615502215012, -3364.3362594331543, -5136.830982745306, -2397.3779168541832, -7832.18884032168, -6527.355907536052, -6901.541409288814, -8539.82767446131, -2830.591264526334, -8376.65378991224, -5043.395721198316, -5231.939465298681, -7509.934515730873, -6371.3090369745, -6234.771960158095, -7511.791790355544, -37.43535779250541, -0.47594799173031843, -9107.156873225984, -8029.103935810862, -2161.545481672634, -5719.5709441462, -4937.472149738554, -6549.797545096144, -545.0497031463918, -2056.511716319538, -4809.530818341159, -6722.196148510145, -3195.917670561498, -7348.461435391742, -6694.370867364641, -8188.187616667943, -4792.687279643843, -7611.797015319224, -3325.1496650136205, -7124.801410164832, -5498.673931622244, -3705.7781874491884, -2669.778568334744, -3584.0889006871, -2115.785296946615, -2338.430836653047, -3952.0470371053907, -5556.380488738894, -5350.448275813403, -2279.9597069243523, -5135.814053452147, -3433.4757865680485, -6946.98211280679, -8249.578665286359, -2788.708912403246, -4236.669410876019, -7139.428656303423, -6739.563861863209, -2588.420591139205, -5783.665844440109, -5074.406763150432, -3117.291514826872, -3432.3532473456307, -4189.094548019882, -7199.356043223219, -8996.992248553579, -7438.92797938726, -5071.743634740777, -3767.869017187513, -8160.692795400851, -9992.168502178312, -4775.537811669045, -2513.573296820893, -7331.265676621257, -471.7972213335088, -246.22660526349352, -36.17452370288973, -185.82372689792487, -2758.488624467936, -5872.07334073189, -611.8114616258586, -853.5032991649015, -1012.0693680709471, -1199.0359315439732, -4190.62693078038, -1838.9460735145449, -613.8870119181014, -1262.5899805727092, -249.62891472094418, -98.01233025461654, -7867.0169999384225, -5787.537531104985, -4469.8710935856925, -3460.8876272915113, -2880.0604883163323, -8258.802566600387, -6158.782414845462, -5477.8878074299155, -9260.526244543284, -4899.110550979962, -2919.8650432323816, -1317.821440592114, -5560.340389223985, -6879.889979205778, -7815.330305943589, -8676.994998822305, -3063.624882164119, -8442.362226159437, -1129.9689590444384, -3224.50236977287, -4403.14104039242, -4974.761044557623, -5384.304699486929, -5827.375948369578, -3186.3107781421463, -2439.9004590076966, -3188.3358898378287, -4523.233963677581, -2333.43315801701, -5410.613528204534, -10893.7239037913, -8855.254871463672, -3429.8296656621383, -2660.3931033668428, -6315.901780312307, -8446.559220026416, -7410.338546081792, -5353.811568260754, -5192.654880914445, -8294.436402136567, -9541.62206632477, -6353.769769115778, -11563.797401822118, -9384.572662476787, -3069.7995617781617, -6194.940752290955, -4947.266254068076, -3259.5353851788486, -6658.033610229366, -1898.3819556008223, -4588.031721971958, -9741.070950122195, -7675.067110275952, -6700.123846053373, -5893.409477742113, -4105.287488276859, -4259.340030182338, -5075.27362454066, -3661.6905508781333, -5288.56792593325, -9467.546774129854, -3917.7521231297146, -4283.01708861766, -2900.235412186119, -3838.1621030386646, -3000.7544974071207, -8268.144996125911, -3566.8072416534555, -7679.480674842031, -5346.289152090986, -5411.312909678809, -5537.897478065799, -6220.793255042551, -2747.6946342699475, -7438.063972563885, -7736.681831721937, -3010.5122072643935, -5791.9915921192905, -3219.508549305769, -8217.871968033562, -7070.498496598331, -6552.838779773845, -4613.1679887517585, -8159.370533418414, -5317.391408644605, -5846.9926599272385, -4155.414927317813, -4594.893632682118, -1173.3858169320065, -866.5853473600732, -3341.631835677194, -5410.631385498655, -6176.309227944421, -6347.61197476693, -2366.5543314426254, -8874.026560774551, -5382.023328795828, -7780.018544602028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4254385641882908, "mean_inference_ms": 1.0315976433342378, "mean_action_processing_ms": 0.17780702410618404, "mean_env_wait_ms": 0.05426238425339199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004719138145446777, "StateBufferConnector_ms": 0.002541184425354004, "ViewRequirementAgentConnector_ms": 0.06639444828033447}, "num_episodes": 19, "episode_return_max": -23.049480775808032, "episode_return_min": -11739.671662688886, "episode_return_mean": -6052.647605430435}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.8365295597081, "num_env_steps_trained_throughput_per_sec": 532.8365295597081, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 7567.955, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7567.921, "sample_time_ms": 727.879, "learn_time_ms": 6826.242, "learn_throughput": 585.974, "synch_weights_time_ms": 13.338}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "training_iteration": 39, "trial_id": "3439d_00000", "date": "2024-08-09_15-31-13", "timestamp": 1723231873, "time_this_iter_s": 7.511965274810791, "time_total_s": 302.44253420829773, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.44253420829773, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.163636363636364, "ram_util_percent": 79.82727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7506856322598954, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.965051661928495, "policy_loss": -0.0030665869839140215, "vf_loss": 9.965973398089409, "vf_explained_var": -0.0002957701062162717, "kl": 0.006355145090977506, "entropy": 1.313735188667973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7687136619494706, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.984921122858765, "policy_loss": -0.0015020905944602514, "vf_loss": 9.982914144526083, "vf_explained_var": -0.00019710587446021023, "kl": 0.01169687714181328, "entropy": 1.4345381445354886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": -73.44058206951001, "episode_reward_min": -11739.671662688886, "episode_reward_mean": -6179.8902549755885, "episode_len_mean": 177.77, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17777, "policy_reward_min": {"agent_policy": 2.741190632634181, "adversary_policy": -11563.797401822118}, "policy_reward_max": {"agent_policy": 9576.072668115161, "adversary_policy": -2.741190632634181}, "policy_reward_mean": {"agent_policy": 3837.482217893285, "adversary_policy": -5008.686236434437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7348.461435391742, -8189.872614681015, -7888.226502364181, -7124.801410164832, -5516.074701663328, -3664.8942650950585, -2548.1374531799215, -5556.836050622822, -5350.448275813403, -5330.361220833991, -8411.641357056986, -5088.236382383022, -7243.69454056087, -5798.606933971612, -5106.724057777516, -4924.7944487498635, -9169.658420280317, -7438.927979387258, -8160.692795400851, -9992.168502178312, -7331.265676621257, -492.38766301715197, -185.82372689792487, -5872.860515257461, -1085.1262223778551, -1222.4823610029753, -4190.626930780379, -1262.5899805727092, -249.6289147209442, -8522.799151933807, -4635.833259426991, -8275.633812476395, -6572.939414322227, -9260.526244543282, -3019.682630152757, -8148.450039771439, -8686.45092886706, -8442.362226159437, -3224.5023697728698, -5137.571263779029, -6218.93894401526, -3614.4219599645826, -4978.145310681596, -5461.7490317492975, -10893.7239037913, -4552.698781704414, -8446.559220026416, -7430.379251738233, -8316.38844895956, -9541.62206632477, -11739.671662688886, -6217.662919409841, -5291.5636772729285, -6658.033610229366, -9741.070950122195, -7724.395489311741, -6069.272519445802, -5212.159436632241, -5288.56792593325, -9812.189960877522, -4283.771478704427, -3880.2610583244173, -8458.17045817345, -7679.480674842031, -6863.790922420416, -6287.261943844752, -8141.3541280813415, -5936.618461372344, -8217.871968033562, -7156.532963157916, -8159.370533418414, -5875.545375705419, -5265.133330098262, -1173.385816932006, -5430.37023086349, -6658.99722585217, -8874.026560774551, -7780.018544602028, -9213.077018966918, -10889.755954505603, -3831.944541335954, -10893.915062665186, -9998.486544781883, -6639.0811542476185, -7074.347517171592, -7076.003070824188, -123.03407384593869, -10966.348882821645, -7100.743251762344, -6347.268247814343, -391.7175307964334, -5743.046587916418, -8090.272687883188, -73.44058206951001, -5697.014648907985, -7751.932700388425, -5119.084570428128, -4390.859497943885, -4685.830066712776, -887.8418776778379], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 33, 12, 200, 76, 56, 170, 76, 17, 200, 200, 200, 200, 200, 99, 200, 200, 200, 83, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 183, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 10, 200, 200, 157, 35, 200, 200, 2, 176, 200, 178, 200, 200, 75], "policy_agent_policy_reward": [3195.917670561498, 6692.685869351569, 4516.257792598887, 3325.1496650136205, 3688.377417408107, 2588.9732039267838, 1906.078680419741, 3951.591475221463, 2279.9597069243523, 3238.928619186206, 6784.919421036165, 1937.1419408962424, 6635.297977605765, 2573.4795016077014, 3084.9742201997897, 2696.6533466156434, 7026.689871496489, 5071.743634740777, 3767.869017187513, 4775.537811669045, 2513.573296820893, 225.6361635798504, 36.17452370288973, 2757.7014499423653, 380.18853841290513, 988.6229386119452, 1838.9460735145449, 613.8870119181014, 98.01233025461654, 5131.755379109612, 3294.9254614502106, 2863.2292424403227, 5063.730807953153, 4899.110550979962, 1218.0038536717386, 4291.780328658336, 7805.874375898835, 3063.624882164119, 1129.9689590444384, 4240.33082117102, 4992.741703841248, 2011.7892771852623, 2733.4245428338168, 2282.297654472248, 8855.254871463672, 1537.5239873245641, 6315.901780312307, 5333.770862604313, 5170.70283409145, 6353.769769115778, 9208.69840161002, 3047.077394659277, 2915.237961973998, 1898.3819556008223, 4588.031721971958, 6650.795467017584, 3929.424446573171, 4122.454218090758, 3661.6905508781333, 3573.108936382044, 2899.4810220993527, 2958.655542121368, 3376.7817796059203, 5346.289152090986, 4085.4194653241993, 2681.225945467746, 7033.391676204477, 2865.885338011339, 3219.508549305769, 6466.804313214261, 4613.1679887517585, 5288.838692866424, 3485.175229901663, 866.5853473600732, 3321.892990312359, 5864.923976859185, 2366.5543314426254, 5382.023328795828, 8433.134842920708, 6327.100053836821, 2799.4491573262208, 9576.072668115161, 7566.404698178588, 4941.978089161989, 5714.818184390291, 5313.961697382415, 32.5513029670292, 6863.929016327463, 4190.395866944963, 2150.213286343775, 171.73988651882507, 4382.204263420278, 4514.505586087161, 2.741190632634181, 2558.426421134974, 6108.597367506575, 3542.7877427468893, 2633.765827652318, 1730.9025043849556, 694.5552946435055], "policy_adversary_policy_reward": [-3195.917670561498, -7348.461435391742, -6694.370867364641, -8188.187616667943, -4792.687279643843, -7611.797015319224, -3325.1496650136205, -7124.801410164832, -5498.673931622244, -3705.7781874491884, -2669.778568334744, -3584.0889006871, -2115.785296946615, -2338.430836653047, -3952.0470371053907, -5556.380488738894, -5350.448275813403, -2279.9597069243523, -5135.814053452147, -3433.4757865680485, -6946.98211280679, -8249.578665286359, -2788.708912403246, -4236.669410876019, -7139.428656303423, -6739.563861863209, -2588.420591139205, -5783.665844440109, -5074.406763150432, -3117.291514826872, -3432.3532473456307, -4189.094548019882, -7199.356043223219, -8996.992248553579, -7438.92797938726, -5071.743634740777, -3767.869017187513, -8160.692795400851, -9992.168502178312, -4775.537811669045, -2513.573296820893, -7331.265676621257, -471.7972213335088, -246.22660526349352, -36.17452370288973, -185.82372689792487, -2758.488624467936, -5872.07334073189, -611.8114616258586, -853.5032991649015, -1012.0693680709471, -1199.0359315439732, -4190.62693078038, -1838.9460735145449, -613.8870119181014, -1262.5899805727092, -249.62891472094418, -98.01233025461654, -7867.0169999384225, -5787.537531104985, -4469.8710935856925, -3460.8876272915113, -2880.0604883163323, -8258.802566600387, -6158.782414845462, -5477.8878074299155, -9260.526244543284, -4899.110550979962, -2919.8650432323816, -1317.821440592114, -5560.340389223985, -6879.889979205778, -7815.330305943589, -8676.994998822305, -3063.624882164119, -8442.362226159437, -1129.9689590444384, -3224.50236977287, -4403.14104039242, -4974.761044557623, -5384.304699486929, -5827.375948369578, -3186.3107781421463, -2439.9004590076966, -3188.3358898378287, -4523.233963677581, -2333.43315801701, -5410.613528204534, -10893.7239037913, -8855.254871463672, -3429.8296656621383, -2660.3931033668428, -6315.901780312307, -8446.559220026416, -7410.338546081792, -5353.811568260754, -5192.654880914445, -8294.436402136567, -9541.62206632477, -6353.769769115778, -11563.797401822118, -9384.572662476787, -3069.7995617781617, -6194.940752290955, -4947.266254068076, -3259.5353851788486, -6658.033610229366, -1898.3819556008223, -4588.031721971958, -9741.070950122195, -7675.067110275952, -6700.123846053373, -5893.409477742113, -4105.287488276859, -4259.340030182338, -5075.27362454066, -3661.6905508781333, -5288.56792593325, -9467.546774129854, -3917.7521231297146, -4283.01708861766, -2900.235412186119, -3838.1621030386646, -3000.7544974071207, -8268.144996125911, -3566.8072416534555, -7679.480674842031, -5346.289152090986, -5411.312909678809, -5537.897478065799, -6220.793255042551, -2747.6946342699475, -7438.063972563885, -7736.681831721937, -3010.5122072643935, -5791.9915921192905, -3219.508549305769, -8217.871968033562, -7070.498496598331, -6552.838779773845, -4613.1679887517585, -8159.370533418414, -5317.391408644605, -5846.9926599272385, -4155.414927317813, -4594.893632682118, -1173.3858169320065, -866.5853473600732, -3341.631835677194, -5410.631385498655, -6176.309227944421, -6347.61197476693, -2366.5543314426254, -8874.026560774551, -5382.023328795828, -7780.018544602028, -9199.109498949249, -8447.10236293838, -6327.100053836821, -10889.755954505605, -3831.843702985038, -2799.549995677136, -9579.438968677996, -10890.54876210235, -9998.486544781881, -7566.404698178588, -6624.597186185819, -4956.462057223789, -5759.487293121594, -7029.678408440289, -7075.910854820277, -5314.053913386326, -123.03407384593869, -32.5513029670292, -6863.929016327463, -10966.348882821643, -4190.395866944963, -7100.743251762344, -2388.1063787095427, -6109.375155448573, -391.02451273436895, -172.4329045808896, -5447.295795496154, -4677.955055840536, -4514.505586087161, -8090.272687883188, -2.741190632634181, -73.44058206951001, -3255.456166342416, -4999.984903700547, -6108.645889731161, -7751.884178163837, -5119.084570428127, -3542.7877427468893, -4390.859497943884, -2633.765827652318, -4685.830066712776, -1730.9025043849556, -820.1146229699582, -762.2825493513851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42438773195575485, "mean_inference_ms": 1.0294101607478525, "mean_action_processing_ms": 0.17756393927183045, "mean_env_wait_ms": 0.05409985607988603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004754185676574707, "StateBufferConnector_ms": 0.0025728940963745117, "ViewRequirementAgentConnector_ms": 0.07042551040649414}, "num_episodes": 22, "episode_return_max": -73.44058206951001, "episode_return_min": -11739.671662688886, "episode_return_mean": -6179.8902549755885}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.8896987720073, "num_env_steps_trained_throughput_per_sec": 539.8896987720073, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 7530.529, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7530.496, "sample_time_ms": 730.245, "learn_time_ms": 6786.558, "learn_throughput": 589.4, "synch_weights_time_ms": 13.223}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 40, "trial_id": "3439d_00000", "date": "2024-08-09_15-31-21", "timestamp": 1723231881, "time_this_iter_s": 7.414294004440308, "time_total_s": 309.85682821273804, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.85682821273804, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.71818181818182, "ram_util_percent": 79.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.706234929865847, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.95240539610386, "policy_loss": -0.004008342863138144, "vf_loss": 9.953901254137357, "vf_explained_var": -0.001105935623248418, "kl": 0.007444353138756317, "entropy": 1.3453577157109975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7817976524195974, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.979655246129111, "policy_loss": -0.0002426944394650125, "vf_loss": 9.97692015562108, "vf_explained_var": 1.4949223351857019e-05, "kl": 0.009925991680384392, "entropy": 1.4193533025721394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "env_runners": {"episode_reward_max": -73.44058206951001, "episode_reward_min": -11739.671662688886, "episode_reward_mean": -6291.206468862052, "episode_len_mean": 177.43, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17743, "policy_reward_min": {"agent_policy": 2.741190632634181, "adversary_policy": -11563.797401822118}, "policy_reward_max": {"agent_policy": 9576.072668115161, "adversary_policy": -2.741190632634181}, "policy_reward_mean": {"agent_policy": 3923.0076873582393, "adversary_policy": -5107.107078110145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1222.4823610029753, -4190.626930780379, -1262.5899805727092, -249.6289147209442, -8522.799151933807, -4635.833259426991, -8275.633812476395, -6572.939414322227, -9260.526244543282, -3019.682630152757, -8148.450039771439, -8686.45092886706, -8442.362226159437, -3224.5023697728698, -5137.571263779029, -6218.93894401526, -3614.4219599645826, -4978.145310681596, -5461.7490317492975, -10893.7239037913, -4552.698781704414, -8446.559220026416, -7430.379251738233, -8316.38844895956, -9541.62206632477, -11739.671662688886, -6217.662919409841, -5291.5636772729285, -6658.033610229366, -9741.070950122195, -7724.395489311741, -6069.272519445802, -5212.159436632241, -5288.56792593325, -9812.189960877522, -4283.771478704427, -3880.2610583244173, -8458.17045817345, -7679.480674842031, -6863.790922420416, -6287.261943844752, -8141.3541280813415, -5936.618461372344, -8217.871968033562, -7156.532963157916, -8159.370533418414, -5875.545375705419, -5265.133330098262, -1173.385816932006, -5430.37023086349, -6658.99722585217, -8874.026560774551, -7780.018544602028, -9213.077018966918, -10889.755954505603, -3831.944541335954, -10893.915062665186, -9998.486544781883, -6639.0811542476185, -7074.347517171592, -7076.003070824188, -123.03407384593869, -10966.348882821645, -7100.743251762344, -6347.268247814343, -391.7175307964334, -5743.046587916418, -8090.272687883188, -73.44058206951001, -5697.014648907985, -7751.932700388425, -5119.084570428128, -4390.859497943885, -4685.830066712776, -887.8418776778379, -8534.706212262505, -4552.709122189305, -4099.5807587063955, -6796.566070978693, -9553.61340659877, -5274.14724316589, -8533.19327969979, -8943.684695869282, -3363.725229300565, -9323.208600147349, -3946.709725883843, -9552.178706960463, -4130.557877549669, -4487.993327220032, -5117.008976109093, -7873.2080021205375, -8314.59299267188, -6599.828962652732, -3678.4574509297604, -1330.4560859830915, -4746.842091323818, -9442.047317137693, -4336.127948459374, -3031.1867453163, -10390.013711137994], "episode_lengths": [56, 170, 76, 17, 200, 200, 200, 200, 200, 99, 200, 200, 200, 83, 200, 200, 200, 200, 200, 200, 159, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 183, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 10, 200, 200, 157, 35, 200, 200, 2, 176, 200, 178, 200, 200, 75, 200, 200, 168, 200, 200, 187, 200, 200, 87, 200, 200, 200, 140, 200, 200, 200, 200, 175, 160, 59, 200, 200, 109, 124, 200], "policy_agent_policy_reward": [988.6229386119452, 1838.9460735145449, 613.8870119181014, 98.01233025461654, 5131.755379109612, 3294.9254614502106, 2863.2292424403227, 5063.730807953153, 4899.110550979962, 1218.0038536717386, 4291.780328658336, 7805.874375898835, 3063.624882164119, 1129.9689590444384, 4240.33082117102, 4992.741703841248, 2011.7892771852623, 2733.4245428338168, 2282.297654472248, 8855.254871463672, 1537.5239873245641, 6315.901780312307, 5333.770862604313, 5170.70283409145, 6353.769769115778, 9208.69840161002, 3047.077394659277, 2915.237961973998, 1898.3819556008223, 4588.031721971958, 6650.795467017584, 3929.424446573171, 4122.454218090758, 3661.6905508781333, 3573.108936382044, 2899.4810220993527, 2958.655542121368, 3376.7817796059203, 5346.289152090986, 4085.4194653241993, 2681.225945467746, 7033.391676204477, 2865.885338011339, 3219.508549305769, 6466.804313214261, 4613.1679887517585, 5288.838692866424, 3485.175229901663, 866.5853473600732, 3321.892990312359, 5864.923976859185, 2366.5543314426254, 5382.023328795828, 8433.134842920708, 6327.100053836821, 2799.4491573262208, 9576.072668115161, 7566.404698178588, 4941.978089161989, 5714.818184390291, 5313.961697382415, 32.5513029670292, 6863.929016327463, 4190.395866944963, 2150.213286343775, 171.73988651882507, 4382.204263420278, 4514.505586087161, 2.741190632634181, 2558.426421134974, 6108.597367506575, 3542.7877427468893, 2633.765827652318, 1730.9025043849556, 694.5552946435055, 6619.974854070579, 2647.0980017378297, 2725.7398179420693, 4656.6222307826665, 1641.7976755999414, 2429.5557095199424, 7821.147275694578, 4495.431267068386, 756.0203700346555, 8566.048241996208, 2783.626636712501, 7675.533820044532, 2375.618507288337, 2744.4002263857624, 3972.808964173441, 3448.6554299157474, 2546.1826442708234, 2821.654272120424, 2724.894358153355, 1086.6284135013375, 3902.3783722827366, 5465.625267724364, 1214.776353560472, 1425.951702990061, 7655.877349050934], "policy_adversary_policy_reward": [-1012.0693680709471, -1199.0359315439732, -4190.62693078038, -1838.9460735145449, -613.8870119181014, -1262.5899805727092, -249.62891472094418, -98.01233025461654, -7867.0169999384225, -5787.537531104985, -4469.8710935856925, -3460.8876272915113, -2880.0604883163323, -8258.802566600387, -6158.782414845462, -5477.8878074299155, -9260.526244543284, -4899.110550979962, -2919.8650432323816, -1317.821440592114, -5560.340389223985, -6879.889979205778, -7815.330305943589, -8676.994998822305, -3063.624882164119, -8442.362226159437, -1129.9689590444384, -3224.50236977287, -4403.14104039242, -4974.761044557623, -5384.304699486929, -5827.375948369578, -3186.3107781421463, -2439.9004590076966, -3188.3358898378287, -4523.233963677581, -2333.43315801701, -5410.613528204534, -10893.7239037913, -8855.254871463672, -3429.8296656621383, -2660.3931033668428, -6315.901780312307, -8446.559220026416, -7410.338546081792, -5353.811568260754, -5192.654880914445, -8294.436402136567, -9541.62206632477, -6353.769769115778, -11563.797401822118, -9384.572662476787, -3069.7995617781617, -6194.940752290955, -4947.266254068076, -3259.5353851788486, -6658.033610229366, -1898.3819556008223, -4588.031721971958, -9741.070950122195, -7675.067110275952, -6700.123846053373, -5893.409477742113, -4105.287488276859, -4259.340030182338, -5075.27362454066, -3661.6905508781333, -5288.56792593325, -9467.546774129854, -3917.7521231297146, -4283.01708861766, -2900.235412186119, -3838.1621030386646, -3000.7544974071207, -8268.144996125911, -3566.8072416534555, -7679.480674842031, -5346.289152090986, -5411.312909678809, -5537.897478065799, -6220.793255042551, -2747.6946342699475, -7438.063972563885, -7736.681831721937, -3010.5122072643935, -5791.9915921192905, -3219.508549305769, -8217.871968033562, -7070.498496598331, -6552.838779773845, -4613.1679887517585, -8159.370533418414, -5317.391408644605, -5846.9926599272385, -4155.414927317813, -4594.893632682118, -1173.3858169320065, -866.5853473600732, -3341.631835677194, -5410.631385498655, -6176.309227944421, -6347.61197476693, -2366.5543314426254, -8874.026560774551, -5382.023328795828, -7780.018544602028, -9199.109498949249, -8447.10236293838, -6327.100053836821, -10889.755954505605, -3831.843702985038, -2799.549995677136, -9579.438968677996, -10890.54876210235, -9998.486544781881, -7566.404698178588, -6624.597186185819, -4956.462057223789, -5759.487293121594, -7029.678408440289, -7075.910854820277, -5314.053913386326, -123.03407384593869, -32.5513029670292, -6863.929016327463, -10966.348882821643, -4190.395866944963, -7100.743251762344, -2388.1063787095427, -6109.375155448573, -391.02451273436895, -172.4329045808896, -5447.295795496154, -4677.955055840536, -4514.505586087161, -8090.272687883188, -2.741190632634181, -73.44058206951001, -3255.456166342416, -4999.984903700547, -6108.645889731161, -7751.884178163837, -5119.084570428127, -3542.7877427468893, -4390.859497943884, -2633.765827652318, -4685.830066712776, -1730.9025043849556, -820.1146229699582, -762.2825493513851, -7381.939283563405, -7772.741782769686, -2647.0980017378297, -4552.709122189306, -2800.596421961756, -4024.72415468671, -5688.172926782507, -5765.015374978844, -9553.61340659877, -1641.7976755999414, -5274.147243165889, -2429.5557095199424, -7852.037987811575, -8502.302567582792, -4495.431267068386, -8943.684695869282, -3363.725229300565, -756.0203700346555, -8743.292484540503, -9145.964357603054, -3932.9947053237192, -2797.341657272624, -7675.533820044532, -9552.178706960462, -2459.148018497886, -4047.028366340119, -3282.845914547865, -3949.5476390579215, -4044.226453695028, -5045.591486587509, -7873.208002120538, -3448.6554299157474, -2546.1826442708234, -8314.59299267188, -6599.828962652732, -2821.654272120424, -3619.7715530073606, -2783.5802560757556, -1204.802026813908, -1212.2824726705217, -4104.43974883353, -4544.7807147730255, -5465.625267724364, -9442.047317137693, -1214.776353560472, -4336.127948459374, -2873.5924610302222, -1583.5459872761387, -10390.013711137995, -7655.877349050934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4228705752617513, "mean_inference_ms": 1.026794522822214, "mean_action_processing_ms": 0.17679421352083893, "mean_env_wait_ms": 0.05390220704051538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046215057373046875, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.06879186630249023}, "num_episodes": 25, "episode_return_max": -73.44058206951001, "episode_return_min": -11739.671662688886, "episode_return_mean": -6291.206468862052}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 515.7342096818514, "num_env_steps_trained_throughput_per_sec": 515.7342096818514, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 7545.741, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7545.708, "sample_time_ms": 729.721, "learn_time_ms": 6802.315, "learn_throughput": 588.035, "synch_weights_time_ms": 13.138}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "training_iteration": 41, "trial_id": "3439d_00000", "date": "2024-08-09_15-31-29", "timestamp": 1723231889, "time_this_iter_s": 7.7611119747161865, "time_total_s": 317.6179401874542, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327eceee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 317.6179401874542, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.3, "ram_util_percent": 79.83636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7344749117890994, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.978549633423487, "policy_loss": 0.001706970905555257, "vf_loss": 9.973863924543062, "vf_explained_var": -0.00036922103414932885, "kl": 0.008825853716795487, "entropy": 1.3255382147928079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7687660217127472, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98852080188731, "policy_loss": -0.0019076353935623374, "vf_loss": 9.98672538232551, "vf_explained_var": 6.379396827132613e-05, "kl": 0.01234354297802956, "entropy": 1.4020189825189178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": -73.44058206951001, "episode_reward_min": -11739.671662688886, "episode_reward_mean": -6448.231053282424, "episode_len_mean": 181.92, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18192, "policy_reward_min": {"agent_policy": 2.741190632634181, "adversary_policy": -11563.797401822118}, "policy_reward_max": {"agent_policy": 9576.072668115161, "adversary_policy": -2.741190632634181}, "policy_reward_mean": {"agent_policy": 4083.1489297374465, "adversary_policy": -5265.689991509934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8446.559220026416, -7430.379251738233, -8316.38844895956, -9541.62206632477, -11739.671662688886, -6217.662919409841, -5291.5636772729285, -6658.033610229366, -9741.070950122195, -7724.395489311741, -6069.272519445802, -5212.159436632241, -5288.56792593325, -9812.189960877522, -4283.771478704427, -3880.2610583244173, -8458.17045817345, -7679.480674842031, -6863.790922420416, -6287.261943844752, -8141.3541280813415, -5936.618461372344, -8217.871968033562, -7156.532963157916, -8159.370533418414, -5875.545375705419, -5265.133330098262, -1173.385816932006, -5430.37023086349, -6658.99722585217, -8874.026560774551, -7780.018544602028, -9213.077018966918, -10889.755954505603, -3831.944541335954, -10893.915062665186, -9998.486544781883, -6639.0811542476185, -7074.347517171592, -7076.003070824188, -123.03407384593869, -10966.348882821645, -7100.743251762344, -6347.268247814343, -391.7175307964334, -5743.046587916418, -8090.272687883188, -73.44058206951001, -5697.014648907985, -7751.932700388425, -5119.084570428128, -4390.859497943885, -4685.830066712776, -887.8418776778379, -8534.706212262505, -4552.709122189305, -4099.5807587063955, -6796.566070978693, -9553.61340659877, -5274.14724316589, -8533.19327969979, -8943.684695869282, -3363.725229300565, -9323.208600147349, -3946.709725883843, -9552.178706960463, -4130.557877549669, -4487.993327220032, -5117.008976109093, -7873.2080021205375, -8314.59299267188, -6599.828962652732, -3678.4574509297604, -1330.4560859830915, -4746.842091323818, -9442.047317137693, -4336.127948459374, -3031.1867453163, -10390.013711137994, -2228.441389146773, -5785.7494342731625, -6438.018670368733, -8642.300216914604, -6557.137735198952, -9385.444794362142, -5950.703928354609, -3577.326861051572, -5398.914310649414, -3889.183531208045, -6530.7489557252275, -3849.0205664681002, -6756.253384327863, -8736.341058639306, -7653.755910063712, -9813.806176442997, -181.9868108081992, -8627.454336480574, -6196.103237924025, -9535.065541557195, -6540.4590522607095], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 183, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 10, 200, 200, 157, 35, 200, 200, 2, 176, 200, 178, 200, 200, 75, 200, 200, 168, 200, 200, 187, 200, 200, 87, 200, 200, 200, 140, 200, 200, 200, 200, 175, 160, 59, 200, 200, 109, 124, 200, 200, 200, 200, 200, 200, 200, 200, 162, 200, 149, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 185], "policy_agent_policy_reward": [6315.901780312307, 5333.770862604313, 5170.70283409145, 6353.769769115778, 9208.69840161002, 3047.077394659277, 2915.237961973998, 1898.3819556008223, 4588.031721971958, 6650.795467017584, 3929.424446573171, 4122.454218090758, 3661.6905508781333, 3573.108936382044, 2899.4810220993527, 2958.655542121368, 3376.7817796059203, 5346.289152090986, 4085.4194653241993, 2681.225945467746, 7033.391676204477, 2865.885338011339, 3219.508549305769, 6466.804313214261, 4613.1679887517585, 5288.838692866424, 3485.175229901663, 866.5853473600732, 3321.892990312359, 5864.923976859185, 2366.5543314426254, 5382.023328795828, 8433.134842920708, 6327.100053836821, 2799.4491573262208, 9576.072668115161, 7566.404698178588, 4941.978089161989, 5714.818184390291, 5313.961697382415, 32.5513029670292, 6863.929016327463, 4190.395866944963, 2150.213286343775, 171.73988651882507, 4382.204263420278, 4514.505586087161, 2.741190632634181, 2558.426421134974, 6108.597367506575, 3542.7877427468893, 2633.765827652318, 1730.9025043849556, 694.5552946435055, 6619.974854070579, 2647.0980017378297, 2725.7398179420693, 4656.6222307826665, 1641.7976755999414, 2429.5557095199424, 7821.147275694578, 4495.431267068386, 756.0203700346555, 8566.048241996208, 2783.626636712501, 7675.533820044532, 2375.618507288337, 2744.4002263857624, 3972.808964173441, 3448.6554299157474, 2546.1826442708234, 2821.654272120424, 2724.894358153355, 1086.6284135013375, 3902.3783722827366, 5465.625267724364, 1214.776353560472, 1425.951702990061, 7655.877349050934, 1565.816189331618, 2149.3364711148247, 5683.637183281373, 6076.784353457295, 3987.1437853881794, 3750.208191052009, 2972.781372009543, 2849.054087372433, 3299.257912869032, 2779.345681096481, 3160.5206332706107, 2615.3244291243, 5582.78334973203, 7201.922642687869, 5821.619741681165, 8679.734170706812, 29.050866642631387, 4100.907679516824, 2227.4530616546904, 6627.199392939616, 3809.0780969531115], "policy_adversary_policy_reward": [-6315.901780312307, -8446.559220026416, -7410.338546081792, -5353.811568260754, -5192.654880914445, -8294.436402136567, -9541.62206632477, -6353.769769115778, -11563.797401822118, -9384.572662476787, -3069.7995617781617, -6194.940752290955, -4947.266254068076, -3259.5353851788486, -6658.033610229366, -1898.3819556008223, -4588.031721971958, -9741.070950122195, -7675.067110275952, -6700.123846053373, -5893.409477742113, -4105.287488276859, -4259.340030182338, -5075.27362454066, -3661.6905508781333, -5288.56792593325, -9467.546774129854, -3917.7521231297146, -4283.01708861766, -2900.235412186119, -3838.1621030386646, -3000.7544974071207, -8268.144996125911, -3566.8072416534555, -7679.480674842031, -5346.289152090986, -5411.312909678809, -5537.897478065799, -6220.793255042551, -2747.6946342699475, -7438.063972563885, -7736.681831721937, -3010.5122072643935, -5791.9915921192905, -3219.508549305769, -8217.871968033562, -7070.498496598331, -6552.838779773845, -4613.1679887517585, -8159.370533418414, -5317.391408644605, -5846.9926599272385, -4155.414927317813, -4594.893632682118, -1173.3858169320065, -866.5853473600732, -3341.631835677194, -5410.631385498655, -6176.309227944421, -6347.61197476693, -2366.5543314426254, -8874.026560774551, -5382.023328795828, -7780.018544602028, -9199.109498949249, -8447.10236293838, -6327.100053836821, -10889.755954505605, -3831.843702985038, -2799.549995677136, -9579.438968677996, -10890.54876210235, -9998.486544781881, -7566.404698178588, -6624.597186185819, -4956.462057223789, -5759.487293121594, -7029.678408440289, -7075.910854820277, -5314.053913386326, -123.03407384593869, -32.5513029670292, -6863.929016327463, -10966.348882821643, -4190.395866944963, -7100.743251762344, -2388.1063787095427, -6109.375155448573, -391.02451273436895, -172.4329045808896, -5447.295795496154, -4677.955055840536, -4514.505586087161, -8090.272687883188, -2.741190632634181, -73.44058206951001, -3255.456166342416, -4999.984903700547, -6108.645889731161, -7751.884178163837, -5119.084570428127, -3542.7877427468893, -4390.859497943884, -2633.765827652318, -4685.830066712776, -1730.9025043849556, -820.1146229699582, -762.2825493513851, -7381.939283563405, -7772.741782769686, -2647.0980017378297, -4552.709122189306, -2800.596421961756, -4024.72415468671, -5688.172926782507, -5765.015374978844, -9553.61340659877, -1641.7976755999414, -5274.147243165889, -2429.5557095199424, -7852.037987811575, -8502.302567582792, -4495.431267068386, -8943.684695869282, -3363.725229300565, -756.0203700346555, -8743.292484540503, -9145.964357603054, -3932.9947053237192, -2797.341657272624, -7675.533820044532, -9552.178706960462, -2459.148018497886, -4047.028366340119, -3282.845914547865, -3949.5476390579215, -4044.226453695028, -5045.591486587509, -7873.208002120538, -3448.6554299157474, -2546.1826442708234, -8314.59299267188, -6599.828962652732, -2821.654272120424, -3619.7715530073606, -2783.5802560757556, -1204.802026813908, -1212.2824726705217, -4104.43974883353, -4544.7807147730255, -5465.625267724364, -9442.047317137693, -1214.776353560472, -4336.127948459374, -2873.5924610302222, -1583.5459872761387, -10390.013711137995, -7655.877349050934, -1671.754870301128, -2122.502708177264, -4791.839427883533, -3143.2464775044477, -6410.980332953567, -5710.67552069654, -6076.784353457295, -8642.300216914604, -6179.283006501196, -4364.998514085939, -9385.444794362142, -3750.208191052009, -3038.388266124371, -5885.097034239781, -3539.2321632863845, -2887.148785137621, -4407.364035674001, -4290.808187844453, -3889.1835312080466, -2779.345681096481, -5547.333349476661, -4143.936239519174, -3290.0365126877364, -3174.308482904664, -5612.68519794923, -6726.351536110663, -7208.2024024537905, -8730.061298873383, -6181.213769801076, -7294.161881943803, -9627.020331165617, -8866.52001598419, -29.050866642631387, -181.98681080819924, -8554.034441558266, -4174.327574439133, -2227.4530616546904, -6196.103237924025, -6627.199392939616, -9535.065541557193, -4582.332985931136, -5767.204163282683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42201981780766107, "mean_inference_ms": 1.022583622116465, "mean_action_processing_ms": 0.17652328600544473, "mean_env_wait_ms": 0.05374188848805952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036356449127197266, "StateBufferConnector_ms": 0.002571702003479004, "ViewRequirementAgentConnector_ms": 0.06958091259002686}, "num_episodes": 21, "episode_return_max": -73.44058206951001, "episode_return_min": -11739.671662688886, "episode_return_mean": -6448.231053282424}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.5946294045841, "num_env_steps_trained_throughput_per_sec": 497.5946294045841, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 7606.505, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7606.47, "sample_time_ms": 728.223, "learn_time_ms": 6864.308, "learn_throughput": 582.724, "synch_weights_time_ms": 13.415}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 42, "trial_id": "3439d_00000", "date": "2024-08-09_15-31-37", "timestamp": 1723231897, "time_this_iter_s": 8.044838905334473, "time_total_s": 325.6627790927887, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed94c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.6627790927887, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.40909090909091, "ram_util_percent": 80.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8378935031282405, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.94025402367115, "policy_loss": -0.005600427923248693, "vf_loss": 9.9420750528574, "vf_explained_var": -0.000975860096514225, "kl": 0.011198220651810213, "entropy": 1.3711939841508864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.772474707615754, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.966634828073007, "policy_loss": -0.009495401372467833, "vf_loss": 9.970959007929242, "vf_explained_var": 5.5151263242045405e-05, "kl": 0.01723743490677662, "entropy": 1.406320748064253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "env_runners": {"episode_reward_max": -73.44058206951001, "episode_reward_min": -10966.348882821645, "episode_reward_mean": -5798.555498970098, "episode_len_mean": 172.11, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17211, "policy_reward_min": {"agent_policy": 2.741190632634181, "adversary_policy": -10966.348882821643}, "policy_reward_max": {"agent_policy": 9576.072668115161, "adversary_policy": -2.741190632634181}, "policy_reward_mean": {"agent_policy": 3627.9686117163164, "adversary_policy": -4713.262055343206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5875.545375705419, -5265.133330098262, -1173.385816932006, -5430.37023086349, -6658.99722585217, -8874.026560774551, -7780.018544602028, -9213.077018966918, -10889.755954505603, -3831.944541335954, -10893.915062665186, -9998.486544781883, -6639.0811542476185, -7074.347517171592, -7076.003070824188, -123.03407384593869, -10966.348882821645, -7100.743251762344, -6347.268247814343, -391.7175307964334, -5743.046587916418, -8090.272687883188, -73.44058206951001, -5697.014648907985, -7751.932700388425, -5119.084570428128, -4390.859497943885, -4685.830066712776, -887.8418776778379, -8534.706212262505, -4552.709122189305, -4099.5807587063955, -6796.566070978693, -9553.61340659877, -5274.14724316589, -8533.19327969979, -8943.684695869282, -3363.725229300565, -9323.208600147349, -3946.709725883843, -9552.178706960463, -4130.557877549669, -4487.993327220032, -5117.008976109093, -7873.2080021205375, -8314.59299267188, -6599.828962652732, -3678.4574509297604, -1330.4560859830915, -4746.842091323818, -9442.047317137693, -4336.127948459374, -3031.1867453163, -10390.013711137994, -2228.441389146773, -5785.7494342731625, -6438.018670368733, -8642.300216914604, -6557.137735198952, -9385.444794362142, -5950.703928354609, -3577.326861051572, -5398.914310649414, -3889.183531208045, -6530.7489557252275, -3849.0205664681002, -6756.253384327863, -8736.341058639306, -7653.755910063712, -9813.806176442997, -181.9868108081992, -8627.454336480574, -6196.103237924025, -9535.065541557195, -6540.4590522607095, -4279.672027972151, -6415.4354818599695, -3465.3788796143294, -6977.935869234452, -2912.940803854407, -5887.294743173845, -2135.2736881530823, -3909.672619722332, -1746.0933060807592, -6690.469217368756, -5010.855720187566, -3964.5507251855215, -450.14981078818687, -8463.22746456753, -2840.4795622639435, -1665.3797497618434, -4373.541726802742, -5234.385549115245, -4357.037534897863, -5383.872690146652, -1594.8287301250587, -6092.949624238834, -7671.103842663083, -5995.289314260222, -10068.647616074755], "episode_lengths": [200, 200, 58, 183, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 10, 200, 200, 157, 35, 200, 200, 2, 176, 200, 178, 200, 200, 75, 200, 200, 168, 200, 200, 187, 200, 200, 87, 200, 200, 200, 140, 200, 200, 200, 200, 175, 160, 59, 200, 200, 109, 124, 200, 200, 200, 200, 200, 200, 200, 200, 162, 200, 149, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 185, 200, 200, 124, 200, 157, 200, 90, 200, 78, 200, 160, 200, 25, 200, 96, 53, 200, 200, 184, 200, 52, 200, 200, 200, 200], "policy_agent_policy_reward": [5288.838692866424, 3485.175229901663, 866.5853473600732, 3321.892990312359, 5864.923976859185, 2366.5543314426254, 5382.023328795828, 8433.134842920708, 6327.100053836821, 2799.4491573262208, 9576.072668115161, 7566.404698178588, 4941.978089161989, 5714.818184390291, 5313.961697382415, 32.5513029670292, 6863.929016327463, 4190.395866944963, 2150.213286343775, 171.73988651882507, 4382.204263420278, 4514.505586087161, 2.741190632634181, 2558.426421134974, 6108.597367506575, 3542.7877427468893, 2633.765827652318, 1730.9025043849556, 694.5552946435055, 6619.974854070579, 2647.0980017378297, 2725.7398179420693, 4656.6222307826665, 1641.7976755999414, 2429.5557095199424, 7821.147275694578, 4495.431267068386, 756.0203700346555, 8566.048241996208, 2783.626636712501, 7675.533820044532, 2375.618507288337, 2744.4002263857624, 3972.808964173441, 3448.6554299157474, 2546.1826442708234, 2821.654272120424, 2724.894358153355, 1086.6284135013375, 3902.3783722827366, 5465.625267724364, 1214.776353560472, 1425.951702990061, 7655.877349050934, 1565.816189331618, 2149.3364711148247, 5683.637183281373, 6076.784353457295, 3987.1437853881794, 3750.208191052009, 2972.781372009543, 2849.054087372433, 3299.257912869032, 2779.345681096481, 3160.5206332706107, 2615.3244291243, 5582.78334973203, 7201.922642687869, 5821.619741681165, 8679.734170706812, 29.050866642631387, 4100.907679516824, 2227.4530616546904, 6627.199392939616, 3809.0780969531115, 3472.975445799471, 4873.6036344781505, 1565.6585118682508, 4936.545825154255, 750.7258905407238, 3384.849027493279, 974.6709883364869, 2447.1793721661234, 912.5873335291984, 5389.047652844598, 3639.8088862269688, 2562.229352953779, 55.37159040734369, 4401.537959447222, 1022.8819299318654, 166.2774216315938, 2151.311546567523, 3177.4266015028884, 1271.8613609610115, 3334.059133000596, 242.4375246763817, 2400.864640657907, 5080.715041159819, 4459.560786294556, 4123.4378133358005], "policy_adversary_policy_reward": [-5317.391408644605, -5846.9926599272385, -4155.414927317813, -4594.893632682118, -1173.3858169320065, -866.5853473600732, -3341.631835677194, -5410.631385498655, -6176.309227944421, -6347.61197476693, -2366.5543314426254, -8874.026560774551, -5382.023328795828, -7780.018544602028, -9199.109498949249, -8447.10236293838, -6327.100053836821, -10889.755954505605, -3831.843702985038, -2799.549995677136, -9579.438968677996, -10890.54876210235, -9998.486544781881, -7566.404698178588, -6624.597186185819, -4956.462057223789, -5759.487293121594, -7029.678408440289, -7075.910854820277, -5314.053913386326, -123.03407384593869, -32.5513029670292, -6863.929016327463, -10966.348882821643, -4190.395866944963, -7100.743251762344, -2388.1063787095427, -6109.375155448573, -391.02451273436895, -172.4329045808896, -5447.295795496154, -4677.955055840536, -4514.505586087161, -8090.272687883188, -2.741190632634181, -73.44058206951001, -3255.456166342416, -4999.984903700547, -6108.645889731161, -7751.884178163837, -5119.084570428127, -3542.7877427468893, -4390.859497943884, -2633.765827652318, -4685.830066712776, -1730.9025043849556, -820.1146229699582, -762.2825493513851, -7381.939283563405, -7772.741782769686, -2647.0980017378297, -4552.709122189306, -2800.596421961756, -4024.72415468671, -5688.172926782507, -5765.015374978844, -9553.61340659877, -1641.7976755999414, -5274.147243165889, -2429.5557095199424, -7852.037987811575, -8502.302567582792, -4495.431267068386, -8943.684695869282, -3363.725229300565, -756.0203700346555, -8743.292484540503, -9145.964357603054, -3932.9947053237192, -2797.341657272624, -7675.533820044532, -9552.178706960462, -2459.148018497886, -4047.028366340119, -3282.845914547865, -3949.5476390579215, -4044.226453695028, -5045.591486587509, -7873.208002120538, -3448.6554299157474, -2546.1826442708234, -8314.59299267188, -6599.828962652732, -2821.654272120424, -3619.7715530073606, -2783.5802560757556, -1204.802026813908, -1212.2824726705217, -4104.43974883353, -4544.7807147730255, -5465.625267724364, -9442.047317137693, -1214.776353560472, -4336.127948459374, -2873.5924610302222, -1583.5459872761387, -10390.013711137995, -7655.877349050934, -1671.754870301128, -2122.502708177264, -4791.839427883533, -3143.2464775044477, -6410.980332953567, -5710.67552069654, -6076.784353457295, -8642.300216914604, -6179.283006501196, -4364.998514085939, -9385.444794362142, -3750.208191052009, -3038.388266124371, -5885.097034239781, -3539.2321632863845, -2887.148785137621, -4407.364035674001, -4290.808187844453, -3889.1835312080466, -2779.345681096481, -5547.333349476661, -4143.936239519174, -3290.0365126877364, -3174.308482904664, -5612.68519794923, -6726.351536110663, -7208.2024024537905, -8730.061298873383, -6181.213769801076, -7294.161881943803, -9627.020331165617, -8866.52001598419, -29.050866642631387, -181.98681080819924, -8554.034441558266, -4174.327574439133, -2227.4530616546904, -6196.103237924025, -6627.199392939616, -9535.065541557193, -4582.332985931136, -5767.204163282683, -4214.086494446191, -3538.5609793254334, -6413.435498721888, -4875.6036176162315, -1565.6585118682508, -3465.3788796143294, -5498.624087283234, -6415.857607105474, -1175.214524548296, -2488.45216984683, -3384.849027493279, -5887.294743173845, -2135.2736881530827, -974.6709883364869, -3720.736183120937, -2636.115808767518, -1711.8006830985137, -946.8799565114438, -5688.322349243594, -6391.194520969754, -3689.1893119264887, -4961.475294488045, -2583.6017558247236, -3943.178322314578, -450.149810788187, -55.37159040734369, -8463.227464567528, -4401.537959447222, -2840.479562263943, -1022.8819299318654, -166.2774216315938, -1665.3797497618434, -4370.068597938527, -2154.7846754317375, -5234.385549115245, -3177.4266015028884, -4181.869088291429, -1447.0298075674455, -5383.872690146652, -3334.059133000596, -1594.8287301250587, -242.4375246763817, -2576.2915187024855, -5917.522746194254, -5551.18390829247, -7200.634975530434, -5995.289314260222, -4459.560786294556, -10068.647616074753, -4123.4378133358005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4206119415298118, "mean_inference_ms": 1.0201906314274232, "mean_action_processing_ms": 0.1758862580488893, "mean_env_wait_ms": 0.05356664103440241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003565669059753418, "StateBufferConnector_ms": 0.0025740861892700195, "ViewRequirementAgentConnector_ms": 0.06946969032287598}, "num_episodes": 25, "episode_return_max": -73.44058206951001, "episode_return_min": -10966.348882821645, "episode_return_mean": -5798.555498970098}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.8388796130939, "num_env_steps_trained_throughput_per_sec": 525.8388796130939, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 7606.316, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7606.281, "sample_time_ms": 728.656, "learn_time_ms": 6863.706, "learn_throughput": 582.776, "synch_weights_time_ms": 13.393}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "training_iteration": 43, "trial_id": "3439d_00000", "date": "2024-08-09_15-31-45", "timestamp": 1723231905, "time_this_iter_s": 7.611562013626099, "time_total_s": 333.2743411064148, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 333.2743411064148, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 32.81818181818182, "ram_util_percent": 82.16363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7496856961709758, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.949583858251572, "policy_loss": 0.0006447868977071873, "vf_loss": 9.944419526060422, "vf_explained_var": -0.0007808055728673935, "kl": 0.01339126105303876, "entropy": 1.4089276855190596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7787019131990968, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.972547184474884, "policy_loss": 0.001017605141790771, "vf_loss": 9.96757583769541, "vf_explained_var": 1.774556422359729e-05, "kl": 0.013179150146860925, "entropy": 1.3747328567757178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": -83.67937964917911, "episode_reward_min": -10390.013711137994, "episode_reward_mean": -5402.621378517932, "episode_len_mean": 170.37, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17037, "policy_reward_min": {"agent_policy": 29.050866642631387, "adversary_policy": -10390.013711137995}, "policy_reward_max": {"agent_policy": 8679.734170706812, "adversary_policy": -29.050866642631387}, "policy_reward_mean": {"agent_policy": 3203.136949970243, "adversary_policy": -4302.879164244088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5119.084570428128, -4390.859497943885, -4685.830066712776, -887.8418776778379, -8534.706212262505, -4552.709122189305, -4099.5807587063955, -6796.566070978693, -9553.61340659877, -5274.14724316589, -8533.19327969979, -8943.684695869282, -3363.725229300565, -9323.208600147349, -3946.709725883843, -9552.178706960463, -4130.557877549669, -4487.993327220032, -5117.008976109093, -7873.2080021205375, -8314.59299267188, -6599.828962652732, -3678.4574509297604, -1330.4560859830915, -4746.842091323818, -9442.047317137693, -4336.127948459374, -3031.1867453163, -10390.013711137994, -2228.441389146773, -5785.7494342731625, -6438.018670368733, -8642.300216914604, -6557.137735198952, -9385.444794362142, -5950.703928354609, -3577.326861051572, -5398.914310649414, -3889.183531208045, -6530.7489557252275, -3849.0205664681002, -6756.253384327863, -8736.341058639306, -7653.755910063712, -9813.806176442997, -181.9868108081992, -8627.454336480574, -6196.103237924025, -9535.065541557195, -6540.4590522607095, -4279.672027972151, -6415.4354818599695, -3465.3788796143294, -6977.935869234452, -2912.940803854407, -5887.294743173845, -2135.2736881530823, -3909.672619722332, -1746.0933060807592, -6690.469217368756, -5010.855720187566, -3964.5507251855215, -450.14981078818687, -8463.22746456753, -2840.4795622639435, -1665.3797497618434, -4373.541726802742, -5234.385549115245, -4357.037534897863, -5383.872690146652, -1594.8287301250587, -6092.949624238834, -7671.103842663083, -5995.289314260222, -10068.647616074755, -2565.9016545746126, -7105.015227045601, -5459.98133646662, -7518.878049346474, -415.67980020100964, -8127.595065538472, -2069.5763443286965, -5015.942046832498, -7584.253273559848, -4822.765350910301, -5384.774192965438, -6511.469218726763, -3260.7241211251962, -3538.916721570842, -9728.160247732329, -6974.271210030526, -3437.1321586115455, -1769.518631941375, -2070.8831262078174, -5519.2927857451, -2398.8052632823587, -83.67937964917911, -2283.807773782333, -6349.627820123539, -9368.844298018306], "episode_lengths": [178, 200, 200, 75, 200, 200, 168, 200, 200, 187, 200, 200, 87, 200, 200, 200, 140, 200, 200, 200, 200, 175, 160, 59, 200, 200, 109, 124, 200, 200, 200, 200, 200, 200, 200, 200, 162, 200, 149, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 185, 200, 200, 124, 200, 157, 200, 90, 200, 78, 200, 160, 200, 25, 200, 96, 53, 200, 200, 184, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 41, 200, 70, 200, 200, 200, 189, 200, 139, 200, 200, 183, 200, 37, 99, 200, 135, 17, 137, 200, 200], "policy_agent_policy_reward": [3542.7877427468893, 2633.765827652318, 1730.9025043849556, 694.5552946435055, 6619.974854070579, 2647.0980017378297, 2725.7398179420693, 4656.6222307826665, 1641.7976755999414, 2429.5557095199424, 7821.147275694578, 4495.431267068386, 756.0203700346555, 8566.048241996208, 2783.626636712501, 7675.533820044532, 2375.618507288337, 2744.4002263857624, 3972.808964173441, 3448.6554299157474, 2546.1826442708234, 2821.654272120424, 2724.894358153355, 1086.6284135013375, 3902.3783722827366, 5465.625267724364, 1214.776353560472, 1425.951702990061, 7655.877349050934, 1565.816189331618, 2149.3364711148247, 5683.637183281373, 6076.784353457295, 3987.1437853881794, 3750.208191052009, 2972.781372009543, 2849.054087372433, 3299.257912869032, 2779.345681096481, 3160.5206332706107, 2615.3244291243, 5582.78334973203, 7201.922642687869, 5821.619741681165, 8679.734170706812, 29.050866642631387, 4100.907679516824, 2227.4530616546904, 6627.199392939616, 3809.0780969531115, 3472.975445799471, 4873.6036344781505, 1565.6585118682508, 4936.545825154255, 750.7258905407238, 3384.849027493279, 974.6709883364869, 2447.1793721661234, 912.5873335291984, 5389.047652844598, 3639.8088862269688, 2562.229352953779, 55.37159040734369, 4401.537959447222, 1022.8819299318654, 166.2774216315938, 2151.311546567523, 3177.4266015028884, 1271.8613609610115, 3334.059133000596, 242.4375246763817, 2400.864640657907, 5080.715041159819, 4459.560786294556, 4123.4378133358005, 1744.136500305104, 1671.0956365657178, 3815.8960276711477, 3605.637978188943, 253.82536941108822, 3735.831352276539, 685.4036732255665, 2855.7847204798054, 3804.0764416741977, 2560.054538378976, 3246.8214435859927, 3371.201046089872, 2610.7175551430455, 2639.405900247228, 4191.093586917921, 2986.821052576122, 2100.4412034634306, 240.64862837946072, 975.9099608773575, 2576.311143200011, 1373.25252558378, 52.27118034851565, 1190.885334286153, 5683.851398282567, 7769.677104968205], "policy_adversary_policy_reward": [-5119.084570428127, -3542.7877427468893, -4390.859497943884, -2633.765827652318, -4685.830066712776, -1730.9025043849556, -820.1146229699582, -762.2825493513851, -7381.939283563405, -7772.741782769686, -2647.0980017378297, -4552.709122189306, -2800.596421961756, -4024.72415468671, -5688.172926782507, -5765.015374978844, -9553.61340659877, -1641.7976755999414, -5274.147243165889, -2429.5557095199424, -7852.037987811575, -8502.302567582792, -4495.431267068386, -8943.684695869282, -3363.725229300565, -756.0203700346555, -8743.292484540503, -9145.964357603054, -3932.9947053237192, -2797.341657272624, -7675.533820044532, -9552.178706960462, -2459.148018497886, -4047.028366340119, -3282.845914547865, -3949.5476390579215, -4044.226453695028, -5045.591486587509, -7873.208002120538, -3448.6554299157474, -2546.1826442708234, -8314.59299267188, -6599.828962652732, -2821.654272120424, -3619.7715530073606, -2783.5802560757556, -1204.802026813908, -1212.2824726705217, -4104.43974883353, -4544.7807147730255, -5465.625267724364, -9442.047317137693, -1214.776353560472, -4336.127948459374, -2873.5924610302222, -1583.5459872761387, -10390.013711137995, -7655.877349050934, -1671.754870301128, -2122.502708177264, -4791.839427883533, -3143.2464775044477, -6410.980332953567, -5710.67552069654, -6076.784353457295, -8642.300216914604, -6179.283006501196, -4364.998514085939, -9385.444794362142, -3750.208191052009, -3038.388266124371, -5885.097034239781, -3539.2321632863845, -2887.148785137621, -4407.364035674001, -4290.808187844453, -3889.1835312080466, -2779.345681096481, -5547.333349476661, -4143.936239519174, -3290.0365126877364, -3174.308482904664, -5612.68519794923, -6726.351536110663, -7208.2024024537905, -8730.061298873383, -6181.213769801076, -7294.161881943803, -9627.020331165617, -8866.52001598419, -29.050866642631387, -181.98681080819924, -8554.034441558266, -4174.327574439133, -2227.4530616546904, -6196.103237924025, -6627.199392939616, -9535.065541557193, -4582.332985931136, -5767.204163282683, -4214.086494446191, -3538.5609793254334, -6413.435498721888, -4875.6036176162315, -1565.6585118682508, -3465.3788796143294, -5498.624087283234, -6415.857607105474, -1175.214524548296, -2488.45216984683, -3384.849027493279, -5887.294743173845, -2135.2736881530827, -974.6709883364869, -3720.736183120937, -2636.115808767518, -1711.8006830985137, -946.8799565114438, -5688.322349243594, -6391.194520969754, -3689.1893119264887, -4961.475294488045, -2583.6017558247236, -3943.178322314578, -450.149810788187, -55.37159040734369, -8463.227464567528, -4401.537959447222, -2840.479562263943, -1022.8819299318654, -166.2774216315938, -1665.3797497618434, -4370.068597938527, -2154.7846754317375, -5234.385549115245, -3177.4266015028884, -4181.869088291429, -1447.0298075674455, -5383.872690146652, -3334.059133000596, -1594.8287301250587, -242.4375246763817, -2576.2915187024855, -5917.522746194254, -5551.18390829247, -7200.634975530434, -5995.289314260222, -4459.560786294556, -10068.647616074753, -4123.4378133358005, -1886.5784116732586, -2423.459743206468, -7105.015227045601, -1671.0956365657178, -3950.313785325069, -5325.563578812696, -3605.637978188943, -7518.878049346475, -268.07264913229227, -401.4325204798059, -8127.595065538472, -3735.831352276539, -2069.5763443286965, -685.4036732255665, -5015.942046832499, -2855.7847204798054, -7513.067403807014, -3875.262311427032, -3377.954932668634, -4004.8649566206404, -3516.0097815198314, -5115.585855031603, -3529.9676155989996, -6352.702649217647, -3163.0831893788827, -2708.358486889359, -2710.7950124020813, -3467.52760941599, -9728.160247732329, -4191.093586917921, -2986.821052576122, -6974.271210030526, -2162.794363097183, -3374.778998977793, -1769.5186319413747, -240.64862837946072, -1900.9104711549292, -1145.8826159302469, -3095.3793087260065, -5000.224620219105, -1392.8101546999837, -2379.2476341661527, -78.95061150814264, -56.99994848955211, -1957.9499624042455, -1516.7431456642412, -6337.286853686108, -5696.19236472, -9368.844298018306, -7769.677104968205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41949000596739844, "mean_inference_ms": 1.016130214093063, "mean_action_processing_ms": 0.17526929358173182, "mean_env_wait_ms": 0.0534178850635662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034488439559936523, "StateBufferConnector_ms": 0.0024106502532958984, "ViewRequirementAgentConnector_ms": 0.06579327583312988}, "num_episodes": 25, "episode_return_max": -83.67937964917911, "episode_return_min": -10390.013711137994, "episode_return_mean": -5402.621378517932}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.4714964127531, "num_env_steps_trained_throughput_per_sec": 541.4714964127531, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 7595.478, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7595.443, "sample_time_ms": 728.034, "learn_time_ms": 6853.428, "learn_throughput": 583.65, "synch_weights_time_ms": 13.419}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 44, "trial_id": "3439d_00000", "date": "2024-08-09_15-31-52", "timestamp": 1723231912, "time_this_iter_s": 7.392021179199219, "time_total_s": 340.666362285614, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 340.666362285614, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 32.39090909090909, "ram_util_percent": 82.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8506615444396933, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.933714753389358, "policy_loss": -0.005991447691242987, "vf_loss": 9.935929184158644, "vf_explained_var": -0.000661105973025163, "kl": 0.011191182020896424, "entropy": 1.3927927639335393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8009780494703187, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.968929659626472, "policy_loss": -0.0021534427453482907, "vf_loss": 9.965822560446602, "vf_explained_var": 0.00013464149974641346, "kl": 0.017535136108873067, "entropy": 1.3613178598817695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": -83.67937964917911, "episode_reward_min": -10390.013711137994, "episode_reward_mean": -5075.344332566433, "episode_len_mean": 164.7, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 16470, "policy_reward_min": {"agent_policy": 29.050866642631387, "adversary_policy": -10390.013711137995}, "policy_reward_max": {"agent_policy": 8679.734170706812, "adversary_policy": -29.050866642631387}, "policy_reward_mean": {"agent_policy": 3002.829806737175, "adversary_policy": -4039.0870696518036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4746.842091323818, -9442.047317137693, -4336.127948459374, -3031.1867453163, -10390.013711137994, -2228.441389146773, -5785.7494342731625, -6438.018670368733, -8642.300216914604, -6557.137735198952, -9385.444794362142, -5950.703928354609, -3577.326861051572, -5398.914310649414, -3889.183531208045, -6530.7489557252275, -3849.0205664681002, -6756.253384327863, -8736.341058639306, -7653.755910063712, -9813.806176442997, -181.9868108081992, -8627.454336480574, -6196.103237924025, -9535.065541557195, -6540.4590522607095, -4279.672027972151, -6415.4354818599695, -3465.3788796143294, -6977.935869234452, -2912.940803854407, -5887.294743173845, -2135.2736881530823, -3909.672619722332, -1746.0933060807592, -6690.469217368756, -5010.855720187566, -3964.5507251855215, -450.14981078818687, -8463.22746456753, -2840.4795622639435, -1665.3797497618434, -4373.541726802742, -5234.385549115245, -4357.037534897863, -5383.872690146652, -1594.8287301250587, -6092.949624238834, -7671.103842663083, -5995.289314260222, -10068.647616074755, -2565.9016545746126, -7105.015227045601, -5459.98133646662, -7518.878049346474, -415.67980020100964, -8127.595065538472, -2069.5763443286965, -5015.942046832498, -7584.253273559848, -4822.765350910301, -5384.774192965438, -6511.469218726763, -3260.7241211251962, -3538.916721570842, -9728.160247732329, -6974.271210030526, -3437.1321586115455, -1769.518631941375, -2070.8831262078174, -5519.2927857451, -2398.8052632823587, -83.67937964917911, -2283.807773782333, -6349.627820123539, -9368.844298018306, -5368.5868900650385, -8260.98157739387, -6291.8020333606255, -770.1862921256361, -756.7553498084517, -8594.110976756037, -1406.8800844640496, -9881.599353685797, -2549.1372341067877, -7990.269140111398, -4899.2448368955775, -2297.4537214079155, -3449.8784176192758, -2843.749602599346, -6149.763157363556, -6514.962580087853, -867.6915477275871, -2760.287759459059, -3654.4687004032685, -7200.816755030174, -1879.408522616788, -4607.119529683006, -6915.520920768881, -451.3631610722025], "episode_lengths": [200, 200, 109, 124, 200, 200, 200, 200, 200, 200, 200, 200, 162, 200, 149, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 185, 200, 200, 124, 200, 157, 200, 90, 200, 78, 200, 160, 200, 25, 200, 96, 53, 200, 200, 184, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 41, 200, 70, 200, 200, 200, 189, 200, 139, 200, 200, 183, 200, 37, 99, 200, 135, 17, 137, 200, 200, 200, 200, 200, 51, 15, 200, 87, 200, 148, 200, 200, 200, 96, 127, 200, 200, 58, 113, 200, 200, 122, 200, 200, 45], "policy_agent_policy_reward": [3902.3783722827366, 5465.625267724364, 1214.776353560472, 1425.951702990061, 7655.877349050934, 1565.816189331618, 2149.3364711148247, 5683.637183281373, 6076.784353457295, 3987.1437853881794, 3750.208191052009, 2972.781372009543, 2849.054087372433, 3299.257912869032, 2779.345681096481, 3160.5206332706107, 2615.3244291243, 5582.78334973203, 7201.922642687869, 5821.619741681165, 8679.734170706812, 29.050866642631387, 4100.907679516824, 2227.4530616546904, 6627.199392939616, 3809.0780969531115, 3472.975445799471, 4873.6036344781505, 1565.6585118682508, 4936.545825154255, 750.7258905407238, 3384.849027493279, 974.6709883364869, 2447.1793721661234, 912.5873335291984, 5389.047652844598, 3639.8088862269688, 2562.229352953779, 55.37159040734369, 4401.537959447222, 1022.8819299318654, 166.2774216315938, 2151.311546567523, 3177.4266015028884, 1271.8613609610115, 3334.059133000596, 242.4375246763817, 2400.864640657907, 5080.715041159819, 4459.560786294556, 4123.4378133358005, 1744.136500305104, 1671.0956365657178, 3815.8960276711477, 3605.637978188943, 253.82536941108822, 3735.831352276539, 685.4036732255665, 2855.7847204798054, 3804.0764416741977, 2560.054538378976, 3246.8214435859927, 3371.201046089872, 2610.7175551430455, 2639.405900247228, 4191.093586917921, 2986.821052576122, 2100.4412034634306, 240.64862837946072, 975.9099608773575, 2576.311143200011, 1373.25252558378, 52.27118034851565, 1190.885334286153, 5683.851398282567, 7769.677104968205, 3293.455581792585, 7659.896661141908, 4452.10892693456, 556.8046765228119, 45.19905702323433, 2216.18907096728, 678.7628141843358, 7173.234567376747, 904.5961174239948, 3152.688848567916, 3626.350251403532, 1947.5924452625454, 960.2754883962251, 1527.909207036624, 4322.233175255876, 5322.406836109916, 254.32159679892507, 872.2278393085576, 1733.8086849455192, 3721.015144911547, 1280.2920326798358, 3830.9783789980543, 3180.426438666763, 397.961921424655], "policy_adversary_policy_reward": [-4104.43974883353, -4544.7807147730255, -5465.625267724364, -9442.047317137693, -1214.776353560472, -4336.127948459374, -2873.5924610302222, -1583.5459872761387, -10390.013711137995, -7655.877349050934, -1671.754870301128, -2122.502708177264, -4791.839427883533, -3143.2464775044477, -6410.980332953567, -5710.67552069654, -6076.784353457295, -8642.300216914604, -6179.283006501196, -4364.998514085939, -9385.444794362142, -3750.208191052009, -3038.388266124371, -5885.097034239781, -3539.2321632863845, -2887.148785137621, -4407.364035674001, -4290.808187844453, -3889.1835312080466, -2779.345681096481, -5547.333349476661, -4143.936239519174, -3290.0365126877364, -3174.308482904664, -5612.68519794923, -6726.351536110663, -7208.2024024537905, -8730.061298873383, -6181.213769801076, -7294.161881943803, -9627.020331165617, -8866.52001598419, -29.050866642631387, -181.98681080819924, -8554.034441558266, -4174.327574439133, -2227.4530616546904, -6196.103237924025, -6627.199392939616, -9535.065541557193, -4582.332985931136, -5767.204163282683, -4214.086494446191, -3538.5609793254334, -6413.435498721888, -4875.6036176162315, -1565.6585118682508, -3465.3788796143294, -5498.624087283234, -6415.857607105474, -1175.214524548296, -2488.45216984683, -3384.849027493279, -5887.294743173845, -2135.2736881530827, -974.6709883364869, -3720.736183120937, -2636.115808767518, -1711.8006830985137, -946.8799565114438, -5688.322349243594, -6391.194520969754, -3689.1893119264887, -4961.475294488045, -2583.6017558247236, -3943.178322314578, -450.149810788187, -55.37159040734369, -8463.227464567528, -4401.537959447222, -2840.479562263943, -1022.8819299318654, -166.2774216315938, -1665.3797497618434, -4370.068597938527, -2154.7846754317375, -5234.385549115245, -3177.4266015028884, -4181.869088291429, -1447.0298075674455, -5383.872690146652, -3334.059133000596, -1594.8287301250587, -242.4375246763817, -2576.2915187024855, -5917.522746194254, -5551.18390829247, -7200.634975530434, -5995.289314260222, -4459.560786294556, -10068.647616074753, -4123.4378133358005, -1886.5784116732586, -2423.459743206468, -7105.015227045601, -1671.0956365657178, -3950.313785325069, -5325.563578812696, -3605.637978188943, -7518.878049346475, -268.07264913229227, -401.4325204798059, -8127.595065538472, -3735.831352276539, -2069.5763443286965, -685.4036732255665, -5015.942046832499, -2855.7847204798054, -7513.067403807014, -3875.262311427032, -3377.954932668634, -4004.8649566206404, -3516.0097815198314, -5115.585855031603, -3529.9676155989996, -6352.702649217647, -3163.0831893788827, -2708.358486889359, -2710.7950124020813, -3467.52760941599, -9728.160247732329, -4191.093586917921, -2986.821052576122, -6974.271210030526, -2162.794363097183, -3374.778998977793, -1769.5186319413747, -240.64862837946072, -1900.9104711549292, -1145.8826159302469, -3095.3793087260065, -5000.224620219105, -1392.8101546999837, -2379.2476341661527, -78.95061150814264, -56.99994848955211, -1957.9499624042455, -1516.7431456642412, -6337.286853686108, -5696.19236472, -9368.844298018306, -7769.677104968205, -3396.2734409038594, -5265.769030953764, -8089.991340695385, -7830.886897840395, -5816.9546722931445, -4926.956288002038, -582.3668590324176, -744.6241096160302, -756.7553498084517, -45.19905702323433, -2314.4554333529927, -8495.844614370322, -1406.8800844640496, -678.7628141843358, -9881.599353685799, -7173.234567376747, -1191.4111697979524, -2262.3221817328294, -7990.269140111396, -3152.688848567916, -4819.224568385311, -3706.370519913799, -2081.927770907832, -2163.1183957626317, -978.6315684431355, -3431.522337572365, -2587.2158879440794, -1784.4429216918911, -6149.763157363557, -4322.233175255876, -5341.744262028497, -6495.625154169272, -254.32159679892507, -867.6915477275871, -872.2278393085576, -2760.287759459059, -3307.606416461467, -2080.670968887324, -4322.006508091321, -6599.825391850401, -1354.2823950361692, -1805.4181602604547, -4606.393314667993, -3831.704594013067, -4110.048478438379, -5985.898880997261, -430.2958969943462, -419.0291855025112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4186107650697125, "mean_inference_ms": 1.0119626451382266, "mean_action_processing_ms": 0.17488903390601146, "mean_env_wait_ms": 0.053338335067225386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034830570220947266, "StateBufferConnector_ms": 0.0028829574584960938, "ViewRequirementAgentConnector_ms": 0.06634247303009033}, "num_episodes": 24, "episode_return_max": -83.67937964917911, "episode_return_min": -10390.013711137994, "episode_return_mean": -5075.344332566433}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.2779916655165, "num_env_steps_trained_throughput_per_sec": 532.2779916655165, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 7593.437, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7593.401, "sample_time_ms": 726.886, "learn_time_ms": 6852.463, "learn_throughput": 583.732, "synch_weights_time_ms": 13.529}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 45, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-00", "timestamp": 1723231920, "time_this_iter_s": 7.520157814025879, "time_total_s": 348.1865200996399, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 348.1865200996399, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 22.6, "ram_util_percent": 82.45454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7087555819191038, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.926899834473927, "policy_loss": 0.0012093454934074543, "vf_loss": 9.922532678643863, "vf_explained_var": -0.0009547472621003787, "kl": 0.009356546544586309, "entropy": 1.3887504530449708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.837458595491591, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.971291803935218, "policy_loss": 0.003722342348623055, "vf_loss": 9.962750422765339, "vf_explained_var": 0.00029463137268389346, "kl": 0.01606343477106993, "entropy": 1.287581791133477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": -83.67937964917911, "episode_reward_min": -10068.647616074755, "episode_reward_mean": -4781.444925084061, "episode_len_mean": 159.56, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 15956, "policy_reward_min": {"agent_policy": 31.13485837049979, "adversary_policy": -10068.647616074753}, "policy_reward_max": {"agent_policy": 7834.580008793275, "adversary_policy": -31.13485837049979}, "policy_reward_mean": {"agent_policy": 2731.2597422887115, "adversary_policy": -3756.352333686386}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6415.4354818599695, -3465.3788796143294, -6977.935869234452, -2912.940803854407, -5887.294743173845, -2135.2736881530823, -3909.672619722332, -1746.0933060807592, -6690.469217368756, -5010.855720187566, -3964.5507251855215, -450.14981078818687, -8463.22746456753, -2840.4795622639435, -1665.3797497618434, -4373.541726802742, -5234.385549115245, -4357.037534897863, -5383.872690146652, -1594.8287301250587, -6092.949624238834, -7671.103842663083, -5995.289314260222, -10068.647616074755, -2565.9016545746126, -7105.015227045601, -5459.98133646662, -7518.878049346474, -415.67980020100964, -8127.595065538472, -2069.5763443286965, -5015.942046832498, -7584.253273559848, -4822.765350910301, -5384.774192965438, -6511.469218726763, -3260.7241211251962, -3538.916721570842, -9728.160247732329, -6974.271210030526, -3437.1321586115455, -1769.518631941375, -2070.8831262078174, -5519.2927857451, -2398.8052632823587, -83.67937964917911, -2283.807773782333, -6349.627820123539, -9368.844298018306, -5368.5868900650385, -8260.98157739387, -6291.8020333606255, -770.1862921256361, -756.7553498084517, -8594.110976756037, -1406.8800844640496, -9881.599353685797, -2549.1372341067877, -7990.269140111398, -4899.2448368955775, -2297.4537214079155, -3449.8784176192758, -2843.749602599346, -6149.763157363556, -6514.962580087853, -867.6915477275871, -2760.287759459059, -3654.4687004032685, -7200.816755030174, -1879.408522616788, -4607.119529683006, -6915.520920768881, -451.3631610722025, -6235.212180881198, -384.37959968660573, -2092.2779504701057, -6928.396464983287, -2792.056352700858, -7684.467936051703, -3271.531287999769, -9907.905789304747, -2863.0081447463986, -4888.83365575687, -5609.941019773322, -7735.049888501838, -4075.2342344765834, -2966.587291911123, -5176.400643216931, -7479.516791081645, -2397.491882490719, -6074.345580244618, -7720.056838935981, -4758.085629631768, -4673.645770170778, -6930.934360730054, -2404.518020815299, -6270.808865382442, -6266.8995127985045, -8649.452711940376, -2873.1265906525505], "episode_lengths": [200, 124, 200, 157, 200, 90, 200, 78, 200, 160, 200, 25, 200, 96, 53, 200, 200, 184, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 41, 200, 70, 200, 200, 200, 189, 200, 139, 200, 200, 183, 200, 37, 99, 200, 135, 17, 137, 200, 200, 200, 200, 200, 51, 15, 200, 87, 200, 148, 200, 200, 200, 96, 127, 200, 200, 58, 113, 200, 200, 122, 200, 200, 45, 167, 11, 85, 200, 99, 200, 163, 200, 132, 200, 200, 200, 136, 111, 196, 200, 99, 200, 200, 200, 200, 200, 110, 200, 200, 200, 119], "policy_agent_policy_reward": [4873.6036344781505, 1565.6585118682508, 4936.545825154255, 750.7258905407238, 3384.849027493279, 974.6709883364869, 2447.1793721661234, 912.5873335291984, 5389.047652844598, 3639.8088862269688, 2562.229352953779, 55.37159040734369, 4401.537959447222, 1022.8819299318654, 166.2774216315938, 2151.311546567523, 3177.4266015028884, 1271.8613609610115, 3334.059133000596, 242.4375246763817, 2400.864640657907, 5080.715041159819, 4459.560786294556, 4123.4378133358005, 1744.136500305104, 1671.0956365657178, 3815.8960276711477, 3605.637978188943, 253.82536941108822, 3735.831352276539, 685.4036732255665, 2855.7847204798054, 3804.0764416741977, 2560.054538378976, 3246.8214435859927, 3371.201046089872, 2610.7175551430455, 2639.405900247228, 4191.093586917921, 2986.821052576122, 2100.4412034634306, 240.64862837946072, 975.9099608773575, 2576.311143200011, 1373.25252558378, 52.27118034851565, 1190.885334286153, 5683.851398282567, 7769.677104968205, 3293.455581792585, 7659.896661141908, 4452.10892693456, 556.8046765228119, 45.19905702323433, 2216.18907096728, 678.7628141843358, 7173.234567376747, 904.5961174239948, 3152.688848567916, 3626.350251403532, 1947.5924452625454, 960.2754883962251, 1527.909207036624, 4322.233175255876, 5322.406836109916, 254.32159679892507, 872.2278393085576, 1733.8086849455192, 3721.015144911547, 1280.2920326798358, 3830.9783789980543, 3180.426438666763, 397.961921424655, 2605.1045639505064, 31.13485837049979, 822.1696489994788, 2034.7415933287689, 1743.4317596288813, 2566.454479729829, 2331.135456024539, 7834.580008793275, 1942.6587808411489, 1542.7930623837194, 3607.7023243443705, 4934.629683214253, 2353.899507865197, 1106.4188360197243, 3122.2318253584376, 5016.505935099714, 1747.1878324154347, 2231.8521338497317, 3208.975403809284, 4043.810276240615, 3794.77025199246, 4152.495057087301, 1210.209090362162, 2639.120128208682, 4909.0500355055165, 7516.008115725621, 1900.4666892950142], "policy_adversary_policy_reward": [-6413.435498721888, -4875.6036176162315, -1565.6585118682508, -3465.3788796143294, -5498.624087283234, -6415.857607105474, -1175.214524548296, -2488.45216984683, -3384.849027493279, -5887.294743173845, -2135.2736881530827, -974.6709883364869, -3720.736183120937, -2636.115808767518, -1711.8006830985137, -946.8799565114438, -5688.322349243594, -6391.194520969754, -3689.1893119264887, -4961.475294488045, -2583.6017558247236, -3943.178322314578, -450.149810788187, -55.37159040734369, -8463.227464567528, -4401.537959447222, -2840.479562263943, -1022.8819299318654, -166.2774216315938, -1665.3797497618434, -4370.068597938527, -2154.7846754317375, -5234.385549115245, -3177.4266015028884, -4181.869088291429, -1447.0298075674455, -5383.872690146652, -3334.059133000596, -1594.8287301250587, -242.4375246763817, -2576.2915187024855, -5917.522746194254, -5551.18390829247, -7200.634975530434, -5995.289314260222, -4459.560786294556, -10068.647616074753, -4123.4378133358005, -1886.5784116732586, -2423.459743206468, -7105.015227045601, -1671.0956365657178, -3950.313785325069, -5325.563578812696, -3605.637978188943, -7518.878049346475, -268.07264913229227, -401.4325204798059, -8127.595065538472, -3735.831352276539, -2069.5763443286965, -685.4036732255665, -5015.942046832499, -2855.7847204798054, -7513.067403807014, -3875.262311427032, -3377.954932668634, -4004.8649566206404, -3516.0097815198314, -5115.585855031603, -3529.9676155989996, -6352.702649217647, -3163.0831893788827, -2708.358486889359, -2710.7950124020813, -3467.52760941599, -9728.160247732329, -4191.093586917921, -2986.821052576122, -6974.271210030526, -2162.794363097183, -3374.778998977793, -1769.5186319413747, -240.64862837946072, -1900.9104711549292, -1145.8826159302469, -3095.3793087260065, -5000.224620219105, -1392.8101546999837, -2379.2476341661527, -78.95061150814264, -56.99994848955211, -1957.9499624042455, -1516.7431456642412, -6337.286853686108, -5696.19236472, -9368.844298018306, -7769.677104968205, -3396.2734409038594, -5265.769030953764, -8089.991340695385, -7830.886897840395, -5816.9546722931445, -4926.956288002038, -582.3668590324176, -744.6241096160302, -756.7553498084517, -45.19905702323433, -2314.4554333529927, -8495.844614370322, -1406.8800844640496, -678.7628141843358, -9881.599353685799, -7173.234567376747, -1191.4111697979524, -2262.3221817328294, -7990.269140111396, -3152.688848567916, -4819.224568385311, -3706.370519913799, -2081.927770907832, -2163.1183957626317, -978.6315684431355, -3431.522337572365, -2587.2158879440794, -1784.4429216918911, -6149.763157363557, -4322.233175255876, -5341.744262028497, -6495.625154169272, -254.32159679892507, -867.6915477275871, -872.2278393085576, -2760.287759459059, -3307.606416461467, -2080.670968887324, -4322.006508091321, -6599.825391850401, -1354.2823950361692, -1805.4181602604547, -4606.393314667993, -3831.704594013067, -4110.048478438379, -5985.898880997261, -430.2958969943462, -419.0291855025112, -6235.212180881197, -2605.1045639505064, -31.13485837049979, -384.37959968660573, -822.1696489994788, -2092.2779504701057, -2034.7415933287689, -6928.396464983287, -1743.4317596288813, -2792.056352700858, -2566.454479729829, -7684.467936051703, -2604.6191046086233, -2998.0476394156854, -7834.580008793275, -9907.905789304745, -1952.5654034124634, -2853.101522175084, -4760.581120269343, -1671.045597871253, -5609.083653183632, -3608.559690934061, -4934.629683214253, -7735.049888501838, -2562.5245840635584, -3866.6091582782224, -2966.5872919111225, -1106.4188360197243, -3122.2318253584376, -5176.400643216931, -5574.686433233447, -6921.3362929479135, -1749.0620882908245, -2395.6176266153293, -6074.345580244618, -2231.8521338497317, -7720.0568389359805, -3208.975403809284, -4070.3453379046696, -4731.550567967712, -3794.77025199246, -4673.645770170778, -4152.495057087301, -6930.934360730054, -2196.2885248238167, -1418.4385863536486, -2639.120128208682, -6270.808865382442, -6264.597120515728, -4911.352427788292, -7516.008115725621, -8649.452711940376, -1913.8769324360671, -2859.7163475114985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41735613720754927, "mean_inference_ms": 1.0093057472137268, "mean_action_processing_ms": 0.17436718182627298, "mean_env_wait_ms": 0.05318381996325281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033696889877319336, "StateBufferConnector_ms": 0.0028520822525024414, "ViewRequirementAgentConnector_ms": 0.06399524211883545}, "num_episodes": 27, "episode_return_max": -83.67937964917911, "episode_return_min": -10068.647616074755, "episode_return_mean": -4781.444925084061}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.1246642478357, "num_env_steps_trained_throughput_per_sec": 518.1246642478357, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 7619.507, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7619.471, "sample_time_ms": 726.463, "learn_time_ms": 6878.585, "learn_throughput": 581.515, "synch_weights_time_ms": 13.891}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 46, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-08", "timestamp": 1723231928, "time_this_iter_s": 7.726786851882935, "time_total_s": 355.9133069515228, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 355.9133069515228, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 28.74545454545454, "ram_util_percent": 82.19090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0007906549610197, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.894318945209186, "policy_loss": -0.006813382312005464, "vf_loss": 9.896023072799046, "vf_explained_var": 0.00025578495115041733, "kl": 0.015138514066347853, "entropy": 1.430587862059474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8212354735880302, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.949221273452517, "policy_loss": -0.0015498152076606712, "vf_loss": 9.946897896761616, "vf_explained_var": 0.0001915576596739431, "kl": 0.012910635895268233, "entropy": 1.2242691329547337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "env_runners": {"episode_reward_max": -83.67937964917911, "episode_reward_min": -9907.905789304747, "episode_reward_mean": -4684.550673115899, "episode_len_mean": 156.47, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15647, "policy_reward_min": {"agent_policy": 31.13485837049979, "adversary_policy": -9907.905789304745}, "policy_reward_max": {"agent_policy": 7834.580008793275, "adversary_policy": -31.13485837049979}, "policy_reward_mean": {"agent_policy": 2665.9581920103105, "adversary_policy": -3675.254432563105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7105.015227045601, -5459.98133646662, -7518.878049346474, -415.67980020100964, -8127.595065538472, -2069.5763443286965, -5015.942046832498, -7584.253273559848, -4822.765350910301, -5384.774192965438, -6511.469218726763, -3260.7241211251962, -3538.916721570842, -9728.160247732329, -6974.271210030526, -3437.1321586115455, -1769.518631941375, -2070.8831262078174, -5519.2927857451, -2398.8052632823587, -83.67937964917911, -2283.807773782333, -6349.627820123539, -9368.844298018306, -5368.5868900650385, -8260.98157739387, -6291.8020333606255, -770.1862921256361, -756.7553498084517, -8594.110976756037, -1406.8800844640496, -9881.599353685797, -2549.1372341067877, -7990.269140111398, -4899.2448368955775, -2297.4537214079155, -3449.8784176192758, -2843.749602599346, -6149.763157363556, -6514.962580087853, -867.6915477275871, -2760.287759459059, -3654.4687004032685, -7200.816755030174, -1879.408522616788, -4607.119529683006, -6915.520920768881, -451.3631610722025, -6235.212180881198, -384.37959968660573, -2092.2779504701057, -6928.396464983287, -2792.056352700858, -7684.467936051703, -3271.531287999769, -9907.905789304747, -2863.0081447463986, -4888.83365575687, -5609.941019773322, -7735.049888501838, -4075.2342344765834, -2966.587291911123, -5176.400643216931, -7479.516791081645, -2397.491882490719, -6074.345580244618, -7720.056838935981, -4758.085629631768, -4673.645770170778, -6930.934360730054, -2404.518020815299, -6270.808865382442, -6266.8995127985045, -8649.452711940376, -2873.1265906525505, -2169.7181830226086, -657.6725214887668, -4220.740644141336, -2619.7916666607416, -3613.014194871632, -3033.4132485064474, -4636.06730073621, -5690.658614118029, -5596.800447282634, -6892.979357852047, -3268.265724915495, -3650.997091263906, -3257.0845563899393, -5678.661955680438, -5431.301636397368, -3113.8633142552367, -3203.858102548216, -6419.884192630776, -1238.3878982817298, -1884.1948508671876, -7792.112870562485, -6783.106004305752, -4161.042261395441, -6646.721075112905, -4522.933014612177], "episode_lengths": [200, 200, 200, 41, 200, 70, 200, 200, 200, 189, 200, 139, 200, 200, 183, 200, 37, 99, 200, 135, 17, 137, 200, 200, 200, 200, 200, 51, 15, 200, 87, 200, 148, 200, 200, 200, 96, 127, 200, 200, 58, 113, 200, 200, 122, 200, 200, 45, 167, 11, 85, 200, 99, 200, 163, 200, 132, 200, 200, 200, 136, 111, 196, 200, 99, 200, 200, 200, 200, 200, 110, 200, 200, 200, 119, 119, 27, 191, 82, 136, 107, 200, 200, 200, 200, 111, 116, 135, 163, 200, 100, 129, 200, 96, 71, 200, 200, 144, 200, 183], "policy_agent_policy_reward": [1671.0956365657178, 3815.8960276711477, 3605.637978188943, 253.82536941108822, 3735.831352276539, 685.4036732255665, 2855.7847204798054, 3804.0764416741977, 2560.054538378976, 3246.8214435859927, 3371.201046089872, 2610.7175551430455, 2639.405900247228, 4191.093586917921, 2986.821052576122, 2100.4412034634306, 240.64862837946072, 975.9099608773575, 2576.311143200011, 1373.25252558378, 52.27118034851565, 1190.885334286153, 5683.851398282567, 7769.677104968205, 3293.455581792585, 7659.896661141908, 4452.10892693456, 556.8046765228119, 45.19905702323433, 2216.18907096728, 678.7628141843358, 7173.234567376747, 904.5961174239948, 3152.688848567916, 3626.350251403532, 1947.5924452625454, 960.2754883962251, 1527.909207036624, 4322.233175255876, 5322.406836109916, 254.32159679892507, 872.2278393085576, 1733.8086849455192, 3721.015144911547, 1280.2920326798358, 3830.9783789980543, 3180.426438666763, 397.961921424655, 2605.1045639505064, 31.13485837049979, 822.1696489994788, 2034.7415933287689, 1743.4317596288813, 2566.454479729829, 2331.135456024539, 7834.580008793275, 1942.6587808411489, 1542.7930623837194, 3607.7023243443705, 4934.629683214253, 2353.899507865197, 1106.4188360197243, 3122.2318253584376, 5016.505935099714, 1747.1878324154347, 2231.8521338497317, 3208.975403809284, 4043.810276240615, 3794.77025199246, 4152.495057087301, 1210.209090362162, 2639.120128208682, 4909.0500355055165, 7516.008115725621, 1900.4666892950142, 1811.458958789878, 264.15443421738627, 3496.5479010268873, 894.1210575547352, 2299.9531826921175, 2006.1704892760401, 2562.9927681397353, 3756.279109813434, 4194.346961799933, 5082.961794458943, 1620.6602518526415, 1715.6813801369258, 1358.3076757419456, 1833.6960794394806, 3738.385792031355, 1880.1981078148783, 1455.084580484321, 3561.6030266736707, 773.0352693384415, 503.78980214625636, 4535.316038640038, 3359.95594433451, 659.9030497475384, 2594.714369990991, 2579.3132714891963], "policy_adversary_policy_reward": [-7105.015227045601, -1671.0956365657178, -3950.313785325069, -5325.563578812696, -3605.637978188943, -7518.878049346475, -268.07264913229227, -401.4325204798059, -8127.595065538472, -3735.831352276539, -2069.5763443286965, -685.4036732255665, -5015.942046832499, -2855.7847204798054, -7513.067403807014, -3875.262311427032, -3377.954932668634, -4004.8649566206404, -3516.0097815198314, -5115.585855031603, -3529.9676155989996, -6352.702649217647, -3163.0831893788827, -2708.358486889359, -2710.7950124020813, -3467.52760941599, -9728.160247732329, -4191.093586917921, -2986.821052576122, -6974.271210030526, -2162.794363097183, -3374.778998977793, -1769.5186319413747, -240.64862837946072, -1900.9104711549292, -1145.8826159302469, -3095.3793087260065, -5000.224620219105, -1392.8101546999837, -2379.2476341661527, -78.95061150814264, -56.99994848955211, -1957.9499624042455, -1516.7431456642412, -6337.286853686108, -5696.19236472, -9368.844298018306, -7769.677104968205, -3396.2734409038594, -5265.769030953764, -8089.991340695385, -7830.886897840395, -5816.9546722931445, -4926.956288002038, -582.3668590324176, -744.6241096160302, -756.7553498084517, -45.19905702323433, -2314.4554333529927, -8495.844614370322, -1406.8800844640496, -678.7628141843358, -9881.599353685799, -7173.234567376747, -1191.4111697979524, -2262.3221817328294, -7990.269140111396, -3152.688848567916, -4819.224568385311, -3706.370519913799, -2081.927770907832, -2163.1183957626317, -978.6315684431355, -3431.522337572365, -2587.2158879440794, -1784.4429216918911, -6149.763157363557, -4322.233175255876, -5341.744262028497, -6495.625154169272, -254.32159679892507, -867.6915477275871, -872.2278393085576, -2760.287759459059, -3307.606416461467, -2080.670968887324, -4322.006508091321, -6599.825391850401, -1354.2823950361692, -1805.4181602604547, -4606.393314667993, -3831.704594013067, -4110.048478438379, -5985.898880997261, -430.2958969943462, -419.0291855025112, -6235.212180881197, -2605.1045639505064, -31.13485837049979, -384.37959968660573, -822.1696489994788, -2092.2779504701057, -2034.7415933287689, -6928.396464983287, -1743.4317596288813, -2792.056352700858, -2566.454479729829, -7684.467936051703, -2604.6191046086233, -2998.0476394156854, -7834.580008793275, -9907.905789304745, -1952.5654034124634, -2853.101522175084, -4760.581120269343, -1671.045597871253, -5609.083653183632, -3608.559690934061, -4934.629683214253, -7735.049888501838, -2562.5245840635584, -3866.6091582782224, -2966.5872919111225, -1106.4188360197243, -3122.2318253584376, -5176.400643216931, -5574.686433233447, -6921.3362929479135, -1749.0620882908245, -2395.6176266153293, -6074.345580244618, -2231.8521338497317, -7720.0568389359805, -3208.975403809284, -4070.3453379046696, -4731.550567967712, -3794.77025199246, -4673.645770170778, -4152.495057087301, -6930.934360730054, -2196.2885248238167, -1418.4385863536486, -2639.120128208682, -6270.808865382442, -6264.597120515728, -4911.352427788292, -7516.008115725621, -8649.452711940376, -1913.8769324360671, -2859.7163475114985, -1939.7434560734837, -2041.433685739005, -657.6725214887668, -264.15443421738627, -3983.842474868443, -3733.446070299777, -894.1210575547352, -2619.7916666607416, -3593.186680778388, -2319.7806967853617, -3028.4192195444807, -2011.164518238007, -4088.3039981249376, -3110.7560707509965, -4500.260989760506, -4946.676734170955, -5596.800447282634, -4194.346961799933, -6817.612883032313, -5158.328269278674, -3268.2657249154945, -1620.6602518526415, -1715.6813801369258, -3650.997091263906, -3257.0845563899393, -1358.3076757419456, -5678.661955680438, -1833.6960794394806, -3743.239527256846, -5426.447901171879, -1880.1981078148783, -3113.863314255236, -1455.084580484321, -3203.858102548216, -3561.6030266736707, -6419.884192630776, -773.0352693384415, -1238.38789828173, -1884.1948508671876, -503.78980214625636, -6730.535636041671, -5596.8932731608475, -3359.95594433451, -6783.106004305752, -4161.042261395441, -659.9030497475384, -2594.714369990991, -6646.721075112905, -3165.049441946092, -3937.1968441552835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41662384332922486, "mean_inference_ms": 1.007427846630192, "mean_action_processing_ms": 0.17410268174253812, "mean_env_wait_ms": 0.053106743159407103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003865480422973633, "StateBufferConnector_ms": 0.002888917922973633, "ViewRequirementAgentConnector_ms": 0.06686198711395264}, "num_episodes": 25, "episode_return_max": -83.67937964917911, "episode_return_min": -9907.905789304747, "episode_return_mean": -4684.550673115899}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.390016527512, "num_env_steps_trained_throughput_per_sec": 521.390016527512, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 7620.947, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7620.905, "sample_time_ms": 729.054, "learn_time_ms": 6877.284, "learn_throughput": 581.625, "synch_weights_time_ms": 14.031}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "training_iteration": 47, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-16", "timestamp": 1723231936, "time_this_iter_s": 7.6773340702056885, "time_total_s": 363.5906410217285, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.5906410217285, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 26.591666666666672, "ram_util_percent": 81.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9342496461545428, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.921307301521301, "policy_loss": -0.0047441740893797634, "vf_loss": 9.921333867311478, "vf_explained_var": 5.591033647457759e-05, "kl": 0.01397807950367375, "entropy": 1.4561167454967896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7878281146839813, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.961469244578527, "policy_loss": 0.0004409457017327585, "vf_loss": 9.957403331837327, "vf_explained_var": 5.3486622199810374e-05, "kl": 0.012083232961595058, "entropy": 1.2232929116203672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": -384.37959968660573, "episode_reward_min": -9907.905789304747, "episode_reward_mean": -4670.382746371431, "episode_len_mean": 159.32, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15932, "policy_reward_min": {"agent_policy": 31.13485837049979, "adversary_policy": -9907.905789304745}, "policy_reward_max": {"agent_policy": 7834.580008793275, "adversary_policy": -31.13485837049979}, "policy_reward_mean": {"agent_policy": 2681.370346957654, "adversary_policy": -3675.876546664542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5368.5868900650385, -8260.98157739387, -6291.8020333606255, -770.1862921256361, -756.7553498084517, -8594.110976756037, -1406.8800844640496, -9881.599353685797, -2549.1372341067877, -7990.269140111398, -4899.2448368955775, -2297.4537214079155, -3449.8784176192758, -2843.749602599346, -6149.763157363556, -6514.962580087853, -867.6915477275871, -2760.287759459059, -3654.4687004032685, -7200.816755030174, -1879.408522616788, -4607.119529683006, -6915.520920768881, -451.3631610722025, -6235.212180881198, -384.37959968660573, -2092.2779504701057, -6928.396464983287, -2792.056352700858, -7684.467936051703, -3271.531287999769, -9907.905789304747, -2863.0081447463986, -4888.83365575687, -5609.941019773322, -7735.049888501838, -4075.2342344765834, -2966.587291911123, -5176.400643216931, -7479.516791081645, -2397.491882490719, -6074.345580244618, -7720.056838935981, -4758.085629631768, -4673.645770170778, -6930.934360730054, -2404.518020815299, -6270.808865382442, -6266.8995127985045, -8649.452711940376, -2873.1265906525505, -2169.7181830226086, -657.6725214887668, -4220.740644141336, -2619.7916666607416, -3613.014194871632, -3033.4132485064474, -4636.06730073621, -5690.658614118029, -5596.800447282634, -6892.979357852047, -3268.265724915495, -3650.997091263906, -3257.0845563899393, -5678.661955680438, -5431.301636397368, -3113.8633142552367, -3203.858102548216, -6419.884192630776, -1238.3878982817298, -1884.1948508671876, -7792.112870562485, -6783.106004305752, -4161.042261395441, -6646.721075112905, -4522.933014612177, -3107.805748300591, -2328.4674445628493, -4045.461015051587, -6141.693796463585, -6369.990222742077, -6039.884129222291, -4915.311157141511, -2482.564774028449, -5821.294142392418, -7838.844579116197, -6966.4611458853515, -6286.180859923177, -1579.394145952056, -1498.1764526078987, -5529.924630844834, -4746.409887093624, -2382.8360745571426, -5421.972314991268, -4854.257976259256, -5418.050933151636, -5299.307764881465, -7207.081729620379, -7095.348142326793, -2006.0817021787977], "episode_lengths": [200, 200, 200, 51, 15, 200, 87, 200, 148, 200, 200, 200, 96, 127, 200, 200, 58, 113, 200, 200, 122, 200, 200, 45, 167, 11, 85, 200, 99, 200, 163, 200, 132, 200, 200, 200, 136, 111, 196, 200, 99, 200, 200, 200, 200, 200, 110, 200, 200, 200, 119, 119, 27, 191, 82, 136, 107, 200, 200, 200, 200, 111, 116, 135, 163, 200, 100, 129, 200, 96, 71, 200, 200, 144, 200, 183, 200, 137, 200, 200, 200, 180, 200, 97, 169, 200, 200, 200, 125, 88, 185, 200, 128, 200, 200, 152, 200, 200, 200, 71], "policy_agent_policy_reward": [3293.455581792585, 7659.896661141908, 4452.10892693456, 556.8046765228119, 45.19905702323433, 2216.18907096728, 678.7628141843358, 7173.234567376747, 904.5961174239948, 3152.688848567916, 3626.350251403532, 1947.5924452625454, 960.2754883962251, 1527.909207036624, 4322.233175255876, 5322.406836109916, 254.32159679892507, 872.2278393085576, 1733.8086849455192, 3721.015144911547, 1280.2920326798358, 3830.9783789980543, 3180.426438666763, 397.961921424655, 2605.1045639505064, 31.13485837049979, 822.1696489994788, 2034.7415933287689, 1743.4317596288813, 2566.454479729829, 2331.135456024539, 7834.580008793275, 1942.6587808411489, 1542.7930623837194, 3607.7023243443705, 4934.629683214253, 2353.899507865197, 1106.4188360197243, 3122.2318253584376, 5016.505935099714, 1747.1878324154347, 2231.8521338497317, 3208.975403809284, 4043.810276240615, 3794.77025199246, 4152.495057087301, 1210.209090362162, 2639.120128208682, 4909.0500355055165, 7516.008115725621, 1900.4666892950142, 1811.458958789878, 264.15443421738627, 3496.5479010268873, 894.1210575547352, 2299.9531826921175, 2006.1704892760401, 2562.9927681397353, 3756.279109813434, 4194.346961799933, 5082.961794458943, 1620.6602518526415, 1715.6813801369258, 1358.3076757419456, 1833.6960794394806, 3738.385792031355, 1880.1981078148783, 1455.084580484321, 3561.6030266736707, 773.0352693384415, 503.78980214625636, 4535.316038640038, 3359.95594433451, 659.9030497475384, 2594.714369990991, 2579.3132714891963, 2542.7236981879473, 1850.8751713522786, 2827.098857114039, 4505.190994441893, 3421.3845496756644, 3447.9806083712474, 3946.006975827052, 1511.0574105307603, 3807.8402030295997, 3830.424161460419, 1628.0556168857631, 3274.7466296306798, 879.1741151238524, 990.9035614438221, 1993.5355537803634, 2965.5809639360114, 1077.840012159012, 4531.99725720517, 1965.829289311588, 2343.3814476678513, 4290.966565538283, 5811.96776697124, 1585.9166456266796, 507.65224128481776], "policy_adversary_policy_reward": [-3396.2734409038594, -5265.769030953764, -8089.991340695385, -7830.886897840395, -5816.9546722931445, -4926.956288002038, -582.3668590324176, -744.6241096160302, -756.7553498084517, -45.19905702323433, -2314.4554333529927, -8495.844614370322, -1406.8800844640496, -678.7628141843358, -9881.599353685799, -7173.234567376747, -1191.4111697979524, -2262.3221817328294, -7990.269140111396, -3152.688848567916, -4819.224568385311, -3706.370519913799, -2081.927770907832, -2163.1183957626317, -978.6315684431355, -3431.522337572365, -2587.2158879440794, -1784.4429216918911, -6149.763157363557, -4322.233175255876, -5341.744262028497, -6495.625154169272, -254.32159679892507, -867.6915477275871, -872.2278393085576, -2760.287759459059, -3307.606416461467, -2080.670968887324, -4322.006508091321, -6599.825391850401, -1354.2823950361692, -1805.4181602604547, -4606.393314667993, -3831.704594013067, -4110.048478438379, -5985.898880997261, -430.2958969943462, -419.0291855025112, -6235.212180881197, -2605.1045639505064, -31.13485837049979, -384.37959968660573, -822.1696489994788, -2092.2779504701057, -2034.7415933287689, -6928.396464983287, -1743.4317596288813, -2792.056352700858, -2566.454479729829, -7684.467936051703, -2604.6191046086233, -2998.0476394156854, -7834.580008793275, -9907.905789304745, -1952.5654034124634, -2853.101522175084, -4760.581120269343, -1671.045597871253, -5609.083653183632, -3608.559690934061, -4934.629683214253, -7735.049888501838, -2562.5245840635584, -3866.6091582782224, -2966.5872919111225, -1106.4188360197243, -3122.2318253584376, -5176.400643216931, -5574.686433233447, -6921.3362929479135, -1749.0620882908245, -2395.6176266153293, -6074.345580244618, -2231.8521338497317, -7720.0568389359805, -3208.975403809284, -4070.3453379046696, -4731.550567967712, -3794.77025199246, -4673.645770170778, -4152.495057087301, -6930.934360730054, -2196.2885248238167, -1418.4385863536486, -2639.120128208682, -6270.808865382442, -6264.597120515728, -4911.352427788292, -7516.008115725621, -8649.452711940376, -1913.8769324360671, -2859.7163475114985, -1939.7434560734837, -2041.433685739005, -657.6725214887668, -264.15443421738627, -3983.842474868443, -3733.446070299777, -894.1210575547352, -2619.7916666607416, -3593.186680778388, -2319.7806967853617, -3028.4192195444807, -2011.164518238007, -4088.3039981249376, -3110.7560707509965, -4500.260989760506, -4946.676734170955, -5596.800447282634, -4194.346961799933, -6817.612883032313, -5158.328269278674, -3268.2657249154945, -1620.6602518526415, -1715.6813801369258, -3650.997091263906, -3257.0845563899393, -1358.3076757419456, -5678.661955680438, -1833.6960794394806, -3743.239527256846, -5426.447901171879, -1880.1981078148783, -3113.863314255236, -1455.084580484321, -3203.858102548216, -3561.6030266736707, -6419.884192630776, -773.0352693384415, -1238.38789828173, -1884.1948508671876, -503.78980214625636, -6730.535636041671, -5596.8932731608475, -3359.95594433451, -6783.106004305752, -4161.042261395441, -659.9030497475384, -2594.714369990991, -6646.721075112905, -3165.049441946092, -3937.1968441552835, -2852.5596130130907, -2797.969833475447, -2029.2321769568412, -2150.110438958287, -2942.4050291063795, -3930.154843059247, -5495.135770785198, -5151.74902012027, -5786.882569072714, -4004.4922033450257, -6039.884129222291, -3447.9806083712474, -4810.487551556019, -4050.8305814125442, -1511.0574105307603, -2482.564774028449, -3807.8402030295997, -5821.294142392418, -4334.367150463712, -7334.901590112912, -6966.4611458853515, -1628.0556168857631, -3274.7466296306798, -6286.180859923178, -907.1456657821491, -1551.422595293761, -1496.4745441412401, -992.6054699104806, -1993.5355537803634, -5529.924630844834, -4746.409887093623, -2965.5809639360114, -2382.8360745571426, -1077.840012159012, -5282.615595380457, -4671.353976815991, -2060.1895380477904, -4759.897727523054, -2524.787457837045, -5236.644922982444, -5211.23616346748, -4379.038166952273, -7205.904292772441, -5813.145203819176, -1585.9166456266796, -7095.348142326793, -2006.0817021787977, -507.65224128481776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4161243410160224, "mean_inference_ms": 1.007478031451711, "mean_action_processing_ms": 0.17400667489745633, "mean_env_wait_ms": 0.053012558708398105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038527250289916992, "StateBufferConnector_ms": 0.0028194189071655273, "ViewRequirementAgentConnector_ms": 0.0661020278930664}, "num_episodes": 24, "episode_return_max": -384.37959968660573, "episode_return_min": -9907.905789304747, "episode_return_mean": -4670.382746371431}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.0176514163413, "num_env_steps_trained_throughput_per_sec": 534.0176514163413, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 7610.2, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7610.159, "sample_time_ms": 736.991, "learn_time_ms": 6858.851, "learn_throughput": 583.188, "synch_weights_time_ms": 13.748}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 48, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-23", "timestamp": 1723231943, "time_this_iter_s": 7.495830059051514, "time_total_s": 371.08647108078003, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 371.08647108078003, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.42, "ram_util_percent": 81.01}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7744933070304493, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.912570386131604, "policy_loss": -0.0016820034424502714, "vf_loss": 9.90897569656372, "vf_explained_var": -0.00015069587777058284, "kl": 0.015634543433164557, "entropy": 1.4285859677940607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7733213293252799, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.954203607165624, "policy_loss": -0.005111829982084966, "vf_loss": 9.955515366508846, "vf_explained_var": 2.3789916719709124e-05, "kl": 0.012666968105942327, "entropy": 1.2250285250799997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "env_runners": {"episode_reward_max": -384.37959968660573, "episode_reward_min": -9907.905789304747, "episode_reward_mean": -4689.975337546832, "episode_len_mean": 157.72, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15772, "policy_reward_min": {"agent_policy": 31.13485837049979, "adversary_policy": -9907.905789304745}, "policy_reward_max": {"agent_policy": 7834.580008793275, "adversary_policy": -31.13485837049979}, "policy_reward_mean": {"agent_policy": 2619.7876196865986, "adversary_policy": -3654.881478616716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-384.37959968660573, -2092.2779504701057, -6928.396464983287, -2792.056352700858, -7684.467936051703, -3271.531287999769, -9907.905789304747, -2863.0081447463986, -4888.83365575687, -5609.941019773322, -7735.049888501838, -4075.2342344765834, -2966.587291911123, -5176.400643216931, -7479.516791081645, -2397.491882490719, -6074.345580244618, -7720.056838935981, -4758.085629631768, -4673.645770170778, -6930.934360730054, -2404.518020815299, -6270.808865382442, -6266.8995127985045, -8649.452711940376, -2873.1265906525505, -2169.7181830226086, -657.6725214887668, -4220.740644141336, -2619.7916666607416, -3613.014194871632, -3033.4132485064474, -4636.06730073621, -5690.658614118029, -5596.800447282634, -6892.979357852047, -3268.265724915495, -3650.997091263906, -3257.0845563899393, -5678.661955680438, -5431.301636397368, -3113.8633142552367, -3203.858102548216, -6419.884192630776, -1238.3878982817298, -1884.1948508671876, -7792.112870562485, -6783.106004305752, -4161.042261395441, -6646.721075112905, -4522.933014612177, -3107.805748300591, -2328.4674445628493, -4045.461015051587, -6141.693796463585, -6369.990222742077, -6039.884129222291, -4915.311157141511, -2482.564774028449, -5821.294142392418, -7838.844579116197, -6966.4611458853515, -6286.180859923177, -1579.394145952056, -1498.1764526078987, -5529.924630844834, -4746.409887093624, -2382.8360745571426, -5421.972314991268, -4854.257976259256, -5418.050933151636, -5299.307764881465, -7207.081729620379, -7095.348142326793, -2006.0817021787977, -1048.4396301389595, -3795.9160811952866, -3007.915679569785, -2991.1997380674193, -4313.480682152301, -2243.413423866944, -3626.5503221573035, -445.70191022695883, -6543.582041817535, -6447.229696517668, -2403.2841300420023, -4792.484386412717, -2307.27413696367, -7627.020839933909, -5638.567438364255, -4258.515220457558, -6216.99724533646, -3129.2339953355136, -2511.673836293857, -8825.832057365866, -3121.044770889511, -8526.961232515041, -4113.3145373036, -7669.558185640328, -8951.318224469213], "episode_lengths": [11, 85, 200, 99, 200, 163, 200, 132, 200, 200, 200, 136, 111, 196, 200, 99, 200, 200, 200, 200, 200, 110, 200, 200, 200, 119, 119, 27, 191, 82, 136, 107, 200, 200, 200, 200, 111, 116, 135, 163, 200, 100, 129, 200, 96, 71, 200, 200, 144, 200, 183, 200, 137, 200, 200, 200, 180, 200, 97, 169, 200, 200, 200, 125, 88, 185, 200, 128, 200, 200, 152, 200, 200, 200, 71, 28, 182, 65, 122, 140, 124, 124, 20, 200, 200, 108, 159, 68, 200, 200, 200, 200, 76, 119, 200, 200, 200, 134, 200, 200], "policy_agent_policy_reward": [31.13485837049979, 822.1696489994788, 2034.7415933287689, 1743.4317596288813, 2566.454479729829, 2331.135456024539, 7834.580008793275, 1942.6587808411489, 1542.7930623837194, 3607.7023243443705, 4934.629683214253, 2353.899507865197, 1106.4188360197243, 3122.2318253584376, 5016.505935099714, 1747.1878324154347, 2231.8521338497317, 3208.975403809284, 4043.810276240615, 3794.77025199246, 4152.495057087301, 1210.209090362162, 2639.120128208682, 4909.0500355055165, 7516.008115725621, 1900.4666892950142, 1811.458958789878, 264.15443421738627, 3496.5479010268873, 894.1210575547352, 2299.9531826921175, 2006.1704892760401, 2562.9927681397353, 3756.279109813434, 4194.346961799933, 5082.961794458943, 1620.6602518526415, 1715.6813801369258, 1358.3076757419456, 1833.6960794394806, 3738.385792031355, 1880.1981078148783, 1455.084580484321, 3561.6030266736707, 773.0352693384415, 503.78980214625636, 4535.316038640038, 3359.95594433451, 659.9030497475384, 2594.714369990991, 2579.3132714891963, 2542.7236981879473, 1850.8751713522786, 2827.098857114039, 4505.190994441893, 3421.3845496756644, 3447.9806083712474, 3946.006975827052, 1511.0574105307603, 3807.8402030295997, 3830.424161460419, 1628.0556168857631, 3274.7466296306798, 879.1741151238524, 990.9035614438221, 1993.5355537803634, 2965.5809639360114, 1077.840012159012, 4531.99725720517, 1965.829289311588, 2343.3814476678513, 4290.966565538283, 5811.96776697124, 1585.9166456266796, 507.65224128481776, 175.90078554285807, 1566.081625221817, 427.88886519224377, 1559.6274536516726, 1819.1991735611846, 1250.2855138087496, 2211.6808903654633, 70.18880718959021, 4015.636157128462, 4384.027449147261, 1311.4898142194215, 1709.95551108913, 712.0859108656964, 3864.159696733399, 2281.594926332785, 2233.3741304991636, 3285.256513423056, 445.2643878254717, 2044.0201637110392, 7682.953399785637, 1862.6977525436623, 5563.54384873172, 1365.7163785542082, 4289.159696900644, 3425.7787479545445], "policy_adversary_policy_reward": [-31.13485837049979, -384.37959968660573, -822.1696489994788, -2092.2779504701057, -2034.7415933287689, -6928.396464983287, -1743.4317596288813, -2792.056352700858, -2566.454479729829, -7684.467936051703, -2604.6191046086233, -2998.0476394156854, -7834.580008793275, -9907.905789304745, -1952.5654034124634, -2853.101522175084, -4760.581120269343, -1671.045597871253, -5609.083653183632, -3608.559690934061, -4934.629683214253, -7735.049888501838, -2562.5245840635584, -3866.6091582782224, -2966.5872919111225, -1106.4188360197243, -3122.2318253584376, -5176.400643216931, -5574.686433233447, -6921.3362929479135, -1749.0620882908245, -2395.6176266153293, -6074.345580244618, -2231.8521338497317, -7720.0568389359805, -3208.975403809284, -4070.3453379046696, -4731.550567967712, -3794.77025199246, -4673.645770170778, -4152.495057087301, -6930.934360730054, -2196.2885248238167, -1418.4385863536486, -2639.120128208682, -6270.808865382442, -6264.597120515728, -4911.352427788292, -7516.008115725621, -8649.452711940376, -1913.8769324360671, -2859.7163475114985, -1939.7434560734837, -2041.433685739005, -657.6725214887668, -264.15443421738627, -3983.842474868443, -3733.446070299777, -894.1210575547352, -2619.7916666607416, -3593.186680778388, -2319.7806967853617, -3028.4192195444807, -2011.164518238007, -4088.3039981249376, -3110.7560707509965, -4500.260989760506, -4946.676734170955, -5596.800447282634, -4194.346961799933, -6817.612883032313, -5158.328269278674, -3268.2657249154945, -1620.6602518526415, -1715.6813801369258, -3650.997091263906, -3257.0845563899393, -1358.3076757419456, -5678.661955680438, -1833.6960794394806, -3743.239527256846, -5426.447901171879, -1880.1981078148783, -3113.863314255236, -1455.084580484321, -3203.858102548216, -3561.6030266736707, -6419.884192630776, -773.0352693384415, -1238.38789828173, -1884.1948508671876, -503.78980214625636, -6730.535636041671, -5596.8932731608475, -3359.95594433451, -6783.106004305752, -4161.042261395441, -659.9030497475384, -2594.714369990991, -6646.721075112905, -3165.049441946092, -3937.1968441552835, -2852.5596130130907, -2797.969833475447, -2029.2321769568412, -2150.110438958287, -2942.4050291063795, -3930.154843059247, -5495.135770785198, -5151.74902012027, -5786.882569072714, -4004.4922033450257, -6039.884129222291, -3447.9806083712474, -4810.487551556019, -4050.8305814125442, -1511.0574105307603, -2482.564774028449, -3807.8402030295997, -5821.294142392418, -4334.367150463712, -7334.901590112912, -6966.4611458853515, -1628.0556168857631, -3274.7466296306798, -6286.180859923178, -907.1456657821491, -1551.422595293761, -1496.4745441412401, -992.6054699104806, -1993.5355537803634, -5529.924630844834, -4746.409887093623, -2965.5809639360114, -2382.8360745571426, -1077.840012159012, -5282.615595380457, -4671.353976815991, -2060.1895380477904, -4759.897727523054, -2524.787457837045, -5236.644922982444, -5211.23616346748, -4379.038166952273, -7205.904292772441, -5813.145203819176, -1585.9166456266796, -7095.348142326793, -2006.0817021787977, -507.65224128481776, -1048.4396301389593, -175.90078554285807, -2107.2996098141616, -3254.698096602941, -3007.9156795697854, -427.88886519224377, -1559.6274536516726, -2991.1997380674193, -1819.1991735611846, -4313.480682152301, -2067.156468012437, -1426.5424696632576, -2759.005636197236, -3079.225576325531, -445.7019102269589, -70.18880718959021, -6456.236787879988, -4102.981411066006, -6447.22969651767, -4384.027449147261, -1558.8482452258704, -2155.9256990355534, -1709.95551108913, -4792.484386412717, -2307.2741369636697, -712.0859108656964, -3864.159696733399, -7627.0208399339135, -2281.594926332785, -5638.567438364255, -3278.742137136215, -3213.1472138205045, -3285.256513423056, -6216.99724533646, -3129.233995335513, -445.2643878254717, -2475.7032532578546, -2079.990746747043, -7717.947174639285, -8790.838282512226, -2686.2740264602294, -2297.4684969729415, -5563.54384873172, -8526.961232515041, -1406.9612588188265, -4072.0696570389823, -5883.42427580446, -6075.2936067365135, -8912.84904667923, -3464.24792574453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155759927543949, "mean_inference_ms": 1.0074668360372392, "mean_action_processing_ms": 0.17385191320495338, "mean_env_wait_ms": 0.05295974549794193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004143834114074707, "StateBufferConnector_ms": 0.004197120666503906, "ViewRequirementAgentConnector_ms": 0.06887960433959961}, "num_episodes": 25, "episode_return_max": -384.37959968660573, "episode_return_min": -9907.905789304747, "episode_return_mean": -4689.975337546832}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.3269983038329, "num_env_steps_trained_throughput_per_sec": 525.3269983038329, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 7620.931, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7620.89, "sample_time_ms": 742.567, "learn_time_ms": 6863.876, "learn_throughput": 582.761, "synch_weights_time_ms": 13.837}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "training_iteration": 49, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-31", "timestamp": 1723231951, "time_this_iter_s": 7.619211912155151, "time_total_s": 378.7056829929352, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 378.7056829929352, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 26.381818181818186, "ram_util_percent": 81.27272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7675444147394349, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.94641061325868, "policy_loss": 0.005299374268603666, "vf_loss": 9.933211168646812, "vf_explained_var": -1.9870574275652566e-05, "kl": 0.023407678794076976, "entropy": 1.4055896309514841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7633635744610161, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.966401752593026, "policy_loss": -0.004185005531661094, "vf_loss": 9.966830035113784, "vf_explained_var": -8.794239589146205e-06, "kl": 0.012522387647971747, "entropy": 1.236290098750402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": -418.2673888316531, "episode_reward_min": -9114.51039528269, "episode_reward_mean": -4800.554429064157, "episode_len_mean": 159.53, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15953, "policy_reward_min": {"agent_policy": 70.18880718959021, "adversary_policy": -9114.51039528269}, "policy_reward_max": {"agent_policy": 8360.569808625276, "adversary_policy": -70.18880718959021}, "policy_reward_mean": {"agent_policy": 2754.6709937347227, "adversary_policy": -3777.6127113994407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8649.452711940376, -2873.1265906525505, -2169.7181830226086, -657.6725214887668, -4220.740644141336, -2619.7916666607416, -3613.014194871632, -3033.4132485064474, -4636.06730073621, -5690.658614118029, -5596.800447282634, -6892.979357852047, -3268.265724915495, -3650.997091263906, -3257.0845563899393, -5678.661955680438, -5431.301636397368, -3113.8633142552367, -3203.858102548216, -6419.884192630776, -1238.3878982817298, -1884.1948508671876, -7792.112870562485, -6783.106004305752, -4161.042261395441, -6646.721075112905, -4522.933014612177, -3107.805748300591, -2328.4674445628493, -4045.461015051587, -6141.693796463585, -6369.990222742077, -6039.884129222291, -4915.311157141511, -2482.564774028449, -5821.294142392418, -7838.844579116197, -6966.4611458853515, -6286.180859923177, -1579.394145952056, -1498.1764526078987, -5529.924630844834, -4746.409887093624, -2382.8360745571426, -5421.972314991268, -4854.257976259256, -5418.050933151636, -5299.307764881465, -7207.081729620379, -7095.348142326793, -2006.0817021787977, -1048.4396301389595, -3795.9160811952866, -3007.915679569785, -2991.1997380674193, -4313.480682152301, -2243.413423866944, -3626.5503221573035, -445.70191022695883, -6543.582041817535, -6447.229696517668, -2403.2841300420023, -4792.484386412717, -2307.27413696367, -7627.020839933909, -5638.567438364255, -4258.515220457558, -6216.99724533646, -3129.2339953355136, -2511.673836293857, -8825.832057365866, -3121.044770889511, -8526.961232515041, -4113.3145373036, -7669.558185640328, -8951.318224469213, -7616.384326437305, -5335.497813232564, -5549.377749082224, -7583.095998393008, -1929.935386208657, -5656.203363561688, -9073.795914803888, -7239.719859747041, -6860.166623492692, -418.2673888316531, -7126.653691931121, -5451.738043850699, -1564.1859516192767, -6769.118845522761, -7933.797209312802, -3678.1155278438437, -5803.125386992963, -9114.51039528269, -4163.048112090305, -1486.659674973882, -6044.893050691546, -7209.0446147327, -4592.929038314231, -4210.018696644946], "episode_lengths": [200, 119, 119, 27, 191, 82, 136, 107, 200, 200, 200, 200, 111, 116, 135, 163, 200, 100, 129, 200, 96, 71, 200, 200, 144, 200, 183, 200, 137, 200, 200, 200, 180, 200, 97, 169, 200, 200, 200, 125, 88, 185, 200, 128, 200, 200, 152, 200, 200, 200, 71, 28, 182, 65, 122, 140, 124, 124, 20, 200, 200, 108, 159, 68, 200, 200, 200, 200, 76, 119, 200, 200, 200, 134, 200, 200, 200, 191, 200, 200, 153, 200, 200, 200, 200, 33, 200, 180, 66, 200, 200, 126, 200, 200, 200, 123, 200, 151, 151, 149], "policy_agent_policy_reward": [7516.008115725621, 1900.4666892950142, 1811.458958789878, 264.15443421738627, 3496.5479010268873, 894.1210575547352, 2299.9531826921175, 2006.1704892760401, 2562.9927681397353, 3756.279109813434, 4194.346961799933, 5082.961794458943, 1620.6602518526415, 1715.6813801369258, 1358.3076757419456, 1833.6960794394806, 3738.385792031355, 1880.1981078148783, 1455.084580484321, 3561.6030266736707, 773.0352693384415, 503.78980214625636, 4535.316038640038, 3359.95594433451, 659.9030497475384, 2594.714369990991, 2579.3132714891963, 2542.7236981879473, 1850.8751713522786, 2827.098857114039, 4505.190994441893, 3421.3845496756644, 3447.9806083712474, 3946.006975827052, 1511.0574105307603, 3807.8402030295997, 3830.424161460419, 1628.0556168857631, 3274.7466296306798, 879.1741151238524, 990.9035614438221, 1993.5355537803634, 2965.5809639360114, 1077.840012159012, 4531.99725720517, 1965.829289311588, 2343.3814476678513, 4290.966565538283, 5811.96776697124, 1585.9166456266796, 507.65224128481776, 175.90078554285807, 1566.081625221817, 427.88886519224377, 1559.6274536516726, 1819.1991735611846, 1250.2855138087496, 2211.6808903654633, 70.18880718959021, 4015.636157128462, 4384.027449147261, 1311.4898142194215, 1709.95551108913, 712.0859108656964, 3864.159696733399, 2281.594926332785, 2233.3741304991636, 3285.256513423056, 445.2643878254717, 2044.0201637110392, 7682.953399785637, 1862.6977525436623, 5563.54384873172, 1365.7163785542082, 4289.159696900644, 3425.7787479545445, 6856.905087769057, 1539.191078493144, 2894.2290215409143, 6667.709820389802, 1428.404617149666, 1525.2301526853096, 8360.569808625276, 4216.204336519237, 4400.6350922777, 152.7125526169303, 6726.0774201764525, 2853.0579710060774, 262.4007047186064, 3176.4082778173374, 4689.692975335296, 2250.1329156979286, 3573.9587394364416, 4929.83150785935, 1944.8465370677643, 1169.0685944733468, 4152.158296861339, 3770.494029746826, 1916.8864256003787, 2959.4894104213117], "policy_adversary_policy_reward": [-7516.008115725621, -8649.452711940376, -1913.8769324360671, -2859.7163475114985, -1939.7434560734837, -2041.433685739005, -657.6725214887668, -264.15443421738627, -3983.842474868443, -3733.446070299777, -894.1210575547352, -2619.7916666607416, -3593.186680778388, -2319.7806967853617, -3028.4192195444807, -2011.164518238007, -4088.3039981249376, -3110.7560707509965, -4500.260989760506, -4946.676734170955, -5596.800447282634, -4194.346961799933, -6817.612883032313, -5158.328269278674, -3268.2657249154945, -1620.6602518526415, -1715.6813801369258, -3650.997091263906, -3257.0845563899393, -1358.3076757419456, -5678.661955680438, -1833.6960794394806, -3743.239527256846, -5426.447901171879, -1880.1981078148783, -3113.863314255236, -1455.084580484321, -3203.858102548216, -3561.6030266736707, -6419.884192630776, -773.0352693384415, -1238.38789828173, -1884.1948508671876, -503.78980214625636, -6730.535636041671, -5596.8932731608475, -3359.95594433451, -6783.106004305752, -4161.042261395441, -659.9030497475384, -2594.714369990991, -6646.721075112905, -3165.049441946092, -3937.1968441552835, -2852.5596130130907, -2797.969833475447, -2029.2321769568412, -2150.110438958287, -2942.4050291063795, -3930.154843059247, -5495.135770785198, -5151.74902012027, -5786.882569072714, -4004.4922033450257, -6039.884129222291, -3447.9806083712474, -4810.487551556019, -4050.8305814125442, -1511.0574105307603, -2482.564774028449, -3807.8402030295997, -5821.294142392418, -4334.367150463712, -7334.901590112912, -6966.4611458853515, -1628.0556168857631, -3274.7466296306798, -6286.180859923178, -907.1456657821491, -1551.422595293761, -1496.4745441412401, -992.6054699104806, -1993.5355537803634, -5529.924630844834, -4746.409887093623, -2965.5809639360114, -2382.8360745571426, -1077.840012159012, -5282.615595380457, -4671.353976815991, -2060.1895380477904, -4759.897727523054, -2524.787457837045, -5236.644922982444, -5211.23616346748, -4379.038166952273, -7205.904292772441, -5813.145203819176, -1585.9166456266796, -7095.348142326793, -2006.0817021787977, -507.65224128481776, -1048.4396301389593, -175.90078554285807, -2107.2996098141616, -3254.698096602941, -3007.9156795697854, -427.88886519224377, -1559.6274536516726, -2991.1997380674193, -1819.1991735611846, -4313.480682152301, -2067.156468012437, -1426.5424696632576, -2759.005636197236, -3079.225576325531, -445.7019102269589, -70.18880718959021, -6456.236787879988, -4102.981411066006, -6447.22969651767, -4384.027449147261, -1558.8482452258704, -2155.9256990355534, -1709.95551108913, -4792.484386412717, -2307.2741369636697, -712.0859108656964, -3864.159696733399, -7627.0208399339135, -2281.594926332785, -5638.567438364255, -3278.742137136215, -3213.1472138205045, -3285.256513423056, -6216.99724533646, -3129.233995335513, -445.2643878254717, -2475.7032532578546, -2079.990746747043, -7717.947174639285, -8790.838282512226, -2686.2740264602294, -2297.4684969729415, -5563.54384873172, -8526.961232515041, -1406.9612588188265, -4072.0696570389823, -5883.42427580446, -6075.2936067365135, -8912.84904667923, -3464.24792574453, -7504.698695021877, -6968.590719184484, -1539.191078493144, -5335.497813232564, -2894.2290215409143, -5549.377749082225, -7450.966223816096, -6799.839594966714, -1578.735909340071, -1779.6040940182509, -1882.941594854449, -5298.491921392554, -8805.161854562964, -8629.2038688662, -4242.61115559046, -7213.313040675818, -4591.834180005293, -6668.967535765099, -418.2673888316532, -152.7125526169303, -7066.853427295451, -6785.8776848121215, -5451.738043850698, -2853.0579710060774, -262.4007047186064, -1564.1859516192767, -6475.7495421914755, -3469.777581148608, -7655.467422100515, -4968.022762547582, -3678.1155278438437, -2250.1329156979286, -3896.9458488417044, -5480.138277587701, -9114.51039528269, -4929.83150785935, -1944.8465370677643, -4163.048112090305, -1423.5013722211677, -1232.2268972260615, -4341.474241508669, -5855.577106044218, -7163.593296603286, -3815.945347876239, -4011.8819109011897, -2497.9335530134235, -4208.385803543842, -2961.1223035224175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4153917893001332, "mean_inference_ms": 1.0071132039532904, "mean_action_processing_ms": 0.17377479098944526, "mean_env_wait_ms": 0.05289649547923186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041844844818115234, "StateBufferConnector_ms": 0.004189491271972656, "ViewRequirementAgentConnector_ms": 0.06894171237945557}, "num_episodes": 24, "episode_return_max": -418.2673888316531, "episode_return_min": -9114.51039528269, "episode_return_mean": -4800.554429064157}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.8147437421811, "num_env_steps_trained_throughput_per_sec": 552.8147437421811, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 7603.609, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7603.568, "sample_time_ms": 734.344, "learn_time_ms": 6854.803, "learn_throughput": 583.532, "synch_weights_time_ms": 13.812}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 50, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-39", "timestamp": 1723231959, "time_this_iter_s": 7.240227937698364, "time_total_s": 385.94591093063354, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327aaf1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 385.94591093063354, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 23.700000000000003, "ram_util_percent": 81.58181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8812245909435054, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.905855077505112, "policy_loss": -0.004682391729390171, "vf_loss": 9.906227264801661, "vf_explained_var": -0.00013780662169059118, "kl": 0.008514009123609867, "entropy": 1.4077677755306164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8190873023851839, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.947337475529423, "policy_loss": -0.006141996655918697, "vf_loss": 9.948168732880285, "vf_explained_var": 0.00013474080928419, "kl": 0.017702485792949873, "entropy": 1.2103919947588886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "env_runners": {"episode_reward_max": -387.68817939607953, "episode_reward_min": -9114.51039528269, "episode_reward_mean": -4903.627423971582, "episode_len_mean": 158.47, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 15847, "policy_reward_min": {"agent_policy": 70.18880718959021, "adversary_policy": -9114.51039528269}, "policy_reward_max": {"agent_policy": 8360.569808625276, "adversary_policy": -70.18880718959021}, "policy_reward_mean": {"agent_policy": 2829.071440197287, "adversary_policy": -3866.3494320844347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2328.4674445628493, -4045.461015051587, -6141.693796463585, -6369.990222742077, -6039.884129222291, -4915.311157141511, -2482.564774028449, -5821.294142392418, -7838.844579116197, -6966.4611458853515, -6286.180859923177, -1579.394145952056, -1498.1764526078987, -5529.924630844834, -4746.409887093624, -2382.8360745571426, -5421.972314991268, -4854.257976259256, -5418.050933151636, -5299.307764881465, -7207.081729620379, -7095.348142326793, -2006.0817021787977, -1048.4396301389595, -3795.9160811952866, -3007.915679569785, -2991.1997380674193, -4313.480682152301, -2243.413423866944, -3626.5503221573035, -445.70191022695883, -6543.582041817535, -6447.229696517668, -2403.2841300420023, -4792.484386412717, -2307.27413696367, -7627.020839933909, -5638.567438364255, -4258.515220457558, -6216.99724533646, -3129.2339953355136, -2511.673836293857, -8825.832057365866, -3121.044770889511, -8526.961232515041, -4113.3145373036, -7669.558185640328, -8951.318224469213, -7616.384326437305, -5335.497813232564, -5549.377749082224, -7583.095998393008, -1929.935386208657, -5656.203363561688, -9073.795914803888, -7239.719859747041, -6860.166623492692, -418.2673888316531, -7126.653691931121, -5451.738043850699, -1564.1859516192767, -6769.118845522761, -7933.797209312802, -3678.1155278438437, -5803.125386992963, -9114.51039528269, -4163.048112090305, -1486.659674973882, -6044.893050691546, -7209.0446147327, -4592.929038314231, -4210.018696644946, -7860.80063325964, -6429.937046579764, -8469.465069436998, -1598.912251223548, -2333.762480944261, -8170.550745866928, -5127.675072660337, -8416.504955093684, -4790.2663275340865, -2260.6048760816875, -8476.934442097801, -4666.294139136295, -2240.586499979663, -4010.6625177058077, -3178.797334072416, -387.68817939607953, -3181.6279194686285, -6407.858521911045, -8212.554668502125, -2813.6005130592657, -3094.2001942039833, -977.8031142576009, -6142.142219106029, -8254.6420817453, -873.324469933802, -7148.6204268071415, -3044.303200075915, -2550.8353693955237], "episode_lengths": [137, 200, 200, 200, 180, 200, 97, 169, 200, 200, 200, 125, 88, 185, 200, 128, 200, 200, 152, 200, 200, 200, 71, 28, 182, 65, 122, 140, 124, 124, 20, 200, 200, 108, 159, 68, 200, 200, 200, 200, 76, 119, 200, 200, 200, 134, 200, 200, 200, 191, 200, 200, 153, 200, 200, 200, 200, 33, 200, 180, 66, 200, 200, 126, 200, 200, 200, 123, 200, 151, 151, 149, 200, 200, 200, 92, 91, 200, 200, 200, 200, 97, 200, 129, 56, 139, 129, 38, 93, 200, 200, 82, 89, 62, 200, 200, 135, 200, 182, 109], "policy_agent_policy_reward": [1850.8751713522786, 2827.098857114039, 4505.190994441893, 3421.3845496756644, 3447.9806083712474, 3946.006975827052, 1511.0574105307603, 3807.8402030295997, 3830.424161460419, 1628.0556168857631, 3274.7466296306798, 879.1741151238524, 990.9035614438221, 1993.5355537803634, 2965.5809639360114, 1077.840012159012, 4531.99725720517, 1965.829289311588, 2343.3814476678513, 4290.966565538283, 5811.96776697124, 1585.9166456266796, 507.65224128481776, 175.90078554285807, 1566.081625221817, 427.88886519224377, 1559.6274536516726, 1819.1991735611846, 1250.2855138087496, 2211.6808903654633, 70.18880718959021, 4015.636157128462, 4384.027449147261, 1311.4898142194215, 1709.95551108913, 712.0859108656964, 3864.159696733399, 2281.594926332785, 2233.3741304991636, 3285.256513423056, 445.2643878254717, 2044.0201637110392, 7682.953399785637, 1862.6977525436623, 5563.54384873172, 1365.7163785542082, 4289.159696900644, 3425.7787479545445, 6856.905087769057, 1539.191078493144, 2894.2290215409143, 6667.709820389802, 1428.404617149666, 1525.2301526853096, 8360.569808625276, 4216.204336519237, 4400.6350922777, 152.7125526169303, 6726.0774201764525, 2853.0579710060774, 262.4007047186064, 3176.4082778173374, 4689.692975335296, 2250.1329156979286, 3573.9587394364416, 4929.83150785935, 1944.8465370677643, 1169.0685944733468, 4152.158296861339, 3770.494029746826, 1916.8864256003787, 2959.4894104213117, 7082.212733258104, 5766.737342287573, 5581.631707615753, 1358.280988027934, 930.9213181805372, 1642.5270613781795, 3975.7679726550496, 3901.008197916607, 3002.937421786899, 901.7142570450543, 3624.830144616908, 1365.4941591410336, 267.4039210105725, 2181.5637031582746, 1359.25714979652, 146.88103881236628, 1173.6258046947582, 4879.027659762147, 6922.560160951898, 749.6680784888572, 1212.4481297877555, 602.2304053228136, 3737.2328281763776, 4344.915507774313, 776.4941151766621, 6386.077126721187, 2504.263275315854, 1560.1622382362148], "policy_adversary_policy_reward": [-2029.2321769568412, -2150.110438958287, -2942.4050291063795, -3930.154843059247, -5495.135770785198, -5151.74902012027, -5786.882569072714, -4004.4922033450257, -6039.884129222291, -3447.9806083712474, -4810.487551556019, -4050.8305814125442, -1511.0574105307603, -2482.564774028449, -3807.8402030295997, -5821.294142392418, -4334.367150463712, -7334.901590112912, -6966.4611458853515, -1628.0556168857631, -3274.7466296306798, -6286.180859923178, -907.1456657821491, -1551.422595293761, -1496.4745441412401, -992.6054699104806, -1993.5355537803634, -5529.924630844834, -4746.409887093623, -2965.5809639360114, -2382.8360745571426, -1077.840012159012, -5282.615595380457, -4671.353976815991, -2060.1895380477904, -4759.897727523054, -2524.787457837045, -5236.644922982444, -5211.23616346748, -4379.038166952273, -7205.904292772441, -5813.145203819176, -1585.9166456266796, -7095.348142326793, -2006.0817021787977, -507.65224128481776, -1048.4396301389593, -175.90078554285807, -2107.2996098141616, -3254.698096602941, -3007.9156795697854, -427.88886519224377, -1559.6274536516726, -2991.1997380674193, -1819.1991735611846, -4313.480682152301, -2067.156468012437, -1426.5424696632576, -2759.005636197236, -3079.225576325531, -445.7019102269589, -70.18880718959021, -6456.236787879988, -4102.981411066006, -6447.22969651767, -4384.027449147261, -1558.8482452258704, -2155.9256990355534, -1709.95551108913, -4792.484386412717, -2307.2741369636697, -712.0859108656964, -3864.159696733399, -7627.0208399339135, -2281.594926332785, -5638.567438364255, -3278.742137136215, -3213.1472138205045, -3285.256513423056, -6216.99724533646, -3129.233995335513, -445.2643878254717, -2475.7032532578546, -2079.990746747043, -7717.947174639285, -8790.838282512226, -2686.2740264602294, -2297.4684969729415, -5563.54384873172, -8526.961232515041, -1406.9612588188265, -4072.0696570389823, -5883.42427580446, -6075.2936067365135, -8912.84904667923, -3464.24792574453, -7504.698695021877, -6968.590719184484, -1539.191078493144, -5335.497813232564, -2894.2290215409143, -5549.377749082225, -7450.966223816096, -6799.839594966714, -1578.735909340071, -1779.6040940182509, -1882.941594854449, -5298.491921392554, -8805.161854562964, -8629.2038688662, -4242.61115559046, -7213.313040675818, -4591.834180005293, -6668.967535765099, -418.2673888316532, -152.7125526169303, -7066.853427295451, -6785.8776848121215, -5451.738043850698, -2853.0579710060774, -262.4007047186064, -1564.1859516192767, -6475.7495421914755, -3469.777581148608, -7655.467422100515, -4968.022762547582, -3678.1155278438437, -2250.1329156979286, -3896.9458488417044, -5480.138277587701, -9114.51039528269, -4929.83150785935, -1944.8465370677643, -4163.048112090305, -1423.5013722211677, -1232.2268972260615, -4341.474241508669, -5855.577106044218, -7163.593296603286, -3815.945347876239, -4011.8819109011897, -2497.9335530134235, -4208.385803543842, -2961.1223035224175, -7528.569564298415, -7414.443802219328, -5799.294490479498, -6397.3798983878405, -8469.465069436998, -5581.631707615753, -1596.6878501730505, -1360.5053890784309, -980.5583079551755, -2284.125491169623, -8170.550745866929, -1642.5270613781795, -4103.463280808858, -4999.979764506528, -3901.008197916607, -8416.504955093684, -3291.735479675497, -4501.468269645487, -901.7142570450543, -2260.6048760816875, -8476.934442097801, -3624.830144616908, -1384.0356805052352, -4647.752617772094, -267.4039210105725, -2240.586499979663, -2456.1670898790107, -3736.05913098507, -3178.797334072417, -1359.25714979652, -146.88103881236628, -387.68817939607953, -1173.6258046947582, -3181.6279194686285, -4879.027659762147, -6407.858521911045, -7921.507559218089, -7213.607270235939, -749.6680784888572, -2813.6005130592657, -1212.4481297877555, -3094.2001942039833, -602.2304053228136, -977.8031142576009, -5070.222044299002, -4809.153002983401, -8254.642081745298, -4344.915507774313, -855.9659680979753, -793.8526170124888, -7103.502325599685, -6431.195227928643, -2700.0375802368903, -2848.528895154881, -2183.622898783893, -1927.3747088478456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41490865073170335, "mean_inference_ms": 1.0047114826176828, "mean_action_processing_ms": 0.17356032805232968, "mean_env_wait_ms": 0.05280834344000959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035932064056396484, "StateBufferConnector_ms": 0.004207253456115723, "ViewRequirementAgentConnector_ms": 0.06959915161132812}, "num_episodes": 28, "episode_return_max": -387.68817939607953, "episode_return_min": -9114.51039528269, "episode_return_mean": -4903.627423971582}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.6314531694412, "num_env_steps_trained_throughput_per_sec": 533.6314531694412, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 7577.597, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7577.556, "sample_time_ms": 736.83, "learn_time_ms": 6826.399, "learn_throughput": 585.96, "synch_weights_time_ms": 13.78}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "training_iteration": 51, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-46", "timestamp": 1723231966, "time_this_iter_s": 7.501504898071289, "time_total_s": 393.44741582870483, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edb1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 393.44741582870483, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.263636363636362, "ram_util_percent": 81.66363636363639}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.812930240140607, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.888708422581354, "policy_loss": 0.0037008114833345946, "vf_loss": 9.878603027264278, "vf_explained_var": -0.0001422213390469551, "kl": 0.012651007758783332, "entropy": 1.419088053330779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9431384197460911, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.940920568900134, "policy_loss": 0.004450309136143279, "vf_loss": 9.931807953466183, "vf_explained_var": 3.227670356710121e-05, "kl": 0.015541033444817734, "entropy": 1.166926688239688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": -387.68817939607953, "episode_reward_min": -10478.78197729299, "episode_reward_mean": -4954.322892183921, "episode_len_mean": 155.11, "episode_media": {}, "episodes_this_iter": 29, "episodes_timesteps_total": 15511, "policy_reward_min": {"agent_policy": 70.18880718959021, "adversary_policy": -10404.788029551433}, "policy_reward_max": {"agent_policy": 8963.90242602225, "adversary_policy": -70.18880718959021}, "policy_reward_mean": {"agent_policy": 2960.510438338521, "adversary_policy": -3957.416665261221}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3626.5503221573035, -445.70191022695883, -6543.582041817535, -6447.229696517668, -2403.2841300420023, -4792.484386412717, -2307.27413696367, -7627.020839933909, -5638.567438364255, -4258.515220457558, -6216.99724533646, -3129.2339953355136, -2511.673836293857, -8825.832057365866, -3121.044770889511, -8526.961232515041, -4113.3145373036, -7669.558185640328, -8951.318224469213, -7616.384326437305, -5335.497813232564, -5549.377749082224, -7583.095998393008, -1929.935386208657, -5656.203363561688, -9073.795914803888, -7239.719859747041, -6860.166623492692, -418.2673888316531, -7126.653691931121, -5451.738043850699, -1564.1859516192767, -6769.118845522761, -7933.797209312802, -3678.1155278438437, -5803.125386992963, -9114.51039528269, -4163.048112090305, -1486.659674973882, -6044.893050691546, -7209.0446147327, -4592.929038314231, -4210.018696644946, -7860.80063325964, -6429.937046579764, -8469.465069436998, -1598.912251223548, -2333.762480944261, -8170.550745866928, -5127.675072660337, -8416.504955093684, -4790.2663275340865, -2260.6048760816875, -8476.934442097801, -4666.294139136295, -2240.586499979663, -4010.6625177058077, -3178.797334072416, -387.68817939607953, -3181.6279194686285, -6407.858521911045, -8212.554668502125, -2813.6005130592657, -3094.2001942039833, -977.8031142576009, -6142.142219106029, -8254.6420817453, -873.324469933802, -7148.6204268071415, -3044.303200075915, -2550.8353693955237, -5787.284834214558, -2481.45556813122, -4566.38729190889, -4253.352611562292, -1160.6767151323636, -2564.760852922653, -7499.961282666095, -1351.900763847528, -583.5837879787701, -5161.76906007878, -5311.193916767802, -4374.57046685175, -3798.0037204582663, -7851.104050344906, -8117.026833370851, -8083.949432010808, -1942.2182173390868, -8100.5569157819, -4649.456493092797, -1163.1468274918805, -9010.093167820909, -2827.736299836565, -1259.310677011595, -8015.814573975815, -10478.78197729299, -3820.2547187346595, -4897.75315145329, -3043.666876080575, -2589.1359930597287], "episode_lengths": [124, 20, 200, 200, 108, 159, 68, 200, 200, 200, 200, 76, 119, 200, 200, 200, 134, 200, 200, 200, 191, 200, 200, 153, 200, 200, 200, 200, 33, 200, 180, 66, 200, 200, 126, 200, 200, 200, 123, 200, 151, 151, 149, 200, 200, 200, 92, 91, 200, 200, 200, 200, 97, 200, 129, 56, 139, 129, 38, 93, 200, 200, 82, 89, 62, 200, 200, 135, 200, 182, 109, 200, 113, 196, 109, 38, 128, 200, 95, 40, 188, 200, 131, 90, 193, 200, 200, 71, 200, 136, 101, 200, 78, 87, 200, 200, 186, 200, 107, 170], "policy_agent_policy_reward": [2211.6808903654633, 70.18880718959021, 4015.636157128462, 4384.027449147261, 1311.4898142194215, 1709.95551108913, 712.0859108656964, 3864.159696733399, 2281.594926332785, 2233.3741304991636, 3285.256513423056, 445.2643878254717, 2044.0201637110392, 7682.953399785637, 1862.6977525436623, 5563.54384873172, 1365.7163785542082, 4289.159696900644, 3425.7787479545445, 6856.905087769057, 1539.191078493144, 2894.2290215409143, 6667.709820389802, 1428.404617149666, 1525.2301526853096, 8360.569808625276, 4216.204336519237, 4400.6350922777, 152.7125526169303, 6726.0774201764525, 2853.0579710060774, 262.4007047186064, 3176.4082778173374, 4689.692975335296, 2250.1329156979286, 3573.9587394364416, 4929.83150785935, 1944.8465370677643, 1169.0685944733468, 4152.158296861339, 3770.494029746826, 1916.8864256003787, 2959.4894104213117, 7082.212733258104, 5766.737342287573, 5581.631707615753, 1358.280988027934, 930.9213181805372, 1642.5270613781795, 3975.7679726550496, 3901.008197916607, 3002.937421786899, 901.7142570450543, 3624.830144616908, 1365.4941591410336, 267.4039210105725, 2181.5637031582746, 1359.25714979652, 146.88103881236628, 1173.6258046947582, 4879.027659762147, 6922.560160951898, 749.6680784888572, 1212.4481297877555, 602.2304053228136, 3737.2328281763776, 4344.915507774313, 776.4941151766621, 6386.077126721187, 2504.263275315854, 1560.1622382362148, 2927.5795858495685, 1382.9604650611184, 2695.8663468992077, 1210.5198189869996, 334.33173659776537, 1132.785370661672, 4451.175046761757, 1206.591171226696, 189.97343031533197, 3046.0537038319435, 4262.568690904478, 1626.673662695501, 982.688408600908, 3805.0718402841944, 7096.447602467933, 5551.3677063214, 839.3837316987574, 6302.819917013166, 2073.366392313813, 894.059929972255, 5528.128166612737, 658.3153307182331, 1087.0229885250553, 7490.875134789429, 8963.90242602225, 1997.08306352651, 2188.0205051025273, 924.3534749691314, 2088.3041807398026], "policy_adversary_policy_reward": [-2759.005636197236, -3079.225576325531, -445.7019102269589, -70.18880718959021, -6456.236787879988, -4102.981411066006, -6447.22969651767, -4384.027449147261, -1558.8482452258704, -2155.9256990355534, -1709.95551108913, -4792.484386412717, -2307.2741369636697, -712.0859108656964, -3864.159696733399, -7627.0208399339135, -2281.594926332785, -5638.567438364255, -3278.742137136215, -3213.1472138205045, -3285.256513423056, -6216.99724533646, -3129.233995335513, -445.2643878254717, -2475.7032532578546, -2079.990746747043, -7717.947174639285, -8790.838282512226, -2686.2740264602294, -2297.4684969729415, -5563.54384873172, -8526.961232515041, -1406.9612588188265, -4072.0696570389823, -5883.42427580446, -6075.2936067365135, -8912.84904667923, -3464.24792574453, -7504.698695021877, -6968.590719184484, -1539.191078493144, -5335.497813232564, -2894.2290215409143, -5549.377749082225, -7450.966223816096, -6799.839594966714, -1578.735909340071, -1779.6040940182509, -1882.941594854449, -5298.491921392554, -8805.161854562964, -8629.2038688662, -4242.61115559046, -7213.313040675818, -4591.834180005293, -6668.967535765099, -418.2673888316532, -152.7125526169303, -7066.853427295451, -6785.8776848121215, -5451.738043850698, -2853.0579710060774, -262.4007047186064, -1564.1859516192767, -6475.7495421914755, -3469.777581148608, -7655.467422100515, -4968.022762547582, -3678.1155278438437, -2250.1329156979286, -3896.9458488417044, -5480.138277587701, -9114.51039528269, -4929.83150785935, -1944.8465370677643, -4163.048112090305, -1423.5013722211677, -1232.2268972260615, -4341.474241508669, -5855.577106044218, -7163.593296603286, -3815.945347876239, -4011.8819109011897, -2497.9335530134235, -4208.385803543842, -2961.1223035224175, -7528.569564298415, -7414.443802219328, -5799.294490479498, -6397.3798983878405, -8469.465069436998, -5581.631707615753, -1596.6878501730505, -1360.5053890784309, -980.5583079551755, -2284.125491169623, -8170.550745866929, -1642.5270613781795, -4103.463280808858, -4999.979764506528, -3901.008197916607, -8416.504955093684, -3291.735479675497, -4501.468269645487, -901.7142570450543, -2260.6048760816875, -8476.934442097801, -3624.830144616908, -1384.0356805052352, -4647.752617772094, -267.4039210105725, -2240.586499979663, -2456.1670898790107, -3736.05913098507, -3178.797334072417, -1359.25714979652, -146.88103881236628, -387.68817939607953, -1173.6258046947582, -3181.6279194686285, -4879.027659762147, -6407.858521911045, -7921.507559218089, -7213.607270235939, -749.6680784888572, -2813.6005130592657, -1212.4481297877555, -3094.2001942039833, -602.2304053228136, -977.8031142576009, -5070.222044299002, -4809.153002983401, -8254.642081745298, -4344.915507774313, -855.9659680979753, -793.8526170124888, -7103.502325599685, -6431.195227928643, -2700.0375802368903, -2848.528895154881, -2183.622898783893, -1927.3747088478456, -3611.969288803237, -5102.8951312608915, -1382.9604650611184, -2481.45556813122, -4035.508361367074, -3226.745277441029, -1210.5198189869996, -4253.352611562292, -1160.6767151323634, -334.33173659776537, -1149.8307113914257, -2547.715512192899, -7499.961282666093, -4451.175046761757, -1349.0120146472223, -1209.4799204270018, -189.97343031533197, -583.5837879787701, -4046.1699378574954, -4161.652826053225, -4306.730020894098, -5267.032586778182, -4374.570466851751, -1626.673662695501, -982.688408600908, -3798.0037204582663, -3805.0718402841944, -7851.104050344906, -7110.178239956484, -8103.2961958823, -5551.3677063214, -8083.949432010808, -839.3837316987574, -1942.2182173390868, -8100.5569157819, -6302.819917013166, -2073.366392313813, -4649.456493092797, -1097.9203393876337, -959.2864180765016, -5528.128166612737, -9010.093167820909, -658.3153307182331, -2827.736299836565, -1227.7325150559782, -1118.601150480672, -7543.526863487092, -7963.162845278152, -10404.788029551433, -9037.896373763808, -3820.254718734659, -1997.08306352651, -4542.468969437489, -2543.3046871183137, -3043.6668760805746, -924.3534749691314, -2539.3303291516636, -2138.109844647868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142264879784148, "mean_inference_ms": 1.0033392350462869, "mean_action_processing_ms": 0.17334756402442927, "mean_env_wait_ms": 0.05271315269710942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033620595932006836, "StateBufferConnector_ms": 0.004220128059387207, "ViewRequirementAgentConnector_ms": 0.06799733638763428}, "num_episodes": 29, "episode_return_max": -387.68817939607953, "episode_return_min": -10478.78197729299, "episode_return_mean": -4954.322892183921}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 555.026880263747, "num_env_steps_trained_throughput_per_sec": 555.026880263747, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 7494.414, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7494.375, "sample_time_ms": 733.982, "learn_time_ms": 6745.998, "learn_throughput": 592.944, "synch_weights_time_ms": 13.855}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 52, "trial_id": "3439d_00000", "date": "2024-08-09_15-32-54", "timestamp": 1723231974, "time_this_iter_s": 7.211748838424683, "time_total_s": 400.6591646671295, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 400.6591646671295, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 22.969999999999995, "ram_util_percent": 81.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8854929823894053, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.935952765742938, "policy_loss": -0.005279729406174738, "vf_loss": 9.933473787705104, "vf_explained_var": -6.0750978688399e-05, "kl": 0.01532588254873796, "entropy": 1.437551267320911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8236100275680501, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.975368045625233, "policy_loss": 0.004936032949961603, "vf_loss": 9.966051173336291, "vf_explained_var": 5.483330872954515e-05, "kl": 0.01460278001934211, "entropy": 1.1246581872935018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "env_runners": {"episode_reward_max": -387.68817939607953, "episode_reward_min": -10478.78197729299, "episode_reward_mean": -4901.66456051964, "episode_len_mean": 155.35, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15535, "policy_reward_min": {"agent_policy": 146.88103881236628, "adversary_policy": -10404.788029551433}, "policy_reward_max": {"agent_policy": 8963.90242602225, "adversary_policy": -146.88103881236628}, "policy_reward_mean": {"agent_policy": 3033.2134982584516, "adversary_policy": -3967.439029389046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5656.203363561688, -9073.795914803888, -7239.719859747041, -6860.166623492692, -418.2673888316531, -7126.653691931121, -5451.738043850699, -1564.1859516192767, -6769.118845522761, -7933.797209312802, -3678.1155278438437, -5803.125386992963, -9114.51039528269, -4163.048112090305, -1486.659674973882, -6044.893050691546, -7209.0446147327, -4592.929038314231, -4210.018696644946, -7860.80063325964, -6429.937046579764, -8469.465069436998, -1598.912251223548, -2333.762480944261, -8170.550745866928, -5127.675072660337, -8416.504955093684, -4790.2663275340865, -2260.6048760816875, -8476.934442097801, -4666.294139136295, -2240.586499979663, -4010.6625177058077, -3178.797334072416, -387.68817939607953, -3181.6279194686285, -6407.858521911045, -8212.554668502125, -2813.6005130592657, -3094.2001942039833, -977.8031142576009, -6142.142219106029, -8254.6420817453, -873.324469933802, -7148.6204268071415, -3044.303200075915, -2550.8353693955237, -5787.284834214558, -2481.45556813122, -4566.38729190889, -4253.352611562292, -1160.6767151323636, -2564.760852922653, -7499.961282666095, -1351.900763847528, -583.5837879787701, -5161.76906007878, -5311.193916767802, -4374.57046685175, -3798.0037204582663, -7851.104050344906, -8117.026833370851, -8083.949432010808, -1942.2182173390868, -8100.5569157819, -4649.456493092797, -1163.1468274918805, -9010.093167820909, -2827.736299836565, -1259.310677011595, -8015.814573975815, -10478.78197729299, -3820.2547187346595, -4897.75315145329, -3043.666876080575, -2589.1359930597287, -9053.460184502304, -3845.0917586576, -2967.687521118484, -2224.1387925266085, -5487.936833478622, -2755.2263041496935, -8068.1434933310475, -7411.612779679674, -9187.891330061118, -6189.998825918791, -1695.4381538288462, -3543.5228302310043, -3199.860819330512, -2863.9861162886405, -3093.26285007397, -8032.714508998214, -2938.669899421783, -7017.702122926234, -3775.5900832766074, -3302.670320342401, -5119.2907613257985, -4427.290800120501, -7022.8551384861175, -6680.560086894034], "episode_lengths": [200, 200, 200, 200, 33, 200, 180, 66, 200, 200, 126, 200, 200, 200, 123, 200, 151, 151, 149, 200, 200, 200, 92, 91, 200, 200, 200, 200, 97, 200, 129, 56, 139, 129, 38, 93, 200, 200, 82, 89, 62, 200, 200, 135, 200, 182, 109, 200, 113, 196, 109, 38, 128, 200, 95, 40, 188, 200, 131, 90, 193, 200, 200, 71, 200, 136, 101, 200, 78, 87, 200, 200, 186, 200, 107, 170, 193, 101, 108, 96, 200, 108, 200, 200, 200, 200, 90, 177, 115, 200, 200, 200, 93, 200, 200, 95, 200, 200, 200, 200], "policy_agent_policy_reward": [1525.2301526853096, 8360.569808625276, 4216.204336519237, 4400.6350922777, 152.7125526169303, 6726.0774201764525, 2853.0579710060774, 262.4007047186064, 3176.4082778173374, 4689.692975335296, 2250.1329156979286, 3573.9587394364416, 4929.83150785935, 1944.8465370677643, 1169.0685944733468, 4152.158296861339, 3770.494029746826, 1916.8864256003787, 2959.4894104213117, 7082.212733258104, 5766.737342287573, 5581.631707615753, 1358.280988027934, 930.9213181805372, 1642.5270613781795, 3975.7679726550496, 3901.008197916607, 3002.937421786899, 901.7142570450543, 3624.830144616908, 1365.4941591410336, 267.4039210105725, 2181.5637031582746, 1359.25714979652, 146.88103881236628, 1173.6258046947582, 4879.027659762147, 6922.560160951898, 749.6680784888572, 1212.4481297877555, 602.2304053228136, 3737.2328281763776, 4344.915507774313, 776.4941151766621, 6386.077126721187, 2504.263275315854, 1560.1622382362148, 2927.5795858495685, 1382.9604650611184, 2695.8663468992077, 1210.5198189869996, 334.33173659776537, 1132.785370661672, 4451.175046761757, 1206.591171226696, 189.97343031533197, 3046.0537038319435, 4262.568690904478, 1626.673662695501, 982.688408600908, 3805.0718402841944, 7096.447602467933, 5551.3677063214, 839.3837316987574, 6302.819917013166, 2073.366392313813, 894.059929972255, 5528.128166612737, 658.3153307182331, 1087.0229885250553, 7490.875134789429, 8963.90242602225, 1997.08306352651, 2188.0205051025273, 924.3534749691314, 2088.3041807398026, 4285.213657570337, 1492.9134188638454, 884.0137086791685, 963.356204747858, 4491.8830671140095, 2298.0941054983045, 6795.528974172695, 6507.113147319179, 4479.907263442956, 5431.281610700762, 1305.7959573891235, 1980.2585939041808, 1441.0526630402564, 2328.840437329464, 2377.5415007968186, 7582.227116412909, 1371.2352459570668, 3994.7992195228576, 3013.842299783618, 2188.679954605819, 3732.0138765009483, 2528.007244486537, 4256.521327538408, 3685.209204958753], "policy_adversary_policy_reward": [-1882.941594854449, -5298.491921392554, -8805.161854562964, -8629.2038688662, -4242.61115559046, -7213.313040675818, -4591.834180005293, -6668.967535765099, -418.2673888316532, -152.7125526169303, -7066.853427295451, -6785.8776848121215, -5451.738043850698, -2853.0579710060774, -262.4007047186064, -1564.1859516192767, -6475.7495421914755, -3469.777581148608, -7655.467422100515, -4968.022762547582, -3678.1155278438437, -2250.1329156979286, -3896.9458488417044, -5480.138277587701, -9114.51039528269, -4929.83150785935, -1944.8465370677643, -4163.048112090305, -1423.5013722211677, -1232.2268972260615, -4341.474241508669, -5855.577106044218, -7163.593296603286, -3815.945347876239, -4011.8819109011897, -2497.9335530134235, -4208.385803543842, -2961.1223035224175, -7528.569564298415, -7414.443802219328, -5799.294490479498, -6397.3798983878405, -8469.465069436998, -5581.631707615753, -1596.6878501730505, -1360.5053890784309, -980.5583079551755, -2284.125491169623, -8170.550745866929, -1642.5270613781795, -4103.463280808858, -4999.979764506528, -3901.008197916607, -8416.504955093684, -3291.735479675497, -4501.468269645487, -901.7142570450543, -2260.6048760816875, -8476.934442097801, -3624.830144616908, -1384.0356805052352, -4647.752617772094, -267.4039210105725, -2240.586499979663, -2456.1670898790107, -3736.05913098507, -3178.797334072417, -1359.25714979652, -146.88103881236628, -387.68817939607953, -1173.6258046947582, -3181.6279194686285, -4879.027659762147, -6407.858521911045, -7921.507559218089, -7213.607270235939, -749.6680784888572, -2813.6005130592657, -1212.4481297877555, -3094.2001942039833, -602.2304053228136, -977.8031142576009, -5070.222044299002, -4809.153002983401, -8254.642081745298, -4344.915507774313, -855.9659680979753, -793.8526170124888, -7103.502325599685, -6431.195227928643, -2700.0375802368903, -2848.528895154881, -2183.622898783893, -1927.3747088478456, -3611.969288803237, -5102.8951312608915, -1382.9604650611184, -2481.45556813122, -4035.508361367074, -3226.745277441029, -1210.5198189869996, -4253.352611562292, -1160.6767151323634, -334.33173659776537, -1149.8307113914257, -2547.715512192899, -7499.961282666093, -4451.175046761757, -1349.0120146472223, -1209.4799204270018, -189.97343031533197, -583.5837879787701, -4046.1699378574954, -4161.652826053225, -4306.730020894098, -5267.032586778182, -4374.570466851751, -1626.673662695501, -982.688408600908, -3798.0037204582663, -3805.0718402841944, -7851.104050344906, -7110.178239956484, -8103.2961958823, -5551.3677063214, -8083.949432010808, -839.3837316987574, -1942.2182173390868, -8100.5569157819, -6302.819917013166, -2073.366392313813, -4649.456493092797, -1097.9203393876337, -959.2864180765016, -5528.128166612737, -9010.093167820909, -658.3153307182331, -2827.736299836565, -1227.7325150559782, -1118.601150480672, -7543.526863487092, -7963.162845278152, -10404.788029551433, -9037.896373763808, -3820.254718734659, -1997.08306352651, -4542.468969437489, -2543.3046871183137, -3043.6668760805746, -924.3534749691314, -2539.3303291516636, -2138.109844647868, -9053.460184502304, -4285.213657570337, -1492.9134188638454, -3845.0917586576, -884.0137086791685, -2967.687521118484, -2095.5511846300137, -1091.9438126444525, -5480.915139800847, -4498.904760791785, -2434.0362758966053, -2619.284133751393, -7982.115980140322, -6881.556487363422, -7337.238679113513, -6581.487247885339, -9187.891330061118, -4479.907263442956, -6184.007939809172, -5437.272496810383, -1471.9821726553853, -1529.2519385625849, -1980.2585939041808, -3543.5228302310043, -3199.860819330512, -1441.0526630402564, -2861.8097050189444, -2331.0168485991553, -2789.228538524761, -2681.5758123460296, -7978.387211364356, -7636.5544140467655, -1482.6105956435572, -2827.294549735294, -7017.702122926233, -3994.7992195228576, -3324.7328192329364, -3464.699563827286, -2204.326379776776, -3287.023895171444, -4698.252243562353, -4153.052394264398, -2528.007244486537, -4427.290800120501, -4256.521327538408, -7022.8551384861175, -3685.209204958753, -6680.560086894034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4138077167275017, "mean_inference_ms": 1.0018157528191662, "mean_action_processing_ms": 0.17326173786047164, "mean_env_wait_ms": 0.052570515536792456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032845735549926758, "StateBufferConnector_ms": 0.002417445182800293, "ViewRequirementAgentConnector_ms": 0.0692136287689209}, "num_episodes": 24, "episode_return_max": -387.68817939607953, "episode_return_min": -10478.78197729299, "episode_return_mean": -4901.66456051964}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.1682545945022, "num_env_steps_trained_throughput_per_sec": 540.1682545945022, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 7474.235, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7474.196, "sample_time_ms": 733.572, "learn_time_ms": 6726.397, "learn_throughput": 594.672, "synch_weights_time_ms": 13.692}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "training_iteration": 53, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-01", "timestamp": 1723231981, "time_this_iter_s": 7.410266876220703, "time_total_s": 408.0694315433502, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edb550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.0694315433502, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 23.65454545454546, "ram_util_percent": 81.66363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8909432467383643, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.89899974266688, "policy_loss": 0.0018641080906187804, "vf_loss": 9.889260375499726, "vf_explained_var": -0.00012426450848579407, "kl": 0.015556108420908762, "entropy": 1.4714204705009857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.855617556236093, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.939969415008706, "policy_loss": -0.005702833522347704, "vf_loss": 9.941232591962057, "vf_explained_var": 2.4989136943110715e-05, "kl": 0.014798856497047439, "entropy": 1.0982839205908397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": -387.68817939607953, "episode_reward_min": -10478.78197729299, "episode_reward_mean": -4421.131398984513, "episode_len_mean": 150.44, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 15044, "policy_reward_min": {"agent_policy": 146.88103881236628, "adversary_policy": -10404.788029551433}, "policy_reward_max": {"agent_policy": 8963.90242602225, "adversary_policy": -146.88103881236628}, "policy_reward_mean": {"agent_policy": 2663.643786912697, "adversary_policy": -3542.3875929486053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4790.2663275340865, -2260.6048760816875, -8476.934442097801, -4666.294139136295, -2240.586499979663, -4010.6625177058077, -3178.797334072416, -387.68817939607953, -3181.6279194686285, -6407.858521911045, -8212.554668502125, -2813.6005130592657, -3094.2001942039833, -977.8031142576009, -6142.142219106029, -8254.6420817453, -873.324469933802, -7148.6204268071415, -3044.303200075915, -2550.8353693955237, -5787.284834214558, -2481.45556813122, -4566.38729190889, -4253.352611562292, -1160.6767151323636, -2564.760852922653, -7499.961282666095, -1351.900763847528, -583.5837879787701, -5161.76906007878, -5311.193916767802, -4374.57046685175, -3798.0037204582663, -7851.104050344906, -8117.026833370851, -8083.949432010808, -1942.2182173390868, -8100.5569157819, -4649.456493092797, -1163.1468274918805, -9010.093167820909, -2827.736299836565, -1259.310677011595, -8015.814573975815, -10478.78197729299, -3820.2547187346595, -4897.75315145329, -3043.666876080575, -2589.1359930597287, -9053.460184502304, -3845.0917586576, -2967.687521118484, -2224.1387925266085, -5487.936833478622, -2755.2263041496935, -8068.1434933310475, -7411.612779679674, -9187.891330061118, -6189.998825918791, -1695.4381538288462, -3543.5228302310043, -3199.860819330512, -2863.9861162886405, -3093.26285007397, -8032.714508998214, -2938.669899421783, -7017.702122926234, -3775.5900832766074, -3302.670320342401, -5119.2907613257985, -4427.290800120501, -7022.8551384861175, -6680.560086894034, -6730.988925352753, -3564.8101322441776, -2982.0246063708687, -4787.282314317015, -6352.944419266668, -2074.3490863768316, -1261.6291119792181, -5456.441034742323, -5258.708051958094, -2317.4980466999195, -2249.012626631176, -5406.414646834575, -2499.1733918945583, -6233.738992708237, -5200.656275249556, -3016.7842296533454, -4029.250395645905, -1893.833277321886, -4414.591166923183, -2498.659186555009, -3527.4479377375424, -2103.205009026156, -2666.4930663758873, -4761.12467012195, -5406.636866609417, -3402.369333047033, -4654.216690149919], "episode_lengths": [200, 97, 200, 129, 56, 139, 129, 38, 93, 200, 200, 82, 89, 62, 200, 200, 135, 200, 182, 109, 200, 113, 196, 109, 38, 128, 200, 95, 40, 188, 200, 131, 90, 193, 200, 200, 71, 200, 136, 101, 200, 78, 87, 200, 200, 186, 200, 107, 170, 193, 101, 108, 96, 200, 108, 200, 200, 200, 200, 90, 177, 115, 200, 200, 200, 93, 200, 200, 95, 200, 200, 200, 200, 200, 84, 155, 200, 200, 100, 89, 200, 120, 200, 200, 200, 200, 176, 198, 78, 185, 106, 109, 95, 155, 60, 83, 200, 126, 152, 200], "policy_agent_policy_reward": [3002.937421786899, 901.7142570450543, 3624.830144616908, 1365.4941591410336, 267.4039210105725, 2181.5637031582746, 1359.25714979652, 146.88103881236628, 1173.6258046947582, 4879.027659762147, 6922.560160951898, 749.6680784888572, 1212.4481297877555, 602.2304053228136, 3737.2328281763776, 4344.915507774313, 776.4941151766621, 6386.077126721187, 2504.263275315854, 1560.1622382362148, 2927.5795858495685, 1382.9604650611184, 2695.8663468992077, 1210.5198189869996, 334.33173659776537, 1132.785370661672, 4451.175046761757, 1206.591171226696, 189.97343031533197, 3046.0537038319435, 4262.568690904478, 1626.673662695501, 982.688408600908, 3805.0718402841944, 7096.447602467933, 5551.3677063214, 839.3837316987574, 6302.819917013166, 2073.366392313813, 894.059929972255, 5528.128166612737, 658.3153307182331, 1087.0229885250553, 7490.875134789429, 8963.90242602225, 1997.08306352651, 2188.0205051025273, 924.3534749691314, 2088.3041807398026, 4285.213657570337, 1492.9134188638454, 884.0137086791685, 963.356204747858, 4491.8830671140095, 2298.0941054983045, 6795.528974172695, 6507.113147319179, 4479.907263442956, 5431.281610700762, 1305.7959573891235, 1980.2585939041808, 1441.0526630402564, 2328.840437329464, 2377.5415007968186, 7582.227116412909, 1371.2352459570668, 3994.7992195228576, 3013.842299783618, 2188.679954605819, 3732.0138765009483, 2528.007244486537, 4256.521327538408, 3685.209204958753, 6509.543320206444, 745.1285629315787, 2451.65277936463, 4037.9373520840013, 2212.6039760438343, 1540.4646800392572, 982.860622045408, 2646.798969585279, 1392.834986781346, 1447.9172973738516, 1778.5585398710095, 3268.456556494076, 1273.8647383686084, 3502.1102538415316, 3782.0790849018754, 1327.1398733554306, 2558.365931265482, 1036.8764790541863, 1688.9807414691093, 1407.3941941923326, 1999.2628244477564, 694.440976702063, 566.0133921060591, 2012.4182953829147, 934.6876748006586, 1564.1992208508934, 2949.380612127673], "policy_adversary_policy_reward": [-3291.735479675497, -4501.468269645487, -901.7142570450543, -2260.6048760816875, -8476.934442097801, -3624.830144616908, -1384.0356805052352, -4647.752617772094, -267.4039210105725, -2240.586499979663, -2456.1670898790107, -3736.05913098507, -3178.797334072417, -1359.25714979652, -146.88103881236628, -387.68817939607953, -1173.6258046947582, -3181.6279194686285, -4879.027659762147, -6407.858521911045, -7921.507559218089, -7213.607270235939, -749.6680784888572, -2813.6005130592657, -1212.4481297877555, -3094.2001942039833, -602.2304053228136, -977.8031142576009, -5070.222044299002, -4809.153002983401, -8254.642081745298, -4344.915507774313, -855.9659680979753, -793.8526170124888, -7103.502325599685, -6431.195227928643, -2700.0375802368903, -2848.528895154881, -2183.622898783893, -1927.3747088478456, -3611.969288803237, -5102.8951312608915, -1382.9604650611184, -2481.45556813122, -4035.508361367074, -3226.745277441029, -1210.5198189869996, -4253.352611562292, -1160.6767151323634, -334.33173659776537, -1149.8307113914257, -2547.715512192899, -7499.961282666093, -4451.175046761757, -1349.0120146472223, -1209.4799204270018, -189.97343031533197, -583.5837879787701, -4046.1699378574954, -4161.652826053225, -4306.730020894098, -5267.032586778182, -4374.570466851751, -1626.673662695501, -982.688408600908, -3798.0037204582663, -3805.0718402841944, -7851.104050344906, -7110.178239956484, -8103.2961958823, -5551.3677063214, -8083.949432010808, -839.3837316987574, -1942.2182173390868, -8100.5569157819, -6302.819917013166, -2073.366392313813, -4649.456493092797, -1097.9203393876337, -959.2864180765016, -5528.128166612737, -9010.093167820909, -658.3153307182331, -2827.736299836565, -1227.7325150559782, -1118.601150480672, -7543.526863487092, -7963.162845278152, -10404.788029551433, -9037.896373763808, -3820.254718734659, -1997.08306352651, -4542.468969437489, -2543.3046871183137, -3043.6668760805746, -924.3534749691314, -2539.3303291516636, -2138.109844647868, -9053.460184502304, -4285.213657570337, -1492.9134188638454, -3845.0917586576, -884.0137086791685, -2967.687521118484, -2095.5511846300137, -1091.9438126444525, -5480.915139800847, -4498.904760791785, -2434.0362758966053, -2619.284133751393, -7982.115980140322, -6881.556487363422, -7337.238679113513, -6581.487247885339, -9187.891330061118, -4479.907263442956, -6184.007939809172, -5437.272496810383, -1471.9821726553853, -1529.2519385625849, -1980.2585939041808, -3543.5228302310043, -3199.860819330512, -1441.0526630402564, -2861.8097050189444, -2331.0168485991553, -2789.228538524761, -2681.5758123460296, -7978.387211364356, -7636.5544140467655, -1482.6105956435572, -2827.294549735294, -7017.702122926233, -3994.7992195228576, -3324.7328192329364, -3464.699563827286, -2204.326379776776, -3287.023895171444, -4698.252243562353, -4153.052394264398, -2528.007244486537, -4427.290800120501, -4256.521327538408, -7022.8551384861175, -3685.209204958753, -6680.560086894034, -6659.880166761594, -6580.652078797602, -745.1285629315787, -3564.8101322441776, -2463.662248902472, -2970.015136833027, -4784.1507693394105, -4041.0688970616047, -5171.974351904254, -3393.574043406253, -1797.8669505145383, -1816.9468159015507, -1237.610327353958, -1006.8794066706689, -4461.838049490656, -3641.401954836946, -5258.708051958093, -1392.834986781346, -2202.0247754512457, -1563.3905686225253, -1972.6307865138954, -2054.940379988289, -4349.128921470386, -4325.742281858268, -2429.033990794598, -1344.0041394685695, -6233.738992708236, -3502.1102538415316, -5200.656275249556, -3782.0790849018754, -3016.7842296533454, -1327.1398733554306, -4029.250395645905, -2558.365931265482, -1051.5666028182854, -1879.143153557787, -1688.9807414691093, -4414.591166923183, -2498.6591865550076, -1407.3941941923326, -3527.447937737542, -1999.2628244477564, -694.440976702063, -2103.205009026156, -566.0133921060591, -2666.4930663758873, -2012.4182953829147, -4761.12467012195, -934.6876748006586, -5406.636866609417, -1564.1992208508934, -3402.3693330470333, -4654.216690149919, -2949.380612127673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41308507423031143, "mean_inference_ms": 1.0011869349247307, "mean_action_processing_ms": 0.1731709709397249, "mean_env_wait_ms": 0.05244883875917527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032802820205688477, "StateBufferConnector_ms": 0.00244295597076416, "ViewRequirementAgentConnector_ms": 0.07055091857910156}, "num_episodes": 27, "episode_return_max": -387.68817939607953, "episode_return_min": -10478.78197729299, "episode_return_mean": -4421.131398984513}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.0651370614373, "num_env_steps_trained_throughput_per_sec": 553.0651370614373, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 7458.749, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7458.71, "sample_time_ms": 735.695, "learn_time_ms": 6708.948, "learn_throughput": 596.219, "synch_weights_time_ms": 13.568}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 54, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-09", "timestamp": 1723231989, "time_this_iter_s": 7.238105773925781, "time_total_s": 415.307537317276, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 415.307537317276, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 22.810000000000002, "ram_util_percent": 81.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0244844360277057, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.8726186444362, "policy_loss": -0.0036055044867680406, "vf_loss": 9.871120125055313, "vf_explained_var": 8.884376535813013e-05, "kl": 0.010081966282935657, "entropy": 1.496407271673282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8695091849281674, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.920204161588478, "policy_loss": -0.0070976550178355954, "vf_loss": 9.923285639727558, "vf_explained_var": 0.00010662151392174776, "kl": 0.01338726828717405, "entropy": 1.122178130111997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": -583.5837879787701, "episode_reward_min": -10478.78197729299, "episode_reward_mean": -4454.6301806425645, "episode_len_mean": 154.65, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15465, "policy_reward_min": {"agent_policy": 131.9188970050974, "adversary_policy": -10404.788029551433}, "policy_reward_max": {"agent_policy": 8963.90242602225, "adversary_policy": -131.9188970050974}, "policy_reward_mean": {"agent_policy": 2664.0045939102984, "adversary_policy": -3559.317387276431}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1160.6767151323636, -2564.760852922653, -7499.961282666095, -1351.900763847528, -583.5837879787701, -5161.76906007878, -5311.193916767802, -4374.57046685175, -3798.0037204582663, -7851.104050344906, -8117.026833370851, -8083.949432010808, -1942.2182173390868, -8100.5569157819, -4649.456493092797, -1163.1468274918805, -9010.093167820909, -2827.736299836565, -1259.310677011595, -8015.814573975815, -10478.78197729299, -3820.2547187346595, -4897.75315145329, -3043.666876080575, -2589.1359930597287, -9053.460184502304, -3845.0917586576, -2967.687521118484, -2224.1387925266085, -5487.936833478622, -2755.2263041496935, -8068.1434933310475, -7411.612779679674, -9187.891330061118, -6189.998825918791, -1695.4381538288462, -3543.5228302310043, -3199.860819330512, -2863.9861162886405, -3093.26285007397, -8032.714508998214, -2938.669899421783, -7017.702122926234, -3775.5900832766074, -3302.670320342401, -5119.2907613257985, -4427.290800120501, -7022.8551384861175, -6680.560086894034, -6730.988925352753, -3564.8101322441776, -2982.0246063708687, -4787.282314317015, -6352.944419266668, -2074.3490863768316, -1261.6291119792181, -5456.441034742323, -5258.708051958094, -2317.4980466999195, -2249.012626631176, -5406.414646834575, -2499.1733918945583, -6233.738992708237, -5200.656275249556, -3016.7842296533454, -4029.250395645905, -1893.833277321886, -4414.591166923183, -2498.659186555009, -3527.4479377375424, -2103.205009026156, -2666.4930663758873, -4761.12467012195, -5406.636866609417, -3402.369333047033, -4654.216690149919, -5139.966384706264, -3500.0065078619537, -5682.798694609202, -2846.1869566293954, -1157.8006434485767, -3570.695007832006, -3507.7438806739733, -3405.7460833866962, -3583.647281581467, -4761.831303861493, -5701.088007234789, -2099.647979410147, -3351.010904070551, -7796.611390793463, -4024.148554894976, -4458.811672797314, -5947.972796588401, -3780.1949777598747, -3831.3291601471246, -7555.034835734034, -1377.7351969914437, -5246.192980016988, -6149.429652330272, -4676.074632731801], "episode_lengths": [38, 128, 200, 95, 40, 188, 200, 131, 90, 193, 200, 200, 71, 200, 136, 101, 200, 78, 87, 200, 200, 186, 200, 107, 170, 193, 101, 108, 96, 200, 108, 200, 200, 200, 200, 90, 177, 115, 200, 200, 200, 93, 200, 200, 95, 200, 200, 200, 200, 200, 84, 155, 200, 200, 100, 89, 200, 120, 200, 200, 200, 200, 176, 198, 78, 185, 106, 109, 95, 155, 60, 83, 200, 126, 152, 200, 200, 139, 131, 166, 88, 176, 151, 182, 167, 100, 197, 41, 190, 200, 184, 133, 200, 125, 189, 197, 75, 160, 200, 188], "policy_agent_policy_reward": [334.33173659776537, 1132.785370661672, 4451.175046761757, 1206.591171226696, 189.97343031533197, 3046.0537038319435, 4262.568690904478, 1626.673662695501, 982.688408600908, 3805.0718402841944, 7096.447602467933, 5551.3677063214, 839.3837316987574, 6302.819917013166, 2073.366392313813, 894.059929972255, 5528.128166612737, 658.3153307182331, 1087.0229885250553, 7490.875134789429, 8963.90242602225, 1997.08306352651, 2188.0205051025273, 924.3534749691314, 2088.3041807398026, 4285.213657570337, 1492.9134188638454, 884.0137086791685, 963.356204747858, 4491.8830671140095, 2298.0941054983045, 6795.528974172695, 6507.113147319179, 4479.907263442956, 5431.281610700762, 1305.7959573891235, 1980.2585939041808, 1441.0526630402564, 2328.840437329464, 2377.5415007968186, 7582.227116412909, 1371.2352459570668, 3994.7992195228576, 3013.842299783618, 2188.679954605819, 3732.0138765009483, 2528.007244486537, 4256.521327538408, 3685.209204958753, 6509.543320206444, 745.1285629315787, 2451.65277936463, 4037.9373520840013, 2212.6039760438343, 1540.4646800392572, 982.860622045408, 2646.798969585279, 1392.834986781346, 1447.9172973738516, 1778.5585398710095, 3268.456556494076, 1273.8647383686084, 3502.1102538415316, 3782.0790849018754, 1327.1398733554306, 2558.365931265482, 1036.8764790541863, 1688.9807414691093, 1407.3941941923326, 1999.2628244477564, 694.440976702063, 566.0133921060591, 2012.4182953829147, 934.6876748006586, 1564.1992208508934, 2949.380612127673, 2588.493774607757, 3093.3937938091963, 1141.3316985887373, 2060.587588045153, 1002.9256865653427, 2997.7993155893264, 1200.9547039397478, 2721.037249156241, 2606.1304562833047, 878.907494209723, 5031.250437261444, 131.9188970050974, 1132.717144862317, 3309.6722335405907, 2876.765616395549, 2236.2906480558763, 3932.6272404557412, 2425.3891105344674, 2996.963358043553, 2210.8941968575564, 598.6460626362041, 1407.4191685774224, 4796.445322982551, 2573.232844330523], "policy_adversary_policy_reward": [-1160.6767151323634, -334.33173659776537, -1149.8307113914257, -2547.715512192899, -7499.961282666093, -4451.175046761757, -1349.0120146472223, -1209.4799204270018, -189.97343031533197, -583.5837879787701, -4046.1699378574954, -4161.652826053225, -4306.730020894098, -5267.032586778182, -4374.570466851751, -1626.673662695501, -982.688408600908, -3798.0037204582663, -3805.0718402841944, -7851.104050344906, -7110.178239956484, -8103.2961958823, -5551.3677063214, -8083.949432010808, -839.3837316987574, -1942.2182173390868, -8100.5569157819, -6302.819917013166, -2073.366392313813, -4649.456493092797, -1097.9203393876337, -959.2864180765016, -5528.128166612737, -9010.093167820909, -658.3153307182331, -2827.736299836565, -1227.7325150559782, -1118.601150480672, -7543.526863487092, -7963.162845278152, -10404.788029551433, -9037.896373763808, -3820.254718734659, -1997.08306352651, -4542.468969437489, -2543.3046871183137, -3043.6668760805746, -924.3534749691314, -2539.3303291516636, -2138.109844647868, -9053.460184502304, -4285.213657570337, -1492.9134188638454, -3845.0917586576, -884.0137086791685, -2967.687521118484, -2095.5511846300137, -1091.9438126444525, -5480.915139800847, -4498.904760791785, -2434.0362758966053, -2619.284133751393, -7982.115980140322, -6881.556487363422, -7337.238679113513, -6581.487247885339, -9187.891330061118, -4479.907263442956, -6184.007939809172, -5437.272496810383, -1471.9821726553853, -1529.2519385625849, -1980.2585939041808, -3543.5228302310043, -3199.860819330512, -1441.0526630402564, -2861.8097050189444, -2331.0168485991553, -2789.228538524761, -2681.5758123460296, -7978.387211364356, -7636.5544140467655, -1482.6105956435572, -2827.294549735294, -7017.702122926233, -3994.7992195228576, -3324.7328192329364, -3464.699563827286, -2204.326379776776, -3287.023895171444, -4698.252243562353, -4153.052394264398, -2528.007244486537, -4427.290800120501, -4256.521327538408, -7022.8551384861175, -3685.209204958753, -6680.560086894034, -6659.880166761594, -6580.652078797602, -745.1285629315787, -3564.8101322441776, -2463.662248902472, -2970.015136833027, -4784.1507693394105, -4041.0688970616047, -5171.974351904254, -3393.574043406253, -1797.8669505145383, -1816.9468159015507, -1237.610327353958, -1006.8794066706689, -4461.838049490656, -3641.401954836946, -5258.708051958093, -1392.834986781346, -2202.0247754512457, -1563.3905686225253, -1972.6307865138954, -2054.940379988289, -4349.128921470386, -4325.742281858268, -2429.033990794598, -1344.0041394685695, -6233.738992708236, -3502.1102538415316, -5200.656275249556, -3782.0790849018754, -3016.7842296533454, -1327.1398733554306, -4029.250395645905, -2558.365931265482, -1051.5666028182854, -1879.143153557787, -1688.9807414691093, -4414.591166923183, -2498.6591865550076, -1407.3941941923326, -3527.447937737542, -1999.2628244477564, -694.440976702063, -2103.205009026156, -566.0133921060591, -2666.4930663758873, -2012.4182953829147, -4761.12467012195, -934.6876748006586, -5406.636866609417, -1564.1992208508934, -3402.3693330470333, -4654.216690149919, -2949.380612127673, -2659.2290480823544, -5069.231111231667, -3496.295472417165, -3097.1048292539876, -1141.3316985887373, -5682.798694609202, -2841.7255603531567, -2065.0489843213923, -1067.2657454209204, -1093.4605845929993, -3139.956259366996, -3428.538064054337, -3476.918968671271, -1231.779615942451, -3405.714583458532, -2721.0687490844048, -2610.456518669008, -3579.321219195764, -4761.831303861493, -878.907494209723, -5700.735824954902, -5031.602619541332, -2099.647979410147, -131.9188970050974, -1133.5870039970669, -3350.141044935802, -3309.6722335405907, -7796.611390793464, -3994.599706313072, -2906.3144649774526, -4458.811672797314, -2236.2906480558763, -5947.972013414203, -3932.628023629941, -3780.1949777598747, -2425.3891105344674, -3001.7127504150376, -3826.57976777564, -7555.034835734035, -2210.8941968575564, -598.6460626362041, -1377.7351969914437, -5246.192980016988, -1407.4191685774224, -4800.682838856484, -6145.1921364563395, -2576.859500213377, -4672.447976848947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4120143226558288, "mean_inference_ms": 0.9999393043389702, "mean_action_processing_ms": 0.17261295737536636, "mean_env_wait_ms": 0.0523968037844678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003282308578491211, "StateBufferConnector_ms": 0.002405405044555664, "ViewRequirementAgentConnector_ms": 0.06830966472625732}, "num_episodes": 24, "episode_return_max": -583.5837879787701, "episode_return_min": -10478.78197729299, "episode_return_mean": -4454.6301806425645}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.0798194454472, "num_env_steps_trained_throughput_per_sec": 513.0798194454472, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 7486.868, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7486.83, "sample_time_ms": 736.455, "learn_time_ms": 6736.318, "learn_throughput": 593.796, "synch_weights_time_ms": 13.552}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 55, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-16", "timestamp": 1723231996, "time_this_iter_s": 7.8010969161987305, "time_total_s": 423.10863423347473, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edb5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 423.10863423347473, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.183333333333334, "ram_util_percent": 81.10833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.022601528496792, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.905137213071187, "policy_loss": -0.0026726319129617574, "vf_loss": 9.90239971280098, "vf_explained_var": 0.00015730553617080052, "kl": 0.010686698492888051, "entropy": 1.4941716289768616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8411893898217135, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9470202052404, "policy_loss": 0.0031588865857985282, "vf_loss": 9.939120015139302, "vf_explained_var": 1.3980190589945152e-05, "kl": 0.01580434659663489, "entropy": 1.1508505695711368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": -604.7119536838309, "episode_reward_min": -9187.891330061118, "episode_reward_mean": -4105.086058286342, "episode_len_mean": 156.76, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15676, "policy_reward_min": {"agent_policy": 131.9188970050974, "adversary_policy": -9187.891330061118}, "policy_reward_max": {"agent_policy": 7582.227116412909, "adversary_policy": -131.9188970050974}, "policy_reward_mean": {"agent_policy": 2452.978260115787, "adversary_policy": -3279.032159201065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2589.1359930597287, -9053.460184502304, -3845.0917586576, -2967.687521118484, -2224.1387925266085, -5487.936833478622, -2755.2263041496935, -8068.1434933310475, -7411.612779679674, -9187.891330061118, -6189.998825918791, -1695.4381538288462, -3543.5228302310043, -3199.860819330512, -2863.9861162886405, -3093.26285007397, -8032.714508998214, -2938.669899421783, -7017.702122926234, -3775.5900832766074, -3302.670320342401, -5119.2907613257985, -4427.290800120501, -7022.8551384861175, -6680.560086894034, -6730.988925352753, -3564.8101322441776, -2982.0246063708687, -4787.282314317015, -6352.944419266668, -2074.3490863768316, -1261.6291119792181, -5456.441034742323, -5258.708051958094, -2317.4980466999195, -2249.012626631176, -5406.414646834575, -2499.1733918945583, -6233.738992708237, -5200.656275249556, -3016.7842296533454, -4029.250395645905, -1893.833277321886, -4414.591166923183, -2498.659186555009, -3527.4479377375424, -2103.205009026156, -2666.4930663758873, -4761.12467012195, -5406.636866609417, -3402.369333047033, -4654.216690149919, -5139.966384706264, -3500.0065078619537, -5682.798694609202, -2846.1869566293954, -1157.8006434485767, -3570.695007832006, -3507.7438806739733, -3405.7460833866962, -3583.647281581467, -4761.831303861493, -5701.088007234789, -2099.647979410147, -3351.010904070551, -7796.611390793463, -4024.148554894976, -4458.811672797314, -5947.972796588401, -3780.1949777598747, -3831.3291601471246, -7555.034835734034, -1377.7351969914437, -5246.192980016988, -6149.429652330272, -4676.074632731801, -604.7119536838309, -1798.4825742777477, -3915.322650412451, -3859.513909491472, -4058.4440522345103, -2530.587227169396, -3823.3339022382497, -3425.703323469781, -2288.3745115859524, -4309.996311188241, -5020.791760603944, -6790.855116674894, -1939.039967365208, -1281.532689421731, -5620.217852267513, -1665.2614222002744, -4178.124602173916, -2761.8582596112683, -2483.0053457620147, -4303.183060277541, -4078.6103318993946, -3954.3435673912795, -3211.336344133506, -2210.2478071864416], "episode_lengths": [170, 193, 101, 108, 96, 200, 108, 200, 200, 200, 200, 90, 177, 115, 200, 200, 200, 93, 200, 200, 95, 200, 200, 200, 200, 200, 84, 155, 200, 200, 100, 89, 200, 120, 200, 200, 200, 200, 176, 198, 78, 185, 106, 109, 95, 155, 60, 83, 200, 126, 152, 200, 200, 139, 131, 166, 88, 176, 151, 182, 167, 100, 197, 41, 190, 200, 184, 133, 200, 125, 189, 197, 75, 160, 200, 188, 64, 138, 145, 172, 200, 122, 200, 200, 160, 169, 165, 200, 112, 89, 197, 92, 200, 84, 99, 152, 200, 200, 184, 136], "policy_agent_policy_reward": [2088.3041807398026, 4285.213657570337, 1492.9134188638454, 884.0137086791685, 963.356204747858, 4491.8830671140095, 2298.0941054983045, 6795.528974172695, 6507.113147319179, 4479.907263442956, 5431.281610700762, 1305.7959573891235, 1980.2585939041808, 1441.0526630402564, 2328.840437329464, 2377.5415007968186, 7582.227116412909, 1371.2352459570668, 3994.7992195228576, 3013.842299783618, 2188.679954605819, 3732.0138765009483, 2528.007244486537, 4256.521327538408, 3685.209204958753, 6509.543320206444, 745.1285629315787, 2451.65277936463, 4037.9373520840013, 2212.6039760438343, 1540.4646800392572, 982.860622045408, 2646.798969585279, 1392.834986781346, 1447.9172973738516, 1778.5585398710095, 3268.456556494076, 1273.8647383686084, 3502.1102538415316, 3782.0790849018754, 1327.1398733554306, 2558.365931265482, 1036.8764790541863, 1688.9807414691093, 1407.3941941923326, 1999.2628244477564, 694.440976702063, 566.0133921060591, 2012.4182953829147, 934.6876748006586, 1564.1992208508934, 2949.380612127673, 2588.493774607757, 3093.3937938091963, 1141.3316985887373, 2060.587588045153, 1002.9256865653427, 2997.7993155893264, 1200.9547039397478, 2721.037249156241, 2606.1304562833047, 878.907494209723, 5031.250437261444, 131.9188970050974, 1132.717144862317, 3309.6722335405907, 2876.765616395549, 2236.2906480558763, 3932.6272404557412, 2425.3891105344674, 2996.963358043553, 2210.8941968575564, 598.6460626362041, 1407.4191685774224, 4796.445322982551, 2573.232844330523, 291.67482035508516, 1111.442441478615, 2658.8963877183955, 3522.827127746565, 2785.9796579288436, 2162.0469702310234, 2365.5251166838334, 3223.431232664596, 1621.1618126486383, 1591.0450261617061, 3440.322521668861, 4349.219572815984, 1028.6961699702915, 1010.4298442366032, 2579.549171368275, 1102.9882926368205, 2443.602008675694, 984.8426301185104, 1491.846053829306, 1284.8875983707205, 3492.853174696433, 3393.2071764923417, 2505.791565824368, 1088.1596781608355], "policy_adversary_policy_reward": [-2539.3303291516636, -2138.109844647868, -9053.460184502304, -4285.213657570337, -1492.9134188638454, -3845.0917586576, -884.0137086791685, -2967.687521118484, -2095.5511846300137, -1091.9438126444525, -5480.915139800847, -4498.904760791785, -2434.0362758966053, -2619.284133751393, -7982.115980140322, -6881.556487363422, -7337.238679113513, -6581.487247885339, -9187.891330061118, -4479.907263442956, -6184.007939809172, -5437.272496810383, -1471.9821726553853, -1529.2519385625849, -1980.2585939041808, -3543.5228302310043, -3199.860819330512, -1441.0526630402564, -2861.8097050189444, -2331.0168485991553, -2789.228538524761, -2681.5758123460296, -7978.387211364356, -7636.5544140467655, -1482.6105956435572, -2827.294549735294, -7017.702122926233, -3994.7992195228576, -3324.7328192329364, -3464.699563827286, -2204.326379776776, -3287.023895171444, -4698.252243562353, -4153.052394264398, -2528.007244486537, -4427.290800120501, -4256.521327538408, -7022.8551384861175, -3685.209204958753, -6680.560086894034, -6659.880166761594, -6580.652078797602, -745.1285629315787, -3564.8101322441776, -2463.662248902472, -2970.015136833027, -4784.1507693394105, -4041.0688970616047, -5171.974351904254, -3393.574043406253, -1797.8669505145383, -1816.9468159015507, -1237.610327353958, -1006.8794066706689, -4461.838049490656, -3641.401954836946, -5258.708051958093, -1392.834986781346, -2202.0247754512457, -1563.3905686225253, -1972.6307865138954, -2054.940379988289, -4349.128921470386, -4325.742281858268, -2429.033990794598, -1344.0041394685695, -6233.738992708236, -3502.1102538415316, -5200.656275249556, -3782.0790849018754, -3016.7842296533454, -1327.1398733554306, -4029.250395645905, -2558.365931265482, -1051.5666028182854, -1879.143153557787, -1688.9807414691093, -4414.591166923183, -2498.6591865550076, -1407.3941941923326, -3527.447937737542, -1999.2628244477564, -694.440976702063, -2103.205009026156, -566.0133921060591, -2666.4930663758873, -2012.4182953829147, -4761.12467012195, -934.6876748006586, -5406.636866609417, -1564.1992208508934, -3402.3693330470333, -4654.216690149919, -2949.380612127673, -2659.2290480823544, -5069.231111231667, -3496.295472417165, -3097.1048292539876, -1141.3316985887373, -5682.798694609202, -2841.7255603531567, -2065.0489843213923, -1067.2657454209204, -1093.4605845929993, -3139.956259366996, -3428.538064054337, -3476.918968671271, -1231.779615942451, -3405.714583458532, -2721.0687490844048, -2610.456518669008, -3579.321219195764, -4761.831303861493, -878.907494209723, -5700.735824954902, -5031.602619541332, -2099.647979410147, -131.9188970050974, -1133.5870039970669, -3350.141044935802, -3309.6722335405907, -7796.611390793464, -3994.599706313072, -2906.3144649774526, -4458.811672797314, -2236.2906480558763, -5947.972013414203, -3932.628023629941, -3780.1949777598747, -2425.3891105344674, -3001.7127504150376, -3826.57976777564, -7555.034835734035, -2210.8941968575564, -598.6460626362041, -1377.7351969914437, -5246.192980016988, -1407.4191685774224, -4800.682838856484, -6145.1921364563395, -2576.859500213377, -4672.447976848947, -406.99525505636353, -489.39151898255227, -1135.1870918339723, -1774.7379239223922, -2943.4227549128314, -3630.7962832180156, -3688.3713827532047, -3693.9696544848316, -2785.9796579288436, -4058.4440522345103, -2493.4962710081536, -2199.1379263922654, -3581.9405938981363, -2606.9184250239473, -3236.8737782464773, -3412.260777887899, -2248.6039723279027, -1660.9323519066882, -1599.800502665179, -4301.240834684766, -5020.791760603945, -3440.322521668861, -4349.290607066645, -6790.784082424234, -1268.8058203209841, -1698.930317014517, -1050.6946688780647, -1241.26786478027, -2584.9102560810115, -5614.8567675547765, -1369.4192399776884, -1398.8304748594064, -2464.626518632461, -4157.100092217149, -984.8426301185104, -2761.8582596112683, -1491.846053829306, -2483.0053457620147, -1284.8875983707205, -4303.183060277541, -3493.658211802391, -4077.8052947934348, -3942.8266163960297, -3404.7241274875914, -2914.8447413030885, -2802.2831686547875, -2153.1909452598416, -1145.2165400874337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4114184611072884, "mean_inference_ms": 0.9979207272809046, "mean_action_processing_ms": 0.17244236966578289, "mean_env_wait_ms": 0.052285404741710784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033538341522216797, "StateBufferConnector_ms": 0.0024219751358032227, "ViewRequirementAgentConnector_ms": 0.06840348243713379}, "num_episodes": 24, "episode_return_max": -604.7119536838309, "episode_return_min": -9187.891330061118, "episode_return_mean": -4105.086058286342}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 531.4044690106527, "num_env_steps_trained_throughput_per_sec": 531.4044690106527, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 7467.575, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7467.538, "sample_time_ms": 735.609, "learn_time_ms": 6718.155, "learn_throughput": 595.402, "synch_weights_time_ms": 13.277}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 56, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-24", "timestamp": 1723232004, "time_this_iter_s": 7.532334089279175, "time_total_s": 430.6409683227539, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edb9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 430.6409683227539, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 25.436363636363634, "ram_util_percent": 81.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9720628860406577, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.907495612899462, "policy_loss": -0.0027138931211084126, "vf_loss": 9.904441041747729, "vf_explained_var": -9.463758518298467e-05, "kl": 0.011394462136862179, "entropy": 1.4833366004129251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7745712428890839, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.93646335349512, "policy_loss": -0.0034441699705052157, "vf_loss": 9.937002065951232, "vf_explained_var": 5.154729520202314e-06, "kl": 0.009684867724263795, "entropy": 1.1687651156117675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "env_runners": {"episode_reward_max": -604.7119536838309, "episode_reward_min": -8925.207189403918, "episode_reward_mean": -3990.1508040727763, "episode_len_mean": 157.42, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 15742, "policy_reward_min": {"agent_policy": 131.9188970050974, "adversary_policy": -8925.207189403918}, "policy_reward_max": {"agent_policy": 7437.443920798058, "adversary_policy": -131.9188970050974}, "policy_reward_mean": {"agent_policy": 2338.89686084095, "adversary_policy": -3164.523832456863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3564.8101322441776, -2982.0246063708687, -4787.282314317015, -6352.944419266668, -2074.3490863768316, -1261.6291119792181, -5456.441034742323, -5258.708051958094, -2317.4980466999195, -2249.012626631176, -5406.414646834575, -2499.1733918945583, -6233.738992708237, -5200.656275249556, -3016.7842296533454, -4029.250395645905, -1893.833277321886, -4414.591166923183, -2498.659186555009, -3527.4479377375424, -2103.205009026156, -2666.4930663758873, -4761.12467012195, -5406.636866609417, -3402.369333047033, -4654.216690149919, -5139.966384706264, -3500.0065078619537, -5682.798694609202, -2846.1869566293954, -1157.8006434485767, -3570.695007832006, -3507.7438806739733, -3405.7460833866962, -3583.647281581467, -4761.831303861493, -5701.088007234789, -2099.647979410147, -3351.010904070551, -7796.611390793463, -4024.148554894976, -4458.811672797314, -5947.972796588401, -3780.1949777598747, -3831.3291601471246, -7555.034835734034, -1377.7351969914437, -5246.192980016988, -6149.429652330272, -4676.074632731801, -604.7119536838309, -1798.4825742777477, -3915.322650412451, -3859.513909491472, -4058.4440522345103, -2530.587227169396, -3823.3339022382497, -3425.703323469781, -2288.3745115859524, -4309.996311188241, -5020.791760603944, -6790.855116674894, -1939.039967365208, -1281.532689421731, -5620.217852267513, -1665.2614222002744, -4178.124602173916, -2761.8582596112683, -2483.0053457620147, -4303.183060277541, -4078.6103318993946, -3954.3435673912795, -3211.336344133506, -2210.2478071864416, -2685.3965802505954, -4252.310854196459, -1217.0329255906954, -3955.5043552716393, -4776.162067464642, -4179.011229779988, -3821.646820638622, -4941.564715107272, -7084.507692362965, -7536.822303415446, -6565.412836654074, -3677.7440810769585, -3311.0054120529703, -2270.722801655196, -5031.782615847249, -8925.207189403918, -6814.911310845054, -4283.020025030661, -3138.7270529100997, -8227.738201592358, -4998.894998257852, -5764.840232604321, -4239.677491730171, -2484.458374908281, -773.3202198658189, -2773.7794235110705], "episode_lengths": [84, 155, 200, 200, 100, 89, 200, 120, 200, 200, 200, 200, 176, 198, 78, 185, 106, 109, 95, 155, 60, 83, 200, 126, 152, 200, 200, 139, 131, 166, 88, 176, 151, 182, 167, 100, 197, 41, 190, 200, 184, 133, 200, 125, 189, 197, 75, 160, 200, 188, 64, 138, 145, 172, 200, 122, 200, 200, 160, 169, 165, 200, 112, 89, 197, 92, 200, 84, 99, 152, 200, 200, 184, 136, 166, 121, 72, 200, 200, 192, 141, 192, 200, 200, 163, 166, 140, 132, 191, 200, 200, 200, 150, 200, 200, 200, 200, 156, 37, 193], "policy_agent_policy_reward": [745.1285629315787, 2451.65277936463, 4037.9373520840013, 2212.6039760438343, 1540.4646800392572, 982.860622045408, 2646.798969585279, 1392.834986781346, 1447.9172973738516, 1778.5585398710095, 3268.456556494076, 1273.8647383686084, 3502.1102538415316, 3782.0790849018754, 1327.1398733554306, 2558.365931265482, 1036.8764790541863, 1688.9807414691093, 1407.3941941923326, 1999.2628244477564, 694.440976702063, 566.0133921060591, 2012.4182953829147, 934.6876748006586, 1564.1992208508934, 2949.380612127673, 2588.493774607757, 3093.3937938091963, 1141.3316985887373, 2060.587588045153, 1002.9256865653427, 2997.7993155893264, 1200.9547039397478, 2721.037249156241, 2606.1304562833047, 878.907494209723, 5031.250437261444, 131.9188970050974, 1132.717144862317, 3309.6722335405907, 2876.765616395549, 2236.2906480558763, 3932.6272404557412, 2425.3891105344674, 2996.963358043553, 2210.8941968575564, 598.6460626362041, 1407.4191685774224, 4796.445322982551, 2573.232844330523, 291.67482035508516, 1111.442441478615, 2658.8963877183955, 3522.827127746565, 2785.9796579288436, 2162.0469702310234, 2365.5251166838334, 3223.431232664596, 1621.1618126486383, 1591.0450261617061, 3440.322521668861, 4349.219572815984, 1028.6961699702915, 1010.4298442366032, 2579.549171368275, 1102.9882926368205, 2443.602008675694, 984.8426301185104, 1491.846053829306, 1284.8875983707205, 3492.853174696433, 3393.2071764923417, 2505.791565824368, 1088.1596781608355, 1886.8231669711677, 1683.1360201817427, 866.0697920966059, 1817.0250322076638, 4467.736104441904, 3308.412882875105, 1006.3475121155564, 3538.764258337162, 6779.225521376025, 7437.443920798058, 3424.4191932280746, 1156.9461571758845, 1539.3472319425239, 1152.0672314498938, 3838.807153034003, 6498.209686464401, 4955.058499718972, 2729.531127943043, 1043.4087501264873, 4722.221285379496, 2507.9037018263166, 3973.1984049004714, 2259.474516400568, 1391.433810012284, 236.42642736676788, 2385.5999854282177], "policy_adversary_policy_reward": [-745.1285629315787, -3564.8101322441776, -2463.662248902472, -2970.015136833027, -4784.1507693394105, -4041.0688970616047, -5171.974351904254, -3393.574043406253, -1797.8669505145383, -1816.9468159015507, -1237.610327353958, -1006.8794066706689, -4461.838049490656, -3641.401954836946, -5258.708051958093, -1392.834986781346, -2202.0247754512457, -1563.3905686225253, -1972.6307865138954, -2054.940379988289, -4349.128921470386, -4325.742281858268, -2429.033990794598, -1344.0041394685695, -6233.738992708236, -3502.1102538415316, -5200.656275249556, -3782.0790849018754, -3016.7842296533454, -1327.1398733554306, -4029.250395645905, -2558.365931265482, -1051.5666028182854, -1879.143153557787, -1688.9807414691093, -4414.591166923183, -2498.6591865550076, -1407.3941941923326, -3527.447937737542, -1999.2628244477564, -694.440976702063, -2103.205009026156, -566.0133921060591, -2666.4930663758873, -2012.4182953829147, -4761.12467012195, -934.6876748006586, -5406.636866609417, -1564.1992208508934, -3402.3693330470333, -4654.216690149919, -2949.380612127673, -2659.2290480823544, -5069.231111231667, -3496.295472417165, -3097.1048292539876, -1141.3316985887373, -5682.798694609202, -2841.7255603531567, -2065.0489843213923, -1067.2657454209204, -1093.4605845929993, -3139.956259366996, -3428.538064054337, -3476.918968671271, -1231.779615942451, -3405.714583458532, -2721.0687490844048, -2610.456518669008, -3579.321219195764, -4761.831303861493, -878.907494209723, -5700.735824954902, -5031.602619541332, -2099.647979410147, -131.9188970050974, -1133.5870039970669, -3350.141044935802, -3309.6722335405907, -7796.611390793464, -3994.599706313072, -2906.3144649774526, -4458.811672797314, -2236.2906480558763, -5947.972013414203, -3932.628023629941, -3780.1949777598747, -2425.3891105344674, -3001.7127504150376, -3826.57976777564, -7555.034835734035, -2210.8941968575564, -598.6460626362041, -1377.7351969914437, -5246.192980016988, -1407.4191685774224, -4800.682838856484, -6145.1921364563395, -2576.859500213377, -4672.447976848947, -406.99525505636353, -489.39151898255227, -1135.1870918339723, -1774.7379239223922, -2943.4227549128314, -3630.7962832180156, -3688.3713827532047, -3693.9696544848316, -2785.9796579288436, -4058.4440522345103, -2493.4962710081536, -2199.1379263922654, -3581.9405938981363, -2606.9184250239473, -3236.8737782464773, -3412.260777887899, -2248.6039723279027, -1660.9323519066882, -1599.800502665179, -4301.240834684766, -5020.791760603945, -3440.322521668861, -4349.290607066645, -6790.784082424234, -1268.8058203209841, -1698.930317014517, -1050.6946688780647, -1241.26786478027, -2584.9102560810115, -5614.8567675547765, -1369.4192399776884, -1398.8304748594064, -2464.626518632461, -4157.100092217149, -984.8426301185104, -2761.8582596112683, -1491.846053829306, -2483.0053457620147, -1284.8875983707205, -4303.183060277541, -3493.658211802391, -4077.8052947934348, -3942.8266163960297, -3404.7241274875914, -2914.8447413030885, -2802.2831686547875, -2153.1909452598416, -1145.2165400874337, -1891.7550468273155, -2680.4647003944456, -1683.1360201817427, -4252.310854196459, -870.0616451264941, -1213.0410725608072, -3955.5043552716393, -1817.0250322076638, -4776.162067464642, -4467.736104441904, -4178.010211763222, -3309.41390089187, -3821.6468206386216, -1006.3475121155564, -3541.6722434035228, -4938.656730040911, -7064.641429341009, -6799.091784397981, -7473.11757520293, -7501.148649010574, -6565.4128366540735, -3424.4191932280746, -1156.9461571758845, -3677.7440810769585, -1539.3472319425239, -3311.0054120529703, -1153.6208922023307, -2269.1691409027585, -5031.78261584725, -3838.807153034003, -6498.209686464401, -8925.207189403918, -5300.116481583708, -6469.853328980314, -3627.880477339235, -3384.670675634466, -3049.646345697005, -1132.489457339582, -4723.908234280481, -8226.051252691374, -3116.51935483626, -4390.279345247911, -3977.196199376539, -5760.842438128253, -3794.6943788722256, -2704.4576292584984, -2484.4583749082803, -1391.433810012284, -236.42642736676788, -773.3202198658189, -2570.2283842634747, -2589.151024675814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4108394518926521, "mean_inference_ms": 0.9964506109904872, "mean_action_processing_ms": 0.17223316659474613, "mean_env_wait_ms": 0.052213175110945205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033614635467529297, "StateBufferConnector_ms": 0.0024143457412719727, "ViewRequirementAgentConnector_ms": 0.06610357761383057}, "num_episodes": 26, "episode_return_max": -604.7119536838309, "episode_return_min": -8925.207189403918, "episode_return_mean": -3990.1508040727763}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.3629535510281, "num_env_steps_trained_throughput_per_sec": 540.3629535510281, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 7440.636, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7440.603, "sample_time_ms": 732.241, "learn_time_ms": 6694.856, "learn_throughput": 597.474, "synch_weights_time_ms": 12.962}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "training_iteration": 57, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-32", "timestamp": 1723232012, "time_this_iter_s": 7.4077229499816895, "time_total_s": 438.0486912727356, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 438.0486912727356, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 24.9, "ram_util_percent": 80.86999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9956201680625478, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.973654146989187, "policy_loss": 0.0009034329448089314, "vf_loss": 9.967397993803024, "vf_explained_var": 0.0002346634864807129, "kl": 0.010573307535863326, "entropy": 1.4916870978971322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6977269587614549, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.984134455080385, "policy_loss": 0.003225979936388001, "vf_loss": 9.975968222138743, "vf_explained_var": -7.032931797088139e-05, "kl": 0.01646753137872096, "entropy": 1.1938241321573813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": -604.7119536838309, "episode_reward_min": -8925.207189403918, "episode_reward_mean": -4300.36149204851, "episode_len_mean": 166.45, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 16645, "policy_reward_min": {"agent_policy": 131.9188970050974, "adversary_policy": -8925.207189403918}, "policy_reward_max": {"agent_policy": 7877.9387712873595, "adversary_policy": -131.9188970050974}, "policy_reward_mean": {"agent_policy": 2739.8749545211285, "adversary_policy": -3520.1182232848196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2666.4930663758873, -4761.12467012195, -5406.636866609417, -3402.369333047033, -4654.216690149919, -5139.966384706264, -3500.0065078619537, -5682.798694609202, -2846.1869566293954, -1157.8006434485767, -3570.695007832006, -3507.7438806739733, -3405.7460833866962, -3583.647281581467, -4761.831303861493, -5701.088007234789, -2099.647979410147, -3351.010904070551, -7796.611390793463, -4024.148554894976, -4458.811672797314, -5947.972796588401, -3780.1949777598747, -3831.3291601471246, -7555.034835734034, -1377.7351969914437, -5246.192980016988, -6149.429652330272, -4676.074632731801, -604.7119536838309, -1798.4825742777477, -3915.322650412451, -3859.513909491472, -4058.4440522345103, -2530.587227169396, -3823.3339022382497, -3425.703323469781, -2288.3745115859524, -4309.996311188241, -5020.791760603944, -6790.855116674894, -1939.039967365208, -1281.532689421731, -5620.217852267513, -1665.2614222002744, -4178.124602173916, -2761.8582596112683, -2483.0053457620147, -4303.183060277541, -4078.6103318993946, -3954.3435673912795, -3211.336344133506, -2210.2478071864416, -2685.3965802505954, -4252.310854196459, -1217.0329255906954, -3955.5043552716393, -4776.162067464642, -4179.011229779988, -3821.646820638622, -4941.564715107272, -7084.507692362965, -7536.822303415446, -6565.412836654074, -3677.7440810769585, -3311.0054120529703, -2270.722801655196, -5031.782615847249, -8925.207189403918, -6814.911310845054, -4283.020025030661, -3138.7270529100997, -8227.738201592358, -4998.894998257852, -5764.840232604321, -4239.677491730171, -2484.458374908281, -773.3202198658189, -2773.7794235110705, -3003.463661505393, -6100.650776061044, -3146.821183366385, -7068.2872609083215, -5883.536424859845, -5339.631404476784, -6513.069671259086, -6047.60520626885, -5556.585858904768, -5142.45072416187, -3881.748627111757, -4235.207475522074, -5529.996483403001, -3956.754912658702, -3980.2417629276038, -6954.459804372353, -8372.682269677824, -3065.621605544998, -3064.287717389402, -5804.516688934059, -5501.903218395546], "episode_lengths": [83, 200, 126, 152, 200, 200, 139, 131, 166, 88, 176, 151, 182, 167, 100, 197, 41, 190, 200, 184, 133, 200, 125, 189, 197, 75, 160, 200, 188, 64, 138, 145, 172, 200, 122, 200, 200, 160, 169, 165, 200, 112, 89, 197, 92, 200, 84, 99, 152, 200, 200, 184, 136, 166, 121, 72, 200, 200, 192, 141, 192, 200, 200, 163, 166, 140, 132, 191, 200, 200, 200, 150, 200, 200, 200, 200, 156, 37, 193, 200, 200, 153, 200, 200, 200, 200, 200, 200, 150, 174, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200], "policy_agent_policy_reward": [566.0133921060591, 2012.4182953829147, 934.6876748006586, 1564.1992208508934, 2949.380612127673, 2588.493774607757, 3093.3937938091963, 1141.3316985887373, 2060.587588045153, 1002.9256865653427, 2997.7993155893264, 1200.9547039397478, 2721.037249156241, 2606.1304562833047, 878.907494209723, 5031.250437261444, 131.9188970050974, 1132.717144862317, 3309.6722335405907, 2876.765616395549, 2236.2906480558763, 3932.6272404557412, 2425.3891105344674, 2996.963358043553, 2210.8941968575564, 598.6460626362041, 1407.4191685774224, 4796.445322982551, 2573.232844330523, 291.67482035508516, 1111.442441478615, 2658.8963877183955, 3522.827127746565, 2785.9796579288436, 2162.0469702310234, 2365.5251166838334, 3223.431232664596, 1621.1618126486383, 1591.0450261617061, 3440.322521668861, 4349.219572815984, 1028.6961699702915, 1010.4298442366032, 2579.549171368275, 1102.9882926368205, 2443.602008675694, 984.8426301185104, 1491.846053829306, 1284.8875983707205, 3492.853174696433, 3393.2071764923417, 2505.791565824368, 1088.1596781608355, 1886.8231669711677, 1683.1360201817427, 866.0697920966059, 1817.0250322076638, 4467.736104441904, 3308.412882875105, 1006.3475121155564, 3538.764258337162, 6779.225521376025, 7437.443920798058, 3424.4191932280746, 1156.9461571758845, 1539.3472319425239, 1152.0672314498938, 3838.807153034003, 6498.209686464401, 4955.058499718972, 2729.531127943043, 1043.4087501264873, 4722.221285379496, 2507.9037018263166, 3973.1984049004714, 2259.474516400568, 1391.433810012284, 236.42642736676788, 2385.5999854282177, 1722.3246346773276, 5083.397784177128, 1348.2961830569557, 5851.877306801651, 2812.355957980988, 4781.574363757887, 5891.603608301308, 5642.589854005748, 3739.255316832777, 2019.7101699525504, 1732.2937454517794, 3165.5989908968386, 3741.2688445779445, 3868.2829083980014, 3207.899846636823, 5519.383156633958, 7877.9387712873595, 1394.195500881772, 2525.222081007942, 5050.471421004744, 4897.998341909017], "policy_adversary_policy_reward": [-566.0133921060591, -2666.4930663758873, -2012.4182953829147, -4761.12467012195, -934.6876748006586, -5406.636866609417, -1564.1992208508934, -3402.3693330470333, -4654.216690149919, -2949.380612127673, -2659.2290480823544, -5069.231111231667, -3496.295472417165, -3097.1048292539876, -1141.3316985887373, -5682.798694609202, -2841.7255603531567, -2065.0489843213923, -1067.2657454209204, -1093.4605845929993, -3139.956259366996, -3428.538064054337, -3476.918968671271, -1231.779615942451, -3405.714583458532, -2721.0687490844048, -2610.456518669008, -3579.321219195764, -4761.831303861493, -878.907494209723, -5700.735824954902, -5031.602619541332, -2099.647979410147, -131.9188970050974, -1133.5870039970669, -3350.141044935802, -3309.6722335405907, -7796.611390793464, -3994.599706313072, -2906.3144649774526, -4458.811672797314, -2236.2906480558763, -5947.972013414203, -3932.628023629941, -3780.1949777598747, -2425.3891105344674, -3001.7127504150376, -3826.57976777564, -7555.034835734035, -2210.8941968575564, -598.6460626362041, -1377.7351969914437, -5246.192980016988, -1407.4191685774224, -4800.682838856484, -6145.1921364563395, -2576.859500213377, -4672.447976848947, -406.99525505636353, -489.39151898255227, -1135.1870918339723, -1774.7379239223922, -2943.4227549128314, -3630.7962832180156, -3688.3713827532047, -3693.9696544848316, -2785.9796579288436, -4058.4440522345103, -2493.4962710081536, -2199.1379263922654, -3581.9405938981363, -2606.9184250239473, -3236.8737782464773, -3412.260777887899, -2248.6039723279027, -1660.9323519066882, -1599.800502665179, -4301.240834684766, -5020.791760603945, -3440.322521668861, -4349.290607066645, -6790.784082424234, -1268.8058203209841, -1698.930317014517, -1050.6946688780647, -1241.26786478027, -2584.9102560810115, -5614.8567675547765, -1369.4192399776884, -1398.8304748594064, -2464.626518632461, -4157.100092217149, -984.8426301185104, -2761.8582596112683, -1491.846053829306, -2483.0053457620147, -1284.8875983707205, -4303.183060277541, -3493.658211802391, -4077.8052947934348, -3942.8266163960297, -3404.7241274875914, -2914.8447413030885, -2802.2831686547875, -2153.1909452598416, -1145.2165400874337, -1891.7550468273155, -2680.4647003944456, -1683.1360201817427, -4252.310854196459, -870.0616451264941, -1213.0410725608072, -3955.5043552716393, -1817.0250322076638, -4776.162067464642, -4467.736104441904, -4178.010211763222, -3309.41390089187, -3821.6468206386216, -1006.3475121155564, -3541.6722434035228, -4938.656730040911, -7064.641429341009, -6799.091784397981, -7473.11757520293, -7501.148649010574, -6565.4128366540735, -3424.4191932280746, -1156.9461571758845, -3677.7440810769585, -1539.3472319425239, -3311.0054120529703, -1153.6208922023307, -2269.1691409027585, -5031.78261584725, -3838.807153034003, -6498.209686464401, -8925.207189403918, -5300.116481583708, -6469.853328980314, -3627.880477339235, -3384.670675634466, -3049.646345697005, -1132.489457339582, -4723.908234280481, -8226.051252691374, -3116.51935483626, -4390.279345247911, -3977.196199376539, -5760.842438128253, -3794.6943788722256, -2704.4576292584984, -2484.4583749082803, -1391.433810012284, -236.42642736676788, -773.3202198658189, -2570.2283842634747, -2589.151024675814, -1722.3246346773276, -3003.463661505393, -5232.036405976221, -5952.012154261945, -3144.9382012656233, -1350.179165157716, -5853.497684162959, -7066.66688354701, -2812.355957980988, -5883.536424859845, -5024.297859950796, -5096.907908283876, -6397.927413473595, -6006.745866086801, -5848.345441968214, -5841.849618306385, -4514.210372888809, -4781.630802848739, -2019.7101699525504, -5142.45072416187, -2153.2962687404483, -3460.7461038230863, -4162.244012948268, -3238.562453470643, -3741.352979889845, -5529.9123480911, -3955.348391348637, -3869.6894297080667, -3968.3374527459405, -3219.8041568184863, -6953.239559794004, -5520.6034012123055, -8372.682269677824, -7877.9387712873595, -1394.195500881772, -3065.6216055449986, -3031.8651235049624, -2557.6446748923813, -5060.463182895665, -5794.5249270431395, -5020.993017354623, -5378.90854294994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4106291958221177, "mean_inference_ms": 0.9948096173066518, "mean_action_processing_ms": 0.1720801754812719, "mean_env_wait_ms": 0.05213514201907758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033162832260131836, "StateBufferConnector_ms": 0.0024088621139526367, "ViewRequirementAgentConnector_ms": 0.0669180154800415}, "num_episodes": 21, "episode_return_max": -604.7119536838309, "episode_return_min": -8925.207189403918, "episode_return_mean": -4300.36149204851}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.2795120875171, "num_env_steps_trained_throughput_per_sec": 548.2795120875171, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 7421.152, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7421.12, "sample_time_ms": 732.328, "learn_time_ms": 6675.36, "learn_throughput": 599.219, "synch_weights_time_ms": 12.928}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 58, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-39", "timestamp": 1723232019, "time_this_iter_s": 7.30012583732605, "time_total_s": 445.34881711006165, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ed9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 445.34881711006165, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 23.40909090909091, "ram_util_percent": 80.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9640751099213958, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.957830089330674, "policy_loss": -0.003165406447078567, "vf_loss": 9.957995291550954, "vf_explained_var": 0.00076211579144001, "kl": 0.00592630898366527, "entropy": 1.5061410521467526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7136793404896423, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983897953941709, "policy_loss": 0.0016508476806203366, "vf_loss": 9.977890237172444, "vf_explained_var": 0.00044359028654754475, "kl": 0.014522870731535097, "entropy": 1.2203796372842537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "env_runners": {"episode_reward_max": -604.7119536838309, "episode_reward_min": -9569.420712485899, "episode_reward_mean": -4566.482311809963, "episode_len_mean": 172.07, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17207, "policy_reward_min": {"agent_policy": 236.42642736676788, "adversary_policy": -9569.312153565555}, "policy_reward_max": {"agent_policy": 7943.157951551051, "adversary_policy": -236.42642736676788}, "policy_reward_mean": {"agent_policy": 3036.982876570899, "adversary_policy": -3801.73259419043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3780.1949777598747, -3831.3291601471246, -7555.034835734034, -1377.7351969914437, -5246.192980016988, -6149.429652330272, -4676.074632731801, -604.7119536838309, -1798.4825742777477, -3915.322650412451, -3859.513909491472, -4058.4440522345103, -2530.587227169396, -3823.3339022382497, -3425.703323469781, -2288.3745115859524, -4309.996311188241, -5020.791760603944, -6790.855116674894, -1939.039967365208, -1281.532689421731, -5620.217852267513, -1665.2614222002744, -4178.124602173916, -2761.8582596112683, -2483.0053457620147, -4303.183060277541, -4078.6103318993946, -3954.3435673912795, -3211.336344133506, -2210.2478071864416, -2685.3965802505954, -4252.310854196459, -1217.0329255906954, -3955.5043552716393, -4776.162067464642, -4179.011229779988, -3821.646820638622, -4941.564715107272, -7084.507692362965, -7536.822303415446, -6565.412836654074, -3677.7440810769585, -3311.0054120529703, -2270.722801655196, -5031.782615847249, -8925.207189403918, -6814.911310845054, -4283.020025030661, -3138.7270529100997, -8227.738201592358, -4998.894998257852, -5764.840232604321, -4239.677491730171, -2484.458374908281, -773.3202198658189, -2773.7794235110705, -3003.463661505393, -6100.650776061044, -3146.821183366385, -7068.2872609083215, -5883.536424859845, -5339.631404476784, -6513.069671259086, -6047.60520626885, -5556.585858904768, -5142.45072416187, -3881.748627111757, -4235.207475522074, -5529.996483403001, -3956.754912658702, -3980.2417629276038, -6954.459804372353, -8372.682269677824, -3065.621605544998, -3064.287717389402, -5804.516688934059, -5501.903218395546, -8228.275382794609, -8715.454308669772, -3677.319525624729, -4447.25360358509, -5080.258162730626, -1473.3432477008232, -6401.046488720258, -6134.631025731705, -4483.51400831472, -3034.0025642488013, -7042.203678985507, -1155.4392836091033, -6321.245519111161, -8971.330851041073, -5295.102396820391, -2648.2174632668725, -7133.308387323951, -1821.2955231161468, -5751.658034225335, -9569.420712485899, -5137.650192687566, -5516.66629203599], "episode_lengths": [125, 189, 197, 75, 160, 200, 188, 64, 138, 145, 172, 200, 122, 200, 200, 160, 169, 165, 200, 112, 89, 197, 92, 200, 84, 99, 152, 200, 200, 184, 136, 166, 121, 72, 200, 200, 192, 141, 192, 200, 200, 163, 166, 140, 132, 191, 200, 200, 200, 150, 200, 200, 200, 200, 156, 37, 193, 200, 200, 153, 200, 200, 200, 200, 200, 200, 150, 174, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 174, 200, 200, 41, 200, 200, 200, 189, 200, 141, 200, 200, 160, 200], "policy_agent_policy_reward": [2425.3891105344674, 2996.963358043553, 2210.8941968575564, 598.6460626362041, 1407.4191685774224, 4796.445322982551, 2573.232844330523, 291.67482035508516, 1111.442441478615, 2658.8963877183955, 3522.827127746565, 2785.9796579288436, 2162.0469702310234, 2365.5251166838334, 3223.431232664596, 1621.1618126486383, 1591.0450261617061, 3440.322521668861, 4349.219572815984, 1028.6961699702915, 1010.4298442366032, 2579.549171368275, 1102.9882926368205, 2443.602008675694, 984.8426301185104, 1491.846053829306, 1284.8875983707205, 3492.853174696433, 3393.2071764923417, 2505.791565824368, 1088.1596781608355, 1886.8231669711677, 1683.1360201817427, 866.0697920966059, 1817.0250322076638, 4467.736104441904, 3308.412882875105, 1006.3475121155564, 3538.764258337162, 6779.225521376025, 7437.443920798058, 3424.4191932280746, 1156.9461571758845, 1539.3472319425239, 1152.0672314498938, 3838.807153034003, 6498.209686464401, 4955.058499718972, 2729.531127943043, 1043.4087501264873, 4722.221285379496, 2507.9037018263166, 3973.1984049004714, 2259.474516400568, 1391.433810012284, 236.42642736676788, 2385.5999854282177, 1722.3246346773276, 5083.397784177128, 1348.2961830569557, 5851.877306801651, 2812.355957980988, 4781.574363757887, 5891.603608301308, 5642.589854005748, 3739.255316832777, 2019.7101699525504, 1732.2937454517794, 3165.5989908968386, 3741.2688445779445, 3868.2829083980014, 3207.899846636823, 5519.383156633958, 7877.9387712873595, 1394.195500881772, 2525.222081007942, 5050.471421004744, 4897.998341909017, 7717.540186636497, 7207.471273896488, 2011.1113504967825, 2208.1049362637223, 2959.740557178579, 526.078853019395, 5188.5840874472, 4517.423365758727, 1573.3580523712064, 1862.9263265827237, 3762.743776123735, 272.0993048806841, 4588.183736992438, 7943.157951551051, 4101.68947228315, 1372.4064584919668, 4981.801630324527, 956.9904028381061, 2857.2878145528753, 6004.6913755050455, 1558.0543540014671, 2508.8501114200044], "policy_adversary_policy_reward": [-3780.1949777598747, -2425.3891105344674, -3001.7127504150376, -3826.57976777564, -7555.034835734035, -2210.8941968575564, -598.6460626362041, -1377.7351969914437, -5246.192980016988, -1407.4191685774224, -4800.682838856484, -6145.1921364563395, -2576.859500213377, -4672.447976848947, -406.99525505636353, -489.39151898255227, -1135.1870918339723, -1774.7379239223922, -2943.4227549128314, -3630.7962832180156, -3688.3713827532047, -3693.9696544848316, -2785.9796579288436, -4058.4440522345103, -2493.4962710081536, -2199.1379263922654, -3581.9405938981363, -2606.9184250239473, -3236.8737782464773, -3412.260777887899, -2248.6039723279027, -1660.9323519066882, -1599.800502665179, -4301.240834684766, -5020.791760603945, -3440.322521668861, -4349.290607066645, -6790.784082424234, -1268.8058203209841, -1698.930317014517, -1050.6946688780647, -1241.26786478027, -2584.9102560810115, -5614.8567675547765, -1369.4192399776884, -1398.8304748594064, -2464.626518632461, -4157.100092217149, -984.8426301185104, -2761.8582596112683, -1491.846053829306, -2483.0053457620147, -1284.8875983707205, -4303.183060277541, -3493.658211802391, -4077.8052947934348, -3942.8266163960297, -3404.7241274875914, -2914.8447413030885, -2802.2831686547875, -2153.1909452598416, -1145.2165400874337, -1891.7550468273155, -2680.4647003944456, -1683.1360201817427, -4252.310854196459, -870.0616451264941, -1213.0410725608072, -3955.5043552716393, -1817.0250322076638, -4776.162067464642, -4467.736104441904, -4178.010211763222, -3309.41390089187, -3821.6468206386216, -1006.3475121155564, -3541.6722434035228, -4938.656730040911, -7064.641429341009, -6799.091784397981, -7473.11757520293, -7501.148649010574, -6565.4128366540735, -3424.4191932280746, -1156.9461571758845, -3677.7440810769585, -1539.3472319425239, -3311.0054120529703, -1153.6208922023307, -2269.1691409027585, -5031.78261584725, -3838.807153034003, -6498.209686464401, -8925.207189403918, -5300.116481583708, -6469.853328980314, -3627.880477339235, -3384.670675634466, -3049.646345697005, -1132.489457339582, -4723.908234280481, -8226.051252691374, -3116.51935483626, -4390.279345247911, -3977.196199376539, -5760.842438128253, -3794.6943788722256, -2704.4576292584984, -2484.4583749082803, -1391.433810012284, -236.42642736676788, -773.3202198658189, -2570.2283842634747, -2589.151024675814, -1722.3246346773276, -3003.463661505393, -5232.036405976221, -5952.012154261945, -3144.9382012656233, -1350.179165157716, -5853.497684162959, -7066.66688354701, -2812.355957980988, -5883.536424859845, -5024.297859950796, -5096.907908283876, -6397.927413473595, -6006.745866086801, -5848.345441968214, -5841.849618306385, -4514.210372888809, -4781.630802848739, -2019.7101699525504, -5142.45072416187, -2153.2962687404483, -3460.7461038230863, -4162.244012948268, -3238.562453470643, -3741.352979889845, -5529.9123480911, -3955.348391348637, -3869.6894297080667, -3968.3374527459405, -3219.8041568184863, -6953.239559794004, -5520.6034012123055, -8372.682269677824, -7877.9387712873595, -1394.195500881772, -3065.6216055449986, -3031.8651235049624, -2557.6446748923813, -5060.463182895665, -5794.5249270431395, -5020.993017354623, -5378.90854294994, -7991.169117216477, -7954.646452214629, -8715.069542068577, -7207.856040497683, -2011.647908181654, -3676.782967939856, -3996.444060506948, -2658.9144793418577, -2959.7890669030917, -5080.2096530061135, -1473.343247700823, -526.078853019395, -6400.5131562304805, -5189.117419936979, -4517.468754314416, -6134.5856371760165, -4483.3338403562, -1573.5382203297254, -3033.815437892815, -1863.1134529387095, -3762.743776123735, -7042.203678985507, -272.0993048806841, -1155.4392836091033, -4878.118346317199, -6031.310909786384, -8958.470185529142, -7956.018617062981, -4740.449759174432, -4656.34210992911, -2642.2293647356128, -1378.3945570232263, -7132.24502193036, -4982.864995718116, -1049.0247435875356, -1729.2611823667166, -2860.468765027283, -5748.477083750925, -6004.799934425389, -9569.312153565555, -5137.650192687566, -1558.0543540014671, -5516.666292035991, -2508.8501114200044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41033888586628636, "mean_inference_ms": 0.9927875238360906, "mean_action_processing_ms": 0.17195909664758957, "mean_env_wait_ms": 0.052091956890558636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00336456298828125, "StateBufferConnector_ms": 0.0023697614669799805, "ViewRequirementAgentConnector_ms": 0.06593132019042969}, "num_episodes": 22, "episode_return_max": -604.7119536838309, "episode_return_min": -9569.420712485899, "episode_return_mean": -4566.482311809963}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.3617256539725, "num_env_steps_trained_throughput_per_sec": 547.3617256539725, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 7390.5, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7390.468, "sample_time_ms": 734.338, "learn_time_ms": 6642.861, "learn_throughput": 602.15, "synch_weights_time_ms": 12.812}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "training_iteration": 59, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-47", "timestamp": 1723232027, "time_this_iter_s": 7.313667058944702, "time_total_s": 452.66248416900635, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edbd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 452.66248416900635, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.35454545454546, "ram_util_percent": 80.87272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0135968243392806, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.972548666596413, "policy_loss": -0.0042599283755407665, "vf_loss": 9.97132159570853, "vf_explained_var": 2.8499898811181386e-05, "kl": 0.010838499788466531, "entropy": 1.5437354054301977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7671057900660252, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994539162973878, "policy_loss": 0.0017542429398942404, "vf_loss": 9.989089036366297, "vf_explained_var": 0.00023048460168182533, "kl": 0.012319593256457694, "entropy": 1.229218190687674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": -773.3202198658189, "episode_reward_min": -9882.032629484656, "episode_reward_mean": -4917.3112235584995, "episode_len_mean": 176.74, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 17674, "policy_reward_min": {"agent_policy": 210.6450248053732, "adversary_policy": -9882.032629484656}, "policy_reward_max": {"agent_policy": 7971.931895148905, "adversary_policy": -210.6450248053732}, "policy_reward_mean": {"agent_policy": 3278.434409412096, "adversary_policy": -4097.872816485297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5620.217852267513, -1665.2614222002744, -4178.124602173916, -2761.8582596112683, -2483.0053457620147, -4303.183060277541, -4078.6103318993946, -3954.3435673912795, -3211.336344133506, -2210.2478071864416, -2685.3965802505954, -4252.310854196459, -1217.0329255906954, -3955.5043552716393, -4776.162067464642, -4179.011229779988, -3821.646820638622, -4941.564715107272, -7084.507692362965, -7536.822303415446, -6565.412836654074, -3677.7440810769585, -3311.0054120529703, -2270.722801655196, -5031.782615847249, -8925.207189403918, -6814.911310845054, -4283.020025030661, -3138.7270529100997, -8227.738201592358, -4998.894998257852, -5764.840232604321, -4239.677491730171, -2484.458374908281, -773.3202198658189, -2773.7794235110705, -3003.463661505393, -6100.650776061044, -3146.821183366385, -7068.2872609083215, -5883.536424859845, -5339.631404476784, -6513.069671259086, -6047.60520626885, -5556.585858904768, -5142.45072416187, -3881.748627111757, -4235.207475522074, -5529.996483403001, -3956.754912658702, -3980.2417629276038, -6954.459804372353, -8372.682269677824, -3065.621605544998, -3064.287717389402, -5804.516688934059, -5501.903218395546, -8228.275382794609, -8715.454308669772, -3677.319525624729, -4447.25360358509, -5080.258162730626, -1473.3432477008232, -6401.046488720258, -6134.631025731705, -4483.51400831472, -3034.0025642488013, -7042.203678985507, -1155.4392836091033, -6321.245519111161, -8971.330851041073, -5295.102396820391, -2648.2174632668725, -7133.308387323951, -1821.2955231161468, -5751.658034225335, -9569.420712485899, -5137.650192687566, -5516.66629203599, -2560.4940630878878, -5114.760160050326, -1914.6851032088196, -6713.534499758111, -5396.078434388664, -2529.3413533715825, -6246.292292573538, -7111.602878055115, -9882.032629484656, -2065.902641171692, -5772.93373131081, -6997.210229759341, -6595.911150666413, -6907.247780031183, -9839.111327848781, -5895.16205391806, -3438.099517828187, -1999.9955029342077, -8004.264138740845, -5113.240721284022, -3247.672350910414], "episode_lengths": [197, 92, 200, 84, 99, 152, 200, 200, 184, 136, 166, 121, 72, 200, 200, 192, 141, 192, 200, 200, 163, 166, 140, 132, 191, 200, 200, 200, 150, 200, 200, 200, 200, 156, 37, 193, 200, 200, 153, 200, 200, 200, 200, 200, 200, 150, 174, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 174, 200, 200, 41, 200, 200, 200, 189, 200, 141, 200, 200, 160, 200, 178, 200, 64, 200, 200, 200, 200, 200, 200, 121, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 127], "policy_agent_policy_reward": [2579.549171368275, 1102.9882926368205, 2443.602008675694, 984.8426301185104, 1491.846053829306, 1284.8875983707205, 3492.853174696433, 3393.2071764923417, 2505.791565824368, 1088.1596781608355, 1886.8231669711677, 1683.1360201817427, 866.0697920966059, 1817.0250322076638, 4467.736104441904, 3308.412882875105, 1006.3475121155564, 3538.764258337162, 6779.225521376025, 7437.443920798058, 3424.4191932280746, 1156.9461571758845, 1539.3472319425239, 1152.0672314498938, 3838.807153034003, 6498.209686464401, 4955.058499718972, 2729.531127943043, 1043.4087501264873, 4722.221285379496, 2507.9037018263166, 3973.1984049004714, 2259.474516400568, 1391.433810012284, 236.42642736676788, 2385.5999854282177, 1722.3246346773276, 5083.397784177128, 1348.2961830569557, 5851.877306801651, 2812.355957980988, 4781.574363757887, 5891.603608301308, 5642.589854005748, 3739.255316832777, 2019.7101699525504, 1732.2937454517794, 3165.5989908968386, 3741.2688445779445, 3868.2829083980014, 3207.899846636823, 5519.383156633958, 7877.9387712873595, 1394.195500881772, 2525.222081007942, 5050.471421004744, 4897.998341909017, 7717.540186636497, 7207.471273896488, 2011.1113504967825, 2208.1049362637223, 2959.740557178579, 526.078853019395, 5188.5840874472, 4517.423365758727, 1573.3580523712064, 1862.9263265827237, 3762.743776123735, 272.0993048806841, 4588.183736992438, 7943.157951551051, 4101.68947228315, 1372.4064584919668, 4981.801630324527, 956.9904028381061, 2857.2878145528753, 6004.6913755050455, 1558.0543540014671, 2508.8501114200044, 1274.3973212224125, 2498.97110031314, 511.0023080309736, 4308.059506391946, 4715.748983864352, 926.5383483632771, 4301.25427541647, 4231.155941438183, 3143.7843371767476, 1561.3137840734123, 5294.482328715437, 3000.929552622667, 6080.616213837496, 5087.811506661052, 7971.931895148905, 2718.1306691553214, 3334.556834182113, 210.6450248053732, 5536.152142964878, 4781.677118965841, 827.6828570410642], "policy_adversary_policy_reward": [-2584.9102560810115, -5614.8567675547765, -1369.4192399776884, -1398.8304748594064, -2464.626518632461, -4157.100092217149, -984.8426301185104, -2761.8582596112683, -1491.846053829306, -2483.0053457620147, -1284.8875983707205, -4303.183060277541, -3493.658211802391, -4077.8052947934348, -3942.8266163960297, -3404.7241274875914, -2914.8447413030885, -2802.2831686547875, -2153.1909452598416, -1145.2165400874337, -1891.7550468273155, -2680.4647003944456, -1683.1360201817427, -4252.310854196459, -870.0616451264941, -1213.0410725608072, -3955.5043552716393, -1817.0250322076638, -4776.162067464642, -4467.736104441904, -4178.010211763222, -3309.41390089187, -3821.6468206386216, -1006.3475121155564, -3541.6722434035228, -4938.656730040911, -7064.641429341009, -6799.091784397981, -7473.11757520293, -7501.148649010574, -6565.4128366540735, -3424.4191932280746, -1156.9461571758845, -3677.7440810769585, -1539.3472319425239, -3311.0054120529703, -1153.6208922023307, -2269.1691409027585, -5031.78261584725, -3838.807153034003, -6498.209686464401, -8925.207189403918, -5300.116481583708, -6469.853328980314, -3627.880477339235, -3384.670675634466, -3049.646345697005, -1132.489457339582, -4723.908234280481, -8226.051252691374, -3116.51935483626, -4390.279345247911, -3977.196199376539, -5760.842438128253, -3794.6943788722256, -2704.4576292584984, -2484.4583749082803, -1391.433810012284, -236.42642736676788, -773.3202198658189, -2570.2283842634747, -2589.151024675814, -1722.3246346773276, -3003.463661505393, -5232.036405976221, -5952.012154261945, -3144.9382012656233, -1350.179165157716, -5853.497684162959, -7066.66688354701, -2812.355957980988, -5883.536424859845, -5024.297859950796, -5096.907908283876, -6397.927413473595, -6006.745866086801, -5848.345441968214, -5841.849618306385, -4514.210372888809, -4781.630802848739, -2019.7101699525504, -5142.45072416187, -2153.2962687404483, -3460.7461038230863, -4162.244012948268, -3238.562453470643, -3741.352979889845, -5529.9123480911, -3955.348391348637, -3869.6894297080667, -3968.3374527459405, -3219.8041568184863, -6953.239559794004, -5520.6034012123055, -8372.682269677824, -7877.9387712873595, -1394.195500881772, -3065.6216055449986, -3031.8651235049624, -2557.6446748923813, -5060.463182895665, -5794.5249270431395, -5020.993017354623, -5378.90854294994, -7991.169117216477, -7954.646452214629, -8715.069542068577, -7207.856040497683, -2011.647908181654, -3676.782967939856, -3996.444060506948, -2658.9144793418577, -2959.7890669030917, -5080.2096530061135, -1473.343247700823, -526.078853019395, -6400.5131562304805, -5189.117419936979, -4517.468754314416, -6134.5856371760165, -4483.3338403562, -1573.5382203297254, -3033.815437892815, -1863.1134529387095, -3762.743776123735, -7042.203678985507, -272.0993048806841, -1155.4392836091033, -4878.118346317199, -6031.310909786384, -8958.470185529142, -7956.018617062981, -4740.449759174432, -4656.34210992911, -2642.2293647356128, -1378.3945570232263, -7132.24502193036, -4982.864995718116, -1049.0247435875356, -1729.2611823667166, -2860.468765027283, -5748.477083750925, -6004.799934425389, -9569.312153565555, -5137.650192687566, -1558.0543540014671, -5516.666292035991, -2508.8501114200044, -1603.3283553311612, -2231.5630289791256, -2498.97110031314, -5114.760160050326, -1914.6851032088198, -511.0023080309736, -4337.312789973994, -6684.281216176066, -5022.253976734966, -5089.57344151805, -940.5808604467145, -2515.298841288146, -4306.506981878176, -6241.039586111832, -4252.473125017911, -7090.285694475398, -9882.032629484656, -3143.7843371767476, -1584.5615792333012, -2042.6548460118026, -5772.730939531763, -5294.685120494483, -6997.210229759341, -3000.929552622667, -6098.09324630028, -6578.43411820363, -6907.128465376275, -5087.930821315959, -9835.291613790125, -7975.75160920756, -2719.3097540289227, -5893.9829690444485, -3358.5861421802656, -3414.0702098300353, -210.6450248053732, -1999.9955029342077, -5536.226275158594, -8004.190006547129, -4791.789367974096, -5103.128472275767, -3247.6723509104145, -827.6828570410642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4100498702811822, "mean_inference_ms": 0.9929807982314571, "mean_action_processing_ms": 0.17188837263212597, "mean_env_wait_ms": 0.05206530094244127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464221954345703, "StateBufferConnector_ms": 0.002373337745666504, "ViewRequirementAgentConnector_ms": 0.06629705429077148}, "num_episodes": 21, "episode_return_max": -773.3202198658189, "episode_return_min": -9882.032629484656, "episode_return_mean": -4917.3112235584995}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.4715942940052, "num_env_steps_trained_throughput_per_sec": 540.4715942940052, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 7407.025, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7406.992, "sample_time_ms": 733.696, "learn_time_ms": 6660.155, "learn_throughput": 600.587, "synch_weights_time_ms": 12.685}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 60, "trial_id": "3439d_00000", "date": "2024-08-09_15-33-54", "timestamp": 1723232034, "time_this_iter_s": 7.405663967132568, "time_total_s": 460.0681481361389, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 460.0681481361389, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.2, "ram_util_percent": 81.31}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0022119119142492, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98952849507332, "policy_loss": -0.004011240237984263, "vf_loss": 9.989677450060844, "vf_explained_var": -9.505655616521835e-05, "kl": 0.00762919003367036, "entropy": 1.5338646505028009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7096625405329245, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000440555148655, "policy_loss": 0.0018473603111006831, "vf_loss": 9.994994863883528, "vf_explained_var": 4.9710620648015746e-05, "kl": 0.01199444677316086, "entropy": 1.2387528061236024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "env_runners": {"episode_reward_max": -217.72284320815413, "episode_reward_min": -9882.032629484656, "episode_reward_mean": -5503.578251687323, "episode_len_mean": 181.91, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18191, "policy_reward_min": {"agent_policy": 84.84978732366486, "adversary_policy": -9882.032629484656}, "policy_reward_max": {"agent_policy": 8627.325759619638, "adversary_policy": -84.84978732366486}, "policy_reward_mean": {"agent_policy": 3838.4266734895796, "adversary_policy": -4671.002462588451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3677.7440810769585, -3311.0054120529703, -2270.722801655196, -5031.782615847249, -8925.207189403918, -6814.911310845054, -4283.020025030661, -3138.7270529100997, -8227.738201592358, -4998.894998257852, -5764.840232604321, -4239.677491730171, -2484.458374908281, -773.3202198658189, -2773.7794235110705, -3003.463661505393, -6100.650776061044, -3146.821183366385, -7068.2872609083215, -5883.536424859845, -5339.631404476784, -6513.069671259086, -6047.60520626885, -5556.585858904768, -5142.45072416187, -3881.748627111757, -4235.207475522074, -5529.996483403001, -3956.754912658702, -3980.2417629276038, -6954.459804372353, -8372.682269677824, -3065.621605544998, -3064.287717389402, -5804.516688934059, -5501.903218395546, -8228.275382794609, -8715.454308669772, -3677.319525624729, -4447.25360358509, -5080.258162730626, -1473.3432477008232, -6401.046488720258, -6134.631025731705, -4483.51400831472, -3034.0025642488013, -7042.203678985507, -1155.4392836091033, -6321.245519111161, -8971.330851041073, -5295.102396820391, -2648.2174632668725, -7133.308387323951, -1821.2955231161468, -5751.658034225335, -9569.420712485899, -5137.650192687566, -5516.66629203599, -2560.4940630878878, -5114.760160050326, -1914.6851032088196, -6713.534499758111, -5396.078434388664, -2529.3413533715825, -6246.292292573538, -7111.602878055115, -9882.032629484656, -2065.902641171692, -5772.93373131081, -6997.210229759341, -6595.911150666413, -6907.247780031183, -9839.111327848781, -5895.16205391806, -3438.099517828187, -1999.9955029342077, -8004.264138740845, -5113.240721284022, -3247.672350910414, -4805.319537288559, -9740.016835963792, -9444.180094614532, -2325.2337492717593, -7152.506030694506, -9600.735967844821, -217.72284320815413, -7902.519635356058, -5672.900674608443, -9014.938772937656, -4011.718897280078, -8752.303070751661, -7326.328510563691, -8934.698883942923, -8669.208079175252, -6318.806720759135, -3100.359254026005, -6347.146648309206, -8262.421779293365, -7140.701643640152, -9368.49615698809], "episode_lengths": [166, 140, 132, 191, 200, 200, 200, 150, 200, 200, 200, 200, 156, 37, 193, 200, 200, 153, 200, 200, 200, 200, 200, 200, 150, 174, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 174, 200, 200, 41, 200, 200, 200, 189, 200, 141, 200, 200, 160, 200, 178, 200, 64, 200, 200, 200, 200, 200, 200, 121, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 127, 200, 200, 200, 88, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1156.9461571758845, 1539.3472319425239, 1152.0672314498938, 3838.807153034003, 6498.209686464401, 4955.058499718972, 2729.531127943043, 1043.4087501264873, 4722.221285379496, 2507.9037018263166, 3973.1984049004714, 2259.474516400568, 1391.433810012284, 236.42642736676788, 2385.5999854282177, 1722.3246346773276, 5083.397784177128, 1348.2961830569557, 5851.877306801651, 2812.355957980988, 4781.574363757887, 5891.603608301308, 5642.589854005748, 3739.255316832777, 2019.7101699525504, 1732.2937454517794, 3165.5989908968386, 3741.2688445779445, 3868.2829083980014, 3207.899846636823, 5519.383156633958, 7877.9387712873595, 1394.195500881772, 2525.222081007942, 5050.471421004744, 4897.998341909017, 7717.540186636497, 7207.471273896488, 2011.1113504967825, 2208.1049362637223, 2959.740557178579, 526.078853019395, 5188.5840874472, 4517.423365758727, 1573.3580523712064, 1862.9263265827237, 3762.743776123735, 272.0993048806841, 4588.183736992438, 7943.157951551051, 4101.68947228315, 1372.4064584919668, 4981.801630324527, 956.9904028381061, 2857.2878145528753, 6004.6913755050455, 1558.0543540014671, 2508.8501114200044, 1274.3973212224125, 2498.97110031314, 511.0023080309736, 4308.059506391946, 4715.748983864352, 926.5383483632771, 4301.25427541647, 4231.155941438183, 3143.7843371767476, 1561.3137840734123, 5294.482328715437, 3000.929552622667, 6080.616213837496, 5087.811506661052, 7971.931895148905, 2718.1306691553214, 3334.556834182113, 210.6450248053732, 5536.152142964878, 4781.677118965841, 827.6828570410642, 4579.913842050723, 5251.470234471604, 8627.325759619638, 609.9674358913052, 6554.637757566196, 7702.114088643304, 84.84978732366486, 7259.168537802549, 4300.412425337813, 7024.075657706595, 3141.226763666053, 8317.451112347399, 4795.0277362795005, 6396.250018933125, 5514.57053116377, 5237.215470075191, 2370.7799285361543, 3680.436685842385, 7988.671853340683, 6284.98592640381, 6861.805609549168], "policy_adversary_policy_reward": [-1156.9461571758845, -3677.7440810769585, -1539.3472319425239, -3311.0054120529703, -1153.6208922023307, -2269.1691409027585, -5031.78261584725, -3838.807153034003, -6498.209686464401, -8925.207189403918, -5300.116481583708, -6469.853328980314, -3627.880477339235, -3384.670675634466, -3049.646345697005, -1132.489457339582, -4723.908234280481, -8226.051252691374, -3116.51935483626, -4390.279345247911, -3977.196199376539, -5760.842438128253, -3794.6943788722256, -2704.4576292584984, -2484.4583749082803, -1391.433810012284, -236.42642736676788, -773.3202198658189, -2570.2283842634747, -2589.151024675814, -1722.3246346773276, -3003.463661505393, -5232.036405976221, -5952.012154261945, -3144.9382012656233, -1350.179165157716, -5853.497684162959, -7066.66688354701, -2812.355957980988, -5883.536424859845, -5024.297859950796, -5096.907908283876, -6397.927413473595, -6006.745866086801, -5848.345441968214, -5841.849618306385, -4514.210372888809, -4781.630802848739, -2019.7101699525504, -5142.45072416187, -2153.2962687404483, -3460.7461038230863, -4162.244012948268, -3238.562453470643, -3741.352979889845, -5529.9123480911, -3955.348391348637, -3869.6894297080667, -3968.3374527459405, -3219.8041568184863, -6953.239559794004, -5520.6034012123055, -8372.682269677824, -7877.9387712873595, -1394.195500881772, -3065.6216055449986, -3031.8651235049624, -2557.6446748923813, -5060.463182895665, -5794.5249270431395, -5020.993017354623, -5378.90854294994, -7991.169117216477, -7954.646452214629, -8715.069542068577, -7207.856040497683, -2011.647908181654, -3676.782967939856, -3996.444060506948, -2658.9144793418577, -2959.7890669030917, -5080.2096530061135, -1473.343247700823, -526.078853019395, -6400.5131562304805, -5189.117419936979, -4517.468754314416, -6134.5856371760165, -4483.3338403562, -1573.5382203297254, -3033.815437892815, -1863.1134529387095, -3762.743776123735, -7042.203678985507, -272.0993048806841, -1155.4392836091033, -4878.118346317199, -6031.310909786384, -8958.470185529142, -7956.018617062981, -4740.449759174432, -4656.34210992911, -2642.2293647356128, -1378.3945570232263, -7132.24502193036, -4982.864995718116, -1049.0247435875356, -1729.2611823667166, -2860.468765027283, -5748.477083750925, -6004.799934425389, -9569.312153565555, -5137.650192687566, -1558.0543540014671, -5516.666292035991, -2508.8501114200044, -1603.3283553311612, -2231.5630289791256, -2498.97110031314, -5114.760160050326, -1914.6851032088198, -511.0023080309736, -4337.312789973994, -6684.281216176066, -5022.253976734966, -5089.57344151805, -940.5808604467145, -2515.298841288146, -4306.506981878176, -6241.039586111832, -4252.473125017911, -7090.285694475398, -9882.032629484656, -3143.7843371767476, -1584.5615792333012, -2042.6548460118026, -5772.730939531763, -5294.685120494483, -6997.210229759341, -3000.929552622667, -6098.09324630028, -6578.43411820363, -6907.128465376275, -5087.930821315959, -9835.291613790125, -7975.75160920756, -2719.3097540289227, -5893.9829690444485, -3358.5861421802656, -3414.0702098300353, -210.6450248053732, -1999.9955029342077, -5536.226275158594, -8004.190006547129, -4791.789367974096, -5103.128472275767, -3247.6723509104145, -827.6828570410642, -4655.352972650994, -4729.88040668829, -5251.536213963355, -9739.950856472042, -8639.108903987855, -9432.396950246311, -609.9674358913052, -2325.2337492717593, -6821.369525269919, -6885.7742629907825, -7720.290170322886, -9582.55988616524, -84.84978732366486, -217.72284320815413, -7349.404925263563, -7812.283247895044, -4767.361962915598, -5205.951137030659, -9008.684149698134, -7030.330280946113, -3577.3706675736876, -3575.574993372442, -8715.934723364993, -8353.819459734068, -7313.335177723554, -4808.021069119635, -6396.250018933125, -8934.698883942923, -5514.57053116377, -8669.208079175252, -5484.17071044004, -6071.851480394286, -2728.496134018158, -2742.643048544001, -6347.146648309206, -3680.436685842385, -8030.072311505653, -8221.021321128394, -6325.161480981427, -7100.526089062534, -6868.096042746779, -9362.205723790481]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4098081708474017, "mean_inference_ms": 0.9913132573910814, "mean_action_processing_ms": 0.17177061443699887, "mean_env_wait_ms": 0.05201941423354226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003434419631958008, "StateBufferConnector_ms": 0.0023654699325561523, "ViewRequirementAgentConnector_ms": 0.06619369983673096}, "num_episodes": 21, "episode_return_max": -217.72284320815413, "episode_return_min": -9882.032629484656, "episode_return_mean": -5503.578251687323}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.5851639466224, "num_env_steps_trained_throughput_per_sec": 538.5851639466224, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 7400.13, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7400.098, "sample_time_ms": 735.781, "learn_time_ms": 6651.303, "learn_throughput": 601.386, "synch_weights_time_ms": 12.557}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "training_iteration": 61, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-02", "timestamp": 1723232042, "time_this_iter_s": 7.431700944900513, "time_total_s": 467.49984908103943, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31111f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 467.49984908103943, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 23.90909090909091, "ram_util_percent": 81.34545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9981521245713035, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988503373662631, "policy_loss": -0.003946498624281957, "vf_loss": 9.986822840571403, "vf_explained_var": -6.330137451489766e-05, "kl": 0.011115094221410497, "entropy": 1.546797196318706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7512671512349572, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996916626117848, "policy_loss": -0.0018724299225680253, "vf_loss": 9.994845759174812, "vf_explained_var": 1.1258655124240452e-06, "kl": 0.013144335373940448, "entropy": 1.2278691355513518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": -217.72284320815413, "episode_reward_min": -10254.626171147685, "episode_reward_mean": -5974.656714931085, "episode_len_mean": 185.09, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18509, "policy_reward_min": {"agent_policy": 84.84978732366486, "adversary_policy": -10250.986497627358}, "policy_reward_max": {"agent_policy": 9317.483105597525, "adversary_policy": -84.84978732366486}, "policy_reward_mean": {"agent_policy": 4304.94263222186, "adversary_policy": -5139.799673576472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6047.60520626885, -5556.585858904768, -5142.45072416187, -3881.748627111757, -4235.207475522074, -5529.996483403001, -3956.754912658702, -3980.2417629276038, -6954.459804372353, -8372.682269677824, -3065.621605544998, -3064.287717389402, -5804.516688934059, -5501.903218395546, -8228.275382794609, -8715.454308669772, -3677.319525624729, -4447.25360358509, -5080.258162730626, -1473.3432477008232, -6401.046488720258, -6134.631025731705, -4483.51400831472, -3034.0025642488013, -7042.203678985507, -1155.4392836091033, -6321.245519111161, -8971.330851041073, -5295.102396820391, -2648.2174632668725, -7133.308387323951, -1821.2955231161468, -5751.658034225335, -9569.420712485899, -5137.650192687566, -5516.66629203599, -2560.4940630878878, -5114.760160050326, -1914.6851032088196, -6713.534499758111, -5396.078434388664, -2529.3413533715825, -6246.292292573538, -7111.602878055115, -9882.032629484656, -2065.902641171692, -5772.93373131081, -6997.210229759341, -6595.911150666413, -6907.247780031183, -9839.111327848781, -5895.16205391806, -3438.099517828187, -1999.9955029342077, -8004.264138740845, -5113.240721284022, -3247.672350910414, -4805.319537288559, -9740.016835963792, -9444.180094614532, -2325.2337492717593, -7152.506030694506, -9600.735967844821, -217.72284320815413, -7902.519635356058, -5672.900674608443, -9014.938772937656, -4011.718897280078, -8752.303070751661, -7326.328510563691, -8934.698883942923, -8669.208079175252, -6318.806720759135, -3100.359254026005, -6347.146648309206, -8262.421779293365, -7140.701643640152, -9368.49615698809, -5259.40724833352, -10215.251826884805, -4187.377626953604, -5031.626617866264, -7392.288432257264, -7358.153849596046, -9213.005566725742, -9602.54986411935, -4576.15521734428, -4984.393932258152, -7146.887432873514, -6189.050206340055, -7315.789097958669, -8079.302828485975, -6145.334417660674, -7488.368380001088, -8448.027496884777, -1296.6426398174601, -7189.228037180297, -10254.626171147685, -8308.59088055995, -5197.07836685583], "episode_lengths": [200, 200, 150, 174, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 63, 200, 200, 174, 200, 200, 41, 200, 200, 200, 189, 200, 141, 200, 200, 160, 200, 178, 200, 64, 200, 200, 200, 200, 200, 200, 121, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 127, 200, 200, 200, 88, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 90, 200, 200, 200, 200], "policy_agent_policy_reward": [5642.589854005748, 3739.255316832777, 2019.7101699525504, 1732.2937454517794, 3165.5989908968386, 3741.2688445779445, 3868.2829083980014, 3207.899846636823, 5519.383156633958, 7877.9387712873595, 1394.195500881772, 2525.222081007942, 5050.471421004744, 4897.998341909017, 7717.540186636497, 7207.471273896488, 2011.1113504967825, 2208.1049362637223, 2959.740557178579, 526.078853019395, 5188.5840874472, 4517.423365758727, 1573.3580523712064, 1862.9263265827237, 3762.743776123735, 272.0993048806841, 4588.183736992438, 7943.157951551051, 4101.68947228315, 1372.4064584919668, 4981.801630324527, 956.9904028381061, 2857.2878145528753, 6004.6913755050455, 1558.0543540014671, 2508.8501114200044, 1274.3973212224125, 2498.97110031314, 511.0023080309736, 4308.059506391946, 4715.748983864352, 926.5383483632771, 4301.25427541647, 4231.155941438183, 3143.7843371767476, 1561.3137840734123, 5294.482328715437, 3000.929552622667, 6080.616213837496, 5087.811506661052, 7971.931895148905, 2718.1306691553214, 3334.556834182113, 210.6450248053732, 5536.152142964878, 4781.677118965841, 827.6828570410642, 4579.913842050723, 5251.470234471604, 8627.325759619638, 609.9674358913052, 6554.637757566196, 7702.114088643304, 84.84978732366486, 7259.168537802549, 4300.412425337813, 7024.075657706595, 3141.226763666053, 8317.451112347399, 4795.0277362795005, 6396.250018933125, 5514.57053116377, 5237.215470075191, 2370.7799285361543, 3680.436685842385, 7988.671853340683, 6284.98592640381, 6861.805609549168, 2406.775725161885, 9181.774175435317, 2995.592349285692, 3407.051028479227, 5168.277877841586, 4471.62229456897, 5031.8262618838335, 7202.934452206529, 3037.660149491241, 4580.971886491308, 5143.115241499317, 5738.039712643365, 6442.58167625381, 7658.50975744252, 4626.681231906051, 5440.3183584764065, 4470.217447330278, 773.3538360620531, 5247.685743397782, 9317.483105597525, 7844.365488576185, 4345.821881119737], "policy_adversary_policy_reward": [-5848.345441968214, -5841.849618306385, -4514.210372888809, -4781.630802848739, -2019.7101699525504, -5142.45072416187, -2153.2962687404483, -3460.7461038230863, -4162.244012948268, -3238.562453470643, -3741.352979889845, -5529.9123480911, -3955.348391348637, -3869.6894297080667, -3968.3374527459405, -3219.8041568184863, -6953.239559794004, -5520.6034012123055, -8372.682269677824, -7877.9387712873595, -1394.195500881772, -3065.6216055449986, -3031.8651235049624, -2557.6446748923813, -5060.463182895665, -5794.5249270431395, -5020.993017354623, -5378.90854294994, -7991.169117216477, -7954.646452214629, -8715.069542068577, -7207.856040497683, -2011.647908181654, -3676.782967939856, -3996.444060506948, -2658.9144793418577, -2959.7890669030917, -5080.2096530061135, -1473.343247700823, -526.078853019395, -6400.5131562304805, -5189.117419936979, -4517.468754314416, -6134.5856371760165, -4483.3338403562, -1573.5382203297254, -3033.815437892815, -1863.1134529387095, -3762.743776123735, -7042.203678985507, -272.0993048806841, -1155.4392836091033, -4878.118346317199, -6031.310909786384, -8958.470185529142, -7956.018617062981, -4740.449759174432, -4656.34210992911, -2642.2293647356128, -1378.3945570232263, -7132.24502193036, -4982.864995718116, -1049.0247435875356, -1729.2611823667166, -2860.468765027283, -5748.477083750925, -6004.799934425389, -9569.312153565555, -5137.650192687566, -1558.0543540014671, -5516.666292035991, -2508.8501114200044, -1603.3283553311612, -2231.5630289791256, -2498.97110031314, -5114.760160050326, -1914.6851032088198, -511.0023080309736, -4337.312789973994, -6684.281216176066, -5022.253976734966, -5089.57344151805, -940.5808604467145, -2515.298841288146, -4306.506981878176, -6241.039586111832, -4252.473125017911, -7090.285694475398, -9882.032629484656, -3143.7843371767476, -1584.5615792333012, -2042.6548460118026, -5772.730939531763, -5294.685120494483, -6997.210229759341, -3000.929552622667, -6098.09324630028, -6578.43411820363, -6907.128465376275, -5087.930821315959, -9835.291613790125, -7975.75160920756, -2719.3097540289227, -5893.9829690444485, -3358.5861421802656, -3414.0702098300353, -210.6450248053732, -1999.9955029342077, -5536.226275158594, -8004.190006547129, -4791.789367974096, -5103.128472275767, -3247.6723509104145, -827.6828570410642, -4655.352972650994, -4729.88040668829, -5251.536213963355, -9739.950856472042, -8639.108903987855, -9432.396950246311, -609.9674358913052, -2325.2337492717593, -6821.369525269919, -6885.7742629907825, -7720.290170322886, -9582.55988616524, -84.84978732366486, -217.72284320815413, -7349.404925263563, -7812.283247895044, -4767.361962915598, -5205.951137030659, -9008.684149698134, -7030.330280946113, -3577.3706675736876, -3575.574993372442, -8715.934723364993, -8353.819459734068, -7313.335177723554, -4808.021069119635, -6396.250018933125, -8934.698883942923, -5514.57053116377, -8669.208079175252, -5484.17071044004, -6071.851480394286, -2728.496134018158, -2742.643048544001, -6347.146648309206, -3680.436685842385, -8030.072311505653, -8221.021321128394, -6325.161480981427, -7100.526089062534, -6868.096042746779, -9362.205723790481, -5259.40724833352, -2406.775725161885, -9542.537447031644, -9854.488555288484, -3286.9993799033928, -3895.9705963359042, -4926.814167109532, -3511.863479235958, -6705.26159512238, -5855.304714976479, -4471.62229456897, -7358.153849596046, -9213.005566725742, -5031.8262618838335, -7206.216198752981, -9599.268117572898, -3064.8820225925547, -4548.933344242967, -4848.396432862613, -4716.969385886843, -7145.800219575578, -5144.202454797252, -6087.6119979173145, -5839.477921066106, -6452.752660931986, -7305.618113280493, -7663.802099145299, -8074.010486783196, -5899.272726458442, -4872.742923108278, -5440.3183584764065, -7488.36838000109, -4470.217447330278, -8448.027496884777, -1247.1316787316523, -822.8647971478626, -5247.685743397782, -7189.228037180297, -9321.122779117852, -10250.986497627358, -8160.269836802667, -7992.686532333467, -4601.738117706092, -4941.162130269474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40931646201212035, "mean_inference_ms": 0.9899157924119092, "mean_action_processing_ms": 0.17167845818896882, "mean_env_wait_ms": 0.05206589411681514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443598747253418, "StateBufferConnector_ms": 0.0023925304412841797, "ViewRequirementAgentConnector_ms": 0.06676995754241943}, "num_episodes": 22, "episode_return_max": -217.72284320815413, "episode_return_min": -10254.626171147685, "episode_return_mean": -5974.656714931085}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.6932502693516, "num_env_steps_trained_throughput_per_sec": 532.6932502693516, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 7430.346, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7430.313, "sample_time_ms": 741.471, "learn_time_ms": 6676.302, "learn_throughput": 599.134, "synch_weights_time_ms": 12.088}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 62, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-09", "timestamp": 1723232049, "time_this_iter_s": 7.513978004455566, "time_total_s": 475.013827085495, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 475.013827085495, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 25.109090909090913, "ram_util_percent": 81.23636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.016821556755652, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991567734877268, "policy_loss": -0.003927271995538225, "vf_loss": 9.9889759461085, "vf_explained_var": 8.053984493017197e-05, "kl": 0.01287715180175534, "entropy": 1.5719782166182994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7604018400506999, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99907388283462, "policy_loss": -0.0007375337444640026, "vf_loss": 9.995403618282742, "vf_explained_var": -0.00018116368187798395, "kl": 0.014692701543213199, "entropy": 1.2004058012255916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "env_runners": {"episode_reward_max": -140.41538679015713, "episode_reward_min": -10435.228792193384, "episode_reward_mean": -6285.974148218421, "episode_len_mean": 185.36, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18536, "policy_reward_min": {"agent_policy": 46.774616513189784, "adversary_policy": -10435.228792193386}, "policy_reward_max": {"agent_policy": 9403.678860205306, "adversary_policy": -84.84978732366486}, "policy_reward_mean": {"agent_policy": 4492.917453096605, "adversary_policy": -5389.445800657512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4483.51400831472, -3034.0025642488013, -7042.203678985507, -1155.4392836091033, -6321.245519111161, -8971.330851041073, -5295.102396820391, -2648.2174632668725, -7133.308387323951, -1821.2955231161468, -5751.658034225335, -9569.420712485899, -5137.650192687566, -5516.66629203599, -2560.4940630878878, -5114.760160050326, -1914.6851032088196, -6713.534499758111, -5396.078434388664, -2529.3413533715825, -6246.292292573538, -7111.602878055115, -9882.032629484656, -2065.902641171692, -5772.93373131081, -6997.210229759341, -6595.911150666413, -6907.247780031183, -9839.111327848781, -5895.16205391806, -3438.099517828187, -1999.9955029342077, -8004.264138740845, -5113.240721284022, -3247.672350910414, -4805.319537288559, -9740.016835963792, -9444.180094614532, -2325.2337492717593, -7152.506030694506, -9600.735967844821, -217.72284320815413, -7902.519635356058, -5672.900674608443, -9014.938772937656, -4011.718897280078, -8752.303070751661, -7326.328510563691, -8934.698883942923, -8669.208079175252, -6318.806720759135, -3100.359254026005, -6347.146648309206, -8262.421779293365, -7140.701643640152, -9368.49615698809, -5259.40724833352, -10215.251826884805, -4187.377626953604, -5031.626617866264, -7392.288432257264, -7358.153849596046, -9213.005566725742, -9602.54986411935, -4576.15521734428, -4984.393932258152, -7146.887432873514, -6189.050206340055, -7315.789097958669, -8079.302828485975, -6145.334417660674, -7488.368380001088, -8448.027496884777, -1296.6426398174601, -7189.228037180297, -10254.626171147685, -8308.59088055995, -5197.07836685583, -7392.2252751154865, -3274.7851873608156, -4902.074865679559, -6810.347028335168, -7291.595269557461, -8512.475751811184, -9910.324080629007, -9408.321396670808, -6955.972356168555, -9407.762000523522, -4116.548731509201, -5724.375292433818, -8175.080806521582, -6548.7868979502155, -5364.276013549053, -10435.228792193384, -4760.197580309347, -6088.789805958489, -7416.982941437963, -140.41538679015713, -5526.630449163251, -8220.191519895885], "episode_lengths": [174, 200, 200, 41, 200, 200, 200, 189, 200, 141, 200, 200, 160, 200, 178, 200, 64, 200, 200, 200, 200, 200, 200, 121, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 127, 200, 200, 200, 88, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 132, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200], "policy_agent_policy_reward": [1573.3580523712064, 1862.9263265827237, 3762.743776123735, 272.0993048806841, 4588.183736992438, 7943.157951551051, 4101.68947228315, 1372.4064584919668, 4981.801630324527, 956.9904028381061, 2857.2878145528753, 6004.6913755050455, 1558.0543540014671, 2508.8501114200044, 1274.3973212224125, 2498.97110031314, 511.0023080309736, 4308.059506391946, 4715.748983864352, 926.5383483632771, 4301.25427541647, 4231.155941438183, 3143.7843371767476, 1561.3137840734123, 5294.482328715437, 3000.929552622667, 6080.616213837496, 5087.811506661052, 7971.931895148905, 2718.1306691553214, 3334.556834182113, 210.6450248053732, 5536.152142964878, 4781.677118965841, 827.6828570410642, 4579.913842050723, 5251.470234471604, 8627.325759619638, 609.9674358913052, 6554.637757566196, 7702.114088643304, 84.84978732366486, 7259.168537802549, 4300.412425337813, 7024.075657706595, 3141.226763666053, 8317.451112347399, 4795.0277362795005, 6396.250018933125, 5514.57053116377, 5237.215470075191, 2370.7799285361543, 3680.436685842385, 7988.671853340683, 6284.98592640381, 6861.805609549168, 2406.775725161885, 9181.774175435317, 2995.592349285692, 3407.051028479227, 5168.277877841586, 4471.62229456897, 5031.8262618838335, 7202.934452206529, 3037.660149491241, 4580.971886491308, 5143.115241499317, 5738.039712643365, 6442.58167625381, 7658.50975744252, 4626.681231906051, 5440.3183584764065, 4470.217447330278, 773.3538360620531, 5247.685743397782, 9317.483105597525, 7844.365488576185, 4345.821881119737, 6043.927994591438, 2446.7765064219125, 3317.27018619577, 2218.817608942091, 2943.894801219216, 6088.187434900391, 9403.678860205306, 8648.268185751376, 3913.2738339779257, 7402.80596135767, 3184.606858307908, 4344.542092846924, 6724.062380462861, 5307.597864611651, 3762.629419962366, 3997.6666205797555, 3620.4193434729937, 4898.5415492506, 5629.431727322039, 46.774616513189784, 5063.906231799311, 6508.565568956527], "policy_adversary_policy_reward": [-4483.3338403562, -1573.5382203297254, -3033.815437892815, -1863.1134529387095, -3762.743776123735, -7042.203678985507, -272.0993048806841, -1155.4392836091033, -4878.118346317199, -6031.310909786384, -8958.470185529142, -7956.018617062981, -4740.449759174432, -4656.34210992911, -2642.2293647356128, -1378.3945570232263, -7132.24502193036, -4982.864995718116, -1049.0247435875356, -1729.2611823667166, -2860.468765027283, -5748.477083750925, -6004.799934425389, -9569.312153565555, -5137.650192687566, -1558.0543540014671, -5516.666292035991, -2508.8501114200044, -1603.3283553311612, -2231.5630289791256, -2498.97110031314, -5114.760160050326, -1914.6851032088198, -511.0023080309736, -4337.312789973994, -6684.281216176066, -5022.253976734966, -5089.57344151805, -940.5808604467145, -2515.298841288146, -4306.506981878176, -6241.039586111832, -4252.473125017911, -7090.285694475398, -9882.032629484656, -3143.7843371767476, -1584.5615792333012, -2042.6548460118026, -5772.730939531763, -5294.685120494483, -6997.210229759341, -3000.929552622667, -6098.09324630028, -6578.43411820363, -6907.128465376275, -5087.930821315959, -9835.291613790125, -7975.75160920756, -2719.3097540289227, -5893.9829690444485, -3358.5861421802656, -3414.0702098300353, -210.6450248053732, -1999.9955029342077, -5536.226275158594, -8004.190006547129, -4791.789367974096, -5103.128472275767, -3247.6723509104145, -827.6828570410642, -4655.352972650994, -4729.88040668829, -5251.536213963355, -9739.950856472042, -8639.108903987855, -9432.396950246311, -609.9674358913052, -2325.2337492717593, -6821.369525269919, -6885.7742629907825, -7720.290170322886, -9582.55988616524, -84.84978732366486, -217.72284320815413, -7349.404925263563, -7812.283247895044, -4767.361962915598, -5205.951137030659, -9008.684149698134, -7030.330280946113, -3577.3706675736876, -3575.574993372442, -8715.934723364993, -8353.819459734068, -7313.335177723554, -4808.021069119635, -6396.250018933125, -8934.698883942923, -5514.57053116377, -8669.208079175252, -5484.17071044004, -6071.851480394286, -2728.496134018158, -2742.643048544001, -6347.146648309206, -3680.436685842385, -8030.072311505653, -8221.021321128394, -6325.161480981427, -7100.526089062534, -6868.096042746779, -9362.205723790481, -5259.40724833352, -2406.775725161885, -9542.537447031644, -9854.488555288484, -3286.9993799033928, -3895.9705963359042, -4926.814167109532, -3511.863479235958, -6705.26159512238, -5855.304714976479, -4471.62229456897, -7358.153849596046, -9213.005566725742, -5031.8262618838335, -7206.216198752981, -9599.268117572898, -3064.8820225925547, -4548.933344242967, -4848.396432862613, -4716.969385886843, -7145.800219575578, -5144.202454797252, -6087.6119979173145, -5839.477921066106, -6452.752660931986, -7305.618113280493, -7663.802099145299, -8074.010486783196, -5899.272726458442, -4872.742923108278, -5440.3183584764065, -7488.36838000109, -4470.217447330278, -8448.027496884777, -1247.1316787316523, -822.8647971478626, -5247.685743397782, -7189.228037180297, -9321.122779117852, -10250.986497627358, -8160.269836802667, -7992.686532333467, -4601.738117706092, -4941.162130269474, -7386.84147272582, -6049.311796981105, -2608.608559857518, -3112.9531339252103, -3527.871161287845, -4691.473890587483, -6810.347028335168, -2218.817608942091, -2943.894801219216, -7291.5952695574615, -6095.941198094183, -8504.721988617392, -9899.570648901168, -9414.432291933144, -9372.677344416401, -8683.912238005783, -3921.049278251006, -6948.196911895475, -7402.80596135767, -9407.762000523522, -4108.871081973983, -3192.2845078431264, -5333.077633687975, -4735.839751592768, -8175.080806521585, -6724.062380462861, -5307.597864611651, -6548.7868979502155, -5102.512188463478, -4024.3932450479415, -10435.228792193386, -3997.6666205797555, -4610.187532900184, -3770.4293908821573, -6088.789805958489, -4898.5415492506, -5629.431727322039, -7416.982941437963, -86.67052397253136, -100.5194793308156, -5125.17982766063, -5465.3568533019325, -6508.565568956527, -8220.191519895885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40903054277237316, "mean_inference_ms": 0.9907253917391253, "mean_action_processing_ms": 0.17165723899544014, "mean_env_wait_ms": 0.05200303538864612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504157066345215, "StateBufferConnector_ms": 0.0023862123489379883, "ViewRequirementAgentConnector_ms": 0.06588888168334961}, "num_episodes": 22, "episode_return_max": -140.41538679015713, "episode_return_min": -10435.228792193384, "episode_return_mean": -6285.974148218421}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 524.6354398200208, "num_env_steps_trained_throughput_per_sec": 524.6354398200208, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 7452.27, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7452.237, "sample_time_ms": 756.453, "learn_time_ms": 6683.246, "learn_throughput": 598.512, "synch_weights_time_ms": 12.076}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "training_iteration": 63, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-17", "timestamp": 1723232057, "time_this_iter_s": 7.628807067871094, "time_total_s": 482.6426341533661, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3111430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 482.6426341533661, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 27.718181818181815, "ram_util_percent": 81.20909090909093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0241342223249377, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987314280867576, "policy_loss": -0.0009359771516756155, "vf_loss": 9.983956763148308, "vf_explained_var": -3.232397139072418e-05, "kl": 0.008481045816491435, "entropy": 1.5705209702253342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7862669274762825, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993789563860211, "policy_loss": -0.004007134924238676, "vf_loss": 9.992989178309365, "vf_explained_var": -0.0003643119461321957, "kl": 0.016025016704702345, "entropy": 1.184982491927172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": -140.41538679015713, "episode_reward_min": -11797.081961534268, "episode_reward_mean": -6878.505427549075, "episode_len_mean": 188.19, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18819, "policy_reward_min": {"agent_policy": 46.774616513189784, "adversary_policy": -11797.081961534268}, "policy_reward_max": {"agent_policy": 10626.82213404751, "adversary_policy": -84.84978732366486}, "policy_reward_mean": {"agent_policy": 5046.059083646124, "adversary_policy": -5962.282255597599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7111.602878055115, -9882.032629484656, -2065.902641171692, -5772.93373131081, -6997.210229759341, -6595.911150666413, -6907.247780031183, -9839.111327848781, -5895.16205391806, -3438.099517828187, -1999.9955029342077, -8004.264138740845, -5113.240721284022, -3247.672350910414, -4805.319537288559, -9740.016835963792, -9444.180094614532, -2325.2337492717593, -7152.506030694506, -9600.735967844821, -217.72284320815413, -7902.519635356058, -5672.900674608443, -9014.938772937656, -4011.718897280078, -8752.303070751661, -7326.328510563691, -8934.698883942923, -8669.208079175252, -6318.806720759135, -3100.359254026005, -6347.146648309206, -8262.421779293365, -7140.701643640152, -9368.49615698809, -5259.40724833352, -10215.251826884805, -4187.377626953604, -5031.626617866264, -7392.288432257264, -7358.153849596046, -9213.005566725742, -9602.54986411935, -4576.15521734428, -4984.393932258152, -7146.887432873514, -6189.050206340055, -7315.789097958669, -8079.302828485975, -6145.334417660674, -7488.368380001088, -8448.027496884777, -1296.6426398174601, -7189.228037180297, -10254.626171147685, -8308.59088055995, -5197.07836685583, -7392.2252751154865, -3274.7851873608156, -4902.074865679559, -6810.347028335168, -7291.595269557461, -8512.475751811184, -9910.324080629007, -9408.321396670808, -6955.972356168555, -9407.762000523522, -4116.548731509201, -5724.375292433818, -8175.080806521582, -6548.7868979502155, -5364.276013549053, -10435.228792193384, -4760.197580309347, -6088.789805958489, -7416.982941437963, -140.41538679015713, -5526.630449163251, -8220.191519895885, -11122.427093814013, -5512.481339389211, -5508.665860937481, -6253.496712502494, -9087.164055005325, -7358.554611507117, -6423.431955219705, -9674.401376595188, -6384.742231358845, -8700.979762012785, -8143.658211879247, -7857.564098869935, -3420.4970207587667, -8073.803267091378, -11797.081961534268, -6296.83329523239, -7144.847689994853, -9749.69068620469, -9906.396462313272, -8515.243665495806, -6677.40738906019], "episode_lengths": [200, 200, 121, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 127, 200, 200, 200, 88, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 132, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4231.155941438183, 3143.7843371767476, 1561.3137840734123, 5294.482328715437, 3000.929552622667, 6080.616213837496, 5087.811506661052, 7971.931895148905, 2718.1306691553214, 3334.556834182113, 210.6450248053732, 5536.152142964878, 4781.677118965841, 827.6828570410642, 4579.913842050723, 5251.470234471604, 8627.325759619638, 609.9674358913052, 6554.637757566196, 7702.114088643304, 84.84978732366486, 7259.168537802549, 4300.412425337813, 7024.075657706595, 3141.226763666053, 8317.451112347399, 4795.0277362795005, 6396.250018933125, 5514.57053116377, 5237.215470075191, 2370.7799285361543, 3680.436685842385, 7988.671853340683, 6284.98592640381, 6861.805609549168, 2406.775725161885, 9181.774175435317, 2995.592349285692, 3407.051028479227, 5168.277877841586, 4471.62229456897, 5031.8262618838335, 7202.934452206529, 3037.660149491241, 4580.971886491308, 5143.115241499317, 5738.039712643365, 6442.58167625381, 7658.50975744252, 4626.681231906051, 5440.3183584764065, 4470.217447330278, 773.3538360620531, 5247.685743397782, 9317.483105597525, 7844.365488576185, 4345.821881119737, 6043.927994591438, 2446.7765064219125, 3317.27018619577, 2218.817608942091, 2943.894801219216, 6088.187434900391, 9403.678860205306, 8648.268185751376, 3913.2738339779257, 7402.80596135767, 3184.606858307908, 4344.542092846924, 6724.062380462861, 5307.597864611651, 3762.629419962366, 3997.6666205797555, 3620.4193434729937, 4898.5415492506, 5629.431727322039, 46.774616513189784, 5063.906231799311, 6508.565568956527, 10626.82213404751, 2699.4013580499527, 4142.960122924186, 4542.345377704391, 4148.144588166507, 7094.210866629045, 4661.665625704039, 6211.198591116927, 4712.111363188348, 6076.059774452144, 7307.485451010461, 7597.850900296017, 793.2216709460831, 7070.582346909985, 6121.209223152972, 3976.014799485911, 5450.798005016977, 8359.7914411055, 8110.813144561312, 5613.4690381255605, 2878.219843879715], "policy_adversary_policy_reward": [-4252.473125017911, -7090.285694475398, -9882.032629484656, -3143.7843371767476, -1584.5615792333012, -2042.6548460118026, -5772.730939531763, -5294.685120494483, -6997.210229759341, -3000.929552622667, -6098.09324630028, -6578.43411820363, -6907.128465376275, -5087.930821315959, -9835.291613790125, -7975.75160920756, -2719.3097540289227, -5893.9829690444485, -3358.5861421802656, -3414.0702098300353, -210.6450248053732, -1999.9955029342077, -5536.226275158594, -8004.190006547129, -4791.789367974096, -5103.128472275767, -3247.6723509104145, -827.6828570410642, -4655.352972650994, -4729.88040668829, -5251.536213963355, -9739.950856472042, -8639.108903987855, -9432.396950246311, -609.9674358913052, -2325.2337492717593, -6821.369525269919, -6885.7742629907825, -7720.290170322886, -9582.55988616524, -84.84978732366486, -217.72284320815413, -7349.404925263563, -7812.283247895044, -4767.361962915598, -5205.951137030659, -9008.684149698134, -7030.330280946113, -3577.3706675736876, -3575.574993372442, -8715.934723364993, -8353.819459734068, -7313.335177723554, -4808.021069119635, -6396.250018933125, -8934.698883942923, -5514.57053116377, -8669.208079175252, -5484.17071044004, -6071.851480394286, -2728.496134018158, -2742.643048544001, -6347.146648309206, -3680.436685842385, -8030.072311505653, -8221.021321128394, -6325.161480981427, -7100.526089062534, -6868.096042746779, -9362.205723790481, -5259.40724833352, -2406.775725161885, -9542.537447031644, -9854.488555288484, -3286.9993799033928, -3895.9705963359042, -4926.814167109532, -3511.863479235958, -6705.26159512238, -5855.304714976479, -4471.62229456897, -7358.153849596046, -9213.005566725742, -5031.8262618838335, -7206.216198752981, -9599.268117572898, -3064.8820225925547, -4548.933344242967, -4848.396432862613, -4716.969385886843, -7145.800219575578, -5144.202454797252, -6087.6119979173145, -5839.477921066106, -6452.752660931986, -7305.618113280493, -7663.802099145299, -8074.010486783196, -5899.272726458442, -4872.742923108278, -5440.3183584764065, -7488.36838000109, -4470.217447330278, -8448.027496884777, -1247.1316787316523, -822.8647971478626, -5247.685743397782, -7189.228037180297, -9321.122779117852, -10250.986497627358, -8160.269836802667, -7992.686532333467, -4601.738117706092, -4941.162130269474, -7386.84147272582, -6049.311796981105, -2608.608559857518, -3112.9531339252103, -3527.871161287845, -4691.473890587483, -6810.347028335168, -2218.817608942091, -2943.894801219216, -7291.5952695574615, -6095.941198094183, -8504.721988617392, -9899.570648901168, -9414.432291933144, -9372.677344416401, -8683.912238005783, -3921.049278251006, -6948.196911895475, -7402.80596135767, -9407.762000523522, -4108.871081973983, -3192.2845078431264, -5333.077633687975, -4735.839751592768, -8175.080806521585, -6724.062380462861, -5307.597864611651, -6548.7868979502155, -5102.512188463478, -4024.3932450479415, -10435.228792193386, -3997.6666205797555, -4610.187532900184, -3770.4293908821573, -6088.789805958489, -4898.5415492506, -5629.431727322039, -7416.982941437963, -86.67052397253136, -100.5194793308156, -5125.17982766063, -5465.3568533019325, -6508.565568956527, -8220.191519895885, -10642.756835385542, -11106.49239247598, -2699.4013580499527, -5512.481339389211, -5497.6647361850755, -4153.9612476765915, -4927.9386491981495, -5867.903441008733, -4148.144588166507, -9087.164055005325, -7095.7669378620585, -7356.998540274104, -4661.665625704039, -6423.431955219705, -6224.738414887431, -9660.861552824681, -6356.565475046241, -4740.288119500951, -6076.059774452144, -8700.979762012783, -8098.618131020418, -7352.525531869288, -7715.332986470343, -7740.0820126956105, -3420.497020758766, -793.2216709460831, -8073.734509032687, -7070.651104968673, -6121.209223152972, -11797.081961534268, -6296.83329523239, -3976.014799485911, -7129.851363784597, -5465.794331227232, -9740.99751607462, -8368.484611235572, -8245.398613399362, -9771.810993475226, -8515.243665495806, -5613.4690381255605, -2878.219843879715, -6677.40738906019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4089836324543096, "mean_inference_ms": 0.9930832959653227, "mean_action_processing_ms": 0.17162085637602073, "mean_env_wait_ms": 0.052007496257197715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035033226013183594, "StateBufferConnector_ms": 0.002411961555480957, "ViewRequirementAgentConnector_ms": 0.0663841962814331}, "num_episodes": 21, "episode_return_max": -140.41538679015713, "episode_return_min": -11797.081961534268, "episode_return_mean": -6878.505427549075}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.4336544535307, "num_env_steps_trained_throughput_per_sec": 498.4336544535307, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 7531.542, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7531.509, "sample_time_ms": 793.293, "learn_time_ms": 6725.502, "learn_throughput": 594.751, "synch_weights_time_ms": 12.243}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 64, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-25", "timestamp": 1723232065, "time_this_iter_s": 8.030812978744507, "time_total_s": 490.6734471321106, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3111670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 490.6734471321106, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 35.59166666666666, "ram_util_percent": 80.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0341183097101747, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995147496461868, "policy_loss": -0.0037891595129622146, "vf_loss": 9.994979842503865, "vf_explained_var": -0.00010341238230466842, "kl": 0.007815936293385069, "entropy": 1.5820202864706516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7451103915613164, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002730680395056, "policy_loss": 0.0004155310533605713, "vf_loss": 9.99817158633439, "vf_explained_var": 5.470533219594804e-05, "kl": 0.013811944290088913, "entropy": 1.1847624060968873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": -140.41538679015713, "episode_reward_min": -11797.081961534268, "episode_reward_mean": -6995.276096892831, "episode_len_mean": 190.47, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19047, "policy_reward_min": {"agent_policy": 46.774616513189784, "adversary_policy": -11797.081961534268}, "policy_reward_max": {"agent_policy": 10626.82213404751, "adversary_policy": -50.40947195569689}, "policy_reward_mean": {"agent_policy": 5215.993568111704, "adversary_policy": -6105.634832502269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9600.735967844821, -217.72284320815413, -7902.519635356058, -5672.900674608443, -9014.938772937656, -4011.718897280078, -8752.303070751661, -7326.328510563691, -8934.698883942923, -8669.208079175252, -6318.806720759135, -3100.359254026005, -6347.146648309206, -8262.421779293365, -7140.701643640152, -9368.49615698809, -5259.40724833352, -10215.251826884805, -4187.377626953604, -5031.626617866264, -7392.288432257264, -7358.153849596046, -9213.005566725742, -9602.54986411935, -4576.15521734428, -4984.393932258152, -7146.887432873514, -6189.050206340055, -7315.789097958669, -8079.302828485975, -6145.334417660674, -7488.368380001088, -8448.027496884777, -1296.6426398174601, -7189.228037180297, -10254.626171147685, -8308.59088055995, -5197.07836685583, -7392.2252751154865, -3274.7851873608156, -4902.074865679559, -6810.347028335168, -7291.595269557461, -8512.475751811184, -9910.324080629007, -9408.321396670808, -6955.972356168555, -9407.762000523522, -4116.548731509201, -5724.375292433818, -8175.080806521582, -6548.7868979502155, -5364.276013549053, -10435.228792193384, -4760.197580309347, -6088.789805958489, -7416.982941437963, -140.41538679015713, -5526.630449163251, -8220.191519895885, -11122.427093814013, -5512.481339389211, -5508.665860937481, -6253.496712502494, -9087.164055005325, -7358.554611507117, -6423.431955219705, -9674.401376595188, -6384.742231358845, -8700.979762012785, -8143.658211879247, -7857.564098869935, -3420.4970207587667, -8073.803267091378, -11797.081961534268, -6296.83329523239, -7144.847689994853, -9749.69068620469, -9906.396462313272, -8515.243665495806, -6677.40738906019, -7514.2500003136665, -6476.489154199299, -6919.739129886551, -8885.73500539358, -6573.802652252386, -5363.147822566168, -7764.094011762828, -7014.600706710072, -261.80521338875377, -5799.408846371311, -9139.554833999598, -5872.08529642344, -8947.28350456947, -8089.26892707011, -8031.96479742041, -6741.889329540572, -4872.334202700335, -6706.023504808453, -7041.232896775877], "episode_lengths": [200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 132, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7702.114088643304, 84.84978732366486, 7259.168537802549, 4300.412425337813, 7024.075657706595, 3141.226763666053, 8317.451112347399, 4795.0277362795005, 6396.250018933125, 5514.57053116377, 5237.215470075191, 2370.7799285361543, 3680.436685842385, 7988.671853340683, 6284.98592640381, 6861.805609549168, 2406.775725161885, 9181.774175435317, 2995.592349285692, 3407.051028479227, 5168.277877841586, 4471.62229456897, 5031.8262618838335, 7202.934452206529, 3037.660149491241, 4580.971886491308, 5143.115241499317, 5738.039712643365, 6442.58167625381, 7658.50975744252, 4626.681231906051, 5440.3183584764065, 4470.217447330278, 773.3538360620531, 5247.685743397782, 9317.483105597525, 7844.365488576185, 4345.821881119737, 6043.927994591438, 2446.7765064219125, 3317.27018619577, 2218.817608942091, 2943.894801219216, 6088.187434900391, 9403.678860205306, 8648.268185751376, 3913.2738339779257, 7402.80596135767, 3184.606858307908, 4344.542092846924, 6724.062380462861, 5307.597864611651, 3762.629419962366, 3997.6666205797555, 3620.4193434729937, 4898.5415492506, 5629.431727322039, 46.774616513189784, 5063.906231799311, 6508.565568956527, 10626.82213404751, 2699.4013580499527, 4142.960122924186, 4542.345377704391, 4148.144588166507, 7094.210866629045, 4661.665625704039, 6211.198591116927, 4712.111363188348, 6076.059774452144, 7307.485451010461, 7597.850900296017, 793.2216709460831, 7070.582346909985, 6121.209223152972, 3976.014799485911, 5450.798005016977, 8359.7914411055, 8110.813144561312, 5613.4690381255605, 2878.219843879715, 6539.645752252221, 5616.960300786742, 4378.482710601685, 7887.779327586892, 5174.3562975476925, 4588.004511853865, 3433.3509007801213, 5943.22144881072, 50.40947195569689, 4336.410419985789, 7769.37170094761, 4492.297195225677, 6569.712121171011, 7430.880994116474, 7566.601897648171, 3404.510013782483, 2186.552565203109, 2978.382667951568, 6050.703384738312], "policy_adversary_policy_reward": [-7720.290170322886, -9582.55988616524, -84.84978732366486, -217.72284320815413, -7349.404925263563, -7812.283247895044, -4767.361962915598, -5205.951137030659, -9008.684149698134, -7030.330280946113, -3577.3706675736876, -3575.574993372442, -8715.934723364993, -8353.819459734068, -7313.335177723554, -4808.021069119635, -6396.250018933125, -8934.698883942923, -5514.57053116377, -8669.208079175252, -5484.17071044004, -6071.851480394286, -2728.496134018158, -2742.643048544001, -6347.146648309206, -3680.436685842385, -8030.072311505653, -8221.021321128394, -6325.161480981427, -7100.526089062534, -6868.096042746779, -9362.205723790481, -5259.40724833352, -2406.775725161885, -9542.537447031644, -9854.488555288484, -3286.9993799033928, -3895.9705963359042, -4926.814167109532, -3511.863479235958, -6705.26159512238, -5855.304714976479, -4471.62229456897, -7358.153849596046, -9213.005566725742, -5031.8262618838335, -7206.216198752981, -9599.268117572898, -3064.8820225925547, -4548.933344242967, -4848.396432862613, -4716.969385886843, -7145.800219575578, -5144.202454797252, -6087.6119979173145, -5839.477921066106, -6452.752660931986, -7305.618113280493, -7663.802099145299, -8074.010486783196, -5899.272726458442, -4872.742923108278, -5440.3183584764065, -7488.36838000109, -4470.217447330278, -8448.027496884777, -1247.1316787316523, -822.8647971478626, -5247.685743397782, -7189.228037180297, -9321.122779117852, -10250.986497627358, -8160.269836802667, -7992.686532333467, -4601.738117706092, -4941.162130269474, -7386.84147272582, -6049.311796981105, -2608.608559857518, -3112.9531339252103, -3527.871161287845, -4691.473890587483, -6810.347028335168, -2218.817608942091, -2943.894801219216, -7291.5952695574615, -6095.941198094183, -8504.721988617392, -9899.570648901168, -9414.432291933144, -9372.677344416401, -8683.912238005783, -3921.049278251006, -6948.196911895475, -7402.80596135767, -9407.762000523522, -4108.871081973983, -3192.2845078431264, -5333.077633687975, -4735.839751592768, -8175.080806521585, -6724.062380462861, -5307.597864611651, -6548.7868979502155, -5102.512188463478, -4024.3932450479415, -10435.228792193386, -3997.6666205797555, -4610.187532900184, -3770.4293908821573, -6088.789805958489, -4898.5415492506, -5629.431727322039, -7416.982941437963, -86.67052397253136, -100.5194793308156, -5125.17982766063, -5465.3568533019325, -6508.565568956527, -8220.191519895885, -10642.756835385542, -11106.49239247598, -2699.4013580499527, -5512.481339389211, -5497.6647361850755, -4153.9612476765915, -4927.9386491981495, -5867.903441008733, -4148.144588166507, -9087.164055005325, -7095.7669378620585, -7356.998540274104, -4661.665625704039, -6423.431955219705, -6224.738414887431, -9660.861552824681, -6356.565475046241, -4740.288119500951, -6076.059774452144, -8700.979762012783, -8098.618131020418, -7352.525531869288, -7715.332986470343, -7740.0820126956105, -3420.497020758766, -793.2216709460831, -8073.734509032687, -7070.651104968673, -6121.209223152972, -11797.081961534268, -6296.83329523239, -3976.014799485911, -7129.851363784597, -5465.794331227232, -9740.99751607462, -8368.484611235572, -8245.398613399362, -9771.810993475226, -8515.243665495806, -5613.4690381255605, -2878.219843879715, -6677.40738906019, -6749.358898041089, -7304.536854524798, -6310.17211760413, -5783.277337381908, -4378.482710601685, -6919.739129886551, -8875.559860146863, -7897.9544728336095, -6518.855516025063, -5229.303433775014, -4765.205419285292, -5185.946915134741, -3433.3509007801213, -7764.094011762828, -6431.802081058951, -6526.020074461842, -50.40947195569689, -261.80521338875377, -4893.087395234248, -5242.731871122853, -7769.702735811286, -9139.223799135922, -5676.943661091365, -4687.438830557758, -8942.298188638591, -6574.69743710189, -7809.212316661304, -7710.937604525281, -7711.325031271209, -7887.241663797374, -6618.362459342786, -3528.0368839802672, -3831.521840771942, -3227.3649271314985, -6530.731498726498, -3153.674674033525, -6865.774671552435, -6226.161609961754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4087621061131199, "mean_inference_ms": 0.9949728857398307, "mean_action_processing_ms": 0.1714933334091104, "mean_env_wait_ms": 0.0520495103500831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035562515258789062, "StateBufferConnector_ms": 0.0025179386138916016, "ViewRequirementAgentConnector_ms": 0.06960952281951904}, "num_episodes": 19, "episode_return_max": -140.41538679015713, "episode_return_min": -11797.081961534268, "episode_return_mean": -6995.276096892831}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.6030619389278, "num_env_steps_trained_throughput_per_sec": 527.6030619389278, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 7510.081, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7510.048, "sample_time_ms": 806.667, "learn_time_ms": 6690.77, "learn_throughput": 597.838, "synch_weights_time_ms": 12.107}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 65, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-33", "timestamp": 1723232073, "time_this_iter_s": 7.585797309875488, "time_total_s": 498.2592444419861, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31118b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.2592444419861, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 27.218181818181815, "ram_util_percent": 80.50909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.008608461978535, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997485490640004, "policy_loss": -0.006979833755758591, "vf_loss": 10.0, "vf_explained_var": -6.794358293215434e-05, "kl": 0.008820441641728394, "entropy": 1.5828417303661506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7633037447771698, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002305954221695, "policy_loss": -0.0015377389496221902, "vf_loss": 10.0, "vf_explained_var": 2.5477138145890815e-05, "kl": 0.01281230224237319, "entropy": 1.1686061871114861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": -140.41538679015713, "episode_reward_min": -11797.081961534268, "episode_reward_mean": -7462.36887081147, "episode_len_mean": 192.81, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19281, "policy_reward_min": {"agent_policy": 46.774616513189784, "adversary_policy": -11797.081961534268}, "policy_reward_max": {"agent_policy": 11369.773080070521, "adversary_policy": -50.40947195569689}, "policy_reward_mean": {"agent_policy": 5464.5225662072435, "adversary_policy": -6463.445718509357}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7358.153849596046, -9213.005566725742, -9602.54986411935, -4576.15521734428, -4984.393932258152, -7146.887432873514, -6189.050206340055, -7315.789097958669, -8079.302828485975, -6145.334417660674, -7488.368380001088, -8448.027496884777, -1296.6426398174601, -7189.228037180297, -10254.626171147685, -8308.59088055995, -5197.07836685583, -7392.2252751154865, -3274.7851873608156, -4902.074865679559, -6810.347028335168, -7291.595269557461, -8512.475751811184, -9910.324080629007, -9408.321396670808, -6955.972356168555, -9407.762000523522, -4116.548731509201, -5724.375292433818, -8175.080806521582, -6548.7868979502155, -5364.276013549053, -10435.228792193384, -4760.197580309347, -6088.789805958489, -7416.982941437963, -140.41538679015713, -5526.630449163251, -8220.191519895885, -11122.427093814013, -5512.481339389211, -5508.665860937481, -6253.496712502494, -9087.164055005325, -7358.554611507117, -6423.431955219705, -9674.401376595188, -6384.742231358845, -8700.979762012785, -8143.658211879247, -7857.564098869935, -3420.4970207587667, -8073.803267091378, -11797.081961534268, -6296.83329523239, -7144.847689994853, -9749.69068620469, -9906.396462313272, -8515.243665495806, -6677.40738906019, -7514.2500003136665, -6476.489154199299, -6919.739129886551, -8885.73500539358, -6573.802652252386, -5363.147822566168, -7764.094011762828, -7014.600706710072, -261.80521338875377, -5799.408846371311, -9139.554833999598, -5872.08529642344, -8947.28350456947, -8089.26892707011, -8031.96479742041, -6741.889329540572, -4872.334202700335, -6706.023504808453, -7041.232896775877, -10153.749399383916, -6565.694591639641, -10225.857083650648, -6495.13624993913, -9521.851207994157, -10223.144710930274, -11515.191574658358, -6696.0353566751455, -11513.46667626742, -10466.09862642363, -8721.266405235056, -3884.8943322524437, -9829.853067939941, -10126.211256352175, -7740.5463820168, -8130.232702447662, -11055.274506756135, -6358.107608455007, -8090.789116602275, -10555.163600092925, -11567.672227131012], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 132, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4471.62229456897, 5031.8262618838335, 7202.934452206529, 3037.660149491241, 4580.971886491308, 5143.115241499317, 5738.039712643365, 6442.58167625381, 7658.50975744252, 4626.681231906051, 5440.3183584764065, 4470.217447330278, 773.3538360620531, 5247.685743397782, 9317.483105597525, 7844.365488576185, 4345.821881119737, 6043.927994591438, 2446.7765064219125, 3317.27018619577, 2218.817608942091, 2943.894801219216, 6088.187434900391, 9403.678860205306, 8648.268185751376, 3913.2738339779257, 7402.80596135767, 3184.606858307908, 4344.542092846924, 6724.062380462861, 5307.597864611651, 3762.629419962366, 3997.6666205797555, 3620.4193434729937, 4898.5415492506, 5629.431727322039, 46.774616513189784, 5063.906231799311, 6508.565568956527, 10626.82213404751, 2699.4013580499527, 4142.960122924186, 4542.345377704391, 4148.144588166507, 7094.210866629045, 4661.665625704039, 6211.198591116927, 4712.111363188348, 6076.059774452144, 7307.485451010461, 7597.850900296017, 793.2216709460831, 7070.582346909985, 6121.209223152972, 3976.014799485911, 5450.798005016977, 8359.7914411055, 8110.813144561312, 5613.4690381255605, 2878.219843879715, 6539.645752252221, 5616.960300786742, 4378.482710601685, 7887.779327586892, 5174.3562975476925, 4588.004511853865, 3433.3509007801213, 5943.22144881072, 50.40947195569689, 4336.410419985789, 7769.37170094761, 4492.297195225677, 6569.712121171011, 7430.880994116474, 7566.601897648171, 3404.510013782483, 2186.552565203109, 2978.382667951568, 6050.703384738312, 7746.72525163688, 2784.109895160935, 9548.338488200441, 5110.52141929596, 5139.153139783111, 9187.656669112179, 7880.913406308681, 3690.9196962725364, 10901.124595418974, 9862.155655480288, 3236.6329246610417, 2766.853762549676, 6242.58097031489, 7423.773901293659, 6563.4529520595715, 7178.939667584366, 3187.3357632038646, 5236.605438141108, 4037.626243758375, 5876.220178401751, 11369.773080070521], "policy_adversary_policy_reward": [-4471.62229456897, -7358.153849596046, -9213.005566725742, -5031.8262618838335, -7206.216198752981, -9599.268117572898, -3064.8820225925547, -4548.933344242967, -4848.396432862613, -4716.969385886843, -7145.800219575578, -5144.202454797252, -6087.6119979173145, -5839.477921066106, -6452.752660931986, -7305.618113280493, -7663.802099145299, -8074.010486783196, -5899.272726458442, -4872.742923108278, -5440.3183584764065, -7488.36838000109, -4470.217447330278, -8448.027496884777, -1247.1316787316523, -822.8647971478626, -5247.685743397782, -7189.228037180297, -9321.122779117852, -10250.986497627358, -8160.269836802667, -7992.686532333467, -4601.738117706092, -4941.162130269474, -7386.84147272582, -6049.311796981105, -2608.608559857518, -3112.9531339252103, -3527.871161287845, -4691.473890587483, -6810.347028335168, -2218.817608942091, -2943.894801219216, -7291.5952695574615, -6095.941198094183, -8504.721988617392, -9899.570648901168, -9414.432291933144, -9372.677344416401, -8683.912238005783, -3921.049278251006, -6948.196911895475, -7402.80596135767, -9407.762000523522, -4108.871081973983, -3192.2845078431264, -5333.077633687975, -4735.839751592768, -8175.080806521585, -6724.062380462861, -5307.597864611651, -6548.7868979502155, -5102.512188463478, -4024.3932450479415, -10435.228792193386, -3997.6666205797555, -4610.187532900184, -3770.4293908821573, -6088.789805958489, -4898.5415492506, -5629.431727322039, -7416.982941437963, -86.67052397253136, -100.5194793308156, -5125.17982766063, -5465.3568533019325, -6508.565568956527, -8220.191519895885, -10642.756835385542, -11106.49239247598, -2699.4013580499527, -5512.481339389211, -5497.6647361850755, -4153.9612476765915, -4927.9386491981495, -5867.903441008733, -4148.144588166507, -9087.164055005325, -7095.7669378620585, -7356.998540274104, -4661.665625704039, -6423.431955219705, -6224.738414887431, -9660.861552824681, -6356.565475046241, -4740.288119500951, -6076.059774452144, -8700.979762012783, -8098.618131020418, -7352.525531869288, -7715.332986470343, -7740.0820126956105, -3420.497020758766, -793.2216709460831, -8073.734509032687, -7070.651104968673, -6121.209223152972, -11797.081961534268, -6296.83329523239, -3976.014799485911, -7129.851363784597, -5465.794331227232, -9740.99751607462, -8368.484611235572, -8245.398613399362, -9771.810993475226, -8515.243665495806, -5613.4690381255605, -2878.219843879715, -6677.40738906019, -6749.358898041089, -7304.536854524798, -6310.17211760413, -5783.277337381908, -4378.482710601685, -6919.739129886551, -8875.559860146863, -7897.9544728336095, -6518.855516025063, -5229.303433775014, -4765.205419285292, -5185.946915134741, -3433.3509007801213, -7764.094011762828, -6431.802081058951, -6526.020074461842, -50.40947195569689, -261.80521338875377, -4893.087395234248, -5242.731871122853, -7769.702735811286, -9139.223799135922, -5676.943661091365, -4687.438830557758, -8942.298188638591, -6574.69743710189, -7809.212316661304, -7710.937604525281, -7711.325031271209, -7887.241663797374, -6618.362459342786, -3528.0368839802672, -3831.521840771942, -3227.3649271314985, -6530.731498726498, -3153.674674033525, -6865.774671552435, -6226.161609961754, -10148.201999474326, -7752.272651546468, -6438.142870994838, -2911.661615805738, -10225.857083650653, -9548.338488200441, -5113.785748169786, -6491.871921065303, -9521.851207994156, -5139.153139783111, -10076.287601594628, -9334.513778447825, -11515.191574658358, -7880.913406308681, -6696.035356675146, -3690.9196962725364, -10912.23578482638, -11502.355486860013, -10436.933550296098, -9891.320731607822, -3236.6329246610417, -8721.266405235056, -2943.217415439714, -3708.5306793624063, -6242.58097031489, -9829.853067939941, -10126.211256352175, -7423.773901293659, -7576.017420759512, -6727.981913316859, -7244.6420159295885, -8064.53035410244, -3187.3357632038646, -11055.274506756135, -6295.408512313005, -5299.304534283109, -4037.626243758375, -8090.789116602275, -10555.163600092925, -5876.220178401751, -11458.754495424619, -11478.690811776913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40875450069647035, "mean_inference_ms": 0.9958673792050099, "mean_action_processing_ms": 0.1714920310179676, "mean_env_wait_ms": 0.05204306723873471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034477710723876953, "StateBufferConnector_ms": 0.002481222152709961, "ViewRequirementAgentConnector_ms": 0.06859111785888672}, "num_episodes": 21, "episode_return_max": -140.41538679015713, "episode_return_min": -11797.081961534268, "episode_return_mean": -7462.36887081147}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 562.8414427932732, "num_env_steps_trained_throughput_per_sec": 562.8414427932732, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 7468.039, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7468.006, "sample_time_ms": 805.074, "learn_time_ms": 6650.533, "learn_throughput": 601.456, "synch_weights_time_ms": 11.895}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 66, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-40", "timestamp": 1723232080, "time_this_iter_s": 7.112017869949341, "time_total_s": 505.3712623119354, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 505.3712623119354, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 24.779999999999998, "ram_util_percent": 80.51}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.011110137589276, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999538442492485, "policy_loss": -0.0004492857558943797, "vf_loss": 9.995889131228129, "vf_explained_var": 9.014407793680826e-05, "kl": 0.008096043816961659, "entropy": 1.5819957771648963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7737320344520624, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99531009008014, "policy_loss": -0.004528039704549998, "vf_loss": 9.997952330049383, "vf_explained_var": 9.322838177756657e-05, "kl": 0.006285987775920639, "entropy": 1.1636689884952767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "env_runners": {"episode_reward_max": -140.41538679015713, "episode_reward_min": -12847.594918220086, "episode_reward_mean": -7616.916477381231, "episode_len_mean": 192.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19277, "policy_reward_min": {"agent_policy": 46.774616513189784, "adversary_policy": -12843.396092739473}, "policy_reward_max": {"agent_policy": 11609.859734113874, "adversary_policy": -50.40947195569689}, "policy_reward_mean": {"agent_policy": 5596.6723086446755, "adversary_policy": -6606.794393012954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7291.595269557461, -8512.475751811184, -9910.324080629007, -9408.321396670808, -6955.972356168555, -9407.762000523522, -4116.548731509201, -5724.375292433818, -8175.080806521582, -6548.7868979502155, -5364.276013549053, -10435.228792193384, -4760.197580309347, -6088.789805958489, -7416.982941437963, -140.41538679015713, -5526.630449163251, -8220.191519895885, -11122.427093814013, -5512.481339389211, -5508.665860937481, -6253.496712502494, -9087.164055005325, -7358.554611507117, -6423.431955219705, -9674.401376595188, -6384.742231358845, -8700.979762012785, -8143.658211879247, -7857.564098869935, -3420.4970207587667, -8073.803267091378, -11797.081961534268, -6296.83329523239, -7144.847689994853, -9749.69068620469, -9906.396462313272, -8515.243665495806, -6677.40738906019, -7514.2500003136665, -6476.489154199299, -6919.739129886551, -8885.73500539358, -6573.802652252386, -5363.147822566168, -7764.094011762828, -7014.600706710072, -261.80521338875377, -5799.408846371311, -9139.554833999598, -5872.08529642344, -8947.28350456947, -8089.26892707011, -8031.96479742041, -6741.889329540572, -4872.334202700335, -6706.023504808453, -7041.232896775877, -10153.749399383916, -6565.694591639641, -10225.857083650648, -6495.13624993913, -9521.851207994157, -10223.144710930274, -11515.191574658358, -6696.0353566751455, -11513.46667626742, -10466.09862642363, -8721.266405235056, -3884.8943322524437, -9829.853067939941, -10126.211256352175, -7740.5463820168, -8130.232702447662, -11055.274506756135, -6358.107608455007, -8090.789116602275, -10555.163600092925, -11567.672227131012, -4935.209583826932, -12847.594918220086, -5380.6717364662045, -4957.360335758373, -5704.126682527934, -8425.165554558294, -9666.587615462395, -659.7085460093376, -10087.608384447112, -8027.701253412227, -7768.616877521303, -11146.579627045161, -7432.558868474628, -8425.140330839444, -9704.19613034499, -5323.836259093109, -9643.575673964453, -8844.91418723268, -8510.038018027371, -4336.683852136315, -4799.5029639082195], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2943.894801219216, 6088.187434900391, 9403.678860205306, 8648.268185751376, 3913.2738339779257, 7402.80596135767, 3184.606858307908, 4344.542092846924, 6724.062380462861, 5307.597864611651, 3762.629419962366, 3997.6666205797555, 3620.4193434729937, 4898.5415492506, 5629.431727322039, 46.774616513189784, 5063.906231799311, 6508.565568956527, 10626.82213404751, 2699.4013580499527, 4142.960122924186, 4542.345377704391, 4148.144588166507, 7094.210866629045, 4661.665625704039, 6211.198591116927, 4712.111363188348, 6076.059774452144, 7307.485451010461, 7597.850900296017, 793.2216709460831, 7070.582346909985, 6121.209223152972, 3976.014799485911, 5450.798005016977, 8359.7914411055, 8110.813144561312, 5613.4690381255605, 2878.219843879715, 6539.645752252221, 5616.960300786742, 4378.482710601685, 7887.779327586892, 5174.3562975476925, 4588.004511853865, 3433.3509007801213, 5943.22144881072, 50.40947195569689, 4336.410419985789, 7769.37170094761, 4492.297195225677, 6569.712121171011, 7430.880994116474, 7566.601897648171, 3404.510013782483, 2186.552565203109, 2978.382667951568, 6050.703384738312, 7746.72525163688, 2784.109895160935, 9548.338488200441, 5110.52141929596, 5139.153139783111, 9187.656669112179, 7880.913406308681, 3690.9196962725364, 10901.124595418974, 9862.155655480288, 3236.6329246610417, 2766.853762549676, 6242.58097031489, 7423.773901293659, 6563.4529520595715, 7178.939667584366, 3187.3357632038646, 5236.605438141108, 4037.626243758375, 5876.220178401751, 11369.773080070521, 3452.579098115351, 11609.859734113874, 4450.69559921036, 4341.552169012216, 4776.412646116417, 8110.5285684580795, 6074.32417893678, 82.50966153369899, 8198.32978639072, 4848.798357715694, 7307.9288089716465, 9803.209602275323, 4844.956711933897, 5423.039157441483, 4149.724238590428, 4320.004674304041, 7279.8215748822095, 7529.187074899024, 5318.678710875111, 2764.437881406672, 3928.3768296584235], "policy_adversary_policy_reward": [-2943.894801219216, -7291.5952695574615, -6095.941198094183, -8504.721988617392, -9899.570648901168, -9414.432291933144, -9372.677344416401, -8683.912238005783, -3921.049278251006, -6948.196911895475, -7402.80596135767, -9407.762000523522, -4108.871081973983, -3192.2845078431264, -5333.077633687975, -4735.839751592768, -8175.080806521585, -6724.062380462861, -5307.597864611651, -6548.7868979502155, -5102.512188463478, -4024.3932450479415, -10435.228792193386, -3997.6666205797555, -4610.187532900184, -3770.4293908821573, -6088.789805958489, -4898.5415492506, -5629.431727322039, -7416.982941437963, -86.67052397253136, -100.5194793308156, -5125.17982766063, -5465.3568533019325, -6508.565568956527, -8220.191519895885, -10642.756835385542, -11106.49239247598, -2699.4013580499527, -5512.481339389211, -5497.6647361850755, -4153.9612476765915, -4927.9386491981495, -5867.903441008733, -4148.144588166507, -9087.164055005325, -7095.7669378620585, -7356.998540274104, -4661.665625704039, -6423.431955219705, -6224.738414887431, -9660.861552824681, -6356.565475046241, -4740.288119500951, -6076.059774452144, -8700.979762012783, -8098.618131020418, -7352.525531869288, -7715.332986470343, -7740.0820126956105, -3420.497020758766, -793.2216709460831, -8073.734509032687, -7070.651104968673, -6121.209223152972, -11797.081961534268, -6296.83329523239, -3976.014799485911, -7129.851363784597, -5465.794331227232, -9740.99751607462, -8368.484611235572, -8245.398613399362, -9771.810993475226, -8515.243665495806, -5613.4690381255605, -2878.219843879715, -6677.40738906019, -6749.358898041089, -7304.536854524798, -6310.17211760413, -5783.277337381908, -4378.482710601685, -6919.739129886551, -8875.559860146863, -7897.9544728336095, -6518.855516025063, -5229.303433775014, -4765.205419285292, -5185.946915134741, -3433.3509007801213, -7764.094011762828, -6431.802081058951, -6526.020074461842, -50.40947195569689, -261.80521338875377, -4893.087395234248, -5242.731871122853, -7769.702735811286, -9139.223799135922, -5676.943661091365, -4687.438830557758, -8942.298188638591, -6574.69743710189, -7809.212316661304, -7710.937604525281, -7711.325031271209, -7887.241663797374, -6618.362459342786, -3528.0368839802672, -3831.521840771942, -3227.3649271314985, -6530.731498726498, -3153.674674033525, -6865.774671552435, -6226.161609961754, -10148.201999474326, -7752.272651546468, -6438.142870994838, -2911.661615805738, -10225.857083650653, -9548.338488200441, -5113.785748169786, -6491.871921065303, -9521.851207994156, -5139.153139783111, -10076.287601594628, -9334.513778447825, -11515.191574658358, -7880.913406308681, -6696.035356675146, -3690.9196962725364, -10912.23578482638, -11502.355486860013, -10436.933550296098, -9891.320731607822, -3236.6329246610417, -8721.266405235056, -2943.217415439714, -3708.5306793624063, -6242.58097031489, -9829.853067939941, -10126.211256352175, -7423.773901293659, -7576.017420759512, -6727.981913316859, -7244.6420159295885, -8064.53035410244, -3187.3357632038646, -11055.274506756135, -6295.408512313005, -5299.304534283109, -4037.626243758375, -8090.789116602275, -10555.163600092925, -5876.220178401751, -11458.754495424619, -11478.690811776913, -4074.396311342901, -4313.392370599378, -11614.058559594487, -12843.396092739473, -4522.340905163742, -5309.026430512823, -4525.062688945038, -4773.849815825554, -5396.713346239088, -5083.825982405257, -8219.701221766116, -8315.992901250256, -9666.587615462395, -6074.32417893678, -82.50966153369899, -659.7085460093376, -10087.60838444711, -8198.32978639072, -8027.701253412227, -4848.798357715694, -7472.931586334678, -7603.614100158271, -9803.209602275323, -11146.579627045161, -5087.761587433182, -7189.753992975347, -5423.039157441483, -8425.140330839444, -4149.724238590428, -9704.19613034499, -5323.502273567704, -4320.338659829445, -9643.575673964453, -7279.8215748822095, -7932.390211033157, -8441.711051098546, -5318.678710875111, -8510.038018027371, -3990.5056461281824, -3110.6160874148054, -4390.63154897181, -4337.248244594837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40877815214902696, "mean_inference_ms": 0.9969650018546661, "mean_action_processing_ms": 0.17127014902709523, "mean_env_wait_ms": 0.052038928057252354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033724308013916016, "StateBufferConnector_ms": 0.0024356842041015625, "ViewRequirementAgentConnector_ms": 0.0668865442276001}, "num_episodes": 21, "episode_return_max": -140.41538679015713, "episode_return_min": -12847.594918220086, "episode_return_mean": -7616.916477381231}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.6962086998346, "num_env_steps_trained_throughput_per_sec": 539.6962086998346, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 7468.953, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7468.921, "sample_time_ms": 806.952, "learn_time_ms": 6649.605, "learn_throughput": 601.539, "synch_weights_time_ms": 11.913}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "training_iteration": 67, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-48", "timestamp": 1723232088, "time_this_iter_s": 7.416205883026123, "time_total_s": 512.7874681949615, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3111ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 512.7874681949615, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 24.44545454545454, "ram_util_percent": 80.71818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9947274681180716, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999283473690351, "policy_loss": -0.006670048539187216, "vf_loss": 10.0, "vf_explained_var": 5.1309727132320405e-05, "kl": 0.011760094010969623, "entropy": 1.562219052389264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8148378164995285, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000442304056158, "policy_loss": -0.0017664484794266404, "vf_loss": 10.0, "vf_explained_var": 0.00024657473362312113, "kl": 0.007362537269810678, "entropy": 1.1857619416146052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": -261.80521338875377, "episode_reward_min": -12847.594918220086, "episode_reward_mean": -7950.126152542723, "episode_len_mean": 195.22, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19522, "policy_reward_min": {"agent_policy": 50.40947195569689, "adversary_policy": -12843.396092739473}, "policy_reward_max": {"agent_policy": 11609.859734113874, "adversary_policy": -50.40947195569689}, "policy_reward_mean": {"agent_policy": 5737.752415150208, "adversary_policy": -6843.939283846466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5508.665860937481, -6253.496712502494, -9087.164055005325, -7358.554611507117, -6423.431955219705, -9674.401376595188, -6384.742231358845, -8700.979762012785, -8143.658211879247, -7857.564098869935, -3420.4970207587667, -8073.803267091378, -11797.081961534268, -6296.83329523239, -7144.847689994853, -9749.69068620469, -9906.396462313272, -8515.243665495806, -6677.40738906019, -7514.2500003136665, -6476.489154199299, -6919.739129886551, -8885.73500539358, -6573.802652252386, -5363.147822566168, -7764.094011762828, -7014.600706710072, -261.80521338875377, -5799.408846371311, -9139.554833999598, -5872.08529642344, -8947.28350456947, -8089.26892707011, -8031.96479742041, -6741.889329540572, -4872.334202700335, -6706.023504808453, -7041.232896775877, -10153.749399383916, -6565.694591639641, -10225.857083650648, -6495.13624993913, -9521.851207994157, -10223.144710930274, -11515.191574658358, -6696.0353566751455, -11513.46667626742, -10466.09862642363, -8721.266405235056, -3884.8943322524437, -9829.853067939941, -10126.211256352175, -7740.5463820168, -8130.232702447662, -11055.274506756135, -6358.107608455007, -8090.789116602275, -10555.163600092925, -11567.672227131012, -4935.209583826932, -12847.594918220086, -5380.6717364662045, -4957.360335758373, -5704.126682527934, -8425.165554558294, -9666.587615462395, -659.7085460093376, -10087.608384447112, -8027.701253412227, -7768.616877521303, -11146.579627045161, -7432.558868474628, -8425.140330839444, -9704.19613034499, -5323.836259093109, -9643.575673964453, -8844.91418723268, -8510.038018027371, -4336.683852136315, -4799.5029639082195, -10890.934078274198, -9562.832544646972, -9939.299082190691, -9908.13768786581, -7435.326804220697, -6505.690943622483, -6765.761372137666, -10831.141233974307, -7483.520302258335, -9620.726989698562, -9521.39129728501, -6956.658288507797, -10593.657827719999, -9303.5243163123, -8416.451351956208, -12255.186352095201, -9357.0274190548, -4694.416715361112, -5660.386804720499, -8257.759610522824], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 93, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4142.960122924186, 4542.345377704391, 4148.144588166507, 7094.210866629045, 4661.665625704039, 6211.198591116927, 4712.111363188348, 6076.059774452144, 7307.485451010461, 7597.850900296017, 793.2216709460831, 7070.582346909985, 6121.209223152972, 3976.014799485911, 5450.798005016977, 8359.7914411055, 8110.813144561312, 5613.4690381255605, 2878.219843879715, 6539.645752252221, 5616.960300786742, 4378.482710601685, 7887.779327586892, 5174.3562975476925, 4588.004511853865, 3433.3509007801213, 5943.22144881072, 50.40947195569689, 4336.410419985789, 7769.37170094761, 4492.297195225677, 6569.712121171011, 7430.880994116474, 7566.601897648171, 3404.510013782483, 2186.552565203109, 2978.382667951568, 6050.703384738312, 7746.72525163688, 2784.109895160935, 9548.338488200441, 5110.52141929596, 5139.153139783111, 9187.656669112179, 7880.913406308681, 3690.9196962725364, 10901.124595418974, 9862.155655480288, 3236.6329246610417, 2766.853762549676, 6242.58097031489, 7423.773901293659, 6563.4529520595715, 7178.939667584366, 3187.3357632038646, 5236.605438141108, 4037.626243758375, 5876.220178401751, 11369.773080070521, 3452.579098115351, 11609.859734113874, 4450.69559921036, 4341.552169012216, 4776.412646116417, 8110.5285684580795, 6074.32417893678, 82.50966153369899, 8198.32978639072, 4848.798357715694, 7307.9288089716465, 9803.209602275323, 4844.956711933897, 5423.039157441483, 4149.724238590428, 4320.004674304041, 7279.8215748822095, 7529.187074899024, 5318.678710875111, 2764.437881406672, 3928.3768296584235, 9063.165952807829, 8838.080419058728, 5877.369392970966, 6098.2011578028505, 3320.4202923038342, 3487.7217203932505, 4447.666352776476, 4958.2718113178435, 2868.377636599018, 9288.705935414155, 8618.357704629818, 3434.9569818075493, 9684.497197439196, 8007.897122611743, 4424.573474432315, 11392.786366931487, 6773.000721617423, 2496.955841999474, 3372.5955219465427, 2469.485889288132], "policy_adversary_policy_reward": [-5497.6647361850755, -4153.9612476765915, -4927.9386491981495, -5867.903441008733, -4148.144588166507, -9087.164055005325, -7095.7669378620585, -7356.998540274104, -4661.665625704039, -6423.431955219705, -6224.738414887431, -9660.861552824681, -6356.565475046241, -4740.288119500951, -6076.059774452144, -8700.979762012783, -8098.618131020418, -7352.525531869288, -7715.332986470343, -7740.0820126956105, -3420.497020758766, -793.2216709460831, -8073.734509032687, -7070.651104968673, -6121.209223152972, -11797.081961534268, -6296.83329523239, -3976.014799485911, -7129.851363784597, -5465.794331227232, -9740.99751607462, -8368.484611235572, -8245.398613399362, -9771.810993475226, -8515.243665495806, -5613.4690381255605, -2878.219843879715, -6677.40738906019, -6749.358898041089, -7304.536854524798, -6310.17211760413, -5783.277337381908, -4378.482710601685, -6919.739129886551, -8875.559860146863, -7897.9544728336095, -6518.855516025063, -5229.303433775014, -4765.205419285292, -5185.946915134741, -3433.3509007801213, -7764.094011762828, -6431.802081058951, -6526.020074461842, -50.40947195569689, -261.80521338875377, -4893.087395234248, -5242.731871122853, -7769.702735811286, -9139.223799135922, -5676.943661091365, -4687.438830557758, -8942.298188638591, -6574.69743710189, -7809.212316661304, -7710.937604525281, -7711.325031271209, -7887.241663797374, -6618.362459342786, -3528.0368839802672, -3831.521840771942, -3227.3649271314985, -6530.731498726498, -3153.674674033525, -6865.774671552435, -6226.161609961754, -10148.201999474326, -7752.272651546468, -6438.142870994838, -2911.661615805738, -10225.857083650653, -9548.338488200441, -5113.785748169786, -6491.871921065303, -9521.851207994156, -5139.153139783111, -10076.287601594628, -9334.513778447825, -11515.191574658358, -7880.913406308681, -6696.035356675146, -3690.9196962725364, -10912.23578482638, -11502.355486860013, -10436.933550296098, -9891.320731607822, -3236.6329246610417, -8721.266405235056, -2943.217415439714, -3708.5306793624063, -6242.58097031489, -9829.853067939941, -10126.211256352175, -7423.773901293659, -7576.017420759512, -6727.981913316859, -7244.6420159295885, -8064.53035410244, -3187.3357632038646, -11055.274506756135, -6295.408512313005, -5299.304534283109, -4037.626243758375, -8090.789116602275, -10555.163600092925, -5876.220178401751, -11458.754495424619, -11478.690811776913, -4074.396311342901, -4313.392370599378, -11614.058559594487, -12843.396092739473, -4522.340905163742, -5309.026430512823, -4525.062688945038, -4773.849815825554, -5396.713346239088, -5083.825982405257, -8219.701221766116, -8315.992901250256, -9666.587615462395, -6074.32417893678, -82.50966153369899, -659.7085460093376, -10087.60838444711, -8198.32978639072, -8027.701253412227, -4848.798357715694, -7472.931586334678, -7603.614100158271, -9803.209602275323, -11146.579627045161, -5087.761587433182, -7189.753992975347, -5423.039157441483, -8425.140330839444, -4149.724238590428, -9704.19613034499, -5323.502273567704, -4320.338659829445, -9643.575673964453, -7279.8215748822095, -7932.390211033157, -8441.711051098546, -5318.678710875111, -8510.038018027371, -3990.5056461281824, -3110.6160874148054, -4390.63154897181, -4337.248244594837, -9098.31907337052, -10855.780957711508, -8902.92640676611, -9497.986556939595, -9939.299082190695, -5877.369392970966, -6098.2011578028505, -9908.13768786581, -6967.329329031009, -3788.4177674935427, -5029.578034980564, -4963.8346290351665, -4447.666352776476, -6765.761372137666, -10831.141233974307, -4958.2718113178435, -2868.377636599018, -7483.520302258335, -9308.01584715125, -9601.417077961467, -9265.268523173168, -8874.480478741652, -6595.048795984379, -3796.5664743309676, -10197.124845243135, -10081.030179916055, -9303.524316312298, -8007.897122611743, -4424.573474432315, -8416.451351956208, -11496.45700129335, -12151.515717733339, -6796.678878593553, -9333.34926207867, -2561.448755653341, -4629.923801707246, -5528.372124960583, -3504.6102017064554, -8127.009108356488, -2600.2363914544685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4086404370730563, "mean_inference_ms": 0.9972892091504043, "mean_action_processing_ms": 0.17112678685701632, "mean_env_wait_ms": 0.052063656799408393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033736228942871094, "StateBufferConnector_ms": 0.0024138689041137695, "ViewRequirementAgentConnector_ms": 0.06735837459564209}, "num_episodes": 20, "episode_return_max": -261.80521338875377, "episode_return_min": -12847.594918220086, "episode_return_mean": -7950.126152542723}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.6024898171177, "num_env_steps_trained_throughput_per_sec": 545.6024898171177, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 7472.533, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7472.5, "sample_time_ms": 801.783, "learn_time_ms": 6658.473, "learn_throughput": 600.738, "synch_weights_time_ms": 11.749}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 68, "trial_id": "3439d_00000", "date": "2024-08-09_15-34-55", "timestamp": 1723232095, "time_this_iter_s": 7.336248159408569, "time_total_s": 520.1237163543701, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3111d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 520.1237163543701, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.889999999999997, "ram_util_percent": 80.71}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0223304903445145, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98769452770551, "policy_loss": -0.003940449075889774, "vf_loss": 9.986066619555155, "vf_explained_var": -6.272122263908386e-05, "kl": 0.010999234590660005, "entropy": 1.5555821880698204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7680778327678878, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99167636286014, "policy_loss": -0.0039053447793420187, "vf_loss": 9.993462244669596, "vf_explained_var": 0.00011511123369610499, "kl": 0.007064986922014406, "entropy": 1.1669716942877997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "env_runners": {"episode_reward_max": -21.28375993602028, "episode_reward_min": -13103.993293276271, "episode_reward_mean": -7912.717054245977, "episode_len_mean": 191.37, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19137, "policy_reward_min": {"agent_policy": 0.9128352555288183, "adversary_policy": -13103.993293276271}, "policy_reward_max": {"agent_policy": 12447.000061899427, "adversary_policy": -0.9128352555288183}, "policy_reward_mean": {"agent_policy": 5700.272619624151, "adversary_policy": -6806.494836935064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6573.802652252386, -5363.147822566168, -7764.094011762828, -7014.600706710072, -261.80521338875377, -5799.408846371311, -9139.554833999598, -5872.08529642344, -8947.28350456947, -8089.26892707011, -8031.96479742041, -6741.889329540572, -4872.334202700335, -6706.023504808453, -7041.232896775877, -10153.749399383916, -6565.694591639641, -10225.857083650648, -6495.13624993913, -9521.851207994157, -10223.144710930274, -11515.191574658358, -6696.0353566751455, -11513.46667626742, -10466.09862642363, -8721.266405235056, -3884.8943322524437, -9829.853067939941, -10126.211256352175, -7740.5463820168, -8130.232702447662, -11055.274506756135, -6358.107608455007, -8090.789116602275, -10555.163600092925, -11567.672227131012, -4935.209583826932, -12847.594918220086, -5380.6717364662045, -4957.360335758373, -5704.126682527934, -8425.165554558294, -9666.587615462395, -659.7085460093376, -10087.608384447112, -8027.701253412227, -7768.616877521303, -11146.579627045161, -7432.558868474628, -8425.140330839444, -9704.19613034499, -5323.836259093109, -9643.575673964453, -8844.91418723268, -8510.038018027371, -4336.683852136315, -4799.5029639082195, -10890.934078274198, -9562.832544646972, -9939.299082190691, -9908.13768786581, -7435.326804220697, -6505.690943622483, -6765.761372137666, -10831.141233974307, -7483.520302258335, -9620.726989698562, -9521.39129728501, -6956.658288507797, -10593.657827719999, -9303.5243163123, -8416.451351956208, -12255.186352095201, -9357.0274190548, -4694.416715361112, -5660.386804720499, -8257.759610522824, -5173.702440981902, -1323.1640636875372, -3267.146392981359, -7558.772884264073, -8695.794002063938, -13103.993293276271, -8271.718931844434, -8242.950187940733, -21.28375993602028, -9701.525946962247, -9226.594210685715, -6776.060095219458, -8698.014906248676, -6858.130599389126, -12914.800617065954, -7917.320022780038, -9176.189962583436, -7218.435853962303, -10923.008769771206, -9487.515118019708, -8910.642325466144, -5754.634484856709, -3808.3649037051196], "episode_lengths": [200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 66, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5174.3562975476925, 4588.004511853865, 3433.3509007801213, 5943.22144881072, 50.40947195569689, 4336.410419985789, 7769.37170094761, 4492.297195225677, 6569.712121171011, 7430.880994116474, 7566.601897648171, 3404.510013782483, 2186.552565203109, 2978.382667951568, 6050.703384738312, 7746.72525163688, 2784.109895160935, 9548.338488200441, 5110.52141929596, 5139.153139783111, 9187.656669112179, 7880.913406308681, 3690.9196962725364, 10901.124595418974, 9862.155655480288, 3236.6329246610417, 2766.853762549676, 6242.58097031489, 7423.773901293659, 6563.4529520595715, 7178.939667584366, 3187.3357632038646, 5236.605438141108, 4037.626243758375, 5876.220178401751, 11369.773080070521, 3452.579098115351, 11609.859734113874, 4450.69559921036, 4341.552169012216, 4776.412646116417, 8110.5285684580795, 6074.32417893678, 82.50966153369899, 8198.32978639072, 4848.798357715694, 7307.9288089716465, 9803.209602275323, 4844.956711933897, 5423.039157441483, 4149.724238590428, 4320.004674304041, 7279.8215748822095, 7529.187074899024, 5318.678710875111, 2764.437881406672, 3928.3768296584235, 9063.165952807829, 8838.080419058728, 5877.369392970966, 6098.2011578028505, 3320.4202923038342, 3487.7217203932505, 4447.666352776476, 4958.2718113178435, 2868.377636599018, 9288.705935414155, 8618.357704629818, 3434.9569818075493, 9684.497197439196, 8007.897122611743, 4424.573474432315, 11392.786366931487, 6773.000721617423, 2496.955841999474, 3372.5955219465427, 2469.485889288132, 3185.4034332684782, 444.91118880529956, 496.6375064919139, 6724.606565209755, 7807.066812382505, 10563.85549563688, 5462.505010621087, 6886.865720109389, 0.9128352555288183, 7952.266277587804, 8943.85382593094, 5664.066566894155, 6797.0371829178575, 3202.1045987868033, 12447.000061899427, 6406.6217009413185, 7866.532236358364, 3335.771900588672, 4812.422961309519, 6177.250831273116, 4371.743786112614, 4670.554629607712, 1323.0495850087977], "policy_adversary_policy_reward": [-6518.855516025063, -5229.303433775014, -4765.205419285292, -5185.946915134741, -3433.3509007801213, -7764.094011762828, -6431.802081058951, -6526.020074461842, -50.40947195569689, -261.80521338875377, -4893.087395234248, -5242.731871122853, -7769.702735811286, -9139.223799135922, -5676.943661091365, -4687.438830557758, -8942.298188638591, -6574.69743710189, -7809.212316661304, -7710.937604525281, -7711.325031271209, -7887.241663797374, -6618.362459342786, -3528.0368839802672, -3831.521840771942, -3227.3649271314985, -6530.731498726498, -3153.674674033525, -6865.774671552435, -6226.161609961754, -10148.201999474326, -7752.272651546468, -6438.142870994838, -2911.661615805738, -10225.857083650653, -9548.338488200441, -5113.785748169786, -6491.871921065303, -9521.851207994156, -5139.153139783111, -10076.287601594628, -9334.513778447825, -11515.191574658358, -7880.913406308681, -6696.035356675146, -3690.9196962725364, -10912.23578482638, -11502.355486860013, -10436.933550296098, -9891.320731607822, -3236.6329246610417, -8721.266405235056, -2943.217415439714, -3708.5306793624063, -6242.58097031489, -9829.853067939941, -10126.211256352175, -7423.773901293659, -7576.017420759512, -6727.981913316859, -7244.6420159295885, -8064.53035410244, -3187.3357632038646, -11055.274506756135, -6295.408512313005, -5299.304534283109, -4037.626243758375, -8090.789116602275, -10555.163600092925, -5876.220178401751, -11458.754495424619, -11478.690811776913, -4074.396311342901, -4313.392370599378, -11614.058559594487, -12843.396092739473, -4522.340905163742, -5309.026430512823, -4525.062688945038, -4773.849815825554, -5396.713346239088, -5083.825982405257, -8219.701221766116, -8315.992901250256, -9666.587615462395, -6074.32417893678, -82.50966153369899, -659.7085460093376, -10087.60838444711, -8198.32978639072, -8027.701253412227, -4848.798357715694, -7472.931586334678, -7603.614100158271, -9803.209602275323, -11146.579627045161, -5087.761587433182, -7189.753992975347, -5423.039157441483, -8425.140330839444, -4149.724238590428, -9704.19613034499, -5323.502273567704, -4320.338659829445, -9643.575673964453, -7279.8215748822095, -7932.390211033157, -8441.711051098546, -5318.678710875111, -8510.038018027371, -3990.5056461281824, -3110.6160874148054, -4390.63154897181, -4337.248244594837, -9098.31907337052, -10855.780957711508, -8902.92640676611, -9497.986556939595, -9939.299082190695, -5877.369392970966, -6098.2011578028505, -9908.13768786581, -6967.329329031009, -3788.4177674935427, -5029.578034980564, -4963.8346290351665, -4447.666352776476, -6765.761372137666, -10831.141233974307, -4958.2718113178435, -2868.377636599018, -7483.520302258335, -9308.01584715125, -9601.417077961467, -9265.268523173168, -8874.480478741652, -6595.048795984379, -3796.5664743309676, -10197.124845243135, -10081.030179916055, -9303.524316312298, -8007.897122611743, -4424.573474432315, -8416.451351956208, -11496.45700129335, -12151.515717733339, -6796.678878593553, -9333.34926207867, -2561.448755653341, -4629.923801707246, -5528.372124960583, -3504.6102017064554, -8127.009108356488, -2600.2363914544685, -5173.298282040205, -3185.807592210175, -444.91118880529956, -1323.1640636875372, -3267.1463929813594, -496.6375064919139, -7555.618230805217, -6727.761218668611, -8695.794002063938, -7807.066812382505, -13103.993293276271, -10563.85549563688, -5462.505010621087, -8271.718931844434, -6888.882458229484, -8240.933449820639, -0.9128352555288183, -21.28375993602028, -7974.012897566913, -9679.779326983147, -9136.384222981973, -9034.063813634686, -5938.302651113342, -6501.824011000267, -8648.642495007136, -6846.4095941594005, -6858.130599389126, -3202.1045987868033, -12484.853687594481, -12876.946991370902, -7863.049499997914, -6460.892223723444, -7866.532236358364, -9176.189962583438, -3732.285609089264, -6821.922145461711, -4812.422961309519, -10923.008769771202, -6177.549738869017, -9487.216210423805, -8910.642325466142, -4371.743786112614, -5692.319908797144, -4732.869205667276, -3808.36490370512, -1323.0495850087977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40813209775349685, "mean_inference_ms": 0.9968862161859258, "mean_action_processing_ms": 0.17096767654333078, "mean_env_wait_ms": 0.05199103323090503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032994747161865234, "StateBufferConnector_ms": 0.002356886863708496, "ViewRequirementAgentConnector_ms": 0.06424939632415771}, "num_episodes": 23, "episode_return_max": -21.28375993602028, "episode_return_min": -13103.993293276271, "episode_return_mean": -7912.717054245977}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.1580577692325, "num_env_steps_trained_throughput_per_sec": 543.1580577692325, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 7478.189, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7478.156, "sample_time_ms": 794.686, "learn_time_ms": 6671.196, "learn_throughput": 599.593, "synch_weights_time_ms": 11.774}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "training_iteration": 69, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-03", "timestamp": 1723232103, "time_this_iter_s": 7.368980169296265, "time_total_s": 527.4926965236664, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3111f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 527.4926965236664, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 24.145454545454548, "ram_util_percent": 80.61818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.997360360249877, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995567102233569, "policy_loss": -0.004969358658612085, "vf_loss": 9.99557390709718, "vf_explained_var": 0.00047552908460299175, "kl": 0.009802575571423706, "entropy": 1.528386402130127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7831702190811041, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997332888810092, "policy_loss": -0.0030380646227587942, "vf_loss": 9.998073802927815, "vf_explained_var": 0.000231892154330299, "kl": 0.007657049948635398, "entropy": 1.1188904012952532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": -21.28375993602028, "episode_reward_min": -13103.993293276271, "episode_reward_mean": -8073.902730326917, "episode_len_mean": 191.6, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19160, "policy_reward_min": {"agent_policy": 0.9128352555288183, "adversary_policy": -13103.993293276271}, "policy_reward_max": {"agent_policy": 12447.000061899427, "adversary_policy": -0.9128352555288183}, "policy_reward_mean": {"agent_policy": 5804.146194261574, "adversary_policy": -6939.024462294246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9521.851207994157, -10223.144710930274, -11515.191574658358, -6696.0353566751455, -11513.46667626742, -10466.09862642363, -8721.266405235056, -3884.8943322524437, -9829.853067939941, -10126.211256352175, -7740.5463820168, -8130.232702447662, -11055.274506756135, -6358.107608455007, -8090.789116602275, -10555.163600092925, -11567.672227131012, -4935.209583826932, -12847.594918220086, -5380.6717364662045, -4957.360335758373, -5704.126682527934, -8425.165554558294, -9666.587615462395, -659.7085460093376, -10087.608384447112, -8027.701253412227, -7768.616877521303, -11146.579627045161, -7432.558868474628, -8425.140330839444, -9704.19613034499, -5323.836259093109, -9643.575673964453, -8844.91418723268, -8510.038018027371, -4336.683852136315, -4799.5029639082195, -10890.934078274198, -9562.832544646972, -9939.299082190691, -9908.13768786581, -7435.326804220697, -6505.690943622483, -6765.761372137666, -10831.141233974307, -7483.520302258335, -9620.726989698562, -9521.39129728501, -6956.658288507797, -10593.657827719999, -9303.5243163123, -8416.451351956208, -12255.186352095201, -9357.0274190548, -4694.416715361112, -5660.386804720499, -8257.759610522824, -5173.702440981902, -1323.1640636875372, -3267.146392981359, -7558.772884264073, -8695.794002063938, -13103.993293276271, -8271.718931844434, -8242.950187940733, -21.28375993602028, -9701.525946962247, -9226.594210685715, -6776.060095219458, -8698.014906248676, -6858.130599389126, -12914.800617065954, -7917.320022780038, -9176.189962583436, -7218.435853962303, -10923.008769771206, -9487.515118019708, -8910.642325466144, -5754.634484856709, -3808.3649037051196, -10899.502764008494, -6139.338056526388, -8148.342241888593, -9692.1095596414, -8187.225496418522, -5927.147878986846, -6590.050933897392, -1337.3170807503955, -7388.958593229257, -5858.949169181959, -7809.101589517861, -7833.008300685155, -7600.505963681932, -8836.735941780064, -10815.967135296456, -10712.45759760234, -7930.899741107634, -9954.018839786604, -6115.864595079816], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 66, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5139.153139783111, 9187.656669112179, 7880.913406308681, 3690.9196962725364, 10901.124595418974, 9862.155655480288, 3236.6329246610417, 2766.853762549676, 6242.58097031489, 7423.773901293659, 6563.4529520595715, 7178.939667584366, 3187.3357632038646, 5236.605438141108, 4037.626243758375, 5876.220178401751, 11369.773080070521, 3452.579098115351, 11609.859734113874, 4450.69559921036, 4341.552169012216, 4776.412646116417, 8110.5285684580795, 6074.32417893678, 82.50966153369899, 8198.32978639072, 4848.798357715694, 7307.9288089716465, 9803.209602275323, 4844.956711933897, 5423.039157441483, 4149.724238590428, 4320.004674304041, 7279.8215748822095, 7529.187074899024, 5318.678710875111, 2764.437881406672, 3928.3768296584235, 9063.165952807829, 8838.080419058728, 5877.369392970966, 6098.2011578028505, 3320.4202923038342, 3487.7217203932505, 4447.666352776476, 4958.2718113178435, 2868.377636599018, 9288.705935414155, 8618.357704629818, 3434.9569818075493, 9684.497197439196, 8007.897122611743, 4424.573474432315, 11392.786366931487, 6773.000721617423, 2496.955841999474, 3372.5955219465427, 2469.485889288132, 3185.4034332684782, 444.91118880529956, 496.6375064919139, 6724.606565209755, 7807.066812382505, 10563.85549563688, 5462.505010621087, 6886.865720109389, 0.9128352555288183, 7952.266277587804, 8943.85382593094, 5664.066566894155, 6797.0371829178575, 3202.1045987868033, 12447.000061899427, 6406.6217009413185, 7866.532236358364, 3335.771900588672, 4812.422961309519, 6177.250831273116, 4371.743786112614, 4670.554629607712, 1323.0495850087977, 9865.726091392595, 5105.277659305336, 3469.260247418966, 7189.364781511161, 4560.674959395314, 4616.363323273658, 5358.433686957026, 216.00492193837044, 6323.492036816133, 3745.236885007591, 6528.920208834129, 3640.2683048221506, 4340.888819456402, 7691.094522362205, 8515.766056563785, 8865.42120942198, 5887.136613827244, 7863.73080560079, 3768.756975850241], "policy_adversary_policy_reward": [-9521.851207994156, -5139.153139783111, -10076.287601594628, -9334.513778447825, -11515.191574658358, -7880.913406308681, -6696.035356675146, -3690.9196962725364, -10912.23578482638, -11502.355486860013, -10436.933550296098, -9891.320731607822, -3236.6329246610417, -8721.266405235056, -2943.217415439714, -3708.5306793624063, -6242.58097031489, -9829.853067939941, -10126.211256352175, -7423.773901293659, -7576.017420759512, -6727.981913316859, -7244.6420159295885, -8064.53035410244, -3187.3357632038646, -11055.274506756135, -6295.408512313005, -5299.304534283109, -4037.626243758375, -8090.789116602275, -10555.163600092925, -5876.220178401751, -11458.754495424619, -11478.690811776913, -4074.396311342901, -4313.392370599378, -11614.058559594487, -12843.396092739473, -4522.340905163742, -5309.026430512823, -4525.062688945038, -4773.849815825554, -5396.713346239088, -5083.825982405257, -8219.701221766116, -8315.992901250256, -9666.587615462395, -6074.32417893678, -82.50966153369899, -659.7085460093376, -10087.60838444711, -8198.32978639072, -8027.701253412227, -4848.798357715694, -7472.931586334678, -7603.614100158271, -9803.209602275323, -11146.579627045161, -5087.761587433182, -7189.753992975347, -5423.039157441483, -8425.140330839444, -4149.724238590428, -9704.19613034499, -5323.502273567704, -4320.338659829445, -9643.575673964453, -7279.8215748822095, -7932.390211033157, -8441.711051098546, -5318.678710875111, -8510.038018027371, -3990.5056461281824, -3110.6160874148054, -4390.63154897181, -4337.248244594837, -9098.31907337052, -10855.780957711508, -8902.92640676611, -9497.986556939595, -9939.299082190695, -5877.369392970966, -6098.2011578028505, -9908.13768786581, -6967.329329031009, -3788.4177674935427, -5029.578034980564, -4963.8346290351665, -4447.666352776476, -6765.761372137666, -10831.141233974307, -4958.2718113178435, -2868.377636599018, -7483.520302258335, -9308.01584715125, -9601.417077961467, -9265.268523173168, -8874.480478741652, -6595.048795984379, -3796.5664743309676, -10197.124845243135, -10081.030179916055, -9303.524316312298, -8007.897122611743, -4424.573474432315, -8416.451351956208, -11496.45700129335, -12151.515717733339, -6796.678878593553, -9333.34926207867, -2561.448755653341, -4629.923801707246, -5528.372124960583, -3504.6102017064554, -8127.009108356488, -2600.2363914544685, -5173.298282040205, -3185.807592210175, -444.91118880529956, -1323.1640636875372, -3267.1463929813594, -496.6375064919139, -7555.618230805217, -6727.761218668611, -8695.794002063938, -7807.066812382505, -13103.993293276271, -10563.85549563688, -5462.505010621087, -8271.718931844434, -6888.882458229484, -8240.933449820639, -0.9128352555288183, -21.28375993602028, -7974.012897566913, -9679.779326983147, -9136.384222981973, -9034.063813634686, -5938.302651113342, -6501.824011000267, -8648.642495007136, -6846.4095941594005, -6858.130599389126, -3202.1045987868033, -12484.853687594481, -12876.946991370902, -7863.049499997914, -6460.892223723444, -7866.532236358364, -9176.189962583438, -3732.285609089264, -6821.922145461711, -4812.422961309519, -10923.008769771202, -6177.549738869017, -9487.216210423805, -8910.642325466142, -4371.743786112614, -5692.319908797144, -4732.869205667276, -3808.36490370512, -1323.0495850087977, -10527.803471379155, -10237.425384021943, -5152.695840160732, -6091.919875670993, -8148.342241888591, -3469.260247418966, -9692.109559641403, -7189.364781511161, -8187.225496418522, -4560.674959395314, -5927.147878986846, -4616.363323273658, -6590.050933897391, -5358.433686957026, -1337.3170807503955, -216.00492193837044, -6323.492036816133, -7388.958593229258, -3745.236885007591, -5858.94916918196, -6794.331152324335, -7543.690646027652, -7833.008300685155, -3640.2683048221506, -7600.505963681933, -4340.888819456402, -7691.094522362205, -8836.735941780064, -8515.766056563785, -10815.967135296456, -10474.221720708407, -9103.65708631592, -7930.899741107634, -5887.136613827244, -9846.11828399, -7971.631361397401, -3768.756975850241, -6115.864595079816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40778437551543134, "mean_inference_ms": 0.9955723089143932, "mean_action_processing_ms": 0.1707805859920655, "mean_env_wait_ms": 0.05196384260528717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033521652221679688, "StateBufferConnector_ms": 0.0024052858352661133, "ViewRequirementAgentConnector_ms": 0.0646132230758667}, "num_episodes": 19, "episode_return_max": -21.28375993602028, "episode_return_min": -13103.993293276271, "episode_return_mean": -8073.902730326917}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.4676817158456, "num_env_steps_trained_throughput_per_sec": 537.4676817158456, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 7482.325, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7482.293, "sample_time_ms": 797.976, "learn_time_ms": 6671.821, "learn_throughput": 599.536, "synch_weights_time_ms": 11.997}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 70, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-11", "timestamp": 1723232111, "time_this_iter_s": 7.446387052536011, "time_total_s": 534.9390835762024, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 534.9390835762024, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 25.654545454545453, "ram_util_percent": 80.83636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9840409092605114, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998177734017371, "policy_loss": -0.0014678066994141166, "vf_loss": 9.9936641116937, "vf_explained_var": -1.0802472631136577e-05, "kl": 0.011815137186689147, "entropy": 1.5207686179627975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8017807531530264, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996376246497745, "policy_loss": -0.0036696878328387225, "vf_loss": 9.997558779943557, "vf_explained_var": 0.00022715440502873175, "kl": 0.008290472010485632, "entropy": 1.120951301143283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "env_runners": {"episode_reward_max": -21.28375993602028, "episode_reward_min": -13103.993293276271, "episode_reward_mean": -7910.806967121564, "episode_len_mean": 188.83, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18883, "policy_reward_min": {"agent_policy": 0.8274422246066364, "adversary_policy": -13103.993293276271}, "policy_reward_max": {"agent_policy": 12447.000061899427, "adversary_policy": -0.8274422246066364}, "policy_reward_mean": {"agent_policy": 5585.313421108183, "adversary_policy": -6748.060194114875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8425.165554558294, -9666.587615462395, -659.7085460093376, -10087.608384447112, -8027.701253412227, -7768.616877521303, -11146.579627045161, -7432.558868474628, -8425.140330839444, -9704.19613034499, -5323.836259093109, -9643.575673964453, -8844.91418723268, -8510.038018027371, -4336.683852136315, -4799.5029639082195, -10890.934078274198, -9562.832544646972, -9939.299082190691, -9908.13768786581, -7435.326804220697, -6505.690943622483, -6765.761372137666, -10831.141233974307, -7483.520302258335, -9620.726989698562, -9521.39129728501, -6956.658288507797, -10593.657827719999, -9303.5243163123, -8416.451351956208, -12255.186352095201, -9357.0274190548, -4694.416715361112, -5660.386804720499, -8257.759610522824, -5173.702440981902, -1323.1640636875372, -3267.146392981359, -7558.772884264073, -8695.794002063938, -13103.993293276271, -8271.718931844434, -8242.950187940733, -21.28375993602028, -9701.525946962247, -9226.594210685715, -6776.060095219458, -8698.014906248676, -6858.130599389126, -12914.800617065954, -7917.320022780038, -9176.189962583436, -7218.435853962303, -10923.008769771206, -9487.515118019708, -8910.642325466144, -5754.634484856709, -3808.3649037051196, -10899.502764008494, -6139.338056526388, -8148.342241888593, -9692.1095596414, -8187.225496418522, -5927.147878986846, -6590.050933897392, -1337.3170807503955, -7388.958593229257, -5858.949169181959, -7809.101589517861, -7833.008300685155, -7600.505963681932, -8836.735941780064, -10815.967135296456, -10712.45759760234, -7930.899741107634, -9954.018839786604, -6115.864595079816, -7024.447014218099, -43.75218127909201, -11954.772321595352, -5425.9881775198755, -8256.559062563752, -5272.462971266951, -10157.58534522886, -7881.652652509369, -7590.150178026297, -10067.460241357003, -8992.699648788037, -5831.66699080235, -4679.140382662439, -9085.395626370679, -6488.119221921279, -8777.768785216016, -9889.841776717953, -9260.727357765008, -5475.08113750307, -11696.763786877527, -11287.650223034014, -8371.501211271769], "episode_lengths": [200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 66, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8110.5285684580795, 6074.32417893678, 82.50966153369899, 8198.32978639072, 4848.798357715694, 7307.9288089716465, 9803.209602275323, 4844.956711933897, 5423.039157441483, 4149.724238590428, 4320.004674304041, 7279.8215748822095, 7529.187074899024, 5318.678710875111, 2764.437881406672, 3928.3768296584235, 9063.165952807829, 8838.080419058728, 5877.369392970966, 6098.2011578028505, 3320.4202923038342, 3487.7217203932505, 4447.666352776476, 4958.2718113178435, 2868.377636599018, 9288.705935414155, 8618.357704629818, 3434.9569818075493, 9684.497197439196, 8007.897122611743, 4424.573474432315, 11392.786366931487, 6773.000721617423, 2496.955841999474, 3372.5955219465427, 2469.485889288132, 3185.4034332684782, 444.91118880529956, 496.6375064919139, 6724.606565209755, 7807.066812382505, 10563.85549563688, 5462.505010621087, 6886.865720109389, 0.9128352555288183, 7952.266277587804, 8943.85382593094, 5664.066566894155, 6797.0371829178575, 3202.1045987868033, 12447.000061899427, 6406.6217009413185, 7866.532236358364, 3335.771900588672, 4812.422961309519, 6177.250831273116, 4371.743786112614, 4670.554629607712, 1323.0495850087977, 9865.726091392595, 5105.277659305336, 3469.260247418966, 7189.364781511161, 4560.674959395314, 4616.363323273658, 5358.433686957026, 216.00492193837044, 6323.492036816133, 3745.236885007591, 6528.920208834129, 3640.2683048221506, 4340.888819456402, 7691.094522362205, 8515.766056563785, 8865.42120942198, 5887.136613827244, 7863.73080560079, 3768.756975850241, 2408.9030361310447, 0.8274422246066364, 10087.535349766682, 1267.1147761217148, 6186.153972798393, 4733.8544572025885, 9846.904271943691, 6893.273385856359, 5800.442475640741, 9534.811246218025, 3335.39233323983, 3200.147962522358, 1757.5094069929562, 6087.376258618264, 3469.606086718301, 7299.972226816263, 4858.67231298447, 6391.20634991916, 4615.473462950498, 6247.728114231866, 9601.232187365791, 2905.402859379908], "policy_adversary_policy_reward": [-8219.701221766116, -8315.992901250256, -9666.587615462395, -6074.32417893678, -82.50966153369899, -659.7085460093376, -10087.60838444711, -8198.32978639072, -8027.701253412227, -4848.798357715694, -7472.931586334678, -7603.614100158271, -9803.209602275323, -11146.579627045161, -5087.761587433182, -7189.753992975347, -5423.039157441483, -8425.140330839444, -4149.724238590428, -9704.19613034499, -5323.502273567704, -4320.338659829445, -9643.575673964453, -7279.8215748822095, -7932.390211033157, -8441.711051098546, -5318.678710875111, -8510.038018027371, -3990.5056461281824, -3110.6160874148054, -4390.63154897181, -4337.248244594837, -9098.31907337052, -10855.780957711508, -8902.92640676611, -9497.986556939595, -9939.299082190695, -5877.369392970966, -6098.2011578028505, -9908.13768786581, -6967.329329031009, -3788.4177674935427, -5029.578034980564, -4963.8346290351665, -4447.666352776476, -6765.761372137666, -10831.141233974307, -4958.2718113178435, -2868.377636599018, -7483.520302258335, -9308.01584715125, -9601.417077961467, -9265.268523173168, -8874.480478741652, -6595.048795984379, -3796.5664743309676, -10197.124845243135, -10081.030179916055, -9303.524316312298, -8007.897122611743, -4424.573474432315, -8416.451351956208, -11496.45700129335, -12151.515717733339, -6796.678878593553, -9333.34926207867, -2561.448755653341, -4629.923801707246, -5528.372124960583, -3504.6102017064554, -8127.009108356488, -2600.2363914544685, -5173.298282040205, -3185.807592210175, -444.91118880529956, -1323.1640636875372, -3267.1463929813594, -496.6375064919139, -7555.618230805217, -6727.761218668611, -8695.794002063938, -7807.066812382505, -13103.993293276271, -10563.85549563688, -5462.505010621087, -8271.718931844434, -6888.882458229484, -8240.933449820639, -0.9128352555288183, -21.28375993602028, -7974.012897566913, -9679.779326983147, -9136.384222981973, -9034.063813634686, -5938.302651113342, -6501.824011000267, -8648.642495007136, -6846.4095941594005, -6858.130599389126, -3202.1045987868033, -12484.853687594481, -12876.946991370902, -7863.049499997914, -6460.892223723444, -7866.532236358364, -9176.189962583438, -3732.285609089264, -6821.922145461711, -4812.422961309519, -10923.008769771202, -6177.549738869017, -9487.216210423805, -8910.642325466142, -4371.743786112614, -5692.319908797144, -4732.869205667276, -3808.36490370512, -1323.0495850087977, -10527.803471379155, -10237.425384021943, -5152.695840160732, -6091.919875670993, -8148.342241888591, -3469.260247418966, -9692.109559641403, -7189.364781511161, -8187.225496418522, -4560.674959395314, -5927.147878986846, -4616.363323273658, -6590.050933897391, -5358.433686957026, -1337.3170807503955, -216.00492193837044, -6323.492036816133, -7388.958593229258, -3745.236885007591, -5858.94916918196, -6794.331152324335, -7543.690646027652, -7833.008300685155, -3640.2683048221506, -7600.505963681933, -4340.888819456402, -7691.094522362205, -8836.735941780064, -8515.766056563785, -10815.967135296456, -10474.221720708407, -9103.65708631592, -7930.899741107634, -5887.136613827244, -9846.11828399, -7971.631361397401, -3768.756975850241, -6115.864595079816, -2408.9030361310447, -7024.447014218099, -43.75218127909201, -0.8274422246066364, -11901.02896640957, -10141.278704952461, -5425.9881775198755, -1267.1147761217148, -6186.153972798393, -8256.55906256375, -5193.51721061556, -4812.80021785398, -9914.10738636166, -10090.382230810887, -6896.659659126028, -7878.2663792397, -7497.210689795421, -5893.381963871618, -9541.315284652494, -10060.956202922533, -3335.39233323983, -8992.699648788037, -3208.7816118624564, -5823.03334146225, -2618.7754865020793, -3817.8743031533168, -6087.376258618264, -9085.395626370679, -3472.2400580054136, -6485.485250634167, -7813.7263501559455, -8264.014661876332, -9889.841776717956, -4858.67231298447, -9260.727357765012, -6391.20634991916, -4660.901502309779, -5429.653098143789, -6247.728114231866, -11696.763786877527, -11251.82182056306, -9637.060589836745, -2905.402859379908, -8371.501211271769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40745204359413295, "mean_inference_ms": 0.9951248391587506, "mean_action_processing_ms": 0.17068003494087264, "mean_env_wait_ms": 0.0519154926547937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00331878662109375, "StateBufferConnector_ms": 0.0024541616439819336, "ViewRequirementAgentConnector_ms": 0.06589031219482422}, "num_episodes": 22, "episode_return_max": -21.28375993602028, "episode_return_min": -13103.993293276271, "episode_return_mean": -7910.806967121564}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.2627017038161, "num_env_steps_trained_throughput_per_sec": 539.2627017038161, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 7481.392, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7481.361, "sample_time_ms": 799.509, "learn_time_ms": 6669.482, "learn_throughput": 599.747, "synch_weights_time_ms": 11.815}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "training_iteration": 71, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-18", "timestamp": 1723232118, "time_this_iter_s": 7.422702789306641, "time_total_s": 542.361786365509, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 542.361786365509, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 26.119999999999997, "ram_util_percent": 81.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9997203653678298, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992887822786967, "policy_loss": -0.004740387587420022, "vf_loss": 9.993682303031285, "vf_explained_var": 0.00014257971197366713, "kl": 0.0077943841761831814, "entropy": 1.5169195044785737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7813495521192197, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994943060193743, "policy_loss": -0.003397359601566913, "vf_loss": 9.996291153014653, "vf_explained_var": 0.0005794219239048227, "kl": 0.0068309135189299625, "entropy": 1.0853876004774103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": -21.28375993602028, "episode_reward_min": -13103.993293276271, "episode_reward_mean": -8004.294096890817, "episode_len_mean": 189.17, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18917, "policy_reward_min": {"agent_policy": 0.8274422246066364, "adversary_policy": -13103.993293276271}, "policy_reward_max": {"agent_policy": 12447.000061899427, "adversary_policy": -0.8274422246066364}, "policy_reward_mean": {"agent_policy": 5552.154301195197, "adversary_policy": -6778.2241990430075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6765.761372137666, -10831.141233974307, -7483.520302258335, -9620.726989698562, -9521.39129728501, -6956.658288507797, -10593.657827719999, -9303.5243163123, -8416.451351956208, -12255.186352095201, -9357.0274190548, -4694.416715361112, -5660.386804720499, -8257.759610522824, -5173.702440981902, -1323.1640636875372, -3267.146392981359, -7558.772884264073, -8695.794002063938, -13103.993293276271, -8271.718931844434, -8242.950187940733, -21.28375993602028, -9701.525946962247, -9226.594210685715, -6776.060095219458, -8698.014906248676, -6858.130599389126, -12914.800617065954, -7917.320022780038, -9176.189962583436, -7218.435853962303, -10923.008769771206, -9487.515118019708, -8910.642325466144, -5754.634484856709, -3808.3649037051196, -10899.502764008494, -6139.338056526388, -8148.342241888593, -9692.1095596414, -8187.225496418522, -5927.147878986846, -6590.050933897392, -1337.3170807503955, -7388.958593229257, -5858.949169181959, -7809.101589517861, -7833.008300685155, -7600.505963681932, -8836.735941780064, -10815.967135296456, -10712.45759760234, -7930.899741107634, -9954.018839786604, -6115.864595079816, -7024.447014218099, -43.75218127909201, -11954.772321595352, -5425.9881775198755, -8256.559062563752, -5272.462971266951, -10157.58534522886, -7881.652652509369, -7590.150178026297, -10067.460241357003, -8992.699648788037, -5831.66699080235, -4679.140382662439, -9085.395626370679, -6488.119221921279, -8777.768785216016, -9889.841776717953, -9260.727357765008, -5475.08113750307, -11696.763786877527, -11287.650223034014, -8371.501211271769, -11928.055859332964, -9459.67225343858, -8140.412876596032, -9425.955197174255, -11309.771146935926, -9824.23199922736, -1747.5388183236503, -8979.545830311945, -9471.238285421783, -8318.12513287567, -6269.898614185119, -5377.600180649228, -9895.338337971778, -10295.87449742124, -10243.69084954226, -8887.553922564706, -9705.650847424515, -9268.252168022333, -6869.348820352892, -6731.277446084442, -8381.652640936612, -5862.662535429738], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 66, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4447.666352776476, 4958.2718113178435, 2868.377636599018, 9288.705935414155, 8618.357704629818, 3434.9569818075493, 9684.497197439196, 8007.897122611743, 4424.573474432315, 11392.786366931487, 6773.000721617423, 2496.955841999474, 3372.5955219465427, 2469.485889288132, 3185.4034332684782, 444.91118880529956, 496.6375064919139, 6724.606565209755, 7807.066812382505, 10563.85549563688, 5462.505010621087, 6886.865720109389, 0.9128352555288183, 7952.266277587804, 8943.85382593094, 5664.066566894155, 6797.0371829178575, 3202.1045987868033, 12447.000061899427, 6406.6217009413185, 7866.532236358364, 3335.771900588672, 4812.422961309519, 6177.250831273116, 4371.743786112614, 4670.554629607712, 1323.0495850087977, 9865.726091392595, 5105.277659305336, 3469.260247418966, 7189.364781511161, 4560.674959395314, 4616.363323273658, 5358.433686957026, 216.00492193837044, 6323.492036816133, 3745.236885007591, 6528.920208834129, 3640.2683048221506, 4340.888819456402, 7691.094522362205, 8515.766056563785, 8865.42120942198, 5887.136613827244, 7863.73080560079, 3768.756975850241, 2408.9030361310447, 0.8274422246066364, 10087.535349766682, 1267.1147761217148, 6186.153972798393, 4733.8544572025885, 9846.904271943691, 6893.273385856359, 5800.442475640741, 9534.811246218025, 3335.39233323983, 3200.147962522358, 1757.5094069929562, 6087.376258618264, 3469.606086718301, 7299.972226816263, 4858.67231298447, 6391.20634991916, 4615.473462950498, 6247.728114231866, 9601.232187365791, 2905.402859379908, 8949.660430378883, 6595.620924572399, 7025.92080699319, 6087.136934140106, 6022.869663978656, 7943.504425312537, 538.0649506625795, 6550.735455731414, 4196.943287285, 7899.817910252214, 3245.7257295322074, 4738.920467450832, 4947.113573716844, 9166.998996840739, 6017.48653619069, 7353.784271418149, 4358.9346244568715, 8868.71073148895, 2976.1670431307452, 4265.817189984396, 3602.768695708711, 2000.2001130859212], "policy_adversary_policy_reward": [-4447.666352776476, -6765.761372137666, -10831.141233974307, -4958.2718113178435, -2868.377636599018, -7483.520302258335, -9308.01584715125, -9601.417077961467, -9265.268523173168, -8874.480478741652, -6595.048795984379, -3796.5664743309676, -10197.124845243135, -10081.030179916055, -9303.524316312298, -8007.897122611743, -4424.573474432315, -8416.451351956208, -11496.45700129335, -12151.515717733339, -6796.678878593553, -9333.34926207867, -2561.448755653341, -4629.923801707246, -5528.372124960583, -3504.6102017064554, -8127.009108356488, -2600.2363914544685, -5173.298282040205, -3185.807592210175, -444.91118880529956, -1323.1640636875372, -3267.1463929813594, -496.6375064919139, -7555.618230805217, -6727.761218668611, -8695.794002063938, -7807.066812382505, -13103.993293276271, -10563.85549563688, -5462.505010621087, -8271.718931844434, -6888.882458229484, -8240.933449820639, -0.9128352555288183, -21.28375993602028, -7974.012897566913, -9679.779326983147, -9136.384222981973, -9034.063813634686, -5938.302651113342, -6501.824011000267, -8648.642495007136, -6846.4095941594005, -6858.130599389126, -3202.1045987868033, -12484.853687594481, -12876.946991370902, -7863.049499997914, -6460.892223723444, -7866.532236358364, -9176.189962583438, -3732.285609089264, -6821.922145461711, -4812.422961309519, -10923.008769771202, -6177.549738869017, -9487.216210423805, -8910.642325466142, -4371.743786112614, -5692.319908797144, -4732.869205667276, -3808.36490370512, -1323.0495850087977, -10527.803471379155, -10237.425384021943, -5152.695840160732, -6091.919875670993, -8148.342241888591, -3469.260247418966, -9692.109559641403, -7189.364781511161, -8187.225496418522, -4560.674959395314, -5927.147878986846, -4616.363323273658, -6590.050933897391, -5358.433686957026, -1337.3170807503955, -216.00492193837044, -6323.492036816133, -7388.958593229258, -3745.236885007591, -5858.94916918196, -6794.331152324335, -7543.690646027652, -7833.008300685155, -3640.2683048221506, -7600.505963681933, -4340.888819456402, -7691.094522362205, -8836.735941780064, -8515.766056563785, -10815.967135296456, -10474.221720708407, -9103.65708631592, -7930.899741107634, -5887.136613827244, -9846.11828399, -7971.631361397401, -3768.756975850241, -6115.864595079816, -2408.9030361310447, -7024.447014218099, -43.75218127909201, -0.8274422246066364, -11901.02896640957, -10141.278704952461, -5425.9881775198755, -1267.1147761217148, -6186.153972798393, -8256.55906256375, -5193.51721061556, -4812.80021785398, -9914.10738636166, -10090.382230810887, -6896.659659126028, -7878.2663792397, -7497.210689795421, -5893.381963871618, -9541.315284652494, -10060.956202922533, -3335.39233323983, -8992.699648788037, -3208.7816118624564, -5823.03334146225, -2618.7754865020793, -3817.8743031533168, -6087.376258618264, -9085.395626370679, -3472.2400580054136, -6485.485250634167, -7813.7263501559455, -8264.014661876332, -9889.841776717956, -4858.67231298447, -9260.727357765012, -6391.20634991916, -4660.901502309779, -5429.653098143789, -6247.728114231866, -11696.763786877527, -11251.82182056306, -9637.060589836745, -2905.402859379908, -8371.501211271769, -8949.660430378883, -11928.055859332964, -6595.620924572399, -9459.67225343858, -8131.860788675217, -7034.472894914005, -6087.136934140106, -9425.955197174255, -6022.869663978656, -11309.771146935926, -9776.12460224195, -7991.611822297962, -538.0649506625795, -1747.5388183236503, -6550.735455731414, -8979.545830311945, -9471.238285421783, -4196.943287285, -8240.168734463028, -7977.774308664855, -3778.080948776758, -5737.543394940567, -5137.568579586469, -4978.952068513596, -4947.113573716844, -9895.338337971778, -9188.438932254887, -10274.434562007093, -10243.690849542261, -6017.48653619069, -8886.857515206533, -7354.480678776321, -4358.9346244568715, -9705.650847424515, -8891.664317477163, -9245.298582034124, -6869.348820352892, -2976.1670431307452, -6731.27744608444, -4265.817189984396, -8357.39837130188, -3627.022965343442, -3720.9835288475397, -4141.8791196681195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40711991868033387, "mean_inference_ms": 0.994601399152287, "mean_action_processing_ms": 0.17064234366805828, "mean_env_wait_ms": 0.05188095861420154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00330352783203125, "StateBufferConnector_ms": 0.0024946928024291992, "ViewRequirementAgentConnector_ms": 0.06622004508972168}, "num_episodes": 22, "episode_return_max": -21.28375993602028, "episode_return_min": -13103.993293276271, "episode_return_mean": -8004.294096890817}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.1349166123669, "num_env_steps_trained_throughput_per_sec": 541.1349166123669, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 7469.678, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7469.647, "sample_time_ms": 798.89, "learn_time_ms": 6658.311, "learn_throughput": 600.753, "synch_weights_time_ms": 11.892}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 72, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-26", "timestamp": 1723232126, "time_this_iter_s": 7.396504163742065, "time_total_s": 549.7582905292511, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f35e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 549.7582905292511, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.55454545454545, "ram_util_percent": 80.99090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9690763714102407, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998071531454721, "policy_loss": -0.007220657821987212, "vf_loss": 10.0, "vf_explained_var": 0.00025392528623342515, "kl": 0.010453669643902685, "entropy": 1.5024954773485661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7730679515729506, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998503317151751, "policy_loss": -0.0050012773922866295, "vf_loss": 10.0, "vf_explained_var": 0.000431302962479768, "kl": 0.01168194169957171, "entropy": 1.1000676203026343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "env_runners": {"episode_reward_max": -21.28375993602028, "episode_reward_min": -13175.668907216885, "episode_reward_mean": -8162.523649230758, "episode_len_mean": 192.1, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19210, "policy_reward_min": {"agent_policy": 0.8274422246066364, "adversary_policy": -13175.668907216885}, "policy_reward_max": {"agent_policy": 12447.000061899427, "adversary_policy": -0.8274422246066364}, "policy_reward_mean": {"agent_policy": 5688.326872812497, "adversary_policy": -6925.425261021626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8271.718931844434, -8242.950187940733, -21.28375993602028, -9701.525946962247, -9226.594210685715, -6776.060095219458, -8698.014906248676, -6858.130599389126, -12914.800617065954, -7917.320022780038, -9176.189962583436, -7218.435853962303, -10923.008769771206, -9487.515118019708, -8910.642325466144, -5754.634484856709, -3808.3649037051196, -10899.502764008494, -6139.338056526388, -8148.342241888593, -9692.1095596414, -8187.225496418522, -5927.147878986846, -6590.050933897392, -1337.3170807503955, -7388.958593229257, -5858.949169181959, -7809.101589517861, -7833.008300685155, -7600.505963681932, -8836.735941780064, -10815.967135296456, -10712.45759760234, -7930.899741107634, -9954.018839786604, -6115.864595079816, -7024.447014218099, -43.75218127909201, -11954.772321595352, -5425.9881775198755, -8256.559062563752, -5272.462971266951, -10157.58534522886, -7881.652652509369, -7590.150178026297, -10067.460241357003, -8992.699648788037, -5831.66699080235, -4679.140382662439, -9085.395626370679, -6488.119221921279, -8777.768785216016, -9889.841776717953, -9260.727357765008, -5475.08113750307, -11696.763786877527, -11287.650223034014, -8371.501211271769, -11928.055859332964, -9459.67225343858, -8140.412876596032, -9425.955197174255, -11309.771146935926, -9824.23199922736, -1747.5388183236503, -8979.545830311945, -9471.238285421783, -8318.12513287567, -6269.898614185119, -5377.600180649228, -9895.338337971778, -10295.87449742124, -10243.69084954226, -8887.553922564706, -9705.650847424515, -9268.252168022333, -6869.348820352892, -6731.277446084442, -8381.652640936612, -5862.662535429738, -10637.353780500678, -8654.020095991516, -10023.659217687458, -9288.622698790228, -7587.196248991757, -13175.668907216885, -11244.576194758347, -9615.100629237282, -6690.571051241081, -8830.645579203347, -6199.5861333528355, -8971.899318211834, -11773.438665619757, -6879.129677601371, -6508.04444693552, -7370.883707047999, -7124.397122355727, -8818.980147242735, -5092.999723695973, -10176.364847171477], "episode_lengths": [200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5462.505010621087, 6886.865720109389, 0.9128352555288183, 7952.266277587804, 8943.85382593094, 5664.066566894155, 6797.0371829178575, 3202.1045987868033, 12447.000061899427, 6406.6217009413185, 7866.532236358364, 3335.771900588672, 4812.422961309519, 6177.250831273116, 4371.743786112614, 4670.554629607712, 1323.0495850087977, 9865.726091392595, 5105.277659305336, 3469.260247418966, 7189.364781511161, 4560.674959395314, 4616.363323273658, 5358.433686957026, 216.00492193837044, 6323.492036816133, 3745.236885007591, 6528.920208834129, 3640.2683048221506, 4340.888819456402, 7691.094522362205, 8515.766056563785, 8865.42120942198, 5887.136613827244, 7863.73080560079, 3768.756975850241, 2408.9030361310447, 0.8274422246066364, 10087.535349766682, 1267.1147761217148, 6186.153972798393, 4733.8544572025885, 9846.904271943691, 6893.273385856359, 5800.442475640741, 9534.811246218025, 3335.39233323983, 3200.147962522358, 1757.5094069929562, 6087.376258618264, 3469.606086718301, 7299.972226816263, 4858.67231298447, 6391.20634991916, 4615.473462950498, 6247.728114231866, 9601.232187365791, 2905.402859379908, 8949.660430378883, 6595.620924572399, 7025.92080699319, 6087.136934140106, 6022.869663978656, 7943.504425312537, 538.0649506625795, 6550.735455731414, 4196.943287285, 7899.817910252214, 3245.7257295322074, 4738.920467450832, 4947.113573716844, 9166.998996840739, 6017.48653619069, 7353.784271418149, 4358.9346244568715, 8868.71073148895, 2976.1670431307452, 4265.817189984396, 3602.768695708711, 2000.2001130859212, 9060.346942350636, 7816.024789749393, 7311.86373114492, 5539.050443559576, 5322.757674520942, 10442.665471561555, 8904.375911375928, 5331.54297020936, 5127.224360231599, 8462.921731468952, 3331.6923123496695, 6340.103800051003, 7819.16817706309, 4575.52240946963, 3548.64741559881, 3715.4922010965656, 3900.242591637421, 6012.346550759277, 3388.6291669649117, 9127.248071172611], "policy_adversary_policy_reward": [-5462.505010621087, -8271.718931844434, -6888.882458229484, -8240.933449820639, -0.9128352555288183, -21.28375993602028, -7974.012897566913, -9679.779326983147, -9136.384222981973, -9034.063813634686, -5938.302651113342, -6501.824011000267, -8648.642495007136, -6846.4095941594005, -6858.130599389126, -3202.1045987868033, -12484.853687594481, -12876.946991370902, -7863.049499997914, -6460.892223723444, -7866.532236358364, -9176.189962583438, -3732.285609089264, -6821.922145461711, -4812.422961309519, -10923.008769771202, -6177.549738869017, -9487.216210423805, -8910.642325466142, -4371.743786112614, -5692.319908797144, -4732.869205667276, -3808.36490370512, -1323.0495850087977, -10527.803471379155, -10237.425384021943, -5152.695840160732, -6091.919875670993, -8148.342241888591, -3469.260247418966, -9692.109559641403, -7189.364781511161, -8187.225496418522, -4560.674959395314, -5927.147878986846, -4616.363323273658, -6590.050933897391, -5358.433686957026, -1337.3170807503955, -216.00492193837044, -6323.492036816133, -7388.958593229258, -3745.236885007591, -5858.94916918196, -6794.331152324335, -7543.690646027652, -7833.008300685155, -3640.2683048221506, -7600.505963681933, -4340.888819456402, -7691.094522362205, -8836.735941780064, -8515.766056563785, -10815.967135296456, -10474.221720708407, -9103.65708631592, -7930.899741107634, -5887.136613827244, -9846.11828399, -7971.631361397401, -3768.756975850241, -6115.864595079816, -2408.9030361310447, -7024.447014218099, -43.75218127909201, -0.8274422246066364, -11901.02896640957, -10141.278704952461, -5425.9881775198755, -1267.1147761217148, -6186.153972798393, -8256.55906256375, -5193.51721061556, -4812.80021785398, -9914.10738636166, -10090.382230810887, -6896.659659126028, -7878.2663792397, -7497.210689795421, -5893.381963871618, -9541.315284652494, -10060.956202922533, -3335.39233323983, -8992.699648788037, -3208.7816118624564, -5823.03334146225, -2618.7754865020793, -3817.8743031533168, -6087.376258618264, -9085.395626370679, -3472.2400580054136, -6485.485250634167, -7813.7263501559455, -8264.014661876332, -9889.841776717956, -4858.67231298447, -9260.727357765012, -6391.20634991916, -4660.901502309779, -5429.653098143789, -6247.728114231866, -11696.763786877527, -11251.82182056306, -9637.060589836745, -2905.402859379908, -8371.501211271769, -8949.660430378883, -11928.055859332964, -6595.620924572399, -9459.67225343858, -8131.860788675217, -7034.472894914005, -6087.136934140106, -9425.955197174255, -6022.869663978656, -11309.771146935926, -9776.12460224195, -7991.611822297962, -538.0649506625795, -1747.5388183236503, -6550.735455731414, -8979.545830311945, -9471.238285421783, -4196.943287285, -8240.168734463028, -7977.774308664855, -3778.080948776758, -5737.543394940567, -5137.568579586469, -4978.952068513596, -4947.113573716844, -9895.338337971778, -9188.438932254887, -10274.434562007093, -10243.690849542261, -6017.48653619069, -8886.857515206533, -7354.480678776321, -4358.9346244568715, -9705.650847424515, -8891.664317477163, -9245.298582034124, -6869.348820352892, -2976.1670431307452, -6731.27744608444, -4265.817189984396, -8357.39837130188, -3627.022965343442, -3720.9835288475397, -4141.8791196681195, -10496.582916201321, -9201.117806650007, -8318.339962305465, -8151.7049234354445, -7311.86373114492, -10023.659217687458, -9288.62269879023, -5539.050443559576, -7387.550384686291, -5522.40353882641, -13175.668907216885, -10442.665471561555, -11244.576194758345, -8904.375911375928, -9615.100629237282, -5331.54297020936, -6690.57105124108, -5127.224360231599, -8484.04329662365, -8809.524014048653, -3871.251370975971, -5660.027074726535, -8893.837139602267, -6418.165978660573, -7819.16817706309, -11773.438665619757, -6140.652087773615, -5313.999999297387, -3551.477034139508, -6505.214828394823, -7370.883707047999, -3715.4922010965656, -3900.242591637421, -7124.397122355727, -6012.346550759277, -8818.980147242735, -4551.542430218324, -3930.0864604425656, -10054.055561053445, -9249.55735729064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4070908244773199, "mean_inference_ms": 0.9935763242357251, "mean_action_processing_ms": 0.17048736436498335, "mean_env_wait_ms": 0.05186401624732165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033233165740966797, "StateBufferConnector_ms": 0.0025292634963989258, "ViewRequirementAgentConnector_ms": 0.06728041172027588}, "num_episodes": 20, "episode_return_max": -21.28375993602028, "episode_return_min": -13175.668907216885, "episode_return_mean": -8162.523649230758}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.0399807785888, "num_env_steps_trained_throughput_per_sec": 537.0399807785888, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 7452.067, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7452.036, "sample_time_ms": 785.072, "learn_time_ms": 6654.295, "learn_throughput": 601.116, "synch_weights_time_ms": 12.122}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "training_iteration": 73, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-33", "timestamp": 1723232133, "time_this_iter_s": 7.452571868896484, "time_total_s": 557.2108623981476, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f3820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 557.2108623981476, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 23.08181818181818, "ram_util_percent": 80.99090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9466065559536219, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996525047222773, "policy_loss": -0.003590000451852878, "vf_loss": 9.993825913468998, "vf_explained_var": -4.104593147834142e-05, "kl": 0.012422928065643647, "entropy": 1.4979002023736636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7262200807768201, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99845563394052, "policy_loss": -0.0031115524528705805, "vf_loss": 9.998201786021076, "vf_explained_var": 0.00043875322770820093, "kl": 0.011217905235816799, "entropy": 1.0707791873386927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": -43.75218127909201, "episode_reward_min": -13175.668907216885, "episode_reward_mean": -8274.930960887961, "episode_len_mean": 192.18, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19218, "policy_reward_min": {"agent_policy": 0.8274422246066364, "adversary_policy": -13175.668907216885}, "policy_reward_max": {"agent_policy": 12532.071521301605, "adversary_policy": -0.8274422246066364}, "policy_reward_mean": {"agent_policy": 5765.1875362406745, "adversary_policy": -7020.059248564317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8148.342241888593, -9692.1095596414, -8187.225496418522, -5927.147878986846, -6590.050933897392, -1337.3170807503955, -7388.958593229257, -5858.949169181959, -7809.101589517861, -7833.008300685155, -7600.505963681932, -8836.735941780064, -10815.967135296456, -10712.45759760234, -7930.899741107634, -9954.018839786604, -6115.864595079816, -7024.447014218099, -43.75218127909201, -11954.772321595352, -5425.9881775198755, -8256.559062563752, -5272.462971266951, -10157.58534522886, -7881.652652509369, -7590.150178026297, -10067.460241357003, -8992.699648788037, -5831.66699080235, -4679.140382662439, -9085.395626370679, -6488.119221921279, -8777.768785216016, -9889.841776717953, -9260.727357765008, -5475.08113750307, -11696.763786877527, -11287.650223034014, -8371.501211271769, -11928.055859332964, -9459.67225343858, -8140.412876596032, -9425.955197174255, -11309.771146935926, -9824.23199922736, -1747.5388183236503, -8979.545830311945, -9471.238285421783, -8318.12513287567, -6269.898614185119, -5377.600180649228, -9895.338337971778, -10295.87449742124, -10243.69084954226, -8887.553922564706, -9705.650847424515, -9268.252168022333, -6869.348820352892, -6731.277446084442, -8381.652640936612, -5862.662535429738, -10637.353780500678, -8654.020095991516, -10023.659217687458, -9288.622698790228, -7587.196248991757, -13175.668907216885, -11244.576194758347, -9615.100629237282, -6690.571051241081, -8830.645579203347, -6199.5861333528355, -8971.899318211834, -11773.438665619757, -6879.129677601371, -6508.04444693552, -7370.883707047999, -7124.397122355727, -8818.980147242735, -5092.999723695973, -10176.364847171477, -7027.402607135244, -8830.226609124444, -6320.4482025471, -9325.012084338969, -165.880110495712, -12803.53721776681, -6080.482912829105, -10780.207776905281, -10910.600328774392, -12046.69632788635, -9260.381822476797, -9007.016394384682, -8844.053293842715, -7029.909824638803, -9612.766766596491, -8986.5085011978, -5852.751322133729, -9736.8980724739, -9565.982507143994], "episode_lengths": [200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3469.260247418966, 7189.364781511161, 4560.674959395314, 4616.363323273658, 5358.433686957026, 216.00492193837044, 6323.492036816133, 3745.236885007591, 6528.920208834129, 3640.2683048221506, 4340.888819456402, 7691.094522362205, 8515.766056563785, 8865.42120942198, 5887.136613827244, 7863.73080560079, 3768.756975850241, 2408.9030361310447, 0.8274422246066364, 10087.535349766682, 1267.1147761217148, 6186.153972798393, 4733.8544572025885, 9846.904271943691, 6893.273385856359, 5800.442475640741, 9534.811246218025, 3335.39233323983, 3200.147962522358, 1757.5094069929562, 6087.376258618264, 3469.606086718301, 7299.972226816263, 4858.67231298447, 6391.20634991916, 4615.473462950498, 6247.728114231866, 9601.232187365791, 2905.402859379908, 8949.660430378883, 6595.620924572399, 7025.92080699319, 6087.136934140106, 6022.869663978656, 7943.504425312537, 538.0649506625795, 6550.735455731414, 4196.943287285, 7899.817910252214, 3245.7257295322074, 4738.920467450832, 4947.113573716844, 9166.998996840739, 6017.48653619069, 7353.784271418149, 4358.9346244568715, 8868.71073148895, 2976.1670431307452, 4265.817189984396, 3602.768695708711, 2000.2001130859212, 9060.346942350636, 7816.024789749393, 7311.86373114492, 5539.050443559576, 5322.757674520942, 10442.665471561555, 8904.375911375928, 5331.54297020936, 5127.224360231599, 8462.921731468952, 3331.6923123496695, 6340.103800051003, 7819.16817706309, 4575.52240946963, 3548.64741559881, 3715.4922010965656, 3900.242591637421, 6012.346550759277, 3388.6291669649117, 9127.248071172611, 5188.6328562645185, 3446.9838908798574, 3714.274011843111, 8209.127969711264, 18.46824971675606, 12532.071521301605, 4918.865875615039, 9736.353594087614, 5159.710075980753, 7250.626954299957, 8619.50238911168, 4669.783961462527, 3471.366030003194, 5709.629347454246, 8350.165870118897, 8479.553992157562, 4391.0846601560925, 9031.851658431846, 6079.576896122444], "policy_adversary_policy_reward": [-8148.342241888591, -3469.260247418966, -9692.109559641403, -7189.364781511161, -8187.225496418522, -4560.674959395314, -5927.147878986846, -4616.363323273658, -6590.050933897391, -5358.433686957026, -1337.3170807503955, -216.00492193837044, -6323.492036816133, -7388.958593229258, -3745.236885007591, -5858.94916918196, -6794.331152324335, -7543.690646027652, -7833.008300685155, -3640.2683048221506, -7600.505963681933, -4340.888819456402, -7691.094522362205, -8836.735941780064, -8515.766056563785, -10815.967135296456, -10474.221720708407, -9103.65708631592, -7930.899741107634, -5887.136613827244, -9846.11828399, -7971.631361397401, -3768.756975850241, -6115.864595079816, -2408.9030361310447, -7024.447014218099, -43.75218127909201, -0.8274422246066364, -11901.02896640957, -10141.278704952461, -5425.9881775198755, -1267.1147761217148, -6186.153972798393, -8256.55906256375, -5193.51721061556, -4812.80021785398, -9914.10738636166, -10090.382230810887, -6896.659659126028, -7878.2663792397, -7497.210689795421, -5893.381963871618, -9541.315284652494, -10060.956202922533, -3335.39233323983, -8992.699648788037, -3208.7816118624564, -5823.03334146225, -2618.7754865020793, -3817.8743031533168, -6087.376258618264, -9085.395626370679, -3472.2400580054136, -6485.485250634167, -7813.7263501559455, -8264.014661876332, -9889.841776717956, -4858.67231298447, -9260.727357765012, -6391.20634991916, -4660.901502309779, -5429.653098143789, -6247.728114231866, -11696.763786877527, -11251.82182056306, -9637.060589836745, -2905.402859379908, -8371.501211271769, -8949.660430378883, -11928.055859332964, -6595.620924572399, -9459.67225343858, -8131.860788675217, -7034.472894914005, -6087.136934140106, -9425.955197174255, -6022.869663978656, -11309.771146935926, -9776.12460224195, -7991.611822297962, -538.0649506625795, -1747.5388183236503, -6550.735455731414, -8979.545830311945, -9471.238285421783, -4196.943287285, -8240.168734463028, -7977.774308664855, -3778.080948776758, -5737.543394940567, -5137.568579586469, -4978.952068513596, -4947.113573716844, -9895.338337971778, -9188.438932254887, -10274.434562007093, -10243.690849542261, -6017.48653619069, -8886.857515206533, -7354.480678776321, -4358.9346244568715, -9705.650847424515, -8891.664317477163, -9245.298582034124, -6869.348820352892, -2976.1670431307452, -6731.27744608444, -4265.817189984396, -8357.39837130188, -3627.022965343442, -3720.9835288475397, -4141.8791196681195, -10496.582916201321, -9201.117806650007, -8318.339962305465, -8151.7049234354445, -7311.86373114492, -10023.659217687458, -9288.62269879023, -5539.050443559576, -7387.550384686291, -5522.40353882641, -13175.668907216885, -10442.665471561555, -11244.576194758345, -8904.375911375928, -9615.100629237282, -5331.54297020936, -6690.57105124108, -5127.224360231599, -8484.04329662365, -8809.524014048653, -3871.251370975971, -5660.027074726535, -8893.837139602267, -6418.165978660573, -7819.16817706309, -11773.438665619757, -6140.652087773615, -5313.999999297387, -3551.477034139508, -6505.214828394823, -7370.883707047999, -3715.4922010965656, -3900.242591637421, -7124.397122355727, -6012.346550759277, -8818.980147242735, -4551.542430218324, -3930.0864604425656, -10054.055561053445, -9249.55735729064, -6474.410398121389, -5741.625065278371, -8830.226609124444, -3446.9838908798574, -6320.4482025471, -3714.274011843111, -9325.012084338969, -8209.127969711264, -165.88011049571202, -18.46824971675606, -12609.38326654223, -12726.225472526183, -6080.482912829105, -4918.865875615039, -10775.131698305093, -9741.429672687796, -10910.600328774393, -5159.710075980753, -7250.626954299957, -12046.69632788635, -9260.381822476797, -8619.50238911168, -4669.783961462527, -9007.016394384682, -3474.2142656872024, -8841.205058158706, -6368.222704766661, -6371.316467326391, -9477.457199122942, -8485.475437592439, -8905.991851025543, -8560.070642329825, -5852.7235302696945, -4391.112452020127, -9195.13615354181, -9573.61357736394, -8119.250999369616, -7526.308403896824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4067740081592822, "mean_inference_ms": 0.9924640101806296, "mean_action_processing_ms": 0.17033817670708346, "mean_env_wait_ms": 0.051862550755816424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033431053161621094, "StateBufferConnector_ms": 0.0025315284729003906, "ViewRequirementAgentConnector_ms": 0.06810581684112549}, "num_episodes": 19, "episode_return_max": -43.75218127909201, "episode_return_min": -13175.668907216885, "episode_return_mean": -8274.930960887961}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.4490806812225, "num_env_steps_trained_throughput_per_sec": 558.4490806812225, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 7365.823, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7365.792, "sample_time_ms": 748.985, "learn_time_ms": 6604.117, "learn_throughput": 605.683, "synch_weights_time_ms": 12.152}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 74, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-41", "timestamp": 1723232141, "time_this_iter_s": 7.166712045669556, "time_total_s": 564.3775744438171, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ea0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 564.3775744438171, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.22, "ram_util_percent": 81.01}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9438902384601533, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002734821041425, "policy_loss": -0.0028857404643834648, "vf_loss": 10.0, "vf_explained_var": 0.0003033841649691264, "kl": 0.011102402944864783, "entropy": 1.4898203904430072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7603763490126877, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99852124572431, "policy_loss": -0.003772483017817928, "vf_loss": 10.0, "vf_explained_var": 4.319400383681847e-05, "kl": 0.0076457026998497666, "entropy": 1.0168161187537763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": -165.880110495712, "episode_reward_min": -13175.668907216885, "episode_reward_mean": -8369.558008449234, "episode_len_mean": 196.61, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19661, "policy_reward_min": {"agent_policy": 18.46824971675606, "adversary_policy": -13175.668907216885}, "policy_reward_max": {"agent_policy": 12532.071521301605, "adversary_policy": -18.46824971675606}, "policy_reward_mean": {"agent_policy": 5835.192240754904, "adversary_policy": -7102.375124602071}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8256.559062563752, -5272.462971266951, -10157.58534522886, -7881.652652509369, -7590.150178026297, -10067.460241357003, -8992.699648788037, -5831.66699080235, -4679.140382662439, -9085.395626370679, -6488.119221921279, -8777.768785216016, -9889.841776717953, -9260.727357765008, -5475.08113750307, -11696.763786877527, -11287.650223034014, -8371.501211271769, -11928.055859332964, -9459.67225343858, -8140.412876596032, -9425.955197174255, -11309.771146935926, -9824.23199922736, -1747.5388183236503, -8979.545830311945, -9471.238285421783, -8318.12513287567, -6269.898614185119, -5377.600180649228, -9895.338337971778, -10295.87449742124, -10243.69084954226, -8887.553922564706, -9705.650847424515, -9268.252168022333, -6869.348820352892, -6731.277446084442, -8381.652640936612, -5862.662535429738, -10637.353780500678, -8654.020095991516, -10023.659217687458, -9288.622698790228, -7587.196248991757, -13175.668907216885, -11244.576194758347, -9615.100629237282, -6690.571051241081, -8830.645579203347, -6199.5861333528355, -8971.899318211834, -11773.438665619757, -6879.129677601371, -6508.04444693552, -7370.883707047999, -7124.397122355727, -8818.980147242735, -5092.999723695973, -10176.364847171477, -7027.402607135244, -8830.226609124444, -6320.4482025471, -9325.012084338969, -165.880110495712, -12803.53721776681, -6080.482912829105, -10780.207776905281, -10910.600328774392, -12046.69632788635, -9260.381822476797, -9007.016394384682, -8844.053293842715, -7029.909824638803, -9612.766766596491, -8986.5085011978, -5852.751322133729, -9736.8980724739, -9565.982507143994, -5538.309568027278, -8540.95471862728, -9164.479847750657, -6377.652857645504, -6302.43531052388, -6374.402861675866, -8113.113340170814, -7859.094894424291, -10096.366569667212, -6734.935653930909, -10297.828191429908, -10172.102478745186, -10764.135625492308, -8919.868489601387, -5948.601240411627, -9354.988045702243, -9674.742826757001, -4945.339154899276, -6373.552349153716, -5474.3998736329695, -7623.021211002756], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6186.153972798393, 4733.8544572025885, 9846.904271943691, 6893.273385856359, 5800.442475640741, 9534.811246218025, 3335.39233323983, 3200.147962522358, 1757.5094069929562, 6087.376258618264, 3469.606086718301, 7299.972226816263, 4858.67231298447, 6391.20634991916, 4615.473462950498, 6247.728114231866, 9601.232187365791, 2905.402859379908, 8949.660430378883, 6595.620924572399, 7025.92080699319, 6087.136934140106, 6022.869663978656, 7943.504425312537, 538.0649506625795, 6550.735455731414, 4196.943287285, 7899.817910252214, 3245.7257295322074, 4738.920467450832, 4947.113573716844, 9166.998996840739, 6017.48653619069, 7353.784271418149, 4358.9346244568715, 8868.71073148895, 2976.1670431307452, 4265.817189984396, 3602.768695708711, 2000.2001130859212, 9060.346942350636, 7816.024789749393, 7311.86373114492, 5539.050443559576, 5322.757674520942, 10442.665471561555, 8904.375911375928, 5331.54297020936, 5127.224360231599, 8462.921731468952, 3331.6923123496695, 6340.103800051003, 7819.16817706309, 4575.52240946963, 3548.64741559881, 3715.4922010965656, 3900.242591637421, 6012.346550759277, 3388.6291669649117, 9127.248071172611, 5188.6328562645185, 3446.9838908798574, 3714.274011843111, 8209.127969711264, 18.46824971675606, 12532.071521301605, 4918.865875615039, 9736.353594087614, 5159.710075980753, 7250.626954299957, 8619.50238911168, 4669.783961462527, 3471.366030003194, 5709.629347454246, 8350.165870118897, 8479.553992157562, 4391.0846601560925, 9031.851658431846, 6079.576896122444, 3668.8139586432553, 7986.978830587587, 7451.638152354959, 4315.560502834406, 3001.2456589605836, 4134.85422986182, 6534.846814566963, 6691.311678701953, 5431.101941071408, 4967.2483101375165, 4739.263764723091, 5263.421927275389, 7177.173746280818, 7587.600911345534, 3446.491977730759, 8005.740315543463, 7170.7867333660415, 2853.0807141017567, 4949.303577918486, 4333.151736033779, 3636.049932684587], "policy_adversary_policy_reward": [-6186.153972798393, -8256.55906256375, -5193.51721061556, -4812.80021785398, -9914.10738636166, -10090.382230810887, -6896.659659126028, -7878.2663792397, -7497.210689795421, -5893.381963871618, -9541.315284652494, -10060.956202922533, -3335.39233323983, -8992.699648788037, -3208.7816118624564, -5823.03334146225, -2618.7754865020793, -3817.8743031533168, -6087.376258618264, -9085.395626370679, -3472.2400580054136, -6485.485250634167, -7813.7263501559455, -8264.014661876332, -9889.841776717956, -4858.67231298447, -9260.727357765012, -6391.20634991916, -4660.901502309779, -5429.653098143789, -6247.728114231866, -11696.763786877527, -11251.82182056306, -9637.060589836745, -2905.402859379908, -8371.501211271769, -8949.660430378883, -11928.055859332964, -6595.620924572399, -9459.67225343858, -8131.860788675217, -7034.472894914005, -6087.136934140106, -9425.955197174255, -6022.869663978656, -11309.771146935926, -9776.12460224195, -7991.611822297962, -538.0649506625795, -1747.5388183236503, -6550.735455731414, -8979.545830311945, -9471.238285421783, -4196.943287285, -8240.168734463028, -7977.774308664855, -3778.080948776758, -5737.543394940567, -5137.568579586469, -4978.952068513596, -4947.113573716844, -9895.338337971778, -9188.438932254887, -10274.434562007093, -10243.690849542261, -6017.48653619069, -8886.857515206533, -7354.480678776321, -4358.9346244568715, -9705.650847424515, -8891.664317477163, -9245.298582034124, -6869.348820352892, -2976.1670431307452, -6731.27744608444, -4265.817189984396, -8357.39837130188, -3627.022965343442, -3720.9835288475397, -4141.8791196681195, -10496.582916201321, -9201.117806650007, -8318.339962305465, -8151.7049234354445, -7311.86373114492, -10023.659217687458, -9288.62269879023, -5539.050443559576, -7387.550384686291, -5522.40353882641, -13175.668907216885, -10442.665471561555, -11244.576194758345, -8904.375911375928, -9615.100629237282, -5331.54297020936, -6690.57105124108, -5127.224360231599, -8484.04329662365, -8809.524014048653, -3871.251370975971, -5660.027074726535, -8893.837139602267, -6418.165978660573, -7819.16817706309, -11773.438665619757, -6140.652087773615, -5313.999999297387, -3551.477034139508, -6505.214828394823, -7370.883707047999, -3715.4922010965656, -3900.242591637421, -7124.397122355727, -6012.346550759277, -8818.980147242735, -4551.542430218324, -3930.0864604425656, -10054.055561053445, -9249.55735729064, -6474.410398121389, -5741.625065278371, -8830.226609124444, -3446.9838908798574, -6320.4482025471, -3714.274011843111, -9325.012084338969, -8209.127969711264, -165.88011049571202, -18.46824971675606, -12609.38326654223, -12726.225472526183, -6080.482912829105, -4918.865875615039, -10775.131698305093, -9741.429672687796, -10910.600328774393, -5159.710075980753, -7250.626954299957, -12046.69632788635, -9260.381822476797, -8619.50238911168, -4669.783961462527, -9007.016394384682, -3474.2142656872024, -8841.205058158706, -6368.222704766661, -6371.316467326391, -9477.457199122942, -8485.475437592439, -8905.991851025543, -8560.070642329825, -5852.7235302696945, -4391.112452020127, -9195.13615354181, -9573.61357736394, -8119.250999369616, -7526.308403896824, -4523.61055266926, -4683.512974001277, -8105.7903883556255, -8422.143160859241, -7646.941771132659, -8969.176228972954, -4529.979297540158, -6163.234062939752, -4461.544735953922, -4842.136233530539, -4135.233473878603, -6374.023617659084, -6534.846814566963, -8113.113340170814, -7859.094894424291, -6691.311678701953, -5431.101941071408, -10096.366569667212, -6487.188436654384, -5214.995527414041, -4739.263764723091, -10297.828191429908, -10172.102478745186, -5263.421927275389, -7177.173746280818, -10764.135625492308, -7601.278583831389, -8906.190817115536, -4036.5049206409044, -5358.5882975014865, -9354.988045702245, -8005.740315543463, -7170.7867333660415, -9674.742826757001, -3371.0983143128956, -4427.3215546881365, -6277.7072311413995, -5045.148695930802, -5251.39667243187, -4556.154937234887, -7623.021211002757, -3636.049932684587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40661906661320274, "mean_inference_ms": 0.9909497633168141, "mean_action_processing_ms": 0.17015539421738665, "mean_env_wait_ms": 0.05181236893674826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003188610076904297, "StateBufferConnector_ms": 0.002381563186645508, "ViewRequirementAgentConnector_ms": 0.0648190975189209}, "num_episodes": 21, "episode_return_max": -165.880110495712, "episode_return_min": -13175.668907216885, "episode_return_mean": -8369.558008449234}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.439305341076, "num_env_steps_trained_throughput_per_sec": 549.439305341076, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 7335.692, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7335.66, "sample_time_ms": 734.696, "learn_time_ms": 6588.35, "learn_throughput": 607.132, "synch_weights_time_ms": 12.111}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 75, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-48", "timestamp": 1723232148, "time_this_iter_s": 7.285254001617432, "time_total_s": 571.6628284454346, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 571.6628284454346, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 23.709090909090904, "ram_util_percent": 80.53636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9674503800148765, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995844663182895, "policy_loss": -0.0015979184696334413, "vf_loss": 9.993790439764659, "vf_explained_var": -6.604008376598358e-06, "kl": 0.0072141327885522815, "entropy": 1.4927870247513055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7491004509979455, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993169997987293, "policy_loss": -0.007756361039355397, "vf_loss": 9.997207686510036, "vf_explained_var": 0.0001484515174986824, "kl": 0.012395582284788213, "entropy": 1.0073780815752726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": -104.72069384926206, "episode_reward_min": -13175.668907216885, "episode_reward_mean": -8377.81720292007, "episode_len_mean": 194.64, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19464, "policy_reward_min": {"agent_policy": 3.8197478964372533, "adversary_policy": -13175.668907216885}, "policy_reward_max": {"agent_policy": 12532.071521301605, "adversary_policy": -3.8197478964372533}, "policy_reward_mean": {"agent_policy": 5833.821132192429, "adversary_policy": -7105.819167556248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11309.771146935926, -9824.23199922736, -1747.5388183236503, -8979.545830311945, -9471.238285421783, -8318.12513287567, -6269.898614185119, -5377.600180649228, -9895.338337971778, -10295.87449742124, -10243.69084954226, -8887.553922564706, -9705.650847424515, -9268.252168022333, -6869.348820352892, -6731.277446084442, -8381.652640936612, -5862.662535429738, -10637.353780500678, -8654.020095991516, -10023.659217687458, -9288.622698790228, -7587.196248991757, -13175.668907216885, -11244.576194758347, -9615.100629237282, -6690.571051241081, -8830.645579203347, -6199.5861333528355, -8971.899318211834, -11773.438665619757, -6879.129677601371, -6508.04444693552, -7370.883707047999, -7124.397122355727, -8818.980147242735, -5092.999723695973, -10176.364847171477, -7027.402607135244, -8830.226609124444, -6320.4482025471, -9325.012084338969, -165.880110495712, -12803.53721776681, -6080.482912829105, -10780.207776905281, -10910.600328774392, -12046.69632788635, -9260.381822476797, -9007.016394384682, -8844.053293842715, -7029.909824638803, -9612.766766596491, -8986.5085011978, -5852.751322133729, -9736.8980724739, -9565.982507143994, -5538.309568027278, -8540.95471862728, -9164.479847750657, -6377.652857645504, -6302.43531052388, -6374.402861675866, -8113.113340170814, -7859.094894424291, -10096.366569667212, -6734.935653930909, -10297.828191429908, -10172.102478745186, -10764.135625492308, -8919.868489601387, -5948.601240411627, -9354.988045702243, -9674.742826757001, -4945.339154899276, -6373.552349153716, -5474.3998736329695, -7623.021211002756, -7763.484089258416, -9836.608638810267, -10178.481822055832, -6360.5864904393, -7881.846964021461, -9264.24516407875, -9412.935784115038, -9394.199360883484, -6692.486839145644, -8511.864626021148, -6055.884223186943, -7698.3545791398055, -12673.45315875002, -9107.75580366678, -10909.409584974479, -10643.491030147847, -12078.794200564613, -8630.996931280357, -10735.77947285674, -6887.782362866807, -104.72069384926206, -8019.080413394504], "episode_lengths": [200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200], "policy_agent_policy_reward": [6022.869663978656, 7943.504425312537, 538.0649506625795, 6550.735455731414, 4196.943287285, 7899.817910252214, 3245.7257295322074, 4738.920467450832, 4947.113573716844, 9166.998996840739, 6017.48653619069, 7353.784271418149, 4358.9346244568715, 8868.71073148895, 2976.1670431307452, 4265.817189984396, 3602.768695708711, 2000.2001130859212, 9060.346942350636, 7816.024789749393, 7311.86373114492, 5539.050443559576, 5322.757674520942, 10442.665471561555, 8904.375911375928, 5331.54297020936, 5127.224360231599, 8462.921731468952, 3331.6923123496695, 6340.103800051003, 7819.16817706309, 4575.52240946963, 3548.64741559881, 3715.4922010965656, 3900.242591637421, 6012.346550759277, 3388.6291669649117, 9127.248071172611, 5188.6328562645185, 3446.9838908798574, 3714.274011843111, 8209.127969711264, 18.46824971675606, 12532.071521301605, 4918.865875615039, 9736.353594087614, 5159.710075980753, 7250.626954299957, 8619.50238911168, 4669.783961462527, 3471.366030003194, 5709.629347454246, 8350.165870118897, 8479.553992157562, 4391.0846601560925, 9031.851658431846, 6079.576896122444, 3668.8139586432553, 7986.978830587587, 7451.638152354959, 4315.560502834406, 3001.2456589605836, 4134.85422986182, 6534.846814566963, 6691.311678701953, 5431.101941071408, 4967.2483101375165, 4739.263764723091, 5263.421927275389, 7177.173746280818, 7587.600911345534, 3446.491977730759, 8005.740315543463, 7170.7867333660415, 2853.0807141017567, 4949.303577918486, 4333.151736033779, 3636.049932684587, 5760.462300619869, 6232.711175176094, 6153.67782680564, 4844.367055190906, 2428.8918186957662, 7410.2277482047475, 7510.519662150692, 8332.849145883694, 3917.2321898865002, 6439.817358021174, 4171.244170499354, 4183.623257939661, 11785.89916862771, 7693.392124292898, 10437.758663902627, 8564.591293420379, 10181.872159262202, 3658.3895542010437, 3185.051901774413, 4532.210761083958, 3.8197478964372533, 3857.7785277007083], "policy_adversary_policy_reward": [-6022.869663978656, -11309.771146935926, -9776.12460224195, -7991.611822297962, -538.0649506625795, -1747.5388183236503, -6550.735455731414, -8979.545830311945, -9471.238285421783, -4196.943287285, -8240.168734463028, -7977.774308664855, -3778.080948776758, -5737.543394940567, -5137.568579586469, -4978.952068513596, -4947.113573716844, -9895.338337971778, -9188.438932254887, -10274.434562007093, -10243.690849542261, -6017.48653619069, -8886.857515206533, -7354.480678776321, -4358.9346244568715, -9705.650847424515, -8891.664317477163, -9245.298582034124, -6869.348820352892, -2976.1670431307452, -6731.27744608444, -4265.817189984396, -8357.39837130188, -3627.022965343442, -3720.9835288475397, -4141.8791196681195, -10496.582916201321, -9201.117806650007, -8318.339962305465, -8151.7049234354445, -7311.86373114492, -10023.659217687458, -9288.62269879023, -5539.050443559576, -7387.550384686291, -5522.40353882641, -13175.668907216885, -10442.665471561555, -11244.576194758345, -8904.375911375928, -9615.100629237282, -5331.54297020936, -6690.57105124108, -5127.224360231599, -8484.04329662365, -8809.524014048653, -3871.251370975971, -5660.027074726535, -8893.837139602267, -6418.165978660573, -7819.16817706309, -11773.438665619757, -6140.652087773615, -5313.999999297387, -3551.477034139508, -6505.214828394823, -7370.883707047999, -3715.4922010965656, -3900.242591637421, -7124.397122355727, -6012.346550759277, -8818.980147242735, -4551.542430218324, -3930.0864604425656, -10054.055561053445, -9249.55735729064, -6474.410398121389, -5741.625065278371, -8830.226609124444, -3446.9838908798574, -6320.4482025471, -3714.274011843111, -9325.012084338969, -8209.127969711264, -165.88011049571202, -18.46824971675606, -12609.38326654223, -12726.225472526183, -6080.482912829105, -4918.865875615039, -10775.131698305093, -9741.429672687796, -10910.600328774393, -5159.710075980753, -7250.626954299957, -12046.69632788635, -9260.381822476797, -8619.50238911168, -4669.783961462527, -9007.016394384682, -3474.2142656872024, -8841.205058158706, -6368.222704766661, -6371.316467326391, -9477.457199122942, -8485.475437592439, -8905.991851025543, -8560.070642329825, -5852.7235302696945, -4391.112452020127, -9195.13615354181, -9573.61357736394, -8119.250999369616, -7526.308403896824, -4523.61055266926, -4683.512974001277, -8105.7903883556255, -8422.143160859241, -7646.941771132659, -8969.176228972954, -4529.979297540158, -6163.234062939752, -4461.544735953922, -4842.136233530539, -4135.233473878603, -6374.023617659084, -6534.846814566963, -8113.113340170814, -7859.094894424291, -6691.311678701953, -5431.101941071408, -10096.366569667212, -6487.188436654384, -5214.995527414041, -4739.263764723091, -10297.828191429908, -10172.102478745186, -5263.421927275389, -7177.173746280818, -10764.135625492308, -7601.278583831389, -8906.190817115536, -4036.5049206409044, -5358.5882975014865, -9354.988045702245, -8005.740315543463, -7170.7867333660415, -9674.742826757001, -3371.0983143128956, -4427.3215546881365, -6277.7072311413995, -5045.148695930802, -5251.39667243187, -4556.154937234887, -7623.021211002757, -3636.049932684587, -7760.751682594862, -5763.194707283423, -9836.608638810263, -6232.711175176094, -6153.67782680564, -10178.481822055834, -5191.34085726917, -6013.612688361037, -7801.341998133317, -2509.39678458391, -7418.328150275641, -9256.144762007856, -9412.935784115038, -7510.519662150692, -9306.661016018837, -8420.38749074834, -4110.186542442068, -6499.5324865900775, -6841.667697232952, -8110.014286809373, -4245.307359298759, -5981.821034387538, -6009.93672651914, -5872.0411105603225, -12672.046087498207, -11787.306239879521, -9107.75580366678, -7693.392124292898, -10514.089380983636, -10833.07886789347, -10643.491030147847, -8564.591293420379, -12078.794200564613, -10181.872159262202, -8613.868465222495, -3675.5180202589067, -3185.051901774413, -10735.77947285674, -6885.48683949784, -4534.506284452925, -104.72069384926206, -3.8197478964372533, -5444.97797984134, -6431.8809612538735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40622755318486237, "mean_inference_ms": 0.9915981183709701, "mean_action_processing_ms": 0.17012316302836833, "mean_env_wait_ms": 0.051744153326165394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003229379653930664, "StateBufferConnector_ms": 0.002410411834716797, "ViewRequirementAgentConnector_ms": 0.06588387489318848}, "num_episodes": 22, "episode_return_max": -104.72069384926206, "episode_return_min": -13175.668907216885, "episode_return_mean": -8377.81720292007}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.8559949567532, "num_env_steps_trained_throughput_per_sec": 548.8559949567532, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 7353.801, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7353.77, "sample_time_ms": 738.01, "learn_time_ms": 6603.197, "learn_throughput": 605.767, "synch_weights_time_ms": 12.054}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 76, "trial_id": "3439d_00000", "date": "2024-08-09_15-35-55", "timestamp": 1723232155, "time_this_iter_s": 7.292270660400391, "time_total_s": 578.955099105835, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f3af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 578.955099105835, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 27.354545454545452, "ram_util_percent": 80.59090909090911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9488696399455269, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000107737382253, "policy_loss": -0.0026627726130148705, "vf_loss": 10.0, "vf_explained_var": -1.7401203513145448e-05, "kl": 0.005472596548255145, "entropy": 1.493658955891927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7510244138499417, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001209731329055, "policy_loss": -0.0014981001611828568, "vf_loss": 10.0, "vf_explained_var": 0.00022838383755355917, "kl": 0.009026121238256416, "entropy": 0.9765500538878971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "env_runners": {"episode_reward_max": -104.72069384926206, "episode_reward_min": -13175.668907216885, "episode_reward_mean": -8563.732301518678, "episode_len_mean": 196.12, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19612, "policy_reward_min": {"agent_policy": 3.8197478964372533, "adversary_policy": -13175.668907216885}, "policy_reward_max": {"agent_policy": 12532.071521301605, "adversary_policy": -3.8197478964372533}, "policy_reward_mean": {"agent_policy": 5992.606971135008, "adversary_policy": -7278.169636326843}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10023.659217687458, -9288.622698790228, -7587.196248991757, -13175.668907216885, -11244.576194758347, -9615.100629237282, -6690.571051241081, -8830.645579203347, -6199.5861333528355, -8971.899318211834, -11773.438665619757, -6879.129677601371, -6508.04444693552, -7370.883707047999, -7124.397122355727, -8818.980147242735, -5092.999723695973, -10176.364847171477, -7027.402607135244, -8830.226609124444, -6320.4482025471, -9325.012084338969, -165.880110495712, -12803.53721776681, -6080.482912829105, -10780.207776905281, -10910.600328774392, -12046.69632788635, -9260.381822476797, -9007.016394384682, -8844.053293842715, -7029.909824638803, -9612.766766596491, -8986.5085011978, -5852.751322133729, -9736.8980724739, -9565.982507143994, -5538.309568027278, -8540.95471862728, -9164.479847750657, -6377.652857645504, -6302.43531052388, -6374.402861675866, -8113.113340170814, -7859.094894424291, -10096.366569667212, -6734.935653930909, -10297.828191429908, -10172.102478745186, -10764.135625492308, -8919.868489601387, -5948.601240411627, -9354.988045702243, -9674.742826757001, -4945.339154899276, -6373.552349153716, -5474.3998736329695, -7623.021211002756, -7763.484089258416, -9836.608638810267, -10178.481822055832, -6360.5864904393, -7881.846964021461, -9264.24516407875, -9412.935784115038, -9394.199360883484, -6692.486839145644, -8511.864626021148, -6055.884223186943, -7698.3545791398055, -12673.45315875002, -9107.75580366678, -10909.409584974479, -10643.491030147847, -12078.794200564613, -8630.996931280357, -10735.77947285674, -6887.782362866807, -104.72069384926206, -8019.080413394504, -11847.308869144552, -9448.514605621416, -10034.145459831048, -10574.306746690489, -11173.057917332095, -9786.315162268918, -10259.617419173268, -10675.19199702472, -9344.696985136517, -8647.297330714326, -6189.382710623663, -6567.258046137691, -8678.864966261532, -7136.545928530299, -11747.654875117569, -10381.173003393505, -9860.23548028364, -7322.636024444127, -6550.5157539007705, -9097.416528404192], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7311.86373114492, 5539.050443559576, 5322.757674520942, 10442.665471561555, 8904.375911375928, 5331.54297020936, 5127.224360231599, 8462.921731468952, 3331.6923123496695, 6340.103800051003, 7819.16817706309, 4575.52240946963, 3548.64741559881, 3715.4922010965656, 3900.242591637421, 6012.346550759277, 3388.6291669649117, 9127.248071172611, 5188.6328562645185, 3446.9838908798574, 3714.274011843111, 8209.127969711264, 18.46824971675606, 12532.071521301605, 4918.865875615039, 9736.353594087614, 5159.710075980753, 7250.626954299957, 8619.50238911168, 4669.783961462527, 3471.366030003194, 5709.629347454246, 8350.165870118897, 8479.553992157562, 4391.0846601560925, 9031.851658431846, 6079.576896122444, 3668.8139586432553, 7986.978830587587, 7451.638152354959, 4315.560502834406, 3001.2456589605836, 4134.85422986182, 6534.846814566963, 6691.311678701953, 5431.101941071408, 4967.2483101375165, 4739.263764723091, 5263.421927275389, 7177.173746280818, 7587.600911345534, 3446.491977730759, 8005.740315543463, 7170.7867333660415, 2853.0807141017567, 4949.303577918486, 4333.151736033779, 3636.049932684587, 5760.462300619869, 6232.711175176094, 6153.67782680564, 4844.367055190906, 2428.8918186957662, 7410.2277482047475, 7510.519662150692, 8332.849145883694, 3917.2321898865002, 6439.817358021174, 4171.244170499354, 4183.623257939661, 11785.89916862771, 7693.392124292898, 10437.758663902627, 8564.591293420379, 10181.872159262202, 3658.3895542010437, 3185.051901774413, 4532.210761083958, 3.8197478964372533, 3857.7785277007083, 8807.563355638866, 8047.691589534502, 8333.044654810672, 9935.285754394132, 5772.2040344614825, 6994.551021067027, 2343.068173585569, 6636.022224426429, 7159.835704600748, 6223.925851808045, 5500.612547519646, 4189.092721859632, 4471.9464804423, 5102.5936346289745, 8157.897860552489, 8253.329175667053, 5030.7965656285705, 4960.683243362312, 4719.9097996186865, 6809.464898978255], "policy_adversary_policy_reward": [-7311.86373114492, -10023.659217687458, -9288.62269879023, -5539.050443559576, -7387.550384686291, -5522.40353882641, -13175.668907216885, -10442.665471561555, -11244.576194758345, -8904.375911375928, -9615.100629237282, -5331.54297020936, -6690.57105124108, -5127.224360231599, -8484.04329662365, -8809.524014048653, -3871.251370975971, -5660.027074726535, -8893.837139602267, -6418.165978660573, -7819.16817706309, -11773.438665619757, -6140.652087773615, -5313.999999297387, -3551.477034139508, -6505.214828394823, -7370.883707047999, -3715.4922010965656, -3900.242591637421, -7124.397122355727, -6012.346550759277, -8818.980147242735, -4551.542430218324, -3930.0864604425656, -10054.055561053445, -9249.55735729064, -6474.410398121389, -5741.625065278371, -8830.226609124444, -3446.9838908798574, -6320.4482025471, -3714.274011843111, -9325.012084338969, -8209.127969711264, -165.88011049571202, -18.46824971675606, -12609.38326654223, -12726.225472526183, -6080.482912829105, -4918.865875615039, -10775.131698305093, -9741.429672687796, -10910.600328774393, -5159.710075980753, -7250.626954299957, -12046.69632788635, -9260.381822476797, -8619.50238911168, -4669.783961462527, -9007.016394384682, -3474.2142656872024, -8841.205058158706, -6368.222704766661, -6371.316467326391, -9477.457199122942, -8485.475437592439, -8905.991851025543, -8560.070642329825, -5852.7235302696945, -4391.112452020127, -9195.13615354181, -9573.61357736394, -8119.250999369616, -7526.308403896824, -4523.61055266926, -4683.512974001277, -8105.7903883556255, -8422.143160859241, -7646.941771132659, -8969.176228972954, -4529.979297540158, -6163.234062939752, -4461.544735953922, -4842.136233530539, -4135.233473878603, -6374.023617659084, -6534.846814566963, -8113.113340170814, -7859.094894424291, -6691.311678701953, -5431.101941071408, -10096.366569667212, -6487.188436654384, -5214.995527414041, -4739.263764723091, -10297.828191429908, -10172.102478745186, -5263.421927275389, -7177.173746280818, -10764.135625492308, -7601.278583831389, -8906.190817115536, -4036.5049206409044, -5358.5882975014865, -9354.988045702245, -8005.740315543463, -7170.7867333660415, -9674.742826757001, -3371.0983143128956, -4427.3215546881365, -6277.7072311413995, -5045.148695930802, -5251.39667243187, -4556.154937234887, -7623.021211002757, -3636.049932684587, -7760.751682594862, -5763.194707283423, -9836.608638810263, -6232.711175176094, -6153.67782680564, -10178.481822055834, -5191.34085726917, -6013.612688361037, -7801.341998133317, -2509.39678458391, -7418.328150275641, -9256.144762007856, -9412.935784115038, -7510.519662150692, -9306.661016018837, -8420.38749074834, -4110.186542442068, -6499.5324865900775, -6841.667697232952, -8110.014286809373, -4245.307359298759, -5981.821034387538, -6009.93672651914, -5872.0411105603225, -12672.046087498207, -11787.306239879521, -9107.75580366678, -7693.392124292898, -10514.089380983636, -10833.07886789347, -10643.491030147847, -8564.591293420379, -12078.794200564613, -10181.872159262202, -8613.868465222495, -3675.5180202589067, -3185.051901774413, -10735.77947285674, -6885.48683949784, -4534.506284452925, -104.72069384926206, -3.8197478964372533, -5444.97797984134, -6431.8809612538735, -8807.563355638866, -11847.308869144552, -8060.30130296844, -9435.904892187475, -8593.412716746629, -9773.777397895095, -9996.941634459887, -10512.650866624735, -5772.2040344614825, -11173.057917332095, -6994.551021067027, -9786.315162268924, -10259.617419173268, -2343.068173585569, -10675.191997024718, -6636.022224426429, -9081.10238140126, -7423.430308336026, -6323.39649773403, -8547.826684788337, -5991.883896906696, -5698.111361236613, -6303.743911493155, -4452.606856504167, -8678.864966261533, -4471.9464804423, -5425.305621693889, -6813.833941465384, -8157.897860552489, -11747.654875117569, -8253.329175667053, -10381.173003393505, -5057.137018934423, -9833.895026977789, -5015.486583317434, -7267.832684489005, -4725.390004208436, -6545.03554931102, -9097.416528404194, -6809.464898978255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40586622058747596, "mean_inference_ms": 0.9896200595599223, "mean_action_processing_ms": 0.16995300804296062, "mean_env_wait_ms": 0.051720377126263054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034674406051635742, "StateBufferConnector_ms": 0.0024144649505615234, "ViewRequirementAgentConnector_ms": 0.06602787971496582}, "num_episodes": 20, "episode_return_max": -104.72069384926206, "episode_return_min": -13175.668907216885, "episode_return_mean": -8563.732301518678}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.9028030435371, "num_env_steps_trained_throughput_per_sec": 550.9028030435371, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 7338.724, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7338.693, "sample_time_ms": 731.179, "learn_time_ms": 6594.929, "learn_throughput": 606.527, "synch_weights_time_ms": 12.049}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "training_iteration": 77, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-03", "timestamp": 1723232163, "time_this_iter_s": 7.26542592048645, "time_total_s": 586.2205250263214, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f3ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 586.2205250263214, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 22.939999999999998, "ram_util_percent": 80.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9635633453416328, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000435663263003, "policy_loss": 0.0005469858937431127, "vf_loss": 9.994659557938576, "vf_explained_var": -0.00034846415122350056, "kl": 0.01032912926384597, "entropy": 1.488557567074895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8061290087996337, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997069734240336, "policy_loss": -0.002453799756174838, "vf_loss": 9.997022341672706, "vf_explained_var": 0.00019750566709609259, "kl": 0.008337369064243618, "entropy": 1.0021366997686012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": -104.72069384926206, "episode_reward_min": -12803.53721776681, "episode_reward_mean": -8550.868824125728, "episode_len_mean": 194.71, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19471, "policy_reward_min": {"agent_policy": 3.8197478964372533, "adversary_policy": -12726.225472526183}, "policy_reward_max": {"agent_policy": 12532.071521301605, "adversary_policy": -3.8197478964372533}, "policy_reward_mean": {"agent_policy": 6010.020170090454, "adversary_policy": -7280.444497108092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6320.4482025471, -9325.012084338969, -165.880110495712, -12803.53721776681, -6080.482912829105, -10780.207776905281, -10910.600328774392, -12046.69632788635, -9260.381822476797, -9007.016394384682, -8844.053293842715, -7029.909824638803, -9612.766766596491, -8986.5085011978, -5852.751322133729, -9736.8980724739, -9565.982507143994, -5538.309568027278, -8540.95471862728, -9164.479847750657, -6377.652857645504, -6302.43531052388, -6374.402861675866, -8113.113340170814, -7859.094894424291, -10096.366569667212, -6734.935653930909, -10297.828191429908, -10172.102478745186, -10764.135625492308, -8919.868489601387, -5948.601240411627, -9354.988045702243, -9674.742826757001, -4945.339154899276, -6373.552349153716, -5474.3998736329695, -7623.021211002756, -7763.484089258416, -9836.608638810267, -10178.481822055832, -6360.5864904393, -7881.846964021461, -9264.24516407875, -9412.935784115038, -9394.199360883484, -6692.486839145644, -8511.864626021148, -6055.884223186943, -7698.3545791398055, -12673.45315875002, -9107.75580366678, -10909.409584974479, -10643.491030147847, -12078.794200564613, -8630.996931280357, -10735.77947285674, -6887.782362866807, -104.72069384926206, -8019.080413394504, -11847.308869144552, -9448.514605621416, -10034.145459831048, -10574.306746690489, -11173.057917332095, -9786.315162268918, -10259.617419173268, -10675.19199702472, -9344.696985136517, -8647.297330714326, -6189.382710623663, -6567.258046137691, -8678.864966261532, -7136.545928530299, -11747.654875117569, -10381.173003393505, -9860.23548028364, -7322.636024444127, -6550.5157539007705, -9097.416528404192, -9393.653471099926, -11437.839509438965, -11593.835453179965, -12319.11744386833, -10526.914278420389, -9477.490934752552, -9672.37285347241, -9345.203615254868, -3477.141989389235, -6928.547963141075, -6725.904984365335, -9527.946674707397, -5397.824157847768, -1562.4717055137507, -8025.094748423633, -6569.696868612992, -7711.803883456817, -9317.168857147748, -10448.062728494151, -10484.953672738782], "episode_lengths": [200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3714.274011843111, 8209.127969711264, 18.46824971675606, 12532.071521301605, 4918.865875615039, 9736.353594087614, 5159.710075980753, 7250.626954299957, 8619.50238911168, 4669.783961462527, 3471.366030003194, 5709.629347454246, 8350.165870118897, 8479.553992157562, 4391.0846601560925, 9031.851658431846, 6079.576896122444, 3668.8139586432553, 7986.978830587587, 7451.638152354959, 4315.560502834406, 3001.2456589605836, 4134.85422986182, 6534.846814566963, 6691.311678701953, 5431.101941071408, 4967.2483101375165, 4739.263764723091, 5263.421927275389, 7177.173746280818, 7587.600911345534, 3446.491977730759, 8005.740315543463, 7170.7867333660415, 2853.0807141017567, 4949.303577918486, 4333.151736033779, 3636.049932684587, 5760.462300619869, 6232.711175176094, 6153.67782680564, 4844.367055190906, 2428.8918186957662, 7410.2277482047475, 7510.519662150692, 8332.849145883694, 3917.2321898865002, 6439.817358021174, 4171.244170499354, 4183.623257939661, 11785.89916862771, 7693.392124292898, 10437.758663902627, 8564.591293420379, 10181.872159262202, 3658.3895542010437, 3185.051901774413, 4532.210761083958, 3.8197478964372533, 3857.7785277007083, 8807.563355638866, 8047.691589534502, 8333.044654810672, 9935.285754394132, 5772.2040344614825, 6994.551021067027, 2343.068173585569, 6636.022224426429, 7159.835704600748, 6223.925851808045, 5500.612547519646, 4189.092721859632, 4471.9464804423, 5102.5936346289745, 8157.897860552489, 8253.329175667053, 5030.7965656285705, 4960.683243362312, 4719.9097996186865, 6809.464898978255, 4305.893077748674, 6845.167127172819, 4471.437630308877, 7454.630806757258, 8524.794419712167, 6688.746766411317, 8129.652095385407, 6829.053987633068, 2311.8057991950354, 6533.040260135698, 5822.094545645202, 3636.043621550896, 4255.560655049484, 671.4427341298469, 6059.7772340787515, 4938.373544393927, 7357.629146256551, 8740.241919999633, 7836.513439930539, 7166.532821429662], "policy_adversary_policy_reward": [-6320.4482025471, -3714.274011843111, -9325.012084338969, -8209.127969711264, -165.88011049571202, -18.46824971675606, -12609.38326654223, -12726.225472526183, -6080.482912829105, -4918.865875615039, -10775.131698305093, -9741.429672687796, -10910.600328774393, -5159.710075980753, -7250.626954299957, -12046.69632788635, -9260.381822476797, -8619.50238911168, -4669.783961462527, -9007.016394384682, -3474.2142656872024, -8841.205058158706, -6368.222704766661, -6371.316467326391, -9477.457199122942, -8485.475437592439, -8905.991851025543, -8560.070642329825, -5852.7235302696945, -4391.112452020127, -9195.13615354181, -9573.61357736394, -8119.250999369616, -7526.308403896824, -4523.61055266926, -4683.512974001277, -8105.7903883556255, -8422.143160859241, -7646.941771132659, -8969.176228972954, -4529.979297540158, -6163.234062939752, -4461.544735953922, -4842.136233530539, -4135.233473878603, -6374.023617659084, -6534.846814566963, -8113.113340170814, -7859.094894424291, -6691.311678701953, -5431.101941071408, -10096.366569667212, -6487.188436654384, -5214.995527414041, -4739.263764723091, -10297.828191429908, -10172.102478745186, -5263.421927275389, -7177.173746280818, -10764.135625492308, -7601.278583831389, -8906.190817115536, -4036.5049206409044, -5358.5882975014865, -9354.988045702245, -8005.740315543463, -7170.7867333660415, -9674.742826757001, -3371.0983143128956, -4427.3215546881365, -6277.7072311413995, -5045.148695930802, -5251.39667243187, -4556.154937234887, -7623.021211002757, -3636.049932684587, -7760.751682594862, -5763.194707283423, -9836.608638810263, -6232.711175176094, -6153.67782680564, -10178.481822055834, -5191.34085726917, -6013.612688361037, -7801.341998133317, -2509.39678458391, -7418.328150275641, -9256.144762007856, -9412.935784115038, -7510.519662150692, -9306.661016018837, -8420.38749074834, -4110.186542442068, -6499.5324865900775, -6841.667697232952, -8110.014286809373, -4245.307359298759, -5981.821034387538, -6009.93672651914, -5872.0411105603225, -12672.046087498207, -11787.306239879521, -9107.75580366678, -7693.392124292898, -10514.089380983636, -10833.07886789347, -10643.491030147847, -8564.591293420379, -12078.794200564613, -10181.872159262202, -8613.868465222495, -3675.5180202589067, -3185.051901774413, -10735.77947285674, -6885.48683949784, -4534.506284452925, -104.72069384926206, -3.8197478964372533, -5444.97797984134, -6431.8809612538735, -8807.563355638866, -11847.308869144552, -8060.30130296844, -9435.904892187475, -8593.412716746629, -9773.777397895095, -9996.941634459887, -10512.650866624735, -5772.2040344614825, -11173.057917332095, -6994.551021067027, -9786.315162268924, -10259.617419173268, -2343.068173585569, -10675.191997024718, -6636.022224426429, -9081.10238140126, -7423.430308336026, -6323.39649773403, -8547.826684788337, -5991.883896906696, -5698.111361236613, -6303.743911493155, -4452.606856504167, -8678.864966261533, -4471.9464804423, -5425.305621693889, -6813.833941465384, -8157.897860552489, -11747.654875117569, -8253.329175667053, -10381.173003393505, -5057.137018934423, -9833.895026977789, -5015.486583317434, -7267.832684489005, -4725.390004208436, -6545.03554931102, -9097.416528404194, -6809.464898978255, -9393.653471099924, -4305.893077748674, -6845.167127172819, -11437.839509438965, -11593.835453179965, -4471.437630308877, -7454.630806757258, -12319.11744386833, -8566.074888360226, -10485.633809772326, -6991.918256457187, -9174.319444706683, -9481.970935974965, -8320.05401288286, -8452.655723532005, -7721.601879355934, -2908.9983346961503, -2879.94945388812, -6717.409222251434, -6744.179001025338, -6682.677903660178, -5865.321626350357, -8692.464709424381, -4471.52558683391, -4294.198930500257, -5359.185882396994, -671.4427341298469, -1562.4717055137507, -8025.094748423634, -6059.7772340787515, -6482.859235642544, -5025.211177364377, -7479.819645411266, -7589.6133843021025, -8909.984627860336, -9147.426149287045, -7836.513439930539, -10448.062728494151, -7166.532821429662, -10484.953672738782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4055409344857486, "mean_inference_ms": 0.9886428371813659, "mean_action_processing_ms": 0.1697842117386431, "mean_env_wait_ms": 0.051676813480288714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035452842712402344, "StateBufferConnector_ms": 0.0024362802505493164, "ViewRequirementAgentConnector_ms": 0.06621289253234863}, "num_episodes": 20, "episode_return_max": -104.72069384926206, "episode_return_min": -12803.53721776681, "episode_return_mean": -8550.868824125728}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.9109967358786, "num_env_steps_trained_throughput_per_sec": 513.9109967358786, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 7383.934, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7383.903, "sample_time_ms": 732.553, "learn_time_ms": 6638.855, "learn_throughput": 602.513, "synch_weights_time_ms": 11.999}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 78, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-11", "timestamp": 1723232171, "time_this_iter_s": 7.790527105331421, "time_total_s": 594.0110521316528, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.0110521316528, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 27.390909090909098, "ram_util_percent": 80.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9747946909007926, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990200997392337, "policy_loss": -0.002188067738461541, "vf_loss": 9.987511587142944, "vf_explained_var": -0.00027480870485305784, "kl": 0.009634544122673106, "entropy": 1.4906381915012996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8255214068151656, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990273826336734, "policy_loss": -0.005542479416789123, "vf_loss": 9.993189227896393, "vf_explained_var": 0.0003708576399182516, "kl": 0.008756924549083191, "entropy": 1.0674552248899267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "env_runners": {"episode_reward_max": -104.72069384926206, "episode_reward_min": -13036.86265650863, "episode_reward_mean": -8362.486169952572, "episode_len_mean": 193.22, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19322, "policy_reward_min": {"agent_policy": 3.8197478964372533, "adversary_policy": -13036.86265650863}, "policy_reward_max": {"agent_policy": 11785.89916862771, "adversary_policy": -3.8197478964372533}, "policy_reward_mean": {"agent_policy": 5785.707348860127, "adversary_policy": -7074.096759406351}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.652857645504, -6302.43531052388, -6374.402861675866, -8113.113340170814, -7859.094894424291, -10096.366569667212, -6734.935653930909, -10297.828191429908, -10172.102478745186, -10764.135625492308, -8919.868489601387, -5948.601240411627, -9354.988045702243, -9674.742826757001, -4945.339154899276, -6373.552349153716, -5474.3998736329695, -7623.021211002756, -7763.484089258416, -9836.608638810267, -10178.481822055832, -6360.5864904393, -7881.846964021461, -9264.24516407875, -9412.935784115038, -9394.199360883484, -6692.486839145644, -8511.864626021148, -6055.884223186943, -7698.3545791398055, -12673.45315875002, -9107.75580366678, -10909.409584974479, -10643.491030147847, -12078.794200564613, -8630.996931280357, -10735.77947285674, -6887.782362866807, -104.72069384926206, -8019.080413394504, -11847.308869144552, -9448.514605621416, -10034.145459831048, -10574.306746690489, -11173.057917332095, -9786.315162268918, -10259.617419173268, -10675.19199702472, -9344.696985136517, -8647.297330714326, -6189.382710623663, -6567.258046137691, -8678.864966261532, -7136.545928530299, -11747.654875117569, -10381.173003393505, -9860.23548028364, -7322.636024444127, -6550.5157539007705, -9097.416528404192, -9393.653471099926, -11437.839509438965, -11593.835453179965, -12319.11744386833, -10526.914278420389, -9477.490934752552, -9672.37285347241, -9345.203615254868, -3477.141989389235, -6928.547963141075, -6725.904984365335, -9527.946674707397, -5397.824157847768, -1562.4717055137507, -8025.094748423633, -6569.696868612992, -7711.803883456817, -9317.168857147748, -10448.062728494151, -10484.953672738782, -10627.094284349796, -8485.724078689409, -1034.0689075755308, -11267.666512851705, -8406.39353121136, -9733.314935127079, -7779.545772277317, -893.9989624862277, -9411.117489821869, -4671.456925863819, -4122.580194743136, -5631.535255775589, -13036.86265650863, -5553.602707903973, -9706.861686575538, -5617.028700478176, -7461.839195665396, -8078.481877383235, -12035.834721071675, -7179.603787163054], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 39, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4315.560502834406, 3001.2456589605836, 4134.85422986182, 6534.846814566963, 6691.311678701953, 5431.101941071408, 4967.2483101375165, 4739.263764723091, 5263.421927275389, 7177.173746280818, 7587.600911345534, 3446.491977730759, 8005.740315543463, 7170.7867333660415, 2853.0807141017567, 4949.303577918486, 4333.151736033779, 3636.049932684587, 5760.462300619869, 6232.711175176094, 6153.67782680564, 4844.367055190906, 2428.8918186957662, 7410.2277482047475, 7510.519662150692, 8332.849145883694, 3917.2321898865002, 6439.817358021174, 4171.244170499354, 4183.623257939661, 11785.89916862771, 7693.392124292898, 10437.758663902627, 8564.591293420379, 10181.872159262202, 3658.3895542010437, 3185.051901774413, 4532.210761083958, 3.8197478964372533, 3857.7785277007083, 8807.563355638866, 8047.691589534502, 8333.044654810672, 9935.285754394132, 5772.2040344614825, 6994.551021067027, 2343.068173585569, 6636.022224426429, 7159.835704600748, 6223.925851808045, 5500.612547519646, 4189.092721859632, 4471.9464804423, 5102.5936346289745, 8157.897860552489, 8253.329175667053, 5030.7965656285705, 4960.683243362312, 4719.9097996186865, 6809.464898978255, 4305.893077748674, 6845.167127172819, 4471.437630308877, 7454.630806757258, 8524.794419712167, 6688.746766411317, 8129.652095385407, 6829.053987633068, 2311.8057991950354, 6533.040260135698, 5822.094545645202, 3636.043621550896, 4255.560655049484, 671.4427341298469, 6059.7772340787515, 4938.373544393927, 7357.629146256551, 8740.241919999633, 7836.513439930539, 7166.532821429662, 5062.661043039945, 6651.127670149728, 358.4491125519375, 10419.268403409276, 6209.039535145128, 7838.14745848168, 7014.612705708194, 66.27809588805596, 5009.936009095225, 1840.7540260248038, 2734.2911000934246, 3909.835608522191, 9868.831964123263, 3905.3282802231183, 3578.5614520810022, 4921.565277802436, 6529.193664555091, 4507.993361415604, 11551.518745541647, 5040.768362276068], "policy_adversary_policy_reward": [-4529.979297540158, -6163.234062939752, -4461.544735953922, -4842.136233530539, -4135.233473878603, -6374.023617659084, -6534.846814566963, -8113.113340170814, -7859.094894424291, -6691.311678701953, -5431.101941071408, -10096.366569667212, -6487.188436654384, -5214.995527414041, -4739.263764723091, -10297.828191429908, -10172.102478745186, -5263.421927275389, -7177.173746280818, -10764.135625492308, -7601.278583831389, -8906.190817115536, -4036.5049206409044, -5358.5882975014865, -9354.988045702245, -8005.740315543463, -7170.7867333660415, -9674.742826757001, -3371.0983143128956, -4427.3215546881365, -6277.7072311413995, -5045.148695930802, -5251.39667243187, -4556.154937234887, -7623.021211002757, -3636.049932684587, -7760.751682594862, -5763.194707283423, -9836.608638810263, -6232.711175176094, -6153.67782680564, -10178.481822055834, -5191.34085726917, -6013.612688361037, -7801.341998133317, -2509.39678458391, -7418.328150275641, -9256.144762007856, -9412.935784115038, -7510.519662150692, -9306.661016018837, -8420.38749074834, -4110.186542442068, -6499.5324865900775, -6841.667697232952, -8110.014286809373, -4245.307359298759, -5981.821034387538, -6009.93672651914, -5872.0411105603225, -12672.046087498207, -11787.306239879521, -9107.75580366678, -7693.392124292898, -10514.089380983636, -10833.07886789347, -10643.491030147847, -8564.591293420379, -12078.794200564613, -10181.872159262202, -8613.868465222495, -3675.5180202589067, -3185.051901774413, -10735.77947285674, -6885.48683949784, -4534.506284452925, -104.72069384926206, -3.8197478964372533, -5444.97797984134, -6431.8809612538735, -8807.563355638866, -11847.308869144552, -8060.30130296844, -9435.904892187475, -8593.412716746629, -9773.777397895095, -9996.941634459887, -10512.650866624735, -5772.2040344614825, -11173.057917332095, -6994.551021067027, -9786.315162268924, -10259.617419173268, -2343.068173585569, -10675.191997024718, -6636.022224426429, -9081.10238140126, -7423.430308336026, -6323.39649773403, -8547.826684788337, -5991.883896906696, -5698.111361236613, -6303.743911493155, -4452.606856504167, -8678.864966261533, -4471.9464804423, -5425.305621693889, -6813.833941465384, -8157.897860552489, -11747.654875117569, -8253.329175667053, -10381.173003393505, -5057.137018934423, -9833.895026977789, -5015.486583317434, -7267.832684489005, -4725.390004208436, -6545.03554931102, -9097.416528404194, -6809.464898978255, -9393.653471099924, -4305.893077748674, -6845.167127172819, -11437.839509438965, -11593.835453179965, -4471.437630308877, -7454.630806757258, -12319.11744386833, -8566.074888360226, -10485.633809772326, -6991.918256457187, -9174.319444706683, -9481.970935974965, -8320.05401288286, -8452.655723532005, -7721.601879355934, -2908.9983346961503, -2879.94945388812, -6717.409222251434, -6744.179001025338, -6682.677903660178, -5865.321626350357, -8692.464709424381, -4471.52558683391, -4294.198930500257, -5359.185882396994, -671.4427341298469, -1562.4717055137507, -8025.094748423634, -6059.7772340787515, -6482.859235642544, -5025.211177364377, -7479.819645411266, -7589.6133843021025, -8909.984627860336, -9147.426149287045, -7836.513439930539, -10448.062728494151, -7166.532821429662, -10484.953672738782, -5062.661043039945, -10627.094284349796, -6651.127670149728, -8485.724078689409, -358.4491125519375, -1034.0689075755308, -10420.95896460095, -11265.97595166003, -6534.946313287795, -8080.486753068695, -9174.79940786186, -8396.662985746902, -7014.847121268251, -7779.31135671726, -66.27809588805596, -893.9989624862277, -5009.936009095225, -9411.117489821869, -2772.245071577989, -3739.965880310638, -3580.5696888561574, -3276.3016059804027, -4374.759526820628, -5166.611337477153, -9868.831964123263, -13036.86265650863, -5416.8699096870705, -4042.0610784400233, -9706.861686575536, -3578.5614520810022, -5276.070330871771, -5262.523647408842, -7426.865729386597, -6564.167130833889, -8078.481877383234, -4507.993361415604, -11977.309751269628, -11610.043715343692, -5040.768362276068, -7179.603787163056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052664078394787, "mean_inference_ms": 0.9879527407130201, "mean_action_processing_ms": 0.16965221782917028, "mean_env_wait_ms": 0.05163282924086836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003527402877807617, "StateBufferConnector_ms": 0.002449631690979004, "ViewRequirementAgentConnector_ms": 0.06715035438537598}, "num_episodes": 20, "episode_return_max": -104.72069384926206, "episode_return_min": -13036.86265650863, "episode_return_mean": -8362.486169952572}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.5675122008536, "num_env_steps_trained_throughput_per_sec": 551.5675122008536, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 7372.707, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7372.674, "sample_time_ms": 732.006, "learn_time_ms": 6628.425, "learn_throughput": 603.462, "synch_weights_time_ms": 11.745}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "training_iteration": 79, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-18", "timestamp": 1723232178, "time_this_iter_s": 7.25627589225769, "time_total_s": 601.2673280239105, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 601.2673280239105, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.18181818181818, "ram_util_percent": 80.95454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.961819491473337, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998972544074059, "policy_loss": 0.0005229595679945002, "vf_loss": 9.990238011876743, "vf_explained_var": -0.0003601140653093656, "kl": 0.016220436199607016, "entropy": 1.482457864160339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8270953061167525, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995562626571251, "policy_loss": -0.001419598086633616, "vf_loss": 9.994691723616665, "vf_explained_var": 0.00036999122806327054, "kl": 0.0076349934400428855, "entropy": 1.0743946339718249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": -104.72069384926206, "episode_reward_min": -13036.86265650863, "episode_reward_mean": -8358.877840250989, "episode_len_mean": 190.15, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19015, "policy_reward_min": {"agent_policy": 3.8197478964372533, "adversary_policy": -13036.86265650863}, "policy_reward_max": {"agent_policy": 11785.89916862771, "adversary_policy": -3.8197478964372533}, "policy_reward_mean": {"agent_policy": 5978.291157965437, "adversary_policy": -7168.584499108215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9264.24516407875, -9412.935784115038, -9394.199360883484, -6692.486839145644, -8511.864626021148, -6055.884223186943, -7698.3545791398055, -12673.45315875002, -9107.75580366678, -10909.409584974479, -10643.491030147847, -12078.794200564613, -8630.996931280357, -10735.77947285674, -6887.782362866807, -104.72069384926206, -8019.080413394504, -11847.308869144552, -9448.514605621416, -10034.145459831048, -10574.306746690489, -11173.057917332095, -9786.315162268918, -10259.617419173268, -10675.19199702472, -9344.696985136517, -8647.297330714326, -6189.382710623663, -6567.258046137691, -8678.864966261532, -7136.545928530299, -11747.654875117569, -10381.173003393505, -9860.23548028364, -7322.636024444127, -6550.5157539007705, -9097.416528404192, -9393.653471099926, -11437.839509438965, -11593.835453179965, -12319.11744386833, -10526.914278420389, -9477.490934752552, -9672.37285347241, -9345.203615254868, -3477.141989389235, -6928.547963141075, -6725.904984365335, -9527.946674707397, -5397.824157847768, -1562.4717055137507, -8025.094748423633, -6569.696868612992, -7711.803883456817, -9317.168857147748, -10448.062728494151, -10484.953672738782, -10627.094284349796, -8485.724078689409, -1034.0689075755308, -11267.666512851705, -8406.39353121136, -9733.314935127079, -7779.545772277317, -893.9989624862277, -9411.117489821869, -4671.456925863819, -4122.580194743136, -5631.535255775589, -13036.86265650863, -5553.602707903973, -9706.861686575538, -5617.028700478176, -7461.839195665396, -8078.481877383235, -12035.834721071675, -7179.603787163054, -9958.880666586474, -9602.491337967995, -12093.233606204589, -9688.80732512636, -10227.487259256959, -7197.834428394587, -8349.109102040173, -9477.28427269486, -5837.804441058087, -5511.772908456919, -9025.939190534848, -9683.891400103694, -6006.636343727185, -8976.723390551619, -10252.4663268197, -6977.566404501273, -6956.352996753445, -653.8564050445782, -7266.48213893281, -2332.6991362005574, -11042.792441650712, -6851.658554875878, -9094.985931810463], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 39, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 70, 200, 200, 200], "policy_agent_policy_reward": [7410.2277482047475, 7510.519662150692, 8332.849145883694, 3917.2321898865002, 6439.817358021174, 4171.244170499354, 4183.623257939661, 11785.89916862771, 7693.392124292898, 10437.758663902627, 8564.591293420379, 10181.872159262202, 3658.3895542010437, 3185.051901774413, 4532.210761083958, 3.8197478964372533, 3857.7785277007083, 8807.563355638866, 8047.691589534502, 8333.044654810672, 9935.285754394132, 5772.2040344614825, 6994.551021067027, 2343.068173585569, 6636.022224426429, 7159.835704600748, 6223.925851808045, 5500.612547519646, 4189.092721859632, 4471.9464804423, 5102.5936346289745, 8157.897860552489, 8253.329175667053, 5030.7965656285705, 4960.683243362312, 4719.9097996186865, 6809.464898978255, 4305.893077748674, 6845.167127172819, 4471.437630308877, 7454.630806757258, 8524.794419712167, 6688.746766411317, 8129.652095385407, 6829.053987633068, 2311.8057991950354, 6533.040260135698, 5822.094545645202, 3636.043621550896, 4255.560655049484, 671.4427341298469, 6059.7772340787515, 4938.373544393927, 7357.629146256551, 8740.241919999633, 7836.513439930539, 7166.532821429662, 5062.661043039945, 6651.127670149728, 358.4491125519375, 10419.268403409276, 6209.039535145128, 7838.14745848168, 7014.612705708194, 66.27809588805596, 5009.936009095225, 1840.7540260248038, 2734.2911000934246, 3909.835608522191, 9868.831964123263, 3905.3282802231183, 3578.5614520810022, 4921.565277802436, 6529.193664555091, 4507.993361415604, 11551.518745541647, 5040.768362276068, 7793.889118101337, 5633.59297562126, 11335.533593569802, 9289.648161789748, 7091.704717149452, 4116.617904733763, 7796.949842853803, 6048.637913490678, 1778.5276825888645, 4597.223337353471, 6531.200498278505, 7933.7041144184195, 4955.715946219467, 5470.378702333325, 9177.082900307138, 5739.932659135724, 5249.892148624663, 173.44898314977092, 6804.369679798734, 678.8573240614917, 8127.308067318861, 5320.910712395133, 7271.598576864269], "policy_adversary_policy_reward": [-7418.328150275641, -9256.144762007856, -9412.935784115038, -7510.519662150692, -9306.661016018837, -8420.38749074834, -4110.186542442068, -6499.5324865900775, -6841.667697232952, -8110.014286809373, -4245.307359298759, -5981.821034387538, -6009.93672651914, -5872.0411105603225, -12672.046087498207, -11787.306239879521, -9107.75580366678, -7693.392124292898, -10514.089380983636, -10833.07886789347, -10643.491030147847, -8564.591293420379, -12078.794200564613, -10181.872159262202, -8613.868465222495, -3675.5180202589067, -3185.051901774413, -10735.77947285674, -6885.48683949784, -4534.506284452925, -104.72069384926206, -3.8197478964372533, -5444.97797984134, -6431.8809612538735, -8807.563355638866, -11847.308869144552, -8060.30130296844, -9435.904892187475, -8593.412716746629, -9773.777397895095, -9996.941634459887, -10512.650866624735, -5772.2040344614825, -11173.057917332095, -6994.551021067027, -9786.315162268924, -10259.617419173268, -2343.068173585569, -10675.191997024718, -6636.022224426429, -9081.10238140126, -7423.430308336026, -6323.39649773403, -8547.826684788337, -5991.883896906696, -5698.111361236613, -6303.743911493155, -4452.606856504167, -8678.864966261533, -4471.9464804423, -5425.305621693889, -6813.833941465384, -8157.897860552489, -11747.654875117569, -8253.329175667053, -10381.173003393505, -5057.137018934423, -9833.895026977789, -5015.486583317434, -7267.832684489005, -4725.390004208436, -6545.03554931102, -9097.416528404194, -6809.464898978255, -9393.653471099924, -4305.893077748674, -6845.167127172819, -11437.839509438965, -11593.835453179965, -4471.437630308877, -7454.630806757258, -12319.11744386833, -8566.074888360226, -10485.633809772326, -6991.918256457187, -9174.319444706683, -9481.970935974965, -8320.05401288286, -8452.655723532005, -7721.601879355934, -2908.9983346961503, -2879.94945388812, -6717.409222251434, -6744.179001025338, -6682.677903660178, -5865.321626350357, -8692.464709424381, -4471.52558683391, -4294.198930500257, -5359.185882396994, -671.4427341298469, -1562.4717055137507, -8025.094748423634, -6059.7772340787515, -6482.859235642544, -5025.211177364377, -7479.819645411266, -7589.6133843021025, -8909.984627860336, -9147.426149287045, -7836.513439930539, -10448.062728494151, -7166.532821429662, -10484.953672738782, -5062.661043039945, -10627.094284349796, -6651.127670149728, -8485.724078689409, -358.4491125519375, -1034.0689075755308, -10420.95896460095, -11265.97595166003, -6534.946313287795, -8080.486753068695, -9174.79940786186, -8396.662985746902, -7014.847121268251, -7779.31135671726, -66.27809588805596, -893.9989624862277, -5009.936009095225, -9411.117489821869, -2772.245071577989, -3739.965880310638, -3580.5696888561574, -3276.3016059804027, -4374.759526820628, -5166.611337477153, -9868.831964123263, -13036.86265650863, -5416.8699096870705, -4042.0610784400233, -9706.861686575536, -3578.5614520810022, -5276.070330871771, -5262.523647408842, -7426.865729386597, -6564.167130833889, -8078.481877383234, -4507.993361415604, -11977.309751269628, -11610.043715343692, -5040.768362276068, -7179.603787163056, -9958.880666586474, -7793.889118101337, -5633.59297562126, -9602.491337967998, -12093.140865326834, -11335.626334447556, -9615.071500131004, -9363.383986785104, -7091.704717149452, -10227.487259256959, -4116.617904733763, -7197.834428394587, -8297.34140068854, -7848.717544205438, -9331.570556496901, -6194.3516296886355, -5828.728102311226, -1787.604021335727, -5371.384989951713, -4737.6112558586765, -9025.939190534848, -6531.200498278505, -7933.7041144184195, -9683.891400103694, -6006.636343727185, -4955.715946219467, -8976.72339055162, -5470.378702333325, -9177.082900307138, -10252.4663268197, -5950.130188305211, -6767.368875331786, -5264.80238341727, -6941.442761960838, -653.8564050445782, -173.44898314977092, -7092.953329156691, -6977.898489574851, -678.8573240614917, -2332.6991362005574, -8127.308067318861, -11042.792441650712, -6711.914437849655, -5460.654829421364, -7271.598576864269, -9094.985931810463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40499886096082277, "mean_inference_ms": 0.9873343218745725, "mean_action_processing_ms": 0.1696008417161067, "mean_env_wait_ms": 0.05158653417122741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003771543502807617, "StateBufferConnector_ms": 0.0031145811080932617, "ViewRequirementAgentConnector_ms": 0.0751798152923584}, "num_episodes": 23, "episode_return_max": -104.72069384926206, "episode_return_min": -13036.86265650863, "episode_return_mean": -8358.877840250989}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.3582720318166, "num_env_steps_trained_throughput_per_sec": 548.3582720318166, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 7357.927, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7357.893, "sample_time_ms": 729.681, "learn_time_ms": 6616.207, "learn_throughput": 604.576, "synch_weights_time_ms": 11.505}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 80, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-26", "timestamp": 1723232186, "time_this_iter_s": 7.298964977264404, "time_total_s": 608.5662930011749, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31251f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 608.5662930011749, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.97, "ram_util_percent": 80.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9285583764625093, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005964923898379, "policy_loss": 0.00021221515101691086, "vf_loss": 9.998156665762265, "vf_explained_var": -0.00010945815593004227, "kl": 0.015004532064388816, "entropy": 1.4661596838384867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.811614368658848, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995049612862724, "policy_loss": -0.00625879330198384, "vf_loss": 9.999140966001642, "vf_explained_var": 0.00023137734680579454, "kl": 0.007224801420997927, "entropy": 1.0611444349642154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "env_runners": {"episode_reward_max": -653.8564050445782, "episode_reward_min": -13419.888076467892, "episode_reward_mean": -8392.398420462037, "episode_len_mean": 192.12, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19212, "policy_reward_min": {"agent_policy": 66.27809588805596, "adversary_policy": -13419.888076467892}, "policy_reward_max": {"agent_policy": 11551.518745541647, "adversary_policy": -66.27809588805596}, "policy_reward_mean": {"agent_policy": 5830.297097324566, "adversary_policy": -7111.347758893301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10574.306746690489, -11173.057917332095, -9786.315162268918, -10259.617419173268, -10675.19199702472, -9344.696985136517, -8647.297330714326, -6189.382710623663, -6567.258046137691, -8678.864966261532, -7136.545928530299, -11747.654875117569, -10381.173003393505, -9860.23548028364, -7322.636024444127, -6550.5157539007705, -9097.416528404192, -9393.653471099926, -11437.839509438965, -11593.835453179965, -12319.11744386833, -10526.914278420389, -9477.490934752552, -9672.37285347241, -9345.203615254868, -3477.141989389235, -6928.547963141075, -6725.904984365335, -9527.946674707397, -5397.824157847768, -1562.4717055137507, -8025.094748423633, -6569.696868612992, -7711.803883456817, -9317.168857147748, -10448.062728494151, -10484.953672738782, -10627.094284349796, -8485.724078689409, -1034.0689075755308, -11267.666512851705, -8406.39353121136, -9733.314935127079, -7779.545772277317, -893.9989624862277, -9411.117489821869, -4671.456925863819, -4122.580194743136, -5631.535255775589, -13036.86265650863, -5553.602707903973, -9706.861686575538, -5617.028700478176, -7461.839195665396, -8078.481877383235, -12035.834721071675, -7179.603787163054, -9958.880666586474, -9602.491337967995, -12093.233606204589, -9688.80732512636, -10227.487259256959, -7197.834428394587, -8349.109102040173, -9477.28427269486, -5837.804441058087, -5511.772908456919, -9025.939190534848, -9683.891400103694, -6006.636343727185, -8976.723390551619, -10252.4663268197, -6977.566404501273, -6956.352996753445, -653.8564050445782, -7266.48213893281, -2332.6991362005574, -11042.792441650712, -6851.658554875878, -9094.985931810463, -13419.888076467892, -9440.792930591664, -9775.45063983476, -7862.814615097008, -11248.304703729693, -7613.6811708568775, -6914.409467048304, -10247.273614209476, -10608.454107262978, -6869.192623946343, -7764.890962160228, -8992.95947090802, -10426.614519363426, -7758.047843454305, -8126.041765136369, -10091.893319592458, -8610.968450284287, -9411.329532091031, -6613.864697225297, -9706.388675363542], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 39, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9935.285754394132, 5772.2040344614825, 6994.551021067027, 2343.068173585569, 6636.022224426429, 7159.835704600748, 6223.925851808045, 5500.612547519646, 4189.092721859632, 4471.9464804423, 5102.5936346289745, 8157.897860552489, 8253.329175667053, 5030.7965656285705, 4960.683243362312, 4719.9097996186865, 6809.464898978255, 4305.893077748674, 6845.167127172819, 4471.437630308877, 7454.630806757258, 8524.794419712167, 6688.746766411317, 8129.652095385407, 6829.053987633068, 2311.8057991950354, 6533.040260135698, 5822.094545645202, 3636.043621550896, 4255.560655049484, 671.4427341298469, 6059.7772340787515, 4938.373544393927, 7357.629146256551, 8740.241919999633, 7836.513439930539, 7166.532821429662, 5062.661043039945, 6651.127670149728, 358.4491125519375, 10419.268403409276, 6209.039535145128, 7838.14745848168, 7014.612705708194, 66.27809588805596, 5009.936009095225, 1840.7540260248038, 2734.2911000934246, 3909.835608522191, 9868.831964123263, 3905.3282802231183, 3578.5614520810022, 4921.565277802436, 6529.193664555091, 4507.993361415604, 11551.518745541647, 5040.768362276068, 7793.889118101337, 5633.59297562126, 11335.533593569802, 9289.648161789748, 7091.704717149452, 4116.617904733763, 7796.949842853803, 6048.637913490678, 1778.5276825888645, 4597.223337353471, 6531.200498278505, 7933.7041144184195, 4955.715946219467, 5470.378702333325, 9177.082900307138, 5739.932659135724, 5249.892148624663, 173.44898314977092, 6804.369679798734, 678.8573240614917, 8127.308067318861, 5320.910712395133, 7271.598576864269, 8629.578890320632, 6439.7152235197045, 8182.229680895763, 4229.5474850108885, 5552.804208771205, 3262.0213666250793, 4523.73232883531, 8707.528512854202, 7092.840631425029, 4141.190543681814, 4507.040782992212, 7986.707286895293, 8932.52887080925, 5630.835199578097, 5515.9393469025135, 7409.90172296755, 7205.932593416593, 2732.3915950633414, 3362.1693902402994, 2210.5353098401492], "policy_adversary_policy_reward": [-9996.941634459887, -10512.650866624735, -5772.2040344614825, -11173.057917332095, -6994.551021067027, -9786.315162268924, -10259.617419173268, -2343.068173585569, -10675.191997024718, -6636.022224426429, -9081.10238140126, -7423.430308336026, -6323.39649773403, -8547.826684788337, -5991.883896906696, -5698.111361236613, -6303.743911493155, -4452.606856504167, -8678.864966261533, -4471.9464804423, -5425.305621693889, -6813.833941465384, -8157.897860552489, -11747.654875117569, -8253.329175667053, -10381.173003393505, -5057.137018934423, -9833.895026977789, -5015.486583317434, -7267.832684489005, -4725.390004208436, -6545.03554931102, -9097.416528404194, -6809.464898978255, -9393.653471099924, -4305.893077748674, -6845.167127172819, -11437.839509438965, -11593.835453179965, -4471.437630308877, -7454.630806757258, -12319.11744386833, -8566.074888360226, -10485.633809772326, -6991.918256457187, -9174.319444706683, -9481.970935974965, -8320.05401288286, -8452.655723532005, -7721.601879355934, -2908.9983346961503, -2879.94945388812, -6717.409222251434, -6744.179001025338, -6682.677903660178, -5865.321626350357, -8692.464709424381, -4471.52558683391, -4294.198930500257, -5359.185882396994, -671.4427341298469, -1562.4717055137507, -8025.094748423634, -6059.7772340787515, -6482.859235642544, -5025.211177364377, -7479.819645411266, -7589.6133843021025, -8909.984627860336, -9147.426149287045, -7836.513439930539, -10448.062728494151, -7166.532821429662, -10484.953672738782, -5062.661043039945, -10627.094284349796, -6651.127670149728, -8485.724078689409, -358.4491125519375, -1034.0689075755308, -10420.95896460095, -11265.97595166003, -6534.946313287795, -8080.486753068695, -9174.79940786186, -8396.662985746902, -7014.847121268251, -7779.31135671726, -66.27809588805596, -893.9989624862277, -5009.936009095225, -9411.117489821869, -2772.245071577989, -3739.965880310638, -3580.5696888561574, -3276.3016059804027, -4374.759526820628, -5166.611337477153, -9868.831964123263, -13036.86265650863, -5416.8699096870705, -4042.0610784400233, -9706.861686575536, -3578.5614520810022, -5276.070330871771, -5262.523647408842, -7426.865729386597, -6564.167130833889, -8078.481877383234, -4507.993361415604, -11977.309751269628, -11610.043715343692, -5040.768362276068, -7179.603787163056, -9958.880666586474, -7793.889118101337, -5633.59297562126, -9602.491337967998, -12093.140865326834, -11335.626334447556, -9615.071500131004, -9363.383986785104, -7091.704717149452, -10227.487259256959, -4116.617904733763, -7197.834428394587, -8297.34140068854, -7848.717544205438, -9331.570556496901, -6194.3516296886355, -5828.728102311226, -1787.604021335727, -5371.384989951713, -4737.6112558586765, -9025.939190534848, -6531.200498278505, -7933.7041144184195, -9683.891400103694, -6006.636343727185, -4955.715946219467, -8976.72339055162, -5470.378702333325, -9177.082900307138, -10252.4663268197, -5950.130188305211, -6767.368875331786, -5264.80238341727, -6941.442761960838, -653.8564050445782, -173.44898314977092, -7092.953329156691, -6977.898489574851, -678.8573240614917, -2332.6991362005574, -8127.308067318861, -11042.792441650712, -6711.914437849655, -5460.654829421364, -7271.598576864269, -9094.985931810463, -13419.888076467892, -8629.578890320632, -9440.792930591664, -6439.7152235197045, -8182.229680895763, -9775.45063983476, -7862.814615097009, -4229.5474850108885, -11248.304703729693, -5552.804208771205, -6625.795195105932, -4249.907342376022, -4523.73232883531, -6914.409467048304, -9886.967708239801, -9067.83441882387, -10608.454107262978, -7092.840631425029, -6869.192623946345, -4141.190543681814, -4861.252649369228, -7410.679095783214, -7986.707286895293, -8992.95947090802, -8932.52887080925, -10426.614519363426, -5630.835199578097, -7758.047843454305, -8126.04176513637, -5515.9393469025135, -10091.893319592458, -7409.90172296755, -7781.708923339526, -8035.192120361349, -2732.3915950633414, -9411.329532091031, -3849.3068771008298, -6126.727210364768, -9706.388675363538, -2210.5353098401492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40472295483194626, "mean_inference_ms": 0.9858239530630086, "mean_action_processing_ms": 0.16941393974231056, "mean_env_wait_ms": 0.051572512218540555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003783106803894043, "StateBufferConnector_ms": 0.003078460693359375, "ViewRequirementAgentConnector_ms": 0.07513284683227539}, "num_episodes": 20, "episode_return_max": -653.8564050445782, "episode_return_min": -13419.888076467892, "episode_return_mean": -8392.398420462037}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 563.9293616056947, "num_env_steps_trained_throughput_per_sec": 563.9293616056947, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 7325.482, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7325.448, "sample_time_ms": 723.327, "learn_time_ms": 6590.179, "learn_throughput": 606.964, "synch_weights_time_ms": 11.5}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "training_iteration": 81, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-33", "timestamp": 1723232193, "time_this_iter_s": 7.097596168518066, "time_total_s": 615.663889169693, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31255e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 615.663889169693, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 22.427272727272726, "ram_util_percent": 80.72727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8974583028970907, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003849178552628, "policy_loss": 0.002659941983680862, "vf_loss": 9.995306704441706, "vf_explained_var": -0.0001911284402012825, "kl": 0.011619777954183518, "entropy": 1.4397151535997788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7977395478300947, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997085138855788, "policy_loss": -0.0029838338501692293, "vf_loss": 9.997624473470859, "vf_explained_var": 9.805153286646283e-06, "kl": 0.008148340940248792, "entropy": 1.0199673232262727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": -502.0308313342077, "episode_reward_min": -13419.888076467892, "episode_reward_mean": -8121.092555995124, "episode_len_mean": 190.37, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19037, "policy_reward_min": {"agent_policy": 66.27809588805596, "adversary_policy": -13419.888076467892}, "policy_reward_max": {"agent_policy": 11551.518745541647, "adversary_policy": -66.27809588805596}, "policy_reward_mean": {"agent_policy": 5794.587697788775, "adversary_policy": -6957.84012689195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10526.914278420389, -9477.490934752552, -9672.37285347241, -9345.203615254868, -3477.141989389235, -6928.547963141075, -6725.904984365335, -9527.946674707397, -5397.824157847768, -1562.4717055137507, -8025.094748423633, -6569.696868612992, -7711.803883456817, -9317.168857147748, -10448.062728494151, -10484.953672738782, -10627.094284349796, -8485.724078689409, -1034.0689075755308, -11267.666512851705, -8406.39353121136, -9733.314935127079, -7779.545772277317, -893.9989624862277, -9411.117489821869, -4671.456925863819, -4122.580194743136, -5631.535255775589, -13036.86265650863, -5553.602707903973, -9706.861686575538, -5617.028700478176, -7461.839195665396, -8078.481877383235, -12035.834721071675, -7179.603787163054, -9958.880666586474, -9602.491337967995, -12093.233606204589, -9688.80732512636, -10227.487259256959, -7197.834428394587, -8349.109102040173, -9477.28427269486, -5837.804441058087, -5511.772908456919, -9025.939190534848, -9683.891400103694, -6006.636343727185, -8976.723390551619, -10252.4663268197, -6977.566404501273, -6956.352996753445, -653.8564050445782, -7266.48213893281, -2332.6991362005574, -11042.792441650712, -6851.658554875878, -9094.985931810463, -13419.888076467892, -9440.792930591664, -9775.45063983476, -7862.814615097008, -11248.304703729693, -7613.6811708568775, -6914.409467048304, -10247.273614209476, -10608.454107262978, -6869.192623946343, -7764.890962160228, -8992.95947090802, -10426.614519363426, -7758.047843454305, -8126.041765136369, -10091.893319592458, -8610.968450284287, -9411.329532091031, -6613.864697225297, -9706.388675363542, -5407.590829677913, -8708.305068026872, -8867.092608882933, -10779.372624149557, -10876.305089723575, -502.0308313342077, -6327.309394153717, -6437.085363469335, -9894.594472409794, -5737.679139982342, -9445.396055155823, -8604.76007783292, -6245.045493362609, -10007.535215555763, -6516.642287303181, -5967.667048584317, -12500.34934491301, -8412.839923335649, -9985.926017743095, -7670.327659424353, -12712.171761312171], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 39, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8524.794419712167, 6688.746766411317, 8129.652095385407, 6829.053987633068, 2311.8057991950354, 6533.040260135698, 5822.094545645202, 3636.043621550896, 4255.560655049484, 671.4427341298469, 6059.7772340787515, 4938.373544393927, 7357.629146256551, 8740.241919999633, 7836.513439930539, 7166.532821429662, 5062.661043039945, 6651.127670149728, 358.4491125519375, 10419.268403409276, 6209.039535145128, 7838.14745848168, 7014.612705708194, 66.27809588805596, 5009.936009095225, 1840.7540260248038, 2734.2911000934246, 3909.835608522191, 9868.831964123263, 3905.3282802231183, 3578.5614520810022, 4921.565277802436, 6529.193664555091, 4507.993361415604, 11551.518745541647, 5040.768362276068, 7793.889118101337, 5633.59297562126, 11335.533593569802, 9289.648161789748, 7091.704717149452, 4116.617904733763, 7796.949842853803, 6048.637913490678, 1778.5276825888645, 4597.223337353471, 6531.200498278505, 7933.7041144184195, 4955.715946219467, 5470.378702333325, 9177.082900307138, 5739.932659135724, 5249.892148624663, 173.44898314977092, 6804.369679798734, 678.8573240614917, 8127.308067318861, 5320.910712395133, 7271.598576864269, 8629.578890320632, 6439.7152235197045, 8182.229680895763, 4229.5474850108885, 5552.804208771205, 3262.0213666250793, 4523.73232883531, 8707.528512854202, 7092.840631425029, 4141.190543681814, 4507.040782992212, 7986.707286895293, 8932.52887080925, 5630.835199578097, 5515.9393469025135, 7409.90172296755, 7205.932593416593, 2732.3915950633414, 3362.1693902402994, 2210.5353098401492, 3147.536954461209, 6462.610135961236, 6293.696438766497, 5899.643006095673, 8722.446868088602, 139.1985583409225, 3759.0365421120473, 5890.690886132228, 2765.57110463371, 2537.288608182011, 8687.739566767752, 7038.091354952131, 6082.9760770761695, 5587.4257595563395, 2929.29732823267, 4705.06668378713, 9233.878779394143, 7245.204130400463, 6681.945285827549, 6642.494805247447, 11315.569506994121], "policy_adversary_policy_reward": [-8566.074888360226, -10485.633809772326, -6991.918256457187, -9174.319444706683, -9481.970935974965, -8320.05401288286, -8452.655723532005, -7721.601879355934, -2908.9983346961503, -2879.94945388812, -6717.409222251434, -6744.179001025338, -6682.677903660178, -5865.321626350357, -8692.464709424381, -4471.52558683391, -4294.198930500257, -5359.185882396994, -671.4427341298469, -1562.4717055137507, -8025.094748423634, -6059.7772340787515, -6482.859235642544, -5025.211177364377, -7479.819645411266, -7589.6133843021025, -8909.984627860336, -9147.426149287045, -7836.513439930539, -10448.062728494151, -7166.532821429662, -10484.953672738782, -5062.661043039945, -10627.094284349796, -6651.127670149728, -8485.724078689409, -358.4491125519375, -1034.0689075755308, -10420.95896460095, -11265.97595166003, -6534.946313287795, -8080.486753068695, -9174.79940786186, -8396.662985746902, -7014.847121268251, -7779.31135671726, -66.27809588805596, -893.9989624862277, -5009.936009095225, -9411.117489821869, -2772.245071577989, -3739.965880310638, -3580.5696888561574, -3276.3016059804027, -4374.759526820628, -5166.611337477153, -9868.831964123263, -13036.86265650863, -5416.8699096870705, -4042.0610784400233, -9706.861686575536, -3578.5614520810022, -5276.070330871771, -5262.523647408842, -7426.865729386597, -6564.167130833889, -8078.481877383234, -4507.993361415604, -11977.309751269628, -11610.043715343692, -5040.768362276068, -7179.603787163056, -9958.880666586474, -7793.889118101337, -5633.59297562126, -9602.491337967998, -12093.140865326834, -11335.626334447556, -9615.071500131004, -9363.383986785104, -7091.704717149452, -10227.487259256959, -4116.617904733763, -7197.834428394587, -8297.34140068854, -7848.717544205438, -9331.570556496901, -6194.3516296886355, -5828.728102311226, -1787.604021335727, -5371.384989951713, -4737.6112558586765, -9025.939190534848, -6531.200498278505, -7933.7041144184195, -9683.891400103694, -6006.636343727185, -4955.715946219467, -8976.72339055162, -5470.378702333325, -9177.082900307138, -10252.4663268197, -5950.130188305211, -6767.368875331786, -5264.80238341727, -6941.442761960838, -653.8564050445782, -173.44898314977092, -7092.953329156691, -6977.898489574851, -678.8573240614917, -2332.6991362005574, -8127.308067318861, -11042.792441650712, -6711.914437849655, -5460.654829421364, -7271.598576864269, -9094.985931810463, -13419.888076467892, -8629.578890320632, -9440.792930591664, -6439.7152235197045, -8182.229680895763, -9775.45063983476, -7862.814615097009, -4229.5474850108885, -11248.304703729693, -5552.804208771205, -6625.795195105932, -4249.907342376022, -4523.73232883531, -6914.409467048304, -9886.967708239801, -9067.83441882387, -10608.454107262978, -7092.840631425029, -6869.192623946345, -4141.190543681814, -4861.252649369228, -7410.679095783214, -7986.707286895293, -8992.95947090802, -8932.52887080925, -10426.614519363426, -5630.835199578097, -7758.047843454305, -8126.04176513637, -5515.9393469025135, -10091.893319592458, -7409.90172296755, -7781.708923339526, -8035.192120361349, -2732.3915950633414, -9411.329532091031, -3849.3068771008298, -6126.727210364768, -9706.388675363538, -2210.5353098401492, -5407.590829677912, -3147.536954461209, -8527.648063356763, -6643.267140631345, -6293.696438766497, -8867.092608882933, -5899.643006095673, -10779.372624149555, -8722.446868088602, -10876.305089723579, -139.1985583409225, -502.0308313342077, -5320.463213476515, -4765.882722789233, -5969.230696472304, -6358.545553129259, -9894.594472409795, -2765.57110463371, -5737.679139982343, -2537.288608182011, -8690.449946584615, -9442.685675338962, -8592.83428910452, -7050.017143680533, -6149.836250731461, -6178.185319707316, -10007.53521555576, -5587.4257595563395, -3696.4847095846653, -5749.454905951189, -4705.06668378713, -5967.667048584317, -9233.878779394143, -12500.349344913011, -8357.216662539411, -7300.827391196701, -6681.945285827549, -9985.926017743095, -7638.74283892981, -6674.0796257419925, -12712.171761312171, -11315.569506994121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4045213876559881, "mean_inference_ms": 0.9852866904533579, "mean_action_processing_ms": 0.16929890029859826, "mean_env_wait_ms": 0.05153074272181924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039681196212768555, "StateBufferConnector_ms": 0.0030553340911865234, "ViewRequirementAgentConnector_ms": 0.07461988925933838}, "num_episodes": 21, "episode_return_max": -502.0308313342077, "episode_return_min": -13419.888076467892, "episode_return_mean": -8121.092555995124}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.7951783248632, "num_env_steps_trained_throughput_per_sec": 542.7951783248632, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 7323.221, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7323.187, "sample_time_ms": 721.266, "learn_time_ms": 6590.181, "learn_throughput": 606.964, "synch_weights_time_ms": 11.25}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 82, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-40", "timestamp": 1723232200, "time_this_iter_s": 7.374943017959595, "time_total_s": 623.0388321876526, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a4a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 623.0388321876526, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 25.97, "ram_util_percent": 80.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8838721471528213, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999774106343587, "policy_loss": -0.000571055738934471, "vf_loss": 9.99624724785487, "vf_explained_var": -0.0002942310025294622, "kl": 0.00809465886753363, "entropy": 1.4165983360260725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7853062124952438, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99456252799463, "policy_loss": -0.0061603280241359715, "vf_loss": 9.998060751213599, "vf_explained_var": 4.6924750010172525e-05, "kl": 0.008873701806638448, "entropy": 1.021062991921864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "env_runners": {"episode_reward_max": -502.0308313342077, "episode_reward_min": -13419.888076467892, "episode_reward_mean": -8265.387402820947, "episode_len_mean": 191.99, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19199, "policy_reward_min": {"agent_policy": 66.27809588805596, "adversary_policy": -13419.888076467892}, "policy_reward_max": {"agent_policy": 11551.518745541647, "adversary_policy": -66.27809588805596}, "policy_reward_mean": {"agent_policy": 5739.191946913876, "adversary_policy": -7002.289674867413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8406.39353121136, -9733.314935127079, -7779.545772277317, -893.9989624862277, -9411.117489821869, -4671.456925863819, -4122.580194743136, -5631.535255775589, -13036.86265650863, -5553.602707903973, -9706.861686575538, -5617.028700478176, -7461.839195665396, -8078.481877383235, -12035.834721071675, -7179.603787163054, -9958.880666586474, -9602.491337967995, -12093.233606204589, -9688.80732512636, -10227.487259256959, -7197.834428394587, -8349.109102040173, -9477.28427269486, -5837.804441058087, -5511.772908456919, -9025.939190534848, -9683.891400103694, -6006.636343727185, -8976.723390551619, -10252.4663268197, -6977.566404501273, -6956.352996753445, -653.8564050445782, -7266.48213893281, -2332.6991362005574, -11042.792441650712, -6851.658554875878, -9094.985931810463, -13419.888076467892, -9440.792930591664, -9775.45063983476, -7862.814615097008, -11248.304703729693, -7613.6811708568775, -6914.409467048304, -10247.273614209476, -10608.454107262978, -6869.192623946343, -7764.890962160228, -8992.95947090802, -10426.614519363426, -7758.047843454305, -8126.041765136369, -10091.893319592458, -8610.968450284287, -9411.329532091031, -6613.864697225297, -9706.388675363542, -5407.590829677913, -8708.305068026872, -8867.092608882933, -10779.372624149557, -10876.305089723575, -502.0308313342077, -6327.309394153717, -6437.085363469335, -9894.594472409794, -5737.679139982342, -9445.396055155823, -8604.76007783292, -6245.045493362609, -10007.535215555763, -6516.642287303181, -5967.667048584317, -12500.34934491301, -8412.839923335649, -9985.926017743095, -7670.327659424353, -12712.171761312171, -8468.430722874908, -6091.489514318224, -2484.034064399636, -9020.966033938874, -6553.070552478031, -11141.55980046128, -9595.290351355863, -9698.450750924261, -8103.074287622832, -6490.129185273199, -8640.853535239607, -8770.170785082722, -11863.33802040441, -7963.5577489313155, -8277.17265472901, -10802.786189341434, -9827.67736151433, -12387.856005883801, -9128.612478409857, -5734.118338604248], "episode_lengths": [200, 200, 200, 21, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6209.039535145128, 7838.14745848168, 7014.612705708194, 66.27809588805596, 5009.936009095225, 1840.7540260248038, 2734.2911000934246, 3909.835608522191, 9868.831964123263, 3905.3282802231183, 3578.5614520810022, 4921.565277802436, 6529.193664555091, 4507.993361415604, 11551.518745541647, 5040.768362276068, 7793.889118101337, 5633.59297562126, 11335.533593569802, 9289.648161789748, 7091.704717149452, 4116.617904733763, 7796.949842853803, 6048.637913490678, 1778.5276825888645, 4597.223337353471, 6531.200498278505, 7933.7041144184195, 4955.715946219467, 5470.378702333325, 9177.082900307138, 5739.932659135724, 5249.892148624663, 173.44898314977092, 6804.369679798734, 678.8573240614917, 8127.308067318861, 5320.910712395133, 7271.598576864269, 8629.578890320632, 6439.7152235197045, 8182.229680895763, 4229.5474850108885, 5552.804208771205, 3262.0213666250793, 4523.73232883531, 8707.528512854202, 7092.840631425029, 4141.190543681814, 4507.040782992212, 7986.707286895293, 8932.52887080925, 5630.835199578097, 5515.9393469025135, 7409.90172296755, 7205.932593416593, 2732.3915950633414, 3362.1693902402994, 2210.5353098401492, 3147.536954461209, 6462.610135961236, 6293.696438766497, 5899.643006095673, 8722.446868088602, 139.1985583409225, 3759.0365421120473, 5890.690886132228, 2765.57110463371, 2537.288608182011, 8687.739566767752, 7038.091354952131, 6082.9760770761695, 5587.4257595563395, 2929.29732823267, 4705.06668378713, 9233.878779394143, 7245.204130400463, 6681.945285827549, 6642.494805247447, 11315.569506994121, 5083.373301024088, 3281.005810735453, 764.0214622755832, 3059.873659051586, 4988.21187739749, 8991.409703126825, 5050.7623104734985, 7171.806703160407, 7083.283541465899, 6191.785840200159, 5040.327217086838, 7492.157399581493, 9487.329492065448, 2318.235716341755, 2549.279741675232, 9646.48568779954, 8522.77148098214, 8769.3754566015, 4320.077959970584, 2641.659771582487], "policy_adversary_policy_reward": [-6534.946313287795, -8080.486753068695, -9174.79940786186, -8396.662985746902, -7014.847121268251, -7779.31135671726, -66.27809588805596, -893.9989624862277, -5009.936009095225, -9411.117489821869, -2772.245071577989, -3739.965880310638, -3580.5696888561574, -3276.3016059804027, -4374.759526820628, -5166.611337477153, -9868.831964123263, -13036.86265650863, -5416.8699096870705, -4042.0610784400233, -9706.861686575536, -3578.5614520810022, -5276.070330871771, -5262.523647408842, -7426.865729386597, -6564.167130833889, -8078.481877383234, -4507.993361415604, -11977.309751269628, -11610.043715343692, -5040.768362276068, -7179.603787163056, -9958.880666586474, -7793.889118101337, -5633.59297562126, -9602.491337967998, -12093.140865326834, -11335.626334447556, -9615.071500131004, -9363.383986785104, -7091.704717149452, -10227.487259256959, -4116.617904733763, -7197.834428394587, -8297.34140068854, -7848.717544205438, -9331.570556496901, -6194.3516296886355, -5828.728102311226, -1787.604021335727, -5371.384989951713, -4737.6112558586765, -9025.939190534848, -6531.200498278505, -7933.7041144184195, -9683.891400103694, -6006.636343727185, -4955.715946219467, -8976.72339055162, -5470.378702333325, -9177.082900307138, -10252.4663268197, -5950.130188305211, -6767.368875331786, -5264.80238341727, -6941.442761960838, -653.8564050445782, -173.44898314977092, -7092.953329156691, -6977.898489574851, -678.8573240614917, -2332.6991362005574, -8127.308067318861, -11042.792441650712, -6711.914437849655, -5460.654829421364, -7271.598576864269, -9094.985931810463, -13419.888076467892, -8629.578890320632, -9440.792930591664, -6439.7152235197045, -8182.229680895763, -9775.45063983476, -7862.814615097009, -4229.5474850108885, -11248.304703729693, -5552.804208771205, -6625.795195105932, -4249.907342376022, -4523.73232883531, -6914.409467048304, -9886.967708239801, -9067.83441882387, -10608.454107262978, -7092.840631425029, -6869.192623946345, -4141.190543681814, -4861.252649369228, -7410.679095783214, -7986.707286895293, -8992.95947090802, -8932.52887080925, -10426.614519363426, -5630.835199578097, -7758.047843454305, -8126.04176513637, -5515.9393469025135, -10091.893319592458, -7409.90172296755, -7781.708923339526, -8035.192120361349, -2732.3915950633414, -9411.329532091031, -3849.3068771008298, -6126.727210364768, -9706.388675363538, -2210.5353098401492, -5407.590829677912, -3147.536954461209, -8527.648063356763, -6643.267140631345, -6293.696438766497, -8867.092608882933, -5899.643006095673, -10779.372624149555, -8722.446868088602, -10876.305089723579, -139.1985583409225, -502.0308313342077, -5320.463213476515, -4765.882722789233, -5969.230696472304, -6358.545553129259, -9894.594472409795, -2765.57110463371, -5737.679139982343, -2537.288608182011, -8690.449946584615, -9442.685675338962, -8592.83428910452, -7050.017143680533, -6149.836250731461, -6178.185319707316, -10007.53521555576, -5587.4257595563395, -3696.4847095846653, -5749.454905951189, -4705.06668378713, -5967.667048584317, -9233.878779394143, -12500.349344913011, -8357.216662539411, -7300.827391196701, -6681.945285827549, -9985.926017743095, -7638.74283892981, -6674.0796257419925, -12712.171761312171, -11315.569506994121, -5087.146394813706, -8464.65762908529, -4069.0584295357853, -5303.436895517902, -2484.0340643996356, -764.0214622755832, -9020.966033938872, -3059.873659051586, -4988.21187739749, -6553.0705524780315, -8991.409703126825, -11141.55980046128, -9595.290351355863, -5050.7623104734985, -7171.806703160407, -9698.450750924261, -7278.214340720431, -7908.1434883683005, -6336.034111791627, -6345.880913681731, -8065.721126095765, -5615.459626230683, -8770.170785082722, -7492.157399581493, -11863.33802040441, -9487.329492065448, -2318.235716341755, -7963.557748931316, -2587.8179947567946, -8238.634401647449, -9646.48568779954, -10802.786189341434, -9720.28066601594, -8630.168176480527, -12387.856005883801, -8769.3754566015, -4568.928448798918, -8879.761989581519, -5478.4623933439725, -2897.315716842762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4042219348674786, "mean_inference_ms": 0.9844853408934905, "mean_action_processing_ms": 0.16914100445638355, "mean_env_wait_ms": 0.05149358452592731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003973245620727539, "StateBufferConnector_ms": 0.0030944347381591797, "ViewRequirementAgentConnector_ms": 0.07491910457611084}, "num_episodes": 20, "episode_return_max": -502.0308313342077, "episode_return_min": -13419.888076467892, "episode_return_mean": -8265.387402820947}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.9231971795241, "num_env_steps_trained_throughput_per_sec": 539.9231971795241, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 7319.243, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7319.21, "sample_time_ms": 721.297, "learn_time_ms": 6586.481, "learn_throughput": 607.305, "synch_weights_time_ms": 10.942}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "training_iteration": 83, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-48", "timestamp": 1723232208, "time_this_iter_s": 7.412838935852051, "time_total_s": 630.4516711235046, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3125670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 630.4516711235046, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 80.66363636363634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.856446995275716, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002229110399883, "policy_loss": -0.002838646963937208, "vf_loss": 10.0, "vf_explained_var": -0.00028049188355604805, "kl": 0.010010469031597798, "entropy": 1.3707304503768682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8002436911933637, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998980740138462, "policy_loss": -0.0036216603042607113, "vf_loss": 10.0, "vf_explained_var": 0.0004454958060431102, "kl": 0.00867473095083836, "entropy": 1.036463910309726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": -502.0308313342077, "episode_reward_min": -13419.888076467892, "episode_reward_mean": -8448.532407029437, "episode_len_mean": 193.78, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19378, "policy_reward_min": {"agent_policy": 139.1985583409225, "adversary_policy": -13419.888076467892}, "policy_reward_max": {"agent_policy": 11315.569506994121, "adversary_policy": -139.1985583409225}, "policy_reward_mean": {"agent_policy": 5659.773488141488, "adversary_policy": -7054.152947585463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10227.487259256959, -7197.834428394587, -8349.109102040173, -9477.28427269486, -5837.804441058087, -5511.772908456919, -9025.939190534848, -9683.891400103694, -6006.636343727185, -8976.723390551619, -10252.4663268197, -6977.566404501273, -6956.352996753445, -653.8564050445782, -7266.48213893281, -2332.6991362005574, -11042.792441650712, -6851.658554875878, -9094.985931810463, -13419.888076467892, -9440.792930591664, -9775.45063983476, -7862.814615097008, -11248.304703729693, -7613.6811708568775, -6914.409467048304, -10247.273614209476, -10608.454107262978, -6869.192623946343, -7764.890962160228, -8992.95947090802, -10426.614519363426, -7758.047843454305, -8126.041765136369, -10091.893319592458, -8610.968450284287, -9411.329532091031, -6613.864697225297, -9706.388675363542, -5407.590829677913, -8708.305068026872, -8867.092608882933, -10779.372624149557, -10876.305089723575, -502.0308313342077, -6327.309394153717, -6437.085363469335, -9894.594472409794, -5737.679139982342, -9445.396055155823, -8604.76007783292, -6245.045493362609, -10007.535215555763, -6516.642287303181, -5967.667048584317, -12500.34934491301, -8412.839923335649, -9985.926017743095, -7670.327659424353, -12712.171761312171, -8468.430722874908, -6091.489514318224, -2484.034064399636, -9020.966033938874, -6553.070552478031, -11141.55980046128, -9595.290351355863, -9698.450750924261, -8103.074287622832, -6490.129185273199, -8640.853535239607, -8770.170785082722, -11863.33802040441, -7963.5577489313155, -8277.17265472901, -10802.786189341434, -9827.67736151433, -12387.856005883801, -9128.612478409857, -5734.118338604248, -10003.303759221448, -12342.312662808032, -10584.127040414123, -8773.672202661664, -6238.513390443874, -11092.539192527074, -8285.259269869404, -11019.023349362129, -7018.299670495532, -9873.51738641758, -10212.827145147723, -8799.304056176132, -10238.84955854809, -4389.839659116587, -10619.751100148507, -7117.278380783245, -9579.561368313989, -6777.06979893104, -9141.789266430495, -6871.133498973687], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7091.704717149452, 4116.617904733763, 7796.949842853803, 6048.637913490678, 1778.5276825888645, 4597.223337353471, 6531.200498278505, 7933.7041144184195, 4955.715946219467, 5470.378702333325, 9177.082900307138, 5739.932659135724, 5249.892148624663, 173.44898314977092, 6804.369679798734, 678.8573240614917, 8127.308067318861, 5320.910712395133, 7271.598576864269, 8629.578890320632, 6439.7152235197045, 8182.229680895763, 4229.5474850108885, 5552.804208771205, 3262.0213666250793, 4523.73232883531, 8707.528512854202, 7092.840631425029, 4141.190543681814, 4507.040782992212, 7986.707286895293, 8932.52887080925, 5630.835199578097, 5515.9393469025135, 7409.90172296755, 7205.932593416593, 2732.3915950633414, 3362.1693902402994, 2210.5353098401492, 3147.536954461209, 6462.610135961236, 6293.696438766497, 5899.643006095673, 8722.446868088602, 139.1985583409225, 3759.0365421120473, 5890.690886132228, 2765.57110463371, 2537.288608182011, 8687.739566767752, 7038.091354952131, 6082.9760770761695, 5587.4257595563395, 2929.29732823267, 4705.06668378713, 9233.878779394143, 7245.204130400463, 6681.945285827549, 6642.494805247447, 11315.569506994121, 5083.373301024088, 3281.005810735453, 764.0214622755832, 3059.873659051586, 4988.21187739749, 8991.409703126825, 5050.7623104734985, 7171.806703160407, 7083.283541465899, 6191.785840200159, 5040.327217086838, 7492.157399581493, 9487.329492065448, 2318.235716341755, 2549.279741675232, 9646.48568779954, 8522.77148098214, 8769.3754566015, 4320.077959970584, 2641.659771582487, 7073.672215746422, 2852.643438510876, 10023.785605124467, 3043.67626668322, 2331.9174660080753, 8229.764870383238, 5785.157475856249, 7417.588307249203, 3442.449338302651, 2853.761024342887, 4887.835081220115, 4113.980372573061, 9572.715464886052, 2612.332574926749, 9642.271131696903, 4658.234325185634, 5170.356074540894, 4266.697097171479, 8436.849823009728, 4221.785665402434], "policy_adversary_policy_reward": [-7091.704717149452, -10227.487259256959, -4116.617904733763, -7197.834428394587, -8297.34140068854, -7848.717544205438, -9331.570556496901, -6194.3516296886355, -5828.728102311226, -1787.604021335727, -5371.384989951713, -4737.6112558586765, -9025.939190534848, -6531.200498278505, -7933.7041144184195, -9683.891400103694, -6006.636343727185, -4955.715946219467, -8976.72339055162, -5470.378702333325, -9177.082900307138, -10252.4663268197, -5950.130188305211, -6767.368875331786, -5264.80238341727, -6941.442761960838, -653.8564050445782, -173.44898314977092, -7092.953329156691, -6977.898489574851, -678.8573240614917, -2332.6991362005574, -8127.308067318861, -11042.792441650712, -6711.914437849655, -5460.654829421364, -7271.598576864269, -9094.985931810463, -13419.888076467892, -8629.578890320632, -9440.792930591664, -6439.7152235197045, -8182.229680895763, -9775.45063983476, -7862.814615097009, -4229.5474850108885, -11248.304703729693, -5552.804208771205, -6625.795195105932, -4249.907342376022, -4523.73232883531, -6914.409467048304, -9886.967708239801, -9067.83441882387, -10608.454107262978, -7092.840631425029, -6869.192623946345, -4141.190543681814, -4861.252649369228, -7410.679095783214, -7986.707286895293, -8992.95947090802, -8932.52887080925, -10426.614519363426, -5630.835199578097, -7758.047843454305, -8126.04176513637, -5515.9393469025135, -10091.893319592458, -7409.90172296755, -7781.708923339526, -8035.192120361349, -2732.3915950633414, -9411.329532091031, -3849.3068771008298, -6126.727210364768, -9706.388675363538, -2210.5353098401492, -5407.590829677912, -3147.536954461209, -8527.648063356763, -6643.267140631345, -6293.696438766497, -8867.092608882933, -5899.643006095673, -10779.372624149555, -8722.446868088602, -10876.305089723579, -139.1985583409225, -502.0308313342077, -5320.463213476515, -4765.882722789233, -5969.230696472304, -6358.545553129259, -9894.594472409795, -2765.57110463371, -5737.679139982343, -2537.288608182011, -8690.449946584615, -9442.685675338962, -8592.83428910452, -7050.017143680533, -6149.836250731461, -6178.185319707316, -10007.53521555576, -5587.4257595563395, -3696.4847095846653, -5749.454905951189, -4705.06668378713, -5967.667048584317, -9233.878779394143, -12500.349344913011, -8357.216662539411, -7300.827391196701, -6681.945285827549, -9985.926017743095, -7638.74283892981, -6674.0796257419925, -12712.171761312171, -11315.569506994121, -5087.146394813706, -8464.65762908529, -4069.0584295357853, -5303.436895517902, -2484.0340643996356, -764.0214622755832, -9020.966033938872, -3059.873659051586, -4988.21187739749, -6553.0705524780315, -8991.409703126825, -11141.55980046128, -9595.290351355863, -5050.7623104734985, -7171.806703160407, -9698.450750924261, -7278.214340720431, -7908.1434883683005, -6336.034111791627, -6345.880913681731, -8065.721126095765, -5615.459626230683, -8770.170785082722, -7492.157399581493, -11863.33802040441, -9487.329492065448, -2318.235716341755, -7963.557748931316, -2587.8179947567946, -8238.634401647449, -9646.48568779954, -10802.786189341434, -9720.28066601594, -8630.168176480527, -12387.856005883801, -8769.3754566015, -4568.928448798918, -8879.761989581519, -5478.4623933439725, -2897.315716842762, -7073.672215746422, -10003.303759221448, -2852.643438510876, -12342.312662808032, -10291.277156728274, -10316.63548881032, -8773.672202661664, -3043.67626668322, -6044.282303193303, -2526.148553258646, -8229.764870383238, -11092.539192527074, -5785.157475856249, -8285.259269869404, -7417.588307249203, -11019.023349362129, -3442.449338302651, -7018.299670495532, -2853.761024342887, -9873.51738641758, -4887.835081220115, -10212.827145147723, -8799.30405617613, -4113.980372573061, -9973.218063731516, -9838.34695970263, -3338.109837268559, -3664.062396774777, -10568.024448746242, -9693.997783099168, -7117.278380783245, -4658.234325185634, -5170.356074540894, -9579.561368313989, -4266.697097171479, -6777.06979893104, -8487.11039203152, -9091.5286974087, -4792.965164371598, -6299.9540000045245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039888297759599, "mean_inference_ms": 0.9830517625160521, "mean_action_processing_ms": 0.16913652735111825, "mean_env_wait_ms": 0.05146247148525926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004023909568786621, "StateBufferConnector_ms": 0.0031090974807739258, "ViewRequirementAgentConnector_ms": 0.07572996616363525}, "num_episodes": 20, "episode_return_max": -502.0308313342077, "episode_return_min": -13419.888076467892, "episode_return_mean": -8448.532407029437}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.9801262510098, "num_env_steps_trained_throughput_per_sec": 547.9801262510098, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 7332.927, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7332.894, "sample_time_ms": 723.268, "learn_time_ms": 6598.409, "learn_throughput": 606.207, "synch_weights_time_ms": 10.727}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 84, "trial_id": "3439d_00000", "date": "2024-08-09_15-36-55", "timestamp": 1723232215, "time_this_iter_s": 7.30489706993103, "time_total_s": 637.7565681934357, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3125af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 637.7565681934357, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 23.79090909090909, "ram_util_percent": 80.11818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8829382630375524, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98863201936086, "policy_loss": -0.008006300460450196, "vf_loss": 9.989299645026525, "vf_explained_var": -0.00016756970435380936, "kl": 0.014496116033600022, "entropy": 1.3687196422368288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.778634089783386, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994316205524264, "policy_loss": -0.002869077179231065, "vf_loss": 9.994810763364116, "vf_explained_var": 0.0005882298820233219, "kl": 0.007915117713085637, "entropy": 1.0151195371277117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": -148.682738811011, "episode_reward_min": -12712.171761312171, "episode_reward_mean": -8389.645836518244, "episode_len_mean": 194.41, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19441, "policy_reward_min": {"agent_policy": 57.23704195787148, "adversary_policy": -12712.171761312171}, "policy_reward_max": {"agent_policy": 11315.569506994121, "adversary_policy": -57.23704195787148}, "policy_reward_mean": {"agent_policy": 5360.316835483173, "adversary_policy": -6874.981336000708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7862.814615097008, -11248.304703729693, -7613.6811708568775, -6914.409467048304, -10247.273614209476, -10608.454107262978, -6869.192623946343, -7764.890962160228, -8992.95947090802, -10426.614519363426, -7758.047843454305, -8126.041765136369, -10091.893319592458, -8610.968450284287, -9411.329532091031, -6613.864697225297, -9706.388675363542, -5407.590829677913, -8708.305068026872, -8867.092608882933, -10779.372624149557, -10876.305089723575, -502.0308313342077, -6327.309394153717, -6437.085363469335, -9894.594472409794, -5737.679139982342, -9445.396055155823, -8604.76007783292, -6245.045493362609, -10007.535215555763, -6516.642287303181, -5967.667048584317, -12500.34934491301, -8412.839923335649, -9985.926017743095, -7670.327659424353, -12712.171761312171, -8468.430722874908, -6091.489514318224, -2484.034064399636, -9020.966033938874, -6553.070552478031, -11141.55980046128, -9595.290351355863, -9698.450750924261, -8103.074287622832, -6490.129185273199, -8640.853535239607, -8770.170785082722, -11863.33802040441, -7963.5577489313155, -8277.17265472901, -10802.786189341434, -9827.67736151433, -12387.856005883801, -9128.612478409857, -5734.118338604248, -10003.303759221448, -12342.312662808032, -10584.127040414123, -8773.672202661664, -6238.513390443874, -11092.539192527074, -8285.259269869404, -11019.023349362129, -7018.299670495532, -9873.51738641758, -10212.827145147723, -8799.304056176132, -10238.84955854809, -4389.839659116587, -10619.751100148507, -7117.278380783245, -9579.561368313989, -6777.06979893104, -9141.789266430495, -6871.133498973687, -9278.498982227102, -10163.80403132328, -10442.62889247057, -6997.202242508874, -4479.594439136573, -8225.840550862984, -6555.788781477172, -5591.181432739757, -9594.937078836872, -10096.266540191813, -11076.124367618704, -148.682738811011, -4998.40055425702, -9542.045083054509, -10267.245766905287, -7717.922843381788, -3692.660643989046, -4884.74142292041, -8059.015635732093, -9275.792730319776, -8763.830436000497, -8618.612474418385], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4229.5474850108885, 5552.804208771205, 3262.0213666250793, 4523.73232883531, 8707.528512854202, 7092.840631425029, 4141.190543681814, 4507.040782992212, 7986.707286895293, 8932.52887080925, 5630.835199578097, 5515.9393469025135, 7409.90172296755, 7205.932593416593, 2732.3915950633414, 3362.1693902402994, 2210.5353098401492, 3147.536954461209, 6462.610135961236, 6293.696438766497, 5899.643006095673, 8722.446868088602, 139.1985583409225, 3759.0365421120473, 5890.690886132228, 2765.57110463371, 2537.288608182011, 8687.739566767752, 7038.091354952131, 6082.9760770761695, 5587.4257595563395, 2929.29732823267, 4705.06668378713, 9233.878779394143, 7245.204130400463, 6681.945285827549, 6642.494805247447, 11315.569506994121, 5083.373301024088, 3281.005810735453, 764.0214622755832, 3059.873659051586, 4988.21187739749, 8991.409703126825, 5050.7623104734985, 7171.806703160407, 7083.283541465899, 6191.785840200159, 5040.327217086838, 7492.157399581493, 9487.329492065448, 2318.235716341755, 2549.279741675232, 9646.48568779954, 8522.77148098214, 8769.3754566015, 4320.077959970584, 2641.659771582487, 7073.672215746422, 2852.643438510876, 10023.785605124467, 3043.67626668322, 2331.9174660080753, 8229.764870383238, 5785.157475856249, 7417.588307249203, 3442.449338302651, 2853.761024342887, 4887.835081220115, 4113.980372573061, 9572.715464886052, 2612.332574926749, 9642.271131696903, 4658.234325185634, 5170.356074540894, 4266.697097171479, 8436.849823009728, 4221.785665402434, 4112.103019213166, 7306.571708822527, 7554.07170539783, 6042.265635662765, 3360.0015099381108, 4950.584614047985, 3748.348681740695, 1999.8401064367154, 4862.504372774396, 2566.5530710688176, 8961.031498377286, 57.23704195787148, 4163.937970165228, 4075.6741910546857, 5134.563107013963, 6309.170384891299, 2308.6771060583874, 2811.1953935556326, 5015.828411204708, 5629.8685053012005, 4564.00194535245, 2635.8902599443327], "policy_adversary_policy_reward": [-7862.814615097009, -4229.5474850108885, -11248.304703729693, -5552.804208771205, -6625.795195105932, -4249.907342376022, -4523.73232883531, -6914.409467048304, -9886.967708239801, -9067.83441882387, -10608.454107262978, -7092.840631425029, -6869.192623946345, -4141.190543681814, -4861.252649369228, -7410.679095783214, -7986.707286895293, -8992.95947090802, -8932.52887080925, -10426.614519363426, -5630.835199578097, -7758.047843454305, -8126.04176513637, -5515.9393469025135, -10091.893319592458, -7409.90172296755, -7781.708923339526, -8035.192120361349, -2732.3915950633414, -9411.329532091031, -3849.3068771008298, -6126.727210364768, -9706.388675363538, -2210.5353098401492, -5407.590829677912, -3147.536954461209, -8527.648063356763, -6643.267140631345, -6293.696438766497, -8867.092608882933, -5899.643006095673, -10779.372624149555, -8722.446868088602, -10876.305089723579, -139.1985583409225, -502.0308313342077, -5320.463213476515, -4765.882722789233, -5969.230696472304, -6358.545553129259, -9894.594472409795, -2765.57110463371, -5737.679139982343, -2537.288608182011, -8690.449946584615, -9442.685675338962, -8592.83428910452, -7050.017143680533, -6149.836250731461, -6178.185319707316, -10007.53521555576, -5587.4257595563395, -3696.4847095846653, -5749.454905951189, -4705.06668378713, -5967.667048584317, -9233.878779394143, -12500.349344913011, -8357.216662539411, -7300.827391196701, -6681.945285827549, -9985.926017743095, -7638.74283892981, -6674.0796257419925, -12712.171761312171, -11315.569506994121, -5087.146394813706, -8464.65762908529, -4069.0584295357853, -5303.436895517902, -2484.0340643996356, -764.0214622755832, -9020.966033938872, -3059.873659051586, -4988.21187739749, -6553.0705524780315, -8991.409703126825, -11141.55980046128, -9595.290351355863, -5050.7623104734985, -7171.806703160407, -9698.450750924261, -7278.214340720431, -7908.1434883683005, -6336.034111791627, -6345.880913681731, -8065.721126095765, -5615.459626230683, -8770.170785082722, -7492.157399581493, -11863.33802040441, -9487.329492065448, -2318.235716341755, -7963.557748931316, -2587.8179947567946, -8238.634401647449, -9646.48568779954, -10802.786189341434, -9720.28066601594, -8630.168176480527, -12387.856005883801, -8769.3754566015, -4568.928448798918, -8879.761989581519, -5478.4623933439725, -2897.315716842762, -7073.672215746422, -10003.303759221448, -2852.643438510876, -12342.312662808032, -10291.277156728274, -10316.63548881032, -8773.672202661664, -3043.67626668322, -6044.282303193303, -2526.148553258646, -8229.764870383238, -11092.539192527074, -5785.157475856249, -8285.259269869404, -7417.588307249203, -11019.023349362129, -3442.449338302651, -7018.299670495532, -2853.761024342887, -9873.51738641758, -4887.835081220115, -10212.827145147723, -8799.30405617613, -4113.980372573061, -9973.218063731516, -9838.34695970263, -3338.109837268559, -3664.062396774777, -10568.024448746242, -9693.997783099168, -7117.278380783245, -4658.234325185634, -5170.356074540894, -9579.561368313989, -4266.697097171479, -6777.06979893104, -8487.11039203152, -9091.5286974087, -4792.965164371598, -6299.9540000045245, -4112.103019213166, -9278.498982227102, -10163.80403132328, -7306.571708822527, -10442.628892470568, -7554.07170539783, -6653.591477914773, -6385.8764002568705, -3494.0094409054677, -4345.586508169215, -5136.815443596856, -8039.609721314112, -3748.348681740695, -6555.788781477172, -5591.181432739756, -1999.8401064367154, -4862.504372774396, -9594.937078836872, -2566.5530710688176, -10096.266540191813, -8961.031498377286, -11076.124367618702, -57.23704195787148, -148.682738811011, -4645.369289451395, -4516.969234970851, -4076.617777589969, -9541.101496519224, -10267.245766905286, -5134.563107013963, -6745.951420633378, -7281.141807639705, -3358.1020233208883, -2643.2357267265515, -2812.2843039072673, -4883.652512568775, -8004.478806820998, -5070.365240115802, -5630.292160711417, -9275.36907490956, -4720.874956660707, -8606.957424692235, -3151.887908665234, -8102.614825697476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40364264032938507, "mean_inference_ms": 0.9824845023166187, "mean_action_processing_ms": 0.1689694629945838, "mean_env_wait_ms": 0.05144322035272795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037927627563476562, "StateBufferConnector_ms": 0.002439260482788086, "ViewRequirementAgentConnector_ms": 0.06728994846343994}, "num_episodes": 22, "episode_return_max": -148.682738811011, "episode_return_min": -12712.171761312171, "episode_return_mean": -8389.645836518244}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.0597336093813, "num_env_steps_trained_throughput_per_sec": 537.0597336093813, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 7349.709, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7349.675, "sample_time_ms": 724.139, "learn_time_ms": 6614.324, "learn_throughput": 604.748, "synch_weights_time_ms": 10.718}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 85, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-03", "timestamp": 1723232223, "time_this_iter_s": 7.4521729946136475, "time_total_s": 645.2087411880493, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3125dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 645.2087411880493, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 22.827272727272728, "ram_util_percent": 80.18181818181816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8368717053594689, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995620127518972, "policy_loss": -0.0016821305219006414, "vf_loss": 9.98669729232788, "vf_explained_var": 1.9508848587671916e-05, "kl": 0.02094807197378638, "entropy": 1.309798214584589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8174286265300695, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991255169318467, "policy_loss": -0.003186199868777915, "vf_loss": 9.992169278765482, "vf_explained_var": 0.0005398139121040466, "kl": 0.007573620488906585, "entropy": 0.9872380553099214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": -148.682738811011, "episode_reward_min": -12712.171761312171, "episode_reward_mean": -8261.050373061002, "episode_len_mean": 192.34, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19234, "policy_reward_min": {"agent_policy": 57.23704195787148, "adversary_policy": -12712.171761312171}, "policy_reward_max": {"agent_policy": 11315.569506994121, "adversary_policy": -57.23704195787148}, "policy_reward_mean": {"agent_policy": 5279.2269718863, "adversary_policy": -6770.138672473652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-502.0308313342077, -6327.309394153717, -6437.085363469335, -9894.594472409794, -5737.679139982342, -9445.396055155823, -8604.76007783292, -6245.045493362609, -10007.535215555763, -6516.642287303181, -5967.667048584317, -12500.34934491301, -8412.839923335649, -9985.926017743095, -7670.327659424353, -12712.171761312171, -8468.430722874908, -6091.489514318224, -2484.034064399636, -9020.966033938874, -6553.070552478031, -11141.55980046128, -9595.290351355863, -9698.450750924261, -8103.074287622832, -6490.129185273199, -8640.853535239607, -8770.170785082722, -11863.33802040441, -7963.5577489313155, -8277.17265472901, -10802.786189341434, -9827.67736151433, -12387.856005883801, -9128.612478409857, -5734.118338604248, -10003.303759221448, -12342.312662808032, -10584.127040414123, -8773.672202661664, -6238.513390443874, -11092.539192527074, -8285.259269869404, -11019.023349362129, -7018.299670495532, -9873.51738641758, -10212.827145147723, -8799.304056176132, -10238.84955854809, -4389.839659116587, -10619.751100148507, -7117.278380783245, -9579.561368313989, -6777.06979893104, -9141.789266430495, -6871.133498973687, -9278.498982227102, -10163.80403132328, -10442.62889247057, -6997.202242508874, -4479.594439136573, -8225.840550862984, -6555.788781477172, -5591.181432739757, -9594.937078836872, -10096.266540191813, -11076.124367618704, -148.682738811011, -4998.40055425702, -9542.045083054509, -10267.245766905287, -7717.922843381788, -3692.660643989046, -4884.74142292041, -8059.015635732093, -9275.792730319776, -8763.830436000497, -8618.612474418385, -9952.604985116148, -7377.605084032016, -11652.853589832363, -9756.65195785775, -9484.628422928788, -6167.89661474343, -3847.899611818594, -7482.455493357007, -8871.657155976836, -8706.593643607343, -11776.414924670562, -9879.048742800085, -11926.158806770392, -3386.4645643233766, -10639.663240633552, -9683.110463541956, -9022.408265389202, -221.22202761771675, -9250.767295382684, -10984.105375570085, -6684.64762984117, -3891.391516655217], "episode_lengths": [25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 27, 200, 200, 200, 200], "policy_agent_policy_reward": [139.1985583409225, 3759.0365421120473, 5890.690886132228, 2765.57110463371, 2537.288608182011, 8687.739566767752, 7038.091354952131, 6082.9760770761695, 5587.4257595563395, 2929.29732823267, 4705.06668378713, 9233.878779394143, 7245.204130400463, 6681.945285827549, 6642.494805247447, 11315.569506994121, 5083.373301024088, 3281.005810735453, 764.0214622755832, 3059.873659051586, 4988.21187739749, 8991.409703126825, 5050.7623104734985, 7171.806703160407, 7083.283541465899, 6191.785840200159, 5040.327217086838, 7492.157399581493, 9487.329492065448, 2318.235716341755, 2549.279741675232, 9646.48568779954, 8522.77148098214, 8769.3754566015, 4320.077959970584, 2641.659771582487, 7073.672215746422, 2852.643438510876, 10023.785605124467, 3043.67626668322, 2331.9174660080753, 8229.764870383238, 5785.157475856249, 7417.588307249203, 3442.449338302651, 2853.761024342887, 4887.835081220115, 4113.980372573061, 9572.715464886052, 2612.332574926749, 9642.271131696903, 4658.234325185634, 5170.356074540894, 4266.697097171479, 8436.849823009728, 4221.785665402434, 4112.103019213166, 7306.571708822527, 7554.07170539783, 6042.265635662765, 3360.0015099381108, 4950.584614047985, 3748.348681740695, 1999.8401064367154, 4862.504372774396, 2566.5530710688176, 8961.031498377286, 57.23704195787148, 4163.937970165228, 4075.6741910546857, 5134.563107013963, 6309.170384891299, 2308.6771060583874, 2811.1953935556326, 5015.828411204708, 5629.8685053012005, 4564.00194535245, 2635.8902599443327, 8275.758521720429, 3572.0652960601105, 11208.367791034116, 8792.72155330282, 3910.4738352261484, 2213.6931286688514, 2656.1959217183758, 4799.668794949845, 4903.092519534889, 3247.7406116968723, 9999.426746890413, 6090.524098961166, 7975.147143927546, 1630.0409705771156, 6040.865231508713, 6904.280182857095, 5108.501022485616, 141.7567209704543, 4181.243966774289, 6183.790747016391, 5323.300632579316, 2261.938781134153], "policy_adversary_policy_reward": [-139.1985583409225, -502.0308313342077, -5320.463213476515, -4765.882722789233, -5969.230696472304, -6358.545553129259, -9894.594472409795, -2765.57110463371, -5737.679139982343, -2537.288608182011, -8690.449946584615, -9442.685675338962, -8592.83428910452, -7050.017143680533, -6149.836250731461, -6178.185319707316, -10007.53521555576, -5587.4257595563395, -3696.4847095846653, -5749.454905951189, -4705.06668378713, -5967.667048584317, -9233.878779394143, -12500.349344913011, -8357.216662539411, -7300.827391196701, -6681.945285827549, -9985.926017743095, -7638.74283892981, -6674.0796257419925, -12712.171761312171, -11315.569506994121, -5087.146394813706, -8464.65762908529, -4069.0584295357853, -5303.436895517902, -2484.0340643996356, -764.0214622755832, -9020.966033938872, -3059.873659051586, -4988.21187739749, -6553.0705524780315, -8991.409703126825, -11141.55980046128, -9595.290351355863, -5050.7623104734985, -7171.806703160407, -9698.450750924261, -7278.214340720431, -7908.1434883683005, -6336.034111791627, -6345.880913681731, -8065.721126095765, -5615.459626230683, -8770.170785082722, -7492.157399581493, -11863.33802040441, -9487.329492065448, -2318.235716341755, -7963.557748931316, -2587.8179947567946, -8238.634401647449, -9646.48568779954, -10802.786189341434, -9720.28066601594, -8630.168176480527, -12387.856005883801, -8769.3754566015, -4568.928448798918, -8879.761989581519, -5478.4623933439725, -2897.315716842762, -7073.672215746422, -10003.303759221448, -2852.643438510876, -12342.312662808032, -10291.277156728274, -10316.63548881032, -8773.672202661664, -3043.67626668322, -6044.282303193303, -2526.148553258646, -8229.764870383238, -11092.539192527074, -5785.157475856249, -8285.259269869404, -7417.588307249203, -11019.023349362129, -3442.449338302651, -7018.299670495532, -2853.761024342887, -9873.51738641758, -4887.835081220115, -10212.827145147723, -8799.30405617613, -4113.980372573061, -9973.218063731516, -9838.34695970263, -3338.109837268559, -3664.062396774777, -10568.024448746242, -9693.997783099168, -7117.278380783245, -4658.234325185634, -5170.356074540894, -9579.561368313989, -4266.697097171479, -6777.06979893104, -8487.11039203152, -9091.5286974087, -4792.965164371598, -6299.9540000045245, -4112.103019213166, -9278.498982227102, -10163.80403132328, -7306.571708822527, -10442.628892470568, -7554.07170539783, -6653.591477914773, -6385.8764002568705, -3494.0094409054677, -4345.586508169215, -5136.815443596856, -8039.609721314112, -3748.348681740695, -6555.788781477172, -5591.181432739756, -1999.8401064367154, -4862.504372774396, -9594.937078836872, -2566.5530710688176, -10096.266540191813, -8961.031498377286, -11076.124367618702, -57.23704195787148, -148.682738811011, -4645.369289451395, -4516.969234970851, -4076.617777589969, -9541.101496519224, -10267.245766905286, -5134.563107013963, -6745.951420633378, -7281.141807639705, -3358.1020233208883, -2643.2357267265515, -2812.2843039072673, -4883.652512568775, -8004.478806820998, -5070.365240115802, -5630.292160711417, -9275.36907490956, -4720.874956660707, -8606.957424692235, -3151.887908665234, -8102.614825697476, -8275.758521720429, -9952.604985116148, -7354.748252290359, -3594.9221278017667, -11450.35298034496, -11410.868400521518, -9314.43041367498, -9234.943097485602, -3910.4738352261484, -9484.628422928788, -2667.1645906466606, -5714.425152765621, -2982.8567825566583, -3521.2387509803093, -7397.068269763792, -4885.0560185430595, -8726.588006709882, -5048.1616688018485, -8688.977863005251, -3265.3563922989633, -11776.414924670562, -9999.426746890413, -9879.048742800085, -6090.524098961166, -11926.158806770392, -7975.147143927546, -2759.0140806101595, -2257.4914542903384, -6040.865231508713, -10639.663240633552, -6904.280182857095, -9683.110463541956, -5108.501022485616, -9022.408265389202, -208.8500842368393, -154.12866435133168, -9250.767295382682, -4181.243966774289, -10984.105375570083, -6183.790747016391, -6591.120516490752, -5416.827745929733, -2730.7273676991676, -3422.6029300902096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4033856953508269, "mean_inference_ms": 0.982143053309495, "mean_action_processing_ms": 0.16904999887291317, "mean_env_wait_ms": 0.05139845515995642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037255287170410156, "StateBufferConnector_ms": 0.0024591684341430664, "ViewRequirementAgentConnector_ms": 0.06761038303375244}, "num_episodes": 22, "episode_return_max": -148.682738811011, "episode_return_min": -12712.171761312171, "episode_return_mean": -8261.050373061002}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.4320659224696, "num_env_steps_trained_throughput_per_sec": 552.4320659224696, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 7344.991, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7344.957, "sample_time_ms": 724.709, "learn_time_ms": 6608.908, "learn_throughput": 605.244, "synch_weights_time_ms": 10.846}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 86, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-10", "timestamp": 1723232230, "time_this_iter_s": 7.244611978530884, "time_total_s": 652.4533531665802, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 652.4533531665802, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.009999999999998, "ram_util_percent": 80.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8768611805979163, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.018102124333382, "policy_loss": 0.008695983094609498, "vf_loss": 9.99467436869939, "vf_explained_var": 3.669721384843191e-05, "kl": 0.019399858046866333, "entropy": 1.3350199768940607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7542544510156389, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997361841151323, "policy_loss": -0.0024579960320677075, "vf_loss": 9.99738541860429, "vf_explained_var": 0.0006220440385202882, "kl": 0.008114741290500634, "entropy": 0.9433104564903905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "env_runners": {"episode_reward_max": -148.682738811011, "episode_reward_min": -12387.856005883801, "episode_reward_mean": -8306.805366773726, "episode_len_mean": 193.73, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19373, "policy_reward_min": {"agent_policy": 57.23704195787148, "adversary_policy": -12387.856005883801}, "policy_reward_max": {"agent_policy": 11208.367791034116, "adversary_policy": -57.23704195787148}, "policy_reward_mean": {"agent_policy": 5397.289438647239, "adversary_policy": -6852.047402710484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6553.070552478031, -11141.55980046128, -9595.290351355863, -9698.450750924261, -8103.074287622832, -6490.129185273199, -8640.853535239607, -8770.170785082722, -11863.33802040441, -7963.5577489313155, -8277.17265472901, -10802.786189341434, -9827.67736151433, -12387.856005883801, -9128.612478409857, -5734.118338604248, -10003.303759221448, -12342.312662808032, -10584.127040414123, -8773.672202661664, -6238.513390443874, -11092.539192527074, -8285.259269869404, -11019.023349362129, -7018.299670495532, -9873.51738641758, -10212.827145147723, -8799.304056176132, -10238.84955854809, -4389.839659116587, -10619.751100148507, -7117.278380783245, -9579.561368313989, -6777.06979893104, -9141.789266430495, -6871.133498973687, -9278.498982227102, -10163.80403132328, -10442.62889247057, -6997.202242508874, -4479.594439136573, -8225.840550862984, -6555.788781477172, -5591.181432739757, -9594.937078836872, -10096.266540191813, -11076.124367618704, -148.682738811011, -4998.40055425702, -9542.045083054509, -10267.245766905287, -7717.922843381788, -3692.660643989046, -4884.74142292041, -8059.015635732093, -9275.792730319776, -8763.830436000497, -8618.612474418385, -9952.604985116148, -7377.605084032016, -11652.853589832363, -9756.65195785775, -9484.628422928788, -6167.89661474343, -3847.899611818594, -7482.455493357007, -8871.657155976836, -8706.593643607343, -11776.414924670562, -9879.048742800085, -11926.158806770392, -3386.4645643233766, -10639.663240633552, -9683.110463541956, -9022.408265389202, -221.22202761771675, -9250.767295382684, -10984.105375570085, -6684.64762984117, -3891.391516655217, -9888.429500814675, -8197.177997787241, -5762.49872970849, -222.6000419796381, -7805.78740442809, -9073.00170679486, -9025.009233313624, -9504.534773006055, -9463.707560396526, -7516.76170797051, -7703.234653402318, -9558.681145134133, -10863.39367356838, -9031.380667901807, -7330.441390429384, -5484.259352357347, -9825.310643557576, -5655.827221994607, -8938.281974262472, -6757.460413868706], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4988.21187739749, 8991.409703126825, 5050.7623104734985, 7171.806703160407, 7083.283541465899, 6191.785840200159, 5040.327217086838, 7492.157399581493, 9487.329492065448, 2318.235716341755, 2549.279741675232, 9646.48568779954, 8522.77148098214, 8769.3754566015, 4320.077959970584, 2641.659771582487, 7073.672215746422, 2852.643438510876, 10023.785605124467, 3043.67626668322, 2331.9174660080753, 8229.764870383238, 5785.157475856249, 7417.588307249203, 3442.449338302651, 2853.761024342887, 4887.835081220115, 4113.980372573061, 9572.715464886052, 2612.332574926749, 9642.271131696903, 4658.234325185634, 5170.356074540894, 4266.697097171479, 8436.849823009728, 4221.785665402434, 4112.103019213166, 7306.571708822527, 7554.07170539783, 6042.265635662765, 3360.0015099381108, 4950.584614047985, 3748.348681740695, 1999.8401064367154, 4862.504372774396, 2566.5530710688176, 8961.031498377286, 57.23704195787148, 4163.937970165228, 4075.6741910546857, 5134.563107013963, 6309.170384891299, 2308.6771060583874, 2811.1953935556326, 5015.828411204708, 5629.8685053012005, 4564.00194535245, 2635.8902599443327, 8275.758521720429, 3572.0652960601105, 11208.367791034116, 8792.72155330282, 3910.4738352261484, 2213.6931286688514, 2656.1959217183758, 4799.668794949845, 4903.092519534889, 3247.7406116968723, 9999.426746890413, 6090.524098961166, 7975.147143927546, 1630.0409705771156, 6040.865231508713, 6904.280182857095, 5108.501022485616, 141.7567209704543, 4181.243966774289, 6183.790747016391, 5323.300632579316, 2261.938781134153, 8981.043929763944, 6892.839711387194, 1826.1727335193668, 172.98403293528904, 4604.987334747908, 8009.483225073197, 8818.434228785285, 5694.74477144662, 6814.101103212706, 7016.950447130811, 7121.341699174047, 5077.222410822442, 10478.919661688684, 6489.080350500194, 2751.644909328759, 4533.156211863879, 3568.6474474655156, 5006.378809722858, 6517.473817798162, 4860.389050450688], "policy_adversary_policy_reward": [-4988.21187739749, -6553.0705524780315, -8991.409703126825, -11141.55980046128, -9595.290351355863, -5050.7623104734985, -7171.806703160407, -9698.450750924261, -7278.214340720431, -7908.1434883683005, -6336.034111791627, -6345.880913681731, -8065.721126095765, -5615.459626230683, -8770.170785082722, -7492.157399581493, -11863.33802040441, -9487.329492065448, -2318.235716341755, -7963.557748931316, -2587.8179947567946, -8238.634401647449, -9646.48568779954, -10802.786189341434, -9720.28066601594, -8630.168176480527, -12387.856005883801, -8769.3754566015, -4568.928448798918, -8879.761989581519, -5478.4623933439725, -2897.315716842762, -7073.672215746422, -10003.303759221448, -2852.643438510876, -12342.312662808032, -10291.277156728274, -10316.63548881032, -8773.672202661664, -3043.67626668322, -6044.282303193303, -2526.148553258646, -8229.764870383238, -11092.539192527074, -5785.157475856249, -8285.259269869404, -7417.588307249203, -11019.023349362129, -3442.449338302651, -7018.299670495532, -2853.761024342887, -9873.51738641758, -4887.835081220115, -10212.827145147723, -8799.30405617613, -4113.980372573061, -9973.218063731516, -9838.34695970263, -3338.109837268559, -3664.062396774777, -10568.024448746242, -9693.997783099168, -7117.278380783245, -4658.234325185634, -5170.356074540894, -9579.561368313989, -4266.697097171479, -6777.06979893104, -8487.11039203152, -9091.5286974087, -4792.965164371598, -6299.9540000045245, -4112.103019213166, -9278.498982227102, -10163.80403132328, -7306.571708822527, -10442.628892470568, -7554.07170539783, -6653.591477914773, -6385.8764002568705, -3494.0094409054677, -4345.586508169215, -5136.815443596856, -8039.609721314112, -3748.348681740695, -6555.788781477172, -5591.181432739756, -1999.8401064367154, -4862.504372774396, -9594.937078836872, -2566.5530710688176, -10096.266540191813, -8961.031498377286, -11076.124367618702, -57.23704195787148, -148.682738811011, -4645.369289451395, -4516.969234970851, -4076.617777589969, -9541.101496519224, -10267.245766905286, -5134.563107013963, -6745.951420633378, -7281.141807639705, -3358.1020233208883, -2643.2357267265515, -2812.2843039072673, -4883.652512568775, -8004.478806820998, -5070.365240115802, -5630.292160711417, -9275.36907490956, -4720.874956660707, -8606.957424692235, -3151.887908665234, -8102.614825697476, -8275.758521720429, -9952.604985116148, -7354.748252290359, -3594.9221278017667, -11450.35298034496, -11410.868400521518, -9314.43041367498, -9234.943097485602, -3910.4738352261484, -9484.628422928788, -2667.1645906466606, -5714.425152765621, -2982.8567825566583, -3521.2387509803093, -7397.068269763792, -4885.0560185430595, -8726.588006709882, -5048.1616688018485, -8688.977863005251, -3265.3563922989633, -11776.414924670562, -9999.426746890413, -9879.048742800085, -6090.524098961166, -11926.158806770392, -7975.147143927546, -2759.0140806101595, -2257.4914542903384, -6040.865231508713, -10639.663240633552, -6904.280182857095, -9683.110463541956, -5108.501022485616, -9022.408265389202, -208.8500842368393, -154.12866435133168, -9250.767295382682, -4181.243966774289, -10984.105375570083, -6183.790747016391, -6591.120516490752, -5416.827745929733, -2730.7273676991676, -3422.6029300902096, -9039.161517641112, -9830.311912937515, -6908.761391210963, -8181.2563179634735, -5287.166791771748, -2301.5046714561054, -172.98403293528904, -222.6000419796381, -4882.246314672042, -7528.528424503956, -9073.00170679486, -8009.483225073197, -8840.36143863723, -9003.08202346168, -9396.08630858264, -5803.193235870036, -9337.089934802316, -6940.718728806919, -7508.183715703322, -7025.528439397998, -7683.753765908975, -7140.822586667387, -9558.681145134133, -5077.222410822442, -10527.322200012759, -10814.991135244303, -8886.57218943139, -6633.888828970609, -3053.5622847340396, -7028.524015024102, -4645.605210231426, -5371.810353989798, -9825.310643557576, -3568.6474474655156, -5630.54450698412, -5031.661524733343, -8691.621239892294, -6764.134552168338, -6749.359494360033, -4868.489969959361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40310834365315473, "mean_inference_ms": 0.9804590069998766, "mean_action_processing_ms": 0.16881466140611695, "mean_env_wait_ms": 0.05137577413160832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032500028610229492, "StateBufferConnector_ms": 0.0024242401123046875, "ViewRequirementAgentConnector_ms": 0.0674828290939331}, "num_episodes": 20, "episode_return_max": -148.682738811011, "episode_return_min": -12387.856005883801, "episode_return_mean": -8306.805366773726}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.1268564017413, "num_env_steps_trained_throughput_per_sec": 518.1268564017413, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 7390.922, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7390.886, "sample_time_ms": 724.503, "learn_time_ms": 6654.552, "learn_throughput": 601.092, "synch_weights_time_ms": 11.263}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "training_iteration": 87, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-18", "timestamp": 1723232238, "time_this_iter_s": 7.748301267623901, "time_total_s": 660.2016544342041, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3125e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 660.2016544342041, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.354545454545452, "ram_util_percent": 80.86363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.860738889593631, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.021931926409403, "policy_loss": 0.006927616391233945, "vf_loss": 10.0, "vf_explained_var": 2.130406598250071e-05, "kl": 0.019758748119541755, "entropy": 1.3348482164243858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7568480728401078, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999256412062065, "policy_loss": -0.002569415241420742, "vf_loss": 10.0, "vf_explained_var": 0.0009761224032709838, "kl": 0.006086079633878494, "entropy": 0.9259119102879176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": -148.682738811011, "episode_reward_min": -11926.158806770392, "episode_reward_mean": -8069.04051579215, "episode_len_mean": 193.73, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19373, "policy_reward_min": {"agent_policy": 57.23704195787148, "adversary_policy": -11926.158806770392}, "policy_reward_max": {"agent_policy": 11208.367791034116, "adversary_policy": -57.23704195787148}, "policy_reward_mean": {"agent_policy": 5166.024504877997, "adversary_policy": -6617.532510335073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8773.672202661664, -6238.513390443874, -11092.539192527074, -8285.259269869404, -11019.023349362129, -7018.299670495532, -9873.51738641758, -10212.827145147723, -8799.304056176132, -10238.84955854809, -4389.839659116587, -10619.751100148507, -7117.278380783245, -9579.561368313989, -6777.06979893104, -9141.789266430495, -6871.133498973687, -9278.498982227102, -10163.80403132328, -10442.62889247057, -6997.202242508874, -4479.594439136573, -8225.840550862984, -6555.788781477172, -5591.181432739757, -9594.937078836872, -10096.266540191813, -11076.124367618704, -148.682738811011, -4998.40055425702, -9542.045083054509, -10267.245766905287, -7717.922843381788, -3692.660643989046, -4884.74142292041, -8059.015635732093, -9275.792730319776, -8763.830436000497, -8618.612474418385, -9952.604985116148, -7377.605084032016, -11652.853589832363, -9756.65195785775, -9484.628422928788, -6167.89661474343, -3847.899611818594, -7482.455493357007, -8871.657155976836, -8706.593643607343, -11776.414924670562, -9879.048742800085, -11926.158806770392, -3386.4645643233766, -10639.663240633552, -9683.110463541956, -9022.408265389202, -221.22202761771675, -9250.767295382684, -10984.105375570085, -6684.64762984117, -3891.391516655217, -9888.429500814675, -8197.177997787241, -5762.49872970849, -222.6000419796381, -7805.78740442809, -9073.00170679486, -9025.009233313624, -9504.534773006055, -9463.707560396526, -7516.76170797051, -7703.234653402318, -9558.681145134133, -10863.39367356838, -9031.380667901807, -7330.441390429384, -5484.259352357347, -9825.310643557576, -5655.827221994607, -8938.281974262472, -6757.460413868706, -8747.535228011473, -9318.531311132156, -5578.633392390786, -5176.158888403049, -8306.485812707702, -6256.325566313825, -10485.63336993552, -6800.209741855978, -8679.016324254286, -6349.39964863449, -8990.562268504003, -6118.774944026484, -9055.814826709939, -7145.293269165891, -8380.435324415357, -11425.69139920648, -10844.114757112891, -9198.003352228317, -7274.356985533372], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 138, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3043.67626668322, 2331.9174660080753, 8229.764870383238, 5785.157475856249, 7417.588307249203, 3442.449338302651, 2853.761024342887, 4887.835081220115, 4113.980372573061, 9572.715464886052, 2612.332574926749, 9642.271131696903, 4658.234325185634, 5170.356074540894, 4266.697097171479, 8436.849823009728, 4221.785665402434, 4112.103019213166, 7306.571708822527, 7554.07170539783, 6042.265635662765, 3360.0015099381108, 4950.584614047985, 3748.348681740695, 1999.8401064367154, 4862.504372774396, 2566.5530710688176, 8961.031498377286, 57.23704195787148, 4163.937970165228, 4075.6741910546857, 5134.563107013963, 6309.170384891299, 2308.6771060583874, 2811.1953935556326, 5015.828411204708, 5629.8685053012005, 4564.00194535245, 2635.8902599443327, 8275.758521720429, 3572.0652960601105, 11208.367791034116, 8792.72155330282, 3910.4738352261484, 2213.6931286688514, 2656.1959217183758, 4799.668794949845, 4903.092519534889, 3247.7406116968723, 9999.426746890413, 6090.524098961166, 7975.147143927546, 1630.0409705771156, 6040.865231508713, 6904.280182857095, 5108.501022485616, 141.7567209704543, 4181.243966774289, 6183.790747016391, 5323.300632579316, 2261.938781134153, 8981.043929763944, 6892.839711387194, 1826.1727335193668, 172.98403293528904, 4604.987334747908, 8009.483225073197, 8818.434228785285, 5694.74477144662, 6814.101103212706, 7016.950447130811, 7121.341699174047, 5077.222410822442, 10478.919661688684, 6489.080350500194, 2751.644909328759, 4533.156211863879, 3568.6474474655156, 5006.378809722858, 6517.473817798162, 4860.389050450688, 1896.6128231985285, 8854.6882442403, 3482.0715812256053, 3423.391867430382, 4451.501223578104, 5287.178214482227, 2427.834300448678, 3607.1042410121895, 2590.825206807583, 4537.806256684949, 5277.186137579557, 5168.139377076788, 8682.271164983222, 4750.389428723689, 4669.855259852729, 9578.126298936606, 4320.257536846638, 7751.671544202723, 6331.657074658328], "policy_adversary_policy_reward": [-8773.672202661664, -3043.67626668322, -6044.282303193303, -2526.148553258646, -8229.764870383238, -11092.539192527074, -5785.157475856249, -8285.259269869404, -7417.588307249203, -11019.023349362129, -3442.449338302651, -7018.299670495532, -2853.761024342887, -9873.51738641758, -4887.835081220115, -10212.827145147723, -8799.30405617613, -4113.980372573061, -9973.218063731516, -9838.34695970263, -3338.109837268559, -3664.062396774777, -10568.024448746242, -9693.997783099168, -7117.278380783245, -4658.234325185634, -5170.356074540894, -9579.561368313989, -4266.697097171479, -6777.06979893104, -8487.11039203152, -9091.5286974087, -4792.965164371598, -6299.9540000045245, -4112.103019213166, -9278.498982227102, -10163.80403132328, -7306.571708822527, -10442.628892470568, -7554.07170539783, -6653.591477914773, -6385.8764002568705, -3494.0094409054677, -4345.586508169215, -5136.815443596856, -8039.609721314112, -3748.348681740695, -6555.788781477172, -5591.181432739756, -1999.8401064367154, -4862.504372774396, -9594.937078836872, -2566.5530710688176, -10096.266540191813, -8961.031498377286, -11076.124367618702, -57.23704195787148, -148.682738811011, -4645.369289451395, -4516.969234970851, -4076.617777589969, -9541.101496519224, -10267.245766905286, -5134.563107013963, -6745.951420633378, -7281.141807639705, -3358.1020233208883, -2643.2357267265515, -2812.2843039072673, -4883.652512568775, -8004.478806820998, -5070.365240115802, -5630.292160711417, -9275.36907490956, -4720.874956660707, -8606.957424692235, -3151.887908665234, -8102.614825697476, -8275.758521720429, -9952.604985116148, -7354.748252290359, -3594.9221278017667, -11450.35298034496, -11410.868400521518, -9314.43041367498, -9234.943097485602, -3910.4738352261484, -9484.628422928788, -2667.1645906466606, -5714.425152765621, -2982.8567825566583, -3521.2387509803093, -7397.068269763792, -4885.0560185430595, -8726.588006709882, -5048.1616688018485, -8688.977863005251, -3265.3563922989633, -11776.414924670562, -9999.426746890413, -9879.048742800085, -6090.524098961166, -11926.158806770392, -7975.147143927546, -2759.0140806101595, -2257.4914542903384, -6040.865231508713, -10639.663240633552, -6904.280182857095, -9683.110463541956, -5108.501022485616, -9022.408265389202, -208.8500842368393, -154.12866435133168, -9250.767295382682, -4181.243966774289, -10984.105375570083, -6183.790747016391, -6591.120516490752, -5416.827745929733, -2730.7273676991676, -3422.6029300902096, -9039.161517641112, -9830.311912937515, -6908.761391210963, -8181.2563179634735, -5287.166791771748, -2301.5046714561054, -172.98403293528904, -222.6000419796381, -4882.246314672042, -7528.528424503956, -9073.00170679486, -8009.483225073197, -8840.36143863723, -9003.08202346168, -9396.08630858264, -5803.193235870036, -9337.089934802316, -6940.718728806919, -7508.183715703322, -7025.528439397998, -7683.753765908975, -7140.822586667387, -9558.681145134133, -5077.222410822442, -10527.322200012759, -10814.991135244303, -8886.57218943139, -6633.888828970609, -3053.5622847340396, -7028.524015024102, -4645.605210231426, -5371.810353989798, -9825.310643557576, -3568.6474474655156, -5630.54450698412, -5031.661524733343, -8691.621239892294, -6764.134552168338, -6749.359494360033, -4868.489969959361, -8737.976193560507, -1906.1718576494945, -9003.234633733926, -9169.984921638525, -3540.2746065371657, -5520.430367079226, -5156.020240404534, -3443.530515428896, -8306.485812707702, -4451.501223578104, -5409.241315452401, -6134.26246534365, -2427.834300448678, -10485.63336993552, -4197.729148086796, -6209.584834781374, -3209.9995227268646, -8059.8420083350065, -5276.949156393805, -5610.256748925632, -5389.245222733054, -8878.503183350509, -5808.055815685788, -5478.858505417485, -8763.406857388116, -8974.679134305044, -4825.632321745431, -7070.05037614415, -4970.8636501994315, -8079.426934068656, -11425.691399206476, -9578.126298936606, -10844.114757112891, -4320.257536846638, -8966.769789034386, -7982.905107396646, -7254.723385697659, -6351.29067449404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4029151018479855, "mean_inference_ms": 0.9796227635761332, "mean_action_processing_ms": 0.16869190049215937, "mean_env_wait_ms": 0.05134907360738457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033049583435058594, "StateBufferConnector_ms": 0.0024224519729614258, "ViewRequirementAgentConnector_ms": 0.06930398941040039}, "num_episodes": 19, "episode_return_max": -148.682738811011, "episode_return_min": -11926.158806770392, "episode_return_mean": -8069.04051579215}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.1311184756463, "num_env_steps_trained_throughput_per_sec": 534.1311184756463, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 7361.457, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7361.421, "sample_time_ms": 723.185, "learn_time_ms": 6626.399, "learn_throughput": 603.646, "synch_weights_time_ms": 11.275}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 88, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-26", "timestamp": 1723232246, "time_this_iter_s": 7.493326902389526, "time_total_s": 667.6949813365936, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 667.6949813365936, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 29.318181818181824, "ram_util_percent": 80.98181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8570134128909558, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.011532641450565, "policy_loss": 0.009869433010559684, "vf_loss": 9.985622901717822, "vf_explained_var": 3.881274412075679e-05, "kl": 0.021123084267795397, "entropy": 1.3112968560308218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7425028729375708, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991555907234313, "policy_loss": -0.0032090660679848894, "vf_loss": 9.992930788211721, "vf_explained_var": -7.1916946027644724e-06, "kl": 0.006113887987119299, "entropy": 0.8647068553185336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "env_runners": {"episode_reward_max": -148.682738811011, "episode_reward_min": -11926.158806770392, "episode_reward_mean": -7791.558512220535, "episode_len_mean": 189.59, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18959, "policy_reward_min": {"agent_policy": 31.501133047168675, "adversary_policy": -11926.158806770392}, "policy_reward_max": {"agent_policy": 11208.367791034116, "adversary_policy": -31.501133047168675}, "policy_reward_mean": {"agent_policy": 4942.446034938188, "adversary_policy": -6367.002273579361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6555.788781477172, -5591.181432739757, -9594.937078836872, -10096.266540191813, -11076.124367618704, -148.682738811011, -4998.40055425702, -9542.045083054509, -10267.245766905287, -7717.922843381788, -3692.660643989046, -4884.74142292041, -8059.015635732093, -9275.792730319776, -8763.830436000497, -8618.612474418385, -9952.604985116148, -7377.605084032016, -11652.853589832363, -9756.65195785775, -9484.628422928788, -6167.89661474343, -3847.899611818594, -7482.455493357007, -8871.657155976836, -8706.593643607343, -11776.414924670562, -9879.048742800085, -11926.158806770392, -3386.4645643233766, -10639.663240633552, -9683.110463541956, -9022.408265389202, -221.22202761771675, -9250.767295382684, -10984.105375570085, -6684.64762984117, -3891.391516655217, -9888.429500814675, -8197.177997787241, -5762.49872970849, -222.6000419796381, -7805.78740442809, -9073.00170679486, -9025.009233313624, -9504.534773006055, -9463.707560396526, -7516.76170797051, -7703.234653402318, -9558.681145134133, -10863.39367356838, -9031.380667901807, -7330.441390429384, -5484.259352357347, -9825.310643557576, -5655.827221994607, -8938.281974262472, -6757.460413868706, -8747.535228011473, -9318.531311132156, -5578.633392390786, -5176.158888403049, -8306.485812707702, -6256.325566313825, -10485.63336993552, -6800.209741855978, -8679.016324254286, -6349.39964863449, -8990.562268504003, -6118.774944026484, -9055.814826709939, -7145.293269165891, -8380.435324415357, -11425.69139920648, -10844.114757112891, -9198.003352228317, -7274.356985533372, -9204.10523498697, -8223.368164246138, -5412.121941578884, -10361.902862129667, -9143.79711145729, -1425.639910402938, -9900.736005407183, -9419.96870833279, -9581.412542780543, -450.9440827661459, -2286.4625302018653, -8507.362639382643, -9650.583798049449, -6783.488433877572, -8746.74968747051, -6060.38500742337, -3410.7660935141976, -7610.830079983193, -8978.967145891103, -5563.5635625819905, -9242.557202912158, -9648.734845138422, -8273.149485199607], "episode_lengths": [200, 138, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 8, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3748.348681740695, 1999.8401064367154, 4862.504372774396, 2566.5530710688176, 8961.031498377286, 57.23704195787148, 4163.937970165228, 4075.6741910546857, 5134.563107013963, 6309.170384891299, 2308.6771060583874, 2811.1953935556326, 5015.828411204708, 5629.8685053012005, 4564.00194535245, 2635.8902599443327, 8275.758521720429, 3572.0652960601105, 11208.367791034116, 8792.72155330282, 3910.4738352261484, 2213.6931286688514, 2656.1959217183758, 4799.668794949845, 4903.092519534889, 3247.7406116968723, 9999.426746890413, 6090.524098961166, 7975.147143927546, 1630.0409705771156, 6040.865231508713, 6904.280182857095, 5108.501022485616, 141.7567209704543, 4181.243966774289, 6183.790747016391, 5323.300632579316, 2261.938781134153, 8981.043929763944, 6892.839711387194, 1826.1727335193668, 172.98403293528904, 4604.987334747908, 8009.483225073197, 8818.434228785285, 5694.74477144662, 6814.101103212706, 7016.950447130811, 7121.341699174047, 5077.222410822442, 10478.919661688684, 6489.080350500194, 2751.644909328759, 4533.156211863879, 3568.6474474655156, 5006.378809722858, 6517.473817798162, 4860.389050450688, 1896.6128231985285, 8854.6882442403, 3482.0715812256053, 3423.391867430382, 4451.501223578104, 5287.178214482227, 2427.834300448678, 3607.1042410121895, 2590.825206807583, 4537.806256684949, 5277.186137579557, 5168.139377076788, 8682.271164983222, 4750.389428723689, 4669.855259852729, 9578.126298936606, 4320.257536846638, 7751.671544202723, 6331.657074658328, 6102.810027162135, 7017.07241295113, 3590.380146512955, 7885.7117700096815, 6135.875242041353, 418.4786776971421, 1308.642339446457, 6094.690619365738, 8777.300426363356, 31.501133047168675, 886.4288655712303, 4525.739497899361, 6784.652648147841, 5417.9499255787105, 7035.005601613025, 3794.2235125508264, 2992.3454407913446, 6757.638922655644, 1602.8850756086297, 4024.1412764642732, 5209.116995598012, 4041.956989504986, 1220.5760119589718], "policy_adversary_policy_reward": [-3748.348681740695, -6555.788781477172, -5591.181432739756, -1999.8401064367154, -4862.504372774396, -9594.937078836872, -2566.5530710688176, -10096.266540191813, -8961.031498377286, -11076.124367618702, -57.23704195787148, -148.682738811011, -4645.369289451395, -4516.969234970851, -4076.617777589969, -9541.101496519224, -10267.245766905286, -5134.563107013963, -6745.951420633378, -7281.141807639705, -3358.1020233208883, -2643.2357267265515, -2812.2843039072673, -4883.652512568775, -8004.478806820998, -5070.365240115802, -5630.292160711417, -9275.36907490956, -4720.874956660707, -8606.957424692235, -3151.887908665234, -8102.614825697476, -8275.758521720429, -9952.604985116148, -7354.748252290359, -3594.9221278017667, -11450.35298034496, -11410.868400521518, -9314.43041367498, -9234.943097485602, -3910.4738352261484, -9484.628422928788, -2667.1645906466606, -5714.425152765621, -2982.8567825566583, -3521.2387509803093, -7397.068269763792, -4885.0560185430595, -8726.588006709882, -5048.1616688018485, -8688.977863005251, -3265.3563922989633, -11776.414924670562, -9999.426746890413, -9879.048742800085, -6090.524098961166, -11926.158806770392, -7975.147143927546, -2759.0140806101595, -2257.4914542903384, -6040.865231508713, -10639.663240633552, -6904.280182857095, -9683.110463541956, -5108.501022485616, -9022.408265389202, -208.8500842368393, -154.12866435133168, -9250.767295382682, -4181.243966774289, -10984.105375570083, -6183.790747016391, -6591.120516490752, -5416.827745929733, -2730.7273676991676, -3422.6029300902096, -9039.161517641112, -9830.311912937515, -6908.761391210963, -8181.2563179634735, -5287.166791771748, -2301.5046714561054, -172.98403293528904, -222.6000419796381, -4882.246314672042, -7528.528424503956, -9073.00170679486, -8009.483225073197, -8840.36143863723, -9003.08202346168, -9396.08630858264, -5803.193235870036, -9337.089934802316, -6940.718728806919, -7508.183715703322, -7025.528439397998, -7683.753765908975, -7140.822586667387, -9558.681145134133, -5077.222410822442, -10527.322200012759, -10814.991135244303, -8886.57218943139, -6633.888828970609, -3053.5622847340396, -7028.524015024102, -4645.605210231426, -5371.810353989798, -9825.310643557576, -3568.6474474655156, -5630.54450698412, -5031.661524733343, -8691.621239892294, -6764.134552168338, -6749.359494360033, -4868.489969959361, -8737.976193560507, -1906.1718576494945, -9003.234633733926, -9169.984921638525, -3540.2746065371657, -5520.430367079226, -5156.020240404534, -3443.530515428896, -8306.485812707702, -4451.501223578104, -5409.241315452401, -6134.26246534365, -2427.834300448678, -10485.63336993552, -4197.729148086796, -6209.584834781374, -3209.9995227268646, -8059.8420083350065, -5276.949156393805, -5610.256748925632, -5389.245222733054, -8878.503183350509, -5808.055815685788, -5478.858505417485, -8763.406857388116, -8974.679134305044, -4825.632321745431, -7070.05037614415, -4970.8636501994315, -8079.426934068656, -11425.691399206476, -9578.126298936606, -10844.114757112891, -4320.257536846638, -8966.769789034386, -7982.905107396646, -7254.723385697659, -6351.29067449404, -9203.978422805661, -6102.936839343442, -8180.364424177025, -7060.0761530202435, -4587.636930778907, -4414.865157312926, -7896.766859791457, -10350.84777234789, -6135.875242041353, -9143.79711145729, -418.4786776971421, -1425.639910402938, -9900.736005407185, -1308.642339446457, -6094.9714005465175, -9419.68792715201, -9581.412542780543, -8777.300426363356, -31.501133047168675, -450.9440827661459, -1256.946461329878, -1915.944934443219, -8507.362639382645, -4525.739497899361, -6784.652648147841, -9650.583798049449, -5446.523842922633, -6754.914516533649, -7126.785872635605, -8654.96941644793, -5981.449169096069, -3873.1593508781275, -3398.532499199456, -3004.5790351060855, -7425.485868676631, -6942.983133962203, -8978.967145891103, -1602.8850756086297, -4720.70027878736, -4867.004560258912, -9242.557202912158, -5209.116995598012, -4041.956989504986, -9648.734845138422, -1220.5760119589718, -8273.149485199607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40259778962379866, "mean_inference_ms": 0.9796608631511374, "mean_action_processing_ms": 0.16867597330359074, "mean_env_wait_ms": 0.05131716608631684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003313422203063965, "StateBufferConnector_ms": 0.002523660659790039, "ViewRequirementAgentConnector_ms": 0.06972396373748779}, "num_episodes": 23, "episode_return_max": -148.682738811011, "episode_return_min": -11926.158806770392, "episode_return_mean": -7791.558512220535}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 562.6721960339852, "num_env_steps_trained_throughput_per_sec": 562.6721960339852, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 7347.144, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7347.109, "sample_time_ms": 728.681, "learn_time_ms": 6606.546, "learn_throughput": 605.46, "synch_weights_time_ms": 11.294}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "training_iteration": 89, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-33", "timestamp": 1723232253, "time_this_iter_s": 7.113363981246948, "time_total_s": 674.8083453178406, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31194c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 674.8083453178406, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 23.509999999999998, "ram_util_percent": 81.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8866117341133456, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.02034633954366, "policy_loss": 0.011920604610349984, "vf_loss": 9.986760014295578, "vf_explained_var": -4.500591506560643e-05, "kl": 0.019020657228732793, "entropy": 1.3135396162668864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7669843418021051, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99242235365368, "policy_loss": -0.002372479268901602, "vf_loss": 9.993303590098385, "vf_explained_var": 0.0007227308220333523, "kl": 0.0049707865880841695, "entropy": 0.9055250992535283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": -221.22202761771675, "episode_reward_min": -11926.158806770392, "episode_reward_mean": -7639.754226640624, "episode_len_mean": 189.39, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18939, "policy_reward_min": {"agent_policy": 31.501133047168675, "adversary_policy": -11926.158806770392}, "policy_reward_max": {"agent_policy": 10478.919661688684, "adversary_policy": -31.501133047168675}, "policy_reward_mean": {"agent_policy": 4913.89082941789, "adversary_policy": -6276.822528029256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6167.89661474343, -3847.899611818594, -7482.455493357007, -8871.657155976836, -8706.593643607343, -11776.414924670562, -9879.048742800085, -11926.158806770392, -3386.4645643233766, -10639.663240633552, -9683.110463541956, -9022.408265389202, -221.22202761771675, -9250.767295382684, -10984.105375570085, -6684.64762984117, -3891.391516655217, -9888.429500814675, -8197.177997787241, -5762.49872970849, -222.6000419796381, -7805.78740442809, -9073.00170679486, -9025.009233313624, -9504.534773006055, -9463.707560396526, -7516.76170797051, -7703.234653402318, -9558.681145134133, -10863.39367356838, -9031.380667901807, -7330.441390429384, -5484.259352357347, -9825.310643557576, -5655.827221994607, -8938.281974262472, -6757.460413868706, -8747.535228011473, -9318.531311132156, -5578.633392390786, -5176.158888403049, -8306.485812707702, -6256.325566313825, -10485.63336993552, -6800.209741855978, -8679.016324254286, -6349.39964863449, -8990.562268504003, -6118.774944026484, -9055.814826709939, -7145.293269165891, -8380.435324415357, -11425.69139920648, -10844.114757112891, -9198.003352228317, -7274.356985533372, -9204.10523498697, -8223.368164246138, -5412.121941578884, -10361.902862129667, -9143.79711145729, -1425.639910402938, -9900.736005407183, -9419.96870833279, -9581.412542780543, -450.9440827661459, -2286.4625302018653, -8507.362639382643, -9650.583798049449, -6783.488433877572, -8746.74968747051, -6060.38500742337, -3410.7660935141976, -7610.830079983193, -8978.967145891103, -5563.5635625819905, -9242.557202912158, -9648.734845138422, -8273.149485199607, -5495.887452105969, -8263.341534344185, -6906.201533783823, -10003.328921422517, -8087.688581058289, -6493.775807341942, -10399.776618781498, -9549.331672631255, -9680.43484825731, -8500.923701044008, -9521.159733234905, -6377.790013737225, -2194.871930100815, -1173.7512056214332, -7964.0702926148115, -8380.426515989102, -7536.317381275544, -2607.5356429195535, -7295.9709488449025, -5780.738788832103, -9713.840888488958], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 166, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 8, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 74, 62, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2213.6931286688514, 2656.1959217183758, 4799.668794949845, 4903.092519534889, 3247.7406116968723, 9999.426746890413, 6090.524098961166, 7975.147143927546, 1630.0409705771156, 6040.865231508713, 6904.280182857095, 5108.501022485616, 141.7567209704543, 4181.243966774289, 6183.790747016391, 5323.300632579316, 2261.938781134153, 8981.043929763944, 6892.839711387194, 1826.1727335193668, 172.98403293528904, 4604.987334747908, 8009.483225073197, 8818.434228785285, 5694.74477144662, 6814.101103212706, 7016.950447130811, 7121.341699174047, 5077.222410822442, 10478.919661688684, 6489.080350500194, 2751.644909328759, 4533.156211863879, 3568.6474474655156, 5006.378809722858, 6517.473817798162, 4860.389050450688, 1896.6128231985285, 8854.6882442403, 3482.0715812256053, 3423.391867430382, 4451.501223578104, 5287.178214482227, 2427.834300448678, 3607.1042410121895, 2590.825206807583, 4537.806256684949, 5277.186137579557, 5168.139377076788, 8682.271164983222, 4750.389428723689, 4669.855259852729, 9578.126298936606, 4320.257536846638, 7751.671544202723, 6331.657074658328, 6102.810027162135, 7017.07241295113, 3590.380146512955, 7885.7117700096815, 6135.875242041353, 418.4786776971421, 1308.642339446457, 6094.690619365738, 8777.300426363356, 31.501133047168675, 886.4288655712303, 4525.739497899361, 6784.652648147841, 5417.9499255787105, 7035.005601613025, 3794.2235125508264, 2992.3454407913446, 6757.638922655644, 1602.8850756086297, 4024.1412764642732, 5209.116995598012, 4041.956989504986, 1220.5760119589718, 4144.554887218988, 2610.847760714483, 5853.1226970294465, 9339.501806073105, 2563.459553044653, 4327.614958410241, 7776.45609015722, 5340.128243228632, 5980.445734027748, 7067.4212891120615, 7684.045140099135, 3213.0043327405456, 1064.9906535801208, 681.2561258792006, 4870.831322918056, 5225.6268062849795, 4615.742934394716, 1462.5670766853048, 6215.574960371788, 4559.322228094773, 3151.6738921463375], "policy_adversary_policy_reward": [-2667.1645906466606, -5714.425152765621, -2982.8567825566583, -3521.2387509803093, -7397.068269763792, -4885.0560185430595, -8726.588006709882, -5048.1616688018485, -8688.977863005251, -3265.3563922989633, -11776.414924670562, -9999.426746890413, -9879.048742800085, -6090.524098961166, -11926.158806770392, -7975.147143927546, -2759.0140806101595, -2257.4914542903384, -6040.865231508713, -10639.663240633552, -6904.280182857095, -9683.110463541956, -5108.501022485616, -9022.408265389202, -208.8500842368393, -154.12866435133168, -9250.767295382682, -4181.243966774289, -10984.105375570083, -6183.790747016391, -6591.120516490752, -5416.827745929733, -2730.7273676991676, -3422.6029300902096, -9039.161517641112, -9830.311912937515, -6908.761391210963, -8181.2563179634735, -5287.166791771748, -2301.5046714561054, -172.98403293528904, -222.6000419796381, -4882.246314672042, -7528.528424503956, -9073.00170679486, -8009.483225073197, -8840.36143863723, -9003.08202346168, -9396.08630858264, -5803.193235870036, -9337.089934802316, -6940.718728806919, -7508.183715703322, -7025.528439397998, -7683.753765908975, -7140.822586667387, -9558.681145134133, -5077.222410822442, -10527.322200012759, -10814.991135244303, -8886.57218943139, -6633.888828970609, -3053.5622847340396, -7028.524015024102, -4645.605210231426, -5371.810353989798, -9825.310643557576, -3568.6474474655156, -5630.54450698412, -5031.661524733343, -8691.621239892294, -6764.134552168338, -6749.359494360033, -4868.489969959361, -8737.976193560507, -1906.1718576494945, -9003.234633733926, -9169.984921638525, -3540.2746065371657, -5520.430367079226, -5156.020240404534, -3443.530515428896, -8306.485812707702, -4451.501223578104, -5409.241315452401, -6134.26246534365, -2427.834300448678, -10485.63336993552, -4197.729148086796, -6209.584834781374, -3209.9995227268646, -8059.8420083350065, -5276.949156393805, -5610.256748925632, -5389.245222733054, -8878.503183350509, -5808.055815685788, -5478.858505417485, -8763.406857388116, -8974.679134305044, -4825.632321745431, -7070.05037614415, -4970.8636501994315, -8079.426934068656, -11425.691399206476, -9578.126298936606, -10844.114757112891, -4320.257536846638, -8966.769789034386, -7982.905107396646, -7254.723385697659, -6351.29067449404, -9203.978422805661, -6102.936839343442, -8180.364424177025, -7060.0761530202435, -4587.636930778907, -4414.865157312926, -7896.766859791457, -10350.84777234789, -6135.875242041353, -9143.79711145729, -418.4786776971421, -1425.639910402938, -9900.736005407185, -1308.642339446457, -6094.9714005465175, -9419.68792715201, -9581.412542780543, -8777.300426363356, -31.501133047168675, -450.9440827661459, -1256.946461329878, -1915.944934443219, -8507.362639382645, -4525.739497899361, -6784.652648147841, -9650.583798049449, -5446.523842922633, -6754.914516533649, -7126.785872635605, -8654.96941644793, -5981.449169096069, -3873.1593508781275, -3398.532499199456, -3004.5790351060855, -7425.485868676631, -6942.983133962203, -8978.967145891103, -1602.8850756086297, -4720.70027878736, -4867.004560258912, -9242.557202912158, -5209.116995598012, -4041.956989504986, -9648.734845138422, -1220.5760119589718, -8273.149485199607, -4151.071285885464, -5489.371053439495, -7882.589338617075, -2991.599956441592, -6906.201533783824, -5853.1226970294465, -9873.86493613516, -9468.965791360455, -7494.834010502419, -3156.314123600521, -6490.154366585676, -4331.236399166509, -7933.702043324981, -10242.530665613738, -5340.128243228632, -9549.331672631255, -9680.434848257311, -5980.445734027748, -7497.964355641176, -8070.380634514893, -9521.159733234905, -7684.045140099135, -6183.503861504938, -3407.290484972831, -2194.8719301008155, -1064.9906535801208, -1096.6533682826098, -758.3539632180236, -4870.831322918056, -7964.0702926148115, -8380.426515989104, -5225.6268062849795, -7536.317381275546, -4615.742934394716, -1467.2638008495655, -2602.838918755292, -7200.1345725630035, -6311.411336653687, -5601.8504748365995, -4738.210542090276, -3155.7020800844225, -9709.812700550872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40240871500557884, "mean_inference_ms": 0.9784395434663952, "mean_action_processing_ms": 0.168559724376408, "mean_env_wait_ms": 0.05130464398168946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033495426177978516, "StateBufferConnector_ms": 0.0025211572647094727, "ViewRequirementAgentConnector_ms": 0.06967413425445557}, "num_episodes": 21, "episode_return_max": -221.22202761771675, "episode_return_min": -11926.158806770392, "episode_return_mean": -7639.754226640624}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 572.6810326503861, "num_env_steps_trained_throughput_per_sec": 572.6810326503861, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 7316.163, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7316.128, "sample_time_ms": 726.119, "learn_time_ms": 6578.217, "learn_throughput": 608.067, "synch_weights_time_ms": 11.2}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 90, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-40", "timestamp": 1723232260, "time_this_iter_s": 6.989097833633423, "time_total_s": 681.797443151474, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a4a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 681.797443151474, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 22.66363636363636, "ram_util_percent": 81.18181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8971744462226828, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.017733633518219, "policy_loss": 0.00364221211396701, "vf_loss": 9.994647740324337, "vf_explained_var": -3.9977083603541055e-05, "kl": 0.017069912113947795, "entropy": 1.2926791379849116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7532060858749208, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993344765617733, "policy_loss": -0.0051593429790859026, "vf_loss": 9.99736554433429, "vf_explained_var": 0.0003657005135975187, "kl": 0.00759038004134757, "entropy": 0.8967308790280075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "env_runners": {"episode_reward_max": -450.9440827661459, "episode_reward_min": -11425.69139920648, "episode_reward_mean": -7564.714994376913, "episode_len_mean": 191.64, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19164, "policy_reward_min": {"agent_policy": 31.501133047168675, "adversary_policy": -11425.691399206476}, "policy_reward_max": {"agent_policy": 10478.919661688684, "adversary_policy": -31.501133047168675}, "policy_reward_mean": {"agent_policy": 4809.660809294604, "adversary_policy": -6187.187901835759}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7805.78740442809, -9073.00170679486, -9025.009233313624, -9504.534773006055, -9463.707560396526, -7516.76170797051, -7703.234653402318, -9558.681145134133, -10863.39367356838, -9031.380667901807, -7330.441390429384, -5484.259352357347, -9825.310643557576, -5655.827221994607, -8938.281974262472, -6757.460413868706, -8747.535228011473, -9318.531311132156, -5578.633392390786, -5176.158888403049, -8306.485812707702, -6256.325566313825, -10485.63336993552, -6800.209741855978, -8679.016324254286, -6349.39964863449, -8990.562268504003, -6118.774944026484, -9055.814826709939, -7145.293269165891, -8380.435324415357, -11425.69139920648, -10844.114757112891, -9198.003352228317, -7274.356985533372, -9204.10523498697, -8223.368164246138, -5412.121941578884, -10361.902862129667, -9143.79711145729, -1425.639910402938, -9900.736005407183, -9419.96870833279, -9581.412542780543, -450.9440827661459, -2286.4625302018653, -8507.362639382643, -9650.583798049449, -6783.488433877572, -8746.74968747051, -6060.38500742337, -3410.7660935141976, -7610.830079983193, -8978.967145891103, -5563.5635625819905, -9242.557202912158, -9648.734845138422, -8273.149485199607, -5495.887452105969, -8263.341534344185, -6906.201533783823, -10003.328921422517, -8087.688581058289, -6493.775807341942, -10399.776618781498, -9549.331672631255, -9680.43484825731, -8500.923701044008, -9521.159733234905, -6377.790013737225, -2194.871930100815, -1173.7512056214332, -7964.0702926148115, -8380.426515989102, -7536.317381275544, -2607.5356429195535, -7295.9709488449025, -5780.738788832103, -9713.840888488958, -8319.394205350565, -7868.395159430901, -7650.051136005618, -9599.64855576076, -7113.846368942484, -5653.917241939586, -8637.467193584996, -8951.74843915637, -2955.9236823093734, -8660.890346340417, -8463.027765467314, -6119.401157484686, -7445.8271454501655, -9680.17775300698, -5109.85111414414, -8909.4572466649, -5881.423624329699, -714.6102329690125, -8801.401039980201, -4980.327180817852, -7471.901827482113], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 8, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 74, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200], "policy_agent_policy_reward": [4604.987334747908, 8009.483225073197, 8818.434228785285, 5694.74477144662, 6814.101103212706, 7016.950447130811, 7121.341699174047, 5077.222410822442, 10478.919661688684, 6489.080350500194, 2751.644909328759, 4533.156211863879, 3568.6474474655156, 5006.378809722858, 6517.473817798162, 4860.389050450688, 1896.6128231985285, 8854.6882442403, 3482.0715812256053, 3423.391867430382, 4451.501223578104, 5287.178214482227, 2427.834300448678, 3607.1042410121895, 2590.825206807583, 4537.806256684949, 5277.186137579557, 5168.139377076788, 8682.271164983222, 4750.389428723689, 4669.855259852729, 9578.126298936606, 4320.257536846638, 7751.671544202723, 6331.657074658328, 6102.810027162135, 7017.07241295113, 3590.380146512955, 7885.7117700096815, 6135.875242041353, 418.4786776971421, 1308.642339446457, 6094.690619365738, 8777.300426363356, 31.501133047168675, 886.4288655712303, 4525.739497899361, 6784.652648147841, 5417.9499255787105, 7035.005601613025, 3794.2235125508264, 2992.3454407913446, 6757.638922655644, 1602.8850756086297, 4024.1412764642732, 5209.116995598012, 4041.956989504986, 1220.5760119589718, 4144.554887218988, 2610.847760714483, 5853.1226970294465, 9339.501806073105, 2563.459553044653, 4327.614958410241, 7776.45609015722, 5340.128243228632, 5980.445734027748, 7067.4212891120615, 7684.045140099135, 3213.0043327405456, 1064.9906535801208, 681.2561258792006, 4870.831322918056, 5225.6268062849795, 4615.742934394716, 1462.5670766853048, 6215.574960371788, 4559.322228094773, 3151.6738921463375, 5482.276751828548, 5383.182978573681, 2396.1541404023906, 6314.039096882452, 5941.8121758703755, 3760.4230907333563, 3944.608636794085, 3574.552146268022, 2030.8412486087025, 5726.07182004211, 3802.688886876125, 1918.8572028777096, 3641.4303530892303, 6103.156301724376, 1839.556267331434, 4101.550961117231, 2983.56793941656, 253.51594059576863, 6669.578644433423, 4402.061976091725, 6841.31905797108], "policy_adversary_policy_reward": [-4882.246314672042, -7528.528424503956, -9073.00170679486, -8009.483225073197, -8840.36143863723, -9003.08202346168, -9396.08630858264, -5803.193235870036, -9337.089934802316, -6940.718728806919, -7508.183715703322, -7025.528439397998, -7683.753765908975, -7140.822586667387, -9558.681145134133, -5077.222410822442, -10527.322200012759, -10814.991135244303, -8886.57218943139, -6633.888828970609, -3053.5622847340396, -7028.524015024102, -4645.605210231426, -5371.810353989798, -9825.310643557576, -3568.6474474655156, -5630.54450698412, -5031.661524733343, -8691.621239892294, -6764.134552168338, -6749.359494360033, -4868.489969959361, -8737.976193560507, -1906.1718576494945, -9003.234633733926, -9169.984921638525, -3540.2746065371657, -5520.430367079226, -5156.020240404534, -3443.530515428896, -8306.485812707702, -4451.501223578104, -5409.241315452401, -6134.26246534365, -2427.834300448678, -10485.63336993552, -4197.729148086796, -6209.584834781374, -3209.9995227268646, -8059.8420083350065, -5276.949156393805, -5610.256748925632, -5389.245222733054, -8878.503183350509, -5808.055815685788, -5478.858505417485, -8763.406857388116, -8974.679134305044, -4825.632321745431, -7070.05037614415, -4970.8636501994315, -8079.426934068656, -11425.691399206476, -9578.126298936606, -10844.114757112891, -4320.257536846638, -8966.769789034386, -7982.905107396646, -7254.723385697659, -6351.29067449404, -9203.978422805661, -6102.936839343442, -8180.364424177025, -7060.0761530202435, -4587.636930778907, -4414.865157312926, -7896.766859791457, -10350.84777234789, -6135.875242041353, -9143.79711145729, -418.4786776971421, -1425.639910402938, -9900.736005407185, -1308.642339446457, -6094.9714005465175, -9419.68792715201, -9581.412542780543, -8777.300426363356, -31.501133047168675, -450.9440827661459, -1256.946461329878, -1915.944934443219, -8507.362639382645, -4525.739497899361, -6784.652648147841, -9650.583798049449, -5446.523842922633, -6754.914516533649, -7126.785872635605, -8654.96941644793, -5981.449169096069, -3873.1593508781275, -3398.532499199456, -3004.5790351060855, -7425.485868676631, -6942.983133962203, -8978.967145891103, -1602.8850756086297, -4720.70027878736, -4867.004560258912, -9242.557202912158, -5209.116995598012, -4041.956989504986, -9648.734845138422, -1220.5760119589718, -8273.149485199607, -4151.071285885464, -5489.371053439495, -7882.589338617075, -2991.599956441592, -6906.201533783824, -5853.1226970294465, -9873.86493613516, -9468.965791360455, -7494.834010502419, -3156.314123600521, -6490.154366585676, -4331.236399166509, -7933.702043324981, -10242.530665613738, -5340.128243228632, -9549.331672631255, -9680.434848257311, -5980.445734027748, -7497.964355641176, -8070.380634514893, -9521.159733234905, -7684.045140099135, -6183.503861504938, -3407.290484972831, -2194.8719301008155, -1064.9906535801208, -1096.6533682826098, -758.3539632180236, -4870.831322918056, -7964.0702926148115, -8380.426515989104, -5225.6268062849795, -7536.317381275546, -4615.742934394716, -1467.2638008495655, -2602.838918755292, -7200.1345725630035, -6311.411336653687, -5601.8504748365995, -4738.210542090276, -3155.7020800844225, -9709.812700550872, -5498.136854768127, -8303.534102410986, -7868.395159430901, -5383.182978573681, -7650.051136005618, -2396.1541404023906, -6314.039096882452, -9599.648555760765, -7081.44122663257, -5974.217318180291, -3771.1431179392694, -5643.197214733674, -3949.629420851771, -8632.44640952731, -8951.74843915637, -3574.552146268022, -2623.129314758795, -2363.635616159285, -7160.033179817615, -7226.928986564907, -3802.688886876125, -8463.027765467314, -1918.8572028777096, -6119.401157484686, -7445.8271454501655, -3641.4303530892303, -6103.156301724376, -9680.17775300698, -5109.851114144142, -1839.556267331434, -4101.550961117231, -8909.4572466649, -2983.56793941656, -5881.423624329699, -514.8442479394029, -453.2819256253785, -6956.4144260489375, -8514.56525836468, -4409.441242378282, -4972.947914531296, -6841.426487632915, -7471.79439782028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4022151901535787, "mean_inference_ms": 0.9778457309328905, "mean_action_processing_ms": 0.16844477239156558, "mean_env_wait_ms": 0.05128784557131895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034117698669433594, "StateBufferConnector_ms": 0.0025855302810668945, "ViewRequirementAgentConnector_ms": 0.07031738758087158}, "num_episodes": 21, "episode_return_max": -450.9440827661459, "episode_return_min": -11425.69139920648, "episode_return_mean": -7564.714994376913}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 520.0266255659676, "num_env_steps_trained_throughput_per_sec": 520.0266255659676, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 7376.045, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7376.011, "sample_time_ms": 732.326, "learn_time_ms": 6631.727, "learn_throughput": 603.161, "synch_weights_time_ms": 11.363}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "training_iteration": 91, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-48", "timestamp": 1723232268, "time_this_iter_s": 7.697067975997925, "time_total_s": 689.4945111274719, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 689.4945111274719, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 28.072727272727267, "ram_util_percent": 81.52727272727275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8182268814959873, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.02158716817697, "policy_loss": 0.0074813910803641194, "vf_loss": 9.994292277097703, "vf_explained_var": -8.970250686009725e-06, "kl": 0.017394575949098604, "entropy": 1.273833346615235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7387179988953803, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991776030404226, "policy_loss": -0.006836599168224783, "vf_loss": 9.997266450508562, "vf_explained_var": 0.0004977445123056886, "kl": 0.008974439669622197, "entropy": 0.8512348923418257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": -450.9440827661459, "episode_reward_min": -11425.69139920648, "episode_reward_mean": -7362.256083127947, "episode_len_mean": 190.15, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19015, "policy_reward_min": {"agent_policy": 31.501133047168675, "adversary_policy": -11425.691399206476}, "policy_reward_max": {"agent_policy": 9578.126298936606, "adversary_policy": -31.501133047168675}, "policy_reward_mean": {"agent_policy": 4580.391808273601, "adversary_policy": -5971.323945700773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8306.485812707702, -6256.325566313825, -10485.63336993552, -6800.209741855978, -8679.016324254286, -6349.39964863449, -8990.562268504003, -6118.774944026484, -9055.814826709939, -7145.293269165891, -8380.435324415357, -11425.69139920648, -10844.114757112891, -9198.003352228317, -7274.356985533372, -9204.10523498697, -8223.368164246138, -5412.121941578884, -10361.902862129667, -9143.79711145729, -1425.639910402938, -9900.736005407183, -9419.96870833279, -9581.412542780543, -450.9440827661459, -2286.4625302018653, -8507.362639382643, -9650.583798049449, -6783.488433877572, -8746.74968747051, -6060.38500742337, -3410.7660935141976, -7610.830079983193, -8978.967145891103, -5563.5635625819905, -9242.557202912158, -9648.734845138422, -8273.149485199607, -5495.887452105969, -8263.341534344185, -6906.201533783823, -10003.328921422517, -8087.688581058289, -6493.775807341942, -10399.776618781498, -9549.331672631255, -9680.43484825731, -8500.923701044008, -9521.159733234905, -6377.790013737225, -2194.871930100815, -1173.7512056214332, -7964.0702926148115, -8380.426515989102, -7536.317381275544, -2607.5356429195535, -7295.9709488449025, -5780.738788832103, -9713.840888488958, -8319.394205350565, -7868.395159430901, -7650.051136005618, -9599.64855576076, -7113.846368942484, -5653.917241939586, -8637.467193584996, -8951.74843915637, -2955.9236823093734, -8660.890346340417, -8463.027765467314, -6119.401157484686, -7445.8271454501655, -9680.17775300698, -5109.85111414414, -8909.4572466649, -5881.423624329699, -714.6102329690125, -8801.401039980201, -4980.327180817852, -7471.901827482113, -4948.723831198791, -6208.7383067099445, -8894.439609542536, -4863.911300823568, -9965.621832698364, -1144.7447795026555, -9069.215638472357, -8569.60120235784, -6525.935360116235, -8779.633760251221, -7927.10313771009, -7129.85458735331, -8215.587480365122, -6945.393762117821, -8766.99028420526, -7618.220159433356, -7350.3757075251315, -8914.91653561749, -5430.428982752294, -4842.604958673777], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 8, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 74, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4451.501223578104, 5287.178214482227, 2427.834300448678, 3607.1042410121895, 2590.825206807583, 4537.806256684949, 5277.186137579557, 5168.139377076788, 8682.271164983222, 4750.389428723689, 4669.855259852729, 9578.126298936606, 4320.257536846638, 7751.671544202723, 6331.657074658328, 6102.810027162135, 7017.07241295113, 3590.380146512955, 7885.7117700096815, 6135.875242041353, 418.4786776971421, 1308.642339446457, 6094.690619365738, 8777.300426363356, 31.501133047168675, 886.4288655712303, 4525.739497899361, 6784.652648147841, 5417.9499255787105, 7035.005601613025, 3794.2235125508264, 2992.3454407913446, 6757.638922655644, 1602.8850756086297, 4024.1412764642732, 5209.116995598012, 4041.956989504986, 1220.5760119589718, 4144.554887218988, 2610.847760714483, 5853.1226970294465, 9339.501806073105, 2563.459553044653, 4327.614958410241, 7776.45609015722, 5340.128243228632, 5980.445734027748, 7067.4212891120615, 7684.045140099135, 3213.0043327405456, 1064.9906535801208, 681.2561258792006, 4870.831322918056, 5225.6268062849795, 4615.742934394716, 1462.5670766853048, 6215.574960371788, 4559.322228094773, 3151.6738921463375, 5482.276751828548, 5383.182978573681, 2396.1541404023906, 6314.039096882452, 5941.8121758703755, 3760.4230907333563, 3944.608636794085, 3574.552146268022, 2030.8412486087025, 5726.07182004211, 3802.688886876125, 1918.8572028777096, 3641.4303530892303, 6103.156301724376, 1839.556267331434, 4101.550961117231, 2983.56793941656, 253.51594059576863, 6669.578644433423, 4402.061976091725, 6841.31905797108, 2945.3939954642683, 3947.19193432228, 6974.733406298476, 4203.681109178726, 9092.18924032544, 713.8513415251373, 6558.984907970189, 5693.068819083041, 3863.073494943925, 6412.601814833103, 7274.688839547889, 3242.476346209668, 4178.653633887349, 2526.1696119581043, 4939.944583340409, 2315.259116455131, 4183.067146117683, 7542.496224513004, 2192.3547410839287, 3292.9395861484945], "policy_adversary_policy_reward": [-8306.485812707702, -4451.501223578104, -5409.241315452401, -6134.26246534365, -2427.834300448678, -10485.63336993552, -4197.729148086796, -6209.584834781374, -3209.9995227268646, -8059.8420083350065, -5276.949156393805, -5610.256748925632, -5389.245222733054, -8878.503183350509, -5808.055815685788, -5478.858505417485, -8763.406857388116, -8974.679134305044, -4825.632321745431, -7070.05037614415, -4970.8636501994315, -8079.426934068656, -11425.691399206476, -9578.126298936606, -10844.114757112891, -4320.257536846638, -8966.769789034386, -7982.905107396646, -7254.723385697659, -6351.29067449404, -9203.978422805661, -6102.936839343442, -8180.364424177025, -7060.0761530202435, -4587.636930778907, -4414.865157312926, -7896.766859791457, -10350.84777234789, -6135.875242041353, -9143.79711145729, -418.4786776971421, -1425.639910402938, -9900.736005407185, -1308.642339446457, -6094.9714005465175, -9419.68792715201, -9581.412542780543, -8777.300426363356, -31.501133047168675, -450.9440827661459, -1256.946461329878, -1915.944934443219, -8507.362639382645, -4525.739497899361, -6784.652648147841, -9650.583798049449, -5446.523842922633, -6754.914516533649, -7126.785872635605, -8654.96941644793, -5981.449169096069, -3873.1593508781275, -3398.532499199456, -3004.5790351060855, -7425.485868676631, -6942.983133962203, -8978.967145891103, -1602.8850756086297, -4720.70027878736, -4867.004560258912, -9242.557202912158, -5209.116995598012, -4041.956989504986, -9648.734845138422, -1220.5760119589718, -8273.149485199607, -4151.071285885464, -5489.371053439495, -7882.589338617075, -2991.599956441592, -6906.201533783824, -5853.1226970294465, -9873.86493613516, -9468.965791360455, -7494.834010502419, -3156.314123600521, -6490.154366585676, -4331.236399166509, -7933.702043324981, -10242.530665613738, -5340.128243228632, -9549.331672631255, -9680.434848257311, -5980.445734027748, -7497.964355641176, -8070.380634514893, -9521.159733234905, -7684.045140099135, -6183.503861504938, -3407.290484972831, -2194.8719301008155, -1064.9906535801208, -1096.6533682826098, -758.3539632180236, -4870.831322918056, -7964.0702926148115, -8380.426515989104, -5225.6268062849795, -7536.317381275546, -4615.742934394716, -1467.2638008495655, -2602.838918755292, -7200.1345725630035, -6311.411336653687, -5601.8504748365995, -4738.210542090276, -3155.7020800844225, -9709.812700550872, -5498.136854768127, -8303.534102410986, -7868.395159430901, -5383.182978573681, -7650.051136005618, -2396.1541404023906, -6314.039096882452, -9599.648555760765, -7081.44122663257, -5974.217318180291, -3771.1431179392694, -5643.197214733674, -3949.629420851771, -8632.44640952731, -8951.74843915637, -3574.552146268022, -2623.129314758795, -2363.635616159285, -7160.033179817615, -7226.928986564907, -3802.688886876125, -8463.027765467314, -1918.8572028777096, -6119.401157484686, -7445.8271454501655, -3641.4303530892303, -6103.156301724376, -9680.17775300698, -5109.851114144142, -1839.556267331434, -4101.550961117231, -8909.4572466649, -2983.56793941656, -5881.423624329699, -514.8442479394029, -453.2819256253785, -6956.4144260489375, -8514.56525836468, -4409.441242378282, -4972.947914531296, -6841.426487632915, -7471.79439782028, -4683.110997047792, -3211.006829615268, -3947.19193432228, -6208.7383067099445, -8890.935805697292, -6978.23721014372, -4586.953631326916, -4480.638778675374, -9107.91973538389, -9949.891337639914, -1114.5037940706293, -744.0923269571636, -9057.816896428338, -6570.383650014209, -5724.1276140758255, -8538.542407365057, -6512.886365068308, -3876.1224899918516, -8313.468155113796, -6878.76741997053, -7637.8635460607165, -7563.928431197261, -3242.476346209668, -7129.85458735331, -8215.58748036512, -4178.653633887349, -6310.277756912064, -3161.2856171638628, -7638.175703289178, -6068.759164256492, -2315.259116455131, -7618.220159433356, -4721.20571527367, -6812.237138369133, -7542.496224513004, -8914.916535617493, -5430.428982752294, -2192.3547410839287, -3403.7042464746737, -4731.840298347597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4020892018025188, "mean_inference_ms": 0.9777423648968433, "mean_action_processing_ms": 0.16837810460999406, "mean_env_wait_ms": 0.05127479300357351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034047365188598633, "StateBufferConnector_ms": 0.0025976896286010742, "ViewRequirementAgentConnector_ms": 0.07044243812561035}, "num_episodes": 20, "episode_return_max": -450.9440827661459, "episode_return_min": -11425.69139920648, "episode_return_mean": -7362.256083127947}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.5634842846634, "num_env_steps_trained_throughput_per_sec": 533.5634842846634, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 7388.796, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7388.761, "sample_time_ms": 733.929, "learn_time_ms": 6642.926, "learn_throughput": 602.144, "synch_weights_time_ms": 11.362}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 92, "trial_id": "3439d_00000", "date": "2024-08-09_15-37-56", "timestamp": 1723232276, "time_this_iter_s": 7.501340866088867, "time_total_s": 696.9958519935608, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 696.9958519935608, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 30.03636363636364, "ram_util_percent": 82.09090909090911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8850814467606445, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.01757395764192, "policy_loss": 0.0023682182746900555, "vf_loss": 9.998060970505078, "vf_explained_var": 2.0017847418785096e-06, "kl": 0.015051646703310932, "entropy": 1.2940271021177372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8042163366205478, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997334986893588, "policy_loss": -0.002396235928905231, "vf_loss": 9.998599745735289, "vf_explained_var": 0.0004988274877033536, "kl": 0.007543163944809407, "entropy": 0.911992583798353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "env_runners": {"episode_reward_max": -450.9440827661459, "episode_reward_min": -10399.776618781498, "episode_reward_mean": -7237.245250309394, "episode_len_mean": 190.15, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19015, "policy_reward_min": {"agent_policy": 31.501133047168675, "adversary_policy": -10242.530665613738}, "policy_reward_max": {"agent_policy": 9339.501806073105, "adversary_policy": -31.501133047168675}, "policy_reward_mean": {"agent_policy": 4390.216644625345, "adversary_policy": -5813.730947467368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1425.639910402938, -9900.736005407183, -9419.96870833279, -9581.412542780543, -450.9440827661459, -2286.4625302018653, -8507.362639382643, -9650.583798049449, -6783.488433877572, -8746.74968747051, -6060.38500742337, -3410.7660935141976, -7610.830079983193, -8978.967145891103, -5563.5635625819905, -9242.557202912158, -9648.734845138422, -8273.149485199607, -5495.887452105969, -8263.341534344185, -6906.201533783823, -10003.328921422517, -8087.688581058289, -6493.775807341942, -10399.776618781498, -9549.331672631255, -9680.43484825731, -8500.923701044008, -9521.159733234905, -6377.790013737225, -2194.871930100815, -1173.7512056214332, -7964.0702926148115, -8380.426515989102, -7536.317381275544, -2607.5356429195535, -7295.9709488449025, -5780.738788832103, -9713.840888488958, -8319.394205350565, -7868.395159430901, -7650.051136005618, -9599.64855576076, -7113.846368942484, -5653.917241939586, -8637.467193584996, -8951.74843915637, -2955.9236823093734, -8660.890346340417, -8463.027765467314, -6119.401157484686, -7445.8271454501655, -9680.17775300698, -5109.85111414414, -8909.4572466649, -5881.423624329699, -714.6102329690125, -8801.401039980201, -4980.327180817852, -7471.901827482113, -4948.723831198791, -6208.7383067099445, -8894.439609542536, -4863.911300823568, -9965.621832698364, -1144.7447795026555, -9069.215638472357, -8569.60120235784, -6525.935360116235, -8779.633760251221, -7927.10313771009, -7129.85458735331, -8215.587480365122, -6945.393762117821, -8766.99028420526, -7618.220159433356, -7350.3757075251315, -8914.91653561749, -5430.428982752294, -4842.604958673777, -8617.665996659087, -8923.397240096354, -7289.5839902449625, -9425.585308984915, -6487.450316015017, -6814.061561162277, -5655.136492965257, -9199.223101850563, -7256.287755638206, -9121.150427366903, -8973.466862006806, -8289.221678382011, -9094.144402354335, -6631.323376918664, -7777.077117907505, -2748.4143521152946, -4701.208852709181, -9666.454004955543, -9855.064678913779, -8628.412105901485], "episode_lengths": [49, 200, 200, 200, 8, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 74, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [418.4786776971421, 1308.642339446457, 6094.690619365738, 8777.300426363356, 31.501133047168675, 886.4288655712303, 4525.739497899361, 6784.652648147841, 5417.9499255787105, 7035.005601613025, 3794.2235125508264, 2992.3454407913446, 6757.638922655644, 1602.8850756086297, 4024.1412764642732, 5209.116995598012, 4041.956989504986, 1220.5760119589718, 4144.554887218988, 2610.847760714483, 5853.1226970294465, 9339.501806073105, 2563.459553044653, 4327.614958410241, 7776.45609015722, 5340.128243228632, 5980.445734027748, 7067.4212891120615, 7684.045140099135, 3213.0043327405456, 1064.9906535801208, 681.2561258792006, 4870.831322918056, 5225.6268062849795, 4615.742934394716, 1462.5670766853048, 6215.574960371788, 4559.322228094773, 3151.6738921463375, 5482.276751828548, 5383.182978573681, 2396.1541404023906, 6314.039096882452, 5941.8121758703755, 3760.4230907333563, 3944.608636794085, 3574.552146268022, 2030.8412486087025, 5726.07182004211, 3802.688886876125, 1918.8572028777096, 3641.4303530892303, 6103.156301724376, 1839.556267331434, 4101.550961117231, 2983.56793941656, 253.51594059576863, 6669.578644433423, 4402.061976091725, 6841.31905797108, 2945.3939954642683, 3947.19193432228, 6974.733406298476, 4203.681109178726, 9092.18924032544, 713.8513415251373, 6558.984907970189, 5693.068819083041, 3863.073494943925, 6412.601814833103, 7274.688839547889, 3242.476346209668, 4178.653633887349, 2526.1696119581043, 4939.944583340409, 2315.259116455131, 4183.067146117683, 7542.496224513004, 2192.3547410839287, 3292.9395861484945, 8385.237110687238, 2256.730536394686, 4964.835041133457, 6533.010682619801, 2830.5473980782954, 4291.634195092489, 1619.5317327722162, 6028.185004165743, 4498.147297099994, 8354.226931347324, 5922.829086000291, 3517.0740712711604, 8134.898881121899, 1367.9748138953041, 3843.3871058396617, 1380.9954279708459, 1785.1735285775546, 5650.781635849162, 4264.219561284503, 5516.716458523995], "policy_adversary_policy_reward": [-418.4786776971421, -1425.639910402938, -9900.736005407185, -1308.642339446457, -6094.9714005465175, -9419.68792715201, -9581.412542780543, -8777.300426363356, -31.501133047168675, -450.9440827661459, -1256.946461329878, -1915.944934443219, -8507.362639382645, -4525.739497899361, -6784.652648147841, -9650.583798049449, -5446.523842922633, -6754.914516533649, -7126.785872635605, -8654.96941644793, -5981.449169096069, -3873.1593508781275, -3398.532499199456, -3004.5790351060855, -7425.485868676631, -6942.983133962203, -8978.967145891103, -1602.8850756086297, -4720.70027878736, -4867.004560258912, -9242.557202912158, -5209.116995598012, -4041.956989504986, -9648.734845138422, -1220.5760119589718, -8273.149485199607, -4151.071285885464, -5489.371053439495, -7882.589338617075, -2991.599956441592, -6906.201533783824, -5853.1226970294465, -9873.86493613516, -9468.965791360455, -7494.834010502419, -3156.314123600521, -6490.154366585676, -4331.236399166509, -7933.702043324981, -10242.530665613738, -5340.128243228632, -9549.331672631255, -9680.434848257311, -5980.445734027748, -7497.964355641176, -8070.380634514893, -9521.159733234905, -7684.045140099135, -6183.503861504938, -3407.290484972831, -2194.8719301008155, -1064.9906535801208, -1096.6533682826098, -758.3539632180236, -4870.831322918056, -7964.0702926148115, -8380.426515989104, -5225.6268062849795, -7536.317381275546, -4615.742934394716, -1467.2638008495655, -2602.838918755292, -7200.1345725630035, -6311.411336653687, -5601.8504748365995, -4738.210542090276, -3155.7020800844225, -9709.812700550872, -5498.136854768127, -8303.534102410986, -7868.395159430901, -5383.182978573681, -7650.051136005618, -2396.1541404023906, -6314.039096882452, -9599.648555760765, -7081.44122663257, -5974.217318180291, -3771.1431179392694, -5643.197214733674, -3949.629420851771, -8632.44640952731, -8951.74843915637, -3574.552146268022, -2623.129314758795, -2363.635616159285, -7160.033179817615, -7226.928986564907, -3802.688886876125, -8463.027765467314, -1918.8572028777096, -6119.401157484686, -7445.8271454501655, -3641.4303530892303, -6103.156301724376, -9680.17775300698, -5109.851114144142, -1839.556267331434, -4101.550961117231, -8909.4572466649, -2983.56793941656, -5881.423624329699, -514.8442479394029, -453.2819256253785, -6956.4144260489375, -8514.56525836468, -4409.441242378282, -4972.947914531296, -6841.426487632915, -7471.79439782028, -4683.110997047792, -3211.006829615268, -3947.19193432228, -6208.7383067099445, -8890.935805697292, -6978.23721014372, -4586.953631326916, -4480.638778675374, -9107.91973538389, -9949.891337639914, -1114.5037940706293, -744.0923269571636, -9057.816896428338, -6570.383650014209, -5724.1276140758255, -8538.542407365057, -6512.886365068308, -3876.1224899918516, -8313.468155113796, -6878.76741997053, -7637.8635460607165, -7563.928431197261, -3242.476346209668, -7129.85458735331, -8215.58748036512, -4178.653633887349, -6310.277756912064, -3161.2856171638628, -7638.175703289178, -6068.759164256492, -2315.259116455131, -7618.220159433356, -4721.20571527367, -6812.237138369133, -7542.496224513004, -8914.916535617493, -5430.428982752294, -2192.3547410839287, -3403.7042464746737, -4731.840298347597, -8490.203944885869, -8512.699162460454, -8923.397240096356, -2256.730536394686, -4967.8571352453155, -7286.561896133104, -6533.010682619801, -9425.585308984915, -6406.659124358851, -2911.3385897344606, -4291.634195092489, -6814.061561162279, -5655.136492965258, -1619.5317327722162, -6028.185004165743, -9199.223101850563, -4498.147297099994, -7256.287755638208, -9121.150427366903, -8354.226931347324, -8973.466862006808, -5922.829086000291, -3517.0740712711604, -8289.221678382011, -8716.804336299123, -8512.238947177111, -1367.9748138953041, -6631.323376918664, -4799.766355467304, -6820.697868279869, -1542.5286484462542, -2586.881131639886, -4616.962992242748, -1869.419389043987, -5697.228921404455, -9620.006719400251, -9855.064678913779, -4264.219561284503, -8628.412105901489, -5516.716458523995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018281484087904, "mean_inference_ms": 0.9772232537444323, "mean_action_processing_ms": 0.1683878318939731, "mean_env_wait_ms": 0.05127455278071677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033544301986694336, "StateBufferConnector_ms": 0.002534627914428711, "ViewRequirementAgentConnector_ms": 0.0686807632446289}, "num_episodes": 20, "episode_return_max": -450.9440827661459, "episode_return_min": -10399.776618781498, "episode_return_mean": -7237.245250309394}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.9047124876619, "num_env_steps_trained_throughput_per_sec": 548.9047124876619, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 7376.673, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7376.639, "sample_time_ms": 733.045, "learn_time_ms": 6631.451, "learn_throughput": 603.186, "synch_weights_time_ms": 11.6}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "training_iteration": 93, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-03", "timestamp": 1723232283, "time_this_iter_s": 7.292527914047241, "time_total_s": 704.288379907608, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 704.288379907608, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 24.6, "ram_util_percent": 81.72999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8764474830590189, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.011784166097641, "policy_loss": 0.0008033255282498431, "vf_loss": 10.0, "vf_explained_var": -0.00010229734083016714, "kl": 0.009640230568766128, "entropy": 1.2926392367730537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7883045020084533, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998319886727307, "policy_loss": -0.0033147808322042385, "vf_loss": 10.0, "vf_explained_var": -0.00013603006721173646, "kl": 0.010897666700036517, "entropy": 0.8806333082062857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": -714.6102329690125, "episode_reward_min": -11420.893464248005, "episode_reward_mean": -7394.463789009801, "episode_len_mean": 194.29, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19429, "policy_reward_min": {"agent_policy": 253.51594059576863, "adversary_policy": -11420.893464248004}, "policy_reward_max": {"agent_policy": 9339.501806073105, "adversary_policy": -453.2819256253785}, "policy_reward_mean": {"agent_policy": 4479.173297507262, "adversary_policy": -5936.818543258531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10003.328921422517, -8087.688581058289, -6493.775807341942, -10399.776618781498, -9549.331672631255, -9680.43484825731, -8500.923701044008, -9521.159733234905, -6377.790013737225, -2194.871930100815, -1173.7512056214332, -7964.0702926148115, -8380.426515989102, -7536.317381275544, -2607.5356429195535, -7295.9709488449025, -5780.738788832103, -9713.840888488958, -8319.394205350565, -7868.395159430901, -7650.051136005618, -9599.64855576076, -7113.846368942484, -5653.917241939586, -8637.467193584996, -8951.74843915637, -2955.9236823093734, -8660.890346340417, -8463.027765467314, -6119.401157484686, -7445.8271454501655, -9680.17775300698, -5109.85111414414, -8909.4572466649, -5881.423624329699, -714.6102329690125, -8801.401039980201, -4980.327180817852, -7471.901827482113, -4948.723831198791, -6208.7383067099445, -8894.439609542536, -4863.911300823568, -9965.621832698364, -1144.7447795026555, -9069.215638472357, -8569.60120235784, -6525.935360116235, -8779.633760251221, -7927.10313771009, -7129.85458735331, -8215.587480365122, -6945.393762117821, -8766.99028420526, -7618.220159433356, -7350.3757075251315, -8914.91653561749, -5430.428982752294, -4842.604958673777, -8617.665996659087, -8923.397240096354, -7289.5839902449625, -9425.585308984915, -6487.450316015017, -6814.061561162277, -5655.136492965257, -9199.223101850563, -7256.287755638206, -9121.150427366903, -8973.466862006806, -8289.221678382011, -9094.144402354335, -6631.323376918664, -7777.077117907505, -2748.4143521152946, -4701.208852709181, -9666.454004955543, -9855.064678913779, -8628.412105901485, -8804.198966583634, -3238.225978743308, -9526.220665985027, -4535.491232777711, -9153.355770387441, -7254.294250469225, -6285.812863965939, -7556.897734939705, -3215.85832230361, -8909.417599069722, -9574.85521217484, -7167.754423320922, -11420.893464248005, -5369.725913636298, -8162.77098216624, -8404.685111089084, -9143.823946644488, -7668.397155343295, -9127.172890340818, -9835.420514134212, -7574.313153266869], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 74, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9339.501806073105, 2563.459553044653, 4327.614958410241, 7776.45609015722, 5340.128243228632, 5980.445734027748, 7067.4212891120615, 7684.045140099135, 3213.0043327405456, 1064.9906535801208, 681.2561258792006, 4870.831322918056, 5225.6268062849795, 4615.742934394716, 1462.5670766853048, 6215.574960371788, 4559.322228094773, 3151.6738921463375, 5482.276751828548, 5383.182978573681, 2396.1541404023906, 6314.039096882452, 5941.8121758703755, 3760.4230907333563, 3944.608636794085, 3574.552146268022, 2030.8412486087025, 5726.07182004211, 3802.688886876125, 1918.8572028777096, 3641.4303530892303, 6103.156301724376, 1839.556267331434, 4101.550961117231, 2983.56793941656, 253.51594059576863, 6669.578644433423, 4402.061976091725, 6841.31905797108, 2945.3939954642683, 3947.19193432228, 6974.733406298476, 4203.681109178726, 9092.18924032544, 713.8513415251373, 6558.984907970189, 5693.068819083041, 3863.073494943925, 6412.601814833103, 7274.688839547889, 3242.476346209668, 4178.653633887349, 2526.1696119581043, 4939.944583340409, 2315.259116455131, 4183.067146117683, 7542.496224513004, 2192.3547410839287, 3292.9395861484945, 8385.237110687238, 2256.730536394686, 4964.835041133457, 6533.010682619801, 2830.5473980782954, 4291.634195092489, 1619.5317327722162, 6028.185004165743, 4498.147297099994, 8354.226931347324, 5922.829086000291, 3517.0740712711604, 8134.898881121899, 1367.9748138953041, 3843.3871058396617, 1380.9954279708459, 1785.1735285775546, 5650.781635849162, 4264.219561284503, 5516.716458523995, 4477.30821707248, 2036.9938039237397, 3837.6157963900473, 4279.811465340513, 5542.354993455554, 2377.1491209903315, 5944.148982865745, 5353.196369229565, 1505.7474200066606, 6882.226002898701, 6133.64997224656, 5742.53795350479, 6011.273469514373, 3469.222712929, 4582.00409159569, 2575.4324204434397, 4374.895747255166, 2804.531118151554, 7089.141838356599, 3279.895486121386, 4128.327610725356], "policy_adversary_policy_reward": [-9873.86493613516, -9468.965791360455, -7494.834010502419, -3156.314123600521, -6490.154366585676, -4331.236399166509, -7933.702043324981, -10242.530665613738, -5340.128243228632, -9549.331672631255, -9680.434848257311, -5980.445734027748, -7497.964355641176, -8070.380634514893, -9521.159733234905, -7684.045140099135, -6183.503861504938, -3407.290484972831, -2194.8719301008155, -1064.9906535801208, -1096.6533682826098, -758.3539632180236, -4870.831322918056, -7964.0702926148115, -8380.426515989104, -5225.6268062849795, -7536.317381275546, -4615.742934394716, -1467.2638008495655, -2602.838918755292, -7200.1345725630035, -6311.411336653687, -5601.8504748365995, -4738.210542090276, -3155.7020800844225, -9709.812700550872, -5498.136854768127, -8303.534102410986, -7868.395159430901, -5383.182978573681, -7650.051136005618, -2396.1541404023906, -6314.039096882452, -9599.648555760765, -7081.44122663257, -5974.217318180291, -3771.1431179392694, -5643.197214733674, -3949.629420851771, -8632.44640952731, -8951.74843915637, -3574.552146268022, -2623.129314758795, -2363.635616159285, -7160.033179817615, -7226.928986564907, -3802.688886876125, -8463.027765467314, -1918.8572028777096, -6119.401157484686, -7445.8271454501655, -3641.4303530892303, -6103.156301724376, -9680.17775300698, -5109.851114144142, -1839.556267331434, -4101.550961117231, -8909.4572466649, -2983.56793941656, -5881.423624329699, -514.8442479394029, -453.2819256253785, -6956.4144260489375, -8514.56525836468, -4409.441242378282, -4972.947914531296, -6841.426487632915, -7471.79439782028, -4683.110997047792, -3211.006829615268, -3947.19193432228, -6208.7383067099445, -8890.935805697292, -6978.23721014372, -4586.953631326916, -4480.638778675374, -9107.91973538389, -9949.891337639914, -1114.5037940706293, -744.0923269571636, -9057.816896428338, -6570.383650014209, -5724.1276140758255, -8538.542407365057, -6512.886365068308, -3876.1224899918516, -8313.468155113796, -6878.76741997053, -7637.8635460607165, -7563.928431197261, -3242.476346209668, -7129.85458735331, -8215.58748036512, -4178.653633887349, -6310.277756912064, -3161.2856171638628, -7638.175703289178, -6068.759164256492, -2315.259116455131, -7618.220159433356, -4721.20571527367, -6812.237138369133, -7542.496224513004, -8914.916535617493, -5430.428982752294, -2192.3547410839287, -3403.7042464746737, -4731.840298347597, -8490.203944885869, -8512.699162460454, -8923.397240096356, -2256.730536394686, -4967.8571352453155, -7286.561896133104, -6533.010682619801, -9425.585308984915, -6406.659124358851, -2911.3385897344606, -4291.634195092489, -6814.061561162279, -5655.136492965258, -1619.5317327722162, -6028.185004165743, -9199.223101850563, -4498.147297099994, -7256.287755638208, -9121.150427366903, -8354.226931347324, -8973.466862006808, -5922.829086000291, -3517.0740712711604, -8289.221678382011, -8716.804336299123, -8512.238947177111, -1367.9748138953041, -6631.323376918664, -4799.766355467304, -6820.697868279869, -1542.5286484462542, -2586.881131639886, -4616.962992242748, -1869.419389043987, -5697.228921404455, -9620.006719400251, -9855.064678913779, -4264.219561284503, -8628.412105901489, -5516.716458523995, -8804.198966583635, -4477.30821707248, -3198.4554069637607, -2076.7643757032865, -3848.897078162086, -9514.939384212988, -4401.248714619297, -4414.053983498927, -9137.935600350502, -5557.775163492493, -7254.294250469222, -2377.1491209903315, -6145.093346415043, -6084.86850041664, -5353.196369229565, -7556.897734939705, -1505.7474200066606, -3215.85832230361, -8909.41759906972, -6882.226002898701, -9574.855212174838, -6133.64997224656, -7167.754423320922, -5742.53795350479, -11420.893464248004, -6011.273469514373, -3589.4021021671842, -5249.5465243981125, -8162.77098216624, -4582.00409159569, -7216.227870801838, -3763.889660730692, -8997.773816232737, -4520.945877666914, -7668.397155343296, -2804.531118151554, -7092.001390829146, -9124.313337868272, -3279.895486121386, -9835.420514134212, -4128.327610725356, -7574.313153266869]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4016532082796139, "mean_inference_ms": 0.9761776746911497, "mean_action_processing_ms": 0.16814256282161288, "mean_env_wait_ms": 0.05125658445378691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033208131790161133, "StateBufferConnector_ms": 0.0024567842483520508, "ViewRequirementAgentConnector_ms": 0.06844031810760498}, "num_episodes": 21, "episode_return_max": -714.6102329690125, "episode_return_min": -11420.893464248005, "episode_return_mean": -7394.463789009801}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.0058795127188, "num_env_steps_trained_throughput_per_sec": 554.0058795127188, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 7368.734, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7368.7, "sample_time_ms": 732.642, "learn_time_ms": 6623.882, "learn_throughput": 603.875, "synch_weights_time_ms": 11.634}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 94, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-11", "timestamp": 1723232291, "time_this_iter_s": 7.223712205886841, "time_total_s": 711.5120921134949, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 711.5120921134949, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 22.890909090909087, "ram_util_percent": 81.65454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8527262619075676, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.013791302839914, "policy_loss": 0.00305195516848471, "vf_loss": 9.984100192785263, "vf_explained_var": 0.00010930529485146205, "kl": 0.023386900815724705, "entropy": 1.2765579797327518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7552378062454481, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.989417815839172, "policy_loss": -0.005531716401807018, "vf_loss": 9.993656050465095, "vf_explained_var": 7.177853079699966e-05, "kl": 0.008623225717539235, "entropy": 0.8262606716975964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": -142.1444309949077, "episode_reward_min": -11420.893464248005, "episode_reward_mean": -7132.50601930375, "episode_len_mean": 191.9, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19190, "policy_reward_min": {"agent_policy": 55.97931119592711, "adversary_policy": -11420.893464248004}, "policy_reward_max": {"agent_policy": 9092.18924032544, "adversary_policy": -55.97931119592711}, "policy_reward_mean": {"agent_policy": 4202.8856595823245, "adversary_policy": -5667.695839443038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5653.917241939586, -8637.467193584996, -8951.74843915637, -2955.9236823093734, -8660.890346340417, -8463.027765467314, -6119.401157484686, -7445.8271454501655, -9680.17775300698, -5109.85111414414, -8909.4572466649, -5881.423624329699, -714.6102329690125, -8801.401039980201, -4980.327180817852, -7471.901827482113, -4948.723831198791, -6208.7383067099445, -8894.439609542536, -4863.911300823568, -9965.621832698364, -1144.7447795026555, -9069.215638472357, -8569.60120235784, -6525.935360116235, -8779.633760251221, -7927.10313771009, -7129.85458735331, -8215.587480365122, -6945.393762117821, -8766.99028420526, -7618.220159433356, -7350.3757075251315, -8914.91653561749, -5430.428982752294, -4842.604958673777, -8617.665996659087, -8923.397240096354, -7289.5839902449625, -9425.585308984915, -6487.450316015017, -6814.061561162277, -5655.136492965257, -9199.223101850563, -7256.287755638206, -9121.150427366903, -8973.466862006806, -8289.221678382011, -9094.144402354335, -6631.323376918664, -7777.077117907505, -2748.4143521152946, -4701.208852709181, -9666.454004955543, -9855.064678913779, -8628.412105901485, -8804.198966583634, -3238.225978743308, -9526.220665985027, -4535.491232777711, -9153.355770387441, -7254.294250469225, -6285.812863965939, -7556.897734939705, -3215.85832230361, -8909.417599069722, -9574.85521217484, -7167.754423320922, -11420.893464248005, -5369.725913636298, -8162.77098216624, -8404.685111089084, -9143.823946644488, -7668.397155343295, -9127.172890340818, -9835.420514134212, -7574.313153266869, -8827.33181056944, -7027.536849135903, -7785.292397513206, -5539.3288708882665, -6296.965125988059, -6284.799043458834, -4891.10881291454, -8432.133663923929, -4702.508913397221, -6862.795732766731, -1381.6756017932498, -8023.102756410807, -8663.89627249417, -7771.818312087147, -9716.80067837731, -9751.559630146543, -3352.51024589346, -7181.414495725375, -5475.493802687128, -9827.350798450316, -306.28349772933825, -142.1444309949077, -7373.440203735547], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 51, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 12, 200], "policy_agent_policy_reward": [3760.4230907333563, 3944.608636794085, 3574.552146268022, 2030.8412486087025, 5726.07182004211, 3802.688886876125, 1918.8572028777096, 3641.4303530892303, 6103.156301724376, 1839.556267331434, 4101.550961117231, 2983.56793941656, 253.51594059576863, 6669.578644433423, 4402.061976091725, 6841.31905797108, 2945.3939954642683, 3947.19193432228, 6974.733406298476, 4203.681109178726, 9092.18924032544, 713.8513415251373, 6558.984907970189, 5693.068819083041, 3863.073494943925, 6412.601814833103, 7274.688839547889, 3242.476346209668, 4178.653633887349, 2526.1696119581043, 4939.944583340409, 2315.259116455131, 4183.067146117683, 7542.496224513004, 2192.3547410839287, 3292.9395861484945, 8385.237110687238, 2256.730536394686, 4964.835041133457, 6533.010682619801, 2830.5473980782954, 4291.634195092489, 1619.5317327722162, 6028.185004165743, 4498.147297099994, 8354.226931347324, 5922.829086000291, 3517.0740712711604, 8134.898881121899, 1367.9748138953041, 3843.3871058396617, 1380.9954279708459, 1785.1735285775546, 5650.781635849162, 4264.219561284503, 5516.716458523995, 4477.30821707248, 2036.9938039237397, 3837.6157963900473, 4279.811465340513, 5542.354993455554, 2377.1491209903315, 5944.148982865745, 5353.196369229565, 1505.7474200066606, 6882.226002898701, 6133.64997224656, 5742.53795350479, 6011.273469514373, 3469.222712929, 4582.00409159569, 2575.4324204434397, 4374.895747255166, 2804.531118151554, 7089.141838356599, 3279.895486121386, 4128.327610725356, 7110.029743663425, 6542.263073573234, 2469.0414827921854, 2590.835589922273, 3492.831753847042, 2172.349715044316, 2878.878457616663, 3485.51467973818, 3476.6819772457743, 3040.6315420979604, 738.9182404819351, 3949.5674525026798, 3076.1905859723515, 5487.666564677604, 5544.069811883219, 3955.024011602766, 2073.3427435556378, 6671.749413955365, 2674.6921554228675, 7428.033443395258, 199.27510701373006, 55.97931119592711, 3914.797641111977], "policy_adversary_policy_reward": [-3771.1431179392694, -5643.197214733674, -3949.629420851771, -8632.44640952731, -8951.74843915637, -3574.552146268022, -2623.129314758795, -2363.635616159285, -7160.033179817615, -7226.928986564907, -3802.688886876125, -8463.027765467314, -1918.8572028777096, -6119.401157484686, -7445.8271454501655, -3641.4303530892303, -6103.156301724376, -9680.17775300698, -5109.851114144142, -1839.556267331434, -4101.550961117231, -8909.4572466649, -2983.56793941656, -5881.423624329699, -514.8442479394029, -453.2819256253785, -6956.4144260489375, -8514.56525836468, -4409.441242378282, -4972.947914531296, -6841.426487632915, -7471.79439782028, -4683.110997047792, -3211.006829615268, -3947.19193432228, -6208.7383067099445, -8890.935805697292, -6978.23721014372, -4586.953631326916, -4480.638778675374, -9107.91973538389, -9949.891337639914, -1114.5037940706293, -744.0923269571636, -9057.816896428338, -6570.383650014209, -5724.1276140758255, -8538.542407365057, -6512.886365068308, -3876.1224899918516, -8313.468155113796, -6878.76741997053, -7637.8635460607165, -7563.928431197261, -3242.476346209668, -7129.85458735331, -8215.58748036512, -4178.653633887349, -6310.277756912064, -3161.2856171638628, -7638.175703289178, -6068.759164256492, -2315.259116455131, -7618.220159433356, -4721.20571527367, -6812.237138369133, -7542.496224513004, -8914.916535617493, -5430.428982752294, -2192.3547410839287, -3403.7042464746737, -4731.840298347597, -8490.203944885869, -8512.699162460454, -8923.397240096356, -2256.730536394686, -4967.8571352453155, -7286.561896133104, -6533.010682619801, -9425.585308984915, -6406.659124358851, -2911.3385897344606, -4291.634195092489, -6814.061561162279, -5655.136492965258, -1619.5317327722162, -6028.185004165743, -9199.223101850563, -4498.147297099994, -7256.287755638208, -9121.150427366903, -8354.226931347324, -8973.466862006808, -5922.829086000291, -3517.0740712711604, -8289.221678382011, -8716.804336299123, -8512.238947177111, -1367.9748138953041, -6631.323376918664, -4799.766355467304, -6820.697868279869, -1542.5286484462542, -2586.881131639886, -4616.962992242748, -1869.419389043987, -5697.228921404455, -9620.006719400251, -9855.064678913779, -4264.219561284503, -8628.412105901489, -5516.716458523995, -8804.198966583635, -4477.30821707248, -3198.4554069637607, -2076.7643757032865, -3848.897078162086, -9514.939384212988, -4401.248714619297, -4414.053983498927, -9137.935600350502, -5557.775163492493, -7254.294250469222, -2377.1491209903315, -6145.093346415043, -6084.86850041664, -5353.196369229565, -7556.897734939705, -1505.7474200066606, -3215.85832230361, -8909.41759906972, -6882.226002898701, -9574.855212174838, -6133.64997224656, -7167.754423320922, -5742.53795350479, -11420.893464248004, -6011.273469514373, -3589.4021021671842, -5249.5465243981125, -8162.77098216624, -4582.00409159569, -7216.227870801838, -3763.889660730692, -8997.773816232737, -4520.945877666914, -7668.397155343296, -2804.531118151554, -7092.001390829146, -9124.313337868272, -3279.895486121386, -9835.420514134212, -4128.327610725356, -7574.313153266869, -8827.331810569438, -7110.029743663425, -6551.369621545192, -7018.430301163944, -2693.6596306919764, -7560.6742496134175, -2590.835589922273, -5539.3288708882665, -4765.156719094367, -5024.640160740741, -2172.4150877653706, -6284.733670737779, -3961.699256745414, -3808.2880137857787, -3485.51467973818, -8432.133663923929, -3476.6819772457743, -4702.508913397221, -3040.6315420979604, -6862.795732766731, -1381.6756017932496, -738.9182404819351, -3949.5674525026798, -8023.102756410807, -8663.896272494172, -3076.1905859723515, -5487.666564677604, -7771.818312087148, -9716.800678377309, -5544.069811883219, -4005.8031266675807, -9700.78051508173, -2355.146587361895, -3070.7064020872035, -7023.59700298582, -6829.566906694919, -5076.6586824617325, -3073.5272756482655, -9827.35079845032, -7428.033443395258, -216.0247087847851, -289.5338959582832, -142.14443099490774, -55.97931119592711, -7293.855595746441, -3994.382249101084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4014723451836315, "mean_inference_ms": 0.9750580514015236, "mean_action_processing_ms": 0.16806023992628868, "mean_env_wait_ms": 0.05119155788106056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003280043601989746, "StateBufferConnector_ms": 0.002459406852722168, "ViewRequirementAgentConnector_ms": 0.0686492919921875}, "num_episodes": 23, "episode_return_max": -142.1444309949077, "episode_return_min": -11420.893464248005, "episode_return_mean": -7132.50601930375}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.0270596088155, "num_env_steps_trained_throughput_per_sec": 536.0270596088155, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 7370.169, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7370.135, "sample_time_ms": 728.788, "learn_time_ms": 6629.164, "learn_throughput": 603.394, "synch_weights_time_ms": 11.643}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 95, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-18", "timestamp": 1723232298, "time_this_iter_s": 7.468217134475708, "time_total_s": 718.9803092479706, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 718.9803092479706, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 33.540000000000006, "ram_util_percent": 81.97}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8771852854173631, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.054459927479426, "policy_loss": 0.008879760004250177, "vf_loss": 10.0, "vf_explained_var": -2.5726606448491415e-05, "kl": 0.02667701573809609, "entropy": 1.2519814612964788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7169910876208512, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001574998684031, "policy_loss": 2.0769137948278398e-05, "vf_loss": 10.0, "vf_explained_var": 0.0003031703214796763, "kl": 0.010361448763352302, "entropy": 0.8170958390311589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": -142.1444309949077, "episode_reward_min": -11420.893464248005, "episode_reward_mean": -7221.520696288176, "episode_len_mean": 193.48, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19348, "policy_reward_min": {"agent_policy": 55.97931119592711, "adversary_policy": -11420.893464248004}, "policy_reward_max": {"agent_policy": 9092.18924032544, "adversary_policy": -55.97931119592711}, "policy_reward_mean": {"agent_policy": 4385.198500782912, "adversary_policy": -5803.359598535544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4863.911300823568, -9965.621832698364, -1144.7447795026555, -9069.215638472357, -8569.60120235784, -6525.935360116235, -8779.633760251221, -7927.10313771009, -7129.85458735331, -8215.587480365122, -6945.393762117821, -8766.99028420526, -7618.220159433356, -7350.3757075251315, -8914.91653561749, -5430.428982752294, -4842.604958673777, -8617.665996659087, -8923.397240096354, -7289.5839902449625, -9425.585308984915, -6487.450316015017, -6814.061561162277, -5655.136492965257, -9199.223101850563, -7256.287755638206, -9121.150427366903, -8973.466862006806, -8289.221678382011, -9094.144402354335, -6631.323376918664, -7777.077117907505, -2748.4143521152946, -4701.208852709181, -9666.454004955543, -9855.064678913779, -8628.412105901485, -8804.198966583634, -3238.225978743308, -9526.220665985027, -4535.491232777711, -9153.355770387441, -7254.294250469225, -6285.812863965939, -7556.897734939705, -3215.85832230361, -8909.417599069722, -9574.85521217484, -7167.754423320922, -11420.893464248005, -5369.725913636298, -8162.77098216624, -8404.685111089084, -9143.823946644488, -7668.397155343295, -9127.172890340818, -9835.420514134212, -7574.313153266869, -8827.33181056944, -7027.536849135903, -7785.292397513206, -5539.3288708882665, -6296.965125988059, -6284.799043458834, -4891.10881291454, -8432.133663923929, -4702.508913397221, -6862.795732766731, -1381.6756017932498, -8023.102756410807, -8663.89627249417, -7771.818312087147, -9716.80067837731, -9751.559630146543, -3352.51024589346, -7181.414495725375, -5475.493802687128, -9827.350798450316, -306.28349772933825, -142.1444309949077, -7373.440203735547, -4385.077681377598, -8950.949633800832, -4556.962849273787, -7663.633045928817, -7821.457988566607, -8989.88136144326, -8245.101254178398, -7122.6695587783, -4412.536756408877, -7543.343211178686, -8094.513246788044, -8030.962505874588, -7366.888877625317, -4176.426727752201, -5714.881605076601, -6922.99627995285, -9646.572863078678, -9906.608849540795, -7839.2581403975155], "episode_lengths": [200, 200, 51, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4203.681109178726, 9092.18924032544, 713.8513415251373, 6558.984907970189, 5693.068819083041, 3863.073494943925, 6412.601814833103, 7274.688839547889, 3242.476346209668, 4178.653633887349, 2526.1696119581043, 4939.944583340409, 2315.259116455131, 4183.067146117683, 7542.496224513004, 2192.3547410839287, 3292.9395861484945, 8385.237110687238, 2256.730536394686, 4964.835041133457, 6533.010682619801, 2830.5473980782954, 4291.634195092489, 1619.5317327722162, 6028.185004165743, 4498.147297099994, 8354.226931347324, 5922.829086000291, 3517.0740712711604, 8134.898881121899, 1367.9748138953041, 3843.3871058396617, 1380.9954279708459, 1785.1735285775546, 5650.781635849162, 4264.219561284503, 5516.716458523995, 4477.30821707248, 2036.9938039237397, 3837.6157963900473, 4279.811465340513, 5542.354993455554, 2377.1491209903315, 5944.148982865745, 5353.196369229565, 1505.7474200066606, 6882.226002898701, 6133.64997224656, 5742.53795350479, 6011.273469514373, 3469.222712929, 4582.00409159569, 2575.4324204434397, 4374.895747255166, 2804.531118151554, 7089.141838356599, 3279.895486121386, 4128.327610725356, 7110.029743663425, 6542.263073573234, 2469.0414827921854, 2590.835589922273, 3492.831753847042, 2172.349715044316, 2878.878457616663, 3485.51467973818, 3476.6819772457743, 3040.6315420979604, 738.9182404819351, 3949.5674525026798, 3076.1905859723515, 5487.666564677604, 5544.069811883219, 3955.024011602766, 2073.3427435556378, 6671.749413955365, 2674.6921554228675, 7428.033443395258, 199.27510701373006, 55.97931119592711, 3914.797641111977, 2331.907346052457, 6912.825575646179, 2918.9166141209007, 7069.800393056727, 5877.9287075654165, 6981.681199616633, 4021.1098398324343, 3236.737003283633, 3151.1938719341674, 6585.963488053404, 4484.485438404553, 7467.7811763976115, 3222.9002984056415, 2308.080592244369, 2744.995210614719, 4902.47645417156, 7204.571867400746, 6178.798727317864, 6090.230125995623], "policy_adversary_policy_reward": [-4586.953631326916, -4480.638778675374, -9107.91973538389, -9949.891337639914, -1114.5037940706293, -744.0923269571636, -9057.816896428338, -6570.383650014209, -5724.1276140758255, -8538.542407365057, -6512.886365068308, -3876.1224899918516, -8313.468155113796, -6878.76741997053, -7637.8635460607165, -7563.928431197261, -3242.476346209668, -7129.85458735331, -8215.58748036512, -4178.653633887349, -6310.277756912064, -3161.2856171638628, -7638.175703289178, -6068.759164256492, -2315.259116455131, -7618.220159433356, -4721.20571527367, -6812.237138369133, -7542.496224513004, -8914.916535617493, -5430.428982752294, -2192.3547410839287, -3403.7042464746737, -4731.840298347597, -8490.203944885869, -8512.699162460454, -8923.397240096356, -2256.730536394686, -4967.8571352453155, -7286.561896133104, -6533.010682619801, -9425.585308984915, -6406.659124358851, -2911.3385897344606, -4291.634195092489, -6814.061561162279, -5655.136492965258, -1619.5317327722162, -6028.185004165743, -9199.223101850563, -4498.147297099994, -7256.287755638208, -9121.150427366903, -8354.226931347324, -8973.466862006808, -5922.829086000291, -3517.0740712711604, -8289.221678382011, -8716.804336299123, -8512.238947177111, -1367.9748138953041, -6631.323376918664, -4799.766355467304, -6820.697868279869, -1542.5286484462542, -2586.881131639886, -4616.962992242748, -1869.419389043987, -5697.228921404455, -9620.006719400251, -9855.064678913779, -4264.219561284503, -8628.412105901489, -5516.716458523995, -8804.198966583635, -4477.30821707248, -3198.4554069637607, -2076.7643757032865, -3848.897078162086, -9514.939384212988, -4401.248714619297, -4414.053983498927, -9137.935600350502, -5557.775163492493, -7254.294250469222, -2377.1491209903315, -6145.093346415043, -6084.86850041664, -5353.196369229565, -7556.897734939705, -1505.7474200066606, -3215.85832230361, -8909.41759906972, -6882.226002898701, -9574.855212174838, -6133.64997224656, -7167.754423320922, -5742.53795350479, -11420.893464248004, -6011.273469514373, -3589.4021021671842, -5249.5465243981125, -8162.77098216624, -4582.00409159569, -7216.227870801838, -3763.889660730692, -8997.773816232737, -4520.945877666914, -7668.397155343296, -2804.531118151554, -7092.001390829146, -9124.313337868272, -3279.895486121386, -9835.420514134212, -4128.327610725356, -7574.313153266869, -8827.331810569438, -7110.029743663425, -6551.369621545192, -7018.430301163944, -2693.6596306919764, -7560.6742496134175, -2590.835589922273, -5539.3288708882665, -4765.156719094367, -5024.640160740741, -2172.4150877653706, -6284.733670737779, -3961.699256745414, -3808.2880137857787, -3485.51467973818, -8432.133663923929, -3476.6819772457743, -4702.508913397221, -3040.6315420979604, -6862.795732766731, -1381.6756017932496, -738.9182404819351, -3949.5674525026798, -8023.102756410807, -8663.896272494172, -3076.1905859723515, -5487.666564677604, -7771.818312087148, -9716.800678377309, -5544.069811883219, -4005.8031266675807, -9700.78051508173, -2355.146587361895, -3070.7064020872035, -7023.59700298582, -6829.566906694919, -5076.6586824617325, -3073.5272756482655, -9827.35079845032, -7428.033443395258, -216.0247087847851, -289.5338959582832, -142.14443099490774, -55.97931119592711, -7293.855595746441, -3994.382249101084, -2668.5036729025137, -4048.481354527542, -8950.94963380083, -6912.825575646179, -3223.5956882463834, -4252.2837751483, -7249.653093144717, -7483.78034584083, -7821.457988566606, -5877.9287075654165, -8989.619402470818, -6981.943158589072, -8245.101254178398, -4021.1098398324343, -3345.8833241006528, -7013.523237961279, -3177.9115400163864, -4385.819088326659, -6585.963488053404, -7543.343211178686, -7275.497909350134, -5303.500775842466, -7794.4566357194935, -7704.287046552707, -5286.9633404085, -5302.825835622451, -3872.040236405965, -2612.4670835906027, -5282.959969390635, -3176.9168463006818, -6785.642523946641, -5039.830210177768, -9646.572863078678, -7204.571867400746, -9906.608849540793, -6178.798727317864, -6395.227068111132, -7534.261198282007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40127715646663087, "mean_inference_ms": 0.9746270948317366, "mean_action_processing_ms": 0.16792919137885523, "mean_env_wait_ms": 0.05118267698750726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033791065216064453, "StateBufferConnector_ms": 0.0024924278259277344, "ViewRequirementAgentConnector_ms": 0.06862401962280273}, "num_episodes": 19, "episode_return_max": -142.1444309949077, "episode_return_min": -11420.893464248005, "episode_return_mean": -7221.520696288176}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.0763961339549, "num_env_steps_trained_throughput_per_sec": 545.0763961339549, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 7379.94, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7379.907, "sample_time_ms": 737.337, "learn_time_ms": 6630.472, "learn_throughput": 603.275, "synch_weights_time_ms": 11.567}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 96, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-26", "timestamp": 1723232306, "time_this_iter_s": 7.343184947967529, "time_total_s": 726.3234941959381, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 726.3234941959381, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 25.89090909090909, "ram_util_percent": 81.72727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9350065946268539, "cur_kl_coeff": 2.5628906250000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.027929458022118, "policy_loss": 0.00635182446470329, "vf_loss": 9.986620500683784, "vf_explained_var": 7.525483767191569e-05, "kl": 0.013639730742822091, "entropy": 1.2889134383449952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7719020617228968, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991781301347036, "policy_loss": -0.002719163994437882, "vf_loss": 9.993514995978623, "vf_explained_var": 0.00010063793293382755, "kl": 0.006569771786163704, "entropy": 0.8517297253722236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "env_runners": {"episode_reward_max": -142.1444309949077, "episode_reward_min": -11420.893464248005, "episode_reward_mean": -6993.641856945901, "episode_len_mean": 191.74, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19174, "policy_reward_min": {"agent_policy": 55.97931119592711, "adversary_policy": -11420.893464248004}, "policy_reward_max": {"agent_policy": 8354.226931347324, "adversary_policy": -55.97931119592711}, "policy_reward_mean": {"agent_policy": 4296.371036935998, "adversary_policy": -5645.00644694095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6814.061561162277, -5655.136492965257, -9199.223101850563, -7256.287755638206, -9121.150427366903, -8973.466862006806, -8289.221678382011, -9094.144402354335, -6631.323376918664, -7777.077117907505, -2748.4143521152946, -4701.208852709181, -9666.454004955543, -9855.064678913779, -8628.412105901485, -8804.198966583634, -3238.225978743308, -9526.220665985027, -4535.491232777711, -9153.355770387441, -7254.294250469225, -6285.812863965939, -7556.897734939705, -3215.85832230361, -8909.417599069722, -9574.85521217484, -7167.754423320922, -11420.893464248005, -5369.725913636298, -8162.77098216624, -8404.685111089084, -9143.823946644488, -7668.397155343295, -9127.172890340818, -9835.420514134212, -7574.313153266869, -8827.33181056944, -7027.536849135903, -7785.292397513206, -5539.3288708882665, -6296.965125988059, -6284.799043458834, -4891.10881291454, -8432.133663923929, -4702.508913397221, -6862.795732766731, -1381.6756017932498, -8023.102756410807, -8663.89627249417, -7771.818312087147, -9716.80067837731, -9751.559630146543, -3352.51024589346, -7181.414495725375, -5475.493802687128, -9827.350798450316, -306.28349772933825, -142.1444309949077, -7373.440203735547, -4385.077681377598, -8950.949633800832, -4556.962849273787, -7663.633045928817, -7821.457988566607, -8989.88136144326, -8245.101254178398, -7122.6695587783, -4412.536756408877, -7543.343211178686, -8094.513246788044, -8030.962505874588, -7366.888877625317, -4176.426727752201, -5714.881605076601, -6922.99627995285, -9646.572863078678, -9906.608849540795, -7839.2581403975155, -5202.011725728487, -10712.82589780493, -7124.543371821885, -6596.667814458689, -984.1366224269258, -8522.531024652597, -4965.135479331074, -7444.693547662829, -9548.13324592335, -7734.595306932836, -4661.64984128393, -7288.312505634709, -5851.336325411199, -6527.55823469183, -6934.953817297152, -6277.293942551438, -5638.563788675105, -6173.151975278212, -829.4715071519574, -7272.574051520295, -6996.825031976008, -6728.973329533384], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200], "policy_agent_policy_reward": [4291.634195092489, 1619.5317327722162, 6028.185004165743, 4498.147297099994, 8354.226931347324, 5922.829086000291, 3517.0740712711604, 8134.898881121899, 1367.9748138953041, 3843.3871058396617, 1380.9954279708459, 1785.1735285775546, 5650.781635849162, 4264.219561284503, 5516.716458523995, 4477.30821707248, 2036.9938039237397, 3837.6157963900473, 4279.811465340513, 5542.354993455554, 2377.1491209903315, 5944.148982865745, 5353.196369229565, 1505.7474200066606, 6882.226002898701, 6133.64997224656, 5742.53795350479, 6011.273469514373, 3469.222712929, 4582.00409159569, 2575.4324204434397, 4374.895747255166, 2804.531118151554, 7089.141838356599, 3279.895486121386, 4128.327610725356, 7110.029743663425, 6542.263073573234, 2469.0414827921854, 2590.835589922273, 3492.831753847042, 2172.349715044316, 2878.878457616663, 3485.51467973818, 3476.6819772457743, 3040.6315420979604, 738.9182404819351, 3949.5674525026798, 3076.1905859723515, 5487.666564677604, 5544.069811883219, 3955.024011602766, 2073.3427435556378, 6671.749413955365, 2674.6921554228675, 7428.033443395258, 199.27510701373006, 55.97931119592711, 3914.797641111977, 2331.907346052457, 6912.825575646179, 2918.9166141209007, 7069.800393056727, 5877.9287075654165, 6981.681199616633, 4021.1098398324343, 3236.737003283633, 3151.1938719341674, 6585.963488053404, 4484.485438404553, 7467.7811763976115, 3222.9002984056415, 2308.080592244369, 2744.995210614719, 4902.47645417156, 7204.571867400746, 6178.798727317864, 6090.230125995623, 3370.6803995673645, 7803.676685841076, 4275.329253007706, 4121.254510419964, 99.92270089541252, 4050.3099126210154, 3065.4655917647183, 2816.686277387359, 6880.680071214496, 5229.928906882749, 3980.9351003469005, 4530.248794939688, 5035.960675190139, 5621.031060156832, 5349.912939937383, 1049.6170427282818, 5098.405346042793, 3538.0314770871023, 564.5641074147569, 6286.946429423972, 6321.194352443946, 5222.333306029701], "policy_adversary_policy_reward": [-4291.634195092489, -6814.061561162279, -5655.136492965258, -1619.5317327722162, -6028.185004165743, -9199.223101850563, -4498.147297099994, -7256.287755638208, -9121.150427366903, -8354.226931347324, -8973.466862006808, -5922.829086000291, -3517.0740712711604, -8289.221678382011, -8716.804336299123, -8512.238947177111, -1367.9748138953041, -6631.323376918664, -4799.766355467304, -6820.697868279869, -1542.5286484462542, -2586.881131639886, -4616.962992242748, -1869.419389043987, -5697.228921404455, -9620.006719400251, -9855.064678913779, -4264.219561284503, -8628.412105901489, -5516.716458523995, -8804.198966583635, -4477.30821707248, -3198.4554069637607, -2076.7643757032865, -3848.897078162086, -9514.939384212988, -4401.248714619297, -4414.053983498927, -9137.935600350502, -5557.775163492493, -7254.294250469222, -2377.1491209903315, -6145.093346415043, -6084.86850041664, -5353.196369229565, -7556.897734939705, -1505.7474200066606, -3215.85832230361, -8909.41759906972, -6882.226002898701, -9574.855212174838, -6133.64997224656, -7167.754423320922, -5742.53795350479, -11420.893464248004, -6011.273469514373, -3589.4021021671842, -5249.5465243981125, -8162.77098216624, -4582.00409159569, -7216.227870801838, -3763.889660730692, -8997.773816232737, -4520.945877666914, -7668.397155343296, -2804.531118151554, -7092.001390829146, -9124.313337868272, -3279.895486121386, -9835.420514134212, -4128.327610725356, -7574.313153266869, -8827.331810569438, -7110.029743663425, -6551.369621545192, -7018.430301163944, -2693.6596306919764, -7560.6742496134175, -2590.835589922273, -5539.3288708882665, -4765.156719094367, -5024.640160740741, -2172.4150877653706, -6284.733670737779, -3961.699256745414, -3808.2880137857787, -3485.51467973818, -8432.133663923929, -3476.6819772457743, -4702.508913397221, -3040.6315420979604, -6862.795732766731, -1381.6756017932496, -738.9182404819351, -3949.5674525026798, -8023.102756410807, -8663.896272494172, -3076.1905859723515, -5487.666564677604, -7771.818312087148, -9716.800678377309, -5544.069811883219, -4005.8031266675807, -9700.78051508173, -2355.146587361895, -3070.7064020872035, -7023.59700298582, -6829.566906694919, -5076.6586824617325, -3073.5272756482655, -9827.35079845032, -7428.033443395258, -216.0247087847851, -289.5338959582832, -142.14443099490774, -55.97931119592711, -7293.855595746441, -3994.382249101084, -2668.5036729025137, -4048.481354527542, -8950.94963380083, -6912.825575646179, -3223.5956882463834, -4252.2837751483, -7249.653093144717, -7483.78034584083, -7821.457988566606, -5877.9287075654165, -8989.619402470818, -6981.943158589072, -8245.101254178398, -4021.1098398324343, -3345.8833241006528, -7013.523237961279, -3177.9115400163864, -4385.819088326659, -6585.963488053404, -7543.343211178686, -7275.497909350134, -5303.500775842466, -7794.4566357194935, -7704.287046552707, -5286.9633404085, -5302.825835622451, -3872.040236405965, -2612.4670835906027, -5282.959969390635, -3176.9168463006818, -6785.642523946641, -5039.830210177768, -9646.572863078678, -7204.571867400746, -9906.608849540793, -6178.798727317864, -6395.227068111132, -7534.261198282007, -5202.011725728489, -3370.6803995673645, -10712.825897804933, -7803.676685841076, -4275.329253007706, -7124.543371821885, -4577.784181527386, -6140.138143351273, -99.92270089541252, -984.1366224269258, -8522.531024652597, -4050.3099126210154, -3150.9014829563625, -4879.6995881394305, -3013.0082070265817, -7248.371618023606, -6914.46386454706, -9514.349452590788, -7734.595306932837, -5229.928906882749, -4453.901602382174, -4188.683339248657, -4982.227149182457, -6836.334151391949, -5828.348103908915, -5058.948896692423, -6118.486223692574, -6030.103071156089, -5351.5982275320675, -6933.268529702468, -6277.293942551439, -1049.6170427282818, -5355.233503500835, -5381.735631217063, -3932.2726185892916, -5778.910833776021, -564.5641074147569, -829.4715071519574, -7255.309944931833, -6304.210536012434, -6374.829522790274, -6943.189861629679, -5222.333306029701, -6728.973329533384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4010935749972095, "mean_inference_ms": 0.9737614299777025, "mean_action_processing_ms": 0.16794183182705433, "mean_env_wait_ms": 0.051185577165521884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034445524215698242, "StateBufferConnector_ms": 0.0025254487991333008, "ViewRequirementAgentConnector_ms": 0.07146131992340088}, "num_episodes": 22, "episode_return_max": -142.1444309949077, "episode_return_min": -11420.893464248005, "episode_return_mean": -6993.641856945901}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.506657699971, "num_env_steps_trained_throughput_per_sec": 545.506657699971, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 7341.192, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7341.16, "sample_time_ms": 745.657, "learn_time_ms": 6583.928, "learn_throughput": 607.54, "synch_weights_time_ms": 11.138}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "training_iteration": 97, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-33", "timestamp": 1723232313, "time_this_iter_s": 7.335960865020752, "time_total_s": 733.6594550609589, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30570d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 733.6594550609589, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.827272727272724, "ram_util_percent": 81.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9692346975207329, "cur_kl_coeff": 2.5628906250000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.066986400882403, "policy_loss": 0.0157096904120408, "vf_loss": 9.994579935073853, "vf_explained_var": 5.888864398002624e-05, "kl": 0.02212219104646162, "entropy": 1.2950124443819127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7482495692080606, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988796434957514, "policy_loss": -0.011058265822890299, "vf_loss": 9.997308322866127, "vf_explained_var": -0.00020029973731469855, "kl": 0.016975736790385946, "entropy": 0.8042108157009044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": -142.1444309949077, "episode_reward_min": -11420.893464248005, "episode_reward_mean": -6821.896102951764, "episode_len_mean": 190.84, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19084, "policy_reward_min": {"agent_policy": 55.97931119592711, "adversary_policy": -11420.893464248004}, "policy_reward_max": {"agent_policy": 7803.676685841076, "adversary_policy": -55.97931119592711}, "policy_reward_mean": {"agent_policy": 4151.959258396679, "adversary_policy": -5486.927680674221}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7254.294250469225, -6285.812863965939, -7556.897734939705, -3215.85832230361, -8909.417599069722, -9574.85521217484, -7167.754423320922, -11420.893464248005, -5369.725913636298, -8162.77098216624, -8404.685111089084, -9143.823946644488, -7668.397155343295, -9127.172890340818, -9835.420514134212, -7574.313153266869, -8827.33181056944, -7027.536849135903, -7785.292397513206, -5539.3288708882665, -6296.965125988059, -6284.799043458834, -4891.10881291454, -8432.133663923929, -4702.508913397221, -6862.795732766731, -1381.6756017932498, -8023.102756410807, -8663.89627249417, -7771.818312087147, -9716.80067837731, -9751.559630146543, -3352.51024589346, -7181.414495725375, -5475.493802687128, -9827.350798450316, -306.28349772933825, -142.1444309949077, -7373.440203735547, -4385.077681377598, -8950.949633800832, -4556.962849273787, -7663.633045928817, -7821.457988566607, -8989.88136144326, -8245.101254178398, -7122.6695587783, -4412.536756408877, -7543.343211178686, -8094.513246788044, -8030.962505874588, -7366.888877625317, -4176.426727752201, -5714.881605076601, -6922.99627995285, -9646.572863078678, -9906.608849540795, -7839.2581403975155, -5202.011725728487, -10712.82589780493, -7124.543371821885, -6596.667814458689, -984.1366224269258, -8522.531024652597, -4965.135479331074, -7444.693547662829, -9548.13324592335, -7734.595306932836, -4661.64984128393, -7288.312505634709, -5851.336325411199, -6527.55823469183, -6934.953817297152, -6277.293942551438, -5638.563788675105, -6173.151975278212, -829.4715071519574, -7272.574051520295, -6996.825031976008, -6728.973329533384, -4944.457796458202, -5298.800282484948, -9477.00932687195, -8151.6875654126325, -3503.2711004736843, -5914.778266657895, -9146.51928230902, -10518.048490481473, -4528.398299571578, -5673.979702171207, -5275.303286835956, -5677.549308890103, -5643.433345383084, -8138.701651819766, -5234.593848458106, -5863.561822753246, -6710.9205614979, -7045.279699640332, -9281.79638320718, -6465.4739648326695], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 110, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2377.1491209903315, 5944.148982865745, 5353.196369229565, 1505.7474200066606, 6882.226002898701, 6133.64997224656, 5742.53795350479, 6011.273469514373, 3469.222712929, 4582.00409159569, 2575.4324204434397, 4374.895747255166, 2804.531118151554, 7089.141838356599, 3279.895486121386, 4128.327610725356, 7110.029743663425, 6542.263073573234, 2469.0414827921854, 2590.835589922273, 3492.831753847042, 2172.349715044316, 2878.878457616663, 3485.51467973818, 3476.6819772457743, 3040.6315420979604, 738.9182404819351, 3949.5674525026798, 3076.1905859723515, 5487.666564677604, 5544.069811883219, 3955.024011602766, 2073.3427435556378, 6671.749413955365, 2674.6921554228675, 7428.033443395258, 199.27510701373006, 55.97931119592711, 3914.797641111977, 2331.907346052457, 6912.825575646179, 2918.9166141209007, 7069.800393056727, 5877.9287075654165, 6981.681199616633, 4021.1098398324343, 3236.737003283633, 3151.1938719341674, 6585.963488053404, 4484.485438404553, 7467.7811763976115, 3222.9002984056415, 2308.080592244369, 2744.995210614719, 4902.47645417156, 7204.571867400746, 6178.798727317864, 6090.230125995623, 3370.6803995673645, 7803.676685841076, 4275.329253007706, 4121.254510419964, 99.92270089541252, 4050.3099126210154, 3065.4655917647183, 2816.686277387359, 6880.680071214496, 5229.928906882749, 3980.9351003469005, 4530.248794939688, 5035.960675190139, 5621.031060156832, 5349.912939937383, 1049.6170427282818, 5098.405346042793, 3538.0314770871023, 564.5641074147569, 6286.946429423972, 6321.194352443946, 5222.333306029701, 3403.361784615536, 4921.936850947618, 3336.2926430036678, 3190.0065610407146, 906.3313626085788, 1747.777094063395, 3721.290529171515, 5154.818965808869, 1798.666365750405, 5407.576365320856, 3828.1859617984364, 5385.000929007666, 2953.6359532726533, 5162.440206940087, 3907.0643206043865, 4802.801461043146, 1605.949303331681, 2566.5847126308986, 3115.0135034231366, 4993.947278679434], "policy_adversary_policy_reward": [-7254.294250469222, -2377.1491209903315, -6145.093346415043, -6084.86850041664, -5353.196369229565, -7556.897734939705, -1505.7474200066606, -3215.85832230361, -8909.41759906972, -6882.226002898701, -9574.855212174838, -6133.64997224656, -7167.754423320922, -5742.53795350479, -11420.893464248004, -6011.273469514373, -3589.4021021671842, -5249.5465243981125, -8162.77098216624, -4582.00409159569, -7216.227870801838, -3763.889660730692, -8997.773816232737, -4520.945877666914, -7668.397155343296, -2804.531118151554, -7092.001390829146, -9124.313337868272, -3279.895486121386, -9835.420514134212, -4128.327610725356, -7574.313153266869, -8827.331810569438, -7110.029743663425, -6551.369621545192, -7018.430301163944, -2693.6596306919764, -7560.6742496134175, -2590.835589922273, -5539.3288708882665, -4765.156719094367, -5024.640160740741, -2172.4150877653706, -6284.733670737779, -3961.699256745414, -3808.2880137857787, -3485.51467973818, -8432.133663923929, -3476.6819772457743, -4702.508913397221, -3040.6315420979604, -6862.795732766731, -1381.6756017932496, -738.9182404819351, -3949.5674525026798, -8023.102756410807, -8663.896272494172, -3076.1905859723515, -5487.666564677604, -7771.818312087148, -9716.800678377309, -5544.069811883219, -4005.8031266675807, -9700.78051508173, -2355.146587361895, -3070.7064020872035, -7023.59700298582, -6829.566906694919, -5076.6586824617325, -3073.5272756482655, -9827.35079845032, -7428.033443395258, -216.0247087847851, -289.5338959582832, -142.14443099490774, -55.97931119592711, -7293.855595746441, -3994.382249101084, -2668.5036729025137, -4048.481354527542, -8950.94963380083, -6912.825575646179, -3223.5956882463834, -4252.2837751483, -7249.653093144717, -7483.78034584083, -7821.457988566606, -5877.9287075654165, -8989.619402470818, -6981.943158589072, -8245.101254178398, -4021.1098398324343, -3345.8833241006528, -7013.523237961279, -3177.9115400163864, -4385.819088326659, -6585.963488053404, -7543.343211178686, -7275.497909350134, -5303.500775842466, -7794.4566357194935, -7704.287046552707, -5286.9633404085, -5302.825835622451, -3872.040236405965, -2612.4670835906027, -5282.959969390635, -3176.9168463006818, -6785.642523946641, -5039.830210177768, -9646.572863078678, -7204.571867400746, -9906.608849540793, -6178.798727317864, -6395.227068111132, -7534.261198282007, -5202.011725728489, -3370.6803995673645, -10712.825897804933, -7803.676685841076, -4275.329253007706, -7124.543371821885, -4577.784181527386, -6140.138143351273, -99.92270089541252, -984.1366224269258, -8522.531024652597, -4050.3099126210154, -3150.9014829563625, -4879.6995881394305, -3013.0082070265817, -7248.371618023606, -6914.46386454706, -9514.349452590788, -7734.595306932837, -5229.928906882749, -4453.901602382174, -4188.683339248657, -4982.227149182457, -6836.334151391949, -5828.348103908915, -5058.948896692423, -6118.486223692574, -6030.103071156089, -5351.5982275320675, -6933.268529702468, -6277.293942551439, -1049.6170427282818, -5355.233503500835, -5381.735631217063, -3932.2726185892916, -5778.910833776021, -564.5641074147569, -829.4715071519574, -7255.309944931833, -6304.210536012434, -6374.829522790274, -6943.189861629679, -5222.333306029701, -6728.973329533384, -3597.4244813193873, -4750.3950997543525, -5132.348967213146, -5088.388166219423, -3336.2926430036678, -9477.00932687195, -8151.687565412632, -3190.0065610407146, -3503.2711004736843, -906.3313626085788, -5914.778266657894, -1747.777094063395, -9146.519282309022, -3721.290529171515, -5154.818965808869, -10518.048490481473, -2071.417284535223, -4255.647380786753, -5523.6828034988, -5557.873263993262, -3828.1859617984364, -5275.303286835956, -5468.277938850673, -5594.272299047096, -3158.514462473244, -5438.554836182497, -6333.063616765077, -6968.078241994777, -5225.535553026659, -3916.122616035835, -5595.979610554944, -5070.383673241439, -2278.9227370837416, -6037.947127745847, -7045.279699640332, -2566.5847126308986, -9281.79638320718, -3115.0135034231366, -6429.043051623767, -5030.378191888334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4010981907029333, "mean_inference_ms": 0.9736421251731227, "mean_action_processing_ms": 0.16788639660168214, "mean_env_wait_ms": 0.05119504917284095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034322738647460938, "StateBufferConnector_ms": 0.002543807029724121, "ViewRequirementAgentConnector_ms": 0.07222914695739746}, "num_episodes": 20, "episode_return_max": -142.1444309949077, "episode_return_min": -11420.893464248005, "episode_return_mean": -6821.896102951764}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.2139035362097, "num_env_steps_trained_throughput_per_sec": 558.2139035362097, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 7308.883, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7308.851, "sample_time_ms": 751.478, "learn_time_ms": 6545.732, "learn_throughput": 611.085, "synch_weights_time_ms": 11.133}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 98, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-41", "timestamp": 1723232321, "time_this_iter_s": 7.169816970825195, "time_total_s": 740.8292720317841, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ecee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 740.8292720317841, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 26.1, "ram_util_percent": 81.26000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1462534725976488, "cur_kl_coeff": 3.844335937499999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.091637059052784, "policy_loss": 0.011646273504205358, "vf_loss": 9.985727110505104, "vf_explained_var": 0.00012019649147987366, "kl": 0.02452013691945467, "entropy": 1.3310968036452928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7503136947356834, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990870397053067, "policy_loss": -0.0018664061909211336, "vf_loss": 9.991577386603785, "vf_explained_var": 0.00021152789630587138, "kl": 0.007729449574515303, "entropy": 0.8198300932765638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "env_runners": {"episode_reward_max": -142.1444309949077, "episode_reward_min": -10712.82589780493, "episode_reward_mean": -6533.559979638664, "episode_len_mean": 189.44, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18944, "policy_reward_min": {"agent_policy": 55.97931119592711, "adversary_policy": -10712.825897804933}, "policy_reward_max": {"agent_policy": 7803.676685841076, "adversary_policy": -55.97931119592711}, "policy_reward_mean": {"agent_policy": 4039.2562293530646, "adversary_policy": -5286.408104495865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6284.799043458834, -4891.10881291454, -8432.133663923929, -4702.508913397221, -6862.795732766731, -1381.6756017932498, -8023.102756410807, -8663.89627249417, -7771.818312087147, -9716.80067837731, -9751.559630146543, -3352.51024589346, -7181.414495725375, -5475.493802687128, -9827.350798450316, -306.28349772933825, -142.1444309949077, -7373.440203735547, -4385.077681377598, -8950.949633800832, -4556.962849273787, -7663.633045928817, -7821.457988566607, -8989.88136144326, -8245.101254178398, -7122.6695587783, -4412.536756408877, -7543.343211178686, -8094.513246788044, -8030.962505874588, -7366.888877625317, -4176.426727752201, -5714.881605076601, -6922.99627995285, -9646.572863078678, -9906.608849540795, -7839.2581403975155, -5202.011725728487, -10712.82589780493, -7124.543371821885, -6596.667814458689, -984.1366224269258, -8522.531024652597, -4965.135479331074, -7444.693547662829, -9548.13324592335, -7734.595306932836, -4661.64984128393, -7288.312505634709, -5851.336325411199, -6527.55823469183, -6934.953817297152, -6277.293942551438, -5638.563788675105, -6173.151975278212, -829.4715071519574, -7272.574051520295, -6996.825031976008, -6728.973329533384, -4944.457796458202, -5298.800282484948, -9477.00932687195, -8151.6875654126325, -3503.2711004736843, -5914.778266657895, -9146.51928230902, -10518.048490481473, -4528.398299571578, -5673.979702171207, -5275.303286835956, -5677.549308890103, -5643.433345383084, -8138.701651819766, -5234.593848458106, -5863.561822753246, -6710.9205614979, -7045.279699640332, -9281.79638320718, -6465.4739648326695, -4435.419549375629, -6855.595527270141, -6434.470005031672, -5712.36710513148, -6814.24184866254, -8960.284238193923, -8112.275268433792, -5346.732213214587, -4862.046344927285, -7734.169148419317, -5788.11617572535, -6977.849033815652, -1265.7400216538474, -7425.264353189086, -5385.3593289945275, -6782.851056192548, -7952.534726867058, -6880.498678639188, -8198.581431201166, -5431.065575307787, -5959.474629651729], "episode_lengths": [200, 200, 200, 200, 200, 62, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 110, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 196, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2172.349715044316, 2878.878457616663, 3485.51467973818, 3476.6819772457743, 3040.6315420979604, 738.9182404819351, 3949.5674525026798, 3076.1905859723515, 5487.666564677604, 5544.069811883219, 3955.024011602766, 2073.3427435556378, 6671.749413955365, 2674.6921554228675, 7428.033443395258, 199.27510701373006, 55.97931119592711, 3914.797641111977, 2331.907346052457, 6912.825575646179, 2918.9166141209007, 7069.800393056727, 5877.9287075654165, 6981.681199616633, 4021.1098398324343, 3236.737003283633, 3151.1938719341674, 6585.963488053404, 4484.485438404553, 7467.7811763976115, 3222.9002984056415, 2308.080592244369, 2744.995210614719, 4902.47645417156, 7204.571867400746, 6178.798727317864, 6090.230125995623, 3370.6803995673645, 7803.676685841076, 4275.329253007706, 4121.254510419964, 99.92270089541252, 4050.3099126210154, 3065.4655917647183, 2816.686277387359, 6880.680071214496, 5229.928906882749, 3980.9351003469005, 4530.248794939688, 5035.960675190139, 5621.031060156832, 5349.912939937383, 1049.6170427282818, 5098.405346042793, 3538.0314770871023, 564.5641074147569, 6286.946429423972, 6321.194352443946, 5222.333306029701, 3403.361784615536, 4921.936850947618, 3336.2926430036678, 3190.0065610407146, 906.3313626085788, 1747.777094063395, 3721.290529171515, 5154.818965808869, 1798.666365750405, 5407.576365320856, 3828.1859617984364, 5385.000929007666, 2953.6359532726533, 5162.440206940087, 3907.0643206043865, 4802.801461043146, 1605.949303331681, 2566.5847126308986, 3115.0135034231366, 4993.947278679434, 1882.479085315071, 2124.2298196342417, 4853.427600044577, 3379.1889796192236, 3019.9826215860744, 5090.910656682563, 4491.91343537808, 3860.254803590151, 3026.2068363875223, 6929.250606647406, 3568.778445319095, 4438.62783727979, 649.3221025889045, 6710.57762390892, 2034.9228333017531, 3621.5315691591054, 5148.055112508867, 5581.546236191227, 3932.682266143721, 3759.0165566713868, 5085.174028313846], "policy_adversary_policy_reward": [-2172.4150877653706, -6284.733670737779, -3961.699256745414, -3808.2880137857787, -3485.51467973818, -8432.133663923929, -3476.6819772457743, -4702.508913397221, -3040.6315420979604, -6862.795732766731, -1381.6756017932496, -738.9182404819351, -3949.5674525026798, -8023.102756410807, -8663.896272494172, -3076.1905859723515, -5487.666564677604, -7771.818312087148, -9716.800678377309, -5544.069811883219, -4005.8031266675807, -9700.78051508173, -2355.146587361895, -3070.7064020872035, -7023.59700298582, -6829.566906694919, -5076.6586824617325, -3073.5272756482655, -9827.35079845032, -7428.033443395258, -216.0247087847851, -289.5338959582832, -142.14443099490774, -55.97931119592711, -7293.855595746441, -3994.382249101084, -2668.5036729025137, -4048.481354527542, -8950.94963380083, -6912.825575646179, -3223.5956882463834, -4252.2837751483, -7249.653093144717, -7483.78034584083, -7821.457988566606, -5877.9287075654165, -8989.619402470818, -6981.943158589072, -8245.101254178398, -4021.1098398324343, -3345.8833241006528, -7013.523237961279, -3177.9115400163864, -4385.819088326659, -6585.963488053404, -7543.343211178686, -7275.497909350134, -5303.500775842466, -7794.4566357194935, -7704.287046552707, -5286.9633404085, -5302.825835622451, -3872.040236405965, -2612.4670835906027, -5282.959969390635, -3176.9168463006818, -6785.642523946641, -5039.830210177768, -9646.572863078678, -7204.571867400746, -9906.608849540793, -6178.798727317864, -6395.227068111132, -7534.261198282007, -5202.011725728489, -3370.6803995673645, -10712.825897804933, -7803.676685841076, -4275.329253007706, -7124.543371821885, -4577.784181527386, -6140.138143351273, -99.92270089541252, -984.1366224269258, -8522.531024652597, -4050.3099126210154, -3150.9014829563625, -4879.6995881394305, -3013.0082070265817, -7248.371618023606, -6914.46386454706, -9514.349452590788, -7734.595306932837, -5229.928906882749, -4453.901602382174, -4188.683339248657, -4982.227149182457, -6836.334151391949, -5828.348103908915, -5058.948896692423, -6118.486223692574, -6030.103071156089, -5351.5982275320675, -6933.268529702468, -6277.293942551439, -1049.6170427282818, -5355.233503500835, -5381.735631217063, -3932.2726185892916, -5778.910833776021, -564.5641074147569, -829.4715071519574, -7255.309944931833, -6304.210536012434, -6374.829522790274, -6943.189861629679, -5222.333306029701, -6728.973329533384, -3597.4244813193873, -4750.3950997543525, -5132.348967213146, -5088.388166219423, -3336.2926430036678, -9477.00932687195, -8151.687565412632, -3190.0065610407146, -3503.2711004736843, -906.3313626085788, -5914.778266657894, -1747.777094063395, -9146.519282309022, -3721.290529171515, -5154.818965808869, -10518.048490481473, -2071.417284535223, -4255.647380786753, -5523.6828034988, -5557.873263993262, -3828.1859617984364, -5275.303286835956, -5468.277938850673, -5594.272299047096, -3158.514462473244, -5438.554836182497, -6333.063616765077, -6968.078241994777, -5225.535553026659, -3916.122616035835, -5595.979610554944, -5070.383673241439, -2278.9227370837416, -6037.947127745847, -7045.279699640332, -2566.5847126308986, -9281.79638320718, -3115.0135034231366, -6429.043051623767, -5030.378191888334, -1882.479085315071, -4435.419549375629, -2124.2298196342417, -6855.595527270141, -4970.636630396638, -6317.260974679612, -5712.367105131479, -3379.1889796192236, -4929.931761835898, -4904.292708412712, -5090.910656682563, -8960.284238193923, -8103.363071493593, -4500.825632318279, -4164.167917840419, -5042.819098964308, -4862.046344927286, -3026.2068363875223, -6936.77411417496, -7726.645640891763, -3568.778445319095, -5788.11617572535, -4438.62783727979, -6977.849033815652, -1168.4350838379266, -746.6270404048252, -6797.553509802229, -7338.288467295776, -2829.270504231681, -4591.011658064593, -3621.5315691591054, -6782.851056192548, -7740.661893671972, -5359.92794570395, -6295.732309343103, -6166.312605487316, -3932.682266143721, -8198.581431201166, -5027.6948631671585, -4162.387268812022, -5605.800835424721, -5438.847822540852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40108357118379984, "mean_inference_ms": 0.9735158343745393, "mean_action_processing_ms": 0.16789693824060892, "mean_env_wait_ms": 0.05121089226735105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033987760543823242, "StateBufferConnector_ms": 0.002501249313354492, "ViewRequirementAgentConnector_ms": 0.07064688205718994}, "num_episodes": 21, "episode_return_max": -142.1444309949077, "episode_return_min": -10712.82589780493, "episode_return_mean": -6533.559979638664}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.6854262580473, "num_env_steps_trained_throughput_per_sec": 552.6854262580473, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 7321.728, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7321.697, "sample_time_ms": 747.18, "learn_time_ms": 6562.772, "learn_throughput": 609.499, "synch_weights_time_ms": 11.259}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "training_iteration": 99, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-48", "timestamp": 1723232328, "time_this_iter_s": 7.242156028747559, "time_total_s": 748.0714280605316, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30574c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 748.0714280605316, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 26.045454545454547, "ram_util_percent": 81.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1236765421306094, "cur_kl_coeff": 5.766503906249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.059098194042841, "policy_loss": 0.008760644944413799, "vf_loss": 9.991085806488991, "vf_explained_var": 0.00013375549266735713, "kl": 0.010275158715618697, "entropy": 1.3427840882291397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7254150885517004, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994629420931377, "policy_loss": -0.0017265849618645257, "vf_loss": 9.994491195174122, "vf_explained_var": -0.0001224025532051369, "kl": 0.012432046998637142, "entropy": 0.8234237254612029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": -635.3118826571889, "episode_reward_min": -10712.82589780493, "episode_reward_mean": -6520.575785806911, "episode_len_mean": 191.46, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19146, "policy_reward_min": {"agent_policy": 99.92270089541252, "adversary_policy": -10712.825897804933}, "policy_reward_max": {"agent_policy": 7803.676685841076, "adversary_policy": -99.92270089541252}, "policy_reward_mean": {"agent_policy": 4055.982311988228, "adversary_policy": -5288.279048897571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7821.457988566607, -8989.88136144326, -8245.101254178398, -7122.6695587783, -4412.536756408877, -7543.343211178686, -8094.513246788044, -8030.962505874588, -7366.888877625317, -4176.426727752201, -5714.881605076601, -6922.99627995285, -9646.572863078678, -9906.608849540795, -7839.2581403975155, -5202.011725728487, -10712.82589780493, -7124.543371821885, -6596.667814458689, -984.1366224269258, -8522.531024652597, -4965.135479331074, -7444.693547662829, -9548.13324592335, -7734.595306932836, -4661.64984128393, -7288.312505634709, -5851.336325411199, -6527.55823469183, -6934.953817297152, -6277.293942551438, -5638.563788675105, -6173.151975278212, -829.4715071519574, -7272.574051520295, -6996.825031976008, -6728.973329533384, -4944.457796458202, -5298.800282484948, -9477.00932687195, -8151.6875654126325, -3503.2711004736843, -5914.778266657895, -9146.51928230902, -10518.048490481473, -4528.398299571578, -5673.979702171207, -5275.303286835956, -5677.549308890103, -5643.433345383084, -8138.701651819766, -5234.593848458106, -5863.561822753246, -6710.9205614979, -7045.279699640332, -9281.79638320718, -6465.4739648326695, -4435.419549375629, -6855.595527270141, -6434.470005031672, -5712.36710513148, -6814.24184866254, -8960.284238193923, -8112.275268433792, -5346.732213214587, -4862.046344927285, -7734.169148419317, -5788.11617572535, -6977.849033815652, -1265.7400216538474, -7425.264353189086, -5385.3593289945275, -6782.851056192548, -7952.534726867058, -6880.498678639188, -8198.581431201166, -5431.065575307787, -5959.474629651729, -6500.635771413925, -6510.859373371671, -6400.528985033174, -7263.92697492616, -3927.491232139662, -2226.529991969938, -5384.618327219124, -9755.686984105669, -5370.037357109865, -7435.907410074378, -8428.81302243536, -635.3118826571889, -5937.846100409227, -3398.9922838761267, -7151.059680954849, -6845.684571840662, -7683.618020863278, -4795.241517191466, -6840.334875847137, -7027.08159718325, -6993.102240482769, -7885.732519087526], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 110, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 196, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 55, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5877.9287075654165, 6981.681199616633, 4021.1098398324343, 3236.737003283633, 3151.1938719341674, 6585.963488053404, 4484.485438404553, 7467.7811763976115, 3222.9002984056415, 2308.080592244369, 2744.995210614719, 4902.47645417156, 7204.571867400746, 6178.798727317864, 6090.230125995623, 3370.6803995673645, 7803.676685841076, 4275.329253007706, 4121.254510419964, 99.92270089541252, 4050.3099126210154, 3065.4655917647183, 2816.686277387359, 6880.680071214496, 5229.928906882749, 3980.9351003469005, 4530.248794939688, 5035.960675190139, 5621.031060156832, 5349.912939937383, 1049.6170427282818, 5098.405346042793, 3538.0314770871023, 564.5641074147569, 6286.946429423972, 6321.194352443946, 5222.333306029701, 3403.361784615536, 4921.936850947618, 3336.2926430036678, 3190.0065610407146, 906.3313626085788, 1747.777094063395, 3721.290529171515, 5154.818965808869, 1798.666365750405, 5407.576365320856, 3828.1859617984364, 5385.000929007666, 2953.6359532726533, 5162.440206940087, 3907.0643206043865, 4802.801461043146, 1605.949303331681, 2566.5847126308986, 3115.0135034231366, 4993.947278679434, 1882.479085315071, 2124.2298196342417, 4853.427600044577, 3379.1889796192236, 3019.9826215860744, 5090.910656682563, 4491.91343537808, 3860.254803590151, 3026.2068363875223, 6929.250606647406, 3568.778445319095, 4438.62783727979, 649.3221025889045, 6710.57762390892, 2034.9228333017531, 3621.5315691591054, 5148.055112508867, 5581.546236191227, 3932.682266143721, 3759.0165566713868, 5085.174028313846, 2357.8842814588675, 4447.057250793464, 5129.962470283579, 4430.594208355909, 3080.55333443229, 193.15456817223418, 2296.656641589907, 5621.111642761553, 4103.103492293793, 3323.433097528269, 7413.497268479274, 501.3585443181253, 3108.1019334635994, 2380.37695132928, 4455.307813420398, 2932.9715466008925, 4133.859487561769, 2337.027779371098, 6316.744293643003, 3262.566000456832, 4229.433564984844, 5674.664875607966], "policy_adversary_policy_reward": [-7821.457988566606, -5877.9287075654165, -8989.619402470818, -6981.943158589072, -8245.101254178398, -4021.1098398324343, -3345.8833241006528, -7013.523237961279, -3177.9115400163864, -4385.819088326659, -6585.963488053404, -7543.343211178686, -7275.497909350134, -5303.500775842466, -7794.4566357194935, -7704.287046552707, -5286.9633404085, -5302.825835622451, -3872.040236405965, -2612.4670835906027, -5282.959969390635, -3176.9168463006818, -6785.642523946641, -5039.830210177768, -9646.572863078678, -7204.571867400746, -9906.608849540793, -6178.798727317864, -6395.227068111132, -7534.261198282007, -5202.011725728489, -3370.6803995673645, -10712.825897804933, -7803.676685841076, -4275.329253007706, -7124.543371821885, -4577.784181527386, -6140.138143351273, -99.92270089541252, -984.1366224269258, -8522.531024652597, -4050.3099126210154, -3150.9014829563625, -4879.6995881394305, -3013.0082070265817, -7248.371618023606, -6914.46386454706, -9514.349452590788, -7734.595306932837, -5229.928906882749, -4453.901602382174, -4188.683339248657, -4982.227149182457, -6836.334151391949, -5828.348103908915, -5058.948896692423, -6118.486223692574, -6030.103071156089, -5351.5982275320675, -6933.268529702468, -6277.293942551439, -1049.6170427282818, -5355.233503500835, -5381.735631217063, -3932.2726185892916, -5778.910833776021, -564.5641074147569, -829.4715071519574, -7255.309944931833, -6304.210536012434, -6374.829522790274, -6943.189861629679, -5222.333306029701, -6728.973329533384, -3597.4244813193873, -4750.3950997543525, -5132.348967213146, -5088.388166219423, -3336.2926430036678, -9477.00932687195, -8151.687565412632, -3190.0065610407146, -3503.2711004736843, -906.3313626085788, -5914.778266657894, -1747.777094063395, -9146.519282309022, -3721.290529171515, -5154.818965808869, -10518.048490481473, -2071.417284535223, -4255.647380786753, -5523.6828034988, -5557.873263993262, -3828.1859617984364, -5275.303286835956, -5468.277938850673, -5594.272299047096, -3158.514462473244, -5438.554836182497, -6333.063616765077, -6968.078241994777, -5225.535553026659, -3916.122616035835, -5595.979610554944, -5070.383673241439, -2278.9227370837416, -6037.947127745847, -7045.279699640332, -2566.5847126308986, -9281.79638320718, -3115.0135034231366, -6429.043051623767, -5030.378191888334, -1882.479085315071, -4435.419549375629, -2124.2298196342417, -6855.595527270141, -4970.636630396638, -6317.260974679612, -5712.367105131479, -3379.1889796192236, -4929.931761835898, -4904.292708412712, -5090.910656682563, -8960.284238193923, -8103.363071493593, -4500.825632318279, -4164.167917840419, -5042.819098964308, -4862.046344927286, -3026.2068363875223, -6936.77411417496, -7726.645640891763, -3568.778445319095, -5788.11617572535, -4438.62783727979, -6977.849033815652, -1168.4350838379266, -746.6270404048252, -6797.553509802229, -7338.288467295776, -2829.270504231681, -4591.011658064593, -3621.5315691591054, -6782.851056192548, -7740.661893671972, -5359.92794570395, -6295.732309343103, -6166.312605487316, -3932.682266143721, -8198.581431201166, -5027.6948631671585, -4162.387268812022, -5605.800835424721, -5438.847822540852, -3304.690526907252, -5553.82952596554, -4447.057250793464, -6510.859373371671, -6400.528985033174, -5129.962470283579, -6804.043243357175, -4890.477939924897, -3241.026064910772, -3767.018501661178, -193.15456817223418, -2226.529991969938, -2296.656641589907, -5384.618327219124, -5621.111642761553, -9755.686984105669, -4568.933010616666, -4904.207838786998, -7001.214862612958, -3758.1256449896905, -7959.592702663315, -7882.7175882513175, -607.1385231333765, -529.5319038419376, -4738.425681655171, -4307.522352217662, -3395.411602789038, -2383.9576324163677, -7151.059680954848, -4455.307813420398, -2936.825089043861, -6841.831029397693, -6317.932103741313, -5499.545404683747, -2337.027779371098, -4795.241517191466, -6719.6238749343665, -6437.455294555775, -6926.463039549155, -3363.184558090925, -4580.883519388719, -6641.652286078885, -7878.49829841167, -5681.8990962838225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401047188477863, "mean_inference_ms": 0.9734585676391316, "mean_action_processing_ms": 0.1678614470028944, "mean_env_wait_ms": 0.05124108606372275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034432411193847656, "StateBufferConnector_ms": 0.0024907588958740234, "ViewRequirementAgentConnector_ms": 0.07178294658660889}, "num_episodes": 22, "episode_return_max": -635.3118826571889, "episode_return_min": -10712.82589780493, "episode_return_mean": -6520.575785806911}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 566.6362316531211, "num_env_steps_trained_throughput_per_sec": 566.6362316531211, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 7329.18, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7329.148, "sample_time_ms": 748.842, "learn_time_ms": 6568.413, "learn_throughput": 608.975, "synch_weights_time_ms": 11.412}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 100, "trial_id": "3439d_00000", "date": "2024-08-09_15-38-55", "timestamp": 1723232335, "time_this_iter_s": 7.0634071826934814, "time_total_s": 755.1348352432251, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3057550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 755.1348352432251, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 24.66, "ram_util_percent": 80.79}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1886783680257698, "cur_kl_coeff": 5.766503906249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.079013364513715, "policy_loss": 0.009294185126782395, "vf_loss": 9.987904500961303, "vf_explained_var": -0.00017422853658596675, "kl": 0.014187921144912252, "entropy": 1.3455953715989988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7664970391799533, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001109703003413, "policy_loss": 0.004688557681120025, "vf_loss": 9.994591480335862, "vf_explained_var": -0.00033237032158664926, "kl": 0.012197849627278707, "entropy": 0.8299725009020044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "env_runners": {"episode_reward_max": -635.3118826571889, "episode_reward_min": -10518.048490481473, "episode_reward_mean": -6439.125724570904, "episode_len_mean": 191.36, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19136, "policy_reward_min": {"agent_policy": 124.26935301473782, "adversary_policy": -10518.048490481473}, "policy_reward_max": {"agent_policy": 8097.5143770198265, "adversary_policy": -124.26935301473782}, "policy_reward_mean": {"agent_policy": 3991.762982559049, "adversary_policy": -5215.444353564976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4965.135479331074, -7444.693547662829, -9548.13324592335, -7734.595306932836, -4661.64984128393, -7288.312505634709, -5851.336325411199, -6527.55823469183, -6934.953817297152, -6277.293942551438, -5638.563788675105, -6173.151975278212, -829.4715071519574, -7272.574051520295, -6996.825031976008, -6728.973329533384, -4944.457796458202, -5298.800282484948, -9477.00932687195, -8151.6875654126325, -3503.2711004736843, -5914.778266657895, -9146.51928230902, -10518.048490481473, -4528.398299571578, -5673.979702171207, -5275.303286835956, -5677.549308890103, -5643.433345383084, -8138.701651819766, -5234.593848458106, -5863.561822753246, -6710.9205614979, -7045.279699640332, -9281.79638320718, -6465.4739648326695, -4435.419549375629, -6855.595527270141, -6434.470005031672, -5712.36710513148, -6814.24184866254, -8960.284238193923, -8112.275268433792, -5346.732213214587, -4862.046344927285, -7734.169148419317, -5788.11617572535, -6977.849033815652, -1265.7400216538474, -7425.264353189086, -5385.3593289945275, -6782.851056192548, -7952.534726867058, -6880.498678639188, -8198.581431201166, -5431.065575307787, -5959.474629651729, -6500.635771413925, -6510.859373371671, -6400.528985033174, -7263.92697492616, -3927.491232139662, -2226.529991969938, -5384.618327219124, -9755.686984105669, -5370.037357109865, -7435.907410074378, -8428.81302243536, -635.3118826571889, -5937.846100409227, -3398.9922838761267, -7151.059680954849, -6845.684571840662, -7683.618020863278, -4795.241517191466, -6840.334875847137, -7027.08159718325, -6993.102240482769, -7885.732519087526, -6500.703827088329, -9299.231614730303, -5582.936921040646, -7446.994033105268, -726.2554264073284, -5371.721482456803, -7031.717343648549, -9917.443515169634, -8634.17162047248, -7576.752685664787, -7779.8874074270225, -7953.160275438126, -3785.5636706606474, -6072.14612397856, -5011.2240434146715, -7847.208295410033, -9553.520409521368, -9068.35245179661, -7120.878393909138, -3377.7861376513783, -7174.153880941581], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 110, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 196, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 55, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 194, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3065.4655917647183, 2816.686277387359, 6880.680071214496, 5229.928906882749, 3980.9351003469005, 4530.248794939688, 5035.960675190139, 5621.031060156832, 5349.912939937383, 1049.6170427282818, 5098.405346042793, 3538.0314770871023, 564.5641074147569, 6286.946429423972, 6321.194352443946, 5222.333306029701, 3403.361784615536, 4921.936850947618, 3336.2926430036678, 3190.0065610407146, 906.3313626085788, 1747.777094063395, 3721.290529171515, 5154.818965808869, 1798.666365750405, 5407.576365320856, 3828.1859617984364, 5385.000929007666, 2953.6359532726533, 5162.440206940087, 3907.0643206043865, 4802.801461043146, 1605.949303331681, 2566.5847126308986, 3115.0135034231366, 4993.947278679434, 1882.479085315071, 2124.2298196342417, 4853.427600044577, 3379.1889796192236, 3019.9826215860744, 5090.910656682563, 4491.91343537808, 3860.254803590151, 3026.2068363875223, 6929.250606647406, 3568.778445319095, 4438.62783727979, 649.3221025889045, 6710.57762390892, 2034.9228333017531, 3621.5315691591054, 5148.055112508867, 5581.546236191227, 3932.682266143721, 3759.0165566713868, 5085.174028313846, 2357.8842814588675, 4447.057250793464, 5129.962470283579, 4430.594208355909, 3080.55333443229, 193.15456817223418, 2296.656641589907, 5621.111642761553, 4103.103492293793, 3323.433097528269, 7413.497268479274, 501.3585443181253, 3108.1019334635994, 2380.37695132928, 4455.307813420398, 2932.9715466008925, 4133.859487561769, 2337.027779371098, 6316.744293643003, 3262.566000456832, 4229.433564984844, 5674.664875607966, 4156.4471254452765, 6218.3518314800785, 5021.803362231837, 4313.984817643939, 124.26935301473782, 2178.6201235448407, 2563.374037586175, 8097.5143770198265, 1825.2971947376031, 6047.359841524653, 5440.772747138434, 6349.224886009834, 3287.535718638971, 4207.165729834585, 2417.4239544590882, 6577.524178824594, 2692.6116150353596, 7712.064044179529, 6360.052766805441, 1972.4946696609718, 4194.282145857139], "policy_adversary_policy_reward": [-3150.9014829563625, -4879.6995881394305, -3013.0082070265817, -7248.371618023606, -6914.46386454706, -9514.349452590788, -7734.595306932837, -5229.928906882749, -4453.901602382174, -4188.683339248657, -4982.227149182457, -6836.334151391949, -5828.348103908915, -5058.948896692423, -6118.486223692574, -6030.103071156089, -5351.5982275320675, -6933.268529702468, -6277.293942551439, -1049.6170427282818, -5355.233503500835, -5381.735631217063, -3932.2726185892916, -5778.910833776021, -564.5641074147569, -829.4715071519574, -7255.309944931833, -6304.210536012434, -6374.829522790274, -6943.189861629679, -5222.333306029701, -6728.973329533384, -3597.4244813193873, -4750.3950997543525, -5132.348967213146, -5088.388166219423, -3336.2926430036678, -9477.00932687195, -8151.687565412632, -3190.0065610407146, -3503.2711004736843, -906.3313626085788, -5914.778266657894, -1747.777094063395, -9146.519282309022, -3721.290529171515, -5154.818965808869, -10518.048490481473, -2071.417284535223, -4255.647380786753, -5523.6828034988, -5557.873263993262, -3828.1859617984364, -5275.303286835956, -5468.277938850673, -5594.272299047096, -3158.514462473244, -5438.554836182497, -6333.063616765077, -6968.078241994777, -5225.535553026659, -3916.122616035835, -5595.979610554944, -5070.383673241439, -2278.9227370837416, -6037.947127745847, -7045.279699640332, -2566.5847126308986, -9281.79638320718, -3115.0135034231366, -6429.043051623767, -5030.378191888334, -1882.479085315071, -4435.419549375629, -2124.2298196342417, -6855.595527270141, -4970.636630396638, -6317.260974679612, -5712.367105131479, -3379.1889796192236, -4929.931761835898, -4904.292708412712, -5090.910656682563, -8960.284238193923, -8103.363071493593, -4500.825632318279, -4164.167917840419, -5042.819098964308, -4862.046344927286, -3026.2068363875223, -6936.77411417496, -7726.645640891763, -3568.778445319095, -5788.11617572535, -4438.62783727979, -6977.849033815652, -1168.4350838379266, -746.6270404048252, -6797.553509802229, -7338.288467295776, -2829.270504231681, -4591.011658064593, -3621.5315691591054, -6782.851056192548, -7740.661893671972, -5359.92794570395, -6295.732309343103, -6166.312605487316, -3932.682266143721, -8198.581431201166, -5027.6948631671585, -4162.387268812022, -5605.800835424721, -5438.847822540852, -3304.690526907252, -5553.82952596554, -4447.057250793464, -6510.859373371671, -6400.528985033174, -5129.962470283579, -6804.043243357175, -4890.477939924897, -3241.026064910772, -3767.018501661178, -193.15456817223418, -2226.529991969938, -2296.656641589907, -5384.618327219124, -5621.111642761553, -9755.686984105669, -4568.933010616666, -4904.207838786998, -7001.214862612958, -3758.1256449896905, -7959.592702663315, -7882.7175882513175, -607.1385231333765, -529.5319038419376, -4738.425681655171, -4307.522352217662, -3395.411602789038, -2383.9576324163677, -7151.059680954848, -4455.307813420398, -2936.825089043861, -6841.831029397693, -6317.932103741313, -5499.545404683747, -2337.027779371098, -4795.241517191466, -6719.6238749343665, -6437.455294555775, -6926.463039549155, -3363.184558090925, -4580.883519388719, -6641.652286078885, -7878.49829841167, -5681.8990962838225, -5870.865007531389, -4786.285945002226, -7895.732009301797, -7621.851436908584, -5555.316407371016, -5049.423875901466, -6957.8978608132165, -4803.080989935993, -726.2554264073284, -124.26935301473782, -5027.220200603561, -2523.1214053980757, -2563.374037586175, -7031.717343648549, -9911.847685074199, -8103.1102071152645, -8345.788700361523, -2113.680114848565, -7137.695845041034, -6486.416682148409, -5440.772747138434, -7779.887407427022, -7953.1602754381265, -6349.224886009834, -3641.9841130902123, -3431.1152762094057, -5757.974272422748, -4521.337581390399, -2665.7222941775403, -4762.9257036962235, -7847.208295410033, -6577.524178824594, -2692.6116150353596, -9553.520409521368, -8885.334326347458, -7895.082169628684, -6521.80364952755, -6959.127511187029, -1972.4946696609718, -3377.7861376513783, -6954.933897030001, -4413.502129768713]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.400974966636156, "mean_inference_ms": 0.9738824584666999, "mean_action_processing_ms": 0.1678782718056045, "mean_env_wait_ms": 0.05123401544408543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003239870071411133, "StateBufferConnector_ms": 0.0024077892303466797, "ViewRequirementAgentConnector_ms": 0.0677269697189331}, "num_episodes": 21, "episode_return_max": -635.3118826571889, "episode_return_min": -10518.048490481473, "episode_return_mean": -6439.125724570904}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.8492016883534, "num_env_steps_trained_throughput_per_sec": 542.8492016883534, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 7296.841, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7296.809, "sample_time_ms": 750.191, "learn_time_ms": 6534.494, "learn_throughput": 612.136, "synch_weights_time_ms": 11.604}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "training_iteration": 101, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-03", "timestamp": 1723232343, "time_this_iter_s": 7.372635841369629, "time_total_s": 762.5074710845947, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3057790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 762.5074710845947, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 80.72727272727275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1442519965581597, "cur_kl_coeff": 5.766503906249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.092340198159217, "policy_loss": 0.013102160085448606, "vf_loss": 9.99551172554493, "vf_explained_var": 0.00028637442737817765, "kl": 0.014519423136031643, "entropy": 1.3467110479871431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7253436951252519, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002464923656806, "policy_loss": 0.003229893132719019, "vf_loss": 9.997145103777527, "vf_explained_var": 0.0001975700653419293, "kl": 0.013932921807897626, "entropy": 0.8618575093607423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": -635.3118826571889, "episode_reward_min": -10787.160079609088, "episode_reward_mean": -6561.3198050971105, "episode_len_mean": 192.86, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19286, "policy_reward_min": {"agent_policy": 124.26935301473782, "adversary_policy": -10783.772810276385}, "policy_reward_max": {"agent_policy": 10202.453574236308, "adversary_policy": -124.26935301473782}, "policy_reward_mean": {"agent_policy": 4060.783855578565, "adversary_policy": -5311.051830337837}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3503.2711004736843, -5914.778266657895, -9146.51928230902, -10518.048490481473, -4528.398299571578, -5673.979702171207, -5275.303286835956, -5677.549308890103, -5643.433345383084, -8138.701651819766, -5234.593848458106, -5863.561822753246, -6710.9205614979, -7045.279699640332, -9281.79638320718, -6465.4739648326695, -4435.419549375629, -6855.595527270141, -6434.470005031672, -5712.36710513148, -6814.24184866254, -8960.284238193923, -8112.275268433792, -5346.732213214587, -4862.046344927285, -7734.169148419317, -5788.11617572535, -6977.849033815652, -1265.7400216538474, -7425.264353189086, -5385.3593289945275, -6782.851056192548, -7952.534726867058, -6880.498678639188, -8198.581431201166, -5431.065575307787, -5959.474629651729, -6500.635771413925, -6510.859373371671, -6400.528985033174, -7263.92697492616, -3927.491232139662, -2226.529991969938, -5384.618327219124, -9755.686984105669, -5370.037357109865, -7435.907410074378, -8428.81302243536, -635.3118826571889, -5937.846100409227, -3398.9922838761267, -7151.059680954849, -6845.684571840662, -7683.618020863278, -4795.241517191466, -6840.334875847137, -7027.08159718325, -6993.102240482769, -7885.732519087526, -6500.703827088329, -9299.231614730303, -5582.936921040646, -7446.994033105268, -726.2554264073284, -5371.721482456803, -7031.717343648549, -9917.443515169634, -8634.17162047248, -7576.752685664787, -7779.8874074270225, -7953.160275438126, -3785.5636706606474, -6072.14612397856, -5011.2240434146715, -7847.208295410033, -9553.520409521368, -9068.35245179661, -7120.878393909138, -3377.7861376513783, -7174.153880941581, -6788.670146611226, -6908.370743092266, -8869.666232296817, -5516.8225609569745, -5423.257017835442, -5212.590338067366, -6464.094450686556, -6667.564875733491, -8157.219597357273, -7126.838796101568, -5681.782178390216, -8938.55457865672, -6608.871573978449, -8923.505636818894, -4800.827027338188, -6765.125647539589, -7329.895163272992, -10787.160079609088, -6355.299150372264, -7638.469159988504], "episode_lengths": [110, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 196, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 55, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 194, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [906.3313626085788, 1747.777094063395, 3721.290529171515, 5154.818965808869, 1798.666365750405, 5407.576365320856, 3828.1859617984364, 5385.000929007666, 2953.6359532726533, 5162.440206940087, 3907.0643206043865, 4802.801461043146, 1605.949303331681, 2566.5847126308986, 3115.0135034231366, 4993.947278679434, 1882.479085315071, 2124.2298196342417, 4853.427600044577, 3379.1889796192236, 3019.9826215860744, 5090.910656682563, 4491.91343537808, 3860.254803590151, 3026.2068363875223, 6929.250606647406, 3568.778445319095, 4438.62783727979, 649.3221025889045, 6710.57762390892, 2034.9228333017531, 3621.5315691591054, 5148.055112508867, 5581.546236191227, 3932.682266143721, 3759.0165566713868, 5085.174028313846, 2357.8842814588675, 4447.057250793464, 5129.962470283579, 4430.594208355909, 3080.55333443229, 193.15456817223418, 2296.656641589907, 5621.111642761553, 4103.103492293793, 3323.433097528269, 7413.497268479274, 501.3585443181253, 3108.1019334635994, 2380.37695132928, 4455.307813420398, 2932.9715466008925, 4133.859487561769, 2337.027779371098, 6316.744293643003, 3262.566000456832, 4229.433564984844, 5674.664875607966, 4156.4471254452765, 6218.3518314800785, 5021.803362231837, 4313.984817643939, 124.26935301473782, 2178.6201235448407, 2563.374037586175, 8097.5143770198265, 1825.2971947376031, 6047.359841524653, 5440.772747138434, 6349.224886009834, 3287.535718638971, 4207.165729834585, 2417.4239544590882, 6577.524178824594, 2692.6116150353596, 7712.064044179529, 6360.052766805441, 1972.4946696609718, 4194.282145857139, 5030.776201462198, 5747.637424149981, 4733.069427989212, 4232.418489578711, 3504.7039821670983, 2066.9075459516157, 5097.473800894752, 3788.720236171807, 4903.424072207819, 4689.203634532447, 3794.247463410903, 4933.807178037729, 3552.283340577028, 5477.749610966848, 2729.3397931116433, 3929.3833259464855, 6253.2469133415, 10202.453574236308, 2661.5052878031397, 5017.275318012759], "policy_adversary_policy_reward": [-3503.2711004736843, -906.3313626085788, -5914.778266657894, -1747.777094063395, -9146.519282309022, -3721.290529171515, -5154.818965808869, -10518.048490481473, -2071.417284535223, -4255.647380786753, -5523.6828034988, -5557.873263993262, -3828.1859617984364, -5275.303286835956, -5468.277938850673, -5594.272299047096, -3158.514462473244, -5438.554836182497, -6333.063616765077, -6968.078241994777, -5225.535553026659, -3916.122616035835, -5595.979610554944, -5070.383673241439, -2278.9227370837416, -6037.947127745847, -7045.279699640332, -2566.5847126308986, -9281.79638320718, -3115.0135034231366, -6429.043051623767, -5030.378191888334, -1882.479085315071, -4435.419549375629, -2124.2298196342417, -6855.595527270141, -4970.636630396638, -6317.260974679612, -5712.367105131479, -3379.1889796192236, -4929.931761835898, -4904.292708412712, -5090.910656682563, -8960.284238193923, -8103.363071493593, -4500.825632318279, -4164.167917840419, -5042.819098964308, -4862.046344927286, -3026.2068363875223, -6936.77411417496, -7726.645640891763, -3568.778445319095, -5788.11617572535, -4438.62783727979, -6977.849033815652, -1168.4350838379266, -746.6270404048252, -6797.553509802229, -7338.288467295776, -2829.270504231681, -4591.011658064593, -3621.5315691591054, -6782.851056192548, -7740.661893671972, -5359.92794570395, -6295.732309343103, -6166.312605487316, -3932.682266143721, -8198.581431201166, -5027.6948631671585, -4162.387268812022, -5605.800835424721, -5438.847822540852, -3304.690526907252, -5553.82952596554, -4447.057250793464, -6510.859373371671, -6400.528985033174, -5129.962470283579, -6804.043243357175, -4890.477939924897, -3241.026064910772, -3767.018501661178, -193.15456817223418, -2226.529991969938, -2296.656641589907, -5384.618327219124, -5621.111642761553, -9755.686984105669, -4568.933010616666, -4904.207838786998, -7001.214862612958, -3758.1256449896905, -7959.592702663315, -7882.7175882513175, -607.1385231333765, -529.5319038419376, -4738.425681655171, -4307.522352217662, -3395.411602789038, -2383.9576324163677, -7151.059680954848, -4455.307813420398, -2936.825089043861, -6841.831029397693, -6317.932103741313, -5499.545404683747, -2337.027779371098, -4795.241517191466, -6719.6238749343665, -6437.455294555775, -6926.463039549155, -3363.184558090925, -4580.883519388719, -6641.652286078885, -7878.49829841167, -5681.8990962838225, -5870.865007531389, -4786.285945002226, -7895.732009301797, -7621.851436908584, -5555.316407371016, -5049.423875901466, -6957.8978608132165, -4803.080989935993, -726.2554264073284, -124.26935301473782, -5027.220200603561, -2523.1214053980757, -2563.374037586175, -7031.717343648549, -9911.847685074199, -8103.1102071152645, -8345.788700361523, -2113.680114848565, -7137.695845041034, -6486.416682148409, -5440.772747138434, -7779.887407427022, -7953.1602754381265, -6349.224886009834, -3641.9841130902123, -3431.1152762094057, -5757.974272422748, -4521.337581390399, -2665.7222941775403, -4762.9257036962235, -7847.208295410033, -6577.524178824594, -2692.6116150353596, -9553.520409521368, -8885.334326347458, -7895.082169628684, -6521.80364952755, -6959.127511187029, -1972.4946696609718, -3377.7861376513783, -6954.933897030001, -4413.502129768713, -5030.776201462198, -6788.670146611226, -5896.561163647581, -6759.447003594665, -4733.069427989212, -8869.666232296817, -5515.200921746916, -4234.040128788769, -5407.504204265407, -3520.4567957371396, -5212.590338067366, -2066.9075459516157, -5562.625613401608, -5998.942638179698, -3788.720236171807, -6667.564875733491, -8141.79507669899, -4918.848592866103, -7126.838796101568, -4689.203634532447, -4589.556498994036, -4886.473142807092, -4933.807178037729, -8938.55457865672, -3552.283340577028, -6608.871573978449, -8923.505636818894, -5477.749610966848, -4800.827027338187, -2729.3397931116433, -6765.125647539589, -3929.3833259464855, -7329.895163272994, -6253.2469133415, -10205.840843569013, -10783.772810276385, -6272.9345354190455, -2743.8699027563575, -5996.7370570978555, -6659.007420903413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40091357622357393, "mean_inference_ms": 0.9737027294430567, "mean_action_processing_ms": 0.1677629955608755, "mean_env_wait_ms": 0.05123270087634238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032024383544921875, "StateBufferConnector_ms": 0.0023697614669799805, "ViewRequirementAgentConnector_ms": 0.0661553144454956}, "num_episodes": 20, "episode_return_max": -635.3118826571889, "episode_return_min": -10787.160079609088, "episode_return_mean": -6561.3198050971105}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 559.2564348579645, "num_env_steps_trained_throughput_per_sec": 559.2564348579645, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 7262.4, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7262.367, "sample_time_ms": 746.739, "learn_time_ms": 6503.162, "learn_throughput": 615.085, "synch_weights_time_ms": 11.939}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 102, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-10", "timestamp": 1723232350, "time_this_iter_s": 7.157686948776245, "time_total_s": 769.665158033371, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 769.665158033371, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 25.109999999999996, "ram_util_percent": 80.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2106851143452029, "cur_kl_coeff": 5.766503906249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.123966336250305, "policy_loss": 0.01376305253021807, "vf_loss": 9.994533834854762, "vf_explained_var": 0.0003684441869457563, "kl": 0.020058854882760595, "entropy": 1.359317565461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.692386116694521, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9998296974828, "policy_loss": -0.00014168662684304372, "vf_loss": 9.99843734256805, "vf_explained_var": 0.00013053357285797281, "kl": 0.010227016523904191, "entropy": 0.8267456767735658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "env_runners": {"episode_reward_max": -114.05000801728256, "episode_reward_min": -10787.160079609088, "episode_reward_mean": -6386.144039486517, "episode_len_mean": 191.8, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19180, "policy_reward_min": {"agent_policy": 6.769703197972, "adversary_policy": -10783.772810276385}, "policy_reward_max": {"agent_policy": 10202.453574236308, "adversary_policy": -6.769703197972}, "policy_reward_mean": {"agent_policy": 4068.2110226144882, "adversary_policy": -5227.177531050502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5712.36710513148, -6814.24184866254, -8960.284238193923, -8112.275268433792, -5346.732213214587, -4862.046344927285, -7734.169148419317, -5788.11617572535, -6977.849033815652, -1265.7400216538474, -7425.264353189086, -5385.3593289945275, -6782.851056192548, -7952.534726867058, -6880.498678639188, -8198.581431201166, -5431.065575307787, -5959.474629651729, -6500.635771413925, -6510.859373371671, -6400.528985033174, -7263.92697492616, -3927.491232139662, -2226.529991969938, -5384.618327219124, -9755.686984105669, -5370.037357109865, -7435.907410074378, -8428.81302243536, -635.3118826571889, -5937.846100409227, -3398.9922838761267, -7151.059680954849, -6845.684571840662, -7683.618020863278, -4795.241517191466, -6840.334875847137, -7027.08159718325, -6993.102240482769, -7885.732519087526, -6500.703827088329, -9299.231614730303, -5582.936921040646, -7446.994033105268, -726.2554264073284, -5371.721482456803, -7031.717343648549, -9917.443515169634, -8634.17162047248, -7576.752685664787, -7779.8874074270225, -7953.160275438126, -3785.5636706606474, -6072.14612397856, -5011.2240434146715, -7847.208295410033, -9553.520409521368, -9068.35245179661, -7120.878393909138, -3377.7861376513783, -7174.153880941581, -6788.670146611226, -6908.370743092266, -8869.666232296817, -5516.8225609569745, -5423.257017835442, -5212.590338067366, -6464.094450686556, -6667.564875733491, -8157.219597357273, -7126.838796101568, -5681.782178390216, -8938.55457865672, -6608.871573978449, -8923.505636818894, -4800.827027338188, -6765.125647539589, -7329.895163272992, -10787.160079609088, -6355.299150372264, -7638.469159988504, -3006.007455113455, -5083.276002995164, -4325.016756838968, -3888.6631471240225, -10459.360304357911, -5041.204681843376, -9551.76186003886, -6249.364169901141, -114.05000801728256, -8654.406095522254, -6075.533485022818, -4494.721410727394, -4317.987064280157, -8181.645709541949, -6086.023146460768, -6263.637707249128, -3381.37611908148, -4100.832219699929, -5554.650191785047], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 196, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 55, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 194, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3379.1889796192236, 3019.9826215860744, 5090.910656682563, 4491.91343537808, 3860.254803590151, 3026.2068363875223, 6929.250606647406, 3568.778445319095, 4438.62783727979, 649.3221025889045, 6710.57762390892, 2034.9228333017531, 3621.5315691591054, 5148.055112508867, 5581.546236191227, 3932.682266143721, 3759.0165566713868, 5085.174028313846, 2357.8842814588675, 4447.057250793464, 5129.962470283579, 4430.594208355909, 3080.55333443229, 193.15456817223418, 2296.656641589907, 5621.111642761553, 4103.103492293793, 3323.433097528269, 7413.497268479274, 501.3585443181253, 3108.1019334635994, 2380.37695132928, 4455.307813420398, 2932.9715466008925, 4133.859487561769, 2337.027779371098, 6316.744293643003, 3262.566000456832, 4229.433564984844, 5674.664875607966, 4156.4471254452765, 6218.3518314800785, 5021.803362231837, 4313.984817643939, 124.26935301473782, 2178.6201235448407, 2563.374037586175, 8097.5143770198265, 1825.2971947376031, 6047.359841524653, 5440.772747138434, 6349.224886009834, 3287.535718638971, 4207.165729834585, 2417.4239544590882, 6577.524178824594, 2692.6116150353596, 7712.064044179529, 6360.052766805441, 1972.4946696609718, 4194.282145857139, 5030.776201462198, 5747.637424149981, 4733.069427989212, 4232.418489578711, 3504.7039821670983, 2066.9075459516157, 5097.473800894752, 3788.720236171807, 4903.424072207819, 4689.203634532447, 3794.247463410903, 4933.807178037729, 3552.283340577028, 5477.749610966848, 2729.3397931116433, 3929.3833259464855, 6253.2469133415, 10202.453574236308, 2661.5052878031397, 5017.275318012759, 1164.5036319509286, 3272.245391858449, 3035.1304819926468, 3168.0598669932665, 9433.94398002117, 3643.9481030714196, 5067.8372705541815, 3182.089050269057, 6.769703197972, 4231.831715620748, 5070.960626415362, 1720.4865199713754, 2400.4751797954523, 5293.549398527662, 4824.009337837363, 3100.351447891564, 1747.8382288257283, 3816.0015523611864, 2479.9060348858015], "policy_adversary_policy_reward": [-5712.367105131479, -3379.1889796192236, -4929.931761835898, -4904.292708412712, -5090.910656682563, -8960.284238193923, -8103.363071493593, -4500.825632318279, -4164.167917840419, -5042.819098964308, -4862.046344927286, -3026.2068363875223, -6936.77411417496, -7726.645640891763, -3568.778445319095, -5788.11617572535, -4438.62783727979, -6977.849033815652, -1168.4350838379266, -746.6270404048252, -6797.553509802229, -7338.288467295776, -2829.270504231681, -4591.011658064593, -3621.5315691591054, -6782.851056192548, -7740.661893671972, -5359.92794570395, -6295.732309343103, -6166.312605487316, -3932.682266143721, -8198.581431201166, -5027.6948631671585, -4162.387268812022, -5605.800835424721, -5438.847822540852, -3304.690526907252, -5553.82952596554, -4447.057250793464, -6510.859373371671, -6400.528985033174, -5129.962470283579, -6804.043243357175, -4890.477939924897, -3241.026064910772, -3767.018501661178, -193.15456817223418, -2226.529991969938, -2296.656641589907, -5384.618327219124, -5621.111642761553, -9755.686984105669, -4568.933010616666, -4904.207838786998, -7001.214862612958, -3758.1256449896905, -7959.592702663315, -7882.7175882513175, -607.1385231333765, -529.5319038419376, -4738.425681655171, -4307.522352217662, -3395.411602789038, -2383.9576324163677, -7151.059680954848, -4455.307813420398, -2936.825089043861, -6841.831029397693, -6317.932103741313, -5499.545404683747, -2337.027779371098, -4795.241517191466, -6719.6238749343665, -6437.455294555775, -6926.463039549155, -3363.184558090925, -4580.883519388719, -6641.652286078885, -7878.49829841167, -5681.8990962838225, -5870.865007531389, -4786.285945002226, -7895.732009301797, -7621.851436908584, -5555.316407371016, -5049.423875901466, -6957.8978608132165, -4803.080989935993, -726.2554264073284, -124.26935301473782, -5027.220200603561, -2523.1214053980757, -2563.374037586175, -7031.717343648549, -9911.847685074199, -8103.1102071152645, -8345.788700361523, -2113.680114848565, -7137.695845041034, -6486.416682148409, -5440.772747138434, -7779.887407427022, -7953.1602754381265, -6349.224886009834, -3641.9841130902123, -3431.1152762094057, -5757.974272422748, -4521.337581390399, -2665.7222941775403, -4762.9257036962235, -7847.208295410033, -6577.524178824594, -2692.6116150353596, -9553.520409521368, -8885.334326347458, -7895.082169628684, -6521.80364952755, -6959.127511187029, -1972.4946696609718, -3377.7861376513783, -6954.933897030001, -4413.502129768713, -5030.776201462198, -6788.670146611226, -5896.561163647581, -6759.447003594665, -4733.069427989212, -8869.666232296817, -5515.200921746916, -4234.040128788769, -5407.504204265407, -3520.4567957371396, -5212.590338067366, -2066.9075459516157, -5562.625613401608, -5998.942638179698, -3788.720236171807, -6667.564875733491, -8141.79507669899, -4918.848592866103, -7126.838796101568, -4689.203634532447, -4589.556498994036, -4886.473142807092, -4933.807178037729, -8938.55457865672, -3552.283340577028, -6608.871573978449, -8923.505636818894, -5477.749610966848, -4800.827027338187, -2729.3397931116433, -6765.125647539589, -3929.3833259464855, -7329.895163272994, -6253.2469133415, -10205.840843569013, -10783.772810276385, -6272.9345354190455, -2743.8699027563575, -5996.7370570978555, -6659.007420903413, -1164.5036319509286, -3006.007455113455, -4857.3435915065, -3498.1778033471132, -3229.1846006601263, -4130.962638171492, -3659.5872341182353, -3397.135779999054, -10201.283430798883, -9692.020853580205, -5039.419206569587, -3645.733578345207, -5067.8372705541815, -9551.76186003886, -3182.089050269057, -6249.364169901141, -114.05000801728255, -6.769703197972, -8654.406095522254, -4231.831715620748, -5070.960626415362, -6075.533485022817, -4382.040635720421, -1833.1672949783506, -3627.36805383944, -3091.094190236165, -5293.549398527662, -8181.645709541949, -5566.0094197286335, -5344.023064569501, -3589.6493216007457, -5774.339833539948, -1762.3189031509378, -3366.8954447562687, -3870.458604583656, -4046.3751674774603, -3089.7867830954765, -4944.7694435753765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4008130468478579, "mean_inference_ms": 0.9735991250891533, "mean_action_processing_ms": 0.16770397034412216, "mean_env_wait_ms": 0.05122178806209373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033233165740966797, "StateBufferConnector_ms": 0.0025076866149902344, "ViewRequirementAgentConnector_ms": 0.06641411781311035}, "num_episodes": 19, "episode_return_max": -114.05000801728256, "episode_return_min": -10787.160079609088, "episode_return_mean": -6386.144039486517}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.1938022500473, "num_env_steps_trained_throughput_per_sec": 546.1938022500473, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 7266.017, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7265.984, "sample_time_ms": 754.063, "learn_time_ms": 6499.626, "learn_throughput": 615.42, "synch_weights_time_ms": 11.763}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "training_iteration": 103, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-18", "timestamp": 1723232358, "time_this_iter_s": 7.3295369148254395, "time_total_s": 776.9946949481964, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30579d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 776.9946949481964, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 25.60909090909091, "ram_util_percent": 80.88181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4389075928678114, "cur_kl_coeff": 8.649755859375002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.116603002945583, "policy_loss": 0.004068630405527074, "vf_loss": 9.97635201116403, "vf_explained_var": 1.7695253094037375e-05, "kl": 0.01574407463000777, "entropy": 1.3524858098477126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7688778572139285, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985693142401479, "policy_loss": 0.0007270811344915755, "vf_loss": 9.983834305515996, "vf_explained_var": 3.317203471269557e-05, "kl": 0.007545135115278224, "entropy": 0.8645282896107467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": -114.05000801728256, "episode_reward_min": -10787.160079609088, "episode_reward_mean": -6219.65485359399, "episode_len_mean": 189.48, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18948, "policy_reward_min": {"agent_policy": 6.769703197972, "adversary_policy": -10783.772810276385}, "policy_reward_max": {"agent_policy": 10202.453574236308, "adversary_policy": -6.769703197972}, "policy_reward_mean": {"agent_policy": 3897.431419599063, "adversary_policy": -5058.543136596527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3927.491232139662, -2226.529991969938, -5384.618327219124, -9755.686984105669, -5370.037357109865, -7435.907410074378, -8428.81302243536, -635.3118826571889, -5937.846100409227, -3398.9922838761267, -7151.059680954849, -6845.684571840662, -7683.618020863278, -4795.241517191466, -6840.334875847137, -7027.08159718325, -6993.102240482769, -7885.732519087526, -6500.703827088329, -9299.231614730303, -5582.936921040646, -7446.994033105268, -726.2554264073284, -5371.721482456803, -7031.717343648549, -9917.443515169634, -8634.17162047248, -7576.752685664787, -7779.8874074270225, -7953.160275438126, -3785.5636706606474, -6072.14612397856, -5011.2240434146715, -7847.208295410033, -9553.520409521368, -9068.35245179661, -7120.878393909138, -3377.7861376513783, -7174.153880941581, -6788.670146611226, -6908.370743092266, -8869.666232296817, -5516.8225609569745, -5423.257017835442, -5212.590338067366, -6464.094450686556, -6667.564875733491, -8157.219597357273, -7126.838796101568, -5681.782178390216, -8938.55457865672, -6608.871573978449, -8923.505636818894, -4800.827027338188, -6765.125647539589, -7329.895163272992, -10787.160079609088, -6355.299150372264, -7638.469159988504, -3006.007455113455, -5083.276002995164, -4325.016756838968, -3888.6631471240225, -10459.360304357911, -5041.204681843376, -9551.76186003886, -6249.364169901141, -114.05000801728256, -8654.406095522254, -6075.533485022818, -4494.721410727394, -4317.987064280157, -8181.645709541949, -6086.023146460768, -6263.637707249128, -3381.37611908148, -4100.832219699929, -5554.650191785047, -5828.1907892962445, -5471.043416246719, -7359.126379731198, -4943.362590147, -3005.9779838901554, -1513.8947974421405, -6472.223077237972, -6656.969044941717, -7245.091962857663, -2907.517426206666, -2478.367937245749, -6765.270532420155, -4403.029578222949, -6707.731319692335, -8153.227317274339, -5086.450191629869, -6036.1919349888985, -9067.661257138094, -4219.994239511715, -4828.571659834949, -7982.675549460551, -8483.914708296272], "episode_lengths": [200, 55, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 194, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 100, 82, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3080.55333443229, 193.15456817223418, 2296.656641589907, 5621.111642761553, 4103.103492293793, 3323.433097528269, 7413.497268479274, 501.3585443181253, 3108.1019334635994, 2380.37695132928, 4455.307813420398, 2932.9715466008925, 4133.859487561769, 2337.027779371098, 6316.744293643003, 3262.566000456832, 4229.433564984844, 5674.664875607966, 4156.4471254452765, 6218.3518314800785, 5021.803362231837, 4313.984817643939, 124.26935301473782, 2178.6201235448407, 2563.374037586175, 8097.5143770198265, 1825.2971947376031, 6047.359841524653, 5440.772747138434, 6349.224886009834, 3287.535718638971, 4207.165729834585, 2417.4239544590882, 6577.524178824594, 2692.6116150353596, 7712.064044179529, 6360.052766805441, 1972.4946696609718, 4194.282145857139, 5030.776201462198, 5747.637424149981, 4733.069427989212, 4232.418489578711, 3504.7039821670983, 2066.9075459516157, 5097.473800894752, 3788.720236171807, 4903.424072207819, 4689.203634532447, 3794.247463410903, 4933.807178037729, 3552.283340577028, 5477.749610966848, 2729.3397931116433, 3929.3833259464855, 6253.2469133415, 10202.453574236308, 2661.5052878031397, 5017.275318012759, 1164.5036319509286, 3272.245391858449, 3035.1304819926468, 3168.0598669932665, 9433.94398002117, 3643.9481030714196, 5067.8372705541815, 3182.089050269057, 6.769703197972, 4231.831715620748, 5070.960626415362, 1720.4865199713754, 2400.4751797954523, 5293.549398527662, 4824.009337837363, 3100.351447891564, 1747.8382288257283, 3816.0015523611864, 2479.9060348858015, 4242.988083698176, 4820.955861257796, 5619.654604731064, 2933.925198390194, 2475.841185475991, 225.97822663041643, 5416.995462268216, 5634.096278601098, 5233.054811532288, 1524.85322805674, 603.0108977216346, 4199.7961458035, 2445.7235225090217, 3567.6241027614924, 4133.3413980630985, 3332.478433450167, 2890.522985831679, 2783.7872910835304, 2447.527225362285, 2474.8187425704396, 3283.9321836320423, 3324.574591195985], "policy_adversary_policy_reward": [-3241.026064910772, -3767.018501661178, -193.15456817223418, -2226.529991969938, -2296.656641589907, -5384.618327219124, -5621.111642761553, -9755.686984105669, -4568.933010616666, -4904.207838786998, -7001.214862612958, -3758.1256449896905, -7959.592702663315, -7882.7175882513175, -607.1385231333765, -529.5319038419376, -4738.425681655171, -4307.522352217662, -3395.411602789038, -2383.9576324163677, -7151.059680954848, -4455.307813420398, -2936.825089043861, -6841.831029397693, -6317.932103741313, -5499.545404683747, -2337.027779371098, -4795.241517191466, -6719.6238749343665, -6437.455294555775, -6926.463039549155, -3363.184558090925, -4580.883519388719, -6641.652286078885, -7878.49829841167, -5681.8990962838225, -5870.865007531389, -4786.285945002226, -7895.732009301797, -7621.851436908584, -5555.316407371016, -5049.423875901466, -6957.8978608132165, -4803.080989935993, -726.2554264073284, -124.26935301473782, -5027.220200603561, -2523.1214053980757, -2563.374037586175, -7031.717343648549, -9911.847685074199, -8103.1102071152645, -8345.788700361523, -2113.680114848565, -7137.695845041034, -6486.416682148409, -5440.772747138434, -7779.887407427022, -7953.1602754381265, -6349.224886009834, -3641.9841130902123, -3431.1152762094057, -5757.974272422748, -4521.337581390399, -2665.7222941775403, -4762.9257036962235, -7847.208295410033, -6577.524178824594, -2692.6116150353596, -9553.520409521368, -8885.334326347458, -7895.082169628684, -6521.80364952755, -6959.127511187029, -1972.4946696609718, -3377.7861376513783, -6954.933897030001, -4413.502129768713, -5030.776201462198, -6788.670146611226, -5896.561163647581, -6759.447003594665, -4733.069427989212, -8869.666232296817, -5515.200921746916, -4234.040128788769, -5407.504204265407, -3520.4567957371396, -5212.590338067366, -2066.9075459516157, -5562.625613401608, -5998.942638179698, -3788.720236171807, -6667.564875733491, -8141.79507669899, -4918.848592866103, -7126.838796101568, -4689.203634532447, -4589.556498994036, -4886.473142807092, -4933.807178037729, -8938.55457865672, -3552.283340577028, -6608.871573978449, -8923.505636818894, -5477.749610966848, -4800.827027338187, -2729.3397931116433, -6765.125647539589, -3929.3833259464855, -7329.895163272994, -6253.2469133415, -10205.840843569013, -10783.772810276385, -6272.9345354190455, -2743.8699027563575, -5996.7370570978555, -6659.007420903413, -1164.5036319509286, -3006.007455113455, -4857.3435915065, -3498.1778033471132, -3229.1846006601263, -4130.962638171492, -3659.5872341182353, -3397.135779999054, -10201.283430798883, -9692.020853580205, -5039.419206569587, -3645.733578345207, -5067.8372705541815, -9551.76186003886, -3182.089050269057, -6249.364169901141, -114.05000801728255, -6.769703197972, -8654.406095522254, -4231.831715620748, -5070.960626415362, -6075.533485022817, -4382.040635720421, -1833.1672949783506, -3627.36805383944, -3091.094190236165, -5293.549398527662, -8181.645709541949, -5566.0094197286335, -5344.023064569501, -3589.6493216007457, -5774.339833539948, -1762.3189031509378, -3366.8954447562687, -3870.458604583656, -4046.3751674774603, -3089.7867830954765, -4944.7694435753765, -4298.387259844483, -5772.791613149937, -5229.736384137411, -5062.262893367109, -7338.236014393956, -5640.544970068306, -2941.106308163125, -4936.181480374069, -2839.39948149218, -2642.4196878739685, -225.97822663041643, -1513.8947974421405, -5913.356735997067, -5975.861803509123, -5634.096278601098, -6656.969044941717, -6469.26997056147, -6008.876803828477, -2457.8835058143877, -1974.4871484490193, -603.0108977216346, -2478.367937245749, -6765.270532420154, -4199.7961458035, -2900.6216384066934, -3948.1314623252765, -5417.126733978057, -4858.2286884757605, -8153.227317274339, -4133.3413980630985, -3332.478433450167, -5086.450191629868, -4944.82888156275, -3981.886039257828, -9067.661257138096, -2783.7872910835304, -3653.4463153730626, -3014.075149500933, -4386.664901707102, -2916.7255006982873, -3295.992173054637, -7970.615560037957, -3324.574591195985, -8483.914708296272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4006734808350748, "mean_inference_ms": 0.973759769796872, "mean_action_processing_ms": 0.1676552140102494, "mean_env_wait_ms": 0.051220377957982885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003282308578491211, "StateBufferConnector_ms": 0.0025157928466796875, "ViewRequirementAgentConnector_ms": 0.06640064716339111}, "num_episodes": 22, "episode_return_max": -114.05000801728256, "episode_return_min": -10787.160079609088, "episode_return_mean": -6219.65485359399}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 561.6909475380312, "num_env_steps_trained_throughput_per_sec": 561.6909475380312, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 7256.139, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7256.105, "sample_time_ms": 750.757, "learn_time_ms": 6493.268, "learn_throughput": 616.023, "synch_weights_time_ms": 11.546}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 104, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-25", "timestamp": 1723232365, "time_this_iter_s": 7.125077962875366, "time_total_s": 784.1197729110718, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3057e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 784.1197729110718, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 24.05, "ram_util_percent": 80.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5330476366604369, "cur_kl_coeff": 8.649755859375002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.213606330752373, "policy_loss": 0.007916573244923104, "vf_loss": 9.996078654130299, "vf_explained_var": 1.2499156097571055e-05, "kl": 0.024233184718953756, "entropy": 1.3656539261341094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8670458651172421, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000832942175487, "policy_loss": 0.002073099586876139, "vf_loss": 9.997166692642939, "vf_explained_var": 3.259755946971752e-05, "kl": 0.010621074166040493, "entropy": 0.967102874965264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": -114.05000801728256, "episode_reward_min": -12232.225995307781, "episode_reward_mean": -6406.906022495672, "episode_len_mean": 192.49, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19249, "policy_reward_min": {"agent_policy": 6.769703197972, "adversary_policy": -12232.225995307781}, "policy_reward_max": {"agent_policy": 10202.453574236308, "adversary_policy": -6.769703197972}, "policy_reward_mean": {"agent_policy": 3980.1150359790176, "adversary_policy": -5193.5105292373455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.2554264073284, -5371.721482456803, -7031.717343648549, -9917.443515169634, -8634.17162047248, -7576.752685664787, -7779.8874074270225, -7953.160275438126, -3785.5636706606474, -6072.14612397856, -5011.2240434146715, -7847.208295410033, -9553.520409521368, -9068.35245179661, -7120.878393909138, -3377.7861376513783, -7174.153880941581, -6788.670146611226, -6908.370743092266, -8869.666232296817, -5516.8225609569745, -5423.257017835442, -5212.590338067366, -6464.094450686556, -6667.564875733491, -8157.219597357273, -7126.838796101568, -5681.782178390216, -8938.55457865672, -6608.871573978449, -8923.505636818894, -4800.827027338188, -6765.125647539589, -7329.895163272992, -10787.160079609088, -6355.299150372264, -7638.469159988504, -3006.007455113455, -5083.276002995164, -4325.016756838968, -3888.6631471240225, -10459.360304357911, -5041.204681843376, -9551.76186003886, -6249.364169901141, -114.05000801728256, -8654.406095522254, -6075.533485022818, -4494.721410727394, -4317.987064280157, -8181.645709541949, -6086.023146460768, -6263.637707249128, -3381.37611908148, -4100.832219699929, -5554.650191785047, -5828.1907892962445, -5471.043416246719, -7359.126379731198, -4943.362590147, -3005.9779838901554, -1513.8947974421405, -6472.223077237972, -6656.969044941717, -7245.091962857663, -2907.517426206666, -2478.367937245749, -6765.270532420155, -4403.029578222949, -6707.731319692335, -8153.227317274339, -5086.450191629869, -6036.1919349888985, -9067.661257138094, -4219.994239511715, -4828.571659834949, -7982.675549460551, -8483.914708296272, -8229.832132199135, -5149.107196481911, -9365.257606755347, -9648.465917427075, -6138.984621860448, -9838.423288905895, -7101.804694204059, -7273.997810446316, -6679.692492366626, -4616.240645924633, -4892.585124152289, -12232.225995307781, -6471.608246638409, -5448.718420815429, -3867.6407333686743, -4606.659352384818, -6938.552820446554, -8089.939709300932, -7790.052472612021, -10080.76746315234, -6149.447179946, -4668.068976883403], "episode_lengths": [23, 194, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 100, 82, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [124.26935301473782, 2178.6201235448407, 2563.374037586175, 8097.5143770198265, 1825.2971947376031, 6047.359841524653, 5440.772747138434, 6349.224886009834, 3287.535718638971, 4207.165729834585, 2417.4239544590882, 6577.524178824594, 2692.6116150353596, 7712.064044179529, 6360.052766805441, 1972.4946696609718, 4194.282145857139, 5030.776201462198, 5747.637424149981, 4733.069427989212, 4232.418489578711, 3504.7039821670983, 2066.9075459516157, 5097.473800894752, 3788.720236171807, 4903.424072207819, 4689.203634532447, 3794.247463410903, 4933.807178037729, 3552.283340577028, 5477.749610966848, 2729.3397931116433, 3929.3833259464855, 6253.2469133415, 10202.453574236308, 2661.5052878031397, 5017.275318012759, 1164.5036319509286, 3272.245391858449, 3035.1304819926468, 3168.0598669932665, 9433.94398002117, 3643.9481030714196, 5067.8372705541815, 3182.089050269057, 6.769703197972, 4231.831715620748, 5070.960626415362, 1720.4865199713754, 2400.4751797954523, 5293.549398527662, 4824.009337837363, 3100.351447891564, 1747.8382288257283, 3816.0015523611864, 2479.9060348858015, 4242.988083698176, 4820.955861257796, 5619.654604731064, 2933.925198390194, 2475.841185475991, 225.97822663041643, 5416.995462268216, 5634.096278601098, 5233.054811532288, 1524.85322805674, 603.0108977216346, 4199.7961458035, 2445.7235225090217, 3567.6241027614924, 4133.3413980630985, 3332.478433450167, 2890.522985831679, 2783.7872910835304, 2447.527225362285, 2474.8187425704396, 3283.9321836320423, 3324.574591195985, 3894.0008559389103, 2399.0457556595675, 5970.261976623449, 7180.888618577912, 5042.6518861416025, 4831.875313022127, 5783.195745017513, 3704.134638877774, 3847.0292807267483, 1762.3530524788232, 3231.08827153641, 4659.816479349205, 5514.9971713291725, 3260.2412572379335, 1480.991612322856, 2710.886844873667, 2720.4771694612755, 3838.2465085148315, 6335.05396867811, 9175.631564787524, 3180.530153813369, 2819.4734858430465], "policy_adversary_policy_reward": [-726.2554264073284, -124.26935301473782, -5027.220200603561, -2523.1214053980757, -2563.374037586175, -7031.717343648549, -9911.847685074199, -8103.1102071152645, -8345.788700361523, -2113.680114848565, -7137.695845041034, -6486.416682148409, -5440.772747138434, -7779.887407427022, -7953.1602754381265, -6349.224886009834, -3641.9841130902123, -3431.1152762094057, -5757.974272422748, -4521.337581390399, -2665.7222941775403, -4762.9257036962235, -7847.208295410033, -6577.524178824594, -2692.6116150353596, -9553.520409521368, -8885.334326347458, -7895.082169628684, -6521.80364952755, -6959.127511187029, -1972.4946696609718, -3377.7861376513783, -6954.933897030001, -4413.502129768713, -5030.776201462198, -6788.670146611226, -5896.561163647581, -6759.447003594665, -4733.069427989212, -8869.666232296817, -5515.200921746916, -4234.040128788769, -5407.504204265407, -3520.4567957371396, -5212.590338067366, -2066.9075459516157, -5562.625613401608, -5998.942638179698, -3788.720236171807, -6667.564875733491, -8141.79507669899, -4918.848592866103, -7126.838796101568, -4689.203634532447, -4589.556498994036, -4886.473142807092, -4933.807178037729, -8938.55457865672, -3552.283340577028, -6608.871573978449, -8923.505636818894, -5477.749610966848, -4800.827027338187, -2729.3397931116433, -6765.125647539589, -3929.3833259464855, -7329.895163272994, -6253.2469133415, -10205.840843569013, -10783.772810276385, -6272.9345354190455, -2743.8699027563575, -5996.7370570978555, -6659.007420903413, -1164.5036319509286, -3006.007455113455, -4857.3435915065, -3498.1778033471132, -3229.1846006601263, -4130.962638171492, -3659.5872341182353, -3397.135779999054, -10201.283430798883, -9692.020853580205, -5039.419206569587, -3645.733578345207, -5067.8372705541815, -9551.76186003886, -3182.089050269057, -6249.364169901141, -114.05000801728255, -6.769703197972, -8654.406095522254, -4231.831715620748, -5070.960626415362, -6075.533485022817, -4382.040635720421, -1833.1672949783506, -3627.36805383944, -3091.094190236165, -5293.549398527662, -8181.645709541949, -5566.0094197286335, -5344.023064569501, -3589.6493216007457, -5774.339833539948, -1762.3189031509378, -3366.8954447562687, -3870.458604583656, -4046.3751674774603, -3089.7867830954765, -4944.7694435753765, -4298.387259844483, -5772.791613149937, -5229.736384137411, -5062.262893367109, -7338.236014393956, -5640.544970068306, -2941.106308163125, -4936.181480374069, -2839.39948149218, -2642.4196878739685, -225.97822663041643, -1513.8947974421405, -5913.356735997067, -5975.861803509123, -5634.096278601098, -6656.969044941717, -6469.26997056147, -6008.876803828477, -2457.8835058143877, -1974.4871484490193, -603.0108977216346, -2478.367937245749, -6765.270532420154, -4199.7961458035, -2900.6216384066934, -3948.1314623252765, -5417.126733978057, -4858.2286884757605, -8153.227317274339, -4133.3413980630985, -3332.478433450167, -5086.450191629868, -4944.82888156275, -3981.886039257828, -9067.661257138096, -2783.7872910835304, -3653.4463153730626, -3014.075149500933, -4386.664901707102, -2916.7255006982873, -3295.992173054637, -7970.615560037957, -3324.574591195985, -8483.914708296272, -8229.832132199135, -3894.0008559389103, -2404.7630355541737, -5143.389916587305, -9365.257606755347, -5970.261976623449, -7180.888618577912, -9648.465917427075, -6138.984621860448, -5042.6518861416025, -9838.423288905895, -4831.875313022127, -6279.946646481506, -6605.053792740073, -7273.997810446315, -3704.134638877774, -5475.168534062906, -5051.553239030456, -1812.3455130773832, -4566.2481853260715, -4892.585124152289, -3231.08827153641, -4659.816479349205, -12232.225995307781, -6463.9177810952415, -5522.687636872339, -4149.267772341727, -4559.691905711642, -2437.7921925264977, -2910.840153165031, -2798.9878486384846, -4518.558348619999, -6837.19180364531, -2821.8381862625215, -8089.93970930093, -3838.2465085148315, -6641.494886278398, -7483.611555011738, -9976.198080003638, -9280.200947936224, -5952.560681697899, -3377.4166520614717, -4467.22171129846, -3020.3207514279884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40056152995722694, "mean_inference_ms": 0.9740154582878343, "mean_action_processing_ms": 0.16766495680917815, "mean_env_wait_ms": 0.05119821133913145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003367900848388672, "StateBufferConnector_ms": 0.002539396286010742, "ViewRequirementAgentConnector_ms": 0.0658179521560669}, "num_episodes": 22, "episode_return_max": -114.05000801728256, "episode_return_min": -12232.225995307781, "episode_return_mean": -6406.906022495672}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 565.3373956319462, "num_env_steps_trained_throughput_per_sec": 565.3373956319462, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 7217.45, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7217.416, "sample_time_ms": 755.159, "learn_time_ms": 6450.083, "learn_throughput": 620.147, "synch_weights_time_ms": 11.647}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 105, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-32", "timestamp": 1723232372, "time_this_iter_s": 7.080538749694824, "time_total_s": 791.2003116607666, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327abf5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 791.2003116607666, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 25.17, "ram_util_percent": 80.61}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.583440471937259, "cur_kl_coeff": 12.974633789062496, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.117723248402278, "policy_loss": 0.004924590933175447, "vf_loss": 9.976808085044224, "vf_explained_var": 7.364961008230845e-06, "kl": 0.010481265787044928, "entropy": 1.3694750275462866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9162593689939332, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985227502590766, "policy_loss": -0.005684877307247863, "vf_loss": 9.988172100713014, "vf_explained_var": -6.176851413868091e-05, "kl": 0.0182684559665778, "entropy": 1.0342574277252117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": -114.05000801728256, "episode_reward_min": -12232.225995307781, "episode_reward_mean": -6432.134335875095, "episode_len_mean": 191.94, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19194, "policy_reward_min": {"agent_policy": 6.769703197972, "adversary_policy": -12232.225995307781}, "policy_reward_max": {"agent_policy": 10202.453574236308, "adversary_policy": -6.769703197972}, "policy_reward_mean": {"agent_policy": 3830.2215317833366, "adversary_policy": -5131.177933829216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5423.257017835442, -5212.590338067366, -6464.094450686556, -6667.564875733491, -8157.219597357273, -7126.838796101568, -5681.782178390216, -8938.55457865672, -6608.871573978449, -8923.505636818894, -4800.827027338188, -6765.125647539589, -7329.895163272992, -10787.160079609088, -6355.299150372264, -7638.469159988504, -3006.007455113455, -5083.276002995164, -4325.016756838968, -3888.6631471240225, -10459.360304357911, -5041.204681843376, -9551.76186003886, -6249.364169901141, -114.05000801728256, -8654.406095522254, -6075.533485022818, -4494.721410727394, -4317.987064280157, -8181.645709541949, -6086.023146460768, -6263.637707249128, -3381.37611908148, -4100.832219699929, -5554.650191785047, -5828.1907892962445, -5471.043416246719, -7359.126379731198, -4943.362590147, -3005.9779838901554, -1513.8947974421405, -6472.223077237972, -6656.969044941717, -7245.091962857663, -2907.517426206666, -2478.367937245749, -6765.270532420155, -4403.029578222949, -6707.731319692335, -8153.227317274339, -5086.450191629869, -6036.1919349888985, -9067.661257138094, -4219.994239511715, -4828.571659834949, -7982.675549460551, -8483.914708296272, -8229.832132199135, -5149.107196481911, -9365.257606755347, -9648.465917427075, -6138.984621860448, -9838.423288905895, -7101.804694204059, -7273.997810446316, -6679.692492366626, -4616.240645924633, -4892.585124152289, -12232.225995307781, -6471.608246638409, -5448.718420815429, -3867.6407333686743, -4606.659352384818, -6938.552820446554, -8089.939709300932, -7790.052472612021, -10080.76746315234, -6149.447179946, -4668.068976883403, -4995.701683691822, -9740.687560693685, -10316.985335927175, -7239.349457808134, -5298.558406668316, -11209.901832542488, -6253.671303787092, -10445.558479847496, -6296.537071800109, -6574.816998773614, -6824.550157921474, -9311.999860617027, -5250.6110889479705, -7036.2144597222305, -288.99802723229175, -6374.093079908438, -5395.458599353532, -9204.2351326301, -3414.44146048501, -7769.130040706537, -5366.804145803805], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 100, 82, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 16, 200, 200, 170, 197, 200, 200], "policy_agent_policy_reward": [3504.7039821670983, 2066.9075459516157, 5097.473800894752, 3788.720236171807, 4903.424072207819, 4689.203634532447, 3794.247463410903, 4933.807178037729, 3552.283340577028, 5477.749610966848, 2729.3397931116433, 3929.3833259464855, 6253.2469133415, 10202.453574236308, 2661.5052878031397, 5017.275318012759, 1164.5036319509286, 3272.245391858449, 3035.1304819926468, 3168.0598669932665, 9433.94398002117, 3643.9481030714196, 5067.8372705541815, 3182.089050269057, 6.769703197972, 4231.831715620748, 5070.960626415362, 1720.4865199713754, 2400.4751797954523, 5293.549398527662, 4824.009337837363, 3100.351447891564, 1747.8382288257283, 3816.0015523611864, 2479.9060348858015, 4242.988083698176, 4820.955861257796, 5619.654604731064, 2933.925198390194, 2475.841185475991, 225.97822663041643, 5416.995462268216, 5634.096278601098, 5233.054811532288, 1524.85322805674, 603.0108977216346, 4199.7961458035, 2445.7235225090217, 3567.6241027614924, 4133.3413980630985, 3332.478433450167, 2890.522985831679, 2783.7872910835304, 2447.527225362285, 2474.8187425704396, 3283.9321836320423, 3324.574591195985, 3894.0008559389103, 2399.0457556595675, 5970.261976623449, 7180.888618577912, 5042.6518861416025, 4831.875313022127, 5783.195745017513, 3704.134638877774, 3847.0292807267483, 1762.3530524788232, 3231.08827153641, 4659.816479349205, 5514.9971713291725, 3260.2412572379335, 1480.991612322856, 2710.886844873667, 2720.4771694612755, 3838.2465085148315, 6335.05396867811, 9175.631564787524, 3180.530153813369, 2819.4734858430465, 1475.0816017811276, 2374.38465403969, 7140.900838297281, 4868.356354524517, 2423.8770530490983, 8119.478327240209, 3009.2937240461447, 5333.768006899286, 5128.317698134241, 1435.666056082928, 5343.811777341598, 4512.302181417527, 4083.4212821167207, 3184.792111531813, 84.33440149322881, 3292.1527932377658, 2973.191440420676, 2294.434803562676, 1203.5535598694353, 5427.456527925805, 3093.5633144720005], "policy_adversary_policy_reward": [-5407.504204265407, -3520.4567957371396, -5212.590338067366, -2066.9075459516157, -5562.625613401608, -5998.942638179698, -3788.720236171807, -6667.564875733491, -8141.79507669899, -4918.848592866103, -7126.838796101568, -4689.203634532447, -4589.556498994036, -4886.473142807092, -4933.807178037729, -8938.55457865672, -3552.283340577028, -6608.871573978449, -8923.505636818894, -5477.749610966848, -4800.827027338187, -2729.3397931116433, -6765.125647539589, -3929.3833259464855, -7329.895163272994, -6253.2469133415, -10205.840843569013, -10783.772810276385, -6272.9345354190455, -2743.8699027563575, -5996.7370570978555, -6659.007420903413, -1164.5036319509286, -3006.007455113455, -4857.3435915065, -3498.1778033471132, -3229.1846006601263, -4130.962638171492, -3659.5872341182353, -3397.135779999054, -10201.283430798883, -9692.020853580205, -5039.419206569587, -3645.733578345207, -5067.8372705541815, -9551.76186003886, -3182.089050269057, -6249.364169901141, -114.05000801728255, -6.769703197972, -8654.406095522254, -4231.831715620748, -5070.960626415362, -6075.533485022817, -4382.040635720421, -1833.1672949783506, -3627.36805383944, -3091.094190236165, -5293.549398527662, -8181.645709541949, -5566.0094197286335, -5344.023064569501, -3589.6493216007457, -5774.339833539948, -1762.3189031509378, -3366.8954447562687, -3870.458604583656, -4046.3751674774603, -3089.7867830954765, -4944.7694435753765, -4298.387259844483, -5772.791613149937, -5229.736384137411, -5062.262893367109, -7338.236014393956, -5640.544970068306, -2941.106308163125, -4936.181480374069, -2839.39948149218, -2642.4196878739685, -225.97822663041643, -1513.8947974421405, -5913.356735997067, -5975.861803509123, -5634.096278601098, -6656.969044941717, -6469.26997056147, -6008.876803828477, -2457.8835058143877, -1974.4871484490193, -603.0108977216346, -2478.367937245749, -6765.270532420154, -4199.7961458035, -2900.6216384066934, -3948.1314623252765, -5417.126733978057, -4858.2286884757605, -8153.227317274339, -4133.3413980630985, -3332.478433450167, -5086.450191629868, -4944.82888156275, -3981.886039257828, -9067.661257138096, -2783.7872910835304, -3653.4463153730626, -3014.075149500933, -4386.664901707102, -2916.7255006982873, -3295.992173054637, -7970.615560037957, -3324.574591195985, -8483.914708296272, -8229.832132199135, -3894.0008559389103, -2404.7630355541737, -5143.389916587305, -9365.257606755347, -5970.261976623449, -7180.888618577912, -9648.465917427075, -6138.984621860448, -5042.6518861416025, -9838.423288905895, -4831.875313022127, -6279.946646481506, -6605.053792740073, -7273.997810446315, -3704.134638877774, -5475.168534062906, -5051.553239030456, -1812.3455130773832, -4566.2481853260715, -4892.585124152289, -3231.08827153641, -4659.816479349205, -12232.225995307781, -6463.9177810952415, -5522.687636872339, -4149.267772341727, -4559.691905711642, -2437.7921925264977, -2910.840153165031, -2798.9878486384846, -4518.558348619999, -6837.19180364531, -2821.8381862625215, -8089.93970930093, -3838.2465085148315, -6641.494886278398, -7483.611555011738, -9976.198080003638, -9280.200947936224, -5952.560681697899, -3377.4166520614717, -4467.22171129846, -3020.3207514279884, -2103.5294094773385, -4367.25387599562, -9740.687560693685, -2374.38465403969, -10248.057615976564, -7209.828558247891, -7239.349457808134, -4868.356354524517, -3652.085157168837, -4070.350302548578, -8119.478327240209, -11209.901832542488, -6253.671303787091, -3009.2937240461447, -5333.768006899286, -10445.558479847496, -5317.884495460729, -6106.970274473623, -1435.666056082928, -6574.816998773615, -5343.811777341598, -6824.550157921474, -4512.302181417527, -9311.999860617027, -4083.4212821167207, -5250.6110889479705, -3184.792111531813, -7036.2144597222305, -288.9980272322917, -84.33440149322881, -3292.998245245975, -6373.247627900229, -5029.347718309718, -3339.302321464485, -9203.773086621228, -2294.8968495715485, -1880.7886622317685, -2737.206358122675, -5439.54324033388, -7757.043328298463, -5366.804145803805, -3093.5633144720005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40036505426915986, "mean_inference_ms": 0.9737600293891707, "mean_action_processing_ms": 0.16764493002513295, "mean_env_wait_ms": 0.0511978501835169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034214258193969727, "StateBufferConnector_ms": 0.002512216567993164, "ViewRequirementAgentConnector_ms": 0.06487178802490234}, "num_episodes": 21, "episode_return_max": -114.05000801728256, "episode_return_min": -12232.225995307781, "episode_return_mean": -6432.134335875095}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 567.5216004356366, "num_env_steps_trained_throughput_per_sec": 567.5216004356366, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 7188.427, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7188.393, "sample_time_ms": 748.145, "learn_time_ms": 6428.026, "learn_throughput": 622.275, "synch_weights_time_ms": 11.692}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 106, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-39", "timestamp": 1723232379, "time_this_iter_s": 7.05206298828125, "time_total_s": 798.2523746490479, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3057ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 798.2523746490479, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.36, "ram_util_percent": 80.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9727615198430917, "cur_kl_coeff": 12.974633789062496, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.21771289408207, "policy_loss": 0.013643827140913344, "vf_loss": 9.96351720392704, "vf_explained_var": 5.54639846086502e-06, "kl": 0.018540165522911895, "entropy": 1.3845329110821087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9650936244577958, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991655132757923, "policy_loss": 0.008379010491753144, "vf_loss": 9.979349596033652, "vf_explained_var": -8.093333118176334e-06, "kl": 0.026176868235229186, "entropy": 1.0185065989456479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "env_runners": {"episode_reward_max": -114.05000801728256, "episode_reward_min": -12232.225995307781, "episode_reward_mean": -6197.818711252327, "episode_len_mean": 184.95, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18495, "policy_reward_min": {"agent_policy": 6.769703197972, "adversary_policy": -12232.225995307781}, "policy_reward_max": {"agent_policy": 9175.631564787524, "adversary_policy": -6.769703197972}, "policy_reward_mean": {"agent_policy": 3604.9694251020865, "adversary_policy": -4901.3940681772065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6249.364169901141, -114.05000801728256, -8654.406095522254, -6075.533485022818, -4494.721410727394, -4317.987064280157, -8181.645709541949, -6086.023146460768, -6263.637707249128, -3381.37611908148, -4100.832219699929, -5554.650191785047, -5828.1907892962445, -5471.043416246719, -7359.126379731198, -4943.362590147, -3005.9779838901554, -1513.8947974421405, -6472.223077237972, -6656.969044941717, -7245.091962857663, -2907.517426206666, -2478.367937245749, -6765.270532420155, -4403.029578222949, -6707.731319692335, -8153.227317274339, -5086.450191629869, -6036.1919349888985, -9067.661257138094, -4219.994239511715, -4828.571659834949, -7982.675549460551, -8483.914708296272, -8229.832132199135, -5149.107196481911, -9365.257606755347, -9648.465917427075, -6138.984621860448, -9838.423288905895, -7101.804694204059, -7273.997810446316, -6679.692492366626, -4616.240645924633, -4892.585124152289, -12232.225995307781, -6471.608246638409, -5448.718420815429, -3867.6407333686743, -4606.659352384818, -6938.552820446554, -8089.939709300932, -7790.052472612021, -10080.76746315234, -6149.447179946, -4668.068976883403, -4995.701683691822, -9740.687560693685, -10316.985335927175, -7239.349457808134, -5298.558406668316, -11209.901832542488, -6253.671303787092, -10445.558479847496, -6296.537071800109, -6574.816998773614, -6824.550157921474, -9311.999860617027, -5250.6110889479705, -7036.2144597222305, -288.99802723229175, -6374.093079908438, -5395.458599353532, -9204.2351326301, -3414.44146048501, -7769.130040706537, -5366.804145803805, -7237.408423617724, -5331.380727685153, -8909.577081184205, -7169.203286679599, -2333.391601824516, -611.163940977287, -10233.92306547136, -5906.531381819559, -1218.6156868034884, -2823.8692999238833, -7877.280359382755, -4391.3098744395, -5505.879867181478, -9497.326211254676, -9725.226758124812, -6662.1883262754245, -4622.646104049848, -3074.968584513165, -3822.45530637543, -6039.970588245691, -3279.0427465636512, -8358.38616673496, -6173.037628653431], "episode_lengths": [200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 100, 82, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 16, 200, 200, 170, 197, 200, 200, 200, 200, 200, 200, 146, 30, 200, 200, 62, 153, 200, 106, 200, 200, 200, 127, 173, 104, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3182.089050269057, 6.769703197972, 4231.831715620748, 5070.960626415362, 1720.4865199713754, 2400.4751797954523, 5293.549398527662, 4824.009337837363, 3100.351447891564, 1747.8382288257283, 3816.0015523611864, 2479.9060348858015, 4242.988083698176, 4820.955861257796, 5619.654604731064, 2933.925198390194, 2475.841185475991, 225.97822663041643, 5416.995462268216, 5634.096278601098, 5233.054811532288, 1524.85322805674, 603.0108977216346, 4199.7961458035, 2445.7235225090217, 3567.6241027614924, 4133.3413980630985, 3332.478433450167, 2890.522985831679, 2783.7872910835304, 2447.527225362285, 2474.8187425704396, 3283.9321836320423, 3324.574591195985, 3894.0008559389103, 2399.0457556595675, 5970.261976623449, 7180.888618577912, 5042.6518861416025, 4831.875313022127, 5783.195745017513, 3704.134638877774, 3847.0292807267483, 1762.3530524788232, 3231.08827153641, 4659.816479349205, 5514.9971713291725, 3260.2412572379335, 1480.991612322856, 2710.886844873667, 2720.4771694612755, 3838.2465085148315, 6335.05396867811, 9175.631564787524, 3180.530153813369, 2819.4734858430465, 1475.0816017811276, 2374.38465403969, 7140.900838297281, 4868.356354524517, 2423.8770530490983, 8119.478327240209, 3009.2937240461447, 5333.768006899286, 5128.317698134241, 1435.666056082928, 5343.811777341598, 4512.302181417527, 4083.4212821167207, 3184.792111531813, 84.33440149322881, 3292.1527932377658, 2973.191440420676, 2294.434803562676, 1203.5535598694353, 5427.456527925805, 3093.5633144720005, 6823.841603708943, 3871.1293358601606, 6524.397338360678, 5545.464887884592, 921.8796184806777, 150.06022458580813, 7176.892551825882, 2383.6377653046156, 734.3942465373003, 1494.909076087172, 6800.595280588492, 1789.2065034001369, 3794.5278049261415, 7609.491206697361, 5591.291204679725, 794.0598462702989, 2168.949918633694, 1143.1491885608914, 2159.736983999632, 2956.20788126665, 2516.067105759025, 3502.5914573452624, 2409.7021049237514], "policy_adversary_policy_reward": [-3182.089050269057, -6249.364169901141, -114.05000801728255, -6.769703197972, -8654.406095522254, -4231.831715620748, -5070.960626415362, -6075.533485022817, -4382.040635720421, -1833.1672949783506, -3627.36805383944, -3091.094190236165, -5293.549398527662, -8181.645709541949, -5566.0094197286335, -5344.023064569501, -3589.6493216007457, -5774.339833539948, -1762.3189031509378, -3366.8954447562687, -3870.458604583656, -4046.3751674774603, -3089.7867830954765, -4944.7694435753765, -4298.387259844483, -5772.791613149937, -5229.736384137411, -5062.262893367109, -7338.236014393956, -5640.544970068306, -2941.106308163125, -4936.181480374069, -2839.39948149218, -2642.4196878739685, -225.97822663041643, -1513.8947974421405, -5913.356735997067, -5975.861803509123, -5634.096278601098, -6656.969044941717, -6469.26997056147, -6008.876803828477, -2457.8835058143877, -1974.4871484490193, -603.0108977216346, -2478.367937245749, -6765.270532420154, -4199.7961458035, -2900.6216384066934, -3948.1314623252765, -5417.126733978057, -4858.2286884757605, -8153.227317274339, -4133.3413980630985, -3332.478433450167, -5086.450191629868, -4944.82888156275, -3981.886039257828, -9067.661257138096, -2783.7872910835304, -3653.4463153730626, -3014.075149500933, -4386.664901707102, -2916.7255006982873, -3295.992173054637, -7970.615560037957, -3324.574591195985, -8483.914708296272, -8229.832132199135, -3894.0008559389103, -2404.7630355541737, -5143.389916587305, -9365.257606755347, -5970.261976623449, -7180.888618577912, -9648.465917427075, -6138.984621860448, -5042.6518861416025, -9838.423288905895, -4831.875313022127, -6279.946646481506, -6605.053792740073, -7273.997810446315, -3704.134638877774, -5475.168534062906, -5051.553239030456, -1812.3455130773832, -4566.2481853260715, -4892.585124152289, -3231.08827153641, -4659.816479349205, -12232.225995307781, -6463.9177810952415, -5522.687636872339, -4149.267772341727, -4559.691905711642, -2437.7921925264977, -2910.840153165031, -2798.9878486384846, -4518.558348619999, -6837.19180364531, -2821.8381862625215, -8089.93970930093, -3838.2465085148315, -6641.494886278398, -7483.611555011738, -9976.198080003638, -9280.200947936224, -5952.560681697899, -3377.4166520614717, -4467.22171129846, -3020.3207514279884, -2103.5294094773385, -4367.25387599562, -9740.687560693685, -2374.38465403969, -10248.057615976564, -7209.828558247891, -7239.349457808134, -4868.356354524517, -3652.085157168837, -4070.350302548578, -8119.478327240209, -11209.901832542488, -6253.671303787091, -3009.2937240461447, -5333.768006899286, -10445.558479847496, -5317.884495460729, -6106.970274473623, -1435.666056082928, -6574.816998773615, -5343.811777341598, -6824.550157921474, -4512.302181417527, -9311.999860617027, -4083.4212821167207, -5250.6110889479705, -3184.792111531813, -7036.2144597222305, -288.9980272322917, -84.33440149322881, -3292.998245245975, -6373.247627900229, -5029.347718309718, -3339.302321464485, -9203.773086621228, -2294.8968495715485, -1880.7886622317685, -2737.206358122675, -5439.54324033388, -7757.043328298463, -5366.804145803805, -3093.5633144720005, -7114.818941389614, -6946.43108593705, -4668.987288528141, -4533.522775017184, -8899.145261442041, -6534.8291581028425, -7166.012583858612, -5548.655590705581, -1549.6939569078127, -1705.5772633973816, -611.163940977287, -150.06022458580813, -10233.92306547136, -7176.892551825882, -2531.1762677972815, -5758.9928793268955, -819.6708761268154, -1133.3390572139733, -2823.8692999238833, -1494.909076087172, -7802.852115359703, -6875.0235246115435, -4391.3098744395, -1789.2065034001369, -3794.5278049261415, -5505.879867181478, -9497.326211254678, -7609.491206697361, -9725.226758124814, -5591.291204679725, -794.0598462702989, -6662.1883262754245, -3561.4702629781436, -3230.125759705392, -1275.6421885847535, -2942.475584489302, -2515.6528766828387, -3466.539413692225, -3026.1954013633044, -5969.983068149035, -2587.177897049008, -3207.9319552736674, -3502.5914573452624, -8358.38616673496, -2409.7021049237514, -6173.037628653427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40020152124278213, "mean_inference_ms": 0.9730118858299082, "mean_action_processing_ms": 0.16759683487277274, "mean_env_wait_ms": 0.051194604244667215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034314393997192383, "StateBufferConnector_ms": 0.002685546875, "ViewRequirementAgentConnector_ms": 0.0660468339920044}, "num_episodes": 23, "episode_return_max": -114.05000801728256, "episode_return_min": -12232.225995307781, "episode_return_mean": -6197.818711252327}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.8370143702732, "num_env_steps_trained_throughput_per_sec": 551.8370143702732, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 7180.016, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7179.981, "sample_time_ms": 743.751, "learn_time_ms": 6424.182, "learn_throughput": 622.647, "synch_weights_time_ms": 11.519}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "training_iteration": 107, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-47", "timestamp": 1723232387, "time_this_iter_s": 7.253982067108154, "time_total_s": 805.506356716156, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b322b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 805.506356716156, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 24.527272727272727, "ram_util_percent": 80.63636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0172299203152457, "cur_kl_coeff": 12.974633789062496, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.30709361732006, "policy_loss": 0.0070760086200607475, "vf_loss": 9.985143182675044, "vf_explained_var": 3.029722720384598e-05, "kl": 0.024268463471283516, "entropy": 1.3910799859712522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8225106406306464, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994858170564843, "policy_loss": -0.0002383076144806134, "vf_loss": 9.992423966321995, "vf_explained_var": 1.0325101317552032e-05, "kl": 0.01187784591192015, "entropy": 1.0338444176805082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": -80.57043064997977, "episode_reward_min": -12232.225995307781, "episode_reward_mean": -6195.093614613399, "episode_len_mean": 182.94, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18294, "policy_reward_min": {"agent_policy": 15.677139292687496, "adversary_policy": -12232.225995307781}, "policy_reward_max": {"agent_policy": 9175.631564787524, "adversary_policy": -15.677139292687496}, "policy_reward_mean": {"agent_policy": 3613.097672163474, "adversary_policy": -4904.095643388437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4403.029578222949, -6707.731319692335, -8153.227317274339, -5086.450191629869, -6036.1919349888985, -9067.661257138094, -4219.994239511715, -4828.571659834949, -7982.675549460551, -8483.914708296272, -8229.832132199135, -5149.107196481911, -9365.257606755347, -9648.465917427075, -6138.984621860448, -9838.423288905895, -7101.804694204059, -7273.997810446316, -6679.692492366626, -4616.240645924633, -4892.585124152289, -12232.225995307781, -6471.608246638409, -5448.718420815429, -3867.6407333686743, -4606.659352384818, -6938.552820446554, -8089.939709300932, -7790.052472612021, -10080.76746315234, -6149.447179946, -4668.068976883403, -4995.701683691822, -9740.687560693685, -10316.985335927175, -7239.349457808134, -5298.558406668316, -11209.901832542488, -6253.671303787092, -10445.558479847496, -6296.537071800109, -6574.816998773614, -6824.550157921474, -9311.999860617027, -5250.6110889479705, -7036.2144597222305, -288.99802723229175, -6374.093079908438, -5395.458599353532, -9204.2351326301, -3414.44146048501, -7769.130040706537, -5366.804145803805, -7237.408423617724, -5331.380727685153, -8909.577081184205, -7169.203286679599, -2333.391601824516, -611.163940977287, -10233.92306547136, -5906.531381819559, -1218.6156868034884, -2823.8692999238833, -7877.280359382755, -4391.3098744395, -5505.879867181478, -9497.326211254676, -9725.226758124812, -6662.1883262754245, -4622.646104049848, -3074.968584513165, -3822.45530637543, -6039.970588245691, -3279.0427465636512, -8358.38616673496, -6173.037628653431, -9260.458831580036, -4459.682257209518, -80.57043064997977, -6151.605173907996, -3930.9762935400854, -1661.6558114485447, -9013.279898123727, -7768.950679540863, -1604.310036570851, -8342.692867260364, -3379.10182327115, -3255.353184301412, -6424.426010845606, -3766.1715028769095, -3724.8655787248963, -7126.661210576555, -7332.550534136287, -8038.761937735515, -7881.939359723307, -5844.9872600244435, -7546.077493605727, -1405.5844173889209, -5190.679709387453, -657.4112986298065], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 16, 200, 200, 170, 197, 200, 200, 200, 200, 200, 200, 146, 30, 200, 200, 62, 153, 200, 106, 200, 200, 200, 127, 173, 104, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 57, 200, 200, 88, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 200, 18], "policy_agent_policy_reward": [2445.7235225090217, 3567.6241027614924, 4133.3413980630985, 3332.478433450167, 2890.522985831679, 2783.7872910835304, 2447.527225362285, 2474.8187425704396, 3283.9321836320423, 3324.574591195985, 3894.0008559389103, 2399.0457556595675, 5970.261976623449, 7180.888618577912, 5042.6518861416025, 4831.875313022127, 5783.195745017513, 3704.134638877774, 3847.0292807267483, 1762.3530524788232, 3231.08827153641, 4659.816479349205, 5514.9971713291725, 3260.2412572379335, 1480.991612322856, 2710.886844873667, 2720.4771694612755, 3838.2465085148315, 6335.05396867811, 9175.631564787524, 3180.530153813369, 2819.4734858430465, 1475.0816017811276, 2374.38465403969, 7140.900838297281, 4868.356354524517, 2423.8770530490983, 8119.478327240209, 3009.2937240461447, 5333.768006899286, 5128.317698134241, 1435.666056082928, 5343.811777341598, 4512.302181417527, 4083.4212821167207, 3184.792111531813, 84.33440149322881, 3292.1527932377658, 2973.191440420676, 2294.434803562676, 1203.5535598694353, 5427.456527925805, 3093.5633144720005, 6823.841603708943, 3871.1293358601606, 6524.397338360678, 5545.464887884592, 921.8796184806777, 150.06022458580813, 7176.892551825882, 2383.6377653046156, 734.3942465373003, 1494.909076087172, 6800.595280588492, 1789.2065034001369, 3794.5278049261415, 7609.491206697361, 5591.291204679725, 794.0598462702989, 2168.949918633694, 1143.1491885608914, 2159.736983999632, 2956.20788126665, 2516.067105759025, 3502.5914573452624, 2409.7021049237514, 6284.307360446286, 3465.3307857374707, 15.677139292687496, 4480.4351962733845, 3021.522274905454, 740.5503775669279, 8494.22345170503, 3235.7533860322606, 1227.5653699834033, 6782.635701601875, 2845.7618826003963, 2822.0986759863003, 2562.8456989564806, 3478.857995780558, 2675.5720354780583, 3867.320429108224, 2918.303780306688, 7445.8920045597715, 6046.4488801967545, 3189.3969091643708, 2585.8947762411585, 866.2359000798472, 2467.70726303383, 97.90621086791143], "policy_adversary_policy_reward": [-2900.6216384066934, -3948.1314623252765, -5417.126733978057, -4858.2286884757605, -8153.227317274339, -4133.3413980630985, -3332.478433450167, -5086.450191629868, -4944.82888156275, -3981.886039257828, -9067.661257138096, -2783.7872910835304, -3653.4463153730626, -3014.075149500933, -4386.664901707102, -2916.7255006982873, -3295.992173054637, -7970.615560037957, -3324.574591195985, -8483.914708296272, -8229.832132199135, -3894.0008559389103, -2404.7630355541737, -5143.389916587305, -9365.257606755347, -5970.261976623449, -7180.888618577912, -9648.465917427075, -6138.984621860448, -5042.6518861416025, -9838.423288905895, -4831.875313022127, -6279.946646481506, -6605.053792740073, -7273.997810446315, -3704.134638877774, -5475.168534062906, -5051.553239030456, -1812.3455130773832, -4566.2481853260715, -4892.585124152289, -3231.08827153641, -4659.816479349205, -12232.225995307781, -6463.9177810952415, -5522.687636872339, -4149.267772341727, -4559.691905711642, -2437.7921925264977, -2910.840153165031, -2798.9878486384846, -4518.558348619999, -6837.19180364531, -2821.8381862625215, -8089.93970930093, -3838.2465085148315, -6641.494886278398, -7483.611555011738, -9976.198080003638, -9280.200947936224, -5952.560681697899, -3377.4166520614717, -4467.22171129846, -3020.3207514279884, -2103.5294094773385, -4367.25387599562, -9740.687560693685, -2374.38465403969, -10248.057615976564, -7209.828558247891, -7239.349457808134, -4868.356354524517, -3652.085157168837, -4070.350302548578, -8119.478327240209, -11209.901832542488, -6253.671303787091, -3009.2937240461447, -5333.768006899286, -10445.558479847496, -5317.884495460729, -6106.970274473623, -1435.666056082928, -6574.816998773615, -5343.811777341598, -6824.550157921474, -4512.302181417527, -9311.999860617027, -4083.4212821167207, -5250.6110889479705, -3184.792111531813, -7036.2144597222305, -288.9980272322917, -84.33440149322881, -3292.998245245975, -6373.247627900229, -5029.347718309718, -3339.302321464485, -9203.773086621228, -2294.8968495715485, -1880.7886622317685, -2737.206358122675, -5439.54324033388, -7757.043328298463, -5366.804145803805, -3093.5633144720005, -7114.818941389614, -6946.43108593705, -4668.987288528141, -4533.522775017184, -8899.145261442041, -6534.8291581028425, -7166.012583858612, -5548.655590705581, -1549.6939569078127, -1705.5772633973816, -611.163940977287, -150.06022458580813, -10233.92306547136, -7176.892551825882, -2531.1762677972815, -5758.9928793268955, -819.6708761268154, -1133.3390572139733, -2823.8692999238833, -1494.909076087172, -7802.852115359703, -6875.0235246115435, -4391.3098744395, -1789.2065034001369, -3794.5278049261415, -5505.879867181478, -9497.326211254678, -7609.491206697361, -9725.226758124814, -5591.291204679725, -794.0598462702989, -6662.1883262754245, -3561.4702629781436, -3230.125759705392, -1275.6421885847535, -2942.475584489302, -2515.6528766828387, -3466.539413692225, -3026.1954013633044, -5969.983068149035, -2587.177897049008, -3207.9319552736674, -3502.5914573452624, -8358.38616673496, -2409.7021049237514, -6173.037628653427, -9260.458831580037, -6284.307360446286, -4161.132518967818, -3763.880523979174, -80.57043064997976, -15.677139292687496, -5103.792510113596, -5528.247860067782, -3027.6482650733346, -3924.8503033722054, -745.9230607272823, -1656.2831282881903, -8677.322065827611, -8830.181284001143, -3235.7533860322606, -7768.950679540863, -1523.416980021227, -1308.4584265330277, -7282.614513775064, -7842.714055087182, -3077.3060796198306, -3147.557626251717, -2918.9610872037797, -3158.4907730839323, -2585.2865737005536, -6401.985136101533, -3590.6237181204674, -3654.4057805370007, -2956.0774868081344, -3444.360127394821, -3867.320429108224, -7126.661210576555, -7054.098505398495, -3196.755809044477, -7908.456336899365, -7576.1976053959215, -6288.341017529141, -7640.047222390918, -3189.3969091643708, -5844.987260024445, -2966.7134649688714, -7165.258804878017, -918.7994216883558, -1353.0208957804125, -2783.2239652457306, -4875.163007175557, -97.90621086791143, -657.4112986298065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4000194991177597, "mean_inference_ms": 0.9731229987104115, "mean_action_processing_ms": 0.1674770629061868, "mean_env_wait_ms": 0.051140171126423925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035282373428344727, "StateBufferConnector_ms": 0.0025864839553833008, "ViewRequirementAgentConnector_ms": 0.06629037857055664}, "num_episodes": 24, "episode_return_max": -80.57043064997977, "episode_return_min": -12232.225995307781, "episode_return_mean": -6195.093614613399}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 556.0907242530194, "num_env_steps_trained_throughput_per_sec": 556.0907242530194, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 7182.752, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7182.717, "sample_time_ms": 734.155, "learn_time_ms": 6436.573, "learn_throughput": 621.449, "synch_weights_time_ms": 11.526}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 108, "trial_id": "3439d_00000", "date": "2024-08-09_15-39-54", "timestamp": 1723232394, "time_this_iter_s": 7.198333024978638, "time_total_s": 812.7046897411346, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b322b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 812.7046897411346, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 30.859999999999996, "ram_util_percent": 80.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9473962059865397, "cur_kl_coeff": 19.46195068359375, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.430628049373627, "policy_loss": 0.01607143281774673, "vf_loss": 9.987236666679383, "vf_explained_var": 0.00010359430064757666, "kl": 0.021956686161865947, "entropy": 1.3883553879956405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9038304338773723, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997756811172243, "policy_loss": 0.0026047541466714054, "vf_loss": 9.99300651550293, "vf_explained_var": 1.152447922519906e-05, "kl": 0.009535728786978379, "entropy": 1.088877884736137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "env_runners": {"episode_reward_max": -76.91559000813447, "episode_reward_min": -11209.901832542488, "episode_reward_mean": -5634.429138160202, "episode_len_mean": 174.18, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 17418, "policy_reward_min": {"agent_policy": 3.560902520700828, "adversary_policy": -11209.901832542488}, "policy_reward_max": {"agent_policy": 9175.631564787524, "adversary_policy": -3.560902520700828}, "policy_reward_mean": {"agent_policy": 3286.334590871502, "adversary_policy": -4460.381864515852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6938.552820446554, -8089.939709300932, -7790.052472612021, -10080.76746315234, -6149.447179946, -4668.068976883403, -4995.701683691822, -9740.687560693685, -10316.985335927175, -7239.349457808134, -5298.558406668316, -11209.901832542488, -6253.671303787092, -10445.558479847496, -6296.537071800109, -6574.816998773614, -6824.550157921474, -9311.999860617027, -5250.6110889479705, -7036.2144597222305, -288.99802723229175, -6374.093079908438, -5395.458599353532, -9204.2351326301, -3414.44146048501, -7769.130040706537, -5366.804145803805, -7237.408423617724, -5331.380727685153, -8909.577081184205, -7169.203286679599, -2333.391601824516, -611.163940977287, -10233.92306547136, -5906.531381819559, -1218.6156868034884, -2823.8692999238833, -7877.280359382755, -4391.3098744395, -5505.879867181478, -9497.326211254676, -9725.226758124812, -6662.1883262754245, -4622.646104049848, -3074.968584513165, -3822.45530637543, -6039.970588245691, -3279.0427465636512, -8358.38616673496, -6173.037628653431, -9260.458831580036, -4459.682257209518, -80.57043064997977, -6151.605173907996, -3930.9762935400854, -1661.6558114485447, -9013.279898123727, -7768.950679540863, -1604.310036570851, -8342.692867260364, -3379.10182327115, -3255.353184301412, -6424.426010845606, -3766.1715028769095, -3724.8655787248963, -7126.661210576555, -7332.550534136287, -8038.761937735515, -7881.939359723307, -5844.9872600244435, -7546.077493605727, -1405.5844173889209, -5190.679709387453, -657.4112986298065, -7776.487176589202, -7256.0493655568625, -9977.008962772885, -7637.67274507047, -4338.851055249089, -3880.855184821963, -76.91559000813447, -3554.0679472937786, -4471.318225386273, -7668.840238325623, -8176.068792303086, -3654.5390019167567, -4637.069536462076, -6129.842137731808, -2185.827673414644, -4799.839473248317, -3077.9919907485696, -4114.634066652769, -120.86715503977445, -6688.658343109572, -4551.839622480788, -1276.0205521081389, -5313.066196060503, -3864.4508289173023, -4567.532622633696, -667.9299060668994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 179, 200, 200, 200, 200, 16, 200, 200, 170, 197, 200, 200, 200, 200, 200, 200, 146, 30, 200, 200, 62, 153, 200, 106, 200, 200, 200, 127, 173, 104, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 57, 200, 200, 88, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 200, 18, 200, 200, 200, 200, 177, 200, 3, 200, 200, 200, 200, 200, 200, 200, 71, 200, 200, 200, 4, 200, 200, 38, 200, 200, 200, 31], "policy_agent_policy_reward": [2720.4771694612755, 3838.2465085148315, 6335.05396867811, 9175.631564787524, 3180.530153813369, 2819.4734858430465, 1475.0816017811276, 2374.38465403969, 7140.900838297281, 4868.356354524517, 2423.8770530490983, 8119.478327240209, 3009.2937240461447, 5333.768006899286, 5128.317698134241, 1435.666056082928, 5343.811777341598, 4512.302181417527, 4083.4212821167207, 3184.792111531813, 84.33440149322881, 3292.1527932377658, 2973.191440420676, 2294.434803562676, 1203.5535598694353, 5427.456527925805, 3093.5633144720005, 6823.841603708943, 3871.1293358601606, 6524.397338360678, 5545.464887884592, 921.8796184806777, 150.06022458580813, 7176.892551825882, 2383.6377653046156, 734.3942465373003, 1494.909076087172, 6800.595280588492, 1789.2065034001369, 3794.5278049261415, 7609.491206697361, 5591.291204679725, 794.0598462702989, 2168.949918633694, 1143.1491885608914, 2159.736983999632, 2956.20788126665, 2516.067105759025, 3502.5914573452624, 2409.7021049237514, 6284.307360446286, 3465.3307857374707, 15.677139292687496, 4480.4351962733845, 3021.522274905454, 740.5503775669279, 8494.22345170503, 3235.7533860322606, 1227.5653699834033, 6782.635701601875, 2845.7618826003963, 2822.0986759863003, 2562.8456989564806, 3478.857995780558, 2675.5720354780583, 3867.320429108224, 2918.303780306688, 7445.8920045597715, 6046.4488801967545, 3189.3969091643708, 2585.8947762411585, 866.2359000798472, 2467.70726303383, 97.90621086791143, 2060.851013549738, 5552.74391653783, 3040.785829661585, 6586.874492034109, 1658.896291999016, 2049.440310526638, 3.560902520700828, 2956.6351118820385, 2410.485822341861, 2667.2511395722286, 2162.115909228675, 2571.643676658992, 3047.624717081392, 2098.7468199231107, 1236.9452148078583, 2849.107717441576, 2401.3301806511004, 2892.5931786235556, 5.248109953356742, 2684.0279735879194, 2548.3618930053017, 480.4547145314257, 4661.211038316205, 2560.720937530292, 1812.782714385662, 281.04148062408797], "policy_adversary_policy_reward": [-6837.19180364531, -2821.8381862625215, -8089.93970930093, -3838.2465085148315, -6641.494886278398, -7483.611555011738, -9976.198080003638, -9280.200947936224, -5952.560681697899, -3377.4166520614717, -4467.22171129846, -3020.3207514279884, -2103.5294094773385, -4367.25387599562, -9740.687560693685, -2374.38465403969, -10248.057615976564, -7209.828558247891, -7239.349457808134, -4868.356354524517, -3652.085157168837, -4070.350302548578, -8119.478327240209, -11209.901832542488, -6253.671303787091, -3009.2937240461447, -5333.768006899286, -10445.558479847496, -5317.884495460729, -6106.970274473623, -1435.666056082928, -6574.816998773615, -5343.811777341598, -6824.550157921474, -4512.302181417527, -9311.999860617027, -4083.4212821167207, -5250.6110889479705, -3184.792111531813, -7036.2144597222305, -288.9980272322917, -84.33440149322881, -3292.998245245975, -6373.247627900229, -5029.347718309718, -3339.302321464485, -9203.773086621228, -2294.8968495715485, -1880.7886622317685, -2737.206358122675, -5439.54324033388, -7757.043328298463, -5366.804145803805, -3093.5633144720005, -7114.818941389614, -6946.43108593705, -4668.987288528141, -4533.522775017184, -8899.145261442041, -6534.8291581028425, -7166.012583858612, -5548.655590705581, -1549.6939569078127, -1705.5772633973816, -611.163940977287, -150.06022458580813, -10233.92306547136, -7176.892551825882, -2531.1762677972815, -5758.9928793268955, -819.6708761268154, -1133.3390572139733, -2823.8692999238833, -1494.909076087172, -7802.852115359703, -6875.0235246115435, -4391.3098744395, -1789.2065034001369, -3794.5278049261415, -5505.879867181478, -9497.326211254678, -7609.491206697361, -9725.226758124814, -5591.291204679725, -794.0598462702989, -6662.1883262754245, -3561.4702629781436, -3230.125759705392, -1275.6421885847535, -2942.475584489302, -2515.6528766828387, -3466.539413692225, -3026.1954013633044, -5969.983068149035, -2587.177897049008, -3207.9319552736674, -3502.5914573452624, -8358.38616673496, -2409.7021049237514, -6173.037628653427, -9260.458831580037, -6284.307360446286, -4161.132518967818, -3763.880523979174, -80.57043064997976, -15.677139292687496, -5103.792510113596, -5528.247860067782, -3027.6482650733346, -3924.8503033722054, -745.9230607272823, -1656.2831282881903, -8677.322065827611, -8830.181284001143, -3235.7533860322606, -7768.950679540863, -1523.416980021227, -1308.4584265330277, -7282.614513775064, -7842.714055087182, -3077.3060796198306, -3147.557626251717, -2918.9610872037797, -3158.4907730839323, -2585.2865737005536, -6401.985136101533, -3590.6237181204674, -3654.4057805370007, -2956.0774868081344, -3444.360127394821, -3867.320429108224, -7126.661210576555, -7054.098505398495, -3196.755809044477, -7908.456336899365, -7576.1976053959215, -6288.341017529141, -7640.047222390918, -3189.3969091643708, -5844.987260024445, -2966.7134649688714, -7165.258804878017, -918.7994216883558, -1353.0208957804125, -2783.2239652457306, -4875.163007175557, -97.90621086791143, -657.4112986298065, -2060.851013549738, -7776.487176589202, -7256.0493655568625, -5552.74391653783, -9977.008962772887, -3040.785829661585, -6621.054247389928, -7603.492989714652, -3604.1502351168915, -2393.597112131213, -2985.637585462344, -2944.657909886251, -76.91559000813446, -3.560902520700828, -2957.9001177130617, -3552.802941462755, -3396.5959013257857, -3485.2081464023495, -2735.3197760758244, -7600.771601822028, -2162.115909228675, -8176.068792303086, -3334.4035092208046, -2891.779169354942, -3055.547184582067, -4629.1470689614025, -2303.646372581144, -5924.9425850737725, -2185.827673414644, -1236.9452148078583, -4799.839473248317, -2849.107717441576, -2820.5830711968197, -2658.73910020285, -3745.332614072258, -3261.894631204066, -120.86715503977445, -5.248109953356742, -2922.9922622701306, -6449.694054427364, -3847.2521560942114, -3252.949359391879, -480.4547145314257, -1276.0205521081389, -4670.25144198006, -5304.025792396647, -3795.1683826378326, -2630.003383809761, -4335.733519631863, -2044.5818173874882, -281.04148062408797, -667.9299060668994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998495940887766, "mean_inference_ms": 0.9721757269633163, "mean_action_processing_ms": 0.16737384218245047, "mean_env_wait_ms": 0.051102133694491896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003716707229614258, "StateBufferConnector_ms": 0.002669095993041992, "ViewRequirementAgentConnector_ms": 0.06896376609802246}, "num_episodes": 26, "episode_return_max": -76.91559000813447, "episode_return_min": -11209.901832542488, "episode_return_mean": -5634.429138160202}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.2584336006648, "num_env_steps_trained_throughput_per_sec": 554.2584336006648, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 7180.698, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7180.663, "sample_time_ms": 736.276, "learn_time_ms": 6432.405, "learn_throughput": 621.851, "synch_weights_time_ms": 11.521}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "training_iteration": 109, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-01", "timestamp": 1723232401, "time_this_iter_s": 7.220585107803345, "time_total_s": 819.925274848938, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3057b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 819.925274848938, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 26.018181818181812, "ram_util_percent": 80.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.476985947353144, "cur_kl_coeff": 29.192926025390634, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.842719182372093, "policy_loss": 0.02534089020191459, "vf_loss": 9.993351075053216, "vf_explained_var": 1.6235622266928353e-05, "kl": 0.02822694726152501, "entropy": 1.3954507832725842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9266252410317224, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995070393375618, "policy_loss": -0.00435974882366185, "vf_loss": 9.99584233319318, "vf_explained_var": 5.410083387263869e-06, "kl": 0.015945778744758436, "entropy": 1.1757784751357225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": -76.91559000813447, "episode_reward_min": -10233.92306547136, "episode_reward_mean": -5501.883975321081, "episode_len_mean": 174.39, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 17439, "policy_reward_min": {"agent_policy": 3.560902520700828, "adversary_policy": -10233.92306547136}, "policy_reward_max": {"agent_policy": 8494.22345170503, "adversary_policy": -3.560902520700828}, "policy_reward_mean": {"agent_policy": 3296.6555395816395, "adversary_policy": -4399.26975745136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5250.6110889479705, -7036.2144597222305, -288.99802723229175, -6374.093079908438, -5395.458599353532, -9204.2351326301, -3414.44146048501, -7769.130040706537, -5366.804145803805, -7237.408423617724, -5331.380727685153, -8909.577081184205, -7169.203286679599, -2333.391601824516, -611.163940977287, -10233.92306547136, -5906.531381819559, -1218.6156868034884, -2823.8692999238833, -7877.280359382755, -4391.3098744395, -5505.879867181478, -9497.326211254676, -9725.226758124812, -6662.1883262754245, -4622.646104049848, -3074.968584513165, -3822.45530637543, -6039.970588245691, -3279.0427465636512, -8358.38616673496, -6173.037628653431, -9260.458831580036, -4459.682257209518, -80.57043064997977, -6151.605173907996, -3930.9762935400854, -1661.6558114485447, -9013.279898123727, -7768.950679540863, -1604.310036570851, -8342.692867260364, -3379.10182327115, -3255.353184301412, -6424.426010845606, -3766.1715028769095, -3724.8655787248963, -7126.661210576555, -7332.550534136287, -8038.761937735515, -7881.939359723307, -5844.9872600244435, -7546.077493605727, -1405.5844173889209, -5190.679709387453, -657.4112986298065, -7776.487176589202, -7256.0493655568625, -9977.008962772885, -7637.67274507047, -4338.851055249089, -3880.855184821963, -76.91559000813447, -3554.0679472937786, -4471.318225386273, -7668.840238325623, -8176.068792303086, -3654.5390019167567, -4637.069536462076, -6129.842137731808, -2185.827673414644, -4799.839473248317, -3077.9919907485696, -4114.634066652769, -120.86715503977445, -6688.658343109572, -4551.839622480788, -1276.0205521081389, -5313.066196060503, -3864.4508289173023, -4567.532622633696, -667.9299060668994, -7201.734877059509, -5239.944171436783, -9235.17319676687, -8193.46783320138, -5829.306910939203, -6321.582644049036, -7630.016893925979, -7770.064762451264, -7170.874602391792, -9603.934391624834, -6122.516040432369, -6897.63412103011, -6152.721263301068, -6923.56004174669, -7624.173970618066, -6606.874858614664, -5861.657315405655, -4585.392593512385], "episode_lengths": [200, 200, 16, 200, 200, 170, 197, 200, 200, 200, 200, 200, 200, 146, 30, 200, 200, 62, 153, 200, 106, 200, 200, 200, 127, 173, 104, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 57, 200, 200, 88, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 200, 18, 200, 200, 200, 200, 177, 200, 3, 200, 200, 200, 200, 200, 200, 200, 71, 200, 200, 200, 4, 200, 200, 38, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4083.4212821167207, 3184.792111531813, 84.33440149322881, 3292.1527932377658, 2973.191440420676, 2294.434803562676, 1203.5535598694353, 5427.456527925805, 3093.5633144720005, 6823.841603708943, 3871.1293358601606, 6524.397338360678, 5545.464887884592, 921.8796184806777, 150.06022458580813, 7176.892551825882, 2383.6377653046156, 734.3942465373003, 1494.909076087172, 6800.595280588492, 1789.2065034001369, 3794.5278049261415, 7609.491206697361, 5591.291204679725, 794.0598462702989, 2168.949918633694, 1143.1491885608914, 2159.736983999632, 2956.20788126665, 2516.067105759025, 3502.5914573452624, 2409.7021049237514, 6284.307360446286, 3465.3307857374707, 15.677139292687496, 4480.4351962733845, 3021.522274905454, 740.5503775669279, 8494.22345170503, 3235.7533860322606, 1227.5653699834033, 6782.635701601875, 2845.7618826003963, 2822.0986759863003, 2562.8456989564806, 3478.857995780558, 2675.5720354780583, 3867.320429108224, 2918.303780306688, 7445.8920045597715, 6046.4488801967545, 3189.3969091643708, 2585.8947762411585, 866.2359000798472, 2467.70726303383, 97.90621086791143, 2060.851013549738, 5552.74391653783, 3040.785829661585, 6586.874492034109, 1658.896291999016, 2049.440310526638, 3.560902520700828, 2956.6351118820385, 2410.485822341861, 2667.2511395722286, 2162.115909228675, 2571.643676658992, 3047.624717081392, 2098.7468199231107, 1236.9452148078583, 2849.107717441576, 2401.3301806511004, 2892.5931786235556, 5.248109953356742, 2684.0279735879194, 2548.3618930053017, 480.4547145314257, 4661.211038316205, 2560.720937530292, 1812.782714385662, 281.04148062408797, 3379.4595231835415, 3412.9187576745308, 5741.84291439511, 6902.152811840475, 4603.712231525638, 5180.494592140823, 6972.42094706749, 4055.114315540591, 6401.554831050048, 4350.776549375918, 2295.6501441381674, 6067.889369452997, 2657.239979668078, 5770.469866364316, 2144.602540655322, 3275.0169177157727, 4375.547597145662, 2679.8821060311075], "policy_adversary_policy_reward": [-4083.4212821167207, -5250.6110889479705, -3184.792111531813, -7036.2144597222305, -288.9980272322917, -84.33440149322881, -3292.998245245975, -6373.247627900229, -5029.347718309718, -3339.302321464485, -9203.773086621228, -2294.8968495715485, -1880.7886622317685, -2737.206358122675, -5439.54324033388, -7757.043328298463, -5366.804145803805, -3093.5633144720005, -7114.818941389614, -6946.43108593705, -4668.987288528141, -4533.522775017184, -8899.145261442041, -6534.8291581028425, -7166.012583858612, -5548.655590705581, -1549.6939569078127, -1705.5772633973816, -611.163940977287, -150.06022458580813, -10233.92306547136, -7176.892551825882, -2531.1762677972815, -5758.9928793268955, -819.6708761268154, -1133.3390572139733, -2823.8692999238833, -1494.909076087172, -7802.852115359703, -6875.0235246115435, -4391.3098744395, -1789.2065034001369, -3794.5278049261415, -5505.879867181478, -9497.326211254678, -7609.491206697361, -9725.226758124814, -5591.291204679725, -794.0598462702989, -6662.1883262754245, -3561.4702629781436, -3230.125759705392, -1275.6421885847535, -2942.475584489302, -2515.6528766828387, -3466.539413692225, -3026.1954013633044, -5969.983068149035, -2587.177897049008, -3207.9319552736674, -3502.5914573452624, -8358.38616673496, -2409.7021049237514, -6173.037628653427, -9260.458831580037, -6284.307360446286, -4161.132518967818, -3763.880523979174, -80.57043064997976, -15.677139292687496, -5103.792510113596, -5528.247860067782, -3027.6482650733346, -3924.8503033722054, -745.9230607272823, -1656.2831282881903, -8677.322065827611, -8830.181284001143, -3235.7533860322606, -7768.950679540863, -1523.416980021227, -1308.4584265330277, -7282.614513775064, -7842.714055087182, -3077.3060796198306, -3147.557626251717, -2918.9610872037797, -3158.4907730839323, -2585.2865737005536, -6401.985136101533, -3590.6237181204674, -3654.4057805370007, -2956.0774868081344, -3444.360127394821, -3867.320429108224, -7126.661210576555, -7054.098505398495, -3196.755809044477, -7908.456336899365, -7576.1976053959215, -6288.341017529141, -7640.047222390918, -3189.3969091643708, -5844.987260024445, -2966.7134649688714, -7165.258804878017, -918.7994216883558, -1353.0208957804125, -2783.2239652457306, -4875.163007175557, -97.90621086791143, -657.4112986298065, -2060.851013549738, -7776.487176589202, -7256.0493655568625, -5552.74391653783, -9977.008962772887, -3040.785829661585, -6621.054247389928, -7603.492989714652, -3604.1502351168915, -2393.597112131213, -2985.637585462344, -2944.657909886251, -76.91559000813446, -3.560902520700828, -2957.9001177130617, -3552.802941462755, -3396.5959013257857, -3485.2081464023495, -2735.3197760758244, -7600.771601822028, -2162.115909228675, -8176.068792303086, -3334.4035092208046, -2891.779169354942, -3055.547184582067, -4629.1470689614025, -2303.646372581144, -5924.9425850737725, -2185.827673414644, -1236.9452148078583, -4799.839473248317, -2849.107717441576, -2820.5830711968197, -2658.73910020285, -3745.332614072258, -3261.894631204066, -120.86715503977445, -5.248109953356742, -2922.9922622701306, -6449.694054427364, -3847.2521560942114, -3252.949359391879, -480.4547145314257, -1276.0205521081389, -4670.25144198006, -5304.025792396647, -3795.1683826378326, -2630.003383809761, -4335.733519631863, -2044.5818173874882, -281.04148062408797, -667.9299060668994, -6693.626906321578, -3887.5674939214728, -4606.415796700419, -4046.447132410883, -9235.17319676687, -5741.84291439511, -6959.702262186607, -8135.918382855243, -5151.802957350549, -5281.216185114289, -5816.680112274121, -5685.397123915735, -7227.538052738366, -7374.899788255103, -7755.8054546057665, -4069.3736233860845, -6830.973762840262, -6741.455670601576, -4350.776549375918, -9603.934391624834, -2295.6501441381674, -6122.516040432369, -6893.545234409269, -6071.978256073838, -6152.486482542826, -2657.4747604263216, -6110.257380744309, -6583.772527366699, -7163.951800627031, -2604.824710646357, -3379.863717997603, -6502.028058332834, -5853.688401701546, -4383.516510849777, -3205.56782234921, -4059.7068771942822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996000943870179, "mean_inference_ms": 0.9723580342035468, "mean_action_processing_ms": 0.16732760322160395, "mean_env_wait_ms": 0.05109188487475306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036118030548095703, "StateBufferConnector_ms": 0.00288546085357666, "ViewRequirementAgentConnector_ms": 0.06918704509735107}, "num_episodes": 18, "episode_return_max": -76.91559000813447, "episode_return_min": -10233.92306547136, "episode_return_mean": -5501.883975321081}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 571.8194558442932, "num_env_steps_trained_throughput_per_sec": 571.8194558442932, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 7174.299, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7174.264, "sample_time_ms": 735.863, "learn_time_ms": 6426.525, "learn_throughput": 622.42, "synch_weights_time_ms": 11.416}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 110, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-09", "timestamp": 1723232409, "time_this_iter_s": 6.998764991760254, "time_total_s": 826.9240398406982, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b322bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 826.9240398406982, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 22.979999999999997, "ram_util_percent": 80.66999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.872962355489532, "cur_kl_coeff": 43.78938903808593, "cur_lr": 5.0000000000000016e-05, "total_loss": 11.19859177172184, "policy_loss": 0.014385167936173579, "vf_loss": 10.0, "vf_explained_var": -7.985159754753113e-06, "kl": 0.027043230721513586, "entropy": 1.4086951644470294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8856486449323634, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004942717880168, "policy_loss": 0.0010591297098755757, "vf_loss": 10.0, "vf_explained_var": 6.576631435010799e-06, "kl": 0.017260401762982526, "entropy": 1.1867453032700472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "env_runners": {"episode_reward_max": -76.91559000813447, "episode_reward_min": -9977.008962772885, "episode_reward_mean": -5590.0784104855375, "episode_len_mean": 180.18, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 18018, "policy_reward_min": {"agent_policy": 3.560902520700828, "adversary_policy": -9977.008962772887}, "policy_reward_max": {"agent_policy": 8944.401772424198, "adversary_policy": -3.560902520700828}, "policy_reward_mean": {"agent_policy": 3338.864944825858, "adversary_policy": -4464.471677655697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2823.8692999238833, -7877.280359382755, -4391.3098744395, -5505.879867181478, -9497.326211254676, -9725.226758124812, -6662.1883262754245, -4622.646104049848, -3074.968584513165, -3822.45530637543, -6039.970588245691, -3279.0427465636512, -8358.38616673496, -6173.037628653431, -9260.458831580036, -4459.682257209518, -80.57043064997977, -6151.605173907996, -3930.9762935400854, -1661.6558114485447, -9013.279898123727, -7768.950679540863, -1604.310036570851, -8342.692867260364, -3379.10182327115, -3255.353184301412, -6424.426010845606, -3766.1715028769095, -3724.8655787248963, -7126.661210576555, -7332.550534136287, -8038.761937735515, -7881.939359723307, -5844.9872600244435, -7546.077493605727, -1405.5844173889209, -5190.679709387453, -657.4112986298065, -7776.487176589202, -7256.0493655568625, -9977.008962772885, -7637.67274507047, -4338.851055249089, -3880.855184821963, -76.91559000813447, -3554.0679472937786, -4471.318225386273, -7668.840238325623, -8176.068792303086, -3654.5390019167567, -4637.069536462076, -6129.842137731808, -2185.827673414644, -4799.839473248317, -3077.9919907485696, -4114.634066652769, -120.86715503977445, -6688.658343109572, -4551.839622480788, -1276.0205521081389, -5313.066196060503, -3864.4508289173023, -4567.532622633696, -667.9299060668994, -7201.734877059509, -5239.944171436783, -9235.17319676687, -8193.46783320138, -5829.306910939203, -6321.582644049036, -7630.016893925979, -7770.064762451264, -7170.874602391792, -9603.934391624834, -6122.516040432369, -6897.63412103011, -6152.721263301068, -6923.56004174669, -7624.173970618066, -6606.874858614664, -5861.657315405655, -4585.392593512385, -3567.103279936469, -4545.567254722607, -9693.184249236036, -3983.325432656726, -5780.706783264713, -3868.205570249902, -8985.024596616993, -4469.625389306506, -8405.16005930179, -4279.202277674534, -8590.931721320649, -4085.564149303355, -6539.86275709503, -6499.905927042107, -6065.978034751453, -4935.384783169131, -4059.0223335447804, -9516.87014810557], "episode_lengths": [153, 200, 106, 200, 200, 200, 127, 173, 104, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 57, 200, 200, 88, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 200, 18, 200, 200, 200, 200, 177, 200, 3, 200, 200, 200, 200, 200, 200, 200, 71, 200, 200, 200, 4, 200, 200, 38, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1494.909076087172, 6800.595280588492, 1789.2065034001369, 3794.5278049261415, 7609.491206697361, 5591.291204679725, 794.0598462702989, 2168.949918633694, 1143.1491885608914, 2159.736983999632, 2956.20788126665, 2516.067105759025, 3502.5914573452624, 2409.7021049237514, 6284.307360446286, 3465.3307857374707, 15.677139292687496, 4480.4351962733845, 3021.522274905454, 740.5503775669279, 8494.22345170503, 3235.7533860322606, 1227.5653699834033, 6782.635701601875, 2845.7618826003963, 2822.0986759863003, 2562.8456989564806, 3478.857995780558, 2675.5720354780583, 3867.320429108224, 2918.303780306688, 7445.8920045597715, 6046.4488801967545, 3189.3969091643708, 2585.8947762411585, 866.2359000798472, 2467.70726303383, 97.90621086791143, 2060.851013549738, 5552.74391653783, 3040.785829661585, 6586.874492034109, 1658.896291999016, 2049.440310526638, 3.560902520700828, 2956.6351118820385, 2410.485822341861, 2667.2511395722286, 2162.115909228675, 2571.643676658992, 3047.624717081392, 2098.7468199231107, 1236.9452148078583, 2849.107717441576, 2401.3301806511004, 2892.5931786235556, 5.248109953356742, 2684.0279735879194, 2548.3618930053017, 480.4547145314257, 4661.211038316205, 2560.720937530292, 1812.782714385662, 281.04148062408797, 3379.4595231835415, 3412.9187576745308, 5741.84291439511, 6902.152811840475, 4603.712231525638, 5180.494592140823, 6972.42094706749, 4055.114315540591, 6401.554831050048, 4350.776549375918, 2295.6501441381674, 6067.889369452997, 2657.239979668078, 5770.469866364316, 2144.602540655322, 3275.0169177157727, 4375.547597145662, 2679.8821060311075, 3154.2544457545273, 2648.6736469589555, 8944.401772424198, 2401.2078237911683, 4791.728021646437, 2801.579075025409, 4179.6687594852365, 2975.0919202470636, 6397.6033729974615, 2950.868099508291, 2026.6886467980999, 3126.8265212384526, 3710.3361511942117, 2381.639969616021, 3684.8367602416456, 1313.0010340532172, 1578.3689971432893, 4922.763313476933], "policy_adversary_policy_reward": [-2823.8692999238833, -1494.909076087172, -7802.852115359703, -6875.0235246115435, -4391.3098744395, -1789.2065034001369, -3794.5278049261415, -5505.879867181478, -9497.326211254678, -7609.491206697361, -9725.226758124814, -5591.291204679725, -794.0598462702989, -6662.1883262754245, -3561.4702629781436, -3230.125759705392, -1275.6421885847535, -2942.475584489302, -2515.6528766828387, -3466.539413692225, -3026.1954013633044, -5969.983068149035, -2587.177897049008, -3207.9319552736674, -3502.5914573452624, -8358.38616673496, -2409.7021049237514, -6173.037628653427, -9260.458831580037, -6284.307360446286, -4161.132518967818, -3763.880523979174, -80.57043064997976, -15.677139292687496, -5103.792510113596, -5528.247860067782, -3027.6482650733346, -3924.8503033722054, -745.9230607272823, -1656.2831282881903, -8677.322065827611, -8830.181284001143, -3235.7533860322606, -7768.950679540863, -1523.416980021227, -1308.4584265330277, -7282.614513775064, -7842.714055087182, -3077.3060796198306, -3147.557626251717, -2918.9610872037797, -3158.4907730839323, -2585.2865737005536, -6401.985136101533, -3590.6237181204674, -3654.4057805370007, -2956.0774868081344, -3444.360127394821, -3867.320429108224, -7126.661210576555, -7054.098505398495, -3196.755809044477, -7908.456336899365, -7576.1976053959215, -6288.341017529141, -7640.047222390918, -3189.3969091643708, -5844.987260024445, -2966.7134649688714, -7165.258804878017, -918.7994216883558, -1353.0208957804125, -2783.2239652457306, -4875.163007175557, -97.90621086791143, -657.4112986298065, -2060.851013549738, -7776.487176589202, -7256.0493655568625, -5552.74391653783, -9977.008962772887, -3040.785829661585, -6621.054247389928, -7603.492989714652, -3604.1502351168915, -2393.597112131213, -2985.637585462344, -2944.657909886251, -76.91559000813446, -3.560902520700828, -2957.9001177130617, -3552.802941462755, -3396.5959013257857, -3485.2081464023495, -2735.3197760758244, -7600.771601822028, -2162.115909228675, -8176.068792303086, -3334.4035092208046, -2891.779169354942, -3055.547184582067, -4629.1470689614025, -2303.646372581144, -5924.9425850737725, -2185.827673414644, -1236.9452148078583, -4799.839473248317, -2849.107717441576, -2820.5830711968197, -2658.73910020285, -3745.332614072258, -3261.894631204066, -120.86715503977445, -5.248109953356742, -2922.9922622701306, -6449.694054427364, -3847.2521560942114, -3252.949359391879, -480.4547145314257, -1276.0205521081389, -4670.25144198006, -5304.025792396647, -3795.1683826378326, -2630.003383809761, -4335.733519631863, -2044.5818173874882, -281.04148062408797, -667.9299060668994, -6693.626906321578, -3887.5674939214728, -4606.415796700419, -4046.447132410883, -9235.17319676687, -5741.84291439511, -6959.702262186607, -8135.918382855243, -5151.802957350549, -5281.216185114289, -5816.680112274121, -5685.397123915735, -7227.538052738366, -7374.899788255103, -7755.8054546057665, -4069.3736233860845, -6830.973762840262, -6741.455670601576, -4350.776549375918, -9603.934391624834, -2295.6501441381674, -6122.516040432369, -6893.545234409269, -6071.978256073838, -6152.486482542826, -2657.4747604263216, -6110.257380744309, -6583.772527366699, -7163.951800627031, -2604.824710646357, -3379.863717997603, -6502.028058332834, -5853.688401701546, -4383.516510849777, -3205.56782234921, -4059.7068771942822, -3489.9099989198967, -3231.4477267710968, -3285.5324622808816, -3908.7084394006824, -9691.623753061229, -8945.962268599002, -3983.325432656725, -2401.2078237911683, -5761.567195873792, -4810.867609037359, -3865.2145307479877, -2804.5701145273233, -8985.024596616993, -4179.6687594852365, -3871.1965713596633, -3573.5207381939067, -6397.6033729974615, -8405.160059301788, -3104.535659633698, -4125.534717549127, -2026.6886467980999, -8590.931721320649, -3749.8343473150494, -3462.556323226759, -6456.097463786967, -3794.1014445022756, -3615.761301837079, -5265.784594821049, -6065.978034751453, -3684.8367602416456, -4935.38478316913, -1313.0010340532172, -3476.4576342607943, -2160.9336964272734, -9516.870148105572, -4922.763313476933]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39937916312561067, "mean_inference_ms": 0.9712352873602602, "mean_action_processing_ms": 0.16738488080512964, "mean_env_wait_ms": 0.051072715746809126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035446882247924805, "StateBufferConnector_ms": 0.00290679931640625, "ViewRequirementAgentConnector_ms": 0.06892633438110352}, "num_episodes": 18, "episode_return_max": -76.91559000813447, "episode_return_min": -9977.008962772885, "episode_return_mean": -5590.0784104855375}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 559.8911455074511, "num_env_steps_trained_throughput_per_sec": 559.8911455074511, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 7151.87, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7151.836, "sample_time_ms": 729.715, "learn_time_ms": 6410.282, "learn_throughput": 623.998, "synch_weights_time_ms": 11.422}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "training_iteration": 111, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-16", "timestamp": 1723232416, "time_this_iter_s": 7.148720026016235, "time_total_s": 834.0727598667145, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31880d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 834.0727598667145, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 24.169999999999998, "ram_util_percent": 80.67999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.622139336789648, "cur_kl_coeff": 65.68408355712891, "cur_lr": 5.0000000000000016e-05, "total_loss": 12.290686042110126, "policy_loss": 0.021957764363711853, "vf_loss": 9.988495019078254, "vf_explained_var": 4.0467145542303724e-05, "kl": 0.03471515712735709, "entropy": 1.4122310948868593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9387742724052812, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002761251964266, "policy_loss": 0.005832956557989948, "vf_loss": 9.99263362379932, "vf_explained_var": -1.1724139016772074e-06, "kl": 0.01908739267419728, "entropy": 1.1848583105379942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": -75.30690697345393, "episode_reward_min": -10336.310705500982, "episode_reward_mean": -5559.264634980142, "episode_len_mean": 183.58, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18358, "policy_reward_min": {"agent_policy": 3.560902520700828, "adversary_policy": -10336.310705500982}, "policy_reward_max": {"agent_policy": 8944.401772424198, "adversary_policy": -3.560902520700828}, "policy_reward_mean": {"agent_policy": 3343.0055343629224, "adversary_policy": -4451.135084671532}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3379.10182327115, -3255.353184301412, -6424.426010845606, -3766.1715028769095, -3724.8655787248963, -7126.661210576555, -7332.550534136287, -8038.761937735515, -7881.939359723307, -5844.9872600244435, -7546.077493605727, -1405.5844173889209, -5190.679709387453, -657.4112986298065, -7776.487176589202, -7256.0493655568625, -9977.008962772885, -7637.67274507047, -4338.851055249089, -3880.855184821963, -76.91559000813447, -3554.0679472937786, -4471.318225386273, -7668.840238325623, -8176.068792303086, -3654.5390019167567, -4637.069536462076, -6129.842137731808, -2185.827673414644, -4799.839473248317, -3077.9919907485696, -4114.634066652769, -120.86715503977445, -6688.658343109572, -4551.839622480788, -1276.0205521081389, -5313.066196060503, -3864.4508289173023, -4567.532622633696, -667.9299060668994, -7201.734877059509, -5239.944171436783, -9235.17319676687, -8193.46783320138, -5829.306910939203, -6321.582644049036, -7630.016893925979, -7770.064762451264, -7170.874602391792, -9603.934391624834, -6122.516040432369, -6897.63412103011, -6152.721263301068, -6923.56004174669, -7624.173970618066, -6606.874858614664, -5861.657315405655, -4585.392593512385, -3567.103279936469, -4545.567254722607, -9693.184249236036, -3983.325432656726, -5780.706783264713, -3868.205570249902, -8985.024596616993, -4469.625389306506, -8405.16005930179, -4279.202277674534, -8590.931721320649, -4085.564149303355, -6539.86275709503, -6499.905927042107, -6065.978034751453, -4935.384783169131, -4059.0223335447804, -9516.87014810557, -7037.4822700815575, -6374.027961364301, -8212.08442481039, -4505.020021681009, -4221.9794599906345, -4079.670772796938, -8522.478527854213, -6432.576405296258, -4843.240471546709, -4564.898307019792, -5372.759255548601, -4450.954245823556, -9862.380964876631, -6656.233562096506, -4998.868967034977, -10336.310705500982, -6681.594802163991, -168.95181825930683, -6468.074561314101, -2745.041290401977, -5968.56651842523, -75.30690697345393, -3873.801433694504, -4594.088896455446], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 200, 18, 200, 200, 200, 200, 177, 200, 3, 200, 200, 200, 200, 200, 200, 200, 71, 200, 200, 200, 4, 200, 200, 38, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 13, 133, 200], "policy_agent_policy_reward": [2845.7618826003963, 2822.0986759863003, 2562.8456989564806, 3478.857995780558, 2675.5720354780583, 3867.320429108224, 2918.303780306688, 7445.8920045597715, 6046.4488801967545, 3189.3969091643708, 2585.8947762411585, 866.2359000798472, 2467.70726303383, 97.90621086791143, 2060.851013549738, 5552.74391653783, 3040.785829661585, 6586.874492034109, 1658.896291999016, 2049.440310526638, 3.560902520700828, 2956.6351118820385, 2410.485822341861, 2667.2511395722286, 2162.115909228675, 2571.643676658992, 3047.624717081392, 2098.7468199231107, 1236.9452148078583, 2849.107717441576, 2401.3301806511004, 2892.5931786235556, 5.248109953356742, 2684.0279735879194, 2548.3618930053017, 480.4547145314257, 4661.211038316205, 2560.720937530292, 1812.782714385662, 281.04148062408797, 3379.4595231835415, 3412.9187576745308, 5741.84291439511, 6902.152811840475, 4603.712231525638, 5180.494592140823, 6972.42094706749, 4055.114315540591, 6401.554831050048, 4350.776549375918, 2295.6501441381674, 6067.889369452997, 2657.239979668078, 5770.469866364316, 2144.602540655322, 3275.0169177157727, 4375.547597145662, 2679.8821060311075, 3154.2544457545273, 2648.6736469589555, 8944.401772424198, 2401.2078237911683, 4791.728021646437, 2801.579075025409, 4179.6687594852365, 2975.0919202470636, 6397.6033729974615, 2950.868099508291, 2026.6886467980999, 3126.8265212384526, 3710.3361511942117, 2381.639969616021, 3684.8367602416456, 1313.0010340532172, 1578.3689971432893, 4922.763313476933, 6047.630153605389, 5107.901931545713, 2766.6050926617395, 2006.0015370992369, 3603.240958067176, 2517.377805563613, 5087.648880247598, 5290.084902178238, 2170.577593798418, 3283.7339067189223, 3116.140070985242, 4086.5911894383576, 3884.6750502133577, 4115.435433829395, 3731.22806891013, 5561.177539331297, 4204.409581655752, 21.187059608139478, 5751.047070431856, 2092.047170487182, 3292.6298001896516, 49.80201129256794, 2517.4637483945953, 2587.909004135932], "policy_adversary_policy_reward": [-3077.3060796198306, -3147.557626251717, -2918.9610872037797, -3158.4907730839323, -2585.2865737005536, -6401.985136101533, -3590.6237181204674, -3654.4057805370007, -2956.0774868081344, -3444.360127394821, -3867.320429108224, -7126.661210576555, -7054.098505398495, -3196.755809044477, -7908.456336899365, -7576.1976053959215, -6288.341017529141, -7640.047222390918, -3189.3969091643708, -5844.987260024445, -2966.7134649688714, -7165.258804878017, -918.7994216883558, -1353.0208957804125, -2783.2239652457306, -4875.163007175557, -97.90621086791143, -657.4112986298065, -2060.851013549738, -7776.487176589202, -7256.0493655568625, -5552.74391653783, -9977.008962772887, -3040.785829661585, -6621.054247389928, -7603.492989714652, -3604.1502351168915, -2393.597112131213, -2985.637585462344, -2944.657909886251, -76.91559000813446, -3.560902520700828, -2957.9001177130617, -3552.802941462755, -3396.5959013257857, -3485.2081464023495, -2735.3197760758244, -7600.771601822028, -2162.115909228675, -8176.068792303086, -3334.4035092208046, -2891.779169354942, -3055.547184582067, -4629.1470689614025, -2303.646372581144, -5924.9425850737725, -2185.827673414644, -1236.9452148078583, -4799.839473248317, -2849.107717441576, -2820.5830711968197, -2658.73910020285, -3745.332614072258, -3261.894631204066, -120.86715503977445, -5.248109953356742, -2922.9922622701306, -6449.694054427364, -3847.2521560942114, -3252.949359391879, -480.4547145314257, -1276.0205521081389, -4670.25144198006, -5304.025792396647, -3795.1683826378326, -2630.003383809761, -4335.733519631863, -2044.5818173874882, -281.04148062408797, -667.9299060668994, -6693.626906321578, -3887.5674939214728, -4606.415796700419, -4046.447132410883, -9235.17319676687, -5741.84291439511, -6959.702262186607, -8135.918382855243, -5151.802957350549, -5281.216185114289, -5816.680112274121, -5685.397123915735, -7227.538052738366, -7374.899788255103, -7755.8054546057665, -4069.3736233860845, -6830.973762840262, -6741.455670601576, -4350.776549375918, -9603.934391624834, -2295.6501441381674, -6122.516040432369, -6893.545234409269, -6071.978256073838, -6152.486482542826, -2657.4747604263216, -6110.257380744309, -6583.772527366699, -7163.951800627031, -2604.824710646357, -3379.863717997603, -6502.028058332834, -5853.688401701546, -4383.516510849777, -3205.56782234921, -4059.7068771942822, -3489.9099989198967, -3231.4477267710968, -3285.5324622808816, -3908.7084394006824, -9691.623753061229, -8945.962268599002, -3983.325432656725, -2401.2078237911683, -5761.567195873792, -4810.867609037359, -3865.2145307479877, -2804.5701145273233, -8985.024596616993, -4179.6687594852365, -3871.1965713596633, -3573.5207381939067, -6397.6033729974615, -8405.160059301788, -3104.535659633698, -4125.534717549127, -2026.6886467980999, -8590.931721320649, -3749.8343473150494, -3462.556323226759, -6456.097463786967, -3794.1014445022756, -3615.761301837079, -5265.784594821049, -6065.978034751453, -3684.8367602416456, -4935.38478316913, -1313.0010340532172, -3476.4576342607943, -2160.9336964272734, -9516.870148105572, -4922.763313476933, -7035.412117912573, -6049.7003057743705, -6176.899632892251, -5305.030260017763, -2842.255859271068, -8136.433658201061, -4501.4737783388355, -2009.5477804414095, -3619.4332004822263, -4205.787217575585, -3806.675535891059, -2790.3730424694963, -8522.478527854215, -5087.648880247598, -6431.8426371653195, -5290.818670309177, -4843.240471546708, -2170.577593798418, -4514.386875036934, -3334.2453387017813, -5372.759255548601, -3116.140070985242, -4341.624671675744, -4195.92076358617, -3884.6750502133577, -9862.380964876631, -4115.435433829395, -6656.233562096506, -3737.3962572255773, -4992.700778719529, -10336.310705500982, -5561.177539331297, -6681.594802163991, -4204.409581655752, -21.187059608139478, -168.95181825930683, -6434.27106528651, -5784.850566459445, -2206.1107981649557, -2630.9776627242036, -3362.4350059656135, -5898.761312649269, -66.02856582847943, -59.08035243754243, -2788.0054291107745, -3603.259752978323, -3541.573745386498, -3640.424155204873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39915283742360574, "mean_inference_ms": 0.970572470532297, "mean_action_processing_ms": 0.1672865060978485, "mean_env_wait_ms": 0.051013920715097034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034189224243164062, "StateBufferConnector_ms": 0.002766847610473633, "ViewRequirementAgentConnector_ms": 0.07035183906555176}, "num_episodes": 24, "episode_return_max": -75.30690697345393, "episode_return_min": -10336.310705500982, "episode_return_mean": -5559.264634980142}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 559.4156863847404, "num_env_steps_trained_throughput_per_sec": 559.4156863847404, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 7151.667, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7151.633, "sample_time_ms": 735.095, "learn_time_ms": 6404.804, "learn_throughput": 624.531, "synch_weights_time_ms": 11.317}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 112, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-23", "timestamp": 1723232423, "time_this_iter_s": 7.154590129852295, "time_total_s": 841.2273499965668, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3188700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 841.2273499965668, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 24.327272727272724, "ram_util_percent": 80.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.97254511391123, "cur_kl_coeff": 98.52612533569338, "cur_lr": 5.0000000000000016e-05, "total_loss": 13.820473139484724, "policy_loss": 0.023492735666998974, "vf_loss": 9.987954367200533, "vf_explained_var": 5.927576373020808e-05, "kl": 0.038660061486492245, "entropy": 1.4221648141741752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9589010455936351, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.013026030101473, "policy_loss": 0.013919101461088138, "vf_loss": 9.99364214296694, "vf_explained_var": -6.201752909907588e-06, "kl": 0.024287988301662226, "entropy": 1.1946436413381465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "env_runners": {"episode_reward_max": -75.30690697345393, "episode_reward_min": -10336.310705500982, "episode_reward_mean": -5541.639453979434, "episode_len_mean": 185.66, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18566, "policy_reward_min": {"agent_policy": 5.248109953356742, "adversary_policy": -10336.310705500982}, "policy_reward_max": {"agent_policy": 8944.401772424198, "adversary_policy": -5.248109953356742}, "policy_reward_mean": {"agent_policy": 3347.8718730288283, "adversary_policy": -4444.755663504131}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8176.068792303086, -3654.5390019167567, -4637.069536462076, -6129.842137731808, -2185.827673414644, -4799.839473248317, -3077.9919907485696, -4114.634066652769, -120.86715503977445, -6688.658343109572, -4551.839622480788, -1276.0205521081389, -5313.066196060503, -3864.4508289173023, -4567.532622633696, -667.9299060668994, -7201.734877059509, -5239.944171436783, -9235.17319676687, -8193.46783320138, -5829.306910939203, -6321.582644049036, -7630.016893925979, -7770.064762451264, -7170.874602391792, -9603.934391624834, -6122.516040432369, -6897.63412103011, -6152.721263301068, -6923.56004174669, -7624.173970618066, -6606.874858614664, -5861.657315405655, -4585.392593512385, -3567.103279936469, -4545.567254722607, -9693.184249236036, -3983.325432656726, -5780.706783264713, -3868.205570249902, -8985.024596616993, -4469.625389306506, -8405.16005930179, -4279.202277674534, -8590.931721320649, -4085.564149303355, -6539.86275709503, -6499.905927042107, -6065.978034751453, -4935.384783169131, -4059.0223335447804, -9516.87014810557, -7037.4822700815575, -6374.027961364301, -8212.08442481039, -4505.020021681009, -4221.9794599906345, -4079.670772796938, -8522.478527854213, -6432.576405296258, -4843.240471546709, -4564.898307019792, -5372.759255548601, -4450.954245823556, -9862.380964876631, -6656.233562096506, -4998.868967034977, -10336.310705500982, -6681.594802163991, -168.95181825930683, -6468.074561314101, -2745.041290401977, -5968.56651842523, -75.30690697345393, -3873.801433694504, -4594.088896455446, -4910.106520318853, -147.54615197357117, -3662.4431582777647, -9663.804114127166, -5776.312505488611, -6841.270491307225, -5407.586246262387, -6167.995424623679, -2425.7856689877913, -5794.199282930912, -5484.296543591372, -2276.4347962850197, -3123.569797905547, -6574.196749589189, -5187.883355502105, -3072.4803366143824, -7880.574177424577, -9092.316306856257, -5993.516599548216, -3930.6241597428243, -3814.1208187516027, -8291.159437309469, -6610.273855588302, -4321.623213224831], "episode_lengths": [200, 200, 200, 200, 71, 200, 200, 200, 4, 200, 200, 38, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 13, 133, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2162.115909228675, 2571.643676658992, 3047.624717081392, 2098.7468199231107, 1236.9452148078583, 2849.107717441576, 2401.3301806511004, 2892.5931786235556, 5.248109953356742, 2684.0279735879194, 2548.3618930053017, 480.4547145314257, 4661.211038316205, 2560.720937530292, 1812.782714385662, 281.04148062408797, 3379.4595231835415, 3412.9187576745308, 5741.84291439511, 6902.152811840475, 4603.712231525638, 5180.494592140823, 6972.42094706749, 4055.114315540591, 6401.554831050048, 4350.776549375918, 2295.6501441381674, 6067.889369452997, 2657.239979668078, 5770.469866364316, 2144.602540655322, 3275.0169177157727, 4375.547597145662, 2679.8821060311075, 3154.2544457545273, 2648.6736469589555, 8944.401772424198, 2401.2078237911683, 4791.728021646437, 2801.579075025409, 4179.6687594852365, 2975.0919202470636, 6397.6033729974615, 2950.868099508291, 2026.6886467980999, 3126.8265212384526, 3710.3361511942117, 2381.639969616021, 3684.8367602416456, 1313.0010340532172, 1578.3689971432893, 4922.763313476933, 6047.630153605389, 5107.901931545713, 2766.6050926617395, 2006.0015370992369, 3603.240958067176, 2517.377805563613, 5087.648880247598, 5290.084902178238, 2170.577593798418, 3283.7339067189223, 3116.140070985242, 4086.5911894383576, 3884.6750502133577, 4115.435433829395, 3731.22806891013, 5561.177539331297, 4204.409581655752, 21.187059608139478, 5751.047070431856, 2092.047170487182, 3292.6298001896516, 49.80201129256794, 2517.4637483945953, 2587.909004135932, 2825.5834373359635, 15.419932257947362, 2429.1752685618553, 8062.436852170638, 4350.017226116392, 5073.089169234224, 1880.1166932192973, 4984.884966302771, 1860.7634515070026, 2819.0555763565803, 2461.430407715965, 1228.6162086445547, 1058.1298605844413, 2604.9707015669615, 2479.9624003751655, 1991.8770582906798, 4860.361427771212, 4616.147829507049, 2582.1836183875903, 2512.844909903678, 2695.4374605420107, 5615.4123419286, 2079.373346193239, 2257.1109951028625], "policy_adversary_policy_reward": [-2162.115909228675, -8176.068792303086, -3334.4035092208046, -2891.779169354942, -3055.547184582067, -4629.1470689614025, -2303.646372581144, -5924.9425850737725, -2185.827673414644, -1236.9452148078583, -4799.839473248317, -2849.107717441576, -2820.5830711968197, -2658.73910020285, -3745.332614072258, -3261.894631204066, -120.86715503977445, -5.248109953356742, -2922.9922622701306, -6449.694054427364, -3847.2521560942114, -3252.949359391879, -480.4547145314257, -1276.0205521081389, -4670.25144198006, -5304.025792396647, -3795.1683826378326, -2630.003383809761, -4335.733519631863, -2044.5818173874882, -281.04148062408797, -667.9299060668994, -6693.626906321578, -3887.5674939214728, -4606.415796700419, -4046.447132410883, -9235.17319676687, -5741.84291439511, -6959.702262186607, -8135.918382855243, -5151.802957350549, -5281.216185114289, -5816.680112274121, -5685.397123915735, -7227.538052738366, -7374.899788255103, -7755.8054546057665, -4069.3736233860845, -6830.973762840262, -6741.455670601576, -4350.776549375918, -9603.934391624834, -2295.6501441381674, -6122.516040432369, -6893.545234409269, -6071.978256073838, -6152.486482542826, -2657.4747604263216, -6110.257380744309, -6583.772527366699, -7163.951800627031, -2604.824710646357, -3379.863717997603, -6502.028058332834, -5853.688401701546, -4383.516510849777, -3205.56782234921, -4059.7068771942822, -3489.9099989198967, -3231.4477267710968, -3285.5324622808816, -3908.7084394006824, -9691.623753061229, -8945.962268599002, -3983.325432656725, -2401.2078237911683, -5761.567195873792, -4810.867609037359, -3865.2145307479877, -2804.5701145273233, -8985.024596616993, -4179.6687594852365, -3871.1965713596633, -3573.5207381939067, -6397.6033729974615, -8405.160059301788, -3104.535659633698, -4125.534717549127, -2026.6886467980999, -8590.931721320649, -3749.8343473150494, -3462.556323226759, -6456.097463786967, -3794.1014445022756, -3615.761301837079, -5265.784594821049, -6065.978034751453, -3684.8367602416456, -4935.38478316913, -1313.0010340532172, -3476.4576342607943, -2160.9336964272734, -9516.870148105572, -4922.763313476933, -7035.412117912573, -6049.7003057743705, -6176.899632892251, -5305.030260017763, -2842.255859271068, -8136.433658201061, -4501.4737783388355, -2009.5477804414095, -3619.4332004822263, -4205.787217575585, -3806.675535891059, -2790.3730424694963, -8522.478527854215, -5087.648880247598, -6431.8426371653195, -5290.818670309177, -4843.240471546708, -2170.577593798418, -4514.386875036934, -3334.2453387017813, -5372.759255548601, -3116.140070985242, -4341.624671675744, -4195.92076358617, -3884.6750502133577, -9862.380964876631, -4115.435433829395, -6656.233562096506, -3737.3962572255773, -4992.700778719529, -10336.310705500982, -5561.177539331297, -6681.594802163991, -4204.409581655752, -21.187059608139478, -168.95181825930683, -6434.27106528651, -5784.850566459445, -2206.1107981649557, -2630.9776627242036, -3362.4350059656135, -5898.761312649269, -66.02856582847943, -59.08035243754243, -2788.0054291107745, -3603.259752978323, -3541.573745386498, -3640.424155204873, -4727.728579767865, -3007.9613778869557, -15.419932257947362, -147.54615197357117, -3016.6462647289304, -3074.972162110691, -8066.041797272041, -9660.199169025764, -4657.153442130576, -5469.176289474426, -5077.529783256906, -6836.829877284543, -4753.843821223923, -2533.8591182577466, -4985.794443904139, -6167.085947022311, -2409.317575040686, -1877.231545454109, -5794.199282930912, -2819.0555763565803, -2863.0681249740733, -5082.6588263332615, -1264.698833230697, -2240.3521716988776, -2360.7071771198903, -1820.9924813701018, -3269.600707758983, -5909.56674339717, -4831.999345147129, -2835.8464107301347, -2004.4973777622836, -3059.8600171427775, -7858.069995905031, -4882.865609290757, -9092.316306856257, -4616.147829507049, -5552.692854418626, -3023.0073635171784, -3930.624159742824, -2512.844909903678, -3574.8570805530217, -2934.7011987405913, -8290.707570953433, -5615.8642082846345, -2440.5117153804813, -6249.135486401064, -4321.623213224831, -2257.1109951028625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988658790241786, "mean_inference_ms": 0.9692437825110809, "mean_action_processing_ms": 0.16721424642628768, "mean_env_wait_ms": 0.05100544742735308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003123164176940918, "StateBufferConnector_ms": 0.0027022361755371094, "ViewRequirementAgentConnector_ms": 0.06807565689086914}, "num_episodes": 24, "episode_return_max": -75.30690697345393, "episode_return_min": -10336.310705500982, "episode_return_mean": -5541.639453979434}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.9961815351704, "num_env_steps_trained_throughput_per_sec": 554.9961815351704, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 7140.051, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7140.018, "sample_time_ms": 728.136, "learn_time_ms": 6399.957, "learn_throughput": 625.004, "synch_weights_time_ms": 11.509}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "training_iteration": 113, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-31", "timestamp": 1723232431, "time_this_iter_s": 7.211570739746094, "time_total_s": 848.4389207363129, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b322bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 848.4389207363129, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 25.07, "ram_util_percent": 80.99}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.43916692833106, "cur_kl_coeff": 147.78918800354, "cur_lr": 5.0000000000000016e-05, "total_loss": 14.74329706033071, "policy_loss": 0.018653968626555675, "vf_loss": 9.987113381425539, "vf_explained_var": 0.00027785090108712517, "kl": 0.03205599753612963, "entropy": 1.4251478946457306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8917272133723138, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993754975757902, "policy_loss": -0.008485782638231599, "vf_loss": 9.993419117902322, "vf_explained_var": -0.0001608106194349824, "kl": 0.026138244786117443, "entropy": 1.1975776781480778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": -75.30690697345393, "episode_reward_min": -10336.310705500982, "episode_reward_mean": -5593.607014292647, "episode_len_mean": 187.45, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18745, "policy_reward_min": {"agent_policy": 15.419932257947362, "adversary_policy": -10336.310705500982}, "policy_reward_max": {"agent_policy": 8944.401772424198, "adversary_policy": -15.419932257947362}, "policy_reward_mean": {"agent_policy": 3436.5010916149004, "adversary_policy": -4515.054052953774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6321.582644049036, -7630.016893925979, -7770.064762451264, -7170.874602391792, -9603.934391624834, -6122.516040432369, -6897.63412103011, -6152.721263301068, -6923.56004174669, -7624.173970618066, -6606.874858614664, -5861.657315405655, -4585.392593512385, -3567.103279936469, -4545.567254722607, -9693.184249236036, -3983.325432656726, -5780.706783264713, -3868.205570249902, -8985.024596616993, -4469.625389306506, -8405.16005930179, -4279.202277674534, -8590.931721320649, -4085.564149303355, -6539.86275709503, -6499.905927042107, -6065.978034751453, -4935.384783169131, -4059.0223335447804, -9516.87014810557, -7037.4822700815575, -6374.027961364301, -8212.08442481039, -4505.020021681009, -4221.9794599906345, -4079.670772796938, -8522.478527854213, -6432.576405296258, -4843.240471546709, -4564.898307019792, -5372.759255548601, -4450.954245823556, -9862.380964876631, -6656.233562096506, -4998.868967034977, -10336.310705500982, -6681.594802163991, -168.95181825930683, -6468.074561314101, -2745.041290401977, -5968.56651842523, -75.30690697345393, -3873.801433694504, -4594.088896455446, -4910.106520318853, -147.54615197357117, -3662.4431582777647, -9663.804114127166, -5776.312505488611, -6841.270491307225, -5407.586246262387, -6167.995424623679, -2425.7856689877913, -5794.199282930912, -5484.296543591372, -2276.4347962850197, -3123.569797905547, -6574.196749589189, -5187.883355502105, -3072.4803366143824, -7880.574177424577, -9092.316306856257, -5993.516599548216, -3930.6241597428243, -3814.1208187516027, -8291.159437309469, -6610.273855588302, -4321.623213224831, -4944.011844844993, -7473.028795015496, -410.6637119780514, -4949.92865564854, -5251.455103968971, -1836.4558328047258, -7213.6303189102155, -4354.404186292874, -5998.041238801883, -2282.151458425267, -5179.51185687176, -8193.537630662839, -5460.154224079197, -6409.510054840278, -995.5256859648799, -4466.354967277367, -7493.22932437989, -5781.9386148163585, -5039.338075365461, -5173.555059230576, -5816.134279440141], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 13, 133, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5180.494592140823, 6972.42094706749, 4055.114315540591, 6401.554831050048, 4350.776549375918, 2295.6501441381674, 6067.889369452997, 2657.239979668078, 5770.469866364316, 2144.602540655322, 3275.0169177157727, 4375.547597145662, 2679.8821060311075, 3154.2544457545273, 2648.6736469589555, 8944.401772424198, 2401.2078237911683, 4791.728021646437, 2801.579075025409, 4179.6687594852365, 2975.0919202470636, 6397.6033729974615, 2950.868099508291, 2026.6886467980999, 3126.8265212384526, 3710.3361511942117, 2381.639969616021, 3684.8367602416456, 1313.0010340532172, 1578.3689971432893, 4922.763313476933, 6047.630153605389, 5107.901931545713, 2766.6050926617395, 2006.0015370992369, 3603.240958067176, 2517.377805563613, 5087.648880247598, 5290.084902178238, 2170.577593798418, 3283.7339067189223, 3116.140070985242, 4086.5911894383576, 3884.6750502133577, 4115.435433829395, 3731.22806891013, 5561.177539331297, 4204.409581655752, 21.187059608139478, 5751.047070431856, 2092.047170487182, 3292.6298001896516, 49.80201129256794, 2517.4637483945953, 2587.909004135932, 2825.5834373359635, 15.419932257947362, 2429.1752685618553, 8062.436852170638, 4350.017226116392, 5073.089169234224, 1880.1166932192973, 4984.884966302771, 1860.7634515070026, 2819.0555763565803, 2461.430407715965, 1228.6162086445547, 1058.1298605844413, 2604.9707015669615, 2479.9624003751655, 1991.8770582906798, 4860.361427771212, 4616.147829507049, 2582.1836183875903, 2512.844909903678, 2695.4374605420107, 5615.4123419286, 2079.373346193239, 2257.1109951028625, 2342.6361055120014, 4437.679555927412, 24.33056670497785, 2821.422141366504, 3624.030155088359, 194.77859698215343, 4455.867743298512, 3349.7435525288565, 5369.572391023791, 1701.3971552690332, 3736.7345722898676, 4990.908842721277, 4587.971050938375, 4304.802524404326, 767.1327129772608, 2030.439359766314, 6997.2991731161765, 2175.1001865061385, 2415.5700226188114, 3560.317550197848, 3309.230414339011], "policy_adversary_policy_reward": [-5816.680112274121, -5685.397123915735, -7227.538052738366, -7374.899788255103, -7755.8054546057665, -4069.3736233860845, -6830.973762840262, -6741.455670601576, -4350.776549375918, -9603.934391624834, -2295.6501441381674, -6122.516040432369, -6893.545234409269, -6071.978256073838, -6152.486482542826, -2657.4747604263216, -6110.257380744309, -6583.772527366699, -7163.951800627031, -2604.824710646357, -3379.863717997603, -6502.028058332834, -5853.688401701546, -4383.516510849777, -3205.56782234921, -4059.7068771942822, -3489.9099989198967, -3231.4477267710968, -3285.5324622808816, -3908.7084394006824, -9691.623753061229, -8945.962268599002, -3983.325432656725, -2401.2078237911683, -5761.567195873792, -4810.867609037359, -3865.2145307479877, -2804.5701145273233, -8985.024596616993, -4179.6687594852365, -3871.1965713596633, -3573.5207381939067, -6397.6033729974615, -8405.160059301788, -3104.535659633698, -4125.534717549127, -2026.6886467980999, -8590.931721320649, -3749.8343473150494, -3462.556323226759, -6456.097463786967, -3794.1014445022756, -3615.761301837079, -5265.784594821049, -6065.978034751453, -3684.8367602416456, -4935.38478316913, -1313.0010340532172, -3476.4576342607943, -2160.9336964272734, -9516.870148105572, -4922.763313476933, -7035.412117912573, -6049.7003057743705, -6176.899632892251, -5305.030260017763, -2842.255859271068, -8136.433658201061, -4501.4737783388355, -2009.5477804414095, -3619.4332004822263, -4205.787217575585, -3806.675535891059, -2790.3730424694963, -8522.478527854215, -5087.648880247598, -6431.8426371653195, -5290.818670309177, -4843.240471546708, -2170.577593798418, -4514.386875036934, -3334.2453387017813, -5372.759255548601, -3116.140070985242, -4341.624671675744, -4195.92076358617, -3884.6750502133577, -9862.380964876631, -4115.435433829395, -6656.233562096506, -3737.3962572255773, -4992.700778719529, -10336.310705500982, -5561.177539331297, -6681.594802163991, -4204.409581655752, -21.187059608139478, -168.95181825930683, -6434.27106528651, -5784.850566459445, -2206.1107981649557, -2630.9776627242036, -3362.4350059656135, -5898.761312649269, -66.02856582847943, -59.08035243754243, -2788.0054291107745, -3603.259752978323, -3541.573745386498, -3640.424155204873, -4727.728579767865, -3007.9613778869557, -15.419932257947362, -147.54615197357117, -3016.6462647289304, -3074.972162110691, -8066.041797272041, -9660.199169025764, -4657.153442130576, -5469.176289474426, -5077.529783256906, -6836.829877284543, -4753.843821223923, -2533.8591182577466, -4985.794443904139, -6167.085947022311, -2409.317575040686, -1877.231545454109, -5794.199282930912, -2819.0555763565803, -2863.0681249740733, -5082.6588263332615, -1264.698833230697, -2240.3521716988776, -2360.7071771198903, -1820.9924813701018, -3269.600707758983, -5909.56674339717, -4831.999345147129, -2835.8464107301347, -2004.4973777622836, -3059.8600171427775, -7858.069995905031, -4882.865609290757, -9092.316306856257, -4616.147829507049, -5552.692854418626, -3023.0073635171784, -3930.624159742824, -2512.844909903678, -3574.8570805530217, -2934.7011987405913, -8290.707570953433, -5615.8642082846345, -2440.5117153804813, -6249.135486401064, -4321.623213224831, -2257.1109951028625, -2696.6061604710253, -4590.041789885974, -4496.722492005715, -7413.985858937196, -410.66371197805137, -24.33056670497785, -2832.776986530191, -4938.573810484853, -4046.1375237744023, -4829.347735282928, -194.77859698215343, -1836.4558328047258, -7213.630318910216, -4455.867743298512, -3617.367563615742, -4086.7801752059877, -5889.2723083788, -5478.341321446876, -2019.4375101847634, -1964.1111035095355, -5088.126268414514, -3828.1201607471125, -4990.908842721277, -8193.537630662839, -4665.164695963352, -5382.96057905422, -6409.319623865826, -4304.992955378778, -966.8390562538835, -795.819342688257, -2030.439359766314, -4466.354967277367, -7450.929744070621, -7039.598753425445, -2675.08041682353, -5281.958384498967, -2985.132697205893, -4469.775400778383, -3742.281467249558, -4991.591142178867, -4411.513693405128, -4713.851000374031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987405555122522, "mean_inference_ms": 0.9696910911549509, "mean_action_processing_ms": 0.16713685498852698, "mean_env_wait_ms": 0.051008659035155904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032973289489746094, "StateBufferConnector_ms": 0.002729058265686035, "ViewRequirementAgentConnector_ms": 0.06978845596313477}, "num_episodes": 21, "episode_return_max": -75.30690697345393, "episode_return_min": -10336.310705500982, "episode_return_mean": -5593.607014292647}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 564.1668002217497, "num_env_steps_trained_throughput_per_sec": 564.1668002217497, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 7136.926, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7136.893, "sample_time_ms": 738.285, "learn_time_ms": 6386.516, "learn_throughput": 626.32, "synch_weights_time_ms": 11.674}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 114, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-38", "timestamp": 1723232438, "time_this_iter_s": 7.094609022140503, "time_total_s": 855.5335297584534, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3188790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 855.5335297584534, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 24.636363636363637, "ram_util_percent": 81.02727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.32190250704686, "cur_kl_coeff": 221.68378200531012, "cur_lr": 5.0000000000000016e-05, "total_loss": 15.89341817398866, "policy_loss": 0.019618786900052025, "vf_loss": 9.991988919178645, "vf_explained_var": 0.00013318434357643128, "kl": 0.026532435343445588, "entropy": 1.4228260056426127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9826637606220271, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.016991813094528, "policy_loss": 0.009270817500159696, "vf_loss": 9.995878095475454, "vf_explained_var": -3.746747970581055e-05, "kl": 0.023393386169755587, "entropy": 1.1457112819429427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": -43.80820816137231, "episode_reward_min": -10336.310705500982, "episode_reward_mean": -5173.18570748215, "episode_len_mean": 178.11, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17811, "policy_reward_min": {"agent_policy": 3.466370015595098, "adversary_policy": -10336.310705500982}, "policy_reward_max": {"agent_policy": 8062.436852170638, "adversary_policy": -3.466370015595098}, "policy_reward_mean": {"agent_policy": 3063.2098636993464, "adversary_policy": -4118.197785590749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6539.86275709503, -6499.905927042107, -6065.978034751453, -4935.384783169131, -4059.0223335447804, -9516.87014810557, -7037.4822700815575, -6374.027961364301, -8212.08442481039, -4505.020021681009, -4221.9794599906345, -4079.670772796938, -8522.478527854213, -6432.576405296258, -4843.240471546709, -4564.898307019792, -5372.759255548601, -4450.954245823556, -9862.380964876631, -6656.233562096506, -4998.868967034977, -10336.310705500982, -6681.594802163991, -168.95181825930683, -6468.074561314101, -2745.041290401977, -5968.56651842523, -75.30690697345393, -3873.801433694504, -4594.088896455446, -4910.106520318853, -147.54615197357117, -3662.4431582777647, -9663.804114127166, -5776.312505488611, -6841.270491307225, -5407.586246262387, -6167.995424623679, -2425.7856689877913, -5794.199282930912, -5484.296543591372, -2276.4347962850197, -3123.569797905547, -6574.196749589189, -5187.883355502105, -3072.4803366143824, -7880.574177424577, -9092.316306856257, -5993.516599548216, -3930.6241597428243, -3814.1208187516027, -8291.159437309469, -6610.273855588302, -4321.623213224831, -4944.011844844993, -7473.028795015496, -410.6637119780514, -4949.92865564854, -5251.455103968971, -1836.4558328047258, -7213.6303189102155, -4354.404186292874, -5998.041238801883, -2282.151458425267, -5179.51185687176, -8193.537630662839, -5460.154224079197, -6409.510054840278, -995.5256859648799, -4466.354967277367, -7493.22932437989, -5781.9386148163585, -5039.338075365461, -5173.555059230576, -5816.134279440141, -4095.3748306468397, -3114.105073356016, -149.40820349246837, -3936.3627724843072, -1007.7397856599383, -4069.960360590836, -3814.6049737237067, -4007.632079494265, -84.1482308897354, -4589.045227741582, -10113.759245003595, -7437.258816115024, -9215.42531357216, -6723.99822915385, -727.7449586690831, -5686.754259252448, -43.80820816137231, -7679.760980475079, -6828.062670790315, -7684.171348083442, -4983.722194522231, -6717.005632756591, -5091.248827621503, -6313.513447427559, -3367.857911960496], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 13, 133, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 21, 200, 200, 200, 3, 200, 200, 200, 200, 200, 34, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3710.3361511942117, 2381.639969616021, 3684.8367602416456, 1313.0010340532172, 1578.3689971432893, 4922.763313476933, 6047.630153605389, 5107.901931545713, 2766.6050926617395, 2006.0015370992369, 3603.240958067176, 2517.377805563613, 5087.648880247598, 5290.084902178238, 2170.577593798418, 3283.7339067189223, 3116.140070985242, 4086.5911894383576, 3884.6750502133577, 4115.435433829395, 3731.22806891013, 5561.177539331297, 4204.409581655752, 21.187059608139478, 5751.047070431856, 2092.047170487182, 3292.6298001896516, 49.80201129256794, 2517.4637483945953, 2587.909004135932, 2825.5834373359635, 15.419932257947362, 2429.1752685618553, 8062.436852170638, 4350.017226116392, 5073.089169234224, 1880.1166932192973, 4984.884966302771, 1860.7634515070026, 2819.0555763565803, 2461.430407715965, 1228.6162086445547, 1058.1298605844413, 2604.9707015669615, 2479.9624003751655, 1991.8770582906798, 4860.361427771212, 4616.147829507049, 2582.1836183875903, 2512.844909903678, 2695.4374605420107, 5615.4123419286, 2079.373346193239, 2257.1109951028625, 2342.6361055120014, 4437.679555927412, 24.33056670497785, 2821.422141366504, 3624.030155088359, 194.77859698215343, 4455.867743298512, 3349.7435525288565, 5369.572391023791, 1701.3971552690332, 3736.7345722898676, 4990.908842721277, 4587.971050938375, 4304.802524404326, 767.1327129772608, 2030.439359766314, 6997.2991731161765, 2175.1001865061385, 2415.5700226188114, 3560.317550197848, 3309.230414339011, 2798.1596775544613, 2659.275802274873, 3.466370015595098, 2259.4530575418407, 117.52078035918278, 2053.5895797746025, 2427.9942550646183, 3299.5533371640076, 4.918631357095741, 1993.024904562022, 6825.114118809607, 2084.237383266822, 5396.311099187882, 1823.2295168852502, 364.84635101598934, 2436.844325738191, 16.951228056501858, 4350.797296474396, 5693.751486820714, 3049.522698030492, 2452.961863375423, 2845.9756465585833, 2335.4520758281355, 5749.715730365102, 2253.4618545847675], "policy_adversary_policy_reward": [-6456.097463786967, -3794.1014445022756, -3615.761301837079, -5265.784594821049, -6065.978034751453, -3684.8367602416456, -4935.38478316913, -1313.0010340532172, -3476.4576342607943, -2160.9336964272734, -9516.870148105572, -4922.763313476933, -7035.412117912573, -6049.7003057743705, -6176.899632892251, -5305.030260017763, -2842.255859271068, -8136.433658201061, -4501.4737783388355, -2009.5477804414095, -3619.4332004822263, -4205.787217575585, -3806.675535891059, -2790.3730424694963, -8522.478527854215, -5087.648880247598, -6431.8426371653195, -5290.818670309177, -4843.240471546708, -2170.577593798418, -4514.386875036934, -3334.2453387017813, -5372.759255548601, -3116.140070985242, -4341.624671675744, -4195.92076358617, -3884.6750502133577, -9862.380964876631, -4115.435433829395, -6656.233562096506, -3737.3962572255773, -4992.700778719529, -10336.310705500982, -5561.177539331297, -6681.594802163991, -4204.409581655752, -21.187059608139478, -168.95181825930683, -6434.27106528651, -5784.850566459445, -2206.1107981649557, -2630.9776627242036, -3362.4350059656135, -5898.761312649269, -66.02856582847943, -59.08035243754243, -2788.0054291107745, -3603.259752978323, -3541.573745386498, -3640.424155204873, -4727.728579767865, -3007.9613778869557, -15.419932257947362, -147.54615197357117, -3016.6462647289304, -3074.972162110691, -8066.041797272041, -9660.199169025764, -4657.153442130576, -5469.176289474426, -5077.529783256906, -6836.829877284543, -4753.843821223923, -2533.8591182577466, -4985.794443904139, -6167.085947022311, -2409.317575040686, -1877.231545454109, -5794.199282930912, -2819.0555763565803, -2863.0681249740733, -5082.6588263332615, -1264.698833230697, -2240.3521716988776, -2360.7071771198903, -1820.9924813701018, -3269.600707758983, -5909.56674339717, -4831.999345147129, -2835.8464107301347, -2004.4973777622836, -3059.8600171427775, -7858.069995905031, -4882.865609290757, -9092.316306856257, -4616.147829507049, -5552.692854418626, -3023.0073635171784, -3930.624159742824, -2512.844909903678, -3574.8570805530217, -2934.7011987405913, -8290.707570953433, -5615.8642082846345, -2440.5117153804813, -6249.135486401064, -4321.623213224831, -2257.1109951028625, -2696.6061604710253, -4590.041789885974, -4496.722492005715, -7413.985858937196, -410.66371197805137, -24.33056670497785, -2832.776986530191, -4938.573810484853, -4046.1375237744023, -4829.347735282928, -194.77859698215343, -1836.4558328047258, -7213.630318910216, -4455.867743298512, -3617.367563615742, -4086.7801752059877, -5889.2723083788, -5478.341321446876, -2019.4375101847634, -1964.1111035095355, -5088.126268414514, -3828.1201607471125, -4990.908842721277, -8193.537630662839, -4665.164695963352, -5382.96057905422, -6409.319623865826, -4304.992955378778, -966.8390562538835, -795.819342688257, -2030.439359766314, -4466.354967277367, -7450.929744070621, -7039.598753425445, -2675.08041682353, -5281.958384498967, -2985.132697205893, -4469.775400778383, -3742.281467249558, -4991.591142178867, -4411.513693405128, -4713.851000374031, -2833.1288078195266, -4060.405700381774, -2747.6902524072725, -3025.6906232236174, -3.466370015595098, -149.40820349246837, -2344.2878904444574, -3851.52793958169, -1007.7397856599382, -117.52078035918278, -3037.0781221785564, -3086.471818186881, -3799.6194437872955, -2442.9797850010295, -3913.6653809454056, -3393.520035712867, -4.918631357095741, -84.1482308897354, -1993.024904562022, -4589.045227741582, -10113.759245003592, -6825.114118809607, -7437.258816115025, -2084.237383266822, -9214.96931458625, -5396.767098173794, -6466.421202865354, -2080.8065431737455, -532.276866242711, -560.3144434423615, -5686.754259252448, -2436.844325738191, -43.808208161372306, -16.951228056501858, -7679.760980475078, -4350.797296474396, -5699.918876648102, -6821.895280962926, -7680.162268371293, -3053.5317777426417, -2452.961863375423, -4983.722194522231, -6668.459737810569, -2894.5215415046036, -3661.4483218110704, -3765.2525816385687, -6084.017005103326, -5979.212172689335, -3362.810737663884, -2258.5090288813794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3986155475413813, "mean_inference_ms": 0.9703244414730762, "mean_action_processing_ms": 0.16707924130186458, "mean_env_wait_ms": 0.050981853389591644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003272533416748047, "StateBufferConnector_ms": 0.0025554895401000977, "ViewRequirementAgentConnector_ms": 0.06877684593200684}, "num_episodes": 25, "episode_return_max": -43.80820816137231, "episode_return_min": -10336.310705500982, "episode_return_mean": -5173.18570748215}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 571.1299550213292, "num_env_steps_trained_throughput_per_sec": 571.1299550213292, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 7129.749, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7129.717, "sample_time_ms": 734.907, "learn_time_ms": 6382.953, "learn_throughput": 626.669, "synch_weights_time_ms": 11.395}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 115, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-45", "timestamp": 1723232445, "time_this_iter_s": 7.0075719356536865, "time_total_s": 862.541101694107, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3188af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 862.541101694107, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 23.689999999999998, "ram_util_percent": 80.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.34627440671126, "cur_kl_coeff": 332.5256730079651, "cur_lr": 5.0000000000000016e-05, "total_loss": 20.23237726390362, "policy_loss": 0.02060753805805386, "vf_loss": 10.0, "vf_explained_var": 0.0001199853296081225, "kl": 0.03070971886384844, "entropy": 1.436377105737726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9066772129958269, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.017024363159504, "policy_loss": 0.004353520059317508, "vf_loss": 10.0, "vf_explained_var": -5.792991194144759e-05, "kl": 0.016685882574390798, "entropy": 1.152536431506828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": -43.80820816137231, "episode_reward_min": -10546.712773606909, "episode_reward_mean": -5228.590880799933, "episode_len_mean": 178.11, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 17811, "policy_reward_min": {"agent_policy": 3.466370015595098, "adversary_policy": -10546.71277360691}, "policy_reward_max": {"agent_policy": 8062.436852170638, "adversary_policy": -3.466370015595098}, "policy_reward_mean": {"agent_policy": 3045.164572579027, "adversary_policy": -4136.87772668948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9862.380964876631, -6656.233562096506, -4998.868967034977, -10336.310705500982, -6681.594802163991, -168.95181825930683, -6468.074561314101, -2745.041290401977, -5968.56651842523, -75.30690697345393, -3873.801433694504, -4594.088896455446, -4910.106520318853, -147.54615197357117, -3662.4431582777647, -9663.804114127166, -5776.312505488611, -6841.270491307225, -5407.586246262387, -6167.995424623679, -2425.7856689877913, -5794.199282930912, -5484.296543591372, -2276.4347962850197, -3123.569797905547, -6574.196749589189, -5187.883355502105, -3072.4803366143824, -7880.574177424577, -9092.316306856257, -5993.516599548216, -3930.6241597428243, -3814.1208187516027, -8291.159437309469, -6610.273855588302, -4321.623213224831, -4944.011844844993, -7473.028795015496, -410.6637119780514, -4949.92865564854, -5251.455103968971, -1836.4558328047258, -7213.6303189102155, -4354.404186292874, -5998.041238801883, -2282.151458425267, -5179.51185687176, -8193.537630662839, -5460.154224079197, -6409.510054840278, -995.5256859648799, -4466.354967277367, -7493.22932437989, -5781.9386148163585, -5039.338075365461, -5173.555059230576, -5816.134279440141, -4095.3748306468397, -3114.105073356016, -149.40820349246837, -3936.3627724843072, -1007.7397856599383, -4069.960360590836, -3814.6049737237067, -4007.632079494265, -84.1482308897354, -4589.045227741582, -10113.759245003595, -7437.258816115024, -9215.42531357216, -6723.99822915385, -727.7449586690831, -5686.754259252448, -43.80820816137231, -7679.760980475079, -6828.062670790315, -7684.171348083442, -4983.722194522231, -6717.005632756591, -5091.248827621503, -6313.513447427559, -3367.857911960496, -5170.567721522258, -4681.812444988248, -6244.748041081724, -7858.933507576595, -5250.643568729512, -5575.424506043607, -10546.712773606909, -5603.974033036452, -8325.952602172278, -7236.448553777026, -5009.106366219914, -5427.957510154714, -7528.741827388643, -8063.655626889976, -4905.035345521535, -3695.953145865333, -4634.530017119025, -6014.51584760663], "episode_lengths": [200, 200, 200, 200, 200, 9, 200, 200, 200, 13, 133, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 80, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 21, 200, 200, 200, 3, 200, 200, 200, 200, 200, 34, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3884.6750502133577, 4115.435433829395, 3731.22806891013, 5561.177539331297, 4204.409581655752, 21.187059608139478, 5751.047070431856, 2092.047170487182, 3292.6298001896516, 49.80201129256794, 2517.4637483945953, 2587.909004135932, 2825.5834373359635, 15.419932257947362, 2429.1752685618553, 8062.436852170638, 4350.017226116392, 5073.089169234224, 1880.1166932192973, 4984.884966302771, 1860.7634515070026, 2819.0555763565803, 2461.430407715965, 1228.6162086445547, 1058.1298605844413, 2604.9707015669615, 2479.9624003751655, 1991.8770582906798, 4860.361427771212, 4616.147829507049, 2582.1836183875903, 2512.844909903678, 2695.4374605420107, 5615.4123419286, 2079.373346193239, 2257.1109951028625, 2342.6361055120014, 4437.679555927412, 24.33056670497785, 2821.422141366504, 3624.030155088359, 194.77859698215343, 4455.867743298512, 3349.7435525288565, 5369.572391023791, 1701.3971552690332, 3736.7345722898676, 4990.908842721277, 4587.971050938375, 4304.802524404326, 767.1327129772608, 2030.439359766314, 6997.2991731161765, 2175.1001865061385, 2415.5700226188114, 3560.317550197848, 3309.230414339011, 2798.1596775544613, 2659.275802274873, 3.466370015595098, 2259.4530575418407, 117.52078035918278, 2053.5895797746025, 2427.9942550646183, 3299.5533371640076, 4.918631357095741, 1993.024904562022, 6825.114118809607, 2084.237383266822, 5396.311099187882, 1823.2295168852502, 364.84635101598934, 2436.844325738191, 16.951228056501858, 4350.797296474396, 5693.751486820714, 3049.522698030492, 2452.961863375423, 2845.9756465585833, 2335.4520758281355, 5749.715730365102, 2253.4618545847675, 2880.336448323497, 2314.3190410093634, 5386.179812680532, 4603.649852090606, 2353.7769546955055, 3640.8979802975573, 4561.196977619111, 2740.809449940755, 5372.774832561143, 1971.5784865434282, 3444.485298524447, 1897.284177869768, 4985.857898644527, 2211.492057630142, 2190.8221290610627, 2542.118990406211, 2832.183923536573, 4940.186824168807], "policy_adversary_policy_reward": [-3884.6750502133577, -9862.380964876631, -4115.435433829395, -6656.233562096506, -3737.3962572255773, -4992.700778719529, -10336.310705500982, -5561.177539331297, -6681.594802163991, -4204.409581655752, -21.187059608139478, -168.95181825930683, -6434.27106528651, -5784.850566459445, -2206.1107981649557, -2630.9776627242036, -3362.4350059656135, -5898.761312649269, -66.02856582847943, -59.08035243754243, -2788.0054291107745, -3603.259752978323, -3541.573745386498, -3640.424155204873, -4727.728579767865, -3007.9613778869557, -15.419932257947362, -147.54615197357117, -3016.6462647289304, -3074.972162110691, -8066.041797272041, -9660.199169025764, -4657.153442130576, -5469.176289474426, -5077.529783256906, -6836.829877284543, -4753.843821223923, -2533.8591182577466, -4985.794443904139, -6167.085947022311, -2409.317575040686, -1877.231545454109, -5794.199282930912, -2819.0555763565803, -2863.0681249740733, -5082.6588263332615, -1264.698833230697, -2240.3521716988776, -2360.7071771198903, -1820.9924813701018, -3269.600707758983, -5909.56674339717, -4831.999345147129, -2835.8464107301347, -2004.4973777622836, -3059.8600171427775, -7858.069995905031, -4882.865609290757, -9092.316306856257, -4616.147829507049, -5552.692854418626, -3023.0073635171784, -3930.624159742824, -2512.844909903678, -3574.8570805530217, -2934.7011987405913, -8290.707570953433, -5615.8642082846345, -2440.5117153804813, -6249.135486401064, -4321.623213224831, -2257.1109951028625, -2696.6061604710253, -4590.041789885974, -4496.722492005715, -7413.985858937196, -410.66371197805137, -24.33056670497785, -2832.776986530191, -4938.573810484853, -4046.1375237744023, -4829.347735282928, -194.77859698215343, -1836.4558328047258, -7213.630318910216, -4455.867743298512, -3617.367563615742, -4086.7801752059877, -5889.2723083788, -5478.341321446876, -2019.4375101847634, -1964.1111035095355, -5088.126268414514, -3828.1201607471125, -4990.908842721277, -8193.537630662839, -4665.164695963352, -5382.96057905422, -6409.319623865826, -4304.992955378778, -966.8390562538835, -795.819342688257, -2030.439359766314, -4466.354967277367, -7450.929744070621, -7039.598753425445, -2675.08041682353, -5281.958384498967, -2985.132697205893, -4469.775400778383, -3742.281467249558, -4991.591142178867, -4411.513693405128, -4713.851000374031, -2833.1288078195266, -4060.405700381774, -2747.6902524072725, -3025.6906232236174, -3.466370015595098, -149.40820349246837, -2344.2878904444574, -3851.52793958169, -1007.7397856599382, -117.52078035918278, -3037.0781221785564, -3086.471818186881, -3799.6194437872955, -2442.9797850010295, -3913.6653809454056, -3393.520035712867, -4.918631357095741, -84.1482308897354, -1993.024904562022, -4589.045227741582, -10113.759245003592, -6825.114118809607, -7437.258816115025, -2084.237383266822, -9214.96931458625, -5396.767098173794, -6466.421202865354, -2080.8065431737455, -532.276866242711, -560.3144434423615, -5686.754259252448, -2436.844325738191, -43.808208161372306, -16.951228056501858, -7679.760980475078, -4350.797296474396, -5699.918876648102, -6821.895280962926, -7680.162268371293, -3053.5317777426417, -2452.961863375423, -4983.722194522231, -6668.459737810569, -2894.5215415046036, -3661.4483218110704, -3765.2525816385687, -6084.017005103326, -5979.212172689335, -3362.810737663884, -2258.5090288813794, -5170.567721522258, -2880.336448323497, -2424.9097731375273, -4571.221712860085, -6179.162118634661, -5451.765735127598, -4603.649852090606, -7858.933507576595, -2815.5561792731846, -4788.864344151837, -5575.424506043607, -3640.8979802975573, -10546.71277360691, -4561.196977619111, -5603.974033036452, -2740.809449940755, -5372.774832561143, -8325.952602172278, -7188.231366989839, -2019.7956733306141, -5009.106366219914, -3444.485298524447, -3469.660517356408, -3855.5811706680715, -4985.857898644527, -7528.7418273886415, -8055.211442997207, -2219.9362415229084, -2265.481547608015, -4830.375926974585, -3693.0090650854477, -2545.063071186096, -3761.8345836783033, -3704.8793569772984, -5917.233812773626, -5037.468859001808]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3984734910904812, "mean_inference_ms": 0.9704301819198876, "mean_action_processing_ms": 0.1671459026239134, "mean_env_wait_ms": 0.05097370587374675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003234386444091797, "StateBufferConnector_ms": 0.002536177635192871, "ViewRequirementAgentConnector_ms": 0.06738269329071045}, "num_episodes": 18, "episode_return_max": -43.80820816137231, "episode_return_min": -10546.712773606909, "episode_return_mean": -5228.590880799933}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.1821107612542, "num_env_steps_trained_throughput_per_sec": 533.1821107612542, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 7175.143, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7175.11, "sample_time_ms": 730.904, "learn_time_ms": 6432.195, "learn_throughput": 621.872, "synch_weights_time_ms": 11.549}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 116, "trial_id": "3439d_00000", "date": "2024-08-09_15-40-53", "timestamp": 1723232453, "time_this_iter_s": 7.506548881530762, "time_total_s": 870.0476505756378, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b322b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 870.0476505756378, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 27.690909090909088, "ram_util_percent": 80.51818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.49178666770459, "cur_kl_coeff": 498.7885095119475, "cur_lr": 5.0000000000000016e-05, "total_loss": 34.36304418841998, "policy_loss": 0.031241443184747673, "vf_loss": 9.996287353833516, "vf_explained_var": 0.0001366885999838511, "kl": 0.048789245771088945, "entropy": 1.4510611249754826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9055746800369686, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.018205495360036, "policy_loss": 0.005334594358182537, "vf_loss": 9.998081082641763, "vf_explained_var": -2.4301980538342996e-06, "kl": 0.019476266353632563, "entropy": 1.1539418084280832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "env_runners": {"episode_reward_max": -43.80820816137231, "episode_reward_min": -10546.712773606909, "episode_reward_mean": -5314.876545309809, "episode_len_mean": 183.94, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18394, "policy_reward_min": {"agent_policy": 3.466370015595098, "adversary_policy": -10546.71277360691}, "policy_reward_max": {"agent_policy": 8040.347634557399, "adversary_policy": -3.466370015595098}, "policy_reward_mean": {"agent_policy": 3103.0183940525935, "adversary_policy": -4208.947469681201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5794.199282930912, -5484.296543591372, -2276.4347962850197, -3123.569797905547, -6574.196749589189, -5187.883355502105, -3072.4803366143824, -7880.574177424577, -9092.316306856257, -5993.516599548216, -3930.6241597428243, -3814.1208187516027, -8291.159437309469, -6610.273855588302, -4321.623213224831, -4944.011844844993, -7473.028795015496, -410.6637119780514, -4949.92865564854, -5251.455103968971, -1836.4558328047258, -7213.6303189102155, -4354.404186292874, -5998.041238801883, -2282.151458425267, -5179.51185687176, -8193.537630662839, -5460.154224079197, -6409.510054840278, -995.5256859648799, -4466.354967277367, -7493.22932437989, -5781.9386148163585, -5039.338075365461, -5173.555059230576, -5816.134279440141, -4095.3748306468397, -3114.105073356016, -149.40820349246837, -3936.3627724843072, -1007.7397856599383, -4069.960360590836, -3814.6049737237067, -4007.632079494265, -84.1482308897354, -4589.045227741582, -10113.759245003595, -7437.258816115024, -9215.42531357216, -6723.99822915385, -727.7449586690831, -5686.754259252448, -43.80820816137231, -7679.760980475079, -6828.062670790315, -7684.171348083442, -4983.722194522231, -6717.005632756591, -5091.248827621503, -6313.513447427559, -3367.857911960496, -5170.567721522258, -4681.812444988248, -6244.748041081724, -7858.933507576595, -5250.643568729512, -5575.424506043607, -10546.712773606909, -5603.974033036452, -8325.952602172278, -7236.448553777026, -5009.106366219914, -5427.957510154714, -7528.741827388643, -8063.655626889976, -4905.035345521535, -3695.953145865333, -4634.530017119025, -6014.51584760663, -4031.4049142615713, -10210.167919891406, -2511.775253269553, -3698.759820422795, -4413.134777578656, -6136.859496118616, -6311.755893008633, -4240.890062408007, -6716.67124222822, -6394.743140414459, -5513.530780720012, -4516.088073963322, -5304.8330611340625, -3891.139406198374, -6543.567515101463, -3647.0765799312016, -7270.704984011185, -9478.677134643007, -4752.5959823768935, -4942.090083958358, -5534.171037911983], "episode_lengths": [200, 200, 80, 179, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 21, 200, 200, 200, 3, 200, 200, 200, 200, 200, 34, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2819.0555763565803, 2461.430407715965, 1228.6162086445547, 1058.1298605844413, 2604.9707015669615, 2479.9624003751655, 1991.8770582906798, 4860.361427771212, 4616.147829507049, 2582.1836183875903, 2512.844909903678, 2695.4374605420107, 5615.4123419286, 2079.373346193239, 2257.1109951028625, 2342.6361055120014, 4437.679555927412, 24.33056670497785, 2821.422141366504, 3624.030155088359, 194.77859698215343, 4455.867743298512, 3349.7435525288565, 5369.572391023791, 1701.3971552690332, 3736.7345722898676, 4990.908842721277, 4587.971050938375, 4304.802524404326, 767.1327129772608, 2030.439359766314, 6997.2991731161765, 2175.1001865061385, 2415.5700226188114, 3560.317550197848, 3309.230414339011, 2798.1596775544613, 2659.275802274873, 3.466370015595098, 2259.4530575418407, 117.52078035918278, 2053.5895797746025, 2427.9942550646183, 3299.5533371640076, 4.918631357095741, 1993.024904562022, 6825.114118809607, 2084.237383266822, 5396.311099187882, 1823.2295168852502, 364.84635101598934, 2436.844325738191, 16.951228056501858, 4350.797296474396, 5693.751486820714, 3049.522698030492, 2452.961863375423, 2845.9756465585833, 2335.4520758281355, 5749.715730365102, 2253.4618545847675, 2880.336448323497, 2314.3190410093634, 5386.179812680532, 4603.649852090606, 2353.7769546955055, 3640.8979802975573, 4561.196977619111, 2740.809449940755, 5372.774832561143, 1971.5784865434282, 3444.485298524447, 1897.284177869768, 4985.857898644527, 2211.492057630142, 2190.8221290610627, 2542.118990406211, 2832.183923536573, 4940.186824168807, 3178.598742480909, 7004.344271165681, 1697.2709808238355, 2867.4841042721687, 2390.528612623105, 5463.2749936580985, 3418.6196085215497, 3675.7441903671747, 2229.843823598005, 2506.0401831901413, 2979.31533756433, 2188.637489357072, 2697.5783851505994, 2450.5358519587885, 3897.3154605580685, 2514.9418397841614, 3967.390117415378, 8040.347634557399, 2418.7172296892795, 4254.5681846758025, 5234.783641130992], "policy_adversary_policy_reward": [-5794.199282930912, -2819.0555763565803, -2863.0681249740733, -5082.6588263332615, -1264.698833230697, -2240.3521716988776, -2360.7071771198903, -1820.9924813701018, -3269.600707758983, -5909.56674339717, -4831.999345147129, -2835.8464107301347, -2004.4973777622836, -3059.8600171427775, -7858.069995905031, -4882.865609290757, -9092.316306856257, -4616.147829507049, -5552.692854418626, -3023.0073635171784, -3930.624159742824, -2512.844909903678, -3574.8570805530217, -2934.7011987405913, -8290.707570953433, -5615.8642082846345, -2440.5117153804813, -6249.135486401064, -4321.623213224831, -2257.1109951028625, -2696.6061604710253, -4590.041789885974, -4496.722492005715, -7413.985858937196, -410.66371197805137, -24.33056670497785, -2832.776986530191, -4938.573810484853, -4046.1375237744023, -4829.347735282928, -194.77859698215343, -1836.4558328047258, -7213.630318910216, -4455.867743298512, -3617.367563615742, -4086.7801752059877, -5889.2723083788, -5478.341321446876, -2019.4375101847634, -1964.1111035095355, -5088.126268414514, -3828.1201607471125, -4990.908842721277, -8193.537630662839, -4665.164695963352, -5382.96057905422, -6409.319623865826, -4304.992955378778, -966.8390562538835, -795.819342688257, -2030.439359766314, -4466.354967277367, -7450.929744070621, -7039.598753425445, -2675.08041682353, -5281.958384498967, -2985.132697205893, -4469.775400778383, -3742.281467249558, -4991.591142178867, -4411.513693405128, -4713.851000374031, -2833.1288078195266, -4060.405700381774, -2747.6902524072725, -3025.6906232236174, -3.466370015595098, -149.40820349246837, -2344.2878904444574, -3851.52793958169, -1007.7397856599382, -117.52078035918278, -3037.0781221785564, -3086.471818186881, -3799.6194437872955, -2442.9797850010295, -3913.6653809454056, -3393.520035712867, -4.918631357095741, -84.1482308897354, -1993.024904562022, -4589.045227741582, -10113.759245003592, -6825.114118809607, -7437.258816115025, -2084.237383266822, -9214.96931458625, -5396.767098173794, -6466.421202865354, -2080.8065431737455, -532.276866242711, -560.3144434423615, -5686.754259252448, -2436.844325738191, -43.808208161372306, -16.951228056501858, -7679.760980475078, -4350.797296474396, -5699.918876648102, -6821.895280962926, -7680.162268371293, -3053.5317777426417, -2452.961863375423, -4983.722194522231, -6668.459737810569, -2894.5215415046036, -3661.4483218110704, -3765.2525816385687, -6084.017005103326, -5979.212172689335, -3362.810737663884, -2258.5090288813794, -5170.567721522258, -2880.336448323497, -2424.9097731375273, -4571.221712860085, -6179.162118634661, -5451.765735127598, -4603.649852090606, -7858.933507576595, -2815.5561792731846, -4788.864344151837, -5575.424506043607, -3640.8979802975573, -10546.71277360691, -4561.196977619111, -5603.974033036452, -2740.809449940755, -5372.774832561143, -8325.952602172278, -7188.231366989839, -2019.7956733306141, -5009.106366219914, -3444.485298524447, -3469.660517356408, -3855.5811706680715, -4985.857898644527, -7528.7418273886415, -8055.211442997207, -2219.9362415229084, -2265.481547608015, -4830.375926974585, -3693.0090650854477, -2545.063071186096, -3761.8345836783033, -3704.8793569772984, -5917.233812773626, -5037.468859001808, -3516.198072760216, -3693.8055839822655, -7004.344271165681, -10210.167919891406, -2000.1866652764033, -2208.859568816989, -3638.1510459439614, -2928.092878751002, -4273.041140842664, -2530.6222493590953, -5990.697747114532, -5609.436742662183, -6311.755893008635, -3418.6196085215497, -3863.5183269421723, -4053.115925833012, -2860.1503771985354, -6086.3646886276965, -2506.6048927727916, -6394.178430831809, -2979.31533756433, -5513.530780720012, -4146.3152989534055, -2558.410264366988, -3402.265063675928, -4600.146382608738, -2639.9628818243764, -3701.7123763327877, -4890.742722711967, -5550.140252947567, -2607.502932025218, -3554.5154876901447, -4489.688231586241, -6748.40686984032, -9478.677134643007, -8040.347634557399, -4752.5959823768935, -2418.7172296892795, -4553.588119592159, -4643.070149042003, -5445.525720818088, -5323.428958224889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3983577863108084, "mean_inference_ms": 0.9675341336240106, "mean_action_processing_ms": 0.1670520626972084, "mean_env_wait_ms": 0.05099396455847886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031806230545043945, "StateBufferConnector_ms": 0.0024739503860473633, "ViewRequirementAgentConnector_ms": 0.06714010238647461}, "num_episodes": 21, "episode_return_max": -43.80820816137231, "episode_return_min": -10546.712773606909, "episode_return_mean": -5314.876545309809}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 565.3353001370508, "num_env_steps_trained_throughput_per_sec": 565.3353001370508, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 7157.836, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7157.803, "sample_time_ms": 730.487, "learn_time_ms": 6414.903, "learn_throughput": 623.548, "synch_weights_time_ms": 11.953}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "training_iteration": 117, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-00", "timestamp": 1723232460, "time_this_iter_s": 7.081044912338257, "time_total_s": 877.1286954879761, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3188e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 877.1286954879761, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 23.31, "ram_util_percent": 80.73}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.19754512310028, "cur_kl_coeff": 748.1827642679217, "cur_lr": 5.0000000000000016e-05, "total_loss": 40.890747384230295, "policy_loss": 0.022205644838444036, "vf_loss": 9.994077011942863, "vf_explained_var": 0.0002448239674170812, "kl": 0.04126594073798818, "entropy": 1.4582793367405733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9477021472952353, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.012099294813853, "policy_loss": 0.007428354551404635, "vf_loss": 9.9951876196281, "vf_explained_var": 0.0006276833632635692, "kl": 0.012488339711769075, "entropy": 1.1346428967657542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": -43.80820816137231, "episode_reward_min": -10788.713923856429, "episode_reward_mean": -5338.605734776224, "episode_len_mean": 185.08, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18508, "policy_reward_min": {"agent_policy": 3.466370015595098, "adversary_policy": -10788.713923856429}, "policy_reward_max": {"agent_policy": 8040.347634557399, "adversary_policy": -3.466370015595098}, "policy_reward_mean": {"agent_policy": 3199.2763816108804, "adversary_policy": -4268.941058193553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5998.041238801883, -2282.151458425267, -5179.51185687176, -8193.537630662839, -5460.154224079197, -6409.510054840278, -995.5256859648799, -4466.354967277367, -7493.22932437989, -5781.9386148163585, -5039.338075365461, -5173.555059230576, -5816.134279440141, -4095.3748306468397, -3114.105073356016, -149.40820349246837, -3936.3627724843072, -1007.7397856599383, -4069.960360590836, -3814.6049737237067, -4007.632079494265, -84.1482308897354, -4589.045227741582, -10113.759245003595, -7437.258816115024, -9215.42531357216, -6723.99822915385, -727.7449586690831, -5686.754259252448, -43.80820816137231, -7679.760980475079, -6828.062670790315, -7684.171348083442, -4983.722194522231, -6717.005632756591, -5091.248827621503, -6313.513447427559, -3367.857911960496, -5170.567721522258, -4681.812444988248, -6244.748041081724, -7858.933507576595, -5250.643568729512, -5575.424506043607, -10546.712773606909, -5603.974033036452, -8325.952602172278, -7236.448553777026, -5009.106366219914, -5427.957510154714, -7528.741827388643, -8063.655626889976, -4905.035345521535, -3695.953145865333, -4634.530017119025, -6014.51584760663, -4031.4049142615713, -10210.167919891406, -2511.775253269553, -3698.759820422795, -4413.134777578656, -6136.859496118616, -6311.755893008633, -4240.890062408007, -6716.67124222822, -6394.743140414459, -5513.530780720012, -4516.088073963322, -5304.8330611340625, -3891.139406198374, -6543.567515101463, -3647.0765799312016, -7270.704984011185, -9478.677134643007, -4752.5959823768935, -4942.090083958358, -5534.171037911983, -10788.713923856429, -5617.820741052264, -5617.48896946471, -7209.484102039114, -7640.982106409847, -3963.681925217154, -4084.02008824704, -5497.01452271885, -5550.4308356907895, -5048.732561921754, -144.5212517359189, -584.1639857130585, -4680.557883701312, -5057.63121281803, -4675.557489937113, -4600.4005922200795, -2900.3492268506334, -4836.890784534151, -6156.287998280728, -8602.432385917073, -8071.905283818848, -4509.863386290642, -4414.835568534445], "episode_lengths": [200, 200, 200, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 21, 200, 200, 200, 3, 200, 200, 200, 200, 200, 34, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5369.572391023791, 1701.3971552690332, 3736.7345722898676, 4990.908842721277, 4587.971050938375, 4304.802524404326, 767.1327129772608, 2030.439359766314, 6997.2991731161765, 2175.1001865061385, 2415.5700226188114, 3560.317550197848, 3309.230414339011, 2798.1596775544613, 2659.275802274873, 3.466370015595098, 2259.4530575418407, 117.52078035918278, 2053.5895797746025, 2427.9942550646183, 3299.5533371640076, 4.918631357095741, 1993.024904562022, 6825.114118809607, 2084.237383266822, 5396.311099187882, 1823.2295168852502, 364.84635101598934, 2436.844325738191, 16.951228056501858, 4350.797296474396, 5693.751486820714, 3049.522698030492, 2452.961863375423, 2845.9756465585833, 2335.4520758281355, 5749.715730365102, 2253.4618545847675, 2880.336448323497, 2314.3190410093634, 5386.179812680532, 4603.649852090606, 2353.7769546955055, 3640.8979802975573, 4561.196977619111, 2740.809449940755, 5372.774832561143, 1971.5784865434282, 3444.485298524447, 1897.284177869768, 4985.857898644527, 2211.492057630142, 2190.8221290610627, 2542.118990406211, 2832.183923536573, 4940.186824168807, 3178.598742480909, 7004.344271165681, 1697.2709808238355, 2867.4841042721687, 2390.528612623105, 5463.2749936580985, 3418.6196085215497, 3675.7441903671747, 2229.843823598005, 2506.0401831901413, 2979.31533756433, 2188.637489357072, 2697.5783851505994, 2450.5358519587885, 3897.3154605580685, 2514.9418397841614, 3967.390117415378, 8040.347634557399, 2418.7172296892795, 4254.5681846758025, 5234.783641130992, 5710.974821979251, 3454.1660058105413, 3766.4797643209417, 4124.792507505586, 3717.869093161495, 3092.829092093157, 2859.007746016471, 3197.265316165945, 2743.9703880772954, 2449.5710839649964, 56.1162092341455, 50.74228970338099, 3900.758396144029, 3130.4856922881986, 3254.3433334552765, 3446.0324565012706, 2403.7959343944885, 3771.061335823729, 4733.133795595713, 3508.23682364297, 2086.1714663651883, 3669.144746827494, 3612.253017036556], "policy_adversary_policy_reward": [-5889.2723083788, -5478.341321446876, -2019.4375101847634, -1964.1111035095355, -5088.126268414514, -3828.1201607471125, -4990.908842721277, -8193.537630662839, -4665.164695963352, -5382.96057905422, -6409.319623865826, -4304.992955378778, -966.8390562538835, -795.819342688257, -2030.439359766314, -4466.354967277367, -7450.929744070621, -7039.598753425445, -2675.08041682353, -5281.958384498967, -2985.132697205893, -4469.775400778383, -3742.281467249558, -4991.591142178867, -4411.513693405128, -4713.851000374031, -2833.1288078195266, -4060.405700381774, -2747.6902524072725, -3025.6906232236174, -3.466370015595098, -149.40820349246837, -2344.2878904444574, -3851.52793958169, -1007.7397856599382, -117.52078035918278, -3037.0781221785564, -3086.471818186881, -3799.6194437872955, -2442.9797850010295, -3913.6653809454056, -3393.520035712867, -4.918631357095741, -84.1482308897354, -1993.024904562022, -4589.045227741582, -10113.759245003592, -6825.114118809607, -7437.258816115025, -2084.237383266822, -9214.96931458625, -5396.767098173794, -6466.421202865354, -2080.8065431737455, -532.276866242711, -560.3144434423615, -5686.754259252448, -2436.844325738191, -43.808208161372306, -16.951228056501858, -7679.760980475078, -4350.797296474396, -5699.918876648102, -6821.895280962926, -7680.162268371293, -3053.5317777426417, -2452.961863375423, -4983.722194522231, -6668.459737810569, -2894.5215415046036, -3661.4483218110704, -3765.2525816385687, -6084.017005103326, -5979.212172689335, -3362.810737663884, -2258.5090288813794, -5170.567721522258, -2880.336448323497, -2424.9097731375273, -4571.221712860085, -6179.162118634661, -5451.765735127598, -4603.649852090606, -7858.933507576595, -2815.5561792731846, -4788.864344151837, -5575.424506043607, -3640.8979802975573, -10546.71277360691, -4561.196977619111, -5603.974033036452, -2740.809449940755, -5372.774832561143, -8325.952602172278, -7188.231366989839, -2019.7956733306141, -5009.106366219914, -3444.485298524447, -3469.660517356408, -3855.5811706680715, -4985.857898644527, -7528.7418273886415, -8055.211442997207, -2219.9362415229084, -2265.481547608015, -4830.375926974585, -3693.0090650854477, -2545.063071186096, -3761.8345836783033, -3704.8793569772984, -5917.233812773626, -5037.468859001808, -3516.198072760216, -3693.8055839822655, -7004.344271165681, -10210.167919891406, -2000.1866652764033, -2208.859568816989, -3638.1510459439614, -2928.092878751002, -4273.041140842664, -2530.6222493590953, -5990.697747114532, -5609.436742662183, -6311.755893008635, -3418.6196085215497, -3863.5183269421723, -4053.115925833012, -2860.1503771985354, -6086.3646886276965, -2506.6048927727916, -6394.178430831809, -2979.31533756433, -5513.530780720012, -4146.3152989534055, -2558.410264366988, -3402.265063675928, -4600.146382608738, -2639.9628818243764, -3701.7123763327877, -4890.742722711967, -5550.140252947567, -2607.502932025218, -3554.5154876901447, -4489.688231586241, -6748.40686984032, -9478.677134643007, -8040.347634557399, -4752.5959823768935, -2418.7172296892795, -4553.588119592159, -4643.070149042003, -5445.525720818088, -5323.428958224889, -5710.974821979251, -10788.713923856429, -5560.104022563945, -3511.8827242988605, -5532.691227939539, -3851.2775058461107, -4124.792507505586, -7209.484102039113, -7316.634811240673, -4042.216388330669, -3398.7171767556256, -3657.7938405546856, -3094.436332425094, -3848.5915018384158, -5173.320105365182, -3520.9597335196236, -2743.9703880772954, -5550.4308356907895, -2449.5710839649964, -5048.732561921754, -56.1162092341455, -144.5212517359189, -584.1639857130584, -50.74228970338099, -3942.4526350031215, -4638.86364484222, -3139.6518047099016, -5048.465100396326, -4675.557489937112, -3254.3433334552765, -4551.00217197178, -3495.4308767495695, -2464.7820761736666, -2839.3630850714558, -4801.793708882924, -3806.1584114749544, -5526.730983458888, -5362.690810417546, -8602.432385917073, -3508.23682364297, -2902.0339796241815, -7256.042770559854, -4509.863386290641, -3669.144746827494, -4346.172040084851, -3680.91654548615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39820574433238093, "mean_inference_ms": 0.9682485664006474, "mean_action_processing_ms": 0.16711138572867057, "mean_env_wait_ms": 0.050990771313197764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00324094295501709, "StateBufferConnector_ms": 0.002415895462036133, "ViewRequirementAgentConnector_ms": 0.06478345394134521}, "num_episodes": 23, "episode_return_max": -43.80820816137231, "episode_return_min": -10788.713923856429, "episode_return_mean": -5338.605734776224}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 571.1081997990373, "num_env_steps_trained_throughput_per_sec": 571.1081997990373, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 7138.922, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7138.889, "sample_time_ms": 732.139, "learn_time_ms": 6394.115, "learn_throughput": 625.575, "synch_weights_time_ms": 12.131}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 118, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-07", "timestamp": 1723232467, "time_this_iter_s": 7.008846044540405, "time_total_s": 884.1375415325165, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30491f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 884.1375415325165, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 24.260000000000005, "ram_util_percent": 80.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.33189543684324, "cur_kl_coeff": 1122.274146401882, "cur_lr": 5.0000000000000016e-05, "total_loss": 39.81434592306614, "policy_loss": 0.01554834583196983, "vf_loss": 9.988211397329966, "vf_explained_var": 0.00011901886512835821, "kl": 0.026562659067712956, "entropy": 1.4626044842104118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8858214961394432, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.013758867758291, "policy_loss": 0.008955859144159134, "vf_loss": 9.994267012580993, "vf_explained_var": -0.0005748025639347299, "kl": 0.013874574500091729, "entropy": 1.12280987545296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "env_runners": {"episode_reward_max": -43.80820816137231, "episode_reward_min": -11206.783481467535, "episode_reward_mean": -5875.656927003634, "episode_len_mean": 188.49, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18849, "policy_reward_min": {"agent_policy": 16.951228056501858, "adversary_policy": -11161.788016182087}, "policy_reward_max": {"agent_policy": 9454.746317413665, "adversary_policy": -16.951228056501858}, "policy_reward_mean": {"agent_policy": 3495.649044467022, "adversary_policy": -4685.652985735328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4589.045227741582, -10113.759245003595, -7437.258816115024, -9215.42531357216, -6723.99822915385, -727.7449586690831, -5686.754259252448, -43.80820816137231, -7679.760980475079, -6828.062670790315, -7684.171348083442, -4983.722194522231, -6717.005632756591, -5091.248827621503, -6313.513447427559, -3367.857911960496, -5170.567721522258, -4681.812444988248, -6244.748041081724, -7858.933507576595, -5250.643568729512, -5575.424506043607, -10546.712773606909, -5603.974033036452, -8325.952602172278, -7236.448553777026, -5009.106366219914, -5427.957510154714, -7528.741827388643, -8063.655626889976, -4905.035345521535, -3695.953145865333, -4634.530017119025, -6014.51584760663, -4031.4049142615713, -10210.167919891406, -2511.775253269553, -3698.759820422795, -4413.134777578656, -6136.859496118616, -6311.755893008633, -4240.890062408007, -6716.67124222822, -6394.743140414459, -5513.530780720012, -4516.088073963322, -5304.8330611340625, -3891.139406198374, -6543.567515101463, -3647.0765799312016, -7270.704984011185, -9478.677134643007, -4752.5959823768935, -4942.090083958358, -5534.171037911983, -10788.713923856429, -5617.820741052264, -5617.48896946471, -7209.484102039114, -7640.982106409847, -3963.681925217154, -4084.02008824704, -5497.01452271885, -5550.4308356907895, -5048.732561921754, -144.5212517359189, -584.1639857130585, -4680.557883701312, -5057.63121281803, -4675.557489937113, -4600.4005922200795, -2900.3492268506334, -4836.890784534151, -6156.287998280728, -8602.432385917073, -8071.905283818848, -4509.863386290642, -4414.835568534445, -4513.890767582035, -7748.083003854969, -277.0052524525557, -5483.2743345108975, -4322.8170398686825, -6367.13566480929, -6063.014289584656, -4031.964681268617, -10178.106754499084, -6872.413062190899, -10510.270224255966, -7039.4471695077755, -10109.54829303344, -6331.2392815561525, -9186.381948037466, -7947.018302325021, -11206.783481467535, -6302.7178892203365, -2953.615507660054, -3893.1295227864916, -7831.815524089928, -7103.766008673106], "episode_lengths": [200, 200, 200, 200, 200, 34, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 76, 200, 200, 150], "policy_agent_policy_reward": [1993.024904562022, 6825.114118809607, 2084.237383266822, 5396.311099187882, 1823.2295168852502, 364.84635101598934, 2436.844325738191, 16.951228056501858, 4350.797296474396, 5693.751486820714, 3049.522698030492, 2452.961863375423, 2845.9756465585833, 2335.4520758281355, 5749.715730365102, 2253.4618545847675, 2880.336448323497, 2314.3190410093634, 5386.179812680532, 4603.649852090606, 2353.7769546955055, 3640.8979802975573, 4561.196977619111, 2740.809449940755, 5372.774832561143, 1971.5784865434282, 3444.485298524447, 1897.284177869768, 4985.857898644527, 2211.492057630142, 2190.8221290610627, 2542.118990406211, 2832.183923536573, 4940.186824168807, 3178.598742480909, 7004.344271165681, 1697.2709808238355, 2867.4841042721687, 2390.528612623105, 5463.2749936580985, 3418.6196085215497, 3675.7441903671747, 2229.843823598005, 2506.0401831901413, 2979.31533756433, 2188.637489357072, 2697.5783851505994, 2450.5358519587885, 3897.3154605580685, 2514.9418397841614, 3967.390117415378, 8040.347634557399, 2418.7172296892795, 4254.5681846758025, 5234.783641130992, 5710.974821979251, 3454.1660058105413, 3766.4797643209417, 4124.792507505586, 3717.869093161495, 3092.829092093157, 2859.007746016471, 3197.265316165945, 2743.9703880772954, 2449.5710839649964, 56.1162092341455, 50.74228970338099, 3900.758396144029, 3130.4856922881986, 3254.3433334552765, 3446.0324565012706, 2403.7959343944885, 3771.061335823729, 4733.133795595713, 3508.23682364297, 2086.1714663651883, 3669.144746827494, 3612.253017036556, 2857.9590131858013, 2262.086844495283, 52.818490937535465, 2693.3895310479693, 2622.746197509408, 3971.60252237438, 3577.1952615836904, 3280.145537885476, 2179.516742756002, 6066.4558521152785, 8881.614819819588, 5004.737633413115, 8450.491413385666, 3601.137825585758, 6280.29080332835, 2983.8424365571154, 9454.746317413665, 5270.043223674878, 625.8541023725414, 2662.8805875544413, 6932.567116688107, 1495.5514592046304], "policy_adversary_policy_reward": [-1993.024904562022, -4589.045227741582, -10113.759245003592, -6825.114118809607, -7437.258816115025, -2084.237383266822, -9214.96931458625, -5396.767098173794, -6466.421202865354, -2080.8065431737455, -532.276866242711, -560.3144434423615, -5686.754259252448, -2436.844325738191, -43.808208161372306, -16.951228056501858, -7679.760980475078, -4350.797296474396, -5699.918876648102, -6821.895280962926, -7680.162268371293, -3053.5317777426417, -2452.961863375423, -4983.722194522231, -6668.459737810569, -2894.5215415046036, -3661.4483218110704, -3765.2525816385687, -6084.017005103326, -5979.212172689335, -3362.810737663884, -2258.5090288813794, -5170.567721522258, -2880.336448323497, -2424.9097731375273, -4571.221712860085, -6179.162118634661, -5451.765735127598, -4603.649852090606, -7858.933507576595, -2815.5561792731846, -4788.864344151837, -5575.424506043607, -3640.8979802975573, -10546.71277360691, -4561.196977619111, -5603.974033036452, -2740.809449940755, -5372.774832561143, -8325.952602172278, -7188.231366989839, -2019.7956733306141, -5009.106366219914, -3444.485298524447, -3469.660517356408, -3855.5811706680715, -4985.857898644527, -7528.7418273886415, -8055.211442997207, -2219.9362415229084, -2265.481547608015, -4830.375926974585, -3693.0090650854477, -2545.063071186096, -3761.8345836783033, -3704.8793569772984, -5917.233812773626, -5037.468859001808, -3516.198072760216, -3693.8055839822655, -7004.344271165681, -10210.167919891406, -2000.1866652764033, -2208.859568816989, -3638.1510459439614, -2928.092878751002, -4273.041140842664, -2530.6222493590953, -5990.697747114532, -5609.436742662183, -6311.755893008635, -3418.6196085215497, -3863.5183269421723, -4053.115925833012, -2860.1503771985354, -6086.3646886276965, -2506.6048927727916, -6394.178430831809, -2979.31533756433, -5513.530780720012, -4146.3152989534055, -2558.410264366988, -3402.265063675928, -4600.146382608738, -2639.9628818243764, -3701.7123763327877, -4890.742722711967, -5550.140252947567, -2607.502932025218, -3554.5154876901447, -4489.688231586241, -6748.40686984032, -9478.677134643007, -8040.347634557399, -4752.5959823768935, -2418.7172296892795, -4553.588119592159, -4643.070149042003, -5445.525720818088, -5323.428958224889, -5710.974821979251, -10788.713923856429, -5560.104022563945, -3511.8827242988605, -5532.691227939539, -3851.2775058461107, -4124.792507505586, -7209.484102039113, -7316.634811240673, -4042.216388330669, -3398.7171767556256, -3657.7938405546856, -3094.436332425094, -3848.5915018384158, -5173.320105365182, -3520.9597335196236, -2743.9703880772954, -5550.4308356907895, -2449.5710839649964, -5048.732561921754, -56.1162092341455, -144.5212517359189, -584.1639857130584, -50.74228970338099, -3942.4526350031215, -4638.86364484222, -3139.6518047099016, -5048.465100396326, -4675.557489937112, -3254.3433334552765, -4551.00217197178, -3495.4308767495695, -2464.7820761736666, -2839.3630850714558, -4801.793708882924, -3806.1584114749544, -5526.730983458888, -5362.690810417546, -8602.432385917073, -3508.23682364297, -2902.0339796241815, -7256.042770559854, -4509.863386290641, -3669.144746827494, -4346.172040084851, -3680.91654548615, -4227.2958418574435, -3144.5539389103906, -7748.083003854969, -2262.086844495283, -52.818490937535465, -277.0052524525557, -2693.3895310479693, -5483.2743345108975, -3363.4427508610615, -3582.1204865170303, -3971.60252237438, -6367.13566480929, -5848.345054988641, -3791.8644961796954, -3809.0711606369614, -3503.039058517131, -2179.516742756002, -10178.106754499084, -6758.627635069135, -6180.241279237044, -10510.270224255966, -8881.614819819588, -5726.473341955343, -6317.71146096555, -10109.54829303344, -8450.491413385666, -5266.506725779857, -4665.870381362051, -9186.381948037464, -6280.29080332835, -7943.134713394259, -2987.7260254878775, -11161.788016182087, -9499.74178269911, -5273.65119270264, -6299.109920192576, -2953.6155076600535, -625.8541023725414, -3341.4520922108027, -3214.5580181301316, -7465.423862489173, -7298.958778288862, -7103.766008673106, -1495.5514592046304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39796259979916004, "mean_inference_ms": 0.9680871534376562, "mean_action_processing_ms": 0.16708442750810132, "mean_env_wait_ms": 0.050949917110299496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003289341926574707, "StateBufferConnector_ms": 0.002342700958251953, "ViewRequirementAgentConnector_ms": 0.06457209587097168}, "num_episodes": 22, "episode_return_max": -43.80820816137231, "episode_return_min": -11206.783481467535, "episode_return_mean": -5875.656927003634}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.5874094257593, "num_env_steps_trained_throughput_per_sec": 553.5874094257593, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 7139.797, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7139.764, "sample_time_ms": 736.755, "learn_time_ms": 6390.306, "learn_throughput": 625.948, "synch_weights_time_ms": 12.203}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "training_iteration": 119, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-14", "timestamp": 1723232474, "time_this_iter_s": 7.230525970458984, "time_total_s": 891.3680675029755, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30495e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 891.3680675029755, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 23.136363636363633, "ram_util_percent": 80.5909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 279.7179520845413, "cur_kl_coeff": 1683.4112196028227, "cur_lr": 5.0000000000000016e-05, "total_loss": 81.88992688655853, "policy_loss": 0.022465853464382235, "vf_loss": 9.986365755399069, "vf_explained_var": 0.00012403285751740137, "kl": 0.0426996642704277, "entropy": 1.4730961738775175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8650569602216363, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996207531419381, "policy_loss": -0.0006800537761399355, "vf_loss": 9.99242954708281, "vf_explained_var": -0.00013041020070434246, "kl": 0.005870659713800898, "entropy": 1.1120286508842752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": -16.480988732664507, "episode_reward_min": -11206.783481467535, "episode_reward_mean": -5725.442874144384, "episode_len_mean": 186.72, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18672, "policy_reward_min": {"agent_policy": 0.8226254182932836, "adversary_policy": -11161.788016182087}, "policy_reward_max": {"agent_policy": 9598.736723353872, "adversary_policy": -0.8226254182932836}, "policy_reward_mean": {"agent_policy": 3409.264450542554, "adversary_policy": -4567.35366234347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10546.712773606909, -5603.974033036452, -8325.952602172278, -7236.448553777026, -5009.106366219914, -5427.957510154714, -7528.741827388643, -8063.655626889976, -4905.035345521535, -3695.953145865333, -4634.530017119025, -6014.51584760663, -4031.4049142615713, -10210.167919891406, -2511.775253269553, -3698.759820422795, -4413.134777578656, -6136.859496118616, -6311.755893008633, -4240.890062408007, -6716.67124222822, -6394.743140414459, -5513.530780720012, -4516.088073963322, -5304.8330611340625, -3891.139406198374, -6543.567515101463, -3647.0765799312016, -7270.704984011185, -9478.677134643007, -4752.5959823768935, -4942.090083958358, -5534.171037911983, -10788.713923856429, -5617.820741052264, -5617.48896946471, -7209.484102039114, -7640.982106409847, -3963.681925217154, -4084.02008824704, -5497.01452271885, -5550.4308356907895, -5048.732561921754, -144.5212517359189, -584.1639857130585, -4680.557883701312, -5057.63121281803, -4675.557489937113, -4600.4005922200795, -2900.3492268506334, -4836.890784534151, -6156.287998280728, -8602.432385917073, -8071.905283818848, -4509.863386290642, -4414.835568534445, -4513.890767582035, -7748.083003854969, -277.0052524525557, -5483.2743345108975, -4322.8170398686825, -6367.13566480929, -6063.014289584656, -4031.964681268617, -10178.106754499084, -6872.413062190899, -10510.270224255966, -7039.4471695077755, -10109.54829303344, -6331.2392815561525, -9186.381948037466, -7947.018302325021, -11206.783481467535, -6302.7178892203365, -2953.615507660054, -3893.1295227864916, -7831.815524089928, -7103.766008673106, -4312.526039847353, -4009.708270834784, -4420.9028927440795, -5537.289911094958, -4982.695650947703, -9462.313617489615, -3874.527933160195, -3720.5029488518917, -3232.1013039058935, -3785.121840048877, -10841.40172731357, -4454.352408442105, -3683.6947429684105, -676.2244891372203, -8802.18582602905, -6625.054120616892, -8687.232095682299, -4747.109424545265, -4563.977907510525, -8580.450383893472, -3948.0072515265038, -16.480988732664507], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 76, 200, 200, 150, 200, 85, 200, 200, 200, 200, 200, 200, 116, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 1], "policy_agent_policy_reward": [4561.196977619111, 2740.809449940755, 5372.774832561143, 1971.5784865434282, 3444.485298524447, 1897.284177869768, 4985.857898644527, 2211.492057630142, 2190.8221290610627, 2542.118990406211, 2832.183923536573, 4940.186824168807, 3178.598742480909, 7004.344271165681, 1697.2709808238355, 2867.4841042721687, 2390.528612623105, 5463.2749936580985, 3418.6196085215497, 3675.7441903671747, 2229.843823598005, 2506.0401831901413, 2979.31533756433, 2188.637489357072, 2697.5783851505994, 2450.5358519587885, 3897.3154605580685, 2514.9418397841614, 3967.390117415378, 8040.347634557399, 2418.7172296892795, 4254.5681846758025, 5234.783641130992, 5710.974821979251, 3454.1660058105413, 3766.4797643209417, 4124.792507505586, 3717.869093161495, 3092.829092093157, 2859.007746016471, 3197.265316165945, 2743.9703880772954, 2449.5710839649964, 56.1162092341455, 50.74228970338099, 3900.758396144029, 3130.4856922881986, 3254.3433334552765, 3446.0324565012706, 2403.7959343944885, 3771.061335823729, 4733.133795595713, 3508.23682364297, 2086.1714663651883, 3669.144746827494, 3612.253017036556, 2857.9590131858013, 2262.086844495283, 52.818490937535465, 2693.3895310479693, 2622.746197509408, 3971.60252237438, 3577.1952615836904, 3280.145537885476, 2179.516742756002, 6066.4558521152785, 8881.614819819588, 5004.737633413115, 8450.491413385666, 3601.137825585758, 6280.29080332835, 2983.8424365571154, 9454.746317413665, 5270.043223674878, 625.8541023725414, 2662.8805875544413, 6932.567116688107, 1495.5514592046304, 3845.5600620343266, 794.8303321583886, 3365.526012197706, 3986.6120750266064, 2424.708837776925, 2314.7276145724786, 1566.3482911173562, 1467.669778673415, 918.7155458020542, 2585.7834107168974, 9598.736723353872, 1790.0573701357218, 2457.7707480112754, 495.70901703974874, 5874.892824001421, 2946.818330065557, 3972.6812789018027, 2838.6118080734536, 2492.771606317831, 4322.280565866116, 2151.2634189489286, 0.8226254182932836], "policy_adversary_policy_reward": [-10546.71277360691, -4561.196977619111, -5603.974033036452, -2740.809449940755, -5372.774832561143, -8325.952602172278, -7188.231366989839, -2019.7956733306141, -5009.106366219914, -3444.485298524447, -3469.660517356408, -3855.5811706680715, -4985.857898644527, -7528.7418273886415, -8055.211442997207, -2219.9362415229084, -2265.481547608015, -4830.375926974585, -3693.0090650854477, -2545.063071186096, -3761.8345836783033, -3704.8793569772984, -5917.233812773626, -5037.468859001808, -3516.198072760216, -3693.8055839822655, -7004.344271165681, -10210.167919891406, -2000.1866652764033, -2208.859568816989, -3638.1510459439614, -2928.092878751002, -4273.041140842664, -2530.6222493590953, -5990.697747114532, -5609.436742662183, -6311.755893008635, -3418.6196085215497, -3863.5183269421723, -4053.115925833012, -2860.1503771985354, -6086.3646886276965, -2506.6048927727916, -6394.178430831809, -2979.31533756433, -5513.530780720012, -4146.3152989534055, -2558.410264366988, -3402.265063675928, -4600.146382608738, -2639.9628818243764, -3701.7123763327877, -4890.742722711967, -5550.140252947567, -2607.502932025218, -3554.5154876901447, -4489.688231586241, -6748.40686984032, -9478.677134643007, -8040.347634557399, -4752.5959823768935, -2418.7172296892795, -4553.588119592159, -4643.070149042003, -5445.525720818088, -5323.428958224889, -5710.974821979251, -10788.713923856429, -5560.104022563945, -3511.8827242988605, -5532.691227939539, -3851.2775058461107, -4124.792507505586, -7209.484102039113, -7316.634811240673, -4042.216388330669, -3398.7171767556256, -3657.7938405546856, -3094.436332425094, -3848.5915018384158, -5173.320105365182, -3520.9597335196236, -2743.9703880772954, -5550.4308356907895, -2449.5710839649964, -5048.732561921754, -56.1162092341455, -144.5212517359189, -584.1639857130584, -50.74228970338099, -3942.4526350031215, -4638.86364484222, -3139.6518047099016, -5048.465100396326, -4675.557489937112, -3254.3433334552765, -4551.00217197178, -3495.4308767495695, -2464.7820761736666, -2839.3630850714558, -4801.793708882924, -3806.1584114749544, -5526.730983458888, -5362.690810417546, -8602.432385917073, -3508.23682364297, -2902.0339796241815, -7256.042770559854, -4509.863386290641, -3669.144746827494, -4346.172040084851, -3680.91654548615, -4227.2958418574435, -3144.5539389103906, -7748.083003854969, -2262.086844495283, -52.818490937535465, -277.0052524525557, -2693.3895310479693, -5483.2743345108975, -3363.4427508610615, -3582.1204865170303, -3971.60252237438, -6367.13566480929, -5848.345054988641, -3791.8644961796954, -3809.0711606369614, -3503.039058517131, -2179.516742756002, -10178.106754499084, -6758.627635069135, -6180.241279237044, -10510.270224255966, -8881.614819819588, -5726.473341955343, -6317.71146096555, -10109.54829303344, -8450.491413385666, -5266.506725779857, -4665.870381362051, -9186.381948037464, -6280.29080332835, -7943.134713394259, -2987.7260254878775, -11161.788016182087, -9499.74178269911, -5273.65119270264, -6299.109920192576, -2953.6155076600535, -625.8541023725414, -3341.4520922108027, -3214.5580181301316, -7465.423862489173, -7298.958778288862, -7103.766008673106, -1495.5514592046304, -4105.274042998051, -4052.812058883626, -4009.7082708347834, -794.8303321583886, -3410.262378110241, -4376.166526831544, -4173.59809323499, -5350.3038928865735, -4982.695650947703, -2424.708837776925, -9462.313617489615, -2314.7276145724786, -3129.013327073995, -2311.862897203556, -1467.8404943460396, -3720.332233179267, -918.7155458020542, -3232.1013039058935, -3042.3242287035414, -3328.5810220622343, -9598.736723353872, -10841.40172731357, -2093.445671105941, -4150.964107471879, -2745.7268773696865, -3395.7386136099985, -495.79838206195484, -676.1351241150144, -5881.036337970584, -8796.042312059888, -4893.045596590573, -4678.826854091874, -3972.6812789018027, -8687.232095682299, -4692.985966668873, -2892.735265949844, -4508.056291955703, -2548.693221872652, -8580.450383893472, -4322.280565866116, -3790.4486329631904, -2308.8220375122432, -0.8226254182932836, -16.480988732664507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39779416011420016, "mean_inference_ms": 0.9669951042639938, "mean_action_processing_ms": 0.1670027929545827, "mean_env_wait_ms": 0.05092973210367558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033398866653442383, "StateBufferConnector_ms": 0.0023709535598754883, "ViewRequirementAgentConnector_ms": 0.06574773788452148}, "num_episodes": 22, "episode_return_max": -16.480988732664507, "episode_return_min": -11206.783481467535, "episode_return_mean": -5725.442874144384}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.9711860830735, "num_env_steps_trained_throughput_per_sec": 557.9711860830735, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 7157.158, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7157.126, "sample_time_ms": 737.729, "learn_time_ms": 6406.568, "learn_throughput": 624.359, "synch_weights_time_ms": 12.325}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 120, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-22", "timestamp": 1723232482, "time_this_iter_s": 7.173424959182739, "time_total_s": 898.5414924621582, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 898.5414924621582, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 23.49, "ram_util_percent": 80.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 337.321221836408, "cur_kl_coeff": 2525.1168294042354, "cur_lr": 5.0000000000000016e-05, "total_loss": 82.5984201669693, "policy_loss": 0.01512732792616589, "vf_loss": 9.98510450621446, "vf_explained_var": 0.00015686694532632828, "kl": 0.028750426220843412, "entropy": 1.4796934127807617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.929174485786882, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997745487172768, "policy_loss": 0.0015376406936122783, "vf_loss": 9.990484688773988, "vf_explained_var": -0.0004342085154598983, "kl": 0.007536660072211393, "entropy": 1.1462423854404025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "env_runners": {"episode_reward_max": -16.480988732664507, "episode_reward_min": -11206.783481467535, "episode_reward_mean": -5574.268242533481, "episode_len_mean": 184.94, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18494, "policy_reward_min": {"agent_policy": 0.8226254182932836, "adversary_policy": -11161.788016182087}, "policy_reward_max": {"agent_policy": 9598.736723353872, "adversary_policy": -0.8226254182932836}, "policy_reward_mean": {"agent_policy": 3436.971865981876, "adversary_policy": -4505.620054257679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6394.743140414459, -5513.530780720012, -4516.088073963322, -5304.8330611340625, -3891.139406198374, -6543.567515101463, -3647.0765799312016, -7270.704984011185, -9478.677134643007, -4752.5959823768935, -4942.090083958358, -5534.171037911983, -10788.713923856429, -5617.820741052264, -5617.48896946471, -7209.484102039114, -7640.982106409847, -3963.681925217154, -4084.02008824704, -5497.01452271885, -5550.4308356907895, -5048.732561921754, -144.5212517359189, -584.1639857130585, -4680.557883701312, -5057.63121281803, -4675.557489937113, -4600.4005922200795, -2900.3492268506334, -4836.890784534151, -6156.287998280728, -8602.432385917073, -8071.905283818848, -4509.863386290642, -4414.835568534445, -4513.890767582035, -7748.083003854969, -277.0052524525557, -5483.2743345108975, -4322.8170398686825, -6367.13566480929, -6063.014289584656, -4031.964681268617, -10178.106754499084, -6872.413062190899, -10510.270224255966, -7039.4471695077755, -10109.54829303344, -6331.2392815561525, -9186.381948037466, -7947.018302325021, -11206.783481467535, -6302.7178892203365, -2953.615507660054, -3893.1295227864916, -7831.815524089928, -7103.766008673106, -4312.526039847353, -4009.708270834784, -4420.9028927440795, -5537.289911094958, -4982.695650947703, -9462.313617489615, -3874.527933160195, -3720.5029488518917, -3232.1013039058935, -3785.121840048877, -10841.40172731357, -4454.352408442105, -3683.6947429684105, -676.2244891372203, -8802.18582602905, -6625.054120616892, -8687.232095682299, -4747.109424545265, -4563.977907510525, -8580.450383893472, -3948.0072515265038, -16.480988732664507, -4262.775386004743, -3352.666645050951, -8037.053205982153, -3044.2085493935206, -5131.166998675215, -6764.813995451948, -4536.328032241787, -2697.199630772814, -7103.913569183393, -3857.9855296725223, -10024.640942529597, -3918.154097454398, -7456.620986583002, -6398.698146538828, -2781.306692040638, -854.6684107062023, -8739.475699999432, -2788.993245499916, -5586.58265237993, -6117.584466639419, -6691.702984655009], "episode_lengths": [200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 76, 200, 200, 150, 200, 85, 200, 200, 200, 200, 200, 200, 116, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 154, 200, 200], "policy_agent_policy_reward": [2506.0401831901413, 2979.31533756433, 2188.637489357072, 2697.5783851505994, 2450.5358519587885, 3897.3154605580685, 2514.9418397841614, 3967.390117415378, 8040.347634557399, 2418.7172296892795, 4254.5681846758025, 5234.783641130992, 5710.974821979251, 3454.1660058105413, 3766.4797643209417, 4124.792507505586, 3717.869093161495, 3092.829092093157, 2859.007746016471, 3197.265316165945, 2743.9703880772954, 2449.5710839649964, 56.1162092341455, 50.74228970338099, 3900.758396144029, 3130.4856922881986, 3254.3433334552765, 3446.0324565012706, 2403.7959343944885, 3771.061335823729, 4733.133795595713, 3508.23682364297, 2086.1714663651883, 3669.144746827494, 3612.253017036556, 2857.9590131858013, 2262.086844495283, 52.818490937535465, 2693.3895310479693, 2622.746197509408, 3971.60252237438, 3577.1952615836904, 3280.145537885476, 2179.516742756002, 6066.4558521152785, 8881.614819819588, 5004.737633413115, 8450.491413385666, 3601.137825585758, 6280.29080332835, 2983.8424365571154, 9454.746317413665, 5270.043223674878, 625.8541023725414, 2662.8805875544413, 6932.567116688107, 1495.5514592046304, 3845.5600620343266, 794.8303321583886, 3365.526012197706, 3986.6120750266064, 2424.708837776925, 2314.7276145724786, 1566.3482911173562, 1467.669778673415, 918.7155458020542, 2585.7834107168974, 9598.736723353872, 1790.0573701357218, 2457.7707480112754, 495.70901703974874, 5874.892824001421, 2946.818330065557, 3972.6812789018027, 2838.6118080734536, 2492.771606317831, 4322.280565866116, 2151.2634189489286, 0.8226254182932836, 3130.2946615345127, 2723.118017940815, 6903.211970260627, 2634.240682658049, 4799.380191729342, 2865.9366320089366, 3331.3209981048954, 2305.942729324425, 6132.988091056208, 3257.6046062530204, 7104.342860960769, 2668.977416489871, 2137.5968397803917, 5574.484743637265, 1645.7155711265939, 405.474632648911, 3543.21842665538, 1863.5612794713509, 2434.245498641696, 3285.8135098367607, 5639.772557828802], "policy_adversary_policy_reward": [-2506.6048927727916, -6394.178430831809, -2979.31533756433, -5513.530780720012, -4146.3152989534055, -2558.410264366988, -3402.265063675928, -4600.146382608738, -2639.9628818243764, -3701.7123763327877, -4890.742722711967, -5550.140252947567, -2607.502932025218, -3554.5154876901447, -4489.688231586241, -6748.40686984032, -9478.677134643007, -8040.347634557399, -4752.5959823768935, -2418.7172296892795, -4553.588119592159, -4643.070149042003, -5445.525720818088, -5323.428958224889, -5710.974821979251, -10788.713923856429, -5560.104022563945, -3511.8827242988605, -5532.691227939539, -3851.2775058461107, -4124.792507505586, -7209.484102039113, -7316.634811240673, -4042.216388330669, -3398.7171767556256, -3657.7938405546856, -3094.436332425094, -3848.5915018384158, -5173.320105365182, -3520.9597335196236, -2743.9703880772954, -5550.4308356907895, -2449.5710839649964, -5048.732561921754, -56.1162092341455, -144.5212517359189, -584.1639857130584, -50.74228970338099, -3942.4526350031215, -4638.86364484222, -3139.6518047099016, -5048.465100396326, -4675.557489937112, -3254.3433334552765, -4551.00217197178, -3495.4308767495695, -2464.7820761736666, -2839.3630850714558, -4801.793708882924, -3806.1584114749544, -5526.730983458888, -5362.690810417546, -8602.432385917073, -3508.23682364297, -2902.0339796241815, -7256.042770559854, -4509.863386290641, -3669.144746827494, -4346.172040084851, -3680.91654548615, -4227.2958418574435, -3144.5539389103906, -7748.083003854969, -2262.086844495283, -52.818490937535465, -277.0052524525557, -2693.3895310479693, -5483.2743345108975, -3363.4427508610615, -3582.1204865170303, -3971.60252237438, -6367.13566480929, -5848.345054988641, -3791.8644961796954, -3809.0711606369614, -3503.039058517131, -2179.516742756002, -10178.106754499084, -6758.627635069135, -6180.241279237044, -10510.270224255966, -8881.614819819588, -5726.473341955343, -6317.71146096555, -10109.54829303344, -8450.491413385666, -5266.506725779857, -4665.870381362051, -9186.381948037464, -6280.29080332835, -7943.134713394259, -2987.7260254878775, -11161.788016182087, -9499.74178269911, -5273.65119270264, -6299.109920192576, -2953.6155076600535, -625.8541023725414, -3341.4520922108027, -3214.5580181301316, -7465.423862489173, -7298.958778288862, -7103.766008673106, -1495.5514592046304, -4105.274042998051, -4052.812058883626, -4009.7082708347834, -794.8303321583886, -3410.262378110241, -4376.166526831544, -4173.59809323499, -5350.3038928865735, -4982.695650947703, -2424.708837776925, -9462.313617489615, -2314.7276145724786, -3129.013327073995, -2311.862897203556, -1467.8404943460396, -3720.332233179267, -918.7155458020542, -3232.1013039058935, -3042.3242287035414, -3328.5810220622343, -9598.736723353872, -10841.40172731357, -2093.445671105941, -4150.964107471879, -2745.7268773696865, -3395.7386136099985, -495.79838206195484, -676.1351241150144, -5881.036337970584, -8796.042312059888, -4893.045596590573, -4678.826854091874, -3972.6812789018027, -8687.232095682299, -4692.985966668873, -2892.735265949844, -4508.056291955703, -2548.693221872652, -8580.450383893472, -4322.280565866116, -3790.4486329631904, -2308.8220375122432, -0.8226254182932836, -16.480988732664507, -3793.7734327852704, -3599.296614753987, -2879.037361809984, -3196.747301181783, -6920.561899673549, -8019.703276569229, -2785.0631540508743, -2893.3860780006958, -5081.471271638351, -4849.075918766207, -6684.552298799178, -2946.198328661706, -3368.7174553775676, -4498.931574969113, -2484.4889692428665, -2518.653390854373, -6132.988091056208, -7103.913569183393, -3269.168120466152, -3846.4220154593913, -10024.640942529597, -7104.342860960769, -3036.5394176756845, -3550.5920962685846, -7456.620986583001, -2137.5968397803917, -5633.988939808622, -6339.193950367473, -2767.312894663092, -1659.7093685041393, -746.917313968064, -513.2257293870488, -3631.607531566336, -8651.086595088476, -2158.1240490097084, -2494.430475961557, -2434.245498641696, -5586.58265237993, -3285.8135098367607, -6117.5844666394205, -5932.8504045166255, -6398.625137967186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3975598927024305, "mean_inference_ms": 0.9662494780081481, "mean_action_processing_ms": 0.16697131175000302, "mean_env_wait_ms": 0.05090349975528209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003414750099182129, "StateBufferConnector_ms": 0.0023756027221679688, "ViewRequirementAgentConnector_ms": 0.06542134284973145}, "num_episodes": 21, "episode_return_max": -16.480988732664507, "episode_return_min": -11206.783481467535, "episode_return_mean": -5574.268242533481}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 564.0824478408649, "num_env_steps_trained_throughput_per_sec": 564.0824478408649, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 7151.85, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7151.817, "sample_time_ms": 737.609, "learn_time_ms": 6401.711, "learn_throughput": 624.833, "synch_weights_time_ms": 11.994}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "training_iteration": 121, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-29", "timestamp": 1723232489, "time_this_iter_s": 7.095259189605713, "time_total_s": 905.6367516517639, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3049940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 905.6367516517639, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 23.729999999999997, "ram_util_percent": 80.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 448.5135644117991, "cur_kl_coeff": 3787.6752441063513, "cur_lr": 5.0000000000000016e-05, "total_loss": 87.05734585920969, "policy_loss": 0.007158875821429925, "vf_loss": 9.98609504699707, "vf_explained_var": -4.182259241739909e-07, "kl": 0.020346013301362594, "entropy": 1.4795130812873443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9399741491785756, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004878688993909, "policy_loss": 0.0035814828486994857, "vf_loss": 9.990127321273562, "vf_explained_var": -0.0001930446536452682, "kl": 0.014709326933832869, "entropy": 1.1686391510660685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": -16.480988732664507, "episode_reward_min": -11206.783481467535, "episode_reward_mean": -5614.831274014439, "episode_len_mean": 181.62, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18162, "policy_reward_min": {"agent_policy": 0.8226254182932836, "adversary_policy": -11161.788016182087}, "policy_reward_max": {"agent_policy": 9598.736723353872, "adversary_policy": -0.8226254182932836}, "policy_reward_mean": {"agent_policy": 3415.03543247498, "adversary_policy": -4514.93335324471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-584.1639857130585, -4680.557883701312, -5057.63121281803, -4675.557489937113, -4600.4005922200795, -2900.3492268506334, -4836.890784534151, -6156.287998280728, -8602.432385917073, -8071.905283818848, -4509.863386290642, -4414.835568534445, -4513.890767582035, -7748.083003854969, -277.0052524525557, -5483.2743345108975, -4322.8170398686825, -6367.13566480929, -6063.014289584656, -4031.964681268617, -10178.106754499084, -6872.413062190899, -10510.270224255966, -7039.4471695077755, -10109.54829303344, -6331.2392815561525, -9186.381948037466, -7947.018302325021, -11206.783481467535, -6302.7178892203365, -2953.615507660054, -3893.1295227864916, -7831.815524089928, -7103.766008673106, -4312.526039847353, -4009.708270834784, -4420.9028927440795, -5537.289911094958, -4982.695650947703, -9462.313617489615, -3874.527933160195, -3720.5029488518917, -3232.1013039058935, -3785.121840048877, -10841.40172731357, -4454.352408442105, -3683.6947429684105, -676.2244891372203, -8802.18582602905, -6625.054120616892, -8687.232095682299, -4747.109424545265, -4563.977907510525, -8580.450383893472, -3948.0072515265038, -16.480988732664507, -4262.775386004743, -3352.666645050951, -8037.053205982153, -3044.2085493935206, -5131.166998675215, -6764.813995451948, -4536.328032241787, -2697.199630772814, -7103.913569183393, -3857.9855296725223, -10024.640942529597, -3918.154097454398, -7456.620986583002, -6398.698146538828, -2781.306692040638, -854.6684107062023, -8739.475699999432, -2788.993245499916, -5586.58265237993, -6117.584466639419, -6691.702984655009, -5139.563625204406, -4302.042871840142, -3944.0411130452717, -7983.596703395986, -8525.95478797811, -4792.953101179112, -7449.791357221532, -8621.463545855098, -3205.0950989752923, -222.83955652400036, -8959.843908999435, -9391.823181728401, -8547.938605441743, -3873.2200003043868, -7938.565611197954, -4605.778551336352, -8213.360354829418, -4353.017701946184, -8620.138650722341, -2510.136938812416, -29.76742518147024, -4809.323079591372, -6968.156185503744], "episode_lengths": [12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 76, 200, 200, 150, 200, 85, 200, 200, 200, 200, 200, 200, 116, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 174, 200, 130, 3, 110, 200], "policy_agent_policy_reward": [50.74228970338099, 3900.758396144029, 3130.4856922881986, 3254.3433334552765, 3446.0324565012706, 2403.7959343944885, 3771.061335823729, 4733.133795595713, 3508.23682364297, 2086.1714663651883, 3669.144746827494, 3612.253017036556, 2857.9590131858013, 2262.086844495283, 52.818490937535465, 2693.3895310479693, 2622.746197509408, 3971.60252237438, 3577.1952615836904, 3280.145537885476, 2179.516742756002, 6066.4558521152785, 8881.614819819588, 5004.737633413115, 8450.491413385666, 3601.137825585758, 6280.29080332835, 2983.8424365571154, 9454.746317413665, 5270.043223674878, 625.8541023725414, 2662.8805875544413, 6932.567116688107, 1495.5514592046304, 3845.5600620343266, 794.8303321583886, 3365.526012197706, 3986.6120750266064, 2424.708837776925, 2314.7276145724786, 1566.3482911173562, 1467.669778673415, 918.7155458020542, 2585.7834107168974, 9598.736723353872, 1790.0573701357218, 2457.7707480112754, 495.70901703974874, 5874.892824001421, 2946.818330065557, 3972.6812789018027, 2838.6118080734536, 2492.771606317831, 4322.280565866116, 2151.2634189489286, 0.8226254182932836, 3130.2946615345127, 2723.118017940815, 6903.211970260627, 2634.240682658049, 4799.380191729342, 2865.9366320089366, 3331.3209981048954, 2305.942729324425, 6132.988091056208, 3257.6046062530204, 7104.342860960769, 2668.977416489871, 2137.5968397803917, 5574.484743637265, 1645.7155711265939, 405.474632648911, 3543.21842665538, 1863.5612794713509, 2434.245498641696, 3285.8135098367607, 5639.772557828802, 3417.1651982234016, 3889.2949838283116, 2330.88287551705, 3591.373809513234, 2324.6548111928228, 3612.610158914313, 4241.526319767372, 6569.465689779479, 1697.823376621518, 27.128849005741937, 8463.135240220721, 1606.495162765354, 4202.873696397959, 2130.921526131662, 2093.441395072357, 4123.680530945192, 6417.217849226735, 2106.7453558378916, 5657.364830598113, 1537.8207057259758, 4.6999914060105965, 562.0662025882272, 5521.181473392733], "policy_adversary_policy_reward": [-584.1639857130584, -50.74228970338099, -3942.4526350031215, -4638.86364484222, -3139.6518047099016, -5048.465100396326, -4675.557489937112, -3254.3433334552765, -4551.00217197178, -3495.4308767495695, -2464.7820761736666, -2839.3630850714558, -4801.793708882924, -3806.1584114749544, -5526.730983458888, -5362.690810417546, -8602.432385917073, -3508.23682364297, -2902.0339796241815, -7256.042770559854, -4509.863386290641, -3669.144746827494, -4346.172040084851, -3680.91654548615, -4227.2958418574435, -3144.5539389103906, -7748.083003854969, -2262.086844495283, -52.818490937535465, -277.0052524525557, -2693.3895310479693, -5483.2743345108975, -3363.4427508610615, -3582.1204865170303, -3971.60252237438, -6367.13566480929, -5848.345054988641, -3791.8644961796954, -3809.0711606369614, -3503.039058517131, -2179.516742756002, -10178.106754499084, -6758.627635069135, -6180.241279237044, -10510.270224255966, -8881.614819819588, -5726.473341955343, -6317.71146096555, -10109.54829303344, -8450.491413385666, -5266.506725779857, -4665.870381362051, -9186.381948037464, -6280.29080332835, -7943.134713394259, -2987.7260254878775, -11161.788016182087, -9499.74178269911, -5273.65119270264, -6299.109920192576, -2953.6155076600535, -625.8541023725414, -3341.4520922108027, -3214.5580181301316, -7465.423862489173, -7298.958778288862, -7103.766008673106, -1495.5514592046304, -4105.274042998051, -4052.812058883626, -4009.7082708347834, -794.8303321583886, -3410.262378110241, -4376.166526831544, -4173.59809323499, -5350.3038928865735, -4982.695650947703, -2424.708837776925, -9462.313617489615, -2314.7276145724786, -3129.013327073995, -2311.862897203556, -1467.8404943460396, -3720.332233179267, -918.7155458020542, -3232.1013039058935, -3042.3242287035414, -3328.5810220622343, -9598.736723353872, -10841.40172731357, -2093.445671105941, -4150.964107471879, -2745.7268773696865, -3395.7386136099985, -495.79838206195484, -676.1351241150144, -5881.036337970584, -8796.042312059888, -4893.045596590573, -4678.826854091874, -3972.6812789018027, -8687.232095682299, -4692.985966668873, -2892.735265949844, -4508.056291955703, -2548.693221872652, -8580.450383893472, -4322.280565866116, -3790.4486329631904, -2308.8220375122432, -0.8226254182932836, -16.480988732664507, -3793.7734327852704, -3599.296614753987, -2879.037361809984, -3196.747301181783, -6920.561899673549, -8019.703276569229, -2785.0631540508743, -2893.3860780006958, -5081.471271638351, -4849.075918766207, -6684.552298799178, -2946.198328661706, -3368.7174553775676, -4498.931574969113, -2484.4889692428665, -2518.653390854373, -6132.988091056208, -7103.913569183393, -3269.168120466152, -3846.4220154593913, -10024.640942529597, -7104.342860960769, -3036.5394176756845, -3550.5920962685846, -7456.620986583001, -2137.5968397803917, -5633.988939808622, -6339.193950367473, -2767.312894663092, -1659.7093685041393, -746.917313968064, -513.2257293870488, -3631.607531566336, -8651.086595088476, -2158.1240490097084, -2494.430475961557, -2434.245498641696, -5586.58265237993, -3285.8135098367607, -6117.5844666394205, -5932.8504045166255, -6398.625137967186, -5139.563625204405, -3417.1651982234016, -4120.067637436214, -4071.2702182322387, -2758.987282007454, -3515.936706554867, -3591.373809513234, -7983.596703395987, -2324.6548111928228, -8525.95478797811, -4751.294390609882, -3654.2688694835438, -4241.526319767372, -7449.791357221533, -8620.658457262392, -6570.270778372187, -1789.348125941034, -3113.570349655777, -27.128849005741937, -222.83955652400036, -8553.083118934046, -8869.896030286112, -9391.823181728398, -1606.495162765354, -4202.873696397959, -8547.938605441743, -3027.5017663047947, -2976.6397601312533, -7938.565611197954, -2093.441395072357, -4273.471504855121, -4455.987577426429, -7624.722510511866, -7005.8556935442875, -2747.3219859437763, -3712.4410718403, -8620.138650722343, -5657.364830598113, -2510.1369388124153, -1537.8207057259758, -29.767425181470237, -4.6999914060105965, -4809.323079591371, -562.0662025882272, -6968.156185503745, -5521.181473392733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39743140529072113, "mean_inference_ms": 0.9658329109647974, "mean_action_processing_ms": 0.16678566268072714, "mean_env_wait_ms": 0.0508500020848237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033670663833618164, "StateBufferConnector_ms": 0.0024945735931396484, "ViewRequirementAgentConnector_ms": 0.06619870662689209}, "num_episodes": 23, "episode_return_max": -16.480988732664507, "episode_return_min": -11206.783481467535, "episode_return_mean": -5614.831274014439}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.6500216387938, "num_env_steps_trained_throughput_per_sec": 558.6500216387938, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 7152.83, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7152.797, "sample_time_ms": 729.83, "learn_time_ms": 6410.407, "learn_throughput": 623.985, "synch_weights_time_ms": 12.006}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 122, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-36", "timestamp": 1723232496, "time_this_iter_s": 7.165244102478027, "time_total_s": 912.801995754242, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3049f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 912.801995754242, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 24.49090909090909, "ram_util_percent": 80.65454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 619.504174375534, "cur_kl_coeff": 5681.512866159527, "cur_lr": 5.0000000000000016e-05, "total_loss": 113.89836031595866, "policy_loss": 0.009275804349939184, "vf_loss": 9.974745775262514, "vf_explained_var": 3.6353679994742076e-05, "kl": 0.018289906941572554, "entropy": 1.4829765475044647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.957098214919605, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003203241156523, "policy_loss": 0.008918212500041125, "vf_loss": 9.982411922475018, "vf_explained_var": -0.001171780200231643, "kl": 0.015635385212153394, "entropy": 1.167326856668664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "env_runners": {"episode_reward_max": -16.480988732664507, "episode_reward_min": -11206.783481467535, "episode_reward_mean": -5726.298339786463, "episode_len_mean": 179.02, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17902, "policy_reward_min": {"agent_policy": 0.8226254182932836, "adversary_policy": -11161.788016182087}, "policy_reward_max": {"agent_policy": 9598.736723353872, "adversary_policy": -0.8226254182932836}, "policy_reward_mean": {"agent_policy": 3391.494127033051, "adversary_policy": -4558.896233409757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10109.54829303344, -6331.2392815561525, -9186.381948037466, -7947.018302325021, -11206.783481467535, -6302.7178892203365, -2953.615507660054, -3893.1295227864916, -7831.815524089928, -7103.766008673106, -4312.526039847353, -4009.708270834784, -4420.9028927440795, -5537.289911094958, -4982.695650947703, -9462.313617489615, -3874.527933160195, -3720.5029488518917, -3232.1013039058935, -3785.121840048877, -10841.40172731357, -4454.352408442105, -3683.6947429684105, -676.2244891372203, -8802.18582602905, -6625.054120616892, -8687.232095682299, -4747.109424545265, -4563.977907510525, -8580.450383893472, -3948.0072515265038, -16.480988732664507, -4262.775386004743, -3352.666645050951, -8037.053205982153, -3044.2085493935206, -5131.166998675215, -6764.813995451948, -4536.328032241787, -2697.199630772814, -7103.913569183393, -3857.9855296725223, -10024.640942529597, -3918.154097454398, -7456.620986583002, -6398.698146538828, -2781.306692040638, -854.6684107062023, -8739.475699999432, -2788.993245499916, -5586.58265237993, -6117.584466639419, -6691.702984655009, -5139.563625204406, -4302.042871840142, -3944.0411130452717, -7983.596703395986, -8525.95478797811, -4792.953101179112, -7449.791357221532, -8621.463545855098, -3205.0950989752923, -222.83955652400036, -8959.843908999435, -9391.823181728401, -8547.938605441743, -3873.2200003043868, -7938.565611197954, -4605.778551336352, -8213.360354829418, -4353.017701946184, -8620.138650722341, -2510.136938812416, -29.76742518147024, -4809.323079591372, -6968.156185503744, -5817.638992272629, -371.4778438166056, -9087.466438267962, -2173.6163721683974, -9630.071871822385, -8556.206776767478, -7111.896456460318, -6383.744645848877, -7798.665560751005, -487.59270631106466, -10138.875346119477, -3833.161627683547, -7666.992882233415, -8186.087117319033, -6195.996291073635, -2708.311171415718, -5929.7348092203365, -4944.594358570965, -5042.3686416622395, -3440.011559817765, -7899.398175338282, -5167.001783270695, -8268.61900647103, -6805.474185521055], "episode_lengths": [200, 200, 200, 200, 200, 200, 76, 200, 200, 150, 200, 85, 200, 200, 200, 200, 200, 200, 116, 200, 200, 200, 200, 60, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 174, 200, 130, 3, 110, 200, 187, 33, 200, 103, 200, 200, 200, 200, 200, 38, 200, 133, 200, 200, 200, 162, 171, 140, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8450.491413385666, 3601.137825585758, 6280.29080332835, 2983.8424365571154, 9454.746317413665, 5270.043223674878, 625.8541023725414, 2662.8805875544413, 6932.567116688107, 1495.5514592046304, 3845.5600620343266, 794.8303321583886, 3365.526012197706, 3986.6120750266064, 2424.708837776925, 2314.7276145724786, 1566.3482911173562, 1467.669778673415, 918.7155458020542, 2585.7834107168974, 9598.736723353872, 1790.0573701357218, 2457.7707480112754, 495.70901703974874, 5874.892824001421, 2946.818330065557, 3972.6812789018027, 2838.6118080734536, 2492.771606317831, 4322.280565866116, 2151.2634189489286, 0.8226254182932836, 3130.2946615345127, 2723.118017940815, 6903.211970260627, 2634.240682658049, 4799.380191729342, 2865.9366320089366, 3331.3209981048954, 2305.942729324425, 6132.988091056208, 3257.6046062530204, 7104.342860960769, 2668.977416489871, 2137.5968397803917, 5574.484743637265, 1645.7155711265939, 405.474632648911, 3543.21842665538, 1863.5612794713509, 2434.245498641696, 3285.8135098367607, 5639.772557828802, 3417.1651982234016, 3889.2949838283116, 2330.88287551705, 3591.373809513234, 2324.6548111928228, 3612.610158914313, 4241.526319767372, 6569.465689779479, 1697.823376621518, 27.128849005741937, 8463.135240220721, 1606.495162765354, 4202.873696397959, 2130.921526131662, 2093.441395072357, 4123.680530945192, 6417.217849226735, 2106.7453558378916, 5657.364830598113, 1537.8207057259758, 4.6999914060105965, 562.0662025882272, 5521.181473392733, 4155.463863614193, 218.6123506984636, 8030.519754486446, 607.8422682961749, 4247.997476593925, 7772.334957814916, 4003.5973226235383, 4542.3163741283815, 3943.9832960204158, 352.78868910412035, 3186.7256972412997, 991.7781990071859, 6133.478674850085, 6325.804215763139, 2392.8231954988605, 2105.6761661174714, 2973.451500029135, 1373.1274507682942, 3567.0693453566496, 2097.9157853494444, 1515.057327300123, 3349.223165597207, 3103.0421549820717, 1671.6679594674317], "policy_adversary_policy_reward": [-10109.54829303344, -8450.491413385666, -5266.506725779857, -4665.870381362051, -9186.381948037464, -6280.29080332835, -7943.134713394259, -2987.7260254878775, -11161.788016182087, -9499.74178269911, -5273.65119270264, -6299.109920192576, -2953.6155076600535, -625.8541023725414, -3341.4520922108027, -3214.5580181301316, -7465.423862489173, -7298.958778288862, -7103.766008673106, -1495.5514592046304, -4105.274042998051, -4052.812058883626, -4009.7082708347834, -794.8303321583886, -3410.262378110241, -4376.166526831544, -4173.59809323499, -5350.3038928865735, -4982.695650947703, -2424.708837776925, -9462.313617489615, -2314.7276145724786, -3129.013327073995, -2311.862897203556, -1467.8404943460396, -3720.332233179267, -918.7155458020542, -3232.1013039058935, -3042.3242287035414, -3328.5810220622343, -9598.736723353872, -10841.40172731357, -2093.445671105941, -4150.964107471879, -2745.7268773696865, -3395.7386136099985, -495.79838206195484, -676.1351241150144, -5881.036337970584, -8796.042312059888, -4893.045596590573, -4678.826854091874, -3972.6812789018027, -8687.232095682299, -4692.985966668873, -2892.735265949844, -4508.056291955703, -2548.693221872652, -8580.450383893472, -4322.280565866116, -3790.4486329631904, -2308.8220375122432, -0.8226254182932836, -16.480988732664507, -3793.7734327852704, -3599.296614753987, -2879.037361809984, -3196.747301181783, -6920.561899673549, -8019.703276569229, -2785.0631540508743, -2893.3860780006958, -5081.471271638351, -4849.075918766207, -6684.552298799178, -2946.198328661706, -3368.7174553775676, -4498.931574969113, -2484.4889692428665, -2518.653390854373, -6132.988091056208, -7103.913569183393, -3269.168120466152, -3846.4220154593913, -10024.640942529597, -7104.342860960769, -3036.5394176756845, -3550.5920962685846, -7456.620986583001, -2137.5968397803917, -5633.988939808622, -6339.193950367473, -2767.312894663092, -1659.7093685041393, -746.917313968064, -513.2257293870488, -3631.607531566336, -8651.086595088476, -2158.1240490097084, -2494.430475961557, -2434.245498641696, -5586.58265237993, -3285.8135098367607, -6117.5844666394205, -5932.8504045166255, -6398.625137967186, -5139.563625204405, -3417.1651982234016, -4120.067637436214, -4071.2702182322387, -2758.987282007454, -3515.936706554867, -3591.373809513234, -7983.596703395987, -2324.6548111928228, -8525.95478797811, -4751.294390609882, -3654.2688694835438, -4241.526319767372, -7449.791357221533, -8620.658457262392, -6570.270778372187, -1789.348125941034, -3113.570349655777, -27.128849005741937, -222.83955652400036, -8553.083118934046, -8869.896030286112, -9391.823181728398, -1606.495162765354, -4202.873696397959, -8547.938605441743, -3027.5017663047947, -2976.6397601312533, -7938.565611197954, -2093.441395072357, -4273.471504855121, -4455.987577426429, -7624.722510511866, -7005.8556935442875, -2747.3219859437763, -3712.4410718403, -8620.138650722343, -5657.364830598113, -2510.1369388124153, -1537.8207057259758, -29.767425181470237, -4.6999914060105965, -4809.323079591371, -562.0662025882272, -6968.156185503745, -5521.181473392733, -4176.560309932461, -5796.542545954361, -369.9479268215964, -220.14226769347286, -8031.5174513597085, -9086.4687413947, -607.8422682961749, -2173.6163721683974, -4261.280091315972, -9616.789257100338, -7772.479415924808, -8556.062318657589, -4003.5973226235383, -7111.896456460318, -6383.744645848876, -4542.3163741283815, -3943.9832960204158, -7798.665560751004, -484.85336795462365, -355.5280274605613, -10138.875346119477, -3186.7256972412997, -3833.161627683547, -991.7781990071859, -7660.532728212619, -6139.93882887088, -6354.718340069533, -8157.1729930126385, -4560.102863811513, -4028.716622760986, -2276.2584483872665, -2537.7288891459225, -3193.1504866952864, -5710.035822554183, -4930.823805566164, -1386.8980037730953, -3798.381857368358, -4811.05612965053, -2405.9911003894063, -3131.936244777801, -1515.057327300123, -7899.398175338282, -3599.58633326473, -4916.638615603175, -3338.899474772477, -8032.761686680624, -1671.6679594674317, -6805.474185521055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3972335826010698, "mean_inference_ms": 0.9662197169726889, "mean_action_processing_ms": 0.16672486364315295, "mean_env_wait_ms": 0.05081804527693439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033903121948242188, "StateBufferConnector_ms": 0.0024912357330322266, "ViewRequirementAgentConnector_ms": 0.06757092475891113}, "num_episodes": 24, "episode_return_max": -16.480988732664507, "episode_return_min": -11206.783481467535, "episode_return_mean": -5726.298339786463}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.9795526856291, "num_env_steps_trained_throughput_per_sec": 539.9795526856291, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 7172.873, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7172.84, "sample_time_ms": 726.321, "learn_time_ms": 6434.345, "learn_throughput": 621.664, "synch_weights_time_ms": 11.622}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "training_iteration": 123, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-44", "timestamp": 1723232504, "time_this_iter_s": 7.412059307098389, "time_total_s": 920.2140550613403, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3182310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 920.2140550613403, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 25.890909090909098, "ram_util_percent": 80.74545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 528.1003978729248, "cur_kl_coeff": 5681.512866159527, "cur_lr": 5.0000000000000016e-05, "total_loss": 88.0673276980718, "policy_loss": 0.007807814785580073, "vf_loss": 9.986739416917166, "vf_explained_var": 7.189040382703146e-05, "kl": 0.013741548157850048, "entropy": 1.4840759967764219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0267606613812623, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.015897250301624, "policy_loss": 0.010156964586564787, "vf_loss": 9.989948877203402, "vf_explained_var": -0.004443041735855991, "kl": 0.02079527208029672, "entropy": 1.196534665299471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": -16.480988732664507, "episode_reward_min": -10363.93637820105, "episode_reward_mean": -5567.641616703373, "episode_len_mean": 177.29, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17729, "policy_reward_min": {"agent_policy": 0.8226254182932836, "adversary_policy": -10363.93637820105}, "policy_reward_max": {"agent_policy": 8463.135240220721, "adversary_policy": -0.8226254182932836}, "policy_reward_mean": {"agent_policy": 3223.0071939197583, "adversary_policy": -4395.324405311566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3683.6947429684105, -676.2244891372203, -8802.18582602905, -6625.054120616892, -8687.232095682299, -4747.109424545265, -4563.977907510525, -8580.450383893472, -3948.0072515265038, -16.480988732664507, -4262.775386004743, -3352.666645050951, -8037.053205982153, -3044.2085493935206, -5131.166998675215, -6764.813995451948, -4536.328032241787, -2697.199630772814, -7103.913569183393, -3857.9855296725223, -10024.640942529597, -3918.154097454398, -7456.620986583002, -6398.698146538828, -2781.306692040638, -854.6684107062023, -8739.475699999432, -2788.993245499916, -5586.58265237993, -6117.584466639419, -6691.702984655009, -5139.563625204406, -4302.042871840142, -3944.0411130452717, -7983.596703395986, -8525.95478797811, -4792.953101179112, -7449.791357221532, -8621.463545855098, -3205.0950989752923, -222.83955652400036, -8959.843908999435, -9391.823181728401, -8547.938605441743, -3873.2200003043868, -7938.565611197954, -4605.778551336352, -8213.360354829418, -4353.017701946184, -8620.138650722341, -2510.136938812416, -29.76742518147024, -4809.323079591372, -6968.156185503744, -5817.638992272629, -371.4778438166056, -9087.466438267962, -2173.6163721683974, -9630.071871822385, -8556.206776767478, -7111.896456460318, -6383.744645848877, -7798.665560751005, -487.59270631106466, -10138.875346119477, -3833.161627683547, -7666.992882233415, -8186.087117319033, -6195.996291073635, -2708.311171415718, -5929.7348092203365, -4944.594358570965, -5042.3686416622395, -3440.011559817765, -7899.398175338282, -5167.001783270695, -8268.61900647103, -6805.474185521055, -8418.900434295516, -5992.831494755431, -4753.02872204075, -2198.1772943520746, -6163.839529603746, -6623.553676573578, -5531.555880622722, -6405.3279618026245, -3550.566820270287, -5467.969680943887, -747.3283262885659, -10363.93637820105, -8754.844730683304, -7528.029238385481, -139.50780978082796, -2425.5573768332715, -4675.937927101018, -6653.3923880932, -3774.3371138657476, -5288.412986611246, -7582.177217646145, -6594.575006471025], "episode_lengths": [200, 60, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 174, 200, 130, 3, 110, 200, 187, 33, 200, 103, 200, 200, 200, 200, 200, 38, 200, 133, 200, 200, 200, 162, 171, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 5, 97, 200, 200, 200, 200, 200, 169], "policy_agent_policy_reward": [2457.7707480112754, 495.70901703974874, 5874.892824001421, 2946.818330065557, 3972.6812789018027, 2838.6118080734536, 2492.771606317831, 4322.280565866116, 2151.2634189489286, 0.8226254182932836, 3130.2946615345127, 2723.118017940815, 6903.211970260627, 2634.240682658049, 4799.380191729342, 2865.9366320089366, 3331.3209981048954, 2305.942729324425, 6132.988091056208, 3257.6046062530204, 7104.342860960769, 2668.977416489871, 2137.5968397803917, 5574.484743637265, 1645.7155711265939, 405.474632648911, 3543.21842665538, 1863.5612794713509, 2434.245498641696, 3285.8135098367607, 5639.772557828802, 3417.1651982234016, 3889.2949838283116, 2330.88287551705, 3591.373809513234, 2324.6548111928228, 3612.610158914313, 4241.526319767372, 6569.465689779479, 1697.823376621518, 27.128849005741937, 8463.135240220721, 1606.495162765354, 4202.873696397959, 2130.921526131662, 2093.441395072357, 4123.680530945192, 6417.217849226735, 2106.7453558378916, 5657.364830598113, 1537.8207057259758, 4.6999914060105965, 562.0662025882272, 5521.181473392733, 4155.463863614193, 218.6123506984636, 8030.519754486446, 607.8422682961749, 4247.997476593925, 7772.334957814916, 4003.5973226235383, 4542.3163741283815, 3943.9832960204158, 352.78868910412035, 3186.7256972412997, 991.7781990071859, 6133.478674850085, 6325.804215763139, 2392.8231954988605, 2105.6761661174714, 2973.451500029135, 1373.1274507682942, 3567.0693453566496, 2097.9157853494444, 1515.057327300123, 3349.223165597207, 3103.0421549820717, 1671.6679594674317, 1834.3492621478729, 3197.4943869021477, 3855.7651685758715, 1688.7717862501413, 4693.595666372521, 4993.8441044242145, 2738.4169855928653, 5300.416130414473, 2892.7194520811954, 4059.0009564211036, 49.160341410799205, 8227.09736086573, 3867.7955657836715, 2294.616230103279, 9.648827541746483, 649.3186131290487, 2853.2498675434867, 3926.17503791323, 1652.7847008761844, 2262.4713944020864, 2420.017294058968, 2101.2788951910084], "policy_adversary_policy_reward": [-2745.7268773696865, -3395.7386136099985, -495.79838206195484, -676.1351241150144, -5881.036337970584, -8796.042312059888, -4893.045596590573, -4678.826854091874, -3972.6812789018027, -8687.232095682299, -4692.985966668873, -2892.735265949844, -4508.056291955703, -2548.693221872652, -8580.450383893472, -4322.280565866116, -3790.4486329631904, -2308.8220375122432, -0.8226254182932836, -16.480988732664507, -3793.7734327852704, -3599.296614753987, -2879.037361809984, -3196.747301181783, -6920.561899673549, -8019.703276569229, -2785.0631540508743, -2893.3860780006958, -5081.471271638351, -4849.075918766207, -6684.552298799178, -2946.198328661706, -3368.7174553775676, -4498.931574969113, -2484.4889692428665, -2518.653390854373, -6132.988091056208, -7103.913569183393, -3269.168120466152, -3846.4220154593913, -10024.640942529597, -7104.342860960769, -3036.5394176756845, -3550.5920962685846, -7456.620986583001, -2137.5968397803917, -5633.988939808622, -6339.193950367473, -2767.312894663092, -1659.7093685041393, -746.917313968064, -513.2257293870488, -3631.607531566336, -8651.086595088476, -2158.1240490097084, -2494.430475961557, -2434.245498641696, -5586.58265237993, -3285.8135098367607, -6117.5844666394205, -5932.8504045166255, -6398.625137967186, -5139.563625204405, -3417.1651982234016, -4120.067637436214, -4071.2702182322387, -2758.987282007454, -3515.936706554867, -3591.373809513234, -7983.596703395987, -2324.6548111928228, -8525.95478797811, -4751.294390609882, -3654.2688694835438, -4241.526319767372, -7449.791357221533, -8620.658457262392, -6570.270778372187, -1789.348125941034, -3113.570349655777, -27.128849005741937, -222.83955652400036, -8553.083118934046, -8869.896030286112, -9391.823181728398, -1606.495162765354, -4202.873696397959, -8547.938605441743, -3027.5017663047947, -2976.6397601312533, -7938.565611197954, -2093.441395072357, -4273.471504855121, -4455.987577426429, -7624.722510511866, -7005.8556935442875, -2747.3219859437763, -3712.4410718403, -8620.138650722343, -5657.364830598113, -2510.1369388124153, -1537.8207057259758, -29.767425181470237, -4.6999914060105965, -4809.323079591371, -562.0662025882272, -6968.156185503745, -5521.181473392733, -4176.560309932461, -5796.542545954361, -369.9479268215964, -220.14226769347286, -8031.5174513597085, -9086.4687413947, -607.8422682961749, -2173.6163721683974, -4261.280091315972, -9616.789257100338, -7772.479415924808, -8556.062318657589, -4003.5973226235383, -7111.896456460318, -6383.744645848876, -4542.3163741283815, -3943.9832960204158, -7798.665560751004, -484.85336795462365, -355.5280274605613, -10138.875346119477, -3186.7256972412997, -3833.161627683547, -991.7781990071859, -7660.532728212619, -6139.93882887088, -6354.718340069533, -8157.1729930126385, -4560.102863811513, -4028.716622760986, -2276.2584483872665, -2537.7288891459225, -3193.1504866952864, -5710.035822554183, -4930.823805566164, -1386.8980037730953, -3798.381857368358, -4811.05612965053, -2405.9911003894063, -3131.936244777801, -1515.057327300123, -7899.398175338282, -3599.58633326473, -4916.638615603175, -3338.899474772477, -8032.761686680624, -1671.6679594674317, -6805.474185521055, -8418.900434295518, -1834.3492621478729, -3619.360885867959, -5570.964995789615, -4347.587547296695, -4261.206343319922, -2165.644714401762, -1721.304366200453, -6012.804276638669, -4844.6309193376, -6210.493288248948, -5406.90449274884, -2738.4169855928653, -5531.555880622722, -6127.191226769202, -5578.552865447895, -3146.9639147749153, -3296.3223575765683, -4086.0005395796265, -5440.97009778537, -49.160341410799205, -747.3283262885659, -8227.09736086573, -10363.93637820105, -3867.7955657836715, -8754.844730683304, -2310.789463038369, -7511.8560054503905, -139.50780978082796, -9.648827541746483, -2425.5573768332724, -649.3186131290487, -3554.467250836071, -3974.7205438084266, -6653.392388093201, -3926.17503791323, -3688.1086404937787, -1739.0131742481533, -2262.4713944020864, -5288.412986611246, -7582.177217646144, -2420.017294058968, -2101.2788951910084, -6594.575006471025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39705041655300677, "mean_inference_ms": 0.964829138519324, "mean_action_processing_ms": 0.16661259032476405, "mean_env_wait_ms": 0.05078949829583666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033069849014282227, "StateBufferConnector_ms": 0.002528071403503418, "ViewRequirementAgentConnector_ms": 0.07176244258880615}, "num_episodes": 22, "episode_return_max": -16.480988732664507, "episode_return_min": -10363.93637820105, "episode_return_mean": -5567.641616703373}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.354513728847, "num_env_steps_trained_throughput_per_sec": 552.354513728847, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 7188.035, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7188.003, "sample_time_ms": 716.568, "learn_time_ms": 6459.088, "learn_throughput": 619.282, "synch_weights_time_ms": 11.759}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 124, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-51", "timestamp": 1723232511, "time_this_iter_s": 7.247140884399414, "time_total_s": 927.4611959457397, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30f3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 927.4611959457397, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 29.940000000000005, "ram_util_percent": 80.89000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 634.6839718421301, "cur_kl_coeff": 5681.512866159527, "cur_lr": 5.0000000000000016e-05, "total_loss": 94.80329113403955, "policy_loss": 0.003725493881696214, "vf_loss": 9.997568000356356, "vf_explained_var": 2.7442785600821178e-05, "kl": 0.014925954073745137, "entropy": 1.4805020314951738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9968236006283886, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00511107015862, "policy_loss": -0.0017999740879214, "vf_loss": 9.997085084864702, "vf_explained_var": -0.0029977780170541593, "kl": 0.008626362785361904, "entropy": 1.2317589713152124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": -12.946298266395024, "episode_reward_min": -12782.094232345564, "episode_reward_mean": -5942.076164965163, "episode_len_mean": 178.5, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 17850, "policy_reward_min": {"agent_policy": 0.9324633169124508, "adversary_policy": -12782.094232345564}, "policy_reward_max": {"agent_policy": 8463.135240220721, "adversary_policy": -0.9324633169124508}, "policy_reward_mean": {"agent_policy": 3235.611534063243, "adversary_policy": -4588.843849514203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10024.640942529597, -3918.154097454398, -7456.620986583002, -6398.698146538828, -2781.306692040638, -854.6684107062023, -8739.475699999432, -2788.993245499916, -5586.58265237993, -6117.584466639419, -6691.702984655009, -5139.563625204406, -4302.042871840142, -3944.0411130452717, -7983.596703395986, -8525.95478797811, -4792.953101179112, -7449.791357221532, -8621.463545855098, -3205.0950989752923, -222.83955652400036, -8959.843908999435, -9391.823181728401, -8547.938605441743, -3873.2200003043868, -7938.565611197954, -4605.778551336352, -8213.360354829418, -4353.017701946184, -8620.138650722341, -2510.136938812416, -29.76742518147024, -4809.323079591372, -6968.156185503744, -5817.638992272629, -371.4778438166056, -9087.466438267962, -2173.6163721683974, -9630.071871822385, -8556.206776767478, -7111.896456460318, -6383.744645848877, -7798.665560751005, -487.59270631106466, -10138.875346119477, -3833.161627683547, -7666.992882233415, -8186.087117319033, -6195.996291073635, -2708.311171415718, -5929.7348092203365, -4944.594358570965, -5042.3686416622395, -3440.011559817765, -7899.398175338282, -5167.001783270695, -8268.61900647103, -6805.474185521055, -8418.900434295516, -5992.831494755431, -4753.02872204075, -2198.1772943520746, -6163.839529603746, -6623.553676573578, -5531.555880622722, -6405.3279618026245, -3550.566820270287, -5467.969680943887, -747.3283262885659, -10363.93637820105, -8754.844730683304, -7528.029238385481, -139.50780978082796, -2425.5573768332715, -4675.937927101018, -6653.3923880932, -3774.3371138657476, -5288.412986611246, -7582.177217646145, -6594.575006471025, -5520.821694372451, -8992.292436912878, -9537.903033225075, -12782.094232345564, -11719.591670797152, -6615.812973507528, -8027.876809090467, -6931.7031762233855, -6148.352246968084, -4907.256656655225, -4038.554358268789, -7171.760743045999, -5133.903459283828, -2684.9826793386164, -9541.342383423083, -12.946298266395024, -7803.879595485961, -5252.542258046316, -10005.0617086435, -3733.3051853500147], "episode_lengths": [200, 200, 200, 200, 200, 68, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 174, 200, 130, 3, 110, 200, 187, 33, 200, 103, 200, 200, 200, 200, 200, 38, 200, 133, 200, 200, 200, 162, 171, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 5, 97, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 181, 200, 1, 200, 200, 200, 200], "policy_agent_policy_reward": [7104.342860960769, 2668.977416489871, 2137.5968397803917, 5574.484743637265, 1645.7155711265939, 405.474632648911, 3543.21842665538, 1863.5612794713509, 2434.245498641696, 3285.8135098367607, 5639.772557828802, 3417.1651982234016, 3889.2949838283116, 2330.88287551705, 3591.373809513234, 2324.6548111928228, 3612.610158914313, 4241.526319767372, 6569.465689779479, 1697.823376621518, 27.128849005741937, 8463.135240220721, 1606.495162765354, 4202.873696397959, 2130.921526131662, 2093.441395072357, 4123.680530945192, 6417.217849226735, 2106.7453558378916, 5657.364830598113, 1537.8207057259758, 4.6999914060105965, 562.0662025882272, 5521.181473392733, 4155.463863614193, 218.6123506984636, 8030.519754486446, 607.8422682961749, 4247.997476593925, 7772.334957814916, 4003.5973226235383, 4542.3163741283815, 3943.9832960204158, 352.78868910412035, 3186.7256972412997, 991.7781990071859, 6133.478674850085, 6325.804215763139, 2392.8231954988605, 2105.6761661174714, 2973.451500029135, 1373.1274507682942, 3567.0693453566496, 2097.9157853494444, 1515.057327300123, 3349.223165597207, 3103.0421549820717, 1671.6679594674317, 1834.3492621478729, 3197.4943869021477, 3855.7651685758715, 1688.7717862501413, 4693.595666372521, 4993.8441044242145, 2738.4169855928653, 5300.416130414473, 2892.7194520811954, 4059.0009564211036, 49.160341410799205, 8227.09736086573, 3867.7955657836715, 2294.616230103279, 9.648827541746483, 649.3186131290487, 2853.2498675434867, 3926.17503791323, 1652.7847008761844, 2262.4713944020864, 2420.017294058968, 2101.2788951910084, 3919.511651187589, 7524.416171609089, 4071.215473050771, 7852.039567841425, 4418.472504417296, 5488.625205085732, 3289.7859251857153, 1987.2177207022787, 2464.455888017547, 2775.8168008426596, 2372.8532794746693, 3787.9954372484426, 3478.6909911138778, 1167.9651416894576, 2433.5925969237323, 0.9324633169124508, 4151.515834223039, 1843.5001284748362, 2139.3105961610963, 1730.1814412975], "policy_adversary_policy_reward": [-10024.640942529597, -7104.342860960769, -3036.5394176756845, -3550.5920962685846, -7456.620986583001, -2137.5968397803917, -5633.988939808622, -6339.193950367473, -2767.312894663092, -1659.7093685041393, -746.917313968064, -513.2257293870488, -3631.607531566336, -8651.086595088476, -2158.1240490097084, -2494.430475961557, -2434.245498641696, -5586.58265237993, -3285.8135098367607, -6117.5844666394205, -5932.8504045166255, -6398.625137967186, -5139.563625204405, -3417.1651982234016, -4120.067637436214, -4071.2702182322387, -2758.987282007454, -3515.936706554867, -3591.373809513234, -7983.596703395987, -2324.6548111928228, -8525.95478797811, -4751.294390609882, -3654.2688694835438, -4241.526319767372, -7449.791357221533, -8620.658457262392, -6570.270778372187, -1789.348125941034, -3113.570349655777, -27.128849005741937, -222.83955652400036, -8553.083118934046, -8869.896030286112, -9391.823181728398, -1606.495162765354, -4202.873696397959, -8547.938605441743, -3027.5017663047947, -2976.6397601312533, -7938.565611197954, -2093.441395072357, -4273.471504855121, -4455.987577426429, -7624.722510511866, -7005.8556935442875, -2747.3219859437763, -3712.4410718403, -8620.138650722343, -5657.364830598113, -2510.1369388124153, -1537.8207057259758, -29.767425181470237, -4.6999914060105965, -4809.323079591371, -562.0662025882272, -6968.156185503745, -5521.181473392733, -4176.560309932461, -5796.542545954361, -369.9479268215964, -220.14226769347286, -8031.5174513597085, -9086.4687413947, -607.8422682961749, -2173.6163721683974, -4261.280091315972, -9616.789257100338, -7772.479415924808, -8556.062318657589, -4003.5973226235383, -7111.896456460318, -6383.744645848876, -4542.3163741283815, -3943.9832960204158, -7798.665560751004, -484.85336795462365, -355.5280274605613, -10138.875346119477, -3186.7256972412997, -3833.161627683547, -991.7781990071859, -7660.532728212619, -6139.93882887088, -6354.718340069533, -8157.1729930126385, -4560.102863811513, -4028.716622760986, -2276.2584483872665, -2537.7288891459225, -3193.1504866952864, -5710.035822554183, -4930.823805566164, -1386.8980037730953, -3798.381857368358, -4811.05612965053, -2405.9911003894063, -3131.936244777801, -1515.057327300123, -7899.398175338282, -3599.58633326473, -4916.638615603175, -3338.899474772477, -8032.761686680624, -1671.6679594674317, -6805.474185521055, -8418.900434295518, -1834.3492621478729, -3619.360885867959, -5570.964995789615, -4347.587547296695, -4261.206343319922, -2165.644714401762, -1721.304366200453, -6012.804276638669, -4844.6309193376, -6210.493288248948, -5406.90449274884, -2738.4169855928653, -5531.555880622722, -6127.191226769202, -5578.552865447895, -3146.9639147749153, -3296.3223575765683, -4086.0005395796265, -5440.97009778537, -49.160341410799205, -747.3283262885659, -8227.09736086573, -10363.93637820105, -3867.7955657836715, -8754.844730683304, -2310.789463038369, -7511.8560054503905, -139.50780978082796, -9.648827541746483, -2425.5573768332724, -649.3186131290487, -3554.467250836071, -3974.7205438084266, -6653.392388093201, -3926.17503791323, -3688.1086404937787, -1739.0131742481533, -2262.4713944020864, -5288.412986611246, -7582.177217646144, -2420.017294058968, -2101.2788951910084, -6594.575006471025, -3929.1358152381913, -5511.197530321848, -8992.292436912876, -7524.416171609089, -9537.903033225075, -4071.215473050771, -7852.039567841425, -12782.094232345564, -4418.472504417296, -11719.591670797152, -5710.459673162695, -6393.978505430563, -8027.876809090467, -3289.7859251857153, -2050.4453453082524, -6868.475551617412, -2464.455888017547, -6148.352246968084, -4492.831334381315, -3190.2421231165686, -2699.696315935434, -3711.7113218080267, -4446.95139946154, -6512.804780832903, -3478.6909911138778, -5133.903459283828, -2422.8135389131953, -1430.1342821148792, -9541.342383423082, -2433.5925969237323, -12.946298266395024, -0.9324633169124508, -7803.027017695618, -4152.368412013382, -4998.1186234275465, -2097.923763093608, -2139.3105961610963, -10005.0617086435, -1780.6534825629242, -3682.833144084592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39686046770092176, "mean_inference_ms": 0.9644616894996667, "mean_action_processing_ms": 0.16656119621934262, "mean_env_wait_ms": 0.05078530843545447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034219026565551758, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.0712510347366333}, "num_episodes": 20, "episode_return_max": -12.946298266395024, "episode_return_min": -12782.094232345564, "episode_return_mean": -5942.076164965163}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.5231483389275, "num_env_steps_trained_throughput_per_sec": 543.5231483389275, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 7223.608, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7223.576, "sample_time_ms": 726.174, "learn_time_ms": 6484.807, "learn_throughput": 616.826, "synch_weights_time_ms": 12.052}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 125, "trial_id": "3439d_00000", "date": "2024-08-09_15-41-59", "timestamp": 1723232519, "time_this_iter_s": 7.363723993301392, "time_total_s": 934.8249199390411, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3182670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 934.8249199390411, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 25.163636363636364, "ram_util_percent": 81.13636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 842.819765440623, "cur_kl_coeff": 5681.512866159527, "cur_lr": 5.0000000000000016e-05, "total_loss": 177.33871196905773, "policy_loss": 0.008369358419440687, "vf_loss": 9.990102593104044, "vf_explained_var": 6.620896359284719e-06, "kl": 0.02945346581885436, "entropy": 1.4811907554666202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0224230289932281, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.0030621503396, "policy_loss": 0.0011955913926213586, "vf_loss": 9.99343857992263, "vf_explained_var": -0.003134856211445319, "kl": 0.007399064267211884, "entropy": 1.240720800369505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": -12.946298266395024, "episode_reward_min": -12782.094232345564, "episode_reward_mean": -6082.2875976315645, "episode_len_mean": 177.9, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17790, "policy_reward_min": {"agent_policy": 0.9324633169124508, "adversary_policy": -12782.094232345564}, "policy_reward_max": {"agent_policy": 8810.400723605693, "adversary_policy": -0.9324633169124508}, "policy_reward_mean": {"agent_policy": 3397.328265772469, "adversary_policy": -4739.807931702016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8547.938605441743, -3873.2200003043868, -7938.565611197954, -4605.778551336352, -8213.360354829418, -4353.017701946184, -8620.138650722341, -2510.136938812416, -29.76742518147024, -4809.323079591372, -6968.156185503744, -5817.638992272629, -371.4778438166056, -9087.466438267962, -2173.6163721683974, -9630.071871822385, -8556.206776767478, -7111.896456460318, -6383.744645848877, -7798.665560751005, -487.59270631106466, -10138.875346119477, -3833.161627683547, -7666.992882233415, -8186.087117319033, -6195.996291073635, -2708.311171415718, -5929.7348092203365, -4944.594358570965, -5042.3686416622395, -3440.011559817765, -7899.398175338282, -5167.001783270695, -8268.61900647103, -6805.474185521055, -8418.900434295516, -5992.831494755431, -4753.02872204075, -2198.1772943520746, -6163.839529603746, -6623.553676573578, -5531.555880622722, -6405.3279618026245, -3550.566820270287, -5467.969680943887, -747.3283262885659, -10363.93637820105, -8754.844730683304, -7528.029238385481, -139.50780978082796, -2425.5573768332715, -4675.937927101018, -6653.3923880932, -3774.3371138657476, -5288.412986611246, -7582.177217646145, -6594.575006471025, -5520.821694372451, -8992.292436912878, -9537.903033225075, -12782.094232345564, -11719.591670797152, -6615.812973507528, -8027.876809090467, -6931.7031762233855, -6148.352246968084, -4907.256656655225, -4038.554358268789, -7171.760743045999, -5133.903459283828, -2684.9826793386164, -9541.342383423083, -12.946298266395024, -7803.879595485961, -5252.542258046316, -10005.0617086435, -3733.3051853500147, -6486.32674401558, -8487.83991505769, -9464.961713615576, -5218.076769042228, -1266.203974195593, -7993.743968175827, -7830.184028582193, -2815.3005052825883, -5989.243026069061, -772.1352925938295, -5807.84033059343, -3680.4529269902328, -9599.603855227413, -8585.255509094097, -8006.179480831975, -7187.68498975354, -7490.388178908465, -6271.1126317608105, -10388.126958492629, -6327.642763563185, -9999.85051854554, -4627.64446241677, -3622.7819008050324], "episode_lengths": [200, 200, 200, 200, 200, 174, 200, 130, 3, 110, 200, 187, 33, 200, 103, 200, 200, 200, 200, 200, 38, 200, 133, 200, 200, 200, 162, 171, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 5, 97, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 181, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 131, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161], "policy_agent_policy_reward": [4202.873696397959, 2130.921526131662, 2093.441395072357, 4123.680530945192, 6417.217849226735, 2106.7453558378916, 5657.364830598113, 1537.8207057259758, 4.6999914060105965, 562.0662025882272, 5521.181473392733, 4155.463863614193, 218.6123506984636, 8030.519754486446, 607.8422682961749, 4247.997476593925, 7772.334957814916, 4003.5973226235383, 4542.3163741283815, 3943.9832960204158, 352.78868910412035, 3186.7256972412997, 991.7781990071859, 6133.478674850085, 6325.804215763139, 2392.8231954988605, 2105.6761661174714, 2973.451500029135, 1373.1274507682942, 3567.0693453566496, 2097.9157853494444, 1515.057327300123, 3349.223165597207, 3103.0421549820717, 1671.6679594674317, 1834.3492621478729, 3197.4943869021477, 3855.7651685758715, 1688.7717862501413, 4693.595666372521, 4993.8441044242145, 2738.4169855928653, 5300.416130414473, 2892.7194520811954, 4059.0009564211036, 49.160341410799205, 8227.09736086573, 3867.7955657836715, 2294.616230103279, 9.648827541746483, 649.3186131290487, 2853.2498675434867, 3926.17503791323, 1652.7847008761844, 2262.4713944020864, 2420.017294058968, 2101.2788951910084, 3919.511651187589, 7524.416171609089, 4071.215473050771, 7852.039567841425, 4418.472504417296, 5488.625205085732, 3289.7859251857153, 1987.2177207022787, 2464.455888017547, 2775.8168008426596, 2372.8532794746693, 3787.9954372484426, 3478.6909911138778, 1167.9651416894576, 2433.5925969237323, 0.9324633169124508, 4151.515834223039, 1843.5001284748362, 2139.3105961610963, 1730.1814412975, 4268.5190426042955, 5172.962093539749, 7436.679090565948, 3075.3021717673714, 218.24771494167229, 2567.18383032053, 3361.2582530221875, 1205.471678381319, 2807.19903196421, 352.34222966914655, 3668.734406040361, 2846.6551073681694, 8767.042178995538, 3960.1632815495523, 7584.12181142935, 6274.448465081687, 2734.797854390201, 2134.211658437037, 8810.400723605693, 5694.222338191391, 6458.8974504645275, 2841.630948283414, 2005.9416227363413], "policy_adversary_policy_reward": [-4202.873696397959, -8547.938605441743, -3027.5017663047947, -2976.6397601312533, -7938.565611197954, -2093.441395072357, -4273.471504855121, -4455.987577426429, -7624.722510511866, -7005.8556935442875, -2747.3219859437763, -3712.4410718403, -8620.138650722343, -5657.364830598113, -2510.1369388124153, -1537.8207057259758, -29.767425181470237, -4.6999914060105965, -4809.323079591371, -562.0662025882272, -6968.156185503745, -5521.181473392733, -4176.560309932461, -5796.542545954361, -369.9479268215964, -220.14226769347286, -8031.5174513597085, -9086.4687413947, -607.8422682961749, -2173.6163721683974, -4261.280091315972, -9616.789257100338, -7772.479415924808, -8556.062318657589, -4003.5973226235383, -7111.896456460318, -6383.744645848876, -4542.3163741283815, -3943.9832960204158, -7798.665560751004, -484.85336795462365, -355.5280274605613, -10138.875346119477, -3186.7256972412997, -3833.161627683547, -991.7781990071859, -7660.532728212619, -6139.93882887088, -6354.718340069533, -8157.1729930126385, -4560.102863811513, -4028.716622760986, -2276.2584483872665, -2537.7288891459225, -3193.1504866952864, -5710.035822554183, -4930.823805566164, -1386.8980037730953, -3798.381857368358, -4811.05612965053, -2405.9911003894063, -3131.936244777801, -1515.057327300123, -7899.398175338282, -3599.58633326473, -4916.638615603175, -3338.899474772477, -8032.761686680624, -1671.6679594674317, -6805.474185521055, -8418.900434295518, -1834.3492621478729, -3619.360885867959, -5570.964995789615, -4347.587547296695, -4261.206343319922, -2165.644714401762, -1721.304366200453, -6012.804276638669, -4844.6309193376, -6210.493288248948, -5406.90449274884, -2738.4169855928653, -5531.555880622722, -6127.191226769202, -5578.552865447895, -3146.9639147749153, -3296.3223575765683, -4086.0005395796265, -5440.97009778537, -49.160341410799205, -747.3283262885659, -8227.09736086573, -10363.93637820105, -3867.7955657836715, -8754.844730683304, -2310.789463038369, -7511.8560054503905, -139.50780978082796, -9.648827541746483, -2425.5573768332724, -649.3186131290487, -3554.467250836071, -3974.7205438084266, -6653.392388093201, -3926.17503791323, -3688.1086404937787, -1739.0131742481533, -2262.4713944020864, -5288.412986611246, -7582.177217646144, -2420.017294058968, -2101.2788951910084, -6594.575006471025, -3929.1358152381913, -5511.197530321848, -8992.292436912876, -7524.416171609089, -9537.903033225075, -4071.215473050771, -7852.039567841425, -12782.094232345564, -4418.472504417296, -11719.591670797152, -5710.459673162695, -6393.978505430563, -8027.876809090467, -3289.7859251857153, -2050.4453453082524, -6868.475551617412, -2464.455888017547, -6148.352246968084, -4492.831334381315, -3190.2421231165686, -2699.696315935434, -3711.7113218080267, -4446.95139946154, -6512.804780832903, -3478.6909911138778, -5133.903459283828, -2422.8135389131953, -1430.1342821148792, -9541.342383423082, -2433.5925969237323, -12.946298266395024, -0.9324633169124508, -7803.027017695618, -4152.368412013382, -4998.1186234275465, -2097.923763093608, -2139.3105961610963, -10005.0617086435, -1780.6534825629242, -3682.833144084592, -6475.09638396257, -4279.749402657304, -8487.839915057688, -5172.962093539749, -9464.961713615576, -7436.679090565948, -3089.668325928467, -5203.710614881134, -1266.203974195593, -218.24771494167229, -7993.743968175827, -2567.18383032053, -3361.2582530221875, -7830.184028582193, -1205.471678381319, -2815.3005052825883, -2807.19903196421, -5989.243026069061, -750.338474546017, -374.1390477169592, -4254.233695063532, -5222.3410415702565, -3330.136595410274, -3196.9714389481264, -9324.113691288836, -9042.532342934113, -8575.636293284435, -3969.782497359214, -7622.824576397445, -7967.47671586388, -7181.563872640939, -6280.56958219429, -2734.797854390201, -7490.388178908465, -2228.5868839556338, -6176.737406242213, -10388.126958492629, -8810.400723605693, -5705.477565947618, -6316.387535806959, -6458.8974504645275, -9999.85051854554, -2841.630948283414, -4627.64446241677, -2005.9416227363413, -3622.7819008050324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39680748845618247, "mean_inference_ms": 0.9644649555326237, "mean_action_processing_ms": 0.16650323242312104, "mean_env_wait_ms": 0.05078156131295833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034216642379760742, "StateBufferConnector_ms": 0.0025358200073242188, "ViewRequirementAgentConnector_ms": 0.07003366947174072}, "num_episodes": 23, "episode_return_max": -12.946298266395024, "episode_return_min": -12782.094232345564, "episode_return_mean": -6082.2875976315645}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.7835415269545, "num_env_steps_trained_throughput_per_sec": 558.7835415269545, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 7189.236, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7189.204, "sample_time_ms": 726.585, "learn_time_ms": 6450.143, "learn_throughput": 620.141, "synch_weights_time_ms": 11.933}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 126, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-06", "timestamp": 1723232526, "time_this_iter_s": 7.162798881530762, "time_total_s": 941.9877188205719, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3182700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 941.9877188205719, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 24.04, "ram_util_percent": 81.17}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1061.2622308890025, "cur_kl_coeff": 8522.269299239295, "cur_lr": 5.0000000000000016e-05, "total_loss": 190.42857069571812, "policy_loss": 0.0023697627179596263, "vf_loss": 9.977794489264488, "vf_explained_var": 2.061855047941208e-05, "kl": 0.02117375022935448, "entropy": 1.4811552427709103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9941791045760352, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994088678511362, "policy_loss": -0.001538288873181772, "vf_loss": 9.988152459563402, "vf_explained_var": -0.0018413965033475684, "kl": 0.006561973254151997, "entropy": 1.2369652447877106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "env_runners": {"episode_reward_max": -12.946298266395024, "episode_reward_min": -12782.094232345564, "episode_reward_mean": -6108.208762611704, "episode_len_mean": 183.16, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18316, "policy_reward_min": {"agent_policy": 0.9324633169124508, "adversary_policy": -12782.094232345564}, "policy_reward_max": {"agent_policy": 8810.400723605693, "adversary_policy": -0.9324633169124508}, "policy_reward_mean": {"agent_policy": 3474.114182018196, "adversary_policy": -4791.1614723149505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3833.161627683547, -7666.992882233415, -8186.087117319033, -6195.996291073635, -2708.311171415718, -5929.7348092203365, -4944.594358570965, -5042.3686416622395, -3440.011559817765, -7899.398175338282, -5167.001783270695, -8268.61900647103, -6805.474185521055, -8418.900434295516, -5992.831494755431, -4753.02872204075, -2198.1772943520746, -6163.839529603746, -6623.553676573578, -5531.555880622722, -6405.3279618026245, -3550.566820270287, -5467.969680943887, -747.3283262885659, -10363.93637820105, -8754.844730683304, -7528.029238385481, -139.50780978082796, -2425.5573768332715, -4675.937927101018, -6653.3923880932, -3774.3371138657476, -5288.412986611246, -7582.177217646145, -6594.575006471025, -5520.821694372451, -8992.292436912878, -9537.903033225075, -12782.094232345564, -11719.591670797152, -6615.812973507528, -8027.876809090467, -6931.7031762233855, -6148.352246968084, -4907.256656655225, -4038.554358268789, -7171.760743045999, -5133.903459283828, -2684.9826793386164, -9541.342383423083, -12.946298266395024, -7803.879595485961, -5252.542258046316, -10005.0617086435, -3733.3051853500147, -6486.32674401558, -8487.83991505769, -9464.961713615576, -5218.076769042228, -1266.203974195593, -7993.743968175827, -7830.184028582193, -2815.3005052825883, -5989.243026069061, -772.1352925938295, -5807.84033059343, -3680.4529269902328, -9599.603855227413, -8585.255509094097, -8006.179480831975, -7187.68498975354, -7490.388178908465, -6271.1126317608105, -10388.126958492629, -6327.642763563185, -9999.85051854554, -4627.64446241677, -3622.7819008050324, -7041.743157868098, -3145.6463640539, -4020.123414263337, -5395.022308327737, -6233.488111352616, -7654.030186827517, -10107.754694230522, -7141.800349643374, -3590.29481581719, -4525.788325105405, -4369.871683782854, -8296.901586972126, -4751.070049605081, -2920.0284741438713, -9549.654730199925, -7312.3179707279, -399.4514638800266, -3472.566658991368, -6272.709116207921, -10150.044450447089, -8781.216018476562, -5487.248682563141], "episode_lengths": [133, 200, 200, 200, 162, 171, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 5, 97, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 181, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 131, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 182, 117, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [991.7781990071859, 6133.478674850085, 6325.804215763139, 2392.8231954988605, 2105.6761661174714, 2973.451500029135, 1373.1274507682942, 3567.0693453566496, 2097.9157853494444, 1515.057327300123, 3349.223165597207, 3103.0421549820717, 1671.6679594674317, 1834.3492621478729, 3197.4943869021477, 3855.7651685758715, 1688.7717862501413, 4693.595666372521, 4993.8441044242145, 2738.4169855928653, 5300.416130414473, 2892.7194520811954, 4059.0009564211036, 49.160341410799205, 8227.09736086573, 3867.7955657836715, 2294.616230103279, 9.648827541746483, 649.3186131290487, 2853.2498675434867, 3926.17503791323, 1652.7847008761844, 2262.4713944020864, 2420.017294058968, 2101.2788951910084, 3919.511651187589, 7524.416171609089, 4071.215473050771, 7852.039567841425, 4418.472504417296, 5488.625205085732, 3289.7859251857153, 1987.2177207022787, 2464.455888017547, 2775.8168008426596, 2372.8532794746693, 3787.9954372484426, 3478.6909911138778, 1167.9651416894576, 2433.5925969237323, 0.9324633169124508, 4151.515834223039, 1843.5001284748362, 2139.3105961610963, 1730.1814412975, 4268.5190426042955, 5172.962093539749, 7436.679090565948, 3075.3021717673714, 218.24771494167229, 2567.18383032053, 3361.2582530221875, 1205.471678381319, 2807.19903196421, 352.34222966914655, 3668.734406040361, 2846.6551073681694, 8767.042178995538, 3960.1632815495523, 7584.12181142935, 6274.448465081687, 2734.797854390201, 2134.211658437037, 8810.400723605693, 5694.222338191391, 6458.8974504645275, 2841.630948283414, 2005.9416227363413, 1282.9104292320426, 823.073054711784, 2108.4344380633806, 4324.945299352544, 4572.370401055669, 5984.84747079521, 6994.505458991192, 5126.947242938218, 3010.467140338336, 1825.6811694508099, 3113.16036993711, 6488.74828636288, 3774.96727391845, 1789.4851851885765, 8773.669127862431, 3440.5402742425367, 240.48133513944705, 1892.559184381413, 938.97719901678, 4408.085307576414, 8103.788350291604, 4080.143233670684], "policy_adversary_policy_reward": [-3833.161627683547, -991.7781990071859, -7660.532728212619, -6139.93882887088, -6354.718340069533, -8157.1729930126385, -4560.102863811513, -4028.716622760986, -2276.2584483872665, -2537.7288891459225, -3193.1504866952864, -5710.035822554183, -4930.823805566164, -1386.8980037730953, -3798.381857368358, -4811.05612965053, -2405.9911003894063, -3131.936244777801, -1515.057327300123, -7899.398175338282, -3599.58633326473, -4916.638615603175, -3338.899474772477, -8032.761686680624, -1671.6679594674317, -6805.474185521055, -8418.900434295518, -1834.3492621478729, -3619.360885867959, -5570.964995789615, -4347.587547296695, -4261.206343319922, -2165.644714401762, -1721.304366200453, -6012.804276638669, -4844.6309193376, -6210.493288248948, -5406.90449274884, -2738.4169855928653, -5531.555880622722, -6127.191226769202, -5578.552865447895, -3146.9639147749153, -3296.3223575765683, -4086.0005395796265, -5440.97009778537, -49.160341410799205, -747.3283262885659, -8227.09736086573, -10363.93637820105, -3867.7955657836715, -8754.844730683304, -2310.789463038369, -7511.8560054503905, -139.50780978082796, -9.648827541746483, -2425.5573768332724, -649.3186131290487, -3554.467250836071, -3974.7205438084266, -6653.392388093201, -3926.17503791323, -3688.1086404937787, -1739.0131742481533, -2262.4713944020864, -5288.412986611246, -7582.177217646144, -2420.017294058968, -2101.2788951910084, -6594.575006471025, -3929.1358152381913, -5511.197530321848, -8992.292436912876, -7524.416171609089, -9537.903033225075, -4071.215473050771, -7852.039567841425, -12782.094232345564, -4418.472504417296, -11719.591670797152, -5710.459673162695, -6393.978505430563, -8027.876809090467, -3289.7859251857153, -2050.4453453082524, -6868.475551617412, -2464.455888017547, -6148.352246968084, -4492.831334381315, -3190.2421231165686, -2699.696315935434, -3711.7113218080267, -4446.95139946154, -6512.804780832903, -3478.6909911138778, -5133.903459283828, -2422.8135389131953, -1430.1342821148792, -9541.342383423082, -2433.5925969237323, -12.946298266395024, -0.9324633169124508, -7803.027017695618, -4152.368412013382, -4998.1186234275465, -2097.923763093608, -2139.3105961610963, -10005.0617086435, -1780.6534825629242, -3682.833144084592, -6475.09638396257, -4279.749402657304, -8487.839915057688, -5172.962093539749, -9464.961713615576, -7436.679090565948, -3089.668325928467, -5203.710614881134, -1266.203974195593, -218.24771494167229, -7993.743968175827, -2567.18383032053, -3361.2582530221875, -7830.184028582193, -1205.471678381319, -2815.3005052825883, -2807.19903196421, -5989.243026069061, -750.338474546017, -374.1390477169592, -4254.233695063532, -5222.3410415702565, -3330.136595410274, -3196.9714389481264, -9324.113691288836, -9042.532342934113, -8575.636293284435, -3969.782497359214, -7622.824576397445, -7967.47671586388, -7181.563872640939, -6280.56958219429, -2734.797854390201, -7490.388178908465, -2228.5868839556338, -6176.737406242213, -10388.126958492629, -8810.400723605693, -5705.477565947618, -6316.387535806959, -6458.8974504645275, -9999.85051854554, -2841.630948283414, -4627.64446241677, -2005.9416227363413, -3622.7819008050324, -7041.743157868097, -1282.9104292320426, -823.073054711784, -3145.6463640539, -3209.6447275230366, -2918.913124803677, -5362.52628932034, -4357.441318359942, -6131.150139310633, -4674.708373097653, -5984.84747079521, -7654.030186827517, -6994.505458991192, -10107.754694230522, -5126.947242938218, -7141.800349643372, -3042.949695499699, -3557.812260655827, -1825.9936069259873, -4525.4758876302285, -3673.7249674330415, -3809.307086286922, -8161.390808133368, -6624.259065201637, -3991.480070732716, -4534.557252790816, -1789.841171079604, -2919.6724882528442, -9169.880860367935, -9153.442997694423, -3440.5402742425367, -7312.3179707279, -393.64476604533814, -246.28803297413546, -1908.0521372921878, -3457.073706080593, -938.97719901678, -6272.709116207921, -10150.044450447085, -4408.085307576414, -8148.454453897698, -8736.549914870473, -5421.87784079624, -4145.514075437581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3966356462076128, "mean_inference_ms": 0.9634960201683478, "mean_action_processing_ms": 0.16646801168136488, "mean_env_wait_ms": 0.05078750449700504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034378767013549805, "StateBufferConnector_ms": 0.0024857521057128906, "ViewRequirementAgentConnector_ms": 0.06862401962280273}, "num_episodes": 22, "episode_return_max": -12.946298266395024, "episode_return_min": -12782.094232345564, "episode_return_mean": -6108.208762611704}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.33314525865, "num_env_steps_trained_throughput_per_sec": 549.33314525865, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1524000, "timers": {"training_iteration_time_ms": 7209.847, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7209.815, "sample_time_ms": 724.32, "learn_time_ms": 6473.169, "learn_throughput": 617.935, "synch_weights_time_ms": 11.782}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "done": false, "training_iteration": 127, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-14", "timestamp": 1723232534, "time_this_iter_s": 7.286710023880005, "time_total_s": 949.2744288444519, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3182d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 949.2744288444519, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 24.345454545454547, "ram_util_percent": 80.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1447.8097419102987, "cur_kl_coeff": 12783.403948858937, "cur_lr": 5.0000000000000016e-05, "total_loss": 237.77589205900827, "policy_loss": 0.005385737148026237, "vf_loss": 9.995338419079781, "vf_explained_var": 3.7944441040356953e-05, "kl": 0.017818036808845743, "entropy": 1.4847373814632496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9941983389475989, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003089202901043, "policy_loss": -0.0007379660814034718, "vf_loss": 9.996934228725534, "vf_explained_var": -0.0012786344876365057, "kl": 0.006051405836093836, "entropy": 1.2517308348070377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": -12.946298266395024, "episode_reward_min": -12782.094232345564, "episode_reward_mean": -6295.544152264875, "episode_len_mean": 182.96, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18296, "policy_reward_min": {"agent_policy": 0.9324633169124508, "adversary_policy": -12782.094232345564}, "policy_reward_max": {"agent_policy": 11394.99521421219, "adversary_policy": -0.9324633169124508}, "policy_reward_mean": {"agent_policy": 3751.673057095998, "adversary_policy": -5023.608604680438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3550.566820270287, -5467.969680943887, -747.3283262885659, -10363.93637820105, -8754.844730683304, -7528.029238385481, -139.50780978082796, -2425.5573768332715, -4675.937927101018, -6653.3923880932, -3774.3371138657476, -5288.412986611246, -7582.177217646145, -6594.575006471025, -5520.821694372451, -8992.292436912878, -9537.903033225075, -12782.094232345564, -11719.591670797152, -6615.812973507528, -8027.876809090467, -6931.7031762233855, -6148.352246968084, -4907.256656655225, -4038.554358268789, -7171.760743045999, -5133.903459283828, -2684.9826793386164, -9541.342383423083, -12.946298266395024, -7803.879595485961, -5252.542258046316, -10005.0617086435, -3733.3051853500147, -6486.32674401558, -8487.83991505769, -9464.961713615576, -5218.076769042228, -1266.203974195593, -7993.743968175827, -7830.184028582193, -2815.3005052825883, -5989.243026069061, -772.1352925938295, -5807.84033059343, -3680.4529269902328, -9599.603855227413, -8585.255509094097, -8006.179480831975, -7187.68498975354, -7490.388178908465, -6271.1126317608105, -10388.126958492629, -6327.642763563185, -9999.85051854554, -4627.64446241677, -3622.7819008050324, -7041.743157868098, -3145.6463640539, -4020.123414263337, -5395.022308327737, -6233.488111352616, -7654.030186827517, -10107.754694230522, -7141.800349643374, -3590.29481581719, -4525.788325105405, -4369.871683782854, -8296.901586972126, -4751.070049605081, -2920.0284741438713, -9549.654730199925, -7312.3179707279, -399.4514638800266, -3472.566658991368, -6272.709116207921, -10150.044450447089, -8781.216018476562, -5487.248682563141, -9330.790377950574, -7698.526847593633, -4214.864871152887, -5789.567523215455, -5997.773241520904, -7802.7078884638295, -823.3565240789242, -2180.456380839185, -7169.765906082881, -7493.865248046891, -6603.443920267753, -6377.437113685166, -4561.637563350228, -9982.79585327354, -5663.438959900288, -6612.902808516999, -11855.45189330281, -7258.697328553434, -8517.325906947613, -4504.651470762608, -10469.047941455901], "episode_lengths": [200, 200, 18, 200, 200, 200, 5, 97, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 181, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 131, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 182, 117, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2892.7194520811954, 4059.0009564211036, 49.160341410799205, 8227.09736086573, 3867.7955657836715, 2294.616230103279, 9.648827541746483, 649.3186131290487, 2853.2498675434867, 3926.17503791323, 1652.7847008761844, 2262.4713944020864, 2420.017294058968, 2101.2788951910084, 3919.511651187589, 7524.416171609089, 4071.215473050771, 7852.039567841425, 4418.472504417296, 5488.625205085732, 3289.7859251857153, 1987.2177207022787, 2464.455888017547, 2775.8168008426596, 2372.8532794746693, 3787.9954372484426, 3478.6909911138778, 1167.9651416894576, 2433.5925969237323, 0.9324633169124508, 4151.515834223039, 1843.5001284748362, 2139.3105961610963, 1730.1814412975, 4268.5190426042955, 5172.962093539749, 7436.679090565948, 3075.3021717673714, 218.24771494167229, 2567.18383032053, 3361.2582530221875, 1205.471678381319, 2807.19903196421, 352.34222966914655, 3668.734406040361, 2846.6551073681694, 8767.042178995538, 3960.1632815495523, 7584.12181142935, 6274.448465081687, 2734.797854390201, 2134.211658437037, 8810.400723605693, 5694.222338191391, 6458.8974504645275, 2841.630948283414, 2005.9416227363413, 1282.9104292320426, 823.073054711784, 2108.4344380633806, 4324.945299352544, 4572.370401055669, 5984.84747079521, 6994.505458991192, 5126.947242938218, 3010.467140338336, 1825.6811694508099, 3113.16036993711, 6488.74828636288, 3774.96727391845, 1789.4851851885765, 8773.669127862431, 3440.5402742425367, 240.48133513944705, 1892.559184381413, 938.97719901678, 4408.085307576414, 8103.788350291604, 4080.143233670684, 5452.066235344039, 4495.141080309083, 2766.5413796285216, 2859.199644183802, 4697.960486377343, 5324.01038699533, 308.3029197993808, 984.0305539576782, 5375.0700372969895, 6518.687987141072, 2617.4185029498167, 1850.526179728108, 2281.475632879437, 8545.015840919828, 3436.413035838521, 5795.437815452143, 11394.99521421219, 6507.734146741674, 5421.735481387184, 2234.0402194181293, 4792.85335798713], "policy_adversary_policy_reward": [-3146.9639147749153, -3296.3223575765683, -4086.0005395796265, -5440.97009778537, -49.160341410799205, -747.3283262885659, -8227.09736086573, -10363.93637820105, -3867.7955657836715, -8754.844730683304, -2310.789463038369, -7511.8560054503905, -139.50780978082796, -9.648827541746483, -2425.5573768332724, -649.3186131290487, -3554.467250836071, -3974.7205438084266, -6653.392388093201, -3926.17503791323, -3688.1086404937787, -1739.0131742481533, -2262.4713944020864, -5288.412986611246, -7582.177217646144, -2420.017294058968, -2101.2788951910084, -6594.575006471025, -3929.1358152381913, -5511.197530321848, -8992.292436912876, -7524.416171609089, -9537.903033225075, -4071.215473050771, -7852.039567841425, -12782.094232345564, -4418.472504417296, -11719.591670797152, -5710.459673162695, -6393.978505430563, -8027.876809090467, -3289.7859251857153, -2050.4453453082524, -6868.475551617412, -2464.455888017547, -6148.352246968084, -4492.831334381315, -3190.2421231165686, -2699.696315935434, -3711.7113218080267, -4446.95139946154, -6512.804780832903, -3478.6909911138778, -5133.903459283828, -2422.8135389131953, -1430.1342821148792, -9541.342383423082, -2433.5925969237323, -12.946298266395024, -0.9324633169124508, -7803.027017695618, -4152.368412013382, -4998.1186234275465, -2097.923763093608, -2139.3105961610963, -10005.0617086435, -1780.6534825629242, -3682.833144084592, -6475.09638396257, -4279.749402657304, -8487.839915057688, -5172.962093539749, -9464.961713615576, -7436.679090565948, -3089.668325928467, -5203.710614881134, -1266.203974195593, -218.24771494167229, -7993.743968175827, -2567.18383032053, -3361.2582530221875, -7830.184028582193, -1205.471678381319, -2815.3005052825883, -2807.19903196421, -5989.243026069061, -750.338474546017, -374.1390477169592, -4254.233695063532, -5222.3410415702565, -3330.136595410274, -3196.9714389481264, -9324.113691288836, -9042.532342934113, -8575.636293284435, -3969.782497359214, -7622.824576397445, -7967.47671586388, -7181.563872640939, -6280.56958219429, -2734.797854390201, -7490.388178908465, -2228.5868839556338, -6176.737406242213, -10388.126958492629, -8810.400723605693, -5705.477565947618, -6316.387535806959, -6458.8974504645275, -9999.85051854554, -2841.630948283414, -4627.64446241677, -2005.9416227363413, -3622.7819008050324, -7041.743157868097, -1282.9104292320426, -823.073054711784, -3145.6463640539, -3209.6447275230366, -2918.913124803677, -5362.52628932034, -4357.441318359942, -6131.150139310633, -4674.708373097653, -5984.84747079521, -7654.030186827517, -6994.505458991192, -10107.754694230522, -5126.947242938218, -7141.800349643372, -3042.949695499699, -3557.812260655827, -1825.9936069259873, -4525.4758876302285, -3673.7249674330415, -3809.307086286922, -8161.390808133368, -6624.259065201637, -3991.480070732716, -4534.557252790816, -1789.841171079604, -2919.6724882528442, -9169.880860367935, -9153.442997694423, -3440.5402742425367, -7312.3179707279, -393.64476604533814, -246.28803297413546, -1908.0521372921878, -3457.073706080593, -938.97719901678, -6272.709116207921, -10150.044450447085, -4408.085307576414, -8148.454453897698, -8736.549914870473, -5421.87784079624, -4145.514075437581, -5452.066235344039, -9330.790377950574, -4542.677454028841, -7650.990473873874, -2813.360606353282, -4168.045644428125, -2895.472468371737, -5753.294699027519, -5832.964751693866, -4862.768976204382, -5392.390896530605, -7734.327378928553, -308.3029197993808, -823.3565240789242, -1909.6467645938778, -1254.8401702029842, -7169.765906082883, -5375.0700372969895, -6541.25292316452, -7471.3003120234425, -6284.298557967053, -2936.5638652505177, -1857.5047298621323, -6370.458563551142, -2501.8055987948087, -4341.307597434858, -8545.015840919828, -9982.79585327354, -5663.438959900287, -3436.413035838521, -6487.038598262424, -5921.302025706716, -11512.67036631667, -11737.776741198328, -7241.701509151176, -6524.729966143933, -8517.325906947613, -5421.735481387184, -2403.415580243433, -4335.276109937305, -4792.85335798713, -10469.047941455901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39653685134043215, "mean_inference_ms": 0.9625688843603502, "mean_action_processing_ms": 0.16642826895640186, "mean_env_wait_ms": 0.05078192977616633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003419637680053711, "StateBufferConnector_ms": 0.00248873233795166, "ViewRequirementAgentConnector_ms": 0.06693112850189209}, "num_episodes": 21, "episode_return_max": -12.946298266395024, "episode_return_min": -12782.094232345564, "episode_return_mean": -6295.544152264875}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.1026244743541, "num_env_steps_trained_throughput_per_sec": 545.1026244743541, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 7243.261, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7243.229, "sample_time_ms": 725.885, "learn_time_ms": 6505.352, "learn_throughput": 614.878, "synch_weights_time_ms": 11.498}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 128, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-21", "timestamp": 1723232541, "time_this_iter_s": 7.3420000076293945, "time_total_s": 956.6164288520813, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3049ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 956.6164288520813, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 24.40909090909091, "ram_util_percent": 80.82727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1458.021911462148, "cur_kl_coeff": 12783.403948858937, "cur_lr": 5.0000000000000016e-05, "total_loss": 265.856485915184, "policy_loss": 0.006616255413003576, "vf_loss": 9.994505101442337, "vf_explained_var": 9.121758242448171e-05, "kl": 0.02001465012775346, "entropy": 1.4713509403169156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9913072686504435, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001121553794416, "policy_loss": -5.11095223445741e-05, "vf_loss": 9.995987582332873, "vf_explained_var": -0.002896635683756026, "kl": 0.004552053139303569, "entropy": 1.2470859084179793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "env_runners": {"episode_reward_max": -12.946298266395024, "episode_reward_min": -11855.45189330281, "episode_reward_mean": -6291.758167573641, "episode_len_mean": 183.39, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18339, "policy_reward_min": {"agent_policy": 0.9324633169124508, "adversary_policy": -11737.776741198328}, "policy_reward_max": {"agent_policy": 11394.99521421219, "adversary_policy": -0.9324633169124508}, "policy_reward_mean": {"agent_policy": 3800.456171118608, "adversary_policy": -5046.107169346125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6931.7031762233855, -6148.352246968084, -4907.256656655225, -4038.554358268789, -7171.760743045999, -5133.903459283828, -2684.9826793386164, -9541.342383423083, -12.946298266395024, -7803.879595485961, -5252.542258046316, -10005.0617086435, -3733.3051853500147, -6486.32674401558, -8487.83991505769, -9464.961713615576, -5218.076769042228, -1266.203974195593, -7993.743968175827, -7830.184028582193, -2815.3005052825883, -5989.243026069061, -772.1352925938295, -5807.84033059343, -3680.4529269902328, -9599.603855227413, -8585.255509094097, -8006.179480831975, -7187.68498975354, -7490.388178908465, -6271.1126317608105, -10388.126958492629, -6327.642763563185, -9999.85051854554, -4627.64446241677, -3622.7819008050324, -7041.743157868098, -3145.6463640539, -4020.123414263337, -5395.022308327737, -6233.488111352616, -7654.030186827517, -10107.754694230522, -7141.800349643374, -3590.29481581719, -4525.788325105405, -4369.871683782854, -8296.901586972126, -4751.070049605081, -2920.0284741438713, -9549.654730199925, -7312.3179707279, -399.4514638800266, -3472.566658991368, -6272.709116207921, -10150.044450447089, -8781.216018476562, -5487.248682563141, -9330.790377950574, -7698.526847593633, -4214.864871152887, -5789.567523215455, -5997.773241520904, -7802.7078884638295, -823.3565240789242, -2180.456380839185, -7169.765906082881, -7493.865248046891, -6603.443920267753, -6377.437113685166, -4561.637563350228, -9982.79585327354, -5663.438959900288, -6612.902808516999, -11855.45189330281, -7258.697328553434, -8517.325906947613, -4504.651470762608, -10469.047941455901, -5842.712689565628, -10888.260598835823, -7197.063286397162, -7191.737774205522, -6298.673042045741, -6083.509593238747, -5515.334184657566, -410.3906840654908, -751.0311653455182, -9371.67237249115, -6470.777580154592, -7302.189507900595, -10575.57225871174, -7830.493206714114, -8642.91911974949, -7985.737948056364, -7235.813210209007, -7791.906662759069, -1329.892242423653, -7872.919662777839, -3775.760591997889], "episode_lengths": [200, 200, 200, 200, 200, 200, 181, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 131, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 182, 117, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 22, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 75, 200, 200], "policy_agent_policy_reward": [1987.2177207022787, 2464.455888017547, 2775.8168008426596, 2372.8532794746693, 3787.9954372484426, 3478.6909911138778, 1167.9651416894576, 2433.5925969237323, 0.9324633169124508, 4151.515834223039, 1843.5001284748362, 2139.3105961610963, 1730.1814412975, 4268.5190426042955, 5172.962093539749, 7436.679090565948, 3075.3021717673714, 218.24771494167229, 2567.18383032053, 3361.2582530221875, 1205.471678381319, 2807.19903196421, 352.34222966914655, 3668.734406040361, 2846.6551073681694, 8767.042178995538, 3960.1632815495523, 7584.12181142935, 6274.448465081687, 2734.797854390201, 2134.211658437037, 8810.400723605693, 5694.222338191391, 6458.8974504645275, 2841.630948283414, 2005.9416227363413, 1282.9104292320426, 823.073054711784, 2108.4344380633806, 4324.945299352544, 4572.370401055669, 5984.84747079521, 6994.505458991192, 5126.947242938218, 3010.467140338336, 1825.6811694508099, 3113.16036993711, 6488.74828636288, 3774.96727391845, 1789.4851851885765, 8773.669127862431, 3440.5402742425367, 240.48133513944705, 1892.559184381413, 938.97719901678, 4408.085307576414, 8103.788350291604, 4080.143233670684, 5452.066235344039, 4495.141080309083, 2766.5413796285216, 2859.199644183802, 4697.960486377343, 5324.01038699533, 308.3029197993808, 984.0305539576782, 5375.0700372969895, 6518.687987141072, 2617.4185029498167, 1850.526179728108, 2281.475632879437, 8545.015840919828, 3436.413035838521, 5795.437815452143, 11394.99521421219, 6507.734146741674, 5421.735481387184, 2234.0402194181293, 4792.85335798713, 1454.9068216588946, 4220.235547685437, 3053.630439897865, 3253.8520220568876, 4361.68612836205, 5000.005125004158, 2880.435181767595, 201.96043070774328, 192.2989318254556, 7454.149218177928, 5083.6737662961295, 5635.623890186985, 8603.155256923375, 3443.2231179610253, 1658.9134861801667, 2779.912587129202, 4672.809192641061, 6512.333385566843, 556.7596778688478, 5537.406947558123, 2150.7412825044125], "policy_adversary_policy_reward": [-2050.4453453082524, -6868.475551617412, -2464.455888017547, -6148.352246968084, -4492.831334381315, -3190.2421231165686, -2699.696315935434, -3711.7113218080267, -4446.95139946154, -6512.804780832903, -3478.6909911138778, -5133.903459283828, -2422.8135389131953, -1430.1342821148792, -9541.342383423082, -2433.5925969237323, -12.946298266395024, -0.9324633169124508, -7803.027017695618, -4152.368412013382, -4998.1186234275465, -2097.923763093608, -2139.3105961610963, -10005.0617086435, -1780.6534825629242, -3682.833144084592, -6475.09638396257, -4279.749402657304, -8487.839915057688, -5172.962093539749, -9464.961713615576, -7436.679090565948, -3089.668325928467, -5203.710614881134, -1266.203974195593, -218.24771494167229, -7993.743968175827, -2567.18383032053, -3361.2582530221875, -7830.184028582193, -1205.471678381319, -2815.3005052825883, -2807.19903196421, -5989.243026069061, -750.338474546017, -374.1390477169592, -4254.233695063532, -5222.3410415702565, -3330.136595410274, -3196.9714389481264, -9324.113691288836, -9042.532342934113, -8575.636293284435, -3969.782497359214, -7622.824576397445, -7967.47671586388, -7181.563872640939, -6280.56958219429, -2734.797854390201, -7490.388178908465, -2228.5868839556338, -6176.737406242213, -10388.126958492629, -8810.400723605693, -5705.477565947618, -6316.387535806959, -6458.8974504645275, -9999.85051854554, -2841.630948283414, -4627.64446241677, -2005.9416227363413, -3622.7819008050324, -7041.743157868097, -1282.9104292320426, -823.073054711784, -3145.6463640539, -3209.6447275230366, -2918.913124803677, -5362.52628932034, -4357.441318359942, -6131.150139310633, -4674.708373097653, -5984.84747079521, -7654.030186827517, -6994.505458991192, -10107.754694230522, -5126.947242938218, -7141.800349643372, -3042.949695499699, -3557.812260655827, -1825.9936069259873, -4525.4758876302285, -3673.7249674330415, -3809.307086286922, -8161.390808133368, -6624.259065201637, -3991.480070732716, -4534.557252790816, -1789.841171079604, -2919.6724882528442, -9169.880860367935, -9153.442997694423, -3440.5402742425367, -7312.3179707279, -393.64476604533814, -246.28803297413546, -1908.0521372921878, -3457.073706080593, -938.97719901678, -6272.709116207921, -10150.044450447085, -4408.085307576414, -8148.454453897698, -8736.549914870473, -5421.87784079624, -4145.514075437581, -5452.066235344039, -9330.790377950574, -4542.677454028841, -7650.990473873874, -2813.360606353282, -4168.045644428125, -2895.472468371737, -5753.294699027519, -5832.964751693866, -4862.768976204382, -5392.390896530605, -7734.327378928553, -308.3029197993808, -823.3565240789242, -1909.6467645938778, -1254.8401702029842, -7169.765906082883, -5375.0700372969895, -6541.25292316452, -7471.3003120234425, -6284.298557967053, -2936.5638652505177, -1857.5047298621323, -6370.458563551142, -2501.8055987948087, -4341.307597434858, -8545.015840919828, -9982.79585327354, -5663.438959900287, -3436.413035838521, -6487.038598262424, -5921.302025706716, -11512.67036631667, -11737.776741198328, -7241.701509151176, -6524.729966143933, -8517.325906947613, -5421.735481387184, -2403.415580243433, -4335.276109937305, -4792.85335798713, -10469.047941455901, -5390.98079712503, -1906.6387140994952, -4220.235547685437, -10888.260598835823, -7197.0632863971605, -3053.630439897865, -6920.503749076934, -3525.086047185475, -5956.2335418135035, -4704.125628594288, -5425.440318961256, -5658.074399281649, -2887.746412006172, -5508.022954418989, -201.96043070774328, -410.3906840654908, -751.031165345518, -192.2989318254556, -9371.67237249115, -7454.149218177928, -6410.107890292165, -5144.343456158559, -5635.623890186985, -7302.189507900595, -10575.572258711738, -8603.155256923375, -3443.2231179610253, -7830.493206714114, -8642.91911974949, -1658.9134861801667, -2782.387431946388, -7983.263103239179, -4803.113271429565, -7105.509131420501, -6608.895251158367, -7695.344797167546, -1058.8158893960733, -827.8360308964271, -6033.519274531157, -7376.80733580481, -2390.9694391599187, -3535.532435342385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3965483226012706, "mean_inference_ms": 0.9640232916054287, "mean_action_processing_ms": 0.16648648340491357, "mean_env_wait_ms": 0.050792401419839546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033301115036010742, "StateBufferConnector_ms": 0.0025845766067504883, "ViewRequirementAgentConnector_ms": 0.06469452381134033}, "num_episodes": 21, "episode_return_max": -12.946298266395024, "episode_return_min": -11855.45189330281, "episode_return_mean": -6291.758167573641}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.3796925329526, "num_env_steps_trained_throughput_per_sec": 530.3796925329526, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1548000, "timers": {"training_iteration_time_ms": 7274.878, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7274.846, "sample_time_ms": 738.84, "learn_time_ms": 6524.077, "learn_throughput": 613.114, "synch_weights_time_ms": 11.394}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "done": false, "training_iteration": 129, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-29", "timestamp": 1723232549, "time_this_iter_s": 7.545583963394165, "time_total_s": 964.1620128154755, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3182dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 964.1620128154755, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 26.580000000000002, "ram_util_percent": 81.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1843.3361647129059, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 247.17896478970846, "policy_loss": 0.0052469438657378005, "vf_loss": 9.991432964801788, "vf_explained_var": 9.442567825317383e-05, "kl": 0.01236928190216228, "entropy": 1.4744355207930009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9569090883883219, "cur_kl_coeff": 0.5695312499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994202491215297, "policy_loss": -0.005202528862738439, "vf_loss": 9.996179157842404, "vf_explained_var": -0.0032375310463880107, "kl": 0.005664058672954087, "entropy": 1.2409110440148248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": -23.13645081753867, "episode_reward_min": -11855.45189330281, "episode_reward_mean": -6622.21977038296, "episode_len_mean": 183.46, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18346, "policy_reward_min": {"agent_policy": 3.563011655788222, "adversary_policy": -11737.776741198328}, "policy_reward_max": {"agent_policy": 11394.99521421219, "adversary_policy": -3.563011655788222}, "policy_reward_mean": {"agent_policy": 4209.340218735553, "adversary_policy": -5415.779994559255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3680.4529269902328, -9599.603855227413, -8585.255509094097, -8006.179480831975, -7187.68498975354, -7490.388178908465, -6271.1126317608105, -10388.126958492629, -6327.642763563185, -9999.85051854554, -4627.64446241677, -3622.7819008050324, -7041.743157868098, -3145.6463640539, -4020.123414263337, -5395.022308327737, -6233.488111352616, -7654.030186827517, -10107.754694230522, -7141.800349643374, -3590.29481581719, -4525.788325105405, -4369.871683782854, -8296.901586972126, -4751.070049605081, -2920.0284741438713, -9549.654730199925, -7312.3179707279, -399.4514638800266, -3472.566658991368, -6272.709116207921, -10150.044450447089, -8781.216018476562, -5487.248682563141, -9330.790377950574, -7698.526847593633, -4214.864871152887, -5789.567523215455, -5997.773241520904, -7802.7078884638295, -823.3565240789242, -2180.456380839185, -7169.765906082881, -7493.865248046891, -6603.443920267753, -6377.437113685166, -4561.637563350228, -9982.79585327354, -5663.438959900288, -6612.902808516999, -11855.45189330281, -7258.697328553434, -8517.325906947613, -4504.651470762608, -10469.047941455901, -5842.712689565628, -10888.260598835823, -7197.063286397162, -7191.737774205522, -6298.673042045741, -6083.509593238747, -5515.334184657566, -410.3906840654908, -751.0311653455182, -9371.67237249115, -6470.777580154592, -7302.189507900595, -10575.57225871174, -7830.493206714114, -8642.91911974949, -7985.737948056364, -7235.813210209007, -7791.906662759069, -1329.892242423653, -7872.919662777839, -3775.760591997889, -7060.8050996722395, -8211.439774351002, -23.13645081753867, -10772.961525974291, -10138.995021807183, -6501.137537246694, -6688.920283748897, -10039.31650416287, -6365.516600054703, -9824.831286267292, -2126.0496491035815, -1878.0761158232558, -8039.520932041817, -10256.357605591895, -9078.231808373746, -7491.87328191578, -6675.943701724072, -8621.309461169229, -7696.413142746667, -9589.690342965387, -8148.7034727939235, -6767.409599302405, -1165.5961163966988, -5381.371983103171], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 182, 117, 200, 200, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 22, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 75, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 92, 66, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200], "policy_agent_policy_reward": [2846.6551073681694, 8767.042178995538, 3960.1632815495523, 7584.12181142935, 6274.448465081687, 2734.797854390201, 2134.211658437037, 8810.400723605693, 5694.222338191391, 6458.8974504645275, 2841.630948283414, 2005.9416227363413, 1282.9104292320426, 823.073054711784, 2108.4344380633806, 4324.945299352544, 4572.370401055669, 5984.84747079521, 6994.505458991192, 5126.947242938218, 3010.467140338336, 1825.6811694508099, 3113.16036993711, 6488.74828636288, 3774.96727391845, 1789.4851851885765, 8773.669127862431, 3440.5402742425367, 240.48133513944705, 1892.559184381413, 938.97719901678, 4408.085307576414, 8103.788350291604, 4080.143233670684, 5452.066235344039, 4495.141080309083, 2766.5413796285216, 2859.199644183802, 4697.960486377343, 5324.01038699533, 308.3029197993808, 984.0305539576782, 5375.0700372969895, 6518.687987141072, 2617.4185029498167, 1850.526179728108, 2281.475632879437, 8545.015840919828, 3436.413035838521, 5795.437815452143, 11394.99521421219, 6507.734146741674, 5421.735481387184, 2234.0402194181293, 4792.85335798713, 1454.9068216588946, 4220.235547685437, 3053.630439897865, 3253.8520220568876, 4361.68612836205, 5000.005125004158, 2880.435181767595, 201.96043070774328, 192.2989318254556, 7454.149218177928, 5083.6737662961295, 5635.623890186985, 8603.155256923375, 3443.2231179610253, 1658.9134861801667, 2779.912587129202, 4672.809192641061, 6512.333385566843, 556.7596778688478, 5537.406947558123, 2150.7412825044125, 5826.259978861569, 4266.756367891146, 3.563011655788222, 7668.361050309395, 3045.4138626955832, 6032.5804515703985, 4253.267903338374, 2599.052682598598, 5408.818155753436, 9190.549710897118, 644.6208679739635, 695.2173372259379, 5156.485862509352, 4449.754616294497, 4931.296714357019, 5925.106079613899, 3606.3745410016318, 3195.196172916328, 7026.672651525887, 6593.322080576527, 6953.439955425592, 5405.362866903814, 231.26982009359523, 2247.589882007924], "policy_adversary_policy_reward": [-3330.136595410274, -3196.9714389481264, -9324.113691288836, -9042.532342934113, -8575.636293284435, -3969.782497359214, -7622.824576397445, -7967.47671586388, -7181.563872640939, -6280.56958219429, -2734.797854390201, -7490.388178908465, -2228.5868839556338, -6176.737406242213, -10388.126958492629, -8810.400723605693, -5705.477565947618, -6316.387535806959, -6458.8974504645275, -9999.85051854554, -2841.630948283414, -4627.64446241677, -2005.9416227363413, -3622.7819008050324, -7041.743157868097, -1282.9104292320426, -823.073054711784, -3145.6463640539, -3209.6447275230366, -2918.913124803677, -5362.52628932034, -4357.441318359942, -6131.150139310633, -4674.708373097653, -5984.84747079521, -7654.030186827517, -6994.505458991192, -10107.754694230522, -5126.947242938218, -7141.800349643372, -3042.949695499699, -3557.812260655827, -1825.9936069259873, -4525.4758876302285, -3673.7249674330415, -3809.307086286922, -8161.390808133368, -6624.259065201637, -3991.480070732716, -4534.557252790816, -1789.841171079604, -2919.6724882528442, -9169.880860367935, -9153.442997694423, -3440.5402742425367, -7312.3179707279, -393.64476604533814, -246.28803297413546, -1908.0521372921878, -3457.073706080593, -938.97719901678, -6272.709116207921, -10150.044450447085, -4408.085307576414, -8148.454453897698, -8736.549914870473, -5421.87784079624, -4145.514075437581, -5452.066235344039, -9330.790377950574, -4542.677454028841, -7650.990473873874, -2813.360606353282, -4168.045644428125, -2895.472468371737, -5753.294699027519, -5832.964751693866, -4862.768976204382, -5392.390896530605, -7734.327378928553, -308.3029197993808, -823.3565240789242, -1909.6467645938778, -1254.8401702029842, -7169.765906082883, -5375.0700372969895, -6541.25292316452, -7471.3003120234425, -6284.298557967053, -2936.5638652505177, -1857.5047298621323, -6370.458563551142, -2501.8055987948087, -4341.307597434858, -8545.015840919828, -9982.79585327354, -5663.438959900287, -3436.413035838521, -6487.038598262424, -5921.302025706716, -11512.67036631667, -11737.776741198328, -7241.701509151176, -6524.729966143933, -8517.325906947613, -5421.735481387184, -2403.415580243433, -4335.276109937305, -4792.85335798713, -10469.047941455901, -5390.98079712503, -1906.6387140994952, -4220.235547685437, -10888.260598835823, -7197.0632863971605, -3053.630439897865, -6920.503749076934, -3525.086047185475, -5956.2335418135035, -4704.125628594288, -5425.440318961256, -5658.074399281649, -2887.746412006172, -5508.022954418989, -201.96043070774328, -410.3906840654908, -751.031165345518, -192.2989318254556, -9371.67237249115, -7454.149218177928, -6410.107890292165, -5144.343456158559, -5635.623890186985, -7302.189507900595, -10575.572258711738, -8603.155256923375, -3443.2231179610253, -7830.493206714114, -8642.91911974949, -1658.9134861801667, -2782.387431946388, -7983.263103239179, -4803.113271429565, -7105.509131420501, -6608.895251158367, -7695.344797167546, -1058.8158893960733, -827.8360308964271, -6033.519274531157, -7376.80733580481, -2390.9694391599187, -3535.532435342385, -7060.805099672239, -5826.259978861569, -4266.756367891146, -8211.439774351002, -23.13645081753867, -3.563011655788222, -7668.361050309395, -10772.961525974291, -10138.995021807183, -3045.4138626955832, -6120.862184627173, -6412.855804189922, -4253.267903338374, -6688.920283748896, -10039.31650416287, -2599.052682598598, -6348.95665585189, -5425.378099956249, -9823.282885200204, -9192.098111964206, -644.6208679739635, -2126.0496491035815, -833.2004617749342, -1740.0929912742595, -6251.638159838049, -6944.368634713116, -10256.357605591895, -4449.754616294497, -4931.296714357019, -9078.231808373746, -7328.777464869158, -6088.20189666052, -6675.943701724072, -3606.3745410016318, -8621.309461169229, -3195.196172916328, -7689.475622366598, -7033.610171905954, -9589.690342965383, -6593.322080576527, -7463.310396912287, -7638.833031307227, -6578.390526262493, -5594.381939943727, -1165.596116396698, -231.26982009359523, -5236.57414685261, -2392.3877182584847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3964335132347923, "mean_inference_ms": 0.9647180867772113, "mean_action_processing_ms": 0.16657013042655852, "mean_env_wait_ms": 0.050765807208314924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033179521560668945, "StateBufferConnector_ms": 0.002591848373413086, "ViewRequirementAgentConnector_ms": 0.06498265266418457}, "num_episodes": 24, "episode_return_max": -23.13645081753867, "episode_return_min": -11855.45189330281, "episode_return_mean": -6622.21977038296}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.7562239837027, "num_env_steps_trained_throughput_per_sec": 553.7562239837027, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 7280.334, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7280.303, "sample_time_ms": 737.306, "learn_time_ms": 6531.34, "learn_throughput": 612.432, "synch_weights_time_ms": 11.117}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 130, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-36", "timestamp": 1723232556, "time_this_iter_s": 7.228795289993286, "time_total_s": 971.3908081054688, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3180160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 971.3908081054688, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 28.40000000000001, "ram_util_percent": 81.32727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2015.9600932121277, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 326.4885929107666, "policy_loss": 0.006653778266627342, "vf_loss": 10.0, "vf_explained_var": -9.118045369784037e-05, "kl": 0.016504834301789135, "entropy": 1.468403418858846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9628811905150692, "cur_kl_coeff": 0.5695312499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001939863376517, "policy_loss": -0.0025414834474090232, "vf_loss": 10.0, "vf_explained_var": -0.0039705960838883015, "kl": 0.007868461806090578, "entropy": 1.2167117113789554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "env_runners": {"episode_reward_max": -23.13645081753867, "episode_reward_min": -11855.45189330281, "episode_reward_mean": -6803.596829743558, "episode_len_mean": 184.86, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18486, "policy_reward_min": {"agent_policy": 3.563011655788222, "adversary_policy": -11737.776741198328}, "policy_reward_max": {"agent_policy": 11394.99521421219, "adversary_policy": -3.563011655788222}, "policy_reward_mean": {"agent_policy": 4264.69506871513, "adversary_policy": -5534.145949229344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3590.29481581719, -4525.788325105405, -4369.871683782854, -8296.901586972126, -4751.070049605081, -2920.0284741438713, -9549.654730199925, -7312.3179707279, -399.4514638800266, -3472.566658991368, -6272.709116207921, -10150.044450447089, -8781.216018476562, -5487.248682563141, -9330.790377950574, -7698.526847593633, -4214.864871152887, -5789.567523215455, -5997.773241520904, -7802.7078884638295, -823.3565240789242, -2180.456380839185, -7169.765906082881, -7493.865248046891, -6603.443920267753, -6377.437113685166, -4561.637563350228, -9982.79585327354, -5663.438959900288, -6612.902808516999, -11855.45189330281, -7258.697328553434, -8517.325906947613, -4504.651470762608, -10469.047941455901, -5842.712689565628, -10888.260598835823, -7197.063286397162, -7191.737774205522, -6298.673042045741, -6083.509593238747, -5515.334184657566, -410.3906840654908, -751.0311653455182, -9371.67237249115, -6470.777580154592, -7302.189507900595, -10575.57225871174, -7830.493206714114, -8642.91911974949, -7985.737948056364, -7235.813210209007, -7791.906662759069, -1329.892242423653, -7872.919662777839, -3775.760591997889, -7060.8050996722395, -8211.439774351002, -23.13645081753867, -10772.961525974291, -10138.995021807183, -6501.137537246694, -6688.920283748897, -10039.31650416287, -6365.516600054703, -9824.831286267292, -2126.0496491035815, -1878.0761158232558, -8039.520932041817, -10256.357605591895, -9078.231808373746, -7491.87328191578, -6675.943701724072, -8621.309461169229, -7696.413142746667, -9589.690342965387, -8148.7034727939235, -6767.409599302405, -1165.5961163966988, -5381.371983103171, -10020.598161898919, -8695.500510121996, -6800.603471312561, -6132.840674813489, -8433.461952914351, -7852.212544545468, -11547.634697350706, -6706.853823392418, -7667.020499592752, -10712.38447941832, -8800.082843645452, -6965.209478295457, -7918.0486098914425, -8260.010585541353, -6261.813320559306, -5802.773130520824, -6738.027753257708, -5345.650656987291, -6756.526582714553, -7246.784922242516], "episode_lengths": [200, 160, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 60, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 22, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 75, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 92, 66, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3010.467140338336, 1825.6811694508099, 3113.16036993711, 6488.74828636288, 3774.96727391845, 1789.4851851885765, 8773.669127862431, 3440.5402742425367, 240.48133513944705, 1892.559184381413, 938.97719901678, 4408.085307576414, 8103.788350291604, 4080.143233670684, 5452.066235344039, 4495.141080309083, 2766.5413796285216, 2859.199644183802, 4697.960486377343, 5324.01038699533, 308.3029197993808, 984.0305539576782, 5375.0700372969895, 6518.687987141072, 2617.4185029498167, 1850.526179728108, 2281.475632879437, 8545.015840919828, 3436.413035838521, 5795.437815452143, 11394.99521421219, 6507.734146741674, 5421.735481387184, 2234.0402194181293, 4792.85335798713, 1454.9068216588946, 4220.235547685437, 3053.630439897865, 3253.8520220568876, 4361.68612836205, 5000.005125004158, 2880.435181767595, 201.96043070774328, 192.2989318254556, 7454.149218177928, 5083.6737662961295, 5635.623890186985, 8603.155256923375, 3443.2231179610253, 1658.9134861801667, 2779.912587129202, 4672.809192641061, 6512.333385566843, 556.7596778688478, 5537.406947558123, 2150.7412825044125, 5826.259978861569, 4266.756367891146, 3.563011655788222, 7668.361050309395, 3045.4138626955832, 6032.5804515703985, 4253.267903338374, 2599.052682598598, 5408.818155753436, 9190.549710897118, 644.6208679739635, 695.2173372259379, 5156.485862509352, 4449.754616294497, 4931.296714357019, 5925.106079613899, 3606.3745410016318, 3195.196172916328, 7026.672651525887, 6593.322080576527, 6953.439955425592, 5405.362866903814, 231.26982009359523, 2247.589882007924, 8438.013688494304, 7590.77668759396, 4725.677161933675, 3252.0691017831946, 7505.288102600689, 2077.3961614583845, 2654.8727475061173, 5684.702758625082, 7171.953625237808, 8003.754785396883, 5219.90983664833, 4685.645485680196, 5382.408909414857, 3495.550645589338, 2947.319757314345, 4024.986582877903, 2886.4394530499326, 4547.599691707775, 5433.988693660439, 1137.698357057471], "policy_adversary_policy_reward": [-3042.949695499699, -3557.812260655827, -1825.9936069259873, -4525.4758876302285, -3673.7249674330415, -3809.307086286922, -8161.390808133368, -6624.259065201637, -3991.480070732716, -4534.557252790816, -1789.841171079604, -2919.6724882528442, -9169.880860367935, -9153.442997694423, -3440.5402742425367, -7312.3179707279, -393.64476604533814, -246.28803297413546, -1908.0521372921878, -3457.073706080593, -938.97719901678, -6272.709116207921, -10150.044450447085, -4408.085307576414, -8148.454453897698, -8736.549914870473, -5421.87784079624, -4145.514075437581, -5452.066235344039, -9330.790377950574, -4542.677454028841, -7650.990473873874, -2813.360606353282, -4168.045644428125, -2895.472468371737, -5753.294699027519, -5832.964751693866, -4862.768976204382, -5392.390896530605, -7734.327378928553, -308.3029197993808, -823.3565240789242, -1909.6467645938778, -1254.8401702029842, -7169.765906082883, -5375.0700372969895, -6541.25292316452, -7471.3003120234425, -6284.298557967053, -2936.5638652505177, -1857.5047298621323, -6370.458563551142, -2501.8055987948087, -4341.307597434858, -8545.015840919828, -9982.79585327354, -5663.438959900287, -3436.413035838521, -6487.038598262424, -5921.302025706716, -11512.67036631667, -11737.776741198328, -7241.701509151176, -6524.729966143933, -8517.325906947613, -5421.735481387184, -2403.415580243433, -4335.276109937305, -4792.85335798713, -10469.047941455901, -5390.98079712503, -1906.6387140994952, -4220.235547685437, -10888.260598835823, -7197.0632863971605, -3053.630439897865, -6920.503749076934, -3525.086047185475, -5956.2335418135035, -4704.125628594288, -5425.440318961256, -5658.074399281649, -2887.746412006172, -5508.022954418989, -201.96043070774328, -410.3906840654908, -751.031165345518, -192.2989318254556, -9371.67237249115, -7454.149218177928, -6410.107890292165, -5144.343456158559, -5635.623890186985, -7302.189507900595, -10575.572258711738, -8603.155256923375, -3443.2231179610253, -7830.493206714114, -8642.91911974949, -1658.9134861801667, -2782.387431946388, -7983.263103239179, -4803.113271429565, -7105.509131420501, -6608.895251158367, -7695.344797167546, -1058.8158893960733, -827.8360308964271, -6033.519274531157, -7376.80733580481, -2390.9694391599187, -3535.532435342385, -7060.805099672239, -5826.259978861569, -4266.756367891146, -8211.439774351002, -23.13645081753867, -3.563011655788222, -7668.361050309395, -10772.961525974291, -10138.995021807183, -3045.4138626955832, -6120.862184627173, -6412.855804189922, -4253.267903338374, -6688.920283748896, -10039.31650416287, -2599.052682598598, -6348.95665585189, -5425.378099956249, -9823.282885200204, -9192.098111964206, -644.6208679739635, -2126.0496491035815, -833.2004617749342, -1740.0929912742595, -6251.638159838049, -6944.368634713116, -10256.357605591895, -4449.754616294497, -4931.296714357019, -9078.231808373746, -7328.777464869158, -6088.20189666052, -6675.943701724072, -3606.3745410016318, -8621.309461169229, -3195.196172916328, -7689.475622366598, -7033.610171905954, -9589.690342965383, -6593.322080576527, -7463.310396912287, -7638.833031307227, -6578.390526262493, -5594.381939943727, -1165.596116396698, -231.26982009359523, -5236.57414685261, -2392.3877182584847, -9801.84528430601, -8656.76656608722, -8687.41424241133, -7598.86295530462, -4957.215582452412, -6569.065050793831, -5370.147093588859, -4014.762683007824, -7872.03607729642, -8066.713978218618, -2077.3961614583845, -7852.212544545468, -11547.634697350708, -2654.8727475061173, -6296.222697641584, -6095.333884375917, -7414.857537007253, -7424.116587823306, -8003.754785396883, -10712.38447941832, -8799.233465149216, -5220.759215144568, -6964.550919570642, -4686.304044405012, -7759.592608606245, -5540.864910700052, -8248.523071233078, -3507.0381598976146, -5599.529326449336, -3609.6037514243153, -4024.986582877903, -5802.773130520824, -2886.4394530499326, -6738.027753257708, -4828.648112156306, -5064.602236538761, -6682.609493960867, -5507.905782414126, -7225.4589259029135, -1159.0243533970738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963995294301844, "mean_inference_ms": 0.9641448065996644, "mean_action_processing_ms": 0.1664859724135125, "mean_env_wait_ms": 0.05076002726813926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003423333168029785, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06554150581359863}, "num_episodes": 20, "episode_return_max": -23.13645081753867, "episode_return_min": -11855.45189330281, "episode_return_mean": -6803.596829743558}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.0435845816936, "num_env_steps_trained_throughput_per_sec": 550.0435845816936, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 7298.433, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7298.401, "sample_time_ms": 738.131, "learn_time_ms": 6548.652, "learn_throughput": 610.813, "synch_weights_time_ms": 11.077}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "training_iteration": 131, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-44", "timestamp": 1723232564, "time_this_iter_s": 7.276863098144531, "time_total_s": 978.6676712036133, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31804c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 978.6676712036133, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 24.772727272727273, "ram_util_percent": 81.32727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2070.2362307230633, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 352.9756606578827, "policy_loss": 0.009750502188884033, "vf_loss": 9.982651564478875, "vf_explained_var": -6.747723867495855e-05, "kl": 0.01788690337901547, "entropy": 1.456808323164781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9778931278242636, "cur_kl_coeff": 0.5695312499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987876436950037, "policy_loss": -0.004523850204275241, "vf_loss": 9.98811058266453, "vf_explained_var": -0.0030492212406541936, "kl": 0.00753205852243044, "entropy": 1.2108255667661232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": -23.13645081753867, "episode_reward_min": -11855.45189330281, "episode_reward_mean": -6770.470806496275, "episode_len_mean": 179.92, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17992, "policy_reward_min": {"agent_policy": 3.563011655788222, "adversary_policy": -11737.776741198328}, "policy_reward_max": {"agent_policy": 11394.99521421219, "adversary_policy": -3.563011655788222}, "policy_reward_mean": {"agent_policy": 4212.048557545143, "adversary_policy": -5491.259682020708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6603.443920267753, -6377.437113685166, -4561.637563350228, -9982.79585327354, -5663.438959900288, -6612.902808516999, -11855.45189330281, -7258.697328553434, -8517.325906947613, -4504.651470762608, -10469.047941455901, -5842.712689565628, -10888.260598835823, -7197.063286397162, -7191.737774205522, -6298.673042045741, -6083.509593238747, -5515.334184657566, -410.3906840654908, -751.0311653455182, -9371.67237249115, -6470.777580154592, -7302.189507900595, -10575.57225871174, -7830.493206714114, -8642.91911974949, -7985.737948056364, -7235.813210209007, -7791.906662759069, -1329.892242423653, -7872.919662777839, -3775.760591997889, -7060.8050996722395, -8211.439774351002, -23.13645081753867, -10772.961525974291, -10138.995021807183, -6501.137537246694, -6688.920283748897, -10039.31650416287, -6365.516600054703, -9824.831286267292, -2126.0496491035815, -1878.0761158232558, -8039.520932041817, -10256.357605591895, -9078.231808373746, -7491.87328191578, -6675.943701724072, -8621.309461169229, -7696.413142746667, -9589.690342965387, -8148.7034727939235, -6767.409599302405, -1165.5961163966988, -5381.371983103171, -10020.598161898919, -8695.500510121996, -6800.603471312561, -6132.840674813489, -8433.461952914351, -7852.212544545468, -11547.634697350706, -6706.853823392418, -7667.020499592752, -10712.38447941832, -8800.082843645452, -6965.209478295457, -7918.0486098914425, -8260.010585541353, -6261.813320559306, -5802.773130520824, -6738.027753257708, -5345.650656987291, -6756.526582714553, -7246.784922242516, -8505.22971068838, -4369.044599662531, -8313.678210713686, -5954.025058217315, -386.1961017158791, -8590.590561241286, -8678.080181472184, -6565.072354198463, -710.7727920442868, -4757.479402234326, -8209.367053820311, -515.8091006377307, -8386.451371646543, -8381.052764283286, -8880.953004957206, -502.39716357259994, -537.0369795239783, -5930.887415264668, -10355.36662576825, -6000.484554293225, -6124.429256351658, -6118.693810821928, -3367.5465914968013, -4927.591846510703], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 22, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 75, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 92, 66, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 127, 37, 200, 200, 200, 18, 200, 200, 36, 200, 200, 200, 27, 61, 200, 200, 200, 200, 200, 156, 200], "policy_agent_policy_reward": [2617.4185029498167, 1850.526179728108, 2281.475632879437, 8545.015840919828, 3436.413035838521, 5795.437815452143, 11394.99521421219, 6507.734146741674, 5421.735481387184, 2234.0402194181293, 4792.85335798713, 1454.9068216588946, 4220.235547685437, 3053.630439897865, 3253.8520220568876, 4361.68612836205, 5000.005125004158, 2880.435181767595, 201.96043070774328, 192.2989318254556, 7454.149218177928, 5083.6737662961295, 5635.623890186985, 8603.155256923375, 3443.2231179610253, 1658.9134861801667, 2779.912587129202, 4672.809192641061, 6512.333385566843, 556.7596778688478, 5537.406947558123, 2150.7412825044125, 5826.259978861569, 4266.756367891146, 3.563011655788222, 7668.361050309395, 3045.4138626955832, 6032.5804515703985, 4253.267903338374, 2599.052682598598, 5408.818155753436, 9190.549710897118, 644.6208679739635, 695.2173372259379, 5156.485862509352, 4449.754616294497, 4931.296714357019, 5925.106079613899, 3606.3745410016318, 3195.196172916328, 7026.672651525887, 6593.322080576527, 6953.439955425592, 5405.362866903814, 231.26982009359523, 2247.589882007924, 8438.013688494304, 7590.77668759396, 4725.677161933675, 3252.0691017831946, 7505.288102600689, 2077.3961614583845, 2654.8727475061173, 5684.702758625082, 7171.953625237808, 8003.754785396883, 5219.90983664833, 4685.645485680196, 5382.408909414857, 3495.550645589338, 2947.319757314345, 4024.986582877903, 2886.4394530499326, 4547.599691707775, 5433.988693660439, 1137.698357057471, 6287.506874541672, 2149.4935978225335, 7658.521941509278, 773.9511716872721, 246.1880350706352, 5105.885716234498, 3668.0445637663065, 2739.3245645496277, 64.0222213338875, 4515.193669891804, 5310.509410376049, 202.50418273402087, 4567.723434873323, 7051.880695602049, 4869.870937986114, 194.94239083308275, 408.7357565097894, 4375.152270225383, 8474.605199501348, 2554.03035394899, 4505.00425594457, 5111.018297502077, 1391.2713191350056, 3171.732169832579], "policy_adversary_policy_reward": [-6284.298557967053, -2936.5638652505177, -1857.5047298621323, -6370.458563551142, -2501.8055987948087, -4341.307597434858, -8545.015840919828, -9982.79585327354, -5663.438959900287, -3436.413035838521, -6487.038598262424, -5921.302025706716, -11512.67036631667, -11737.776741198328, -7241.701509151176, -6524.729966143933, -8517.325906947613, -5421.735481387184, -2403.415580243433, -4335.276109937305, -4792.85335798713, -10469.047941455901, -5390.98079712503, -1906.6387140994952, -4220.235547685437, -10888.260598835823, -7197.0632863971605, -3053.630439897865, -6920.503749076934, -3525.086047185475, -5956.2335418135035, -4704.125628594288, -5425.440318961256, -5658.074399281649, -2887.746412006172, -5508.022954418989, -201.96043070774328, -410.3906840654908, -751.031165345518, -192.2989318254556, -9371.67237249115, -7454.149218177928, -6410.107890292165, -5144.343456158559, -5635.623890186985, -7302.189507900595, -10575.572258711738, -8603.155256923375, -3443.2231179610253, -7830.493206714114, -8642.91911974949, -1658.9134861801667, -2782.387431946388, -7983.263103239179, -4803.113271429565, -7105.509131420501, -6608.895251158367, -7695.344797167546, -1058.8158893960733, -827.8360308964271, -6033.519274531157, -7376.80733580481, -2390.9694391599187, -3535.532435342385, -7060.805099672239, -5826.259978861569, -4266.756367891146, -8211.439774351002, -23.13645081753867, -3.563011655788222, -7668.361050309395, -10772.961525974291, -10138.995021807183, -3045.4138626955832, -6120.862184627173, -6412.855804189922, -4253.267903338374, -6688.920283748896, -10039.31650416287, -2599.052682598598, -6348.95665585189, -5425.378099956249, -9823.282885200204, -9192.098111964206, -644.6208679739635, -2126.0496491035815, -833.2004617749342, -1740.0929912742595, -6251.638159838049, -6944.368634713116, -10256.357605591895, -4449.754616294497, -4931.296714357019, -9078.231808373746, -7328.777464869158, -6088.20189666052, -6675.943701724072, -3606.3745410016318, -8621.309461169229, -3195.196172916328, -7689.475622366598, -7033.610171905954, -9589.690342965383, -6593.322080576527, -7463.310396912287, -7638.833031307227, -6578.390526262493, -5594.381939943727, -1165.596116396698, -231.26982009359523, -5236.57414685261, -2392.3877182584847, -9801.84528430601, -8656.76656608722, -8687.41424241133, -7598.86295530462, -4957.215582452412, -6569.065050793831, -5370.147093588859, -4014.762683007824, -7872.03607729642, -8066.713978218618, -2077.3961614583845, -7852.212544545468, -11547.634697350708, -2654.8727475061173, -6296.222697641584, -6095.333884375917, -7414.857537007253, -7424.116587823306, -8003.754785396883, -10712.38447941832, -8799.233465149216, -5220.759215144568, -6964.550919570642, -4686.304044405012, -7759.592608606245, -5540.864910700052, -8248.523071233078, -3507.0381598976146, -5599.529326449336, -3609.6037514243153, -4024.986582877903, -5802.773130520824, -2886.4394530499326, -6738.027753257708, -4828.648112156306, -5064.602236538761, -6682.609493960867, -5507.905782414126, -7225.4589259029135, -1159.0243533970738, -6330.607766266717, -8462.128818963336, -3474.8114750836216, -3043.7267224014363, -7775.993364106697, -8196.206788116266, -5954.025058217314, -773.9511716872721, -305.64639043113027, -326.737746355384, -5105.885716234498, -8590.590561241286, -3728.813966619443, -8617.310778619047, -2739.3245645496277, -6565.072354198463, -710.772792044287, -64.0222213338875, -4586.150067705821, -4686.523004420308, -5613.40991316346, -7906.466551032898, -515.8091006377307, -202.50418273402087, -4567.723434873323, -8386.451371646543, -7051.880695602049, -8381.052764283286, -8879.345497898634, -4871.478445044686, -194.94239083308275, -502.39716357259994, -507.9028361326508, -437.8698999011171, -5078.10299728679, -5227.936688203268, -10323.072376639551, -8506.899448630049, -6000.484554293224, -2554.03035394899, -5315.896050887123, -5313.5374614091, -5349.425684666204, -5880.286423657804, -3060.073998890427, -1698.74391174138, -4862.240314921017, -3237.083701422265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963778215089367, "mean_inference_ms": 0.9629959303628314, "mean_action_processing_ms": 0.1664469574286134, "mean_env_wait_ms": 0.05077379316850788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003423452377319336, "StateBufferConnector_ms": 0.0026246309280395508, "ViewRequirementAgentConnector_ms": 0.06745338439941406}, "num_episodes": 24, "episode_return_max": -23.13645081753867, "episode_return_min": -11855.45189330281, "episode_return_mean": -6770.470806496275}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.7438951742726, "num_env_steps_trained_throughput_per_sec": 550.7438951742726, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 7308.712, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7308.68, "sample_time_ms": 742.601, "learn_time_ms": 6554.596, "learn_throughput": 610.259, "synch_weights_time_ms": 10.996}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 132, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-51", "timestamp": 1723232571, "time_this_iter_s": 7.266956806182861, "time_total_s": 985.9346280097961, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3119f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 985.9346280097961, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 23.96, "ram_util_percent": 81.31999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2160.234623336792, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 364.9095991690954, "policy_loss": -0.0009991536300124912, "vf_loss": 9.981706603368123, "vf_explained_var": -0.00013813761373360952, "kl": 0.018509879509413924, "entropy": 1.445936260248224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.964068291821177, "cur_kl_coeff": 0.5695312499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98734175818307, "policy_loss": -0.004603202837253255, "vf_loss": 9.9881159378738, "vf_explained_var": -0.00030266497500989803, "kl": 0.006723111143789043, "entropy": 1.1950201479846208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "env_runners": {"episode_reward_max": -23.13645081753867, "episode_reward_min": -12231.376890308264, "episode_reward_mean": -6729.784418115445, "episode_len_mean": 176.48, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17648, "policy_reward_min": {"agent_policy": 3.563011655788222, "adversary_policy": -12231.376890308266}, "policy_reward_max": {"agent_policy": 9190.549710897118, "adversary_policy": -3.563011655788222}, "policy_reward_mean": {"agent_policy": 4176.521554896033, "adversary_policy": -5453.152986505738}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7830.493206714114, -8642.91911974949, -7985.737948056364, -7235.813210209007, -7791.906662759069, -1329.892242423653, -7872.919662777839, -3775.760591997889, -7060.8050996722395, -8211.439774351002, -23.13645081753867, -10772.961525974291, -10138.995021807183, -6501.137537246694, -6688.920283748897, -10039.31650416287, -6365.516600054703, -9824.831286267292, -2126.0496491035815, -1878.0761158232558, -8039.520932041817, -10256.357605591895, -9078.231808373746, -7491.87328191578, -6675.943701724072, -8621.309461169229, -7696.413142746667, -9589.690342965387, -8148.7034727939235, -6767.409599302405, -1165.5961163966988, -5381.371983103171, -10020.598161898919, -8695.500510121996, -6800.603471312561, -6132.840674813489, -8433.461952914351, -7852.212544545468, -11547.634697350706, -6706.853823392418, -7667.020499592752, -10712.38447941832, -8800.082843645452, -6965.209478295457, -7918.0486098914425, -8260.010585541353, -6261.813320559306, -5802.773130520824, -6738.027753257708, -5345.650656987291, -6756.526582714553, -7246.784922242516, -8505.22971068838, -4369.044599662531, -8313.678210713686, -5954.025058217315, -386.1961017158791, -8590.590561241286, -8678.080181472184, -6565.072354198463, -710.7727920442868, -4757.479402234326, -8209.367053820311, -515.8091006377307, -8386.451371646543, -8381.052764283286, -8880.953004957206, -502.39716357259994, -537.0369795239783, -5930.887415264668, -10355.36662576825, -6000.484554293225, -6124.429256351658, -6118.693810821928, -3367.5465914968013, -4927.591846510703, -12231.376890308264, -7759.654836595875, -9147.61615990857, -5335.077237925056, -9678.616527683049, -1372.1574864069291, -1488.8746148394976, -9267.005923012402, -8651.15532076778, -10351.730152637347, -6884.213592335091, -2356.6055297967196, -7726.676640404527, -8066.9470094922235, -3958.569835121511, -5432.968561710579, -2401.943056912687, -6934.153203750485, -4724.702876601443, -6757.946538623824, -5348.806668256516, -7550.295165032919, -10334.885044854682, -8475.137786570484], "episode_lengths": [200, 200, 200, 200, 200, 75, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 92, 66, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 127, 37, 200, 200, 200, 18, 200, 200, 36, 200, 200, 200, 27, 61, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 32, 64, 200, 200, 200, 200, 70, 200, 200, 131, 126, 90, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3443.2231179610253, 1658.9134861801667, 2779.912587129202, 4672.809192641061, 6512.333385566843, 556.7596778688478, 5537.406947558123, 2150.7412825044125, 5826.259978861569, 4266.756367891146, 3.563011655788222, 7668.361050309395, 3045.4138626955832, 6032.5804515703985, 4253.267903338374, 2599.052682598598, 5408.818155753436, 9190.549710897118, 644.6208679739635, 695.2173372259379, 5156.485862509352, 4449.754616294497, 4931.296714357019, 5925.106079613899, 3606.3745410016318, 3195.196172916328, 7026.672651525887, 6593.322080576527, 6953.439955425592, 5405.362866903814, 231.26982009359523, 2247.589882007924, 8438.013688494304, 7590.77668759396, 4725.677161933675, 3252.0691017831946, 7505.288102600689, 2077.3961614583845, 2654.8727475061173, 5684.702758625082, 7171.953625237808, 8003.754785396883, 5219.90983664833, 4685.645485680196, 5382.408909414857, 3495.550645589338, 2947.319757314345, 4024.986582877903, 2886.4394530499326, 4547.599691707775, 5433.988693660439, 1137.698357057471, 6287.506874541672, 2149.4935978225335, 7658.521941509278, 773.9511716872721, 246.1880350706352, 5105.885716234498, 3668.0445637663065, 2739.3245645496277, 64.0222213338875, 4515.193669891804, 5310.509410376049, 202.50418273402087, 4567.723434873323, 7051.880695602049, 4869.870937986114, 194.94239083308275, 408.7357565097894, 4375.152270225383, 8474.605199501348, 2554.03035394899, 4505.00425594457, 5111.018297502077, 1391.2713191350056, 3171.732169832579, 8744.209589468706, 5479.342528239922, 7165.193592480665, 3310.663160133248, 4073.18685601922, 213.00754095176703, 623.2623068781182, 7994.09302037658, 4599.15250521221, 4583.732888802015, 3549.2062866692686, 1168.1986709776409, 3994.2655737030577, 5091.90443736124, 1439.7682672155772, 1477.7927389594704, 1272.9844494216266, 4754.100327232872, 3675.0597090904157, 6142.092141229829, 3924.682909738291, 6205.306468497908, 8157.45210049759, 5081.899853996417], "policy_adversary_policy_reward": [-3443.2231179610253, -7830.493206714114, -8642.91911974949, -1658.9134861801667, -2782.387431946388, -7983.263103239179, -4803.113271429565, -7105.509131420501, -6608.895251158367, -7695.344797167546, -1058.8158893960733, -827.8360308964271, -6033.519274531157, -7376.80733580481, -2390.9694391599187, -3535.532435342385, -7060.805099672239, -5826.259978861569, -4266.756367891146, -8211.439774351002, -23.13645081753867, -3.563011655788222, -7668.361050309395, -10772.961525974291, -10138.995021807183, -3045.4138626955832, -6120.862184627173, -6412.855804189922, -4253.267903338374, -6688.920283748896, -10039.31650416287, -2599.052682598598, -6348.95665585189, -5425.378099956249, -9823.282885200204, -9192.098111964206, -644.6208679739635, -2126.0496491035815, -833.2004617749342, -1740.0929912742595, -6251.638159838049, -6944.368634713116, -10256.357605591895, -4449.754616294497, -4931.296714357019, -9078.231808373746, -7328.777464869158, -6088.20189666052, -6675.943701724072, -3606.3745410016318, -8621.309461169229, -3195.196172916328, -7689.475622366598, -7033.610171905954, -9589.690342965383, -6593.322080576527, -7463.310396912287, -7638.833031307227, -6578.390526262493, -5594.381939943727, -1165.596116396698, -231.26982009359523, -5236.57414685261, -2392.3877182584847, -9801.84528430601, -8656.76656608722, -8687.41424241133, -7598.86295530462, -4957.215582452412, -6569.065050793831, -5370.147093588859, -4014.762683007824, -7872.03607729642, -8066.713978218618, -2077.3961614583845, -7852.212544545468, -11547.634697350708, -2654.8727475061173, -6296.222697641584, -6095.333884375917, -7414.857537007253, -7424.116587823306, -8003.754785396883, -10712.38447941832, -8799.233465149216, -5220.759215144568, -6964.550919570642, -4686.304044405012, -7759.592608606245, -5540.864910700052, -8248.523071233078, -3507.0381598976146, -5599.529326449336, -3609.6037514243153, -4024.986582877903, -5802.773130520824, -2886.4394530499326, -6738.027753257708, -4828.648112156306, -5064.602236538761, -6682.609493960867, -5507.905782414126, -7225.4589259029135, -1159.0243533970738, -6330.607766266717, -8462.128818963336, -3474.8114750836216, -3043.7267224014363, -7775.993364106697, -8196.206788116266, -5954.025058217314, -773.9511716872721, -305.64639043113027, -326.737746355384, -5105.885716234498, -8590.590561241286, -3728.813966619443, -8617.310778619047, -2739.3245645496277, -6565.072354198463, -710.772792044287, -64.0222213338875, -4586.150067705821, -4686.523004420308, -5613.40991316346, -7906.466551032898, -515.8091006377307, -202.50418273402087, -4567.723434873323, -8386.451371646543, -7051.880695602049, -8381.052764283286, -8879.345497898634, -4871.478445044686, -194.94239083308275, -502.39716357259994, -507.9028361326508, -437.8698999011171, -5078.10299728679, -5227.936688203268, -10323.072376639551, -8506.899448630049, -6000.484554293224, -2554.03035394899, -5315.896050887123, -5313.5374614091, -5349.425684666204, -5880.286423657804, -3060.073998890427, -1698.74391174138, -4862.240314921017, -3237.083701422265, -8744.209589468706, -12231.376890308266, -7555.647200221119, -5683.350164614678, -7165.193592480665, -9147.61615990857, -3463.309514292022, -5182.4308837662875, -4073.18685601922, -9678.61652768305, -213.00754095176703, -1372.1574864069291, -626.1584577299797, -1485.9784639876364, -8584.236476894912, -8676.862466494065, -4599.15250521221, -8651.15532076778, -10351.730152637343, -4583.732888802015, -3549.2062866692686, -6884.213592335091, -2356.6055297967196, -1168.1986709776409, -3994.2655737030577, -7726.676640404527, -6460.166798077092, -6698.684648776374, -2297.3576020531527, -3100.980500283934, -5377.781791965674, -1532.9795087043751, -2399.788008620877, -1275.1394977134364, -6934.153203750486, -4754.100327232872, -4127.147041754294, -4272.615543937565, -6741.575619345323, -6158.463060508331, -5148.770254151055, -4124.719323843753, -6444.547995089213, -7311.053638441615, -10334.88504485468, -8157.45210049759, -5081.899853996417, -8475.137786570484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39626840435620336, "mean_inference_ms": 0.9637656090911658, "mean_action_processing_ms": 0.16633907009908358, "mean_env_wait_ms": 0.05073048642960989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033801794052124023, "StateBufferConnector_ms": 0.0025213956832885742, "ViewRequirementAgentConnector_ms": 0.0669407844543457}, "num_episodes": 24, "episode_return_max": -23.13645081753867, "episode_return_min": -12231.376890308264, "episode_return_mean": -6729.784418115445}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.8704778225316, "num_env_steps_trained_throughput_per_sec": 557.8704778225316, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 7284.956, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7284.924, "sample_time_ms": 743.652, "learn_time_ms": 6529.498, "learn_throughput": 612.605, "synch_weights_time_ms": 11.291}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "training_iteration": 133, "trial_id": "3439d_00000", "date": "2024-08-09_15-42-58", "timestamp": 1723232578, "time_this_iter_s": 7.175748825073242, "time_total_s": 993.1103768348694, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3180820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 993.1103768348694, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 23.49090909090909, "ram_util_percent": 81.25454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2074.8759174187976, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 311.0527014017105, "policy_loss": 0.0055107971755205655, "vf_loss": 9.99411684970061, "vf_explained_var": -6.471245239178339e-05, "kl": 0.015700204314392372, "entropy": 1.4181423883885145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9575334479411443, "cur_kl_coeff": 0.5695312499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994641189978868, "policy_loss": -0.0035073696384354245, "vf_loss": 9.995350089401164, "vf_explained_var": -0.0003525110148878955, "kl": 0.004913650606463235, "entropy": 1.1846081016555665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": -386.1961017158791, "episode_reward_min": -12231.376890308264, "episode_reward_mean": -7049.331649747652, "episode_len_mean": 181.52, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18152, "policy_reward_min": {"agent_policy": 64.0222213338875, "adversary_policy": -12231.376890308266}, "policy_reward_max": {"agent_policy": 9712.665236425064, "adversary_policy": -64.0222213338875}, "policy_reward_mean": {"agent_policy": 4522.373532845839, "adversary_policy": -5785.852591296744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10256.357605591895, -9078.231808373746, -7491.87328191578, -6675.943701724072, -8621.309461169229, -7696.413142746667, -9589.690342965387, -8148.7034727939235, -6767.409599302405, -1165.5961163966988, -5381.371983103171, -10020.598161898919, -8695.500510121996, -6800.603471312561, -6132.840674813489, -8433.461952914351, -7852.212544545468, -11547.634697350706, -6706.853823392418, -7667.020499592752, -10712.38447941832, -8800.082843645452, -6965.209478295457, -7918.0486098914425, -8260.010585541353, -6261.813320559306, -5802.773130520824, -6738.027753257708, -5345.650656987291, -6756.526582714553, -7246.784922242516, -8505.22971068838, -4369.044599662531, -8313.678210713686, -5954.025058217315, -386.1961017158791, -8590.590561241286, -8678.080181472184, -6565.072354198463, -710.7727920442868, -4757.479402234326, -8209.367053820311, -515.8091006377307, -8386.451371646543, -8381.052764283286, -8880.953004957206, -502.39716357259994, -537.0369795239783, -5930.887415264668, -10355.36662576825, -6000.484554293225, -6124.429256351658, -6118.693810821928, -3367.5465914968013, -4927.591846510703, -12231.376890308264, -7759.654836595875, -9147.61615990857, -5335.077237925056, -9678.616527683049, -1372.1574864069291, -1488.8746148394976, -9267.005923012402, -8651.15532076778, -10351.730152637347, -6884.213592335091, -2356.6055297967196, -7726.676640404527, -8066.9470094922235, -3958.569835121511, -5432.968561710579, -2401.943056912687, -6934.153203750485, -4724.702876601443, -6757.946538623824, -5348.806668256516, -7550.295165032919, -10334.885044854682, -8475.137786570484, -7881.847955358285, -6456.4348852451785, -10440.613927841645, -8246.056264362584, -6401.79936545852, -10053.572792039784, -8586.101461676422, -10275.44196073705, -5843.349153525708, -7235.775211725187, -5313.578220673957, -9901.039997789814, -9436.526520922109, -5975.541370188605, -9110.11641013386, -7581.5706637787725, -6112.3019845600365, -10240.559569038296, -8926.223083677545, -6819.463934884128, -11252.957855362034], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 127, 37, 200, 200, 200, 18, 200, 200, 36, 200, 200, 200, 27, 61, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 32, 64, 200, 200, 200, 200, 70, 200, 200, 131, 126, 90, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 150, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4449.754616294497, 4931.296714357019, 5925.106079613899, 3606.3745410016318, 3195.196172916328, 7026.672651525887, 6593.322080576527, 6953.439955425592, 5405.362866903814, 231.26982009359523, 2247.589882007924, 8438.013688494304, 7590.77668759396, 4725.677161933675, 3252.0691017831946, 7505.288102600689, 2077.3961614583845, 2654.8727475061173, 5684.702758625082, 7171.953625237808, 8003.754785396883, 5219.90983664833, 4685.645485680196, 5382.408909414857, 3495.550645589338, 2947.319757314345, 4024.986582877903, 2886.4394530499326, 4547.599691707775, 5433.988693660439, 1137.698357057471, 6287.506874541672, 2149.4935978225335, 7658.521941509278, 773.9511716872721, 246.1880350706352, 5105.885716234498, 3668.0445637663065, 2739.3245645496277, 64.0222213338875, 4515.193669891804, 5310.509410376049, 202.50418273402087, 4567.723434873323, 7051.880695602049, 4869.870937986114, 194.94239083308275, 408.7357565097894, 4375.152270225383, 8474.605199501348, 2554.03035394899, 4505.00425594457, 5111.018297502077, 1391.2713191350056, 3171.732169832579, 8744.209589468706, 5479.342528239922, 7165.193592480665, 3310.663160133248, 4073.18685601922, 213.00754095176703, 623.2623068781182, 7994.09302037658, 4599.15250521221, 4583.732888802015, 3549.2062866692686, 1168.1986709776409, 3994.2655737030577, 5091.90443736124, 1439.7682672155772, 1477.7927389594704, 1272.9844494216266, 4754.100327232872, 3675.0597090904157, 6142.092141229829, 3924.682909738291, 6205.306468497908, 8157.45210049759, 5081.899853996417, 5779.822535002155, 2269.1167953840745, 9712.665236425064, 3197.30580576377, 4826.240423721742, 5610.789812392726, 5379.627179234541, 8121.443030579913, 1789.6750541034564, 3735.2529425239886, 4655.950909813269, 7417.143008326624, 8480.139499696235, 2869.992575228891, 6331.4452843152585, 2465.155644602263, 4021.9525217284136, 8622.487822256742, 7179.719716652044, 4575.178105326909, 9647.140812592801], "policy_adversary_policy_reward": [-10256.357605591895, -4449.754616294497, -4931.296714357019, -9078.231808373746, -7328.777464869158, -6088.20189666052, -6675.943701724072, -3606.3745410016318, -8621.309461169229, -3195.196172916328, -7689.475622366598, -7033.610171905954, -9589.690342965383, -6593.322080576527, -7463.310396912287, -7638.833031307227, -6578.390526262493, -5594.381939943727, -1165.596116396698, -231.26982009359523, -5236.57414685261, -2392.3877182584847, -9801.84528430601, -8656.76656608722, -8687.41424241133, -7598.86295530462, -4957.215582452412, -6569.065050793831, -5370.147093588859, -4014.762683007824, -7872.03607729642, -8066.713978218618, -2077.3961614583845, -7852.212544545468, -11547.634697350708, -2654.8727475061173, -6296.222697641584, -6095.333884375917, -7414.857537007253, -7424.116587823306, -8003.754785396883, -10712.38447941832, -8799.233465149216, -5220.759215144568, -6964.550919570642, -4686.304044405012, -7759.592608606245, -5540.864910700052, -8248.523071233078, -3507.0381598976146, -5599.529326449336, -3609.6037514243153, -4024.986582877903, -5802.773130520824, -2886.4394530499326, -6738.027753257708, -4828.648112156306, -5064.602236538761, -6682.609493960867, -5507.905782414126, -7225.4589259029135, -1159.0243533970738, -6330.607766266717, -8462.128818963336, -3474.8114750836216, -3043.7267224014363, -7775.993364106697, -8196.206788116266, -5954.025058217314, -773.9511716872721, -305.64639043113027, -326.737746355384, -5105.885716234498, -8590.590561241286, -3728.813966619443, -8617.310778619047, -2739.3245645496277, -6565.072354198463, -710.772792044287, -64.0222213338875, -4586.150067705821, -4686.523004420308, -5613.40991316346, -7906.466551032898, -515.8091006377307, -202.50418273402087, -4567.723434873323, -8386.451371646543, -7051.880695602049, -8381.052764283286, -8879.345497898634, -4871.478445044686, -194.94239083308275, -502.39716357259994, -507.9028361326508, -437.8698999011171, -5078.10299728679, -5227.936688203268, -10323.072376639551, -8506.899448630049, -6000.484554293224, -2554.03035394899, -5315.896050887123, -5313.5374614091, -5349.425684666204, -5880.286423657804, -3060.073998890427, -1698.74391174138, -4862.240314921017, -3237.083701422265, -8744.209589468706, -12231.376890308266, -7555.647200221119, -5683.350164614678, -7165.193592480665, -9147.61615990857, -3463.309514292022, -5182.4308837662875, -4073.18685601922, -9678.61652768305, -213.00754095176703, -1372.1574864069291, -626.1584577299797, -1485.9784639876364, -8584.236476894912, -8676.862466494065, -4599.15250521221, -8651.15532076778, -10351.730152637343, -4583.732888802015, -3549.2062866692686, -6884.213592335091, -2356.6055297967196, -1168.1986709776409, -3994.2655737030577, -7726.676640404527, -6460.166798077092, -6698.684648776374, -2297.3576020531527, -3100.980500283934, -5377.781791965674, -1532.9795087043751, -2399.788008620877, -1275.1394977134364, -6934.153203750486, -4754.100327232872, -4127.147041754294, -4272.615543937565, -6741.575619345323, -6158.463060508331, -5148.770254151055, -4124.719323843753, -6444.547995089213, -7311.053638441615, -10334.88504485468, -8157.45210049759, -5081.899853996417, -8475.137786570484, -7881.847955358286, -5779.822535002155, -2269.1167953840745, -6456.4348852451785, -10236.826660968598, -9916.452503298115, -8246.056264362584, -3197.30580576377, -6112.569763392851, -5115.470025787415, -10053.572792039784, -5610.789812392726, -8586.101461676424, -5379.627179234541, -8121.443030579913, -10275.44196073705, -2065.427040506432, -5567.597167122733, -3897.3438172796773, -7073.684336969499, -4685.546592607935, -5283.982537879295, -7417.143008326624, -9901.039997789814, -9234.770775246585, -8681.895245371756, -5969.17971763664, -2876.354227780856, -6331.4452843152585, -9110.11641013386, -7380.715164528669, -2666.0111438523672, -6112.301984560037, -4021.9525217284136, -8683.234928742495, -10179.812462552543, -7179.719716652044, -8926.223083677545, -5320.814119657431, -6073.827920553604, -11252.696449186868, -9647.402218767967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3961477437874932, "mean_inference_ms": 0.9617687447395323, "mean_action_processing_ms": 0.1662846528880701, "mean_env_wait_ms": 0.0507542033283689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003306269645690918, "StateBufferConnector_ms": 0.0024585723876953125, "ViewRequirementAgentConnector_ms": 0.06593537330627441}, "num_episodes": 21, "episode_return_max": -386.1961017158791, "episode_return_min": -12231.376890308264, "episode_return_mean": -7049.331649747652}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.7899791367315, "num_env_steps_trained_throughput_per_sec": 544.7899791367315, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 7295.011, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7294.979, "sample_time_ms": 760.933, "learn_time_ms": 6522.552, "learn_throughput": 613.257, "synch_weights_time_ms": 11.049}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 134, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-06", "timestamp": 1723232586, "time_this_iter_s": 7.347198963165283, "time_total_s": 1000.4575757980347, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3180e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1000.4575757980347, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 25.770000000000003, "ram_util_percent": 81.01}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1947.5785817305248, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 328.9123430808385, "policy_loss": 0.013858152310664689, "vf_loss": 9.99100863834222, "vf_explained_var": 3.789147982994715e-05, "kl": 0.016631328410827942, "entropy": 1.403604560593764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.961787084423045, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99146107971353, "policy_loss": -0.005944759650993599, "vf_loss": 9.995130603023307, "vf_explained_var": -0.00034372506949005934, "kl": 0.007989893806605506, "entropy": 1.1962282036347365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "env_runners": {"episode_reward_max": -386.1961017158791, "episode_reward_min": -12977.369088861511, "episode_reward_mean": -7126.16361184337, "episode_len_mean": 181.81, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18181, "policy_reward_min": {"agent_policy": 64.0222213338875, "adversary_policy": -12977.369088861513}, "policy_reward_max": {"agent_policy": 9712.665236425064, "adversary_policy": -64.0222213338875}, "policy_reward_mean": {"agent_policy": 4540.0325415699945, "adversary_policy": -5833.098076706682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8800.082843645452, -6965.209478295457, -7918.0486098914425, -8260.010585541353, -6261.813320559306, -5802.773130520824, -6738.027753257708, -5345.650656987291, -6756.526582714553, -7246.784922242516, -8505.22971068838, -4369.044599662531, -8313.678210713686, -5954.025058217315, -386.1961017158791, -8590.590561241286, -8678.080181472184, -6565.072354198463, -710.7727920442868, -4757.479402234326, -8209.367053820311, -515.8091006377307, -8386.451371646543, -8381.052764283286, -8880.953004957206, -502.39716357259994, -537.0369795239783, -5930.887415264668, -10355.36662576825, -6000.484554293225, -6124.429256351658, -6118.693810821928, -3367.5465914968013, -4927.591846510703, -12231.376890308264, -7759.654836595875, -9147.61615990857, -5335.077237925056, -9678.616527683049, -1372.1574864069291, -1488.8746148394976, -9267.005923012402, -8651.15532076778, -10351.730152637347, -6884.213592335091, -2356.6055297967196, -7726.676640404527, -8066.9470094922235, -3958.569835121511, -5432.968561710579, -2401.943056912687, -6934.153203750485, -4724.702876601443, -6757.946538623824, -5348.806668256516, -7550.295165032919, -10334.885044854682, -8475.137786570484, -7881.847955358285, -6456.4348852451785, -10440.613927841645, -8246.056264362584, -6401.79936545852, -10053.572792039784, -8586.101461676422, -10275.44196073705, -5843.349153525708, -7235.775211725187, -5313.578220673957, -9901.039997789814, -9436.526520922109, -5975.541370188605, -9110.11641013386, -7581.5706637787725, -6112.3019845600365, -10240.559569038296, -8926.223083677545, -6819.463934884128, -11252.957855362034, -9191.738274672962, -8191.751928833672, -4675.895946763841, -10121.152018263741, -6992.02192776672, -8718.493835654019, -3208.512776471115, -5689.37058990962, -7140.440370176595, -8039.8587970908275, -7586.118543423117, -8078.431829820172, -10146.236496381534, -8268.782412458502, -9248.698519966409, -8750.984920371584, -8802.31390316512, -7471.45704075432, -10909.151102063382, -8916.427218147066, -12977.369088861511], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 127, 37, 200, 200, 200, 18, 200, 200, 36, 200, 200, 200, 27, 61, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 32, 64, 200, 200, 200, 200, 70, 200, 200, 131, 126, 90, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 150, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 94, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200], "policy_agent_policy_reward": [5219.90983664833, 4685.645485680196, 5382.408909414857, 3495.550645589338, 2947.319757314345, 4024.986582877903, 2886.4394530499326, 4547.599691707775, 5433.988693660439, 1137.698357057471, 6287.506874541672, 2149.4935978225335, 7658.521941509278, 773.9511716872721, 246.1880350706352, 5105.885716234498, 3668.0445637663065, 2739.3245645496277, 64.0222213338875, 4515.193669891804, 5310.509410376049, 202.50418273402087, 4567.723434873323, 7051.880695602049, 4869.870937986114, 194.94239083308275, 408.7357565097894, 4375.152270225383, 8474.605199501348, 2554.03035394899, 4505.00425594457, 5111.018297502077, 1391.2713191350056, 3171.732169832579, 8744.209589468706, 5479.342528239922, 7165.193592480665, 3310.663160133248, 4073.18685601922, 213.00754095176703, 623.2623068781182, 7994.09302037658, 4599.15250521221, 4583.732888802015, 3549.2062866692686, 1168.1986709776409, 3994.2655737030577, 5091.90443736124, 1439.7682672155772, 1477.7927389594704, 1272.9844494216266, 4754.100327232872, 3675.0597090904157, 6142.092141229829, 3924.682909738291, 6205.306468497908, 8157.45210049759, 5081.899853996417, 5779.822535002155, 2269.1167953840745, 9712.665236425064, 3197.30580576377, 4826.240423721742, 5610.789812392726, 5379.627179234541, 8121.443030579913, 1789.6750541034564, 3735.2529425239886, 4655.950909813269, 7417.143008326624, 8480.139499696235, 2869.992575228891, 6331.4452843152585, 2465.155644602263, 4021.9525217284136, 8622.487822256742, 7179.719716652044, 4575.178105326909, 9647.140812592801, 4904.630634970944, 5286.438387102331, 4437.064624956455, 9238.571018864248, 2809.710654706453, 6591.792688520806, 811.855106319262, 4329.344662392405, 5655.870759744095, 5493.00281325488, 7162.017691990394, 6724.281647316959, 9638.546073356201, 1768.9669011862861, 3180.8775243732875, 5323.4094711664475, 6472.772319114851, 6419.563666772556, 8610.90487260507, 1163.1199561642838, 3413.049598884285], "policy_adversary_policy_reward": [-8799.233465149216, -5220.759215144568, -6964.550919570642, -4686.304044405012, -7759.592608606245, -5540.864910700052, -8248.523071233078, -3507.0381598976146, -5599.529326449336, -3609.6037514243153, -4024.986582877903, -5802.773130520824, -2886.4394530499326, -6738.027753257708, -4828.648112156306, -5064.602236538761, -6682.609493960867, -5507.905782414126, -7225.4589259029135, -1159.0243533970738, -6330.607766266717, -8462.128818963336, -3474.8114750836216, -3043.7267224014363, -7775.993364106697, -8196.206788116266, -5954.025058217314, -773.9511716872721, -305.64639043113027, -326.737746355384, -5105.885716234498, -8590.590561241286, -3728.813966619443, -8617.310778619047, -2739.3245645496277, -6565.072354198463, -710.772792044287, -64.0222213338875, -4586.150067705821, -4686.523004420308, -5613.40991316346, -7906.466551032898, -515.8091006377307, -202.50418273402087, -4567.723434873323, -8386.451371646543, -7051.880695602049, -8381.052764283286, -8879.345497898634, -4871.478445044686, -194.94239083308275, -502.39716357259994, -507.9028361326508, -437.8698999011171, -5078.10299728679, -5227.936688203268, -10323.072376639551, -8506.899448630049, -6000.484554293224, -2554.03035394899, -5315.896050887123, -5313.5374614091, -5349.425684666204, -5880.286423657804, -3060.073998890427, -1698.74391174138, -4862.240314921017, -3237.083701422265, -8744.209589468706, -12231.376890308266, -7555.647200221119, -5683.350164614678, -7165.193592480665, -9147.61615990857, -3463.309514292022, -5182.4308837662875, -4073.18685601922, -9678.61652768305, -213.00754095176703, -1372.1574864069291, -626.1584577299797, -1485.9784639876364, -8584.236476894912, -8676.862466494065, -4599.15250521221, -8651.15532076778, -10351.730152637343, -4583.732888802015, -3549.2062866692686, -6884.213592335091, -2356.6055297967196, -1168.1986709776409, -3994.2655737030577, -7726.676640404527, -6460.166798077092, -6698.684648776374, -2297.3576020531527, -3100.980500283934, -5377.781791965674, -1532.9795087043751, -2399.788008620877, -1275.1394977134364, -6934.153203750486, -4754.100327232872, -4127.147041754294, -4272.615543937565, -6741.575619345323, -6158.463060508331, -5148.770254151055, -4124.719323843753, -6444.547995089213, -7311.053638441615, -10334.88504485468, -8157.45210049759, -5081.899853996417, -8475.137786570484, -7881.847955358286, -5779.822535002155, -2269.1167953840745, -6456.4348852451785, -10236.826660968598, -9916.452503298115, -8246.056264362584, -3197.30580576377, -6112.569763392851, -5115.470025787415, -10053.572792039784, -5610.789812392726, -8586.101461676424, -5379.627179234541, -8121.443030579913, -10275.44196073705, -2065.427040506432, -5567.597167122733, -3897.3438172796773, -7073.684336969499, -4685.546592607935, -5283.982537879295, -7417.143008326624, -9901.039997789814, -9234.770775246585, -8681.895245371756, -5969.17971763664, -2876.354227780856, -6331.4452843152585, -9110.11641013386, -7380.715164528669, -2666.0111438523672, -6112.301984560037, -4021.9525217284136, -8683.234928742495, -10179.812462552543, -7179.719716652044, -8926.223083677545, -5320.814119657431, -6073.827920553604, -11252.696449186868, -9647.402218767967, -8525.059788598492, -5571.309121045418, -5286.438387102331, -8191.751928833673, -4548.601310893513, -4564.359260826784, -9876.954422934126, -9482.768614193858, -2809.710654706453, -6992.021927766719, -6591.792688520806, -8718.493835654019, -3132.8299927096623, -887.5378900807144, -4504.392730811792, -5514.322521490234, -7026.2142462747115, -5770.096883645979, -8039.8587970908275, -5493.00281325488, -7247.400185534327, -7500.736049879186, -7505.813562979629, -7296.899914157505, -10035.53476569192, -9749.247804045812, -8268.782412458504, -1768.9669011862861, -3180.8775243732875, -9248.698519966409, -8743.774233804628, -5330.620157733403, -8802.313903165123, -6472.772319114851, -7363.052058378248, -6527.968649148628, -8610.90487260507, -10909.151102063382, -1163.1199561642838, -8916.427218147066, -12977.369088861513, -3413.049598884285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39603936099910014, "mean_inference_ms": 0.9620357414333054, "mean_action_processing_ms": 0.16627922773997383, "mean_env_wait_ms": 0.05075055347550537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032607316970825195, "StateBufferConnector_ms": 0.0024275779724121094, "ViewRequirementAgentConnector_ms": 0.06644439697265625}, "num_episodes": 21, "episode_return_max": -386.1961017158791, "episode_return_min": -12977.369088861511, "episode_return_mean": -7126.16361184337}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.5817897089873, "num_env_steps_trained_throughput_per_sec": 541.5817897089873, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1620000, "timers": {"training_iteration_time_ms": 7297.65, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7297.617, "sample_time_ms": 752.544, "learn_time_ms": 6533.79, "learn_throughput": 612.202, "synch_weights_time_ms": 10.832}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "done": false, "training_iteration": 135, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-14", "timestamp": 1723232594, "time_this_iter_s": 7.390884160995483, "time_total_s": 1007.8484599590302, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327abf0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1007.8484599590302, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 26.44545454545454, "ram_util_percent": 81.26363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1980.8457403500875, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 354.2605406920115, "policy_loss": 0.009258749374809364, "vf_loss": 9.977134972810745, "vf_explained_var": -7.249849538008372e-06, "kl": 0.017954224372806492, "entropy": 1.36886138903598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9758586021327468, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9821060135251, "policy_loss": -0.00774700866800255, "vf_loss": 9.987537634309637, "vf_explained_var": -0.00016901010558718728, "kl": 0.008130919573848289, "entropy": 1.1820607651478399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": -15.914234881379489, "episode_reward_min": -12977.369088861511, "episode_reward_mean": -7212.855941278023, "episode_len_mean": 179.64, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 17964, "policy_reward_min": {"agent_policy": 0.6486922430072696, "adversary_policy": -12977.369088861513}, "policy_reward_max": {"agent_policy": 10276.59833052883, "adversary_policy": -0.6486922430072696}, "policy_reward_mean": {"agent_policy": 4566.9434535233895, "adversary_policy": -5889.899697400706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8209.367053820311, -515.8091006377307, -8386.451371646543, -8381.052764283286, -8880.953004957206, -502.39716357259994, -537.0369795239783, -5930.887415264668, -10355.36662576825, -6000.484554293225, -6124.429256351658, -6118.693810821928, -3367.5465914968013, -4927.591846510703, -12231.376890308264, -7759.654836595875, -9147.61615990857, -5335.077237925056, -9678.616527683049, -1372.1574864069291, -1488.8746148394976, -9267.005923012402, -8651.15532076778, -10351.730152637347, -6884.213592335091, -2356.6055297967196, -7726.676640404527, -8066.9470094922235, -3958.569835121511, -5432.968561710579, -2401.943056912687, -6934.153203750485, -4724.702876601443, -6757.946538623824, -5348.806668256516, -7550.295165032919, -10334.885044854682, -8475.137786570484, -7881.847955358285, -6456.4348852451785, -10440.613927841645, -8246.056264362584, -6401.79936545852, -10053.572792039784, -8586.101461676422, -10275.44196073705, -5843.349153525708, -7235.775211725187, -5313.578220673957, -9901.039997789814, -9436.526520922109, -5975.541370188605, -9110.11641013386, -7581.5706637787725, -6112.3019845600365, -10240.559569038296, -8926.223083677545, -6819.463934884128, -11252.957855362034, -9191.738274672962, -8191.751928833672, -4675.895946763841, -10121.152018263741, -6992.02192776672, -8718.493835654019, -3208.512776471115, -5689.37058990962, -7140.440370176595, -8039.8587970908275, -7586.118543423117, -8078.431829820172, -10146.236496381534, -8268.782412458502, -9248.698519966409, -8750.984920371584, -8802.31390316512, -7471.45704075432, -10909.151102063382, -8916.427218147066, -12977.369088861511, -3730.075332079198, -11634.494829460764, -6820.099159920978, -9970.246874828863, -5307.305197239243, -8856.227296171399, -5927.835281858628, -5508.556975975547, -8816.604008684992, -4673.825251063412, -5920.115136632675, -5335.430514710993, -7649.288348977958, -4887.594853498238, -15.914234881379489, -3631.5191298861473, -9606.33357682108, -10679.022073677124, -9871.12466617468, -6752.717056766342], "episode_lengths": [200, 36, 200, 200, 200, 27, 61, 200, 200, 200, 200, 200, 156, 200, 200, 200, 200, 200, 200, 32, 64, 200, 200, 200, 200, 70, 200, 200, 131, 126, 90, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 150, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 94, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 81, 200, 200, 200, 129, 200, 106, 200, 200, 142, 200, 200, 195, 200, 1, 111, 200, 200, 200, 200], "policy_agent_policy_reward": [5310.509410376049, 202.50418273402087, 4567.723434873323, 7051.880695602049, 4869.870937986114, 194.94239083308275, 408.7357565097894, 4375.152270225383, 8474.605199501348, 2554.03035394899, 4505.00425594457, 5111.018297502077, 1391.2713191350056, 3171.732169832579, 8744.209589468706, 5479.342528239922, 7165.193592480665, 3310.663160133248, 4073.18685601922, 213.00754095176703, 623.2623068781182, 7994.09302037658, 4599.15250521221, 4583.732888802015, 3549.2062866692686, 1168.1986709776409, 3994.2655737030577, 5091.90443736124, 1439.7682672155772, 1477.7927389594704, 1272.9844494216266, 4754.100327232872, 3675.0597090904157, 6142.092141229829, 3924.682909738291, 6205.306468497908, 8157.45210049759, 5081.899853996417, 5779.822535002155, 2269.1167953840745, 9712.665236425064, 3197.30580576377, 4826.240423721742, 5610.789812392726, 5379.627179234541, 8121.443030579913, 1789.6750541034564, 3735.2529425239886, 4655.950909813269, 7417.143008326624, 8480.139499696235, 2869.992575228891, 6331.4452843152585, 2465.155644602263, 4021.9525217284136, 8622.487822256742, 7179.719716652044, 4575.178105326909, 9647.140812592801, 4904.630634970944, 5286.438387102331, 4437.064624956455, 9238.571018864248, 2809.710654706453, 6591.792688520806, 811.855106319262, 4329.344662392405, 5655.870759744095, 5493.00281325488, 7162.017691990394, 6724.281647316959, 9638.546073356201, 1768.9669011862861, 3180.8775243732875, 5323.4094711664475, 6472.772319114851, 6419.563666772556, 8610.90487260507, 1163.1199561642838, 3413.049598884285, 617.334498558991, 10276.59833052883, 5436.987906495172, 5299.33784639838, 1458.621521393766, 3200.2569612457773, 984.3317278188242, 4069.728677263069, 2165.5939861748457, 2521.3121147161974, 3203.912247844245, 2993.9909944714504, 1311.6407271724224, 3185.171779182836, 0.6486922430072696, 1367.8327199384273, 5904.9740877132435, 7535.130594212772, 8512.399412083698, 5614.966139291571], "policy_adversary_policy_reward": [-5613.40991316346, -7906.466551032898, -515.8091006377307, -202.50418273402087, -4567.723434873323, -8386.451371646543, -7051.880695602049, -8381.052764283286, -8879.345497898634, -4871.478445044686, -194.94239083308275, -502.39716357259994, -507.9028361326508, -437.8698999011171, -5078.10299728679, -5227.936688203268, -10323.072376639551, -8506.899448630049, -6000.484554293224, -2554.03035394899, -5315.896050887123, -5313.5374614091, -5349.425684666204, -5880.286423657804, -3060.073998890427, -1698.74391174138, -4862.240314921017, -3237.083701422265, -8744.209589468706, -12231.376890308266, -7555.647200221119, -5683.350164614678, -7165.193592480665, -9147.61615990857, -3463.309514292022, -5182.4308837662875, -4073.18685601922, -9678.61652768305, -213.00754095176703, -1372.1574864069291, -626.1584577299797, -1485.9784639876364, -8584.236476894912, -8676.862466494065, -4599.15250521221, -8651.15532076778, -10351.730152637343, -4583.732888802015, -3549.2062866692686, -6884.213592335091, -2356.6055297967196, -1168.1986709776409, -3994.2655737030577, -7726.676640404527, -6460.166798077092, -6698.684648776374, -2297.3576020531527, -3100.980500283934, -5377.781791965674, -1532.9795087043751, -2399.788008620877, -1275.1394977134364, -6934.153203750486, -4754.100327232872, -4127.147041754294, -4272.615543937565, -6741.575619345323, -6158.463060508331, -5148.770254151055, -4124.719323843753, -6444.547995089213, -7311.053638441615, -10334.88504485468, -8157.45210049759, -5081.899853996417, -8475.137786570484, -7881.847955358286, -5779.822535002155, -2269.1167953840745, -6456.4348852451785, -10236.826660968598, -9916.452503298115, -8246.056264362584, -3197.30580576377, -6112.569763392851, -5115.470025787415, -10053.572792039784, -5610.789812392726, -8586.101461676424, -5379.627179234541, -8121.443030579913, -10275.44196073705, -2065.427040506432, -5567.597167122733, -3897.3438172796773, -7073.684336969499, -4685.546592607935, -5283.982537879295, -7417.143008326624, -9901.039997789814, -9234.770775246585, -8681.895245371756, -5969.17971763664, -2876.354227780856, -6331.4452843152585, -9110.11641013386, -7380.715164528669, -2666.0111438523672, -6112.301984560037, -4021.9525217284136, -8683.234928742495, -10179.812462552543, -7179.719716652044, -8926.223083677545, -5320.814119657431, -6073.827920553604, -11252.696449186868, -9647.402218767967, -8525.059788598492, -5571.309121045418, -5286.438387102331, -8191.751928833673, -4548.601310893513, -4564.359260826784, -9876.954422934126, -9482.768614193858, -2809.710654706453, -6992.021927766719, -6591.792688520806, -8718.493835654019, -3132.8299927096623, -887.5378900807144, -4504.392730811792, -5514.322521490234, -7026.2142462747115, -5770.096883645979, -8039.8587970908275, -5493.00281325488, -7247.400185534327, -7500.736049879186, -7505.813562979629, -7296.899914157505, -10035.53476569192, -9749.247804045812, -8268.782412458504, -1768.9669011862861, -3180.8775243732875, -9248.698519966409, -8743.774233804628, -5330.620157733403, -8802.313903165123, -6472.772319114851, -7363.052058378248, -6527.968649148628, -8610.90487260507, -10909.151102063382, -1163.1199561642838, -8916.427218147066, -12977.369088861513, -3413.049598884285, -617.334498558991, -3730.075332079198, -10356.517082470362, -11554.576077519232, -6677.744897727775, -5579.342168688375, -9970.246874828861, -5299.33784639838, -4985.047255050803, -1780.8794635822053, -8856.227296171399, -3200.2569612457773, -984.3317278188242, -5927.835281858628, -4166.755024572962, -5411.530628665653, -2165.5939861748457, -8816.604008684992, -4673.825251063412, -2521.3121147161974, -3561.8883592588736, -5562.139025218051, -3255.598298622552, -5073.823210559888, -1311.6407271724224, -7649.288348977958, -3185.171779182836, -4887.594853498238, -15.914234881379489, -0.6486922430072696, -1368.2130818536957, -3631.1387679708787, -9537.001536765814, -5974.306127768512, -10679.022073677123, -7535.130594212772, -8833.07402466342, -9550.450053594937, -6152.194891675452, -6215.488304382465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959318565904672, "mean_inference_ms": 0.9616524351633922, "mean_action_processing_ms": 0.16627152532984707, "mean_env_wait_ms": 0.0507427854741188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031517744064331055, "StateBufferConnector_ms": 0.002496480941772461, "ViewRequirementAgentConnector_ms": 0.06671261787414551}, "num_episodes": 20, "episode_return_max": -15.914234881379489, "episode_return_min": -12977.369088861511, "episode_return_mean": -7212.855941278023}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.96898441884633, "num_env_steps_trained_throughput_per_sec": 501.96898441884633, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 7378.671, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7378.638, "sample_time_ms": 762.755, "learn_time_ms": 6604.41, "learn_throughput": 605.656, "synch_weights_time_ms": 11.016}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 136, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-22", "timestamp": 1723232602, "time_this_iter_s": 7.979345083236694, "time_total_s": 1015.8278050422668, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3180ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1015.8278050422668, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 38.77272727272727, "ram_util_percent": 82.12727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1813.5049444198607, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 352.4283042271932, "policy_loss": 0.011377105976862367, "vf_loss": 9.98458701968193, "vf_explained_var": -0.00012346462657054265, "kl": 0.017858172427319612, "entropy": 1.3209650220970313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9321687364073658, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988900769955267, "policy_loss": -0.006319199787531659, "vf_loss": 9.992061758798267, "vf_explained_var": -4.3808467804439484e-05, "kl": 0.011090591762500702, "entropy": 1.1576139934479244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "env_runners": {"episode_reward_max": -15.914234881379489, "episode_reward_min": -12977.369088861511, "episode_reward_mean": -7376.309887209251, "episode_len_mean": 184.77, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 18477, "policy_reward_min": {"agent_policy": 0.6486922430072696, "adversary_policy": -12977.369088861513}, "policy_reward_max": {"agent_policy": 10276.59833052883, "adversary_policy": -0.6486922430072696}, "policy_reward_mean": {"agent_policy": 4587.595191435949, "adversary_policy": -5981.9525393225995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2356.6055297967196, -7726.676640404527, -8066.9470094922235, -3958.569835121511, -5432.968561710579, -2401.943056912687, -6934.153203750485, -4724.702876601443, -6757.946538623824, -5348.806668256516, -7550.295165032919, -10334.885044854682, -8475.137786570484, -7881.847955358285, -6456.4348852451785, -10440.613927841645, -8246.056264362584, -6401.79936545852, -10053.572792039784, -8586.101461676422, -10275.44196073705, -5843.349153525708, -7235.775211725187, -5313.578220673957, -9901.039997789814, -9436.526520922109, -5975.541370188605, -9110.11641013386, -7581.5706637787725, -6112.3019845600365, -10240.559569038296, -8926.223083677545, -6819.463934884128, -11252.957855362034, -9191.738274672962, -8191.751928833672, -4675.895946763841, -10121.152018263741, -6992.02192776672, -8718.493835654019, -3208.512776471115, -5689.37058990962, -7140.440370176595, -8039.8587970908275, -7586.118543423117, -8078.431829820172, -10146.236496381534, -8268.782412458502, -9248.698519966409, -8750.984920371584, -8802.31390316512, -7471.45704075432, -10909.151102063382, -8916.427218147066, -12977.369088861511, -3730.075332079198, -11634.494829460764, -6820.099159920978, -9970.246874828863, -5307.305197239243, -8856.227296171399, -5927.835281858628, -5508.556975975547, -8816.604008684992, -4673.825251063412, -5920.115136632675, -5335.430514710993, -7649.288348977958, -4887.594853498238, -15.914234881379489, -3631.5191298861473, -9606.33357682108, -10679.022073677124, -9871.12466617468, -6752.717056766342, -10883.10181310299, -6979.487044729155, -7540.772525401936, -5879.521747867925, -7457.004796830662, -7501.910580360453, -5190.057278564192, -2979.5618923210627, -9829.927268070918, -8779.616756674452, -3937.2355847831645, -11502.6621344765, -4808.019925048072, -8633.302358834208, -6642.347047996615, -5384.2583328764495, -9352.728471662089, -5427.638782881605, -2578.097843205838, -8239.903448347646, -7090.643111166079, -8073.331445273555, -10793.491959627205, -4793.267985944928, -6473.050738443752], "episode_lengths": [70, 200, 200, 131, 126, 90, 200, 200, 200, 200, 200, 200, 200, 200, 190, 200, 200, 200, 200, 200, 200, 150, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 94, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 81, 200, 200, 200, 129, 200, 106, 200, 200, 142, 200, 200, 195, 200, 1, 111, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 116, 103, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 149, 200, 162, 200, 200, 200, 200], "policy_agent_policy_reward": [1168.1986709776409, 3994.2655737030577, 5091.90443736124, 1439.7682672155772, 1477.7927389594704, 1272.9844494216266, 4754.100327232872, 3675.0597090904157, 6142.092141229829, 3924.682909738291, 6205.306468497908, 8157.45210049759, 5081.899853996417, 5779.822535002155, 2269.1167953840745, 9712.665236425064, 3197.30580576377, 4826.240423721742, 5610.789812392726, 5379.627179234541, 8121.443030579913, 1789.6750541034564, 3735.2529425239886, 4655.950909813269, 7417.143008326624, 8480.139499696235, 2869.992575228891, 6331.4452843152585, 2465.155644602263, 4021.9525217284136, 8622.487822256742, 7179.719716652044, 4575.178105326909, 9647.140812592801, 4904.630634970944, 5286.438387102331, 4437.064624956455, 9238.571018864248, 2809.710654706453, 6591.792688520806, 811.855106319262, 4329.344662392405, 5655.870759744095, 5493.00281325488, 7162.017691990394, 6724.281647316959, 9638.546073356201, 1768.9669011862861, 3180.8775243732875, 5323.4094711664475, 6472.772319114851, 6419.563666772556, 8610.90487260507, 1163.1199561642838, 3413.049598884285, 617.334498558991, 10276.59833052883, 5436.987906495172, 5299.33784639838, 1458.621521393766, 3200.2569612457773, 984.3317278188242, 4069.728677263069, 2165.5939861748457, 2521.3121147161974, 3203.912247844245, 2993.9909944714504, 1311.6407271724224, 3185.171779182836, 0.6486922430072696, 1367.8327199384273, 5904.9740877132435, 7535.130594212772, 8512.399412083698, 5614.966139291571, 5552.143045337077, 3377.746342938256, 6224.216067047912, 4954.165842941009, 3463.892506882538, 3683.2272935275464, 1792.8705801415508, 1037.20984458406, 7398.701099337787, 4010.1516500667612, 919.089088749422, 6705.773677161332, 3693.9965909884604, 7507.886911414941, 2459.653745869205, 3667.2042227155316, 6806.350604663031, 4975.463187207779, 836.9868537033882, 4987.680753270238, 1975.8952101021548, 4843.991903404696, 9808.321886404923, 2339.381124326699, 1567.204708705647], "policy_adversary_policy_reward": [-2356.6055297967196, -1168.1986709776409, -3994.2655737030577, -7726.676640404527, -6460.166798077092, -6698.684648776374, -2297.3576020531527, -3100.980500283934, -5377.781791965674, -1532.9795087043751, -2399.788008620877, -1275.1394977134364, -6934.153203750486, -4754.100327232872, -4127.147041754294, -4272.615543937565, -6741.575619345323, -6158.463060508331, -5148.770254151055, -4124.719323843753, -6444.547995089213, -7311.053638441615, -10334.88504485468, -8157.45210049759, -5081.899853996417, -8475.137786570484, -7881.847955358286, -5779.822535002155, -2269.1167953840745, -6456.4348852451785, -10236.826660968598, -9916.452503298115, -8246.056264362584, -3197.30580576377, -6112.569763392851, -5115.470025787415, -10053.572792039784, -5610.789812392726, -8586.101461676424, -5379.627179234541, -8121.443030579913, -10275.44196073705, -2065.427040506432, -5567.597167122733, -3897.3438172796773, -7073.684336969499, -4685.546592607935, -5283.982537879295, -7417.143008326624, -9901.039997789814, -9234.770775246585, -8681.895245371756, -5969.17971763664, -2876.354227780856, -6331.4452843152585, -9110.11641013386, -7380.715164528669, -2666.0111438523672, -6112.301984560037, -4021.9525217284136, -8683.234928742495, -10179.812462552543, -7179.719716652044, -8926.223083677545, -5320.814119657431, -6073.827920553604, -11252.696449186868, -9647.402218767967, -8525.059788598492, -5571.309121045418, -5286.438387102331, -8191.751928833673, -4548.601310893513, -4564.359260826784, -9876.954422934126, -9482.768614193858, -2809.710654706453, -6992.021927766719, -6591.792688520806, -8718.493835654019, -3132.8299927096623, -887.5378900807144, -4504.392730811792, -5514.322521490234, -7026.2142462747115, -5770.096883645979, -8039.8587970908275, -5493.00281325488, -7247.400185534327, -7500.736049879186, -7505.813562979629, -7296.899914157505, -10035.53476569192, -9749.247804045812, -8268.782412458504, -1768.9669011862861, -3180.8775243732875, -9248.698519966409, -8743.774233804628, -5330.620157733403, -8802.313903165123, -6472.772319114851, -7363.052058378248, -6527.968649148628, -8610.90487260507, -10909.151102063382, -1163.1199561642838, -8916.427218147066, -12977.369088861513, -3413.049598884285, -617.334498558991, -3730.075332079198, -10356.517082470362, -11554.576077519232, -6677.744897727775, -5579.342168688375, -9970.246874828861, -5299.33784639838, -4985.047255050803, -1780.8794635822053, -8856.227296171399, -3200.2569612457773, -984.3317278188242, -5927.835281858628, -4166.755024572962, -5411.530628665653, -2165.5939861748457, -8816.604008684992, -4673.825251063412, -2521.3121147161974, -3561.8883592588736, -5562.139025218051, -3255.598298622552, -5073.823210559888, -1311.6407271724224, -7649.288348977958, -3185.171779182836, -4887.594853498238, -15.914234881379489, -0.6486922430072696, -1368.2130818536957, -3631.1387679708787, -9537.001536765814, -5974.306127768512, -10679.022073677123, -7535.130594212772, -8833.07402466342, -9550.450053594937, -6152.194891675452, -6215.488304382465, -10883.10181310299, -5552.143045337077, -3468.744698277598, -6888.488689389813, -6224.216067047912, -7540.772525401936, -5808.386545873868, -5025.301044935069, -4732.693862132993, -6188.203441580202, -3683.4130922661916, -7501.724781621809, -1886.7808306481234, -5096.147028057619, -2291.2236758506488, -1725.5480610544737, -7398.701099337787, -9829.927268070918, -8779.616756674453, -4010.1516500667612, -3876.0544645681607, -980.2702089644263, -11502.6621344765, -6705.773677161332, -3893.9270475880703, -4608.0894684484665, -8629.513252419409, -7511.67601782974, -6013.072764682935, -3088.928029182888, -3668.4078725606314, -5383.05468303135, -6806.350604663031, -9352.728471662089, -5305.888631744709, -5097.213338344677, -2056.0974656179287, -1358.9872312912964, -6218.398992637526, -7009.18520898037, -2759.1489020995364, -6307.389419168707, -4860.106973664147, -8057.216375014104, -9966.567188835832, -10635.246657196294, -2339.381124326699, -4793.26798594493, -6473.050738443754, -1567.204708705647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959876340803228, "mean_inference_ms": 0.9627486484037179, "mean_action_processing_ms": 0.16621109524513575, "mean_env_wait_ms": 0.05074506389047425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031723976135253906, "StateBufferConnector_ms": 0.0024781227111816406, "ViewRequirementAgentConnector_ms": 0.06673383712768555}, "num_episodes": 25, "episode_return_max": -15.914234881379489, "episode_return_min": -12977.369088861511, "episode_return_mean": -7376.309887209251}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 531.774807663202, "num_env_steps_trained_throughput_per_sec": 531.774807663202, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 7402.713, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7402.68, "sample_time_ms": 767.968, "learn_time_ms": 6623.258, "learn_throughput": 603.932, "synch_weights_time_ms": 10.995}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "training_iteration": 137, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-29", "timestamp": 1723232609, "time_this_iter_s": 7.527001142501831, "time_total_s": 1023.3548061847687, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ab550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1023.3548061847687, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 27.645454545454548, "ram_util_percent": 82.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1730.9131006558737, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 287.03712895711266, "policy_loss": 0.008933439742637954, "vf_loss": 10.0, "vf_explained_var": -0.00016877930611371993, "kl": 0.014447284025178912, "entropy": 1.2673365098734697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9273748871510622, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998156710528823, "policy_loss": -0.005261408417761602, "vf_loss": 10.0, "vf_explained_var": -0.0005036469489809066, "kl": 0.012003281887463003, "entropy": 1.1562823278563363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": -15.914234881379489, "episode_reward_min": -12977.369088861511, "episode_reward_mean": -7685.29475790207, "episode_len_mean": 188.7, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18870, "policy_reward_min": {"agent_policy": 0.6486922430072696, "adversary_policy": -12977.369088861513}, "policy_reward_max": {"agent_policy": 10276.59833052883, "adversary_policy": -0.6486922430072696}, "policy_reward_mean": {"agent_policy": 4782.234683893235, "adversary_policy": -6233.764720897653}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10275.44196073705, -5843.349153525708, -7235.775211725187, -5313.578220673957, -9901.039997789814, -9436.526520922109, -5975.541370188605, -9110.11641013386, -7581.5706637787725, -6112.3019845600365, -10240.559569038296, -8926.223083677545, -6819.463934884128, -11252.957855362034, -9191.738274672962, -8191.751928833672, -4675.895946763841, -10121.152018263741, -6992.02192776672, -8718.493835654019, -3208.512776471115, -5689.37058990962, -7140.440370176595, -8039.8587970908275, -7586.118543423117, -8078.431829820172, -10146.236496381534, -8268.782412458502, -9248.698519966409, -8750.984920371584, -8802.31390316512, -7471.45704075432, -10909.151102063382, -8916.427218147066, -12977.369088861511, -3730.075332079198, -11634.494829460764, -6820.099159920978, -9970.246874828863, -5307.305197239243, -8856.227296171399, -5927.835281858628, -5508.556975975547, -8816.604008684992, -4673.825251063412, -5920.115136632675, -5335.430514710993, -7649.288348977958, -4887.594853498238, -15.914234881379489, -3631.5191298861473, -9606.33357682108, -10679.022073677124, -9871.12466617468, -6752.717056766342, -10883.10181310299, -6979.487044729155, -7540.772525401936, -5879.521747867925, -7457.004796830662, -7501.910580360453, -5190.057278564192, -2979.5618923210627, -9829.927268070918, -8779.616756674452, -3937.2355847831645, -11502.6621344765, -4808.019925048072, -8633.302358834208, -6642.347047996615, -5384.2583328764495, -9352.728471662089, -5427.638782881605, -2578.097843205838, -8239.903448347646, -7090.643111166079, -8073.331445273555, -10793.491959627205, -4793.267985944928, -6473.050738443752, -7200.888354914431, -8461.943820959175, -7763.802691059726, -6002.635219651435, -9262.67159505952, -9868.996848196846, -8651.32802107313, -11545.279935879587, -9693.582924516528, -8780.408732795293, -5466.929918910463, -7805.3825799294145, -11347.68446512103, -9017.224580009639, -5529.096406994829, -7944.042035378103, -10385.391011700955, -10533.944221667922, -6265.2187187662375, -7508.09955580879], "episode_lengths": [200, 150, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 94, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 81, 200, 200, 200, 129, 200, 106, 200, 200, 142, 200, 200, 195, 200, 1, 111, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 116, 103, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 149, 200, 162, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8121.443030579913, 1789.6750541034564, 3735.2529425239886, 4655.950909813269, 7417.143008326624, 8480.139499696235, 2869.992575228891, 6331.4452843152585, 2465.155644602263, 4021.9525217284136, 8622.487822256742, 7179.719716652044, 4575.178105326909, 9647.140812592801, 4904.630634970944, 5286.438387102331, 4437.064624956455, 9238.571018864248, 2809.710654706453, 6591.792688520806, 811.855106319262, 4329.344662392405, 5655.870759744095, 5493.00281325488, 7162.017691990394, 6724.281647316959, 9638.546073356201, 1768.9669011862861, 3180.8775243732875, 5323.4094711664475, 6472.772319114851, 6419.563666772556, 8610.90487260507, 1163.1199561642838, 3413.049598884285, 617.334498558991, 10276.59833052883, 5436.987906495172, 5299.33784639838, 1458.621521393766, 3200.2569612457773, 984.3317278188242, 4069.728677263069, 2165.5939861748457, 2521.3121147161974, 3203.912247844245, 2993.9909944714504, 1311.6407271724224, 3185.171779182836, 0.6486922430072696, 1367.8327199384273, 5904.9740877132435, 7535.130594212772, 8512.399412083698, 5614.966139291571, 5552.143045337077, 3377.746342938256, 6224.216067047912, 4954.165842941009, 3463.892506882538, 3683.2272935275464, 1792.8705801415508, 1037.20984458406, 7398.701099337787, 4010.1516500667612, 919.089088749422, 6705.773677161332, 3693.9965909884604, 7507.886911414941, 2459.653745869205, 3667.2042227155316, 6806.350604663031, 4975.463187207779, 836.9868537033882, 4987.680753270238, 1975.8952101021548, 4843.991903404696, 9808.321886404923, 2339.381124326699, 1567.204708705647, 3770.471027408702, 3986.424309057662, 4685.437836929155, 5515.214248478553, 6180.121303561478, 6236.549753994403, 4239.509720811173, 6189.119522622012, 6472.634533199645, 4213.394310835149, 1750.2888380887916, 5159.949605785638, 8484.970577703632, 6135.876039091421, 3902.6476379470714, 7096.444508748429, 7654.991878873227, 7389.3505810482875, 4704.65840626305, 4856.970041127329], "policy_adversary_policy_reward": [-8121.443030579913, -10275.44196073705, -2065.427040506432, -5567.597167122733, -3897.3438172796773, -7073.684336969499, -4685.546592607935, -5283.982537879295, -7417.143008326624, -9901.039997789814, -9234.770775246585, -8681.895245371756, -5969.17971763664, -2876.354227780856, -6331.4452843152585, -9110.11641013386, -7380.715164528669, -2666.0111438523672, -6112.301984560037, -4021.9525217284136, -8683.234928742495, -10179.812462552543, -7179.719716652044, -8926.223083677545, -5320.814119657431, -6073.827920553604, -11252.696449186868, -9647.402218767967, -8525.059788598492, -5571.309121045418, -5286.438387102331, -8191.751928833673, -4548.601310893513, -4564.359260826784, -9876.954422934126, -9482.768614193858, -2809.710654706453, -6992.021927766719, -6591.792688520806, -8718.493835654019, -3132.8299927096623, -887.5378900807144, -4504.392730811792, -5514.322521490234, -7026.2142462747115, -5770.096883645979, -8039.8587970908275, -5493.00281325488, -7247.400185534327, -7500.736049879186, -7505.813562979629, -7296.899914157505, -10035.53476569192, -9749.247804045812, -8268.782412458504, -1768.9669011862861, -3180.8775243732875, -9248.698519966409, -8743.774233804628, -5330.620157733403, -8802.313903165123, -6472.772319114851, -7363.052058378248, -6527.968649148628, -8610.90487260507, -10909.151102063382, -1163.1199561642838, -8916.427218147066, -12977.369088861513, -3413.049598884285, -617.334498558991, -3730.075332079198, -10356.517082470362, -11554.576077519232, -6677.744897727775, -5579.342168688375, -9970.246874828861, -5299.33784639838, -4985.047255050803, -1780.8794635822053, -8856.227296171399, -3200.2569612457773, -984.3317278188242, -5927.835281858628, -4166.755024572962, -5411.530628665653, -2165.5939861748457, -8816.604008684992, -4673.825251063412, -2521.3121147161974, -3561.8883592588736, -5562.139025218051, -3255.598298622552, -5073.823210559888, -1311.6407271724224, -7649.288348977958, -3185.171779182836, -4887.594853498238, -15.914234881379489, -0.6486922430072696, -1368.2130818536957, -3631.1387679708787, -9537.001536765814, -5974.306127768512, -10679.022073677123, -7535.130594212772, -8833.07402466342, -9550.450053594937, -6152.194891675452, -6215.488304382465, -10883.10181310299, -5552.143045337077, -3468.744698277598, -6888.488689389813, -6224.216067047912, -7540.772525401936, -5808.386545873868, -5025.301044935069, -4732.693862132993, -6188.203441580202, -3683.4130922661916, -7501.724781621809, -1886.7808306481234, -5096.147028057619, -2291.2236758506488, -1725.5480610544737, -7398.701099337787, -9829.927268070918, -8779.616756674453, -4010.1516500667612, -3876.0544645681607, -980.2702089644263, -11502.6621344765, -6705.773677161332, -3893.9270475880703, -4608.0894684484665, -8629.513252419409, -7511.67601782974, -6013.072764682935, -3088.928029182888, -3668.4078725606314, -5383.05468303135, -6806.350604663031, -9352.728471662089, -5305.888631744709, -5097.213338344677, -2056.0974656179287, -1358.9872312912964, -6218.398992637526, -7009.18520898037, -2759.1489020995364, -6307.389419168707, -4860.106973664147, -8057.216375014104, -9966.567188835832, -10635.246657196294, -2339.381124326699, -4793.26798594493, -6473.050738443754, -1567.204708705647, -7188.220181478225, -3783.139200844906, -7524.479508387691, -4923.888621629161, -7763.802691059726, -4685.437836929155, -5562.928514151773, -5954.920953978215, -8554.053532057349, -6888.7393665636555, -9681.000465929663, -6424.5461362615915, -4239.509720811173, -8651.328021073132, -11545.27993587959, -6189.119522622012, -6551.9341012989125, -9614.28335641726, -4557.921973117432, -8435.881070513009, -4410.3389109813415, -2806.879846017914, -5159.949605785638, -7805.3825799294145, -8484.970577703632, -11347.68446512103, -9016.56492376004, -6136.535695341019, -3902.6476379470714, -5529.096406994829, -7208.865815820689, -7831.620728305841, -7654.991878873227, -10385.391011700955, -9888.423235181386, -8034.871567534823, -5311.290180909807, -5658.586944119483, -4913.786607285756, -7451.282989650364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960629935704536, "mean_inference_ms": 0.9626451579995225, "mean_action_processing_ms": 0.16622491985774043, "mean_env_wait_ms": 0.05076742861656425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032405853271484375, "StateBufferConnector_ms": 0.002464890480041504, "ViewRequirementAgentConnector_ms": 0.06582868099212646}, "num_episodes": 20, "episode_return_max": -15.914234881379489, "episode_return_min": -12977.369088861511, "episode_return_mean": -7685.29475790207}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.2742166351959, "num_env_steps_trained_throughput_per_sec": 551.2742166351959, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 7394.498, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7394.465, "sample_time_ms": 774.116, "learn_time_ms": 6608.663, "learn_throughput": 605.266, "synch_weights_time_ms": 11.221}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 138, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-37", "timestamp": 1723232617, "time_this_iter_s": 7.260694980621338, "time_total_s": 1030.61550116539, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ab5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1030.61550116539, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 25.79090909090909, "ram_util_percent": 83.08181818181816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1492.2096930821738, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 291.86054526964824, "policy_loss": 0.01807007317644699, "vf_loss": 9.984463784098626, "vf_explained_var": -7.671614487965902e-07, "kl": 0.014699163553693021, "entropy": 1.2035287176569303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9428502981467222, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990605007656036, "policy_loss": -0.002501230936980358, "vf_loss": 9.989632626185342, "vf_explained_var": -0.0003391895660016903, "kl": 0.012198248846091764, "entropy": 1.1406148151745872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "env_runners": {"episode_reward_max": -15.914234881379489, "episode_reward_min": -12977.369088861511, "episode_reward_mean": -7491.78737065008, "episode_len_mean": 187.32, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18732, "policy_reward_min": {"agent_policy": 0.6486922430072696, "adversary_policy": -12977.369088861513}, "policy_reward_max": {"agent_policy": 10276.59833052883, "adversary_policy": -0.6486922430072696}, "policy_reward_mean": {"agent_policy": 4613.4942744840155, "adversary_policy": -6052.640822567048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3208.512776471115, -5689.37058990962, -7140.440370176595, -8039.8587970908275, -7586.118543423117, -8078.431829820172, -10146.236496381534, -8268.782412458502, -9248.698519966409, -8750.984920371584, -8802.31390316512, -7471.45704075432, -10909.151102063382, -8916.427218147066, -12977.369088861511, -3730.075332079198, -11634.494829460764, -6820.099159920978, -9970.246874828863, -5307.305197239243, -8856.227296171399, -5927.835281858628, -5508.556975975547, -8816.604008684992, -4673.825251063412, -5920.115136632675, -5335.430514710993, -7649.288348977958, -4887.594853498238, -15.914234881379489, -3631.5191298861473, -9606.33357682108, -10679.022073677124, -9871.12466617468, -6752.717056766342, -10883.10181310299, -6979.487044729155, -7540.772525401936, -5879.521747867925, -7457.004796830662, -7501.910580360453, -5190.057278564192, -2979.5618923210627, -9829.927268070918, -8779.616756674452, -3937.2355847831645, -11502.6621344765, -4808.019925048072, -8633.302358834208, -6642.347047996615, -5384.2583328764495, -9352.728471662089, -5427.638782881605, -2578.097843205838, -8239.903448347646, -7090.643111166079, -8073.331445273555, -10793.491959627205, -4793.267985944928, -6473.050738443752, -7200.888354914431, -8461.943820959175, -7763.802691059726, -6002.635219651435, -9262.67159505952, -9868.996848196846, -8651.32802107313, -11545.279935879587, -9693.582924516528, -8780.408732795293, -5466.929918910463, -7805.3825799294145, -11347.68446512103, -9017.224580009639, -5529.096406994829, -7944.042035378103, -10385.391011700955, -10533.944221667922, -6265.2187187662375, -7508.09955580879, -6275.285641116359, -7127.036547072269, -2024.881503640228, -9973.767505676034, -8501.06317436906, -4847.563983997595, -5932.219028138534, -5172.0342144170645, -8290.415531516066, -6012.85363534182, -8855.204748655477, -4347.841055135423, -10168.37431696207, -5988.475937647035, -11083.386579798524, -4513.547070134086, -11114.216722142568, -7737.6788700623665, -8310.225429990332, -6288.689647940179], "episode_lengths": [94, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 81, 200, 200, 200, 129, 200, 106, 200, 200, 142, 200, 200, 195, 200, 1, 111, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 116, 103, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 149, 200, 162, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 139, 200, 200, 200, 200, 166, 200, 200, 200, 107, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [811.855106319262, 4329.344662392405, 5655.870759744095, 5493.00281325488, 7162.017691990394, 6724.281647316959, 9638.546073356201, 1768.9669011862861, 3180.8775243732875, 5323.4094711664475, 6472.772319114851, 6419.563666772556, 8610.90487260507, 1163.1199561642838, 3413.049598884285, 617.334498558991, 10276.59833052883, 5436.987906495172, 5299.33784639838, 1458.621521393766, 3200.2569612457773, 984.3317278188242, 4069.728677263069, 2165.5939861748457, 2521.3121147161974, 3203.912247844245, 2993.9909944714504, 1311.6407271724224, 3185.171779182836, 0.6486922430072696, 1367.8327199384273, 5904.9740877132435, 7535.130594212772, 8512.399412083698, 5614.966139291571, 5552.143045337077, 3377.746342938256, 6224.216067047912, 4954.165842941009, 3463.892506882538, 3683.2272935275464, 1792.8705801415508, 1037.20984458406, 7398.701099337787, 4010.1516500667612, 919.089088749422, 6705.773677161332, 3693.9965909884604, 7507.886911414941, 2459.653745869205, 3667.2042227155316, 6806.350604663031, 4975.463187207779, 836.9868537033882, 4987.680753270238, 1975.8952101021548, 4843.991903404696, 9808.321886404923, 2339.381124326699, 1567.204708705647, 3770.471027408702, 3986.424309057662, 4685.437836929155, 5515.214248478553, 6180.121303561478, 6236.549753994403, 4239.509720811173, 6189.119522622012, 6472.634533199645, 4213.394310835149, 1750.2888380887916, 5159.949605785638, 8484.970577703632, 6135.876039091421, 3902.6476379470714, 7096.444508748429, 7654.991878873227, 7389.3505810482875, 4704.65840626305, 4856.970041127329, 5296.882342578064, 5739.822264452026, 1435.6201818942561, 6791.032917224602, 6941.860516550305, 3784.1914366161836, 4824.240113590162, 1654.8886454801177, 5017.08337810216, 4800.537992713977, 5974.034803641833, 2372.9320667292513, 6879.0700838674675, 4712.700637895249, 6451.900389216174, 2809.797635443171, 6209.288444230743, 1440.695387748894, 7852.008939439611, 5318.255818531812], "policy_adversary_policy_reward": [-3132.8299927096623, -887.5378900807144, -4504.392730811792, -5514.322521490234, -7026.2142462747115, -5770.096883645979, -8039.8587970908275, -5493.00281325488, -7247.400185534327, -7500.736049879186, -7505.813562979629, -7296.899914157505, -10035.53476569192, -9749.247804045812, -8268.782412458504, -1768.9669011862861, -3180.8775243732875, -9248.698519966409, -8743.774233804628, -5330.620157733403, -8802.313903165123, -6472.772319114851, -7363.052058378248, -6527.968649148628, -8610.90487260507, -10909.151102063382, -1163.1199561642838, -8916.427218147066, -12977.369088861513, -3413.049598884285, -617.334498558991, -3730.075332079198, -10356.517082470362, -11554.576077519232, -6677.744897727775, -5579.342168688375, -9970.246874828861, -5299.33784639838, -4985.047255050803, -1780.8794635822053, -8856.227296171399, -3200.2569612457773, -984.3317278188242, -5927.835281858628, -4166.755024572962, -5411.530628665653, -2165.5939861748457, -8816.604008684992, -4673.825251063412, -2521.3121147161974, -3561.8883592588736, -5562.139025218051, -3255.598298622552, -5073.823210559888, -1311.6407271724224, -7649.288348977958, -3185.171779182836, -4887.594853498238, -15.914234881379489, -0.6486922430072696, -1368.2130818536957, -3631.1387679708787, -9537.001536765814, -5974.306127768512, -10679.022073677123, -7535.130594212772, -8833.07402466342, -9550.450053594937, -6152.194891675452, -6215.488304382465, -10883.10181310299, -5552.143045337077, -3468.744698277598, -6888.488689389813, -6224.216067047912, -7540.772525401936, -5808.386545873868, -5025.301044935069, -4732.693862132993, -6188.203441580202, -3683.4130922661916, -7501.724781621809, -1886.7808306481234, -5096.147028057619, -2291.2236758506488, -1725.5480610544737, -7398.701099337787, -9829.927268070918, -8779.616756674453, -4010.1516500667612, -3876.0544645681607, -980.2702089644263, -11502.6621344765, -6705.773677161332, -3893.9270475880703, -4608.0894684484665, -8629.513252419409, -7511.67601782974, -6013.072764682935, -3088.928029182888, -3668.4078725606314, -5383.05468303135, -6806.350604663031, -9352.728471662089, -5305.888631744709, -5097.213338344677, -2056.0974656179287, -1358.9872312912964, -6218.398992637526, -7009.18520898037, -2759.1489020995364, -6307.389419168707, -4860.106973664147, -8057.216375014104, -9966.567188835832, -10635.246657196294, -2339.381124326699, -4793.26798594493, -6473.050738443754, -1567.204708705647, -7188.220181478225, -3783.139200844906, -7524.479508387691, -4923.888621629161, -7763.802691059726, -4685.437836929155, -5562.928514151773, -5954.920953978215, -8554.053532057349, -6888.7393665636555, -9681.000465929663, -6424.5461362615915, -4239.509720811173, -8651.328021073132, -11545.27993587959, -6189.119522622012, -6551.9341012989125, -9614.28335641726, -4557.921973117432, -8435.881070513009, -4410.3389109813415, -2806.879846017914, -5159.949605785638, -7805.3825799294145, -8484.970577703632, -11347.68446512103, -9016.56492376004, -6136.535695341019, -3902.6476379470714, -5529.096406994829, -7208.865815820689, -7831.620728305841, -7654.991878873227, -10385.391011700955, -9888.423235181386, -8034.871567534823, -5311.290180909807, -5658.586944119483, -4913.786607285756, -7451.282989650364, -5453.153022011585, -6119.01496168284, -7127.03654707227, -5739.822264452026, -1580.2678753890123, -1880.2338101454716, -6791.032917224602, -9973.767505676034, -6941.860516550305, -8501.06317436906, -4527.598858309204, -4104.156562304576, -5224.066772794361, -5532.392368934337, -4588.807823287032, -2238.11503661015, -8290.415531516068, -5017.08337810216, -6012.85363534182, -4800.537992713977, -8855.204748655475, -5974.034803641833, -2379.982384732865, -4340.790737131808, -10168.374316962072, -6879.0700838674675, -5944.715839562411, -4756.460735979874, -6451.900389216174, -11083.386579798524, -4073.6767050377885, -3249.668000539465, -6209.288444230743, -11114.216722142566, -1623.191106657147, -7555.183151154112, -7933.078049278201, -8229.15632015174, -5773.879999768966, -5833.065466703019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396007196408834, "mean_inference_ms": 0.9626188513590431, "mean_action_processing_ms": 0.16624643547096585, "mean_env_wait_ms": 0.050780097646524434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003293752670288086, "StateBufferConnector_ms": 0.0025022029876708984, "ViewRequirementAgentConnector_ms": 0.06695210933685303}, "num_episodes": 20, "episode_return_max": -15.914234881379489, "episode_return_min": -12977.369088861511, "episode_return_mean": -7491.78737065008}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.742184649755, "num_env_steps_trained_throughput_per_sec": 535.742184649755, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1668000, "timers": {"training_iteration_time_ms": 7386.949, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7386.916, "sample_time_ms": 759.319, "learn_time_ms": 6616.136, "learn_throughput": 604.583, "synch_weights_time_ms": 10.958}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "done": false, "training_iteration": 139, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-44", "timestamp": 1723232624, "time_this_iter_s": 7.470289945602417, "time_total_s": 1038.0857911109924, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ab940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1038.0857911109924, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 26.636363636363637, "ram_util_percent": 83.13636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1038.7021371364594, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 170.3473445971807, "policy_loss": 0.009543154335309131, "vf_loss": 9.989889457821846, "vf_explained_var": 3.733057528734207e-05, "kl": 0.008362296214909293, "entropy": 1.1678468152880668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9115319020376004, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99363683922581, "policy_loss": -0.0017859355302616243, "vf_loss": 9.992778562111829, "vf_explained_var": -0.0006652668355003236, "kl": 0.009285592655380252, "entropy": 1.099434037940212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": -15.914234881379489, "episode_reward_min": -11545.279935879587, "episode_reward_mean": -7195.935164298341, "episode_len_mean": 186.66, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18666, "policy_reward_min": {"agent_policy": 0.6486922430072696, "adversary_policy": -11545.27993587959}, "policy_reward_max": {"agent_policy": 9808.321886404923, "adversary_policy": -0.6486922430072696}, "policy_reward_mean": {"agent_policy": 4461.240402311955, "adversary_policy": -5828.587783305149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5927.835281858628, -5508.556975975547, -8816.604008684992, -4673.825251063412, -5920.115136632675, -5335.430514710993, -7649.288348977958, -4887.594853498238, -15.914234881379489, -3631.5191298861473, -9606.33357682108, -10679.022073677124, -9871.12466617468, -6752.717056766342, -10883.10181310299, -6979.487044729155, -7540.772525401936, -5879.521747867925, -7457.004796830662, -7501.910580360453, -5190.057278564192, -2979.5618923210627, -9829.927268070918, -8779.616756674452, -3937.2355847831645, -11502.6621344765, -4808.019925048072, -8633.302358834208, -6642.347047996615, -5384.2583328764495, -9352.728471662089, -5427.638782881605, -2578.097843205838, -8239.903448347646, -7090.643111166079, -8073.331445273555, -10793.491959627205, -4793.267985944928, -6473.050738443752, -7200.888354914431, -8461.943820959175, -7763.802691059726, -6002.635219651435, -9262.67159505952, -9868.996848196846, -8651.32802107313, -11545.279935879587, -9693.582924516528, -8780.408732795293, -5466.929918910463, -7805.3825799294145, -11347.68446512103, -9017.224580009639, -5529.096406994829, -7944.042035378103, -10385.391011700955, -10533.944221667922, -6265.2187187662375, -7508.09955580879, -6275.285641116359, -7127.036547072269, -2024.881503640228, -9973.767505676034, -8501.06317436906, -4847.563983997595, -5932.219028138534, -5172.0342144170645, -8290.415531516066, -6012.85363534182, -8855.204748655477, -4347.841055135423, -10168.37431696207, -5988.475937647035, -11083.386579798524, -4513.547070134086, -11114.216722142568, -7737.6788700623665, -8310.225429990332, -6288.689647940179, -8283.846590629268, -3217.8121260558446, -9216.78241965563, -2911.0275154624987, -7759.005887217826, -8536.281813047992, -417.71387049647916, -7018.958193004045, -8890.023798748045, -3299.848355180596, -4737.077935738828, -8164.493395757365, -7761.759837174309, -5645.502692287469, -7960.011057789583, -8571.304815739742, -7241.186112155769, -9260.724845466599, -9512.01431683518, -5401.69427919809, -8160.311805946193], "episode_lengths": [106, 200, 200, 142, 200, 200, 195, 200, 1, 111, 200, 200, 200, 200, 200, 200, 200, 200, 200, 194, 116, 103, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 149, 200, 162, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 139, 200, 200, 200, 200, 166, 200, 200, 200, 107, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 141, 200, 200, 11, 200, 200, 112, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [984.3317278188242, 4069.728677263069, 2165.5939861748457, 2521.3121147161974, 3203.912247844245, 2993.9909944714504, 1311.6407271724224, 3185.171779182836, 0.6486922430072696, 1367.8327199384273, 5904.9740877132435, 7535.130594212772, 8512.399412083698, 5614.966139291571, 5552.143045337077, 3377.746342938256, 6224.216067047912, 4954.165842941009, 3463.892506882538, 3683.2272935275464, 1792.8705801415508, 1037.20984458406, 7398.701099337787, 4010.1516500667612, 919.089088749422, 6705.773677161332, 3693.9965909884604, 7507.886911414941, 2459.653745869205, 3667.2042227155316, 6806.350604663031, 4975.463187207779, 836.9868537033882, 4987.680753270238, 1975.8952101021548, 4843.991903404696, 9808.321886404923, 2339.381124326699, 1567.204708705647, 3770.471027408702, 3986.424309057662, 4685.437836929155, 5515.214248478553, 6180.121303561478, 6236.549753994403, 4239.509720811173, 6189.119522622012, 6472.634533199645, 4213.394310835149, 1750.2888380887916, 5159.949605785638, 8484.970577703632, 6135.876039091421, 3902.6476379470714, 7096.444508748429, 7654.991878873227, 7389.3505810482875, 4704.65840626305, 4856.970041127329, 5296.882342578064, 5739.822264452026, 1435.6201818942561, 6791.032917224602, 6941.860516550305, 3784.1914366161836, 4824.240113590162, 1654.8886454801177, 5017.08337810216, 4800.537992713977, 5974.034803641833, 2372.9320667292513, 6879.0700838674675, 4712.700637895249, 6451.900389216174, 2809.797635443171, 6209.288444230743, 1440.695387748894, 7852.008939439611, 5318.255818531812, 4908.429514109923, 2796.4858270120926, 8464.588054799558, 2351.0394811589135, 6594.53637085998, 4941.936388728458, 29.254881572035096, 4284.635432167524, 6103.253255455398, 1388.7529086126583, 3051.683737592421, 4267.284275413214, 5363.238979069519, 1443.1077643951817, 5609.962706583635, 2703.315154926617, 6452.139544883119, 5775.129810336602, 1594.3931291398783, 2443.1311587715204, 6665.034536467833], "policy_adversary_policy_reward": [-984.3317278188242, -5927.835281858628, -4166.755024572962, -5411.530628665653, -2165.5939861748457, -8816.604008684992, -4673.825251063412, -2521.3121147161974, -3561.8883592588736, -5562.139025218051, -3255.598298622552, -5073.823210559888, -1311.6407271724224, -7649.288348977958, -3185.171779182836, -4887.594853498238, -15.914234881379489, -0.6486922430072696, -1368.2130818536957, -3631.1387679708787, -9537.001536765814, -5974.306127768512, -10679.022073677123, -7535.130594212772, -8833.07402466342, -9550.450053594937, -6152.194891675452, -6215.488304382465, -10883.10181310299, -5552.143045337077, -3468.744698277598, -6888.488689389813, -6224.216067047912, -7540.772525401936, -5808.386545873868, -5025.301044935069, -4732.693862132993, -6188.203441580202, -3683.4130922661916, -7501.724781621809, -1886.7808306481234, -5096.147028057619, -2291.2236758506488, -1725.5480610544737, -7398.701099337787, -9829.927268070918, -8779.616756674453, -4010.1516500667612, -3876.0544645681607, -980.2702089644263, -11502.6621344765, -6705.773677161332, -3893.9270475880703, -4608.0894684484665, -8629.513252419409, -7511.67601782974, -6013.072764682935, -3088.928029182888, -3668.4078725606314, -5383.05468303135, -6806.350604663031, -9352.728471662089, -5305.888631744709, -5097.213338344677, -2056.0974656179287, -1358.9872312912964, -6218.398992637526, -7009.18520898037, -2759.1489020995364, -6307.389419168707, -4860.106973664147, -8057.216375014104, -9966.567188835832, -10635.246657196294, -2339.381124326699, -4793.26798594493, -6473.050738443754, -1567.204708705647, -7188.220181478225, -3783.139200844906, -7524.479508387691, -4923.888621629161, -7763.802691059726, -4685.437836929155, -5562.928514151773, -5954.920953978215, -8554.053532057349, -6888.7393665636555, -9681.000465929663, -6424.5461362615915, -4239.509720811173, -8651.328021073132, -11545.27993587959, -6189.119522622012, -6551.9341012989125, -9614.28335641726, -4557.921973117432, -8435.881070513009, -4410.3389109813415, -2806.879846017914, -5159.949605785638, -7805.3825799294145, -8484.970577703632, -11347.68446512103, -9016.56492376004, -6136.535695341019, -3902.6476379470714, -5529.096406994829, -7208.865815820689, -7831.620728305841, -7654.991878873227, -10385.391011700955, -9888.423235181386, -8034.871567534823, -5311.290180909807, -5658.586944119483, -4913.786607285756, -7451.282989650364, -5453.153022011585, -6119.01496168284, -7127.03654707227, -5739.822264452026, -1580.2678753890123, -1880.2338101454716, -6791.032917224602, -9973.767505676034, -6941.860516550305, -8501.06317436906, -4527.598858309204, -4104.156562304576, -5224.066772794361, -5532.392368934337, -4588.807823287032, -2238.11503661015, -8290.415531516068, -5017.08337810216, -6012.85363534182, -4800.537992713977, -8855.204748655475, -5974.034803641833, -2379.982384732865, -4340.790737131808, -10168.374316962072, -6879.0700838674675, -5944.715839562411, -4756.460735979874, -6451.900389216174, -11083.386579798524, -4073.6767050377885, -3249.668000539465, -6209.288444230743, -11114.216722142566, -1623.191106657147, -7555.183151154112, -7933.078049278201, -8229.15632015174, -5773.879999768966, -5833.065466703019, -8283.846590629268, -4908.429514109923, -3095.848505755075, -2918.449447312862, -9179.951672695568, -8501.418801759619, -2873.027128735868, -2389.0398678855445, -7052.623431882333, -7300.918826195473, -8536.281813047992, -4941.936388728458, -29.254881572035096, -417.71387049647916, -5019.805089286936, -6283.788535884632, -8890.023798748041, -6103.253255455398, -2621.5632436818023, -2067.0380201114526, -4546.19941223874, -3242.5622610925057, -5467.173743898771, -6964.603927271807, -5363.238979069519, -7761.759837174309, -1443.1077643951817, -5645.502692287469, -7960.011057789583, -5609.962706583635, -2703.315154926617, -8571.304815739742, -7165.856075444631, -6527.469581594257, -5854.536398680233, -9181.318257122968, -1594.3931291398783, -9512.01431683518, -2443.1311587715204, -5401.69427919809, -8160.311805946191, -6665.034536467833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960680609152793, "mean_inference_ms": 0.9627686186287412, "mean_action_processing_ms": 0.16619665704541375, "mean_env_wait_ms": 0.050788367499170005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031669139862060547, "StateBufferConnector_ms": 0.0024148225784301758, "ViewRequirementAgentConnector_ms": 0.06574499607086182}, "num_episodes": 21, "episode_return_max": -15.914234881379489, "episode_return_min": -11545.279935879587, "episode_return_mean": -7195.935164298341}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.023666470634, "num_env_steps_trained_throughput_per_sec": 546.023666470634, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 7397.179, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7397.145, "sample_time_ms": 757.486, "learn_time_ms": 6627.917, "learn_throughput": 603.508, "synch_weights_time_ms": 11.246}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 140, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-52", "timestamp": 1723232632, "time_this_iter_s": 7.330390930175781, "time_total_s": 1045.4161820411682, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ea0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1045.4161820411682, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 31.64545454545454, "ram_util_percent": 83.17272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 740.5685380419095, "cur_kl_coeff": 19175.105923288407, "cur_lr": 5.0000000000000016e-05, "total_loss": 99.70191870133083, "policy_loss": 0.003893817624581667, "vf_loss": 9.993639735380809, "vf_explained_var": -3.962218761444092e-05, "kl": 0.0046781690517188204, "entropy": 1.1392034908135733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9855400263947784, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992727496132018, "policy_loss": -0.006331471653122987, "vf_loss": 9.995304386704056, "vf_explained_var": -0.0015900647829449365, "kl": 0.013184808527006122, "entropy": 1.1254693663940227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "env_runners": {"episode_reward_max": -417.71387049647916, "episode_reward_min": -11545.279935879587, "episode_reward_mean": -7302.365570789573, "episode_len_mean": 191.05, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19105, "policy_reward_min": {"agent_policy": 29.254881572035096, "adversary_policy": -11545.27993587959}, "policy_reward_max": {"agent_policy": 9808.321886404923, "adversary_policy": -29.254881572035096}, "policy_reward_mean": {"agent_policy": 4637.451017091949, "adversary_policy": -5969.908293940762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2979.5618923210627, -9829.927268070918, -8779.616756674452, -3937.2355847831645, -11502.6621344765, -4808.019925048072, -8633.302358834208, -6642.347047996615, -5384.2583328764495, -9352.728471662089, -5427.638782881605, -2578.097843205838, -8239.903448347646, -7090.643111166079, -8073.331445273555, -10793.491959627205, -4793.267985944928, -6473.050738443752, -7200.888354914431, -8461.943820959175, -7763.802691059726, -6002.635219651435, -9262.67159505952, -9868.996848196846, -8651.32802107313, -11545.279935879587, -9693.582924516528, -8780.408732795293, -5466.929918910463, -7805.3825799294145, -11347.68446512103, -9017.224580009639, -5529.096406994829, -7944.042035378103, -10385.391011700955, -10533.944221667922, -6265.2187187662375, -7508.09955580879, -6275.285641116359, -7127.036547072269, -2024.881503640228, -9973.767505676034, -8501.06317436906, -4847.563983997595, -5932.219028138534, -5172.0342144170645, -8290.415531516066, -6012.85363534182, -8855.204748655477, -4347.841055135423, -10168.37431696207, -5988.475937647035, -11083.386579798524, -4513.547070134086, -11114.216722142568, -7737.6788700623665, -8310.225429990332, -6288.689647940179, -8283.846590629268, -3217.8121260558446, -9216.78241965563, -2911.0275154624987, -7759.005887217826, -8536.281813047992, -417.71387049647916, -7018.958193004045, -8890.023798748045, -3299.848355180596, -4737.077935738828, -8164.493395757365, -7761.759837174309, -5645.502692287469, -7960.011057789583, -8571.304815739742, -7241.186112155769, -9260.724845466599, -9512.01431683518, -5401.69427919809, -8160.311805946193, -5385.3791538135765, -5753.036817406386, -6151.692328594383, -10820.263400960377, -8136.618213398562, -7740.811109001814, -11401.366701145742, -8041.170334022284, -8018.296708410924, -11371.232225498234, -4457.05981422743, -8509.336315566037, -4633.259496840756, -9740.41913503843, -6457.23816917698, -5344.786492049905, -6264.798713878604, -8710.594465103824, -6553.395898999676, -6397.167177326898, -1462.854875128939], "episode_lengths": [103, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 149, 200, 162, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 139, 200, 200, 200, 200, 166, 200, 200, 200, 107, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 141, 200, 200, 11, 200, 200, 112, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 132], "policy_agent_policy_reward": [1037.20984458406, 7398.701099337787, 4010.1516500667612, 919.089088749422, 6705.773677161332, 3693.9965909884604, 7507.886911414941, 2459.653745869205, 3667.2042227155316, 6806.350604663031, 4975.463187207779, 836.9868537033882, 4987.680753270238, 1975.8952101021548, 4843.991903404696, 9808.321886404923, 2339.381124326699, 1567.204708705647, 3770.471027408702, 3986.424309057662, 4685.437836929155, 5515.214248478553, 6180.121303561478, 6236.549753994403, 4239.509720811173, 6189.119522622012, 6472.634533199645, 4213.394310835149, 1750.2888380887916, 5159.949605785638, 8484.970577703632, 6135.876039091421, 3902.6476379470714, 7096.444508748429, 7654.991878873227, 7389.3505810482875, 4704.65840626305, 4856.970041127329, 5296.882342578064, 5739.822264452026, 1435.6201818942561, 6791.032917224602, 6941.860516550305, 3784.1914366161836, 4824.240113590162, 1654.8886454801177, 5017.08337810216, 4800.537992713977, 5974.034803641833, 2372.9320667292513, 6879.0700838674675, 4712.700637895249, 6451.900389216174, 2809.797635443171, 6209.288444230743, 1440.695387748894, 7852.008939439611, 5318.255818531812, 4908.429514109923, 2796.4858270120926, 8464.588054799558, 2351.0394811589135, 6594.53637085998, 4941.936388728458, 29.254881572035096, 4284.635432167524, 6103.253255455398, 1388.7529086126583, 3051.683737592421, 4267.284275413214, 5363.238979069519, 1443.1077643951817, 5609.962706583635, 2703.315154926617, 6452.139544883119, 5775.129810336602, 1594.3931291398783, 2443.1311587715204, 6665.034536467833, 4208.167576731194, 3205.339779986076, 2490.1967660707455, 6722.244372735658, 6878.159096482945, 4386.836860397616, 5071.727769539858, 5946.761593996041, 7164.877171647338, 6151.051774681026, 4012.8668921132553, 6627.319908518715, 2243.606308532099, 3439.741299931075, 4593.915523735353, 3965.6163762521355, 5571.147429170915, 3548.376743092828, 5623.713757036651, 3501.020159753689, 688.2698965367096], "policy_adversary_policy_reward": [-2291.2236758506488, -1725.5480610544737, -7398.701099337787, -9829.927268070918, -8779.616756674453, -4010.1516500667612, -3876.0544645681607, -980.2702089644263, -11502.6621344765, -6705.773677161332, -3893.9270475880703, -4608.0894684484665, -8629.513252419409, -7511.67601782974, -6013.072764682935, -3088.928029182888, -3668.4078725606314, -5383.05468303135, -6806.350604663031, -9352.728471662089, -5305.888631744709, -5097.213338344677, -2056.0974656179287, -1358.9872312912964, -6218.398992637526, -7009.18520898037, -2759.1489020995364, -6307.389419168707, -4860.106973664147, -8057.216375014104, -9966.567188835832, -10635.246657196294, -2339.381124326699, -4793.26798594493, -6473.050738443754, -1567.204708705647, -7188.220181478225, -3783.139200844906, -7524.479508387691, -4923.888621629161, -7763.802691059726, -4685.437836929155, -5562.928514151773, -5954.920953978215, -8554.053532057349, -6888.7393665636555, -9681.000465929663, -6424.5461362615915, -4239.509720811173, -8651.328021073132, -11545.27993587959, -6189.119522622012, -6551.9341012989125, -9614.28335641726, -4557.921973117432, -8435.881070513009, -4410.3389109813415, -2806.879846017914, -5159.949605785638, -7805.3825799294145, -8484.970577703632, -11347.68446512103, -9016.56492376004, -6136.535695341019, -3902.6476379470714, -5529.096406994829, -7208.865815820689, -7831.620728305841, -7654.991878873227, -10385.391011700955, -9888.423235181386, -8034.871567534823, -5311.290180909807, -5658.586944119483, -4913.786607285756, -7451.282989650364, -5453.153022011585, -6119.01496168284, -7127.03654707227, -5739.822264452026, -1580.2678753890123, -1880.2338101454716, -6791.032917224602, -9973.767505676034, -6941.860516550305, -8501.06317436906, -4527.598858309204, -4104.156562304576, -5224.066772794361, -5532.392368934337, -4588.807823287032, -2238.11503661015, -8290.415531516068, -5017.08337810216, -6012.85363534182, -4800.537992713977, -8855.204748655475, -5974.034803641833, -2379.982384732865, -4340.790737131808, -10168.374316962072, -6879.0700838674675, -5944.715839562411, -4756.460735979874, -6451.900389216174, -11083.386579798524, -4073.6767050377885, -3249.668000539465, -6209.288444230743, -11114.216722142566, -1623.191106657147, -7555.183151154112, -7933.078049278201, -8229.15632015174, -5773.879999768966, -5833.065466703019, -8283.846590629268, -4908.429514109923, -3095.848505755075, -2918.449447312862, -9179.951672695568, -8501.418801759619, -2873.027128735868, -2389.0398678855445, -7052.623431882333, -7300.918826195473, -8536.281813047992, -4941.936388728458, -29.254881572035096, -417.71387049647916, -5019.805089286936, -6283.788535884632, -8890.023798748041, -6103.253255455398, -2621.5632436818023, -2067.0380201114526, -4546.19941223874, -3242.5622610925057, -5467.173743898771, -6964.603927271807, -5363.238979069519, -7761.759837174309, -1443.1077643951817, -5645.502692287469, -7960.011057789583, -5609.962706583635, -2703.315154926617, -8571.304815739742, -7165.856075444631, -6527.469581594257, -5854.536398680233, -9181.318257122968, -1594.3931291398783, -9512.01431683518, -2443.1311587715204, -5401.69427919809, -8160.311805946191, -6665.034536467833, -4483.8873732102775, -5109.659357334499, -5052.816918149663, -3905.559679242803, -2497.4395328054275, -6144.449561859702, -10673.654651510238, -6868.853122185795, -7182.792217578164, -7831.985092303344, -4386.836860397616, -7740.811109001814, -11401.366701145746, -5071.727769539858, -5946.761593996041, -8041.170334022284, -7722.828744295743, -7460.345135762524, -11371.232225498234, -6151.051774681026, -4359.350540016163, -4110.576166324512, -6627.319908518715, -8509.336315566037, -2882.086012923196, -3994.779792449652, -3439.741299931075, -9740.419135038432, -5079.224008633701, -5971.929684278624, -4493.061644554495, -4817.341223747544, -5954.65674323276, -5881.289399816759, -8710.594465103823, -3548.376743092828, -5890.793019231353, -6286.316636804973, -6397.037135543161, -3501.1502015374263, -688.2698965367096, -1462.854875128939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960522507708907, "mean_inference_ms": 0.9627150601170392, "mean_action_processing_ms": 0.1662562733077277, "mean_env_wait_ms": 0.050784397607703397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032695531845092773, "StateBufferConnector_ms": 0.0023840665817260742, "ViewRequirementAgentConnector_ms": 0.06557989120483398}, "num_episodes": 21, "episode_return_max": -417.71387049647916, "episode_return_min": -11545.279935879587, "episode_return_mean": -7302.365570789573}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.4762759077574, "num_env_steps_trained_throughput_per_sec": 545.4762759077574, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1692000, "timers": {"training_iteration_time_ms": 7403.268, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7403.234, "sample_time_ms": 759.717, "learn_time_ms": 6631.478, "learn_throughput": 603.184, "synch_weights_time_ms": 11.548}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "done": false, "training_iteration": 141, "trial_id": "3439d_00000", "date": "2024-08-09_15-43-59", "timestamp": 1723232639, "time_this_iter_s": 7.337007999420166, "time_total_s": 1052.7531900405884, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31abca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1052.7531900405884, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 28.320000000000004, "ram_util_percent": 83.17}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 304.5537811994553, "cur_kl_coeff": 9587.552961644204, "cur_lr": 5.0000000000000016e-05, "total_loss": 46.459662503004076, "policy_loss": 0.0029697096450642373, "vf_loss": 9.980492462714514, "vf_explained_var": -2.2868191202481587e-05, "kl": 0.0038045371317518097, "entropy": 1.1168262254446746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9745181038739189, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99946553063771, "policy_loss": 0.004263524613441732, "vf_loss": 9.990064919184125, "vf_explained_var": 7.681726778625811e-05, "kl": 0.018039652162167446, "entropy": 1.178327852077585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": -91.62186626008356, "episode_reward_min": -11545.279935879587, "episode_reward_mean": -6783.134872372003, "episode_len_mean": 181.13, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 18113, "policy_reward_min": {"agent_policy": 14.376086476596242, "adversary_policy": -11545.27993587959}, "policy_reward_max": {"agent_policy": 8647.521765137693, "adversary_policy": -14.376086476596242}, "policy_reward_mean": {"agent_policy": 4332.235639402066, "adversary_policy": -5557.685255887033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11545.279935879587, -9693.582924516528, -8780.408732795293, -5466.929918910463, -7805.3825799294145, -11347.68446512103, -9017.224580009639, -5529.096406994829, -7944.042035378103, -10385.391011700955, -10533.944221667922, -6265.2187187662375, -7508.09955580879, -6275.285641116359, -7127.036547072269, -2024.881503640228, -9973.767505676034, -8501.06317436906, -4847.563983997595, -5932.219028138534, -5172.0342144170645, -8290.415531516066, -6012.85363534182, -8855.204748655477, -4347.841055135423, -10168.37431696207, -5988.475937647035, -11083.386579798524, -4513.547070134086, -11114.216722142568, -7737.6788700623665, -8310.225429990332, -6288.689647940179, -8283.846590629268, -3217.8121260558446, -9216.78241965563, -2911.0275154624987, -7759.005887217826, -8536.281813047992, -417.71387049647916, -7018.958193004045, -8890.023798748045, -3299.848355180596, -4737.077935738828, -8164.493395757365, -7761.759837174309, -5645.502692287469, -7960.011057789583, -8571.304815739742, -7241.186112155769, -9260.724845466599, -9512.01431683518, -5401.69427919809, -8160.311805946193, -5385.3791538135765, -5753.036817406386, -6151.692328594383, -10820.263400960377, -8136.618213398562, -7740.811109001814, -11401.366701145742, -8041.170334022284, -8018.296708410924, -11371.232225498234, -4457.05981422743, -8509.336315566037, -4633.259496840756, -9740.41913503843, -6457.23816917698, -5344.786492049905, -6264.798713878604, -8710.594465103824, -6553.395898999676, -6397.167177326898, -1462.854875128939, -4624.581574345074, -7899.311459248547, -2410.8182864138194, -6443.74342590395, -5563.424284566705, -5398.315384955182, -7644.430469718456, -8120.343563763368, -5445.490181822142, -7650.41685661341, -91.62186626008356, -4438.563490528644, -2918.227686722916, -5587.568890894726, -10790.37593493995, -7852.3160318538585, -1301.3666492796604, -7091.086014753179, -152.63569587587827, -135.1335411938571, -3047.1822799821334, -6964.309673326968, -8415.96642878607, -3225.71142509002, -7395.340699952628], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 139, 200, 200, 200, 200, 166, 200, 200, 200, 107, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 141, 200, 200, 11, 200, 200, 112, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 132, 200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 10, 150, 73, 200, 200, 200, 41, 200, 5, 16, 78, 200, 200, 99, 200], "policy_agent_policy_reward": [6189.119522622012, 6472.634533199645, 4213.394310835149, 1750.2888380887916, 5159.949605785638, 8484.970577703632, 6135.876039091421, 3902.6476379470714, 7096.444508748429, 7654.991878873227, 7389.3505810482875, 4704.65840626305, 4856.970041127329, 5296.882342578064, 5739.822264452026, 1435.6201818942561, 6791.032917224602, 6941.860516550305, 3784.1914366161836, 4824.240113590162, 1654.8886454801177, 5017.08337810216, 4800.537992713977, 5974.034803641833, 2372.9320667292513, 6879.0700838674675, 4712.700637895249, 6451.900389216174, 2809.797635443171, 6209.288444230743, 1440.695387748894, 7852.008939439611, 5318.255818531812, 4908.429514109923, 2796.4858270120926, 8464.588054799558, 2351.0394811589135, 6594.53637085998, 4941.936388728458, 29.254881572035096, 4284.635432167524, 6103.253255455398, 1388.7529086126583, 3051.683737592421, 4267.284275413214, 5363.238979069519, 1443.1077643951817, 5609.962706583635, 2703.315154926617, 6452.139544883119, 5775.129810336602, 1594.3931291398783, 2443.1311587715204, 6665.034536467833, 4208.167576731194, 3205.339779986076, 2490.1967660707455, 6722.244372735658, 6878.159096482945, 4386.836860397616, 5071.727769539858, 5946.761593996041, 7164.877171647338, 6151.051774681026, 4012.8668921132553, 6627.319908518715, 2243.606308532099, 3439.741299931075, 4593.915523735353, 3965.6163762521355, 5571.147429170915, 3548.376743092828, 5623.713757036651, 3501.020159753689, 688.2698965367096, 3275.0393588363318, 2810.1295368771616, 1571.9036405103939, 5355.865780431194, 4385.940075884345, 2237.401249572423, 5941.2026086527485, 4892.65965386403, 4403.865376280472, 4879.13929151045, 37.82870476123935, 1483.433143522772, 1723.9378492635756, 3133.329470627456, 8647.521765137693, 5269.083794697533, 385.1747640382802, 4144.35993130648, 14.376086476596242, 47.03655791191194, 1530.4448033189224, 2607.8719653817616, 6879.032514009408, 676.0115731188494, 3300.543997936798], "policy_adversary_policy_reward": [-11545.27993587959, -6189.119522622012, -6551.9341012989125, -9614.28335641726, -4557.921973117432, -8435.881070513009, -4410.3389109813415, -2806.879846017914, -5159.949605785638, -7805.3825799294145, -8484.970577703632, -11347.68446512103, -9016.56492376004, -6136.535695341019, -3902.6476379470714, -5529.096406994829, -7208.865815820689, -7831.620728305841, -7654.991878873227, -10385.391011700955, -9888.423235181386, -8034.871567534823, -5311.290180909807, -5658.586944119483, -4913.786607285756, -7451.282989650364, -5453.153022011585, -6119.01496168284, -7127.03654707227, -5739.822264452026, -1580.2678753890123, -1880.2338101454716, -6791.032917224602, -9973.767505676034, -6941.860516550305, -8501.06317436906, -4527.598858309204, -4104.156562304576, -5224.066772794361, -5532.392368934337, -4588.807823287032, -2238.11503661015, -8290.415531516068, -5017.08337810216, -6012.85363534182, -4800.537992713977, -8855.204748655475, -5974.034803641833, -2379.982384732865, -4340.790737131808, -10168.374316962072, -6879.0700838674675, -5944.715839562411, -4756.460735979874, -6451.900389216174, -11083.386579798524, -4073.6767050377885, -3249.668000539465, -6209.288444230743, -11114.216722142566, -1623.191106657147, -7555.183151154112, -7933.078049278201, -8229.15632015174, -5773.879999768966, -5833.065466703019, -8283.846590629268, -4908.429514109923, -3095.848505755075, -2918.449447312862, -9179.951672695568, -8501.418801759619, -2873.027128735868, -2389.0398678855445, -7052.623431882333, -7300.918826195473, -8536.281813047992, -4941.936388728458, -29.254881572035096, -417.71387049647916, -5019.805089286936, -6283.788535884632, -8890.023798748041, -6103.253255455398, -2621.5632436818023, -2067.0380201114526, -4546.19941223874, -3242.5622610925057, -5467.173743898771, -6964.603927271807, -5363.238979069519, -7761.759837174309, -1443.1077643951817, -5645.502692287469, -7960.011057789583, -5609.962706583635, -2703.315154926617, -8571.304815739742, -7165.856075444631, -6527.469581594257, -5854.536398680233, -9181.318257122968, -1594.3931291398783, -9512.01431683518, -2443.1311587715204, -5401.69427919809, -8160.311805946191, -6665.034536467833, -4483.8873732102775, -5109.659357334499, -5052.816918149663, -3905.559679242803, -2497.4395328054275, -6144.449561859702, -10673.654651510238, -6868.853122185795, -7182.792217578164, -7831.985092303344, -4386.836860397616, -7740.811109001814, -11401.366701145746, -5071.727769539858, -5946.761593996041, -8041.170334022284, -7722.828744295743, -7460.345135762524, -11371.232225498234, -6151.051774681026, -4359.350540016163, -4110.576166324512, -6627.319908518715, -8509.336315566037, -2882.086012923196, -3994.779792449652, -3439.741299931075, -9740.419135038432, -5079.224008633701, -5971.929684278624, -4493.061644554495, -4817.341223747544, -5954.65674323276, -5881.289399816759, -8710.594465103823, -3548.376743092828, -5890.793019231353, -6286.316636804973, -6397.037135543161, -3501.1502015374263, -688.2698965367096, -1462.854875128939, -3403.5122461141523, -4496.108687067252, -3119.9420351438503, -7589.498960981859, -1708.0622728397627, -2274.659654084443, -5634.908157726248, -6164.701048608899, -4644.145904798067, -5305.218455652977, -2323.302816612294, -5312.413817915309, -5949.305587104539, -7636.327491266666, -5519.42036637346, -7493.582851253937, -5445.487206880909, -4403.868351221706, -6467.852781376601, -6061.703366747256, -91.62186626008358, -37.82870476123935, -1499.2367646197727, -4422.759869431643, -2913.4601959104357, -1728.7053400760556, -3309.935057400538, -5410.963304121643, -10790.37593493995, -8647.521765137693, -5269.083794697533, -7852.3160318538585, -385.1747640382802, -1301.3666492796604, -4744.652565500646, -6490.793380559017, -152.63569587587827, -14.376086476596242, -135.1335411938571, -47.03655791191194, -2530.309341526601, -2047.3177417744557, -6964.309673326967, -2607.8719653817616, -8415.96642878607, -6879.032514009408, -3225.7114250900195, -676.0115731188494, -7385.702401792677, -3310.1822960967475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959096853121189, "mean_inference_ms": 0.9625766294277025, "mean_action_processing_ms": 0.16624749169830202, "mean_env_wait_ms": 0.05078913048717133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033479928970336914, "StateBufferConnector_ms": 0.0024186372756958008, "ViewRequirementAgentConnector_ms": 0.06789505481719971}, "num_episodes": 25, "episode_return_max": -91.62186626008356, "episode_return_min": -11545.279935879587, "episode_return_mean": -6783.134872372003}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.1368878536233, "num_env_steps_trained_throughput_per_sec": 548.1368878536233, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 7406.722, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7406.688, "sample_time_ms": 760.745, "learn_time_ms": 6633.872, "learn_throughput": 602.966, "synch_weights_time_ms": 11.547}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 142, "trial_id": "3439d_00000", "date": "2024-08-09_15-44-07", "timestamp": 1723232647, "time_this_iter_s": 7.3027260303497314, "time_total_s": 1060.055916070938, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3223310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1060.055916070938, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 25.381818181818186, "ram_util_percent": 83.10909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.25155996084214, "cur_kl_coeff": 4793.776480822102, "cur_lr": 5.0000000000000016e-05, "total_loss": 24.94162672162056, "policy_loss": 0.00386534062223897, "vf_loss": 9.974357881148656, "vf_explained_var": -5.4630016287167867e-05, "kl": 0.0031214229352675223, "entropy": 1.1078279847900072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0053680624280656, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99404864084153, "policy_loss": 0.005181824090698409, "vf_loss": 9.98448541025636, "vf_explained_var": 0.0009608815271387655, "kl": 0.01538602199710945, "entropy": 1.1950123419837346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "env_runners": {"episode_reward_max": -91.62186626008356, "episode_reward_min": -11401.366701145742, "episode_reward_mean": -6435.637810178691, "episode_len_mean": 177.35, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17735, "policy_reward_min": {"agent_policy": 14.376086476596242, "adversary_policy": -11401.366701145746}, "policy_reward_max": {"agent_policy": 8647.521765137693, "adversary_policy": -14.376086476596242}, "policy_reward_mean": {"agent_policy": 3997.51835958574, "adversary_policy": -5216.578084882216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10168.37431696207, -5988.475937647035, -11083.386579798524, -4513.547070134086, -11114.216722142568, -7737.6788700623665, -8310.225429990332, -6288.689647940179, -8283.846590629268, -3217.8121260558446, -9216.78241965563, -2911.0275154624987, -7759.005887217826, -8536.281813047992, -417.71387049647916, -7018.958193004045, -8890.023798748045, -3299.848355180596, -4737.077935738828, -8164.493395757365, -7761.759837174309, -5645.502692287469, -7960.011057789583, -8571.304815739742, -7241.186112155769, -9260.724845466599, -9512.01431683518, -5401.69427919809, -8160.311805946193, -5385.3791538135765, -5753.036817406386, -6151.692328594383, -10820.263400960377, -8136.618213398562, -7740.811109001814, -11401.366701145742, -8041.170334022284, -8018.296708410924, -11371.232225498234, -4457.05981422743, -8509.336315566037, -4633.259496840756, -9740.41913503843, -6457.23816917698, -5344.786492049905, -6264.798713878604, -8710.594465103824, -6553.395898999676, -6397.167177326898, -1462.854875128939, -4624.581574345074, -7899.311459248547, -2410.8182864138194, -6443.74342590395, -5563.424284566705, -5398.315384955182, -7644.430469718456, -8120.343563763368, -5445.490181822142, -7650.41685661341, -91.62186626008356, -4438.563490528644, -2918.227686722916, -5587.568890894726, -10790.37593493995, -7852.3160318538585, -1301.3666492796604, -7091.086014753179, -152.63569587587827, -135.1335411938571, -3047.1822799821334, -6964.309673326968, -8415.96642878607, -3225.71142509002, -7395.340699952628, -7125.307540500782, -5937.729070122248, -6178.185274338745, -4438.086507998871, -7180.875904977936, -6883.766598153067, -5833.696043268175, -7791.437913788239, -3933.9769277704304, -3806.8760111701877, -8168.99043666856, -6737.770837125274, -7000.401560092219, -9698.16714576522, -1372.0891441776798, -6720.468536453205, -8022.576474357588, -5694.503360580143, -5907.248281334753, -7141.763030390049, -2632.4577359615237, -6291.804620275928, -6581.137290059529, -5779.127070712261, -7574.30212118109], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 141, 200, 200, 11, 200, 200, 112, 200, 200, 200, 146, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 132, 200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 10, 150, 73, 200, 200, 200, 41, 200, 5, 16, 78, 200, 200, 99, 200, 200, 200, 200, 130, 200, 200, 200, 200, 115, 135, 200, 152, 168, 200, 67, 200, 200, 175, 200, 200, 92, 200, 200, 200, 200], "policy_agent_policy_reward": [6879.0700838674675, 4712.700637895249, 6451.900389216174, 2809.797635443171, 6209.288444230743, 1440.695387748894, 7852.008939439611, 5318.255818531812, 4908.429514109923, 2796.4858270120926, 8464.588054799558, 2351.0394811589135, 6594.53637085998, 4941.936388728458, 29.254881572035096, 4284.635432167524, 6103.253255455398, 1388.7529086126583, 3051.683737592421, 4267.284275413214, 5363.238979069519, 1443.1077643951817, 5609.962706583635, 2703.315154926617, 6452.139544883119, 5775.129810336602, 1594.3931291398783, 2443.1311587715204, 6665.034536467833, 4208.167576731194, 3205.339779986076, 2490.1967660707455, 6722.244372735658, 6878.159096482945, 4386.836860397616, 5071.727769539858, 5946.761593996041, 7164.877171647338, 6151.051774681026, 4012.8668921132553, 6627.319908518715, 2243.606308532099, 3439.741299931075, 4593.915523735353, 3965.6163762521355, 5571.147429170915, 3548.376743092828, 5623.713757036651, 3501.020159753689, 688.2698965367096, 3275.0393588363318, 2810.1295368771616, 1571.9036405103939, 5355.865780431194, 4385.940075884345, 2237.401249572423, 5941.2026086527485, 4892.65965386403, 4403.865376280472, 4879.13929151045, 37.82870476123935, 1483.433143522772, 1723.9378492635756, 3133.329470627456, 8647.521765137693, 5269.083794697533, 385.1747640382802, 4144.35993130648, 14.376086476596242, 47.03655791191194, 1530.4448033189224, 2607.8719653817616, 6879.032514009408, 676.0115731188494, 3300.543997936798, 4310.458847409572, 3766.3021604892024, 4211.119904106159, 691.6835646489529, 6356.017394085161, 4040.8843776132376, 3445.626510625885, 5350.562539278911, 2648.627118940743, 1037.9222413321247, 4547.534558782861, 1028.2975303504782, 840.3310477588117, 6524.171789507859, 647.6506077177028, 6357.289840812373, 6464.5851743183875, 1822.7868275354456, 4114.6018089667, 6127.2047111519805, 1003.8698363222086, 4692.97617926475, 3300.0780670286185, 5310.114571572521, 6531.997949653444], "policy_adversary_policy_reward": [-10168.374316962072, -6879.0700838674675, -5944.715839562411, -4756.460735979874, -6451.900389216174, -11083.386579798524, -4073.6767050377885, -3249.668000539465, -6209.288444230743, -11114.216722142566, -1623.191106657147, -7555.183151154112, -7933.078049278201, -8229.15632015174, -5773.879999768966, -5833.065466703019, -8283.846590629268, -4908.429514109923, -3095.848505755075, -2918.449447312862, -9179.951672695568, -8501.418801759619, -2873.027128735868, -2389.0398678855445, -7052.623431882333, -7300.918826195473, -8536.281813047992, -4941.936388728458, -29.254881572035096, -417.71387049647916, -5019.805089286936, -6283.788535884632, -8890.023798748041, -6103.253255455398, -2621.5632436818023, -2067.0380201114526, -4546.19941223874, -3242.5622610925057, -5467.173743898771, -6964.603927271807, -5363.238979069519, -7761.759837174309, -1443.1077643951817, -5645.502692287469, -7960.011057789583, -5609.962706583635, -2703.315154926617, -8571.304815739742, -7165.856075444631, -6527.469581594257, -5854.536398680233, -9181.318257122968, -1594.3931291398783, -9512.01431683518, -2443.1311587715204, -5401.69427919809, -8160.311805946191, -6665.034536467833, -4483.8873732102775, -5109.659357334499, -5052.816918149663, -3905.559679242803, -2497.4395328054275, -6144.449561859702, -10673.654651510238, -6868.853122185795, -7182.792217578164, -7831.985092303344, -4386.836860397616, -7740.811109001814, -11401.366701145746, -5071.727769539858, -5946.761593996041, -8041.170334022284, -7722.828744295743, -7460.345135762524, -11371.232225498234, -6151.051774681026, -4359.350540016163, -4110.576166324512, -6627.319908518715, -8509.336315566037, -2882.086012923196, -3994.779792449652, -3439.741299931075, -9740.419135038432, -5079.224008633701, -5971.929684278624, -4493.061644554495, -4817.341223747544, -5954.65674323276, -5881.289399816759, -8710.594465103823, -3548.376743092828, -5890.793019231353, -6286.316636804973, -6397.037135543161, -3501.1502015374263, -688.2698965367096, -1462.854875128939, -3403.5122461141523, -4496.108687067252, -3119.9420351438503, -7589.498960981859, -1708.0622728397627, -2274.659654084443, -5634.908157726248, -6164.701048608899, -4644.145904798067, -5305.218455652977, -2323.302816612294, -5312.413817915309, -5949.305587104539, -7636.327491266666, -5519.42036637346, -7493.582851253937, -5445.487206880909, -4403.868351221706, -6467.852781376601, -6061.703366747256, -91.62186626008358, -37.82870476123935, -1499.2367646197727, -4422.759869431643, -2913.4601959104357, -1728.7053400760556, -3309.935057400538, -5410.963304121643, -10790.37593493995, -8647.521765137693, -5269.083794697533, -7852.3160318538585, -385.1747640382802, -1301.3666492796604, -4744.652565500646, -6490.793380559017, -152.63569587587827, -14.376086476596242, -135.1335411938571, -47.03655791191194, -2530.309341526601, -2047.3177417744557, -6964.309673326967, -2607.8719653817616, -8415.96642878607, -6879.032514009408, -3225.7114250900195, -676.0115731188494, -7385.702401792677, -3310.1822960967475, -7125.307540500781, -4310.458847409572, -5923.308167342772, -3780.723063268678, -4290.193844059791, -6099.111334385112, -691.6835646489529, -4438.086507998871, -7090.011140737692, -6446.882158325405, -6883.766598153067, -4040.8843776132376, -5833.696043268175, -3445.626510625885, -7749.886469029237, -5392.113984037914, -3264.5079323000223, -3318.09611441115, -1042.780809773171, -3802.0174427291413, -4547.534558782861, -8168.990436668558, -1028.2975303504782, -6737.770837125274, -7000.401560092219, -840.3310477588117, -9698.167145765221, -6524.171789507859, -878.1172680974133, -1141.6224837979687, -6512.534771668274, -6565.2236055973035, -7028.230487074219, -7458.931161601756, -5694.503360580143, -1822.7868275354456, -4141.7136329228215, -5880.136457378633, -6127.2047111519805, -7141.763030390049, -1158.8860794831746, -2477.4414928005594, -5353.7697308402585, -5631.011068700417, -3300.0780670286185, -6581.13729005953, -5757.5302482819025, -5331.711394002878, -7468.2592763065595, -6638.040794527974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958454681875454, "mean_inference_ms": 0.9627032330037799, "mean_action_processing_ms": 0.1661717001722321, "mean_env_wait_ms": 0.050764820889679735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003319382667541504, "StateBufferConnector_ms": 0.0023459196090698242, "ViewRequirementAgentConnector_ms": 0.06632328033447266}, "num_episodes": 25, "episode_return_max": -91.62186626008356, "episode_return_min": -11401.366701145742, "episode_return_mean": -6435.637810178691}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.5102154594566, "num_env_steps_trained_throughput_per_sec": 546.5102154594566, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 7421.626, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7421.593, "sample_time_ms": 761.419, "learn_time_ms": 6648.085, "learn_throughput": 601.677, "synch_weights_time_ms": 11.56}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "training_iteration": 143, "trial_id": "3439d_00000", "date": "2024-08-09_15-44-14", "timestamp": 1723232654, "time_this_iter_s": 7.324257135391235, "time_total_s": 1067.3801732063293, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32233a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1067.3801732063293, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 26.120000000000005, "ram_util_percent": 82.98999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.21674289206663, "cur_kl_coeff": 2396.888240411051, "cur_lr": 5.0000000000000016e-05, "total_loss": 18.08637296160062, "policy_loss": -0.00031640358841589965, "vf_loss": 9.968244787057241, "vf_explained_var": -0.0003138580669959386, "kl": 0.0033870768907945602, "entropy": 1.0991040752579768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0203457019001088, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987463975835729, "policy_loss": 0.0015708958817567066, "vf_loss": 9.981590502602714, "vf_explained_var": 0.00011679795053270128, "kl": 0.015109189000552293, "entropy": 1.2387383576423403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": -91.62186626008356, "episode_reward_min": -11401.366701145742, "episode_reward_mean": -5971.075031670346, "episode_len_mean": 170.83, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 17083, "policy_reward_min": {"agent_policy": 14.376086476596242, "adversary_policy": -11401.366701145746}, "policy_reward_max": {"agent_policy": 8647.521765137693, "adversary_policy": -14.376086476596242}, "policy_reward_mean": {"agent_policy": 3699.366508952963, "adversary_policy": -4835.220770311655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7241.186112155769, -9260.724845466599, -9512.01431683518, -5401.69427919809, -8160.311805946193, -5385.3791538135765, -5753.036817406386, -6151.692328594383, -10820.263400960377, -8136.618213398562, -7740.811109001814, -11401.366701145742, -8041.170334022284, -8018.296708410924, -11371.232225498234, -4457.05981422743, -8509.336315566037, -4633.259496840756, -9740.41913503843, -6457.23816917698, -5344.786492049905, -6264.798713878604, -8710.594465103824, -6553.395898999676, -6397.167177326898, -1462.854875128939, -4624.581574345074, -7899.311459248547, -2410.8182864138194, -6443.74342590395, -5563.424284566705, -5398.315384955182, -7644.430469718456, -8120.343563763368, -5445.490181822142, -7650.41685661341, -91.62186626008356, -4438.563490528644, -2918.227686722916, -5587.568890894726, -10790.37593493995, -7852.3160318538585, -1301.3666492796604, -7091.086014753179, -152.63569587587827, -135.1335411938571, -3047.1822799821334, -6964.309673326968, -8415.96642878607, -3225.71142509002, -7395.340699952628, -7125.307540500782, -5937.729070122248, -6178.185274338745, -4438.086507998871, -7180.875904977936, -6883.766598153067, -5833.696043268175, -7791.437913788239, -3933.9769277704304, -3806.8760111701877, -8168.99043666856, -6737.770837125274, -7000.401560092219, -9698.16714576522, -1372.0891441776798, -6720.468536453205, -8022.576474357588, -5694.503360580143, -5907.248281334753, -7141.763030390049, -2632.4577359615237, -6291.804620275928, -6581.137290059529, -5779.127070712261, -7574.30212118109, -4482.2386496972795, -1742.2094123063387, -8012.925909518054, -3328.5659246155064, -7304.2689390317655, -758.0575496804528, -8255.791167875721, -6677.84569192586, -5663.458522701128, -8952.599057644287, -1022.2667933849493, -3498.5808367875507, -5692.477273379943, -6380.201109742978, -3396.0952148991532, -5485.1686432302795, -8421.969811839546, -7138.911473625514, -5777.014141264967, -1826.8224844093577, -228.8648575774476, -3165.200829975804, -8336.680495554036, -5591.5522371602365], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 132, 200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 10, 150, 73, 200, 200, 200, 41, 200, 5, 16, 78, 200, 200, 99, 200, 200, 200, 200, 130, 200, 200, 200, 200, 115, 135, 200, 152, 168, 200, 67, 200, 200, 175, 200, 200, 92, 200, 200, 200, 200, 200, 92, 200, 99, 200, 24, 200, 200, 200, 200, 31, 161, 200, 200, 146, 200, 200, 200, 200, 76, 27, 102, 200, 200], "policy_agent_policy_reward": [6452.139544883119, 5775.129810336602, 1594.3931291398783, 2443.1311587715204, 6665.034536467833, 4208.167576731194, 3205.339779986076, 2490.1967660707455, 6722.244372735658, 6878.159096482945, 4386.836860397616, 5071.727769539858, 5946.761593996041, 7164.877171647338, 6151.051774681026, 4012.8668921132553, 6627.319908518715, 2243.606308532099, 3439.741299931075, 4593.915523735353, 3965.6163762521355, 5571.147429170915, 3548.376743092828, 5623.713757036651, 3501.020159753689, 688.2698965367096, 3275.0393588363318, 2810.1295368771616, 1571.9036405103939, 5355.865780431194, 4385.940075884345, 2237.401249572423, 5941.2026086527485, 4892.65965386403, 4403.865376280472, 4879.13929151045, 37.82870476123935, 1483.433143522772, 1723.9378492635756, 3133.329470627456, 8647.521765137693, 5269.083794697533, 385.1747640382802, 4144.35993130648, 14.376086476596242, 47.03655791191194, 1530.4448033189224, 2607.8719653817616, 6879.032514009408, 676.0115731188494, 3300.543997936798, 4310.458847409572, 3766.3021604892024, 4211.119904106159, 691.6835646489529, 6356.017394085161, 4040.8843776132376, 3445.626510625885, 5350.562539278911, 2648.627118940743, 1037.9222413321247, 4547.534558782861, 1028.2975303504782, 840.3310477588117, 6524.171789507859, 647.6506077177028, 6357.289840812373, 6464.5851743183875, 1822.7868275354456, 4114.6018089667, 6127.2047111519805, 1003.8698363222086, 4692.97617926475, 3300.0780670286185, 5310.114571572521, 6531.997949653444, 3752.553119799228, 1436.6635225674336, 4331.765946698499, 1042.1033376688295, 5166.475312334391, 119.15780373719221, 5016.375160626112, 2617.735410753953, 4955.524607145227, 6382.161750256192, 147.87228460456066, 1320.704718729043, 1659.047943003599, 4480.624974144227, 1246.6126663914451, 4832.908630686028, 4500.634940960281, 6427.687000066984, 4720.511937235806, 952.1051969483295, 105.0571444450397, 1297.3459377612387, 6019.140651103798, 3629.267007885122], "policy_adversary_policy_reward": [-7165.856075444631, -6527.469581594257, -5854.536398680233, -9181.318257122968, -1594.3931291398783, -9512.01431683518, -2443.1311587715204, -5401.69427919809, -8160.311805946191, -6665.034536467833, -4483.8873732102775, -5109.659357334499, -5052.816918149663, -3905.559679242803, -2497.4395328054275, -6144.449561859702, -10673.654651510238, -6868.853122185795, -7182.792217578164, -7831.985092303344, -4386.836860397616, -7740.811109001814, -11401.366701145746, -5071.727769539858, -5946.761593996041, -8041.170334022284, -7722.828744295743, -7460.345135762524, -11371.232225498234, -6151.051774681026, -4359.350540016163, -4110.576166324512, -6627.319908518715, -8509.336315566037, -2882.086012923196, -3994.779792449652, -3439.741299931075, -9740.419135038432, -5079.224008633701, -5971.929684278624, -4493.061644554495, -4817.341223747544, -5954.65674323276, -5881.289399816759, -8710.594465103823, -3548.376743092828, -5890.793019231353, -6286.316636804973, -6397.037135543161, -3501.1502015374263, -688.2698965367096, -1462.854875128939, -3403.5122461141523, -4496.108687067252, -3119.9420351438503, -7589.498960981859, -1708.0622728397627, -2274.659654084443, -5634.908157726248, -6164.701048608899, -4644.145904798067, -5305.218455652977, -2323.302816612294, -5312.413817915309, -5949.305587104539, -7636.327491266666, -5519.42036637346, -7493.582851253937, -5445.487206880909, -4403.868351221706, -6467.852781376601, -6061.703366747256, -91.62186626008358, -37.82870476123935, -1499.2367646197727, -4422.759869431643, -2913.4601959104357, -1728.7053400760556, -3309.935057400538, -5410.963304121643, -10790.37593493995, -8647.521765137693, -5269.083794697533, -7852.3160318538585, -385.1747640382802, -1301.3666492796604, -4744.652565500646, -6490.793380559017, -152.63569587587827, -14.376086476596242, -135.1335411938571, -47.03655791191194, -2530.309341526601, -2047.3177417744557, -6964.309673326967, -2607.8719653817616, -8415.96642878607, -6879.032514009408, -3225.7114250900195, -676.0115731188494, -7385.702401792677, -3310.1822960967475, -7125.307540500781, -4310.458847409572, -5923.308167342772, -3780.723063268678, -4290.193844059791, -6099.111334385112, -691.6835646489529, -4438.086507998871, -7090.011140737692, -6446.882158325405, -6883.766598153067, -4040.8843776132376, -5833.696043268175, -3445.626510625885, -7749.886469029237, -5392.113984037914, -3264.5079323000223, -3318.09611441115, -1042.780809773171, -3802.0174427291413, -4547.534558782861, -8168.990436668558, -1028.2975303504782, -6737.770837125274, -7000.401560092219, -840.3310477588117, -9698.167145765221, -6524.171789507859, -878.1172680974133, -1141.6224837979687, -6512.534771668274, -6565.2236055973035, -7028.230487074219, -7458.931161601756, -5694.503360580143, -1822.7868275354456, -4141.7136329228215, -5880.136457378633, -6127.2047111519805, -7141.763030390049, -1158.8860794831746, -2477.4414928005594, -5353.7697308402585, -5631.011068700417, -3300.0780670286185, -6581.13729005953, -5757.5302482819025, -5331.711394002878, -7468.2592763065595, -6638.040794527974, -4201.3607100571, -4033.431059439402, -1717.1294481872521, -1461.7434866865224, -4331.765946698499, -8012.925909518054, -1042.1033376688295, -3328.5659246155064, -7164.088601281009, -5306.655650085149, -119.15780373719221, -758.0575496804528, -8255.791167875721, -5016.375160626112, -2617.735410753953, -6677.84569192586, -5553.8869938489315, -5065.09613599742, -6382.161750256192, -8952.59905764429, -147.87228460456066, -1022.2667933849493, -1555.5534782814727, -3263.7320772351213, -5175.147688990592, -2176.3775273929573, -4507.409388718232, -6353.416695168976, -3256.985910413049, -1385.72197087755, -5360.121526769792, -4957.955747146514, -8421.969811839546, -4500.634940960281, -6432.560386101557, -7134.03808759094, -5219.039432768567, -5278.486645732204, -1826.8224844093577, -952.1051969483295, -128.66687174470565, -205.25513027778163, -1480.8621908928374, -2981.684576844205, -6934.776199082603, -7421.044947575234, -3972.858150329463, -5247.961094715895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39579075783639367, "mean_inference_ms": 0.9614476574971573, "mean_action_processing_ms": 0.16616833106737605, "mean_env_wait_ms": 0.050756614927815316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034395456314086914, "StateBufferConnector_ms": 0.0024253129959106445, "ViewRequirementAgentConnector_ms": 0.06805777549743652}, "num_episodes": 24, "episode_return_max": -91.62186626008356, "episode_return_min": -11401.366701145742, "episode_return_mean": -5971.075031670346}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.3247646897174, "num_env_steps_trained_throughput_per_sec": 544.3247646897174, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 7422.254, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7422.221, "sample_time_ms": 745.699, "learn_time_ms": 6664.105, "learn_throughput": 600.231, "synch_weights_time_ms": 11.886}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 144, "trial_id": "3439d_00000", "date": "2024-08-09_15-44-22", "timestamp": 1723232662, "time_this_iter_s": 7.352737665176392, "time_total_s": 1074.7329108715057, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31abdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1074.7329108715057, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 27.018181818181816, "ram_util_percent": 83.17272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.27409701049328, "cur_kl_coeff": 1198.4441202055255, "cur_lr": 5.0000000000000016e-05, "total_loss": 15.441985831658046, "policy_loss": 0.0009177754565219705, "vf_loss": 9.976939406991004, "vf_explained_var": -0.00011377924432357153, "kl": 0.0045593521297026506, "entropy": 1.1116838437815508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0645228273338743, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.989214114032725, "policy_loss": -0.00028601555528227614, "vf_loss": 9.985560220385354, "vf_explained_var": 0.00016100709400479756, "kl": 0.013835583100460036, "entropy": 1.30654013585792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "env_runners": {"episode_reward_max": -91.62186626008356, "episode_reward_min": -10790.37593493995, "episode_reward_mean": -5344.667816282981, "episode_len_mean": 161.0, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 16100, "policy_reward_min": {"agent_policy": 14.376086476596242, "adversary_policy": -10790.37593493995}, "policy_reward_max": {"agent_policy": 8647.521765137693, "adversary_policy": -14.376086476596242}, "policy_reward_mean": {"agent_policy": 3352.3311777703843, "adversary_policy": -4348.499497026683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4624.581574345074, -7899.311459248547, -2410.8182864138194, -6443.74342590395, -5563.424284566705, -5398.315384955182, -7644.430469718456, -8120.343563763368, -5445.490181822142, -7650.41685661341, -91.62186626008356, -4438.563490528644, -2918.227686722916, -5587.568890894726, -10790.37593493995, -7852.3160318538585, -1301.3666492796604, -7091.086014753179, -152.63569587587827, -135.1335411938571, -3047.1822799821334, -6964.309673326968, -8415.96642878607, -3225.71142509002, -7395.340699952628, -7125.307540500782, -5937.729070122248, -6178.185274338745, -4438.086507998871, -7180.875904977936, -6883.766598153067, -5833.696043268175, -7791.437913788239, -3933.9769277704304, -3806.8760111701877, -8168.99043666856, -6737.770837125274, -7000.401560092219, -9698.16714576522, -1372.0891441776798, -6720.468536453205, -8022.576474357588, -5694.503360580143, -5907.248281334753, -7141.763030390049, -2632.4577359615237, -6291.804620275928, -6581.137290059529, -5779.127070712261, -7574.30212118109, -4482.2386496972795, -1742.2094123063387, -8012.925909518054, -3328.5659246155064, -7304.2689390317655, -758.0575496804528, -8255.791167875721, -6677.84569192586, -5663.458522701128, -8952.599057644287, -1022.2667933849493, -3498.5808367875507, -5692.477273379943, -6380.201109742978, -3396.0952148991532, -5485.1686432302795, -8421.969811839546, -7138.911473625514, -5777.014141264967, -1826.8224844093577, -228.8648575774476, -3165.200829975804, -8336.680495554036, -5591.5522371602365, -8616.864116196044, -4609.777850449622, -5786.609816214121, -7172.368633412327, -2942.2309771458754, -7764.914756442128, -6942.2392710223585, -514.0773629079087, -7472.750564195457, -2126.373492461641, -4708.763989290002, -7099.032432093834, -7658.452847969373, -5683.177734988641, -7631.908913105866, -6226.825365684552, -2603.9586571748055, -7285.789878629955, -1087.9822692679918, -1922.9116170927684, -1014.7562271991579, -3964.190680201609, -4024.990358383205, -6730.641607324312, -5286.379422408935, -1408.0185251925634], "episode_lengths": [200, 200, 115, 200, 200, 200, 200, 200, 200, 200, 10, 150, 73, 200, 200, 200, 41, 200, 5, 16, 78, 200, 200, 99, 200, 200, 200, 200, 130, 200, 200, 200, 200, 115, 135, 200, 152, 168, 200, 67, 200, 200, 175, 200, 200, 92, 200, 200, 200, 200, 200, 92, 200, 99, 200, 24, 200, 200, 200, 200, 31, 161, 200, 200, 146, 200, 200, 200, 200, 76, 27, 102, 200, 200, 200, 200, 200, 200, 113, 200, 200, 25, 200, 96, 155, 200, 200, 200, 200, 200, 110, 200, 52, 47, 37, 200, 200, 200, 200, 86], "policy_agent_policy_reward": [3275.0393588363318, 2810.1295368771616, 1571.9036405103939, 5355.865780431194, 4385.940075884345, 2237.401249572423, 5941.2026086527485, 4892.65965386403, 4403.865376280472, 4879.13929151045, 37.82870476123935, 1483.433143522772, 1723.9378492635756, 3133.329470627456, 8647.521765137693, 5269.083794697533, 385.1747640382802, 4144.35993130648, 14.376086476596242, 47.03655791191194, 1530.4448033189224, 2607.8719653817616, 6879.032514009408, 676.0115731188494, 3300.543997936798, 4310.458847409572, 3766.3021604892024, 4211.119904106159, 691.6835646489529, 6356.017394085161, 4040.8843776132376, 3445.626510625885, 5350.562539278911, 2648.627118940743, 1037.9222413321247, 4547.534558782861, 1028.2975303504782, 840.3310477588117, 6524.171789507859, 647.6506077177028, 6357.289840812373, 6464.5851743183875, 1822.7868275354456, 4114.6018089667, 6127.2047111519805, 1003.8698363222086, 4692.97617926475, 3300.0780670286185, 5310.114571572521, 6531.997949653444, 3752.553119799228, 1436.6635225674336, 4331.765946698499, 1042.1033376688295, 5166.475312334391, 119.15780373719221, 5016.375160626112, 2617.735410753953, 4955.524607145227, 6382.161750256192, 147.87228460456066, 1320.704718729043, 1659.047943003599, 4480.624974144227, 1246.6126663914451, 4832.908630686028, 4500.634940960281, 6427.687000066984, 4720.511937235806, 952.1051969483295, 105.0571444450397, 1297.3459377612387, 6019.140651103798, 3629.267007885122, 4175.99486784438, 3550.646044761124, 4168.01444964163, 4841.921199323783, 1244.927451600114, 5524.727546283535, 6065.6284371216725, 81.23054913167189, 4040.4973362286973, 698.457745429432, 1889.3611630464727, 2823.55813992985, 5821.07717557052, 4848.470893782915, 3366.4464392399905, 5714.442107220087, 1785.091039353503, 6120.0160075605, 660.3459646331897, 548.9025159940235, 252.75552337612882, 2643.331645028274, 3069.332010769075, 5554.2399659621815, 4347.189221750936, 430.6466776993087], "policy_adversary_policy_reward": [-3403.5122461141523, -4496.108687067252, -3119.9420351438503, -7589.498960981859, -1708.0622728397627, -2274.659654084443, -5634.908157726248, -6164.701048608899, -4644.145904798067, -5305.218455652977, -2323.302816612294, -5312.413817915309, -5949.305587104539, -7636.327491266666, -5519.42036637346, -7493.582851253937, -5445.487206880909, -4403.868351221706, -6467.852781376601, -6061.703366747256, -91.62186626008358, -37.82870476123935, -1499.2367646197727, -4422.759869431643, -2913.4601959104357, -1728.7053400760556, -3309.935057400538, -5410.963304121643, -10790.37593493995, -8647.521765137693, -5269.083794697533, -7852.3160318538585, -385.1747640382802, -1301.3666492796604, -4744.652565500646, -6490.793380559017, -152.63569587587827, -14.376086476596242, -135.1335411938571, -47.03655791191194, -2530.309341526601, -2047.3177417744557, -6964.309673326967, -2607.8719653817616, -8415.96642878607, -6879.032514009408, -3225.7114250900195, -676.0115731188494, -7385.702401792677, -3310.1822960967475, -7125.307540500781, -4310.458847409572, -5923.308167342772, -3780.723063268678, -4290.193844059791, -6099.111334385112, -691.6835646489529, -4438.086507998871, -7090.011140737692, -6446.882158325405, -6883.766598153067, -4040.8843776132376, -5833.696043268175, -3445.626510625885, -7749.886469029237, -5392.113984037914, -3264.5079323000223, -3318.09611441115, -1042.780809773171, -3802.0174427291413, -4547.534558782861, -8168.990436668558, -1028.2975303504782, -6737.770837125274, -7000.401560092219, -840.3310477588117, -9698.167145765221, -6524.171789507859, -878.1172680974133, -1141.6224837979687, -6512.534771668274, -6565.2236055973035, -7028.230487074219, -7458.931161601756, -5694.503360580143, -1822.7868275354456, -4141.7136329228215, -5880.136457378633, -6127.2047111519805, -7141.763030390049, -1158.8860794831746, -2477.4414928005594, -5353.7697308402585, -5631.011068700417, -3300.0780670286185, -6581.13729005953, -5757.5302482819025, -5331.711394002878, -7468.2592763065595, -6638.040794527974, -4201.3607100571, -4033.431059439402, -1717.1294481872521, -1461.7434866865224, -4331.765946698499, -8012.925909518054, -1042.1033376688295, -3328.5659246155064, -7164.088601281009, -5306.655650085149, -119.15780373719221, -758.0575496804528, -8255.791167875721, -5016.375160626112, -2617.735410753953, -6677.84569192586, -5553.8869938489315, -5065.09613599742, -6382.161750256192, -8952.59905764429, -147.87228460456066, -1022.2667933849493, -1555.5534782814727, -3263.7320772351213, -5175.147688990592, -2176.3775273929573, -4507.409388718232, -6353.416695168976, -3256.985910413049, -1385.72197087755, -5360.121526769792, -4957.955747146514, -8421.969811839546, -4500.634940960281, -6432.560386101557, -7134.03808759094, -5219.039432768567, -5278.486645732204, -1826.8224844093577, -952.1051969483295, -128.66687174470565, -205.25513027778163, -1480.8621908928374, -2981.684576844205, -6934.776199082603, -7421.044947575234, -3972.858150329463, -5247.961094715895, -8578.436033523143, -4214.422950517282, -4469.546682990944, -3690.877212219799, -4190.622662522458, -5764.001603333293, -4841.921199323783, -7172.368633412327, -1385.8796154483337, -2801.2788132976534, -5525.247287054727, -7764.395015670936, -6885.30986299284, -6122.557845151189, -81.23054913167189, -514.0773629079087, -7472.750564195459, -4040.4973362286973, -1974.3025592265778, -850.5286786644951, -3092.152807017264, -3505.972345319226, -7088.806543593037, -2833.7840284306476, -7432.278731254967, -6047.251292284929, -5674.632980486764, -4857.015648284792, -7631.9089131058645, -3366.4464392399905, -6166.935408763988, -5774.33206414065, -2055.1378507192053, -2333.9118458091016, -6120.0160075605, -7285.789878629954, -682.1407753534012, -1066.1874585477804, -1922.9116170927682, -548.9025159940235, -1014.7562271991579, -252.75552337612882, -3652.907593460133, -2954.6147317697514, -3781.5356037456095, -3312.7867654066704, -6675.659031866906, -5609.222541419586, -5248.856981439606, -4384.711662720265, -1135.7180400272493, -702.9471628646246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39562937469991416, "mean_inference_ms": 0.9615611799494652, "mean_action_processing_ms": 0.16606188284948573, "mean_env_wait_ms": 0.05077097217700167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034372806549072266, "StateBufferConnector_ms": 0.002406477928161621, "ViewRequirementAgentConnector_ms": 0.0680990219116211}, "num_episodes": 26, "episode_return_max": -91.62186626008356, "episode_return_min": -10790.37593493995, "episode_return_mean": -5344.667816282981}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.7022557177099, "num_env_steps_trained_throughput_per_sec": 553.7022557177099, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1740000, "timers": {"training_iteration_time_ms": 7406.086, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7406.053, "sample_time_ms": 745.511, "learn_time_ms": 6648.011, "learn_throughput": 601.684, "synch_weights_time_ms": 12.0}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "done": false, "training_iteration": 145, "trial_id": "3439d_00000", "date": "2024-08-09_15-44-29", "timestamp": 1723232669, "time_this_iter_s": 7.228701114654541, "time_total_s": 1081.9616119861603, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32239d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1081.9616119861603, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 24.781818181818178, "ram_util_percent": 82.83636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.459481596698364, "cur_kl_coeff": 599.2220601027627, "cur_lr": 5.0000000000000016e-05, "total_loss": 13.736019423604011, "policy_loss": 0.0020502812054473906, "vf_loss": 9.966239005327225, "vf_explained_var": -0.000283973291516304, "kl": 0.006287702776414032, "entropy": 1.1440270607670149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1038315850748588, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98550483713705, "policy_loss": 0.001300931796825752, "vf_loss": 9.979963849587415, "vf_explained_var": -0.0009060771692366828, "kl": 0.01488958137977139, "entropy": 1.340604546587303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": -64.43735274497175, "episode_reward_min": -9698.16714576522, "episode_reward_mean": -5297.409772123507, "episode_len_mean": 160.01, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 16001, "policy_reward_min": {"agent_policy": 9.090222469847246, "adversary_policy": -9698.167145765221}, "policy_reward_max": {"agent_policy": 7603.275611902329, "adversary_policy": -9.090222469847246}, "policy_reward_mean": {"agent_policy": 3309.5254489038966, "adversary_policy": -4303.467610513702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6178.185274338745, -4438.086507998871, -7180.875904977936, -6883.766598153067, -5833.696043268175, -7791.437913788239, -3933.9769277704304, -3806.8760111701877, -8168.99043666856, -6737.770837125274, -7000.401560092219, -9698.16714576522, -1372.0891441776798, -6720.468536453205, -8022.576474357588, -5694.503360580143, -5907.248281334753, -7141.763030390049, -2632.4577359615237, -6291.804620275928, -6581.137290059529, -5779.127070712261, -7574.30212118109, -4482.2386496972795, -1742.2094123063387, -8012.925909518054, -3328.5659246155064, -7304.2689390317655, -758.0575496804528, -8255.791167875721, -6677.84569192586, -5663.458522701128, -8952.599057644287, -1022.2667933849493, -3498.5808367875507, -5692.477273379943, -6380.201109742978, -3396.0952148991532, -5485.1686432302795, -8421.969811839546, -7138.911473625514, -5777.014141264967, -1826.8224844093577, -228.8648575774476, -3165.200829975804, -8336.680495554036, -5591.5522371602365, -8616.864116196044, -4609.777850449622, -5786.609816214121, -7172.368633412327, -2942.2309771458754, -7764.914756442128, -6942.2392710223585, -514.0773629079087, -7472.750564195457, -2126.373492461641, -4708.763989290002, -7099.032432093834, -7658.452847969373, -5683.177734988641, -7631.908913105866, -6226.825365684552, -2603.9586571748055, -7285.789878629955, -1087.9822692679918, -1922.9116170927684, -1014.7562271991579, -3964.190680201609, -4024.990358383205, -6730.641607324312, -5286.379422408935, -1408.0185251925634, -6702.462720295082, -8838.52008130363, -1960.7030675623764, -2477.3696315561924, -6317.951377394632, -1974.081302797392, -5391.189135386721, -4109.999295792413, -7837.918144414429, -8263.96375734511, -8622.105072569919, -1107.283214379403, -4073.0280447413024, -2589.0119749078203, -1494.455749210423, -64.43735274497175, -1306.5850596708071, -3276.3694364956023, -6765.4986958219015, -8950.830288846613, -3501.6884351940034, -6853.051250912715, -5491.05671398349, -7574.0974455993655, -7996.104240094013, -7126.227918494104, -8279.52458395242], "episode_lengths": [200, 130, 200, 200, 200, 200, 115, 135, 200, 152, 168, 200, 67, 200, 200, 175, 200, 200, 92, 200, 200, 200, 200, 200, 92, 200, 99, 200, 24, 200, 200, 200, 200, 31, 161, 200, 200, 146, 200, 200, 200, 200, 76, 27, 102, 200, 200, 200, 200, 200, 200, 113, 200, 200, 25, 200, 96, 155, 200, 200, 200, 200, 200, 110, 200, 52, 47, 37, 200, 200, 200, 200, 86, 200, 200, 82, 101, 200, 98, 187, 200, 200, 200, 200, 33, 92, 99, 71, 5, 87, 144, 200, 200, 89, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4211.119904106159, 691.6835646489529, 6356.017394085161, 4040.8843776132376, 3445.626510625885, 5350.562539278911, 2648.627118940743, 1037.9222413321247, 4547.534558782861, 1028.2975303504782, 840.3310477588117, 6524.171789507859, 647.6506077177028, 6357.289840812373, 6464.5851743183875, 1822.7868275354456, 4114.6018089667, 6127.2047111519805, 1003.8698363222086, 4692.97617926475, 3300.0780670286185, 5310.114571572521, 6531.997949653444, 3752.553119799228, 1436.6635225674336, 4331.765946698499, 1042.1033376688295, 5166.475312334391, 119.15780373719221, 5016.375160626112, 2617.735410753953, 4955.524607145227, 6382.161750256192, 147.87228460456066, 1320.704718729043, 1659.047943003599, 4480.624974144227, 1246.6126663914451, 4832.908630686028, 4500.634940960281, 6427.687000066984, 4720.511937235806, 952.1051969483295, 105.0571444450397, 1297.3459377612387, 6019.140651103798, 3629.267007885122, 4175.99486784438, 3550.646044761124, 4168.01444964163, 4841.921199323783, 1244.927451600114, 5524.727546283535, 6065.6284371216725, 81.23054913167189, 4040.4973362286973, 698.457745429432, 1889.3611630464727, 2823.55813992985, 5821.07717557052, 4848.470893782915, 3366.4464392399905, 5714.442107220087, 1785.091039353503, 6120.0160075605, 660.3459646331897, 548.9025159940235, 252.75552337612882, 2643.331645028274, 3069.332010769075, 5554.2399659621815, 4347.189221750936, 430.6466776993087, 5200.602489315672, 5674.1896532769215, 1235.7947538531848, 1869.7778569143916, 5170.91128312882, 1250.545506329533, 1698.6951584970077, 3508.9975632537694, 5346.349918280667, 3072.820678596155, 7603.275611902329, 359.482311035644, 1961.4110556030714, 1609.843915620346, 755.529629286305, 9.090222469847246, 647.2967593011558, 1555.8124133354916, 3679.819214052932, 6068.003400053786, 1276.5402046783895, 2951.122441213662, 5054.585292626862, 5398.544045159258, 2289.566687098146, 4052.126304995271, 4128.58724530019], "policy_adversary_policy_reward": [-4290.193844059791, -6099.111334385112, -691.6835646489529, -4438.086507998871, -7090.011140737692, -6446.882158325405, -6883.766598153067, -4040.8843776132376, -5833.696043268175, -3445.626510625885, -7749.886469029237, -5392.113984037914, -3264.5079323000223, -3318.09611441115, -1042.780809773171, -3802.0174427291413, -4547.534558782861, -8168.990436668558, -1028.2975303504782, -6737.770837125274, -7000.401560092219, -840.3310477588117, -9698.167145765221, -6524.171789507859, -878.1172680974133, -1141.6224837979687, -6512.534771668274, -6565.2236055973035, -7028.230487074219, -7458.931161601756, -5694.503360580143, -1822.7868275354456, -4141.7136329228215, -5880.136457378633, -6127.2047111519805, -7141.763030390049, -1158.8860794831746, -2477.4414928005594, -5353.7697308402585, -5631.011068700417, -3300.0780670286185, -6581.13729005953, -5757.5302482819025, -5331.711394002878, -7468.2592763065595, -6638.040794527974, -4201.3607100571, -4033.431059439402, -1717.1294481872521, -1461.7434866865224, -4331.765946698499, -8012.925909518054, -1042.1033376688295, -3328.5659246155064, -7164.088601281009, -5306.655650085149, -119.15780373719221, -758.0575496804528, -8255.791167875721, -5016.375160626112, -2617.735410753953, -6677.84569192586, -5553.8869938489315, -5065.09613599742, -6382.161750256192, -8952.59905764429, -147.87228460456066, -1022.2667933849493, -1555.5534782814727, -3263.7320772351213, -5175.147688990592, -2176.3775273929573, -4507.409388718232, -6353.416695168976, -3256.985910413049, -1385.72197087755, -5360.121526769792, -4957.955747146514, -8421.969811839546, -4500.634940960281, -6432.560386101557, -7134.03808759094, -5219.039432768567, -5278.486645732204, -1826.8224844093577, -952.1051969483295, -128.66687174470565, -205.25513027778163, -1480.8621908928374, -2981.684576844205, -6934.776199082603, -7421.044947575234, -3972.858150329463, -5247.961094715895, -8578.436033523143, -4214.422950517282, -4469.546682990944, -3690.877212219799, -4190.622662522458, -5764.001603333293, -4841.921199323783, -7172.368633412327, -1385.8796154483337, -2801.2788132976534, -5525.247287054727, -7764.395015670936, -6885.30986299284, -6122.557845151189, -81.23054913167189, -514.0773629079087, -7472.750564195459, -4040.4973362286973, -1974.3025592265778, -850.5286786644951, -3092.152807017264, -3505.972345319226, -7088.806543593037, -2833.7840284306476, -7432.278731254967, -6047.251292284929, -5674.632980486764, -4857.015648284792, -7631.9089131058645, -3366.4464392399905, -6166.935408763988, -5774.33206414065, -2055.1378507192053, -2333.9118458091016, -6120.0160075605, -7285.789878629954, -682.1407753534012, -1066.1874585477804, -1922.9116170927682, -548.9025159940235, -1014.7562271991579, -252.75552337612882, -3652.907593460133, -2954.6147317697514, -3781.5356037456095, -3312.7867654066704, -6675.659031866906, -5609.222541419586, -5248.856981439606, -4384.711662720265, -1135.7180400272493, -702.9471628646246, -5336.826298923954, -6566.238910686798, -5674.1896532769215, -8838.52008130363, -1308.8490833768667, -1887.648738038694, -2455.877719060532, -1891.2697694100505, -5525.612302328096, -5963.250358195358, -1913.44707951144, -1311.179729615485, -1698.6951584970077, -5391.189135386721, -3909.5624557843407, -3709.4344032618424, -5346.349918280667, -7837.918144414429, -3097.4939590485633, -8239.290476892702, -8112.151034532118, -8113.229649940135, -359.482311035644, -1107.283214379403, -3852.0988126389598, -2182.340287705414, -2589.0119749078203, -1609.843915620346, -815.2004663297756, -1434.7849121669524, -9.090222469847246, -64.43735274497175, -1105.7634777569733, -848.1183412149901, -1710.2905770849788, -3121.8912727461147, -4619.406462906496, -5825.911446968353, -6068.003400053786, -8950.830288846613, -1300.8544368326807, -3477.3742030397125, -6853.051250912711, -2951.122441213662, -5120.088453941337, -5425.553552669012, -5441.197775318984, -7531.443715439639, -7978.794473938859, -2306.876453253299, -7025.926185998827, -4152.4280374905475, -8279.524583952418, -4128.58724530019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39566689173225783, "mean_inference_ms": 0.9587489874859648, "mean_action_processing_ms": 0.16591913301720898, "mean_env_wait_ms": 0.05078062971046446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004337430000305176, "StateBufferConnector_ms": 0.0024046897888183594, "ViewRequirementAgentConnector_ms": 0.0672682523727417}, "num_episodes": 27, "episode_return_max": -64.43735274497175, "episode_return_min": -9698.16714576522, "episode_return_mean": -5297.409772123507}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.9494601917459, "num_env_steps_trained_throughput_per_sec": 550.9494601917459, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 7335.244, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7335.211, "sample_time_ms": 739.024, "learn_time_ms": 6583.808, "learn_throughput": 607.551, "synch_weights_time_ms": 11.847}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 146, "trial_id": "3439d_00000", "date": "2024-08-09_15-44-37", "timestamp": 1723232677, "time_this_iter_s": 7.264495849609375, "time_total_s": 1089.2261078357697, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3223d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1089.2261078357697, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 24.41, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.5443993528684, "cur_kl_coeff": 599.2220601027627, "cur_lr": 5.0000000000000016e-05, "total_loss": 13.426168100039165, "policy_loss": 0.0009597974654752761, "vf_loss": 9.953163888057073, "vf_explained_var": -0.0004741440216700236, "kl": 0.005794253444764763, "entropy": 1.1798514150083066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0859045919917878, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97721275904822, "policy_loss": -0.0028621133924437263, "vf_loss": 9.976687361197497, "vf_explained_var": -0.0009901057790826868, "kl": 0.01189573232710322, "entropy": 1.3377756751403607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "env_runners": {"episode_reward_max": -64.43735274497175, "episode_reward_min": -9349.467897762277, "episode_reward_mean": -4927.699073071166, "episode_len_mean": 152.51, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 15251, "policy_reward_min": {"agent_policy": 5.92981575692761, "adversary_policy": -9349.467897762275}, "policy_reward_max": {"agent_policy": 7612.999339237695, "adversary_policy": -5.92981575692761}, "policy_reward_mean": {"agent_policy": 3042.1161182660617, "adversary_policy": -3984.9075956686133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-758.0575496804528, -8255.791167875721, -6677.84569192586, -5663.458522701128, -8952.599057644287, -1022.2667933849493, -3498.5808367875507, -5692.477273379943, -6380.201109742978, -3396.0952148991532, -5485.1686432302795, -8421.969811839546, -7138.911473625514, -5777.014141264967, -1826.8224844093577, -228.8648575774476, -3165.200829975804, -8336.680495554036, -5591.5522371602365, -8616.864116196044, -4609.777850449622, -5786.609816214121, -7172.368633412327, -2942.2309771458754, -7764.914756442128, -6942.2392710223585, -514.0773629079087, -7472.750564195457, -2126.373492461641, -4708.763989290002, -7099.032432093834, -7658.452847969373, -5683.177734988641, -7631.908913105866, -6226.825365684552, -2603.9586571748055, -7285.789878629955, -1087.9822692679918, -1922.9116170927684, -1014.7562271991579, -3964.190680201609, -4024.990358383205, -6730.641607324312, -5286.379422408935, -1408.0185251925634, -6702.462720295082, -8838.52008130363, -1960.7030675623764, -2477.3696315561924, -6317.951377394632, -1974.081302797392, -5391.189135386721, -4109.999295792413, -7837.918144414429, -8263.96375734511, -8622.105072569919, -1107.283214379403, -4073.0280447413024, -2589.0119749078203, -1494.455749210423, -64.43735274497175, -1306.5850596708071, -3276.3694364956023, -6765.4986958219015, -8950.830288846613, -3501.6884351940034, -6853.051250912715, -5491.05671398349, -7574.0974455993655, -7996.104240094013, -7126.227918494104, -8279.52458395242, -7986.862634385355, -582.5872140965, -2141.4395735848284, -2013.1047375538537, -8038.206976865219, -4321.94356031338, -5199.983082823234, -6974.905691001561, -8447.43900891593, -9349.467897762277, -1629.4398058226166, -2775.602427822716, -1582.2365333125254, -7421.144369002152, -2315.1870612109883, -97.24297590990076, -7348.321204959377, -5289.903064932174, -696.3582947052536, -4636.485815937561, -7149.162521371966, -9270.943920585367, -6938.279618677071, -4813.902965234312, -1997.4539470410487, -3917.4177236663577, -2068.007800306639, -4265.81732873527], "episode_lengths": [24, 200, 200, 200, 200, 31, 161, 200, 200, 146, 200, 200, 200, 200, 76, 27, 102, 200, 200, 200, 200, 200, 200, 113, 200, 200, 25, 200, 96, 155, 200, 200, 200, 200, 200, 110, 200, 52, 47, 37, 200, 200, 200, 200, 86, 200, 200, 82, 101, 200, 98, 187, 200, 200, 200, 200, 33, 92, 99, 71, 5, 87, 144, 200, 200, 89, 200, 200, 200, 200, 200, 200, 200, 35, 57, 80, 200, 149, 200, 200, 200, 200, 90, 107, 74, 200, 52, 4, 200, 200, 39, 200, 200, 200, 200, 200, 71, 190, 127, 200], "policy_agent_policy_reward": [119.15780373719221, 5016.375160626112, 2617.735410753953, 4955.524607145227, 6382.161750256192, 147.87228460456066, 1320.704718729043, 1659.047943003599, 4480.624974144227, 1246.6126663914451, 4832.908630686028, 4500.634940960281, 6427.687000066984, 4720.511937235806, 952.1051969483295, 105.0571444450397, 1297.3459377612387, 6019.140651103798, 3629.267007885122, 4175.99486784438, 3550.646044761124, 4168.01444964163, 4841.921199323783, 1244.927451600114, 5524.727546283535, 6065.6284371216725, 81.23054913167189, 4040.4973362286973, 698.457745429432, 1889.3611630464727, 2823.55813992985, 5821.07717557052, 4848.470893782915, 3366.4464392399905, 5714.442107220087, 1785.091039353503, 6120.0160075605, 660.3459646331897, 548.9025159940235, 252.75552337612882, 2643.331645028274, 3069.332010769075, 5554.2399659621815, 4347.189221750936, 430.6466776993087, 5200.602489315672, 5674.1896532769215, 1235.7947538531848, 1869.7778569143916, 5170.91128312882, 1250.545506329533, 1698.6951584970077, 3508.9975632537694, 5346.349918280667, 3072.820678596155, 7603.275611902329, 359.482311035644, 1961.4110556030714, 1609.843915620346, 755.529629286305, 9.090222469847246, 647.2967593011558, 1555.8124133354916, 3679.819214052932, 6068.003400053786, 1276.5402046783895, 2951.122441213662, 5054.585292626862, 5398.544045159258, 2289.566687098146, 4052.126304995271, 4128.58724530019, 2430.3175350331094, 77.5872304897999, 593.0250245519417, 1176.419134277347, 2654.6092720511165, 1514.444952336957, 3140.0928830205835, 5668.5452092866335, 7612.999339237695, 5151.627721418755, 866.9639723657534, 1588.0022050307498, 1040.1970064203365, 5296.702481306603, 364.4126067500584, 5.92981575692761, 6321.624996351607, 4259.754232744074, 335.3034690926497, 3605.0521897513813, 4352.663925646097, 1919.338885205769, 5455.876897680656, 3137.4021231474853, 760.9241647418013, 2775.0545516662874, 923.2923999428841, 3056.398101355088], "policy_adversary_policy_reward": [-119.15780373719221, -758.0575496804528, -8255.791167875721, -5016.375160626112, -2617.735410753953, -6677.84569192586, -5553.8869938489315, -5065.09613599742, -6382.161750256192, -8952.59905764429, -147.87228460456066, -1022.2667933849493, -1555.5534782814727, -3263.7320772351213, -5175.147688990592, -2176.3775273929573, -4507.409388718232, -6353.416695168976, -3256.985910413049, -1385.72197087755, -5360.121526769792, -4957.955747146514, -8421.969811839546, -4500.634940960281, -6432.560386101557, -7134.03808759094, -5219.039432768567, -5278.486645732204, -1826.8224844093577, -952.1051969483295, -128.66687174470565, -205.25513027778163, -1480.8621908928374, -2981.684576844205, -6934.776199082603, -7421.044947575234, -3972.858150329463, -5247.961094715895, -8578.436033523143, -4214.422950517282, -4469.546682990944, -3690.877212219799, -4190.622662522458, -5764.001603333293, -4841.921199323783, -7172.368633412327, -1385.8796154483337, -2801.2788132976534, -5525.247287054727, -7764.395015670936, -6885.30986299284, -6122.557845151189, -81.23054913167189, -514.0773629079087, -7472.750564195459, -4040.4973362286973, -1974.3025592265778, -850.5286786644951, -3092.152807017264, -3505.972345319226, -7088.806543593037, -2833.7840284306476, -7432.278731254967, -6047.251292284929, -5674.632980486764, -4857.015648284792, -7631.9089131058645, -3366.4464392399905, -6166.935408763988, -5774.33206414065, -2055.1378507192053, -2333.9118458091016, -6120.0160075605, -7285.789878629954, -682.1407753534012, -1066.1874585477804, -1922.9116170927682, -548.9025159940235, -1014.7562271991579, -252.75552337612882, -3652.907593460133, -2954.6147317697514, -3781.5356037456095, -3312.7867654066704, -6675.659031866906, -5609.222541419586, -5248.856981439606, -4384.711662720265, -1135.7180400272493, -702.9471628646246, -5336.826298923954, -6566.238910686798, -5674.1896532769215, -8838.52008130363, -1308.8490833768667, -1887.648738038694, -2455.877719060532, -1891.2697694100505, -5525.612302328096, -5963.250358195358, -1913.44707951144, -1311.179729615485, -1698.6951584970077, -5391.189135386721, -3909.5624557843407, -3709.4344032618424, -5346.349918280667, -7837.918144414429, -3097.4939590485633, -8239.290476892702, -8112.151034532118, -8113.229649940135, -359.482311035644, -1107.283214379403, -3852.0988126389598, -2182.340287705414, -2589.0119749078203, -1609.843915620346, -815.2004663297756, -1434.7849121669524, -9.090222469847246, -64.43735274497175, -1105.7634777569733, -848.1183412149901, -1710.2905770849788, -3121.8912727461147, -4619.406462906496, -5825.911446968353, -6068.003400053786, -8950.830288846613, -1300.8544368326807, -3477.3742030397125, -6853.051250912711, -2951.122441213662, -5120.088453941337, -5425.553552669012, -5441.197775318984, -7531.443715439639, -7978.794473938859, -2306.876453253299, -7025.926185998827, -4152.4280374905475, -8279.524583952418, -4128.58724530019, -7986.862634385354, -2430.3175350331094, -582.5872140965001, -77.5872304897999, -2141.4395735848284, -593.0250245519417, -1317.191327826424, -1872.3325440047765, -7417.841844124558, -3274.974404791779, -2322.24175859604, -3514.146754054298, -3437.3701451637835, -4902.7058206800375, -5677.957617621409, -6965.4932826667855, -7797.596836539071, -8262.841511614539, -9349.467897762275, -5151.627721418755, -1285.3014767786917, -1211.1023014096781, -2775.602427822716, -1588.0022050307498, -1582.2365333125254, -1040.1970064203365, -7408.912200661929, -5308.934649646826, -2315.1870612109888, -364.4126067500584, -97.24297590990076, -5.92981575692761, -6445.5677340635775, -7224.378467247406, -4598.442898508534, -4951.214399167718, -511.8181043258996, -519.8436594720035, -4055.3700312840965, -4186.1679744048415, -4352.663925646097, -7149.162521371968, -1919.338885205769, -9270.943920585367, -5514.913045445777, -6879.243470911949, -4786.455363274863, -3164.8497251069352, -1997.4539470410487, -760.9241647418013, -3107.8638006311226, -3584.6084747015193, -1027.265025667762, -1964.035174581762, -3754.296110002533, -3567.919320087824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39548127808130823, "mean_inference_ms": 0.9590537042788292, "mean_action_processing_ms": 0.165997188137957, "mean_env_wait_ms": 0.050756663334425925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004311919212341309, "StateBufferConnector_ms": 0.002456068992614746, "ViewRequirementAgentConnector_ms": 0.06647646427154541}, "num_episodes": 28, "episode_return_max": -64.43735274497175, "episode_return_min": -9349.467897762277, "episode_return_mean": -4927.699073071166}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.5022412222319, "num_env_steps_trained_throughput_per_sec": 545.5022412222319, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 7316.315, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7316.282, "sample_time_ms": 735.527, "learn_time_ms": 6568.319, "learn_throughput": 608.984, "synch_weights_time_ms": 11.908}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "training_iteration": 147, "trial_id": "3439d_00000", "date": "2024-08-09_15-44-44", "timestamp": 1723232684, "time_this_iter_s": 7.337604999542236, "time_total_s": 1096.563712835312, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ab940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1096.563712835312, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 25.00909090909091, "ram_util_percent": 82.71818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.977176881333193, "cur_kl_coeff": 599.2220601027627, "cur_lr": 5.0000000000000016e-05, "total_loss": 11.38087100982666, "policy_loss": 0.0008261151233455166, "vf_loss": 9.9579868187507, "vf_explained_var": -8.496387551228205e-05, "kl": 0.002373173882976213, "entropy": 1.1998397820939621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0745036990317718, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97388888010903, "policy_loss": -0.0038568807968490377, "vf_loss": 9.974995260894614, "vf_explained_var": 0.0002831664034929225, "kl": 0.009658876231935605, "entropy": 1.3513657050157981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": -64.43735274497175, "episode_reward_min": -9501.648248167812, "episode_reward_mean": -4984.796352495847, "episode_len_mean": 150.96, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 15096, "policy_reward_min": {"agent_policy": 5.92981575692761, "adversary_policy": -9349.467897762275}, "policy_reward_max": {"agent_policy": 8280.50043671457, "adversary_policy": -5.92981575692761}, "policy_reward_mean": {"agent_policy": 3000.1981810113703, "adversary_policy": -3992.497266753608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7472.750564195457, -2126.373492461641, -4708.763989290002, -7099.032432093834, -7658.452847969373, -5683.177734988641, -7631.908913105866, -6226.825365684552, -2603.9586571748055, -7285.789878629955, -1087.9822692679918, -1922.9116170927684, -1014.7562271991579, -3964.190680201609, -4024.990358383205, -6730.641607324312, -5286.379422408935, -1408.0185251925634, -6702.462720295082, -8838.52008130363, -1960.7030675623764, -2477.3696315561924, -6317.951377394632, -1974.081302797392, -5391.189135386721, -4109.999295792413, -7837.918144414429, -8263.96375734511, -8622.105072569919, -1107.283214379403, -4073.0280447413024, -2589.0119749078203, -1494.455749210423, -64.43735274497175, -1306.5850596708071, -3276.3694364956023, -6765.4986958219015, -8950.830288846613, -3501.6884351940034, -6853.051250912715, -5491.05671398349, -7574.0974455993655, -7996.104240094013, -7126.227918494104, -8279.52458395242, -7986.862634385355, -582.5872140965, -2141.4395735848284, -2013.1047375538537, -8038.206976865219, -4321.94356031338, -5199.983082823234, -6974.905691001561, -8447.43900891593, -9349.467897762277, -1629.4398058226166, -2775.602427822716, -1582.2365333125254, -7421.144369002152, -2315.1870612109883, -97.24297590990076, -7348.321204959377, -5289.903064932174, -696.3582947052536, -4636.485815937561, -7149.162521371966, -9270.943920585367, -6938.279618677071, -4813.902965234312, -1997.4539470410487, -3917.4177236663577, -2068.007800306639, -4265.81732873527, -5229.874840474892, -4987.318846873449, -5051.636158731633, -7777.505055259811, -7325.849782778961, -1249.149132221677, -8196.301743657734, -4286.571521453239, -134.13637779976324, -6842.96467773827, -6103.953428051765, -2645.7367953969992, -5274.032072907592, -5413.827112138947, -1492.8859692840851, -9260.47212586049, -3556.103417008087, -255.7278586029849, -3988.0849117914954, -7117.979899621029, -4903.055153536781, -7887.322372991288, -7048.416802827706, -3561.287221610791, -9501.648248167812, -9115.428072795938, -8121.099319334471], "episode_lengths": [200, 96, 155, 200, 200, 200, 200, 200, 110, 200, 52, 47, 37, 200, 200, 200, 200, 86, 200, 200, 82, 101, 200, 98, 187, 200, 200, 200, 200, 33, 92, 99, 71, 5, 87, 144, 200, 200, 89, 200, 200, 200, 200, 200, 200, 200, 35, 57, 80, 200, 149, 200, 200, 200, 200, 90, 107, 74, 200, 52, 4, 200, 200, 39, 200, 200, 200, 200, 200, 71, 190, 127, 200, 136, 106, 200, 200, 200, 62, 200, 200, 9, 200, 178, 109, 200, 132, 33, 200, 122, 7, 159, 200, 145, 200, 200, 152, 200, 200, 200], "policy_agent_policy_reward": [4040.4973362286973, 698.457745429432, 1889.3611630464727, 2823.55813992985, 5821.07717557052, 4848.470893782915, 3366.4464392399905, 5714.442107220087, 1785.091039353503, 6120.0160075605, 660.3459646331897, 548.9025159940235, 252.75552337612882, 2643.331645028274, 3069.332010769075, 5554.2399659621815, 4347.189221750936, 430.6466776993087, 5200.602489315672, 5674.1896532769215, 1235.7947538531848, 1869.7778569143916, 5170.91128312882, 1250.545506329533, 1698.6951584970077, 3508.9975632537694, 5346.349918280667, 3072.820678596155, 7603.275611902329, 359.482311035644, 1961.4110556030714, 1609.843915620346, 755.529629286305, 9.090222469847246, 647.2967593011558, 1555.8124133354916, 3679.819214052932, 6068.003400053786, 1276.5402046783895, 2951.122441213662, 5054.585292626862, 5398.544045159258, 2289.566687098146, 4052.126304995271, 4128.58724530019, 2430.3175350331094, 77.5872304897999, 593.0250245519417, 1176.419134277347, 2654.6092720511165, 1514.444952336957, 3140.0928830205835, 5668.5452092866335, 7612.999339237695, 5151.627721418755, 866.9639723657534, 1588.0022050307498, 1040.1970064203365, 5296.702481306603, 364.4126067500584, 5.92981575692761, 6321.624996351607, 4259.754232744074, 335.3034690926497, 3605.0521897513813, 4352.663925646097, 1919.338885205769, 5455.876897680656, 3137.4021231474853, 760.9241647418013, 2775.0545516662874, 923.2923999428841, 3056.398101355088, 1096.6011634554022, 1710.9433703536556, 1776.6964904256304, 4998.079387186587, 6817.475672877206, 1089.8096259826084, 5888.6443488442565, 2196.704504143928, 38.771854272267205, 3047.710031007268, 3782.7138683072185, 1078.058942048833, 2994.0060308794195, 1113.056443637438, 214.7203529347314, 7256.544842168637, 1305.6658988136362, 20.531839206200758, 1492.8856453758517, 4450.348238002784, 1256.6202039597556, 2515.5777462220294, 5031.7865739129675, 2164.281662102419, 8194.889977889243, 8280.50043671457, 6078.1474359983995], "policy_adversary_policy_reward": [-7472.750564195459, -4040.4973362286973, -1974.3025592265778, -850.5286786644951, -3092.152807017264, -3505.972345319226, -7088.806543593037, -2833.7840284306476, -7432.278731254967, -6047.251292284929, -5674.632980486764, -4857.015648284792, -7631.9089131058645, -3366.4464392399905, -6166.935408763988, -5774.33206414065, -2055.1378507192053, -2333.9118458091016, -6120.0160075605, -7285.789878629954, -682.1407753534012, -1066.1874585477804, -1922.9116170927682, -548.9025159940235, -1014.7562271991579, -252.75552337612882, -3652.907593460133, -2954.6147317697514, -3781.5356037456095, -3312.7867654066704, -6675.659031866906, -5609.222541419586, -5248.856981439606, -4384.711662720265, -1135.7180400272493, -702.9471628646246, -5336.826298923954, -6566.238910686798, -5674.1896532769215, -8838.52008130363, -1308.8490833768667, -1887.648738038694, -2455.877719060532, -1891.2697694100505, -5525.612302328096, -5963.250358195358, -1913.44707951144, -1311.179729615485, -1698.6951584970077, -5391.189135386721, -3909.5624557843407, -3709.4344032618424, -5346.349918280667, -7837.918144414429, -3097.4939590485633, -8239.290476892702, -8112.151034532118, -8113.229649940135, -359.482311035644, -1107.283214379403, -3852.0988126389598, -2182.340287705414, -2589.0119749078203, -1609.843915620346, -815.2004663297756, -1434.7849121669524, -9.090222469847246, -64.43735274497175, -1105.7634777569733, -848.1183412149901, -1710.2905770849788, -3121.8912727461147, -4619.406462906496, -5825.911446968353, -6068.003400053786, -8950.830288846613, -1300.8544368326807, -3477.3742030397125, -6853.051250912711, -2951.122441213662, -5120.088453941337, -5425.553552669012, -5441.197775318984, -7531.443715439639, -7978.794473938859, -2306.876453253299, -7025.926185998827, -4152.4280374905475, -8279.524583952418, -4128.58724530019, -7986.862634385354, -2430.3175350331094, -582.5872140965001, -77.5872304897999, -2141.4395735848284, -593.0250245519417, -1317.191327826424, -1872.3325440047765, -7417.841844124558, -3274.974404791779, -2322.24175859604, -3514.146754054298, -3437.3701451637835, -4902.7058206800375, -5677.957617621409, -6965.4932826667855, -7797.596836539071, -8262.841511614539, -9349.467897762275, -5151.627721418755, -1285.3014767786917, -1211.1023014096781, -2775.602427822716, -1588.0022050307498, -1582.2365333125254, -1040.1970064203365, -7408.912200661929, -5308.934649646826, -2315.1870612109888, -364.4126067500584, -97.24297590990076, -5.92981575692761, -6445.5677340635775, -7224.378467247406, -4598.442898508534, -4951.214399167718, -511.8181043258996, -519.8436594720035, -4055.3700312840965, -4186.1679744048415, -4352.663925646097, -7149.162521371968, -1919.338885205769, -9270.943920585367, -5514.913045445777, -6879.243470911949, -4786.455363274863, -3164.8497251069352, -1997.4539470410487, -760.9241647418013, -3107.8638006311226, -3584.6084747015193, -1027.265025667762, -1964.035174581762, -3754.296110002533, -3567.919320087824, -1096.6011634554022, -5229.874840474892, -4987.318846873447, -1710.9433703536556, -1776.6964904256304, -5051.636158731633, -7647.840238798764, -5127.744203647632, -7098.293882458713, -7045.031573197455, -1135.7366488013354, -1203.2221094029499, -5888.6443488442565, -8196.301743657734, -4286.1471921475895, -2197.128833449578, -134.13637779976324, -38.771854272267205, -6206.219649238162, -3684.4550595073747, -3878.990639198924, -6007.67665716006, -1789.5904742046716, -1934.2052632411658, -3039.268755140027, -5228.769348646985, -1113.056443637438, -5413.827112138947, -1492.8859692840851, -214.7203529347314, -9259.526557381369, -7257.490410647756, -2482.6667384569187, -2379.1025773648034, -255.72785860298495, -20.531839206200758, -3988.084911791496, -1492.8856453758517, -4450.348238002784, -7117.979899621029, -4903.055153536782, -1256.6202039597556, -2515.5777462220294, -7887.322372991288, -5069.705164829357, -7010.4982119113165, -3553.403469096213, -2172.1654146169976, -8548.866482434967, -9147.671743622086, -8939.25092006189, -8456.677589448627, -6727.568201619662, -7471.678553713211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39528531141073797, "mean_inference_ms": 0.9584224004490878, "mean_action_processing_ms": 0.1660155928235941, "mean_env_wait_ms": 0.05075885097160774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042514801025390625, "StateBufferConnector_ms": 0.0026589632034301758, "ViewRequirementAgentConnector_ms": 0.06793010234832764}, "num_episodes": 27, "episode_return_max": -64.43735274497175, "episode_return_min": -9501.648248167812, "episode_return_mean": -4984.796352495847}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.2234302057094, "num_env_steps_trained_throughput_per_sec": 552.2234302057094, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 7315.068, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7315.035, "sample_time_ms": 736.26, "learn_time_ms": 6566.521, "learn_throughput": 609.151, "synch_weights_time_ms": 11.723}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 148, "trial_id": "3439d_00000", "date": "2024-08-09_15-44-52", "timestamp": 1723232692, "time_this_iter_s": 7.248106002807617, "time_total_s": 1103.8118188381195, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3223dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1103.8118188381195, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 27.43, "ram_util_percent": 82.83}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.5001403739055, "cur_kl_coeff": 299.61103005138136, "cur_lr": 5.0000000000000016e-05, "total_loss": 11.02512636979421, "policy_loss": -0.00027020301543719444, "vf_loss": 9.956678719321888, "vf_explained_var": 1.7138880987962087e-05, "kl": 0.003567017859919967, "entropy": 1.2206531616548697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.10101767674325, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97382472911209, "policy_loss": -0.004643986209556855, "vf_loss": 9.974234927142108, "vf_explained_var": 0.0005740347047331472, "kl": 0.014867680218740903, "entropy": 1.3348433140093687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "env_runners": {"episode_reward_max": -64.43735274497175, "episode_reward_min": -9501.648248167812, "episode_reward_mean": -4972.650030932888, "episode_len_mean": 150.35, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15035, "policy_reward_min": {"agent_policy": 5.92981575692761, "adversary_policy": -9349.467897762275}, "policy_reward_max": {"agent_policy": 8280.50043671457, "adversary_policy": -5.92981575692761}, "policy_reward_mean": {"agent_policy": 2838.9264031455486, "adversary_policy": -3905.7882170392177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4109.999295792413, -7837.918144414429, -8263.96375734511, -8622.105072569919, -1107.283214379403, -4073.0280447413024, -2589.0119749078203, -1494.455749210423, -64.43735274497175, -1306.5850596708071, -3276.3694364956023, -6765.4986958219015, -8950.830288846613, -3501.6884351940034, -6853.051250912715, -5491.05671398349, -7574.0974455993655, -7996.104240094013, -7126.227918494104, -8279.52458395242, -7986.862634385355, -582.5872140965, -2141.4395735848284, -2013.1047375538537, -8038.206976865219, -4321.94356031338, -5199.983082823234, -6974.905691001561, -8447.43900891593, -9349.467897762277, -1629.4398058226166, -2775.602427822716, -1582.2365333125254, -7421.144369002152, -2315.1870612109883, -97.24297590990076, -7348.321204959377, -5289.903064932174, -696.3582947052536, -4636.485815937561, -7149.162521371966, -9270.943920585367, -6938.279618677071, -4813.902965234312, -1997.4539470410487, -3917.4177236663577, -2068.007800306639, -4265.81732873527, -5229.874840474892, -4987.318846873449, -5051.636158731633, -7777.505055259811, -7325.849782778961, -1249.149132221677, -8196.301743657734, -4286.571521453239, -134.13637779976324, -6842.96467773827, -6103.953428051765, -2645.7367953969992, -5274.032072907592, -5413.827112138947, -1492.8859692840851, -9260.47212586049, -3556.103417008087, -255.7278586029849, -3988.0849117914954, -7117.979899621029, -4903.055153536781, -7887.322372991288, -7048.416802827706, -3561.287221610791, -9501.648248167812, -9115.428072795938, -8121.099319334471, -2388.167503606709, -2934.3237176004627, -3202.6663623938584, -408.8681907368202, -5364.93233406626, -2273.106245132266, -1941.5458836281427, -1774.3777780464118, -8409.724656232485, -5714.071412613323, -2314.893800519803, -8340.062359784577, -6902.820359812492, -8982.498456168933, -7232.23082638338, -1913.2890845778632, -3920.885033802285, -7334.8146463003095, -1602.9480351111285, -7312.844055079354, -6930.620084182806, -6054.58249475372, -2896.5967093190366, -5985.354034653667, -4248.325678158683], "episode_lengths": [200, 200, 200, 200, 33, 92, 99, 71, 5, 87, 144, 200, 200, 89, 200, 200, 200, 200, 200, 200, 200, 35, 57, 80, 200, 149, 200, 200, 200, 200, 90, 107, 74, 200, 52, 4, 200, 200, 39, 200, 200, 200, 200, 200, 71, 190, 127, 200, 136, 106, 200, 200, 200, 62, 200, 200, 9, 200, 178, 109, 200, 132, 33, 200, 122, 7, 159, 200, 145, 200, 200, 152, 200, 200, 200, 186, 110, 103, 34, 200, 109, 81, 91, 200, 200, 74, 200, 200, 200, 200, 49, 133, 200, 85, 200, 169, 200, 166, 200, 200], "policy_agent_policy_reward": [3508.9975632537694, 5346.349918280667, 3072.820678596155, 7603.275611902329, 359.482311035644, 1961.4110556030714, 1609.843915620346, 755.529629286305, 9.090222469847246, 647.2967593011558, 1555.8124133354916, 3679.819214052932, 6068.003400053786, 1276.5402046783895, 2951.122441213662, 5054.585292626862, 5398.544045159258, 2289.566687098146, 4052.126304995271, 4128.58724530019, 2430.3175350331094, 77.5872304897999, 593.0250245519417, 1176.419134277347, 2654.6092720511165, 1514.444952336957, 3140.0928830205835, 5668.5452092866335, 7612.999339237695, 5151.627721418755, 866.9639723657534, 1588.0022050307498, 1040.1970064203365, 5296.702481306603, 364.4126067500584, 5.92981575692761, 6321.624996351607, 4259.754232744074, 335.3034690926497, 3605.0521897513813, 4352.663925646097, 1919.338885205769, 5455.876897680656, 3137.4021231474853, 760.9241647418013, 2775.0545516662874, 923.2923999428841, 3056.398101355088, 1096.6011634554022, 1710.9433703536556, 1776.6964904256304, 4998.079387186587, 6817.475672877206, 1089.8096259826084, 5888.6443488442565, 2196.704504143928, 38.771854272267205, 3047.710031007268, 3782.7138683072185, 1078.058942048833, 2994.0060308794195, 1113.056443637438, 214.7203529347314, 7256.544842168637, 1305.6658988136362, 20.531839206200758, 1492.8856453758517, 4450.348238002784, 1256.6202039597556, 2515.5777462220294, 5031.7865739129675, 2164.281662102419, 8194.889977889243, 8280.50043671457, 6078.1474359983995, 1055.2665450787392, 1471.1390857924837, 1532.5294110253033, 270.042766015728, 3046.4142818681084, 1542.1267469491984, 1149.7094539576583, 622.4578437874898, 2472.363136097933, 2329.841103373037, 888.797743087162, 3642.7577363761516, 3053.7828706824343, 8195.994273621365, 5328.543484165834, 393.0899739212778, 1453.644607474886, 3186.6373272900328, 698.8001674595025, 3756.0538343121457, 2102.764160460121, 2403.960176097932, 1482.3893459868552, 4903.422013831966, 3604.9723985951846], "policy_adversary_policy_reward": [-3909.5624557843407, -3709.4344032618424, -5346.349918280667, -7837.918144414429, -3097.4939590485633, -8239.290476892702, -8112.151034532118, -8113.229649940135, -359.482311035644, -1107.283214379403, -3852.0988126389598, -2182.340287705414, -2589.0119749078203, -1609.843915620346, -815.2004663297756, -1434.7849121669524, -9.090222469847246, -64.43735274497175, -1105.7634777569733, -848.1183412149901, -1710.2905770849788, -3121.8912727461147, -4619.406462906496, -5825.911446968353, -6068.003400053786, -8950.830288846613, -1300.8544368326807, -3477.3742030397125, -6853.051250912711, -2951.122441213662, -5120.088453941337, -5425.553552669012, -5441.197775318984, -7531.443715439639, -7978.794473938859, -2306.876453253299, -7025.926185998827, -4152.4280374905475, -8279.524583952418, -4128.58724530019, -7986.862634385354, -2430.3175350331094, -582.5872140965001, -77.5872304897999, -2141.4395735848284, -593.0250245519417, -1317.191327826424, -1872.3325440047765, -7417.841844124558, -3274.974404791779, -2322.24175859604, -3514.146754054298, -3437.3701451637835, -4902.7058206800375, -5677.957617621409, -6965.4932826667855, -7797.596836539071, -8262.841511614539, -9349.467897762275, -5151.627721418755, -1285.3014767786917, -1211.1023014096781, -2775.602427822716, -1588.0022050307498, -1582.2365333125254, -1040.1970064203365, -7408.912200661929, -5308.934649646826, -2315.1870612109888, -364.4126067500584, -97.24297590990076, -5.92981575692761, -6445.5677340635775, -7224.378467247406, -4598.442898508534, -4951.214399167718, -511.8181043258996, -519.8436594720035, -4055.3700312840965, -4186.1679744048415, -4352.663925646097, -7149.162521371968, -1919.338885205769, -9270.943920585367, -5514.913045445777, -6879.243470911949, -4786.455363274863, -3164.8497251069352, -1997.4539470410487, -760.9241647418013, -3107.8638006311226, -3584.6084747015193, -1027.265025667762, -1964.035174581762, -3754.296110002533, -3567.919320087824, -1096.6011634554022, -5229.874840474892, -4987.318846873447, -1710.9433703536556, -1776.6964904256304, -5051.636158731633, -7647.840238798764, -5127.744203647632, -7098.293882458713, -7045.031573197455, -1135.7366488013354, -1203.2221094029499, -5888.6443488442565, -8196.301743657734, -4286.1471921475895, -2197.128833449578, -134.13637779976324, -38.771854272267205, -6206.219649238162, -3684.4550595073747, -3878.990639198924, -6007.67665716006, -1789.5904742046716, -1934.2052632411658, -3039.268755140027, -5228.769348646985, -1113.056443637438, -5413.827112138947, -1492.8859692840851, -214.7203529347314, -9259.526557381369, -7257.490410647756, -2482.6667384569187, -2379.1025773648034, -255.72785860298495, -20.531839206200758, -3988.084911791496, -1492.8856453758517, -4450.348238002784, -7117.979899621029, -4903.055153536782, -1256.6202039597556, -2515.5777462220294, -7887.322372991288, -5069.705164829357, -7010.4982119113165, -3553.403469096213, -2172.1654146169976, -8548.866482434967, -9147.671743622086, -8939.25092006189, -8456.677589448627, -6727.568201619662, -7471.678553713211, -2381.342714751447, -1062.0913339340007, -2446.3893285878476, -1959.0734748050995, -3202.666362393858, -1532.5294110253033, -408.8681907368202, -270.042766015728, -4577.4764519043, -3833.8701640300415, -1708.4123983196012, -2106.820593761863, -1810.0502533040974, -1281.2050842817034, -1026.7799660447465, -1370.0556557891555, -2472.363136097933, -8409.724656232485, -3236.375432189422, -4807.537083796932, -2296.7394369870567, -906.9521066199084, -8340.062359784579, -3642.7577363761516, -3053.7828706824343, -6902.820359812492, -8559.59688615491, -8618.895843635386, -5328.543484165834, -7232.23082638338, -393.0899739212778, -1913.2890845778632, -1453.644607474886, -3920.885033802285, -3186.6373272900328, -7334.8146463003095, -1321.3830867646673, -980.3651158059637, -5354.565718156358, -5714.332171235132, -2102.764160460121, -6930.620084182806, -6054.582494753719, -2403.960176097932, -2697.475855803307, -1681.5101995025825, -4907.106298297964, -5981.669750187669, -3914.9660618796265, -3938.3320148742414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39537722599460084, "mean_inference_ms": 0.958534660107942, "mean_action_processing_ms": 0.1660112041151448, "mean_env_wait_ms": 0.05077272662045127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347137451171875, "StateBufferConnector_ms": 0.0027006864547729492, "ViewRequirementAgentConnector_ms": 0.06801271438598633}, "num_episodes": 25, "episode_return_max": -64.43735274497175, "episode_return_min": -9501.648248167812, "episode_return_mean": -4972.650030932888}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.3967515667981, "num_env_steps_trained_throughput_per_sec": 504.3967515667981, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1788000, "timers": {"training_iteration_time_ms": 7361.467, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7361.434, "sample_time_ms": 749.147, "learn_time_ms": 6599.648, "learn_throughput": 606.093, "synch_weights_time_ms": 12.185}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "done": false, "training_iteration": 149, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-00", "timestamp": 1723232700, "time_this_iter_s": 7.934995889663696, "time_total_s": 1111.7468147277832, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b315a430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1111.7468147277832, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 31.333333333333332, "ram_util_percent": 83.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.605062692984939, "cur_kl_coeff": 149.80551502569068, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.612779255708059, "policy_loss": 0.00109717378897282, "vf_loss": 9.970695154865583, "vf_explained_var": 5.416075388590494e-06, "kl": 0.004278793960838812, "entropy": 1.253460377206405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0427421900330398, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.986029501314517, "policy_loss": -0.005030056995847238, "vf_loss": 9.987677465670954, "vf_explained_var": -0.00242226139578239, "kl": 0.01187666736188389, "entropy": 1.314862683273497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": -56.48106418798311, "episode_reward_min": -9501.648248167812, "episode_reward_mean": -5027.55682390259, "episode_len_mean": 152.74, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15274, "policy_reward_min": {"agent_policy": 2.3304447922734286, "adversary_policy": -9364.532347761486}, "policy_reward_max": {"agent_policy": 8280.50043671457, "adversary_policy": -2.3304447922734286}, "policy_reward_mean": {"agent_policy": 2905.087834718714, "adversary_policy": -3966.322329310651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4321.94356031338, -5199.983082823234, -6974.905691001561, -8447.43900891593, -9349.467897762277, -1629.4398058226166, -2775.602427822716, -1582.2365333125254, -7421.144369002152, -2315.1870612109883, -97.24297590990076, -7348.321204959377, -5289.903064932174, -696.3582947052536, -4636.485815937561, -7149.162521371966, -9270.943920585367, -6938.279618677071, -4813.902965234312, -1997.4539470410487, -3917.4177236663577, -2068.007800306639, -4265.81732873527, -5229.874840474892, -4987.318846873449, -5051.636158731633, -7777.505055259811, -7325.849782778961, -1249.149132221677, -8196.301743657734, -4286.571521453239, -134.13637779976324, -6842.96467773827, -6103.953428051765, -2645.7367953969992, -5274.032072907592, -5413.827112138947, -1492.8859692840851, -9260.47212586049, -3556.103417008087, -255.7278586029849, -3988.0849117914954, -7117.979899621029, -4903.055153536781, -7887.322372991288, -7048.416802827706, -3561.287221610791, -9501.648248167812, -9115.428072795938, -8121.099319334471, -2388.167503606709, -2934.3237176004627, -3202.6663623938584, -408.8681907368202, -5364.93233406626, -2273.106245132266, -1941.5458836281427, -1774.3777780464118, -8409.724656232485, -5714.071412613323, -2314.893800519803, -8340.062359784577, -6902.820359812492, -8982.498456168933, -7232.23082638338, -1913.2890845778632, -3920.885033802285, -7334.8146463003095, -1602.9480351111285, -7312.844055079354, -6930.620084182806, -6054.58249475372, -2896.5967093190366, -5985.354034653667, -4248.325678158683, -4616.119327199559, -6000.678912557113, -1424.132245797803, -8576.013561329812, -8360.05849289355, -2009.8340436820408, -5354.943780528987, -5436.409500817067, -6977.2317271848815, -6832.912907507572, -7076.240466678876, -8933.475238721805, -9121.859454558475, -1559.9967210386112, -6737.559128005357, -4784.706271669892, -9364.532347761486, -56.48106418798311, -8475.708654673223, -6786.136263178299, -4175.044201860978, -2571.5868066953985, -846.8073225836116, -4662.988566705122, -794.6601008092866], "episode_lengths": [149, 200, 200, 200, 200, 90, 107, 74, 200, 52, 4, 200, 200, 39, 200, 200, 200, 200, 200, 71, 190, 127, 200, 136, 106, 200, 200, 200, 62, 200, 200, 9, 200, 178, 109, 200, 132, 33, 200, 122, 7, 159, 200, 145, 200, 200, 152, 200, 200, 200, 186, 110, 103, 34, 200, 109, 81, 91, 200, 200, 74, 200, 200, 200, 200, 49, 133, 200, 85, 200, 169, 200, 166, 200, 200, 153, 200, 75, 200, 200, 84, 154, 200, 200, 200, 159, 200, 200, 47, 200, 200, 200, 2, 200, 200, 200, 105, 48, 145, 59], "policy_agent_policy_reward": [1514.444952336957, 3140.0928830205835, 5668.5452092866335, 7612.999339237695, 5151.627721418755, 866.9639723657534, 1588.0022050307498, 1040.1970064203365, 5296.702481306603, 364.4126067500584, 5.92981575692761, 6321.624996351607, 4259.754232744074, 335.3034690926497, 3605.0521897513813, 4352.663925646097, 1919.338885205769, 5455.876897680656, 3137.4021231474853, 760.9241647418013, 2775.0545516662874, 923.2923999428841, 3056.398101355088, 1096.6011634554022, 1710.9433703536556, 1776.6964904256304, 4998.079387186587, 6817.475672877206, 1089.8096259826084, 5888.6443488442565, 2196.704504143928, 38.771854272267205, 3047.710031007268, 3782.7138683072185, 1078.058942048833, 2994.0060308794195, 1113.056443637438, 214.7203529347314, 7256.544842168637, 1305.6658988136362, 20.531839206200758, 1492.8856453758517, 4450.348238002784, 1256.6202039597556, 2515.5777462220294, 5031.7865739129675, 2164.281662102419, 8194.889977889243, 8280.50043671457, 6078.1474359983995, 1055.2665450787392, 1471.1390857924837, 1532.5294110253033, 270.042766015728, 3046.4142818681084, 1542.1267469491984, 1149.7094539576583, 622.4578437874898, 2472.363136097933, 2329.841103373037, 888.797743087162, 3642.7577363761516, 3053.7828706824343, 8195.994273621365, 5328.543484165834, 393.0899739212778, 1453.644607474886, 3186.6373272900328, 698.8001674595025, 3756.0538343121457, 2102.764160460121, 2403.960176097932, 1482.3893459868552, 4903.422013831966, 3604.9723985951846, 1880.5479026441988, 2928.7990876512645, 1260.769731749254, 3477.112362038135, 6580.977378188084, 666.5938870520471, 2526.4099397273544, 3835.7862506466877, 5313.666288849716, 6358.72256553653, 2033.1569877151423, 6094.939572015712, 4349.662810464653, 422.0707238554917, 2428.9300391303045, 3165.3387801179815, 2517.2110206792386, 2.3304447922734286, 7605.05594968754, 5302.946173968103, 3025.4978304182673, 890.1282687759726, 422.61841118419636, 1048.5889359511555, 739.0449247437766], "policy_adversary_policy_reward": [-2322.24175859604, -3514.146754054298, -3437.3701451637835, -4902.7058206800375, -5677.957617621409, -6965.4932826667855, -7797.596836539071, -8262.841511614539, -9349.467897762275, -5151.627721418755, -1285.3014767786917, -1211.1023014096781, -2775.602427822716, -1588.0022050307498, -1582.2365333125254, -1040.1970064203365, -7408.912200661929, -5308.934649646826, -2315.1870612109888, -364.4126067500584, -97.24297590990076, -5.92981575692761, -6445.5677340635775, -7224.378467247406, -4598.442898508534, -4951.214399167718, -511.8181043258996, -519.8436594720035, -4055.3700312840965, -4186.1679744048415, -4352.663925646097, -7149.162521371968, -1919.338885205769, -9270.943920585367, -5514.913045445777, -6879.243470911949, -4786.455363274863, -3164.8497251069352, -1997.4539470410487, -760.9241647418013, -3107.8638006311226, -3584.6084747015193, -1027.265025667762, -1964.035174581762, -3754.296110002533, -3567.919320087824, -1096.6011634554022, -5229.874840474892, -4987.318846873447, -1710.9433703536556, -1776.6964904256304, -5051.636158731633, -7647.840238798764, -5127.744203647632, -7098.293882458713, -7045.031573197455, -1135.7366488013354, -1203.2221094029499, -5888.6443488442565, -8196.301743657734, -4286.1471921475895, -2197.128833449578, -134.13637779976324, -38.771854272267205, -6206.219649238162, -3684.4550595073747, -3878.990639198924, -6007.67665716006, -1789.5904742046716, -1934.2052632411658, -3039.268755140027, -5228.769348646985, -1113.056443637438, -5413.827112138947, -1492.8859692840851, -214.7203529347314, -9259.526557381369, -7257.490410647756, -2482.6667384569187, -2379.1025773648034, -255.72785860298495, -20.531839206200758, -3988.084911791496, -1492.8856453758517, -4450.348238002784, -7117.979899621029, -4903.055153536782, -1256.6202039597556, -2515.5777462220294, -7887.322372991288, -5069.705164829357, -7010.4982119113165, -3553.403469096213, -2172.1654146169976, -8548.866482434967, -9147.671743622086, -8939.25092006189, -8456.677589448627, -6727.568201619662, -7471.678553713211, -2381.342714751447, -1062.0913339340007, -2446.3893285878476, -1959.0734748050995, -3202.666362393858, -1532.5294110253033, -408.8681907368202, -270.042766015728, -4577.4764519043, -3833.8701640300415, -1708.4123983196012, -2106.820593761863, -1810.0502533040974, -1281.2050842817034, -1026.7799660447465, -1370.0556557891555, -2472.363136097933, -8409.724656232485, -3236.375432189422, -4807.537083796932, -2296.7394369870567, -906.9521066199084, -8340.062359784579, -3642.7577363761516, -3053.7828706824343, -6902.820359812492, -8559.59688615491, -8618.895843635386, -5328.543484165834, -7232.23082638338, -393.0899739212778, -1913.2890845778632, -1453.644607474886, -3920.885033802285, -3186.6373272900328, -7334.8146463003095, -1321.3830867646673, -980.3651158059637, -5354.565718156358, -5714.332171235132, -2102.764160460121, -6930.620084182806, -6054.582494753719, -2403.960176097932, -2697.475855803307, -1681.5101995025825, -4907.106298297964, -5981.669750187669, -3914.9660618796265, -3938.3320148742414, -1880.5479026441988, -4616.11932719956, -3554.164173589652, -5375.313826618725, -1344.3023156352654, -1340.5996619117914, -8576.013561329813, -3477.112362038135, -6632.003604491725, -8309.03226658991, -1858.0839017826838, -818.3440289514042, -2953.5802578338166, -4927.773462422523, -3922.4385027763033, -5349.757248687459, -6864.872399102973, -5426.025616931625, -6535.828159137245, -6655.807313906859, -2037.2947930053338, -7072.102661388684, -6094.939572015712, -8933.475238721805, -9121.859454558475, -4349.662810464653, -1559.996721038611, -422.0707238554917, -2428.9300391303045, -6737.559128005357, -4640.42374063252, -3309.62131115535, -2517.2110206792386, -9364.532347761486, -2.3304447922734286, -56.48106418798311, -8474.615064577238, -7606.149539783525, -5302.946173968103, -6786.136263178299, -3164.8115453121322, -4035.7304869671157, -890.1282687759726, -2571.5868066953985, -422.61841118419636, -846.8073225836116, -1048.5889359511555, -4662.988566705121, -787.5995677288502, -746.1054578242131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959592489990695, "mean_inference_ms": 0.9605032067089234, "mean_action_processing_ms": 0.16609078760721105, "mean_env_wait_ms": 0.05081727820620723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004112362861633301, "StateBufferConnector_ms": 0.0029342174530029297, "ViewRequirementAgentConnector_ms": 0.08135104179382324}, "num_episodes": 25, "episode_return_max": -56.48106418798311, "episode_return_min": -9501.648248167812, "episode_return_mean": -5027.55682390259}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 522.1726134712512, "num_env_steps_trained_throughput_per_sec": 522.1726134712512, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 7394.928, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7394.894, "sample_time_ms": 801.567, "learn_time_ms": 6580.836, "learn_throughput": 607.826, "synch_weights_time_ms": 12.001}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 150, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-08", "timestamp": 1723232708, "time_this_iter_s": 7.665574312210083, "time_total_s": 1119.4123890399933, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b315a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1119.4123890399933, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 32.518181818181816, "ram_util_percent": 82.33636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1334938955493272, "cur_kl_coeff": 74.90275751284534, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.198136342565219, "policy_loss": -0.0011702993938039678, "vf_loss": 9.968627320726712, "vf_explained_var": 5.334982027610143e-05, "kl": 0.0030797175956346714, "entropy": 1.2794408034533262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.095982596625096, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.982583442062298, "policy_loss": -0.004856726678985137, "vf_loss": 9.983545110591505, "vf_explained_var": -5.717614971140705e-05, "kl": 0.013678144484206482, "entropy": 1.3415523976245254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "env_runners": {"episode_reward_max": -40.953306178669365, "episode_reward_min": -9501.648248167812, "episode_reward_mean": -5166.909115617798, "episode_len_mean": 155.29, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 15529, "policy_reward_min": {"agent_policy": 2.3304447922734286, "adversary_policy": -9364.532347761486}, "policy_reward_max": {"agent_policy": 8280.50043671457, "adversary_policy": -2.3304447922734286}, "policy_reward_mean": {"agent_policy": 3021.133965892758, "adversary_policy": -4094.021540755278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4987.318846873449, -5051.636158731633, -7777.505055259811, -7325.849782778961, -1249.149132221677, -8196.301743657734, -4286.571521453239, -134.13637779976324, -6842.96467773827, -6103.953428051765, -2645.7367953969992, -5274.032072907592, -5413.827112138947, -1492.8859692840851, -9260.47212586049, -3556.103417008087, -255.7278586029849, -3988.0849117914954, -7117.979899621029, -4903.055153536781, -7887.322372991288, -7048.416802827706, -3561.287221610791, -9501.648248167812, -9115.428072795938, -8121.099319334471, -2388.167503606709, -2934.3237176004627, -3202.6663623938584, -408.8681907368202, -5364.93233406626, -2273.106245132266, -1941.5458836281427, -1774.3777780464118, -8409.724656232485, -5714.071412613323, -2314.893800519803, -8340.062359784577, -6902.820359812492, -8982.498456168933, -7232.23082638338, -1913.2890845778632, -3920.885033802285, -7334.8146463003095, -1602.9480351111285, -7312.844055079354, -6930.620084182806, -6054.58249475372, -2896.5967093190366, -5985.354034653667, -4248.325678158683, -4616.119327199559, -6000.678912557113, -1424.132245797803, -8576.013561329812, -8360.05849289355, -2009.8340436820408, -5354.943780528987, -5436.409500817067, -6977.2317271848815, -6832.912907507572, -7076.240466678876, -8933.475238721805, -9121.859454558475, -1559.9967210386112, -6737.559128005357, -4784.706271669892, -9364.532347761486, -56.48106418798311, -8475.708654673223, -6786.136263178299, -4175.044201860978, -2571.5868066953985, -846.8073225836116, -4662.988566705122, -794.6601008092866, -2454.467762311682, -6731.649640224517, -1033.7412485265577, -8666.595994520732, -2570.2127980259806, -7003.899598556933, -7514.3042772024955, -7036.283249488914, -6498.138573671901, -2015.291382866693, -4739.463937863181, -3740.2238051222494, -40.953306178669365, -7047.89748918319, -4423.636806473343, -7478.752300254692, -6306.0952082903, -4913.104581513533, -3707.397125482048, -4906.493688256109, -7480.083052278377, -7606.873703657494, -6198.562325021905, -7557.628777073902], "episode_lengths": [106, 200, 200, 200, 62, 200, 200, 9, 200, 178, 109, 200, 132, 33, 200, 122, 7, 159, 200, 145, 200, 200, 152, 200, 200, 200, 186, 110, 103, 34, 200, 109, 81, 91, 200, 200, 74, 200, 200, 200, 200, 49, 133, 200, 85, 200, 169, 200, 166, 200, 200, 153, 200, 75, 200, 200, 84, 154, 200, 200, 200, 159, 200, 200, 47, 200, 200, 200, 2, 200, 200, 200, 105, 48, 145, 59, 60, 200, 65, 200, 102, 200, 200, 200, 200, 78, 127, 138, 2, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1710.9433703536556, 1776.6964904256304, 4998.079387186587, 6817.475672877206, 1089.8096259826084, 5888.6443488442565, 2196.704504143928, 38.771854272267205, 3047.710031007268, 3782.7138683072185, 1078.058942048833, 2994.0060308794195, 1113.056443637438, 214.7203529347314, 7256.544842168637, 1305.6658988136362, 20.531839206200758, 1492.8856453758517, 4450.348238002784, 1256.6202039597556, 2515.5777462220294, 5031.7865739129675, 2164.281662102419, 8194.889977889243, 8280.50043671457, 6078.1474359983995, 1055.2665450787392, 1471.1390857924837, 1532.5294110253033, 270.042766015728, 3046.4142818681084, 1542.1267469491984, 1149.7094539576583, 622.4578437874898, 2472.363136097933, 2329.841103373037, 888.797743087162, 3642.7577363761516, 3053.7828706824343, 8195.994273621365, 5328.543484165834, 393.0899739212778, 1453.644607474886, 3186.6373272900328, 698.8001674595025, 3756.0538343121457, 2102.764160460121, 2403.960176097932, 1482.3893459868552, 4903.422013831966, 3604.9723985951846, 1880.5479026441988, 2928.7990876512645, 1260.769731749254, 3477.112362038135, 6580.977378188084, 666.5938870520471, 2526.4099397273544, 3835.7862506466877, 5313.666288849716, 6358.72256553653, 2033.1569877151423, 6094.939572015712, 4349.662810464653, 422.0707238554917, 2428.9300391303045, 3165.3387801179815, 2517.2110206792386, 2.3304447922734286, 7605.05594968754, 5302.946173968103, 3025.4978304182673, 890.1282687759726, 422.61841118419636, 1048.5889359511555, 739.0449247437766, 725.869736345337, 4526.622672512214, 720.1026767432614, 7163.1102354564855, 2284.987700223449, 5526.50784544743, 7014.922617267849, 2534.327060433295, 5602.787063773862, 616.2832190756484, 2198.924525933281, 1853.6537793723855, 2.626453339867614, 5364.57912399749, 3427.045644956505, 3012.3314826978135, 4884.756937279356, 4529.613904050393, 1629.7586840409654, 2800.5937358138217, 4983.988486745749, 2626.7324698808584, 4777.978963069468, 3045.713392659981], "policy_adversary_policy_reward": [-4987.318846873447, -1710.9433703536556, -1776.6964904256304, -5051.636158731633, -7647.840238798764, -5127.744203647632, -7098.293882458713, -7045.031573197455, -1135.7366488013354, -1203.2221094029499, -5888.6443488442565, -8196.301743657734, -4286.1471921475895, -2197.128833449578, -134.13637779976324, -38.771854272267205, -6206.219649238162, -3684.4550595073747, -3878.990639198924, -6007.67665716006, -1789.5904742046716, -1934.2052632411658, -3039.268755140027, -5228.769348646985, -1113.056443637438, -5413.827112138947, -1492.8859692840851, -214.7203529347314, -9259.526557381369, -7257.490410647756, -2482.6667384569187, -2379.1025773648034, -255.72785860298495, -20.531839206200758, -3988.084911791496, -1492.8856453758517, -4450.348238002784, -7117.979899621029, -4903.055153536782, -1256.6202039597556, -2515.5777462220294, -7887.322372991288, -5069.705164829357, -7010.4982119113165, -3553.403469096213, -2172.1654146169976, -8548.866482434967, -9147.671743622086, -8939.25092006189, -8456.677589448627, -6727.568201619662, -7471.678553713211, -2381.342714751447, -1062.0913339340007, -2446.3893285878476, -1959.0734748050995, -3202.666362393858, -1532.5294110253033, -408.8681907368202, -270.042766015728, -4577.4764519043, -3833.8701640300415, -1708.4123983196012, -2106.820593761863, -1810.0502533040974, -1281.2050842817034, -1026.7799660447465, -1370.0556557891555, -2472.363136097933, -8409.724656232485, -3236.375432189422, -4807.537083796932, -2296.7394369870567, -906.9521066199084, -8340.062359784579, -3642.7577363761516, -3053.7828706824343, -6902.820359812492, -8559.59688615491, -8618.895843635386, -5328.543484165834, -7232.23082638338, -393.0899739212778, -1913.2890845778632, -1453.644607474886, -3920.885033802285, -3186.6373272900328, -7334.8146463003095, -1321.3830867646673, -980.3651158059637, -5354.565718156358, -5714.332171235132, -2102.764160460121, -6930.620084182806, -6054.582494753719, -2403.960176097932, -2697.475855803307, -1681.5101995025825, -4907.106298297964, -5981.669750187669, -3914.9660618796265, -3938.3320148742414, -1880.5479026441988, -4616.11932719956, -3554.164173589652, -5375.313826618725, -1344.3023156352654, -1340.5996619117914, -8576.013561329813, -3477.112362038135, -6632.003604491725, -8309.03226658991, -1858.0839017826838, -818.3440289514042, -2953.5802578338166, -4927.773462422523, -3922.4385027763033, -5349.757248687459, -6864.872399102973, -5426.025616931625, -6535.828159137245, -6655.807313906859, -2037.2947930053338, -7072.102661388684, -6094.939572015712, -8933.475238721805, -9121.859454558475, -4349.662810464653, -1559.996721038611, -422.0707238554917, -2428.9300391303045, -6737.559128005357, -4640.42374063252, -3309.62131115535, -2517.2110206792386, -9364.532347761486, -2.3304447922734286, -56.48106418798311, -8474.615064577238, -7606.149539783525, -5302.946173968103, -6786.136263178299, -3164.8115453121322, -4035.7304869671157, -890.1282687759726, -2571.5868066953985, -422.61841118419636, -846.8073225836116, -1048.5889359511555, -4662.988566705121, -787.5995677288502, -746.1054578242131, -2454.4677623116822, -725.869736345337, -6731.6496402245175, -4526.622672512214, -746.8516764305083, -1006.9922488393108, -7566.282642767244, -8263.423587209969, -2379.5563710992687, -2475.6441271501617, -5533.2617876013865, -6997.145656402976, -7184.502367929703, -7344.724526540642, -7036.283249488914, -2534.327060433295, -5972.88854509091, -6128.0370923548535, -616.2832190756484, -2015.291382866693, -2198.924525933281, -4739.463937863181, -3105.452274518603, -2488.425309976031, -2.626453339867614, -40.953306178669365, -5641.813133584177, -6770.663479596504, -3509.695598819073, -4340.986852610778, -3012.3314826978135, -7478.752300254692, -5819.263566590843, -5371.588578978816, -4637.632116010342, -4805.086369553585, -1949.6145917027604, -3387.541217820252, -4906.493688256109, -2800.5937358138217, -4983.988486745749, -7480.083052278377, -3225.0589605610667, -7008.547212977284, -5999.800953493546, -4976.740334597827, -7253.956795856868, -3349.3853738770154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39646695135555954, "mean_inference_ms": 0.9628805334331295, "mean_action_processing_ms": 0.16628021674954177, "mean_env_wait_ms": 0.050901576382578674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224896430969238, "StateBufferConnector_ms": 0.002934098243713379, "ViewRequirementAgentConnector_ms": 0.0821915864944458}, "num_episodes": 24, "episode_return_max": -40.953306178669365, "episode_return_min": -9501.648248167812, "episode_return_mean": -5166.909115617798}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.3607639021468, "num_env_steps_trained_throughput_per_sec": 497.3607639021468, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1812000, "timers": {"training_iteration_time_ms": 7465.869, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7465.835, "sample_time_ms": 813.466, "learn_time_ms": 6639.837, "learn_throughput": 602.424, "synch_weights_time_ms": 12.039}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "done": false, "training_iteration": 151, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-16", "timestamp": 1723232716, "time_this_iter_s": 8.05451488494873, "time_total_s": 1127.466903924942, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b315ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1127.466903924942, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 31.741666666666664, "ram_util_percent": 82.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8257922493852674, "cur_kl_coeff": 37.45137875642267, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.090501256783803, "policy_loss": 0.0015640434775074632, "vf_loss": 9.973577053348224, "vf_explained_var": 8.717818806568782e-05, "kl": 0.0030802649021400915, "entropy": 1.30473510697484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0694136336209281, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.978633294786725, "policy_loss": -0.0077992102754593055, "vf_loss": 9.983092790936666, "vf_explained_var": -0.0021604093609663543, "kl": 0.011727929717698505, "entropy": 1.3512698961313439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": -40.953306178669365, "episode_reward_min": -9837.322999251792, "episode_reward_mean": -5024.246300147155, "episode_len_mean": 156.45, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15645, "policy_reward_min": {"agent_policy": 2.3304447922734286, "adversary_policy": -9364.532347761486}, "policy_reward_max": {"agent_policy": 8682.10150512758, "adversary_policy": -2.3304447922734286}, "policy_reward_mean": {"agent_policy": 2943.28750693577, "adversary_policy": -3983.766903541463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8121.099319334471, -2388.167503606709, -2934.3237176004627, -3202.6663623938584, -408.8681907368202, -5364.93233406626, -2273.106245132266, -1941.5458836281427, -1774.3777780464118, -8409.724656232485, -5714.071412613323, -2314.893800519803, -8340.062359784577, -6902.820359812492, -8982.498456168933, -7232.23082638338, -1913.2890845778632, -3920.885033802285, -7334.8146463003095, -1602.9480351111285, -7312.844055079354, -6930.620084182806, -6054.58249475372, -2896.5967093190366, -5985.354034653667, -4248.325678158683, -4616.119327199559, -6000.678912557113, -1424.132245797803, -8576.013561329812, -8360.05849289355, -2009.8340436820408, -5354.943780528987, -5436.409500817067, -6977.2317271848815, -6832.912907507572, -7076.240466678876, -8933.475238721805, -9121.859454558475, -1559.9967210386112, -6737.559128005357, -4784.706271669892, -9364.532347761486, -56.48106418798311, -8475.708654673223, -6786.136263178299, -4175.044201860978, -2571.5868066953985, -846.8073225836116, -4662.988566705122, -794.6601008092866, -2454.467762311682, -6731.649640224517, -1033.7412485265577, -8666.595994520732, -2570.2127980259806, -7003.899598556933, -7514.3042772024955, -7036.283249488914, -6498.138573671901, -2015.291382866693, -4739.463937863181, -3740.2238051222494, -40.953306178669365, -7047.89748918319, -4423.636806473343, -7478.752300254692, -6306.0952082903, -4913.104581513533, -3707.397125482048, -4906.493688256109, -7480.083052278377, -7606.873703657494, -6198.562325021905, -7557.628777073902, -7817.295300356134, -3195.0020279084665, -5535.283947633349, -7252.043382573127, -3697.5003851806778, -2853.946891555664, -9837.322999251792, -1763.5561838324847, -5765.620594895848, -5552.6696189575, -5823.408904229756, -4601.4054589090065, -93.33396498308446, -5578.945939154108, -2134.4967189336558, -5056.321140288177, -6792.984691093188, -3378.201260130952, -8532.195021967846, -5057.547808376899, -6045.731984374376, -2561.8936692766797, -357.9536961471025, -2565.534500682605, -6860.917121351637], "episode_lengths": [200, 186, 110, 103, 34, 200, 109, 81, 91, 200, 200, 74, 200, 200, 200, 200, 49, 133, 200, 85, 200, 169, 200, 166, 200, 200, 153, 200, 75, 200, 200, 84, 154, 200, 200, 200, 159, 200, 200, 47, 200, 200, 200, 2, 200, 200, 200, 105, 48, 145, 59, 60, 200, 65, 200, 102, 200, 200, 200, 200, 78, 127, 138, 2, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 119, 114, 200, 54, 179, 200, 200, 200, 9, 200, 182, 200, 200, 86, 200, 171, 200, 102, 19, 95, 200], "policy_agent_policy_reward": [6078.1474359983995, 1055.2665450787392, 1471.1390857924837, 1532.5294110253033, 270.042766015728, 3046.4142818681084, 1542.1267469491984, 1149.7094539576583, 622.4578437874898, 2472.363136097933, 2329.841103373037, 888.797743087162, 3642.7577363761516, 3053.7828706824343, 8195.994273621365, 5328.543484165834, 393.0899739212778, 1453.644607474886, 3186.6373272900328, 698.8001674595025, 3756.0538343121457, 2102.764160460121, 2403.960176097932, 1482.3893459868552, 4903.422013831966, 3604.9723985951846, 1880.5479026441988, 2928.7990876512645, 1260.769731749254, 3477.112362038135, 6580.977378188084, 666.5938870520471, 2526.4099397273544, 3835.7862506466877, 5313.666288849716, 6358.72256553653, 2033.1569877151423, 6094.939572015712, 4349.662810464653, 422.0707238554917, 2428.9300391303045, 3165.3387801179815, 2517.2110206792386, 2.3304447922734286, 7605.05594968754, 5302.946173968103, 3025.4978304182673, 890.1282687759726, 422.61841118419636, 1048.5889359511555, 739.0449247437766, 725.869736345337, 4526.622672512214, 720.1026767432614, 7163.1102354564855, 2284.987700223449, 5526.50784544743, 7014.922617267849, 2534.327060433295, 5602.787063773862, 616.2832190756484, 2198.924525933281, 1853.6537793723855, 2.626453339867614, 5364.57912399749, 3427.045644956505, 3012.3314826978135, 4884.756937279356, 4529.613904050393, 1629.7586840409654, 2800.5937358138217, 4983.988486745749, 2626.7324698808584, 4777.978963069468, 3045.713392659981, 2466.955837632506, 2273.0045414389624, 3939.3014202234945, 4540.718471381377, 2330.6392714370977, 1005.8577738590844, 8682.10150512758, 647.3317224031391, 3630.3029744183295, 4432.403987735511, 2533.235691721223, 3554.225332387424, 23.899486757590815, 3335.143406157461, 1105.8496623231015, 2514.0408661963397, 3742.395739765632, 952.3302659931369, 6154.300656475564, 2826.5271350874687, 3777.919561045504, 1542.6415882325516, 86.18821617171416, 697.2531252508442, 4137.809852347612], "policy_adversary_policy_reward": [-6727.568201619662, -7471.678553713211, -2381.342714751447, -1062.0913339340007, -2446.3893285878476, -1959.0734748050995, -3202.666362393858, -1532.5294110253033, -408.8681907368202, -270.042766015728, -4577.4764519043, -3833.8701640300415, -1708.4123983196012, -2106.820593761863, -1810.0502533040974, -1281.2050842817034, -1026.7799660447465, -1370.0556557891555, -2472.363136097933, -8409.724656232485, -3236.375432189422, -4807.537083796932, -2296.7394369870567, -906.9521066199084, -8340.062359784579, -3642.7577363761516, -3053.7828706824343, -6902.820359812492, -8559.59688615491, -8618.895843635386, -5328.543484165834, -7232.23082638338, -393.0899739212778, -1913.2890845778632, -1453.644607474886, -3920.885033802285, -3186.6373272900328, -7334.8146463003095, -1321.3830867646673, -980.3651158059637, -5354.565718156358, -5714.332171235132, -2102.764160460121, -6930.620084182806, -6054.582494753719, -2403.960176097932, -2697.475855803307, -1681.5101995025825, -4907.106298297964, -5981.669750187669, -3914.9660618796265, -3938.3320148742414, -1880.5479026441988, -4616.11932719956, -3554.164173589652, -5375.313826618725, -1344.3023156352654, -1340.5996619117914, -8576.013561329813, -3477.112362038135, -6632.003604491725, -8309.03226658991, -1858.0839017826838, -818.3440289514042, -2953.5802578338166, -4927.773462422523, -3922.4385027763033, -5349.757248687459, -6864.872399102973, -5426.025616931625, -6535.828159137245, -6655.807313906859, -2037.2947930053338, -7072.102661388684, -6094.939572015712, -8933.475238721805, -9121.859454558475, -4349.662810464653, -1559.996721038611, -422.0707238554917, -2428.9300391303045, -6737.559128005357, -4640.42374063252, -3309.62131115535, -2517.2110206792386, -9364.532347761486, -2.3304447922734286, -56.48106418798311, -8474.615064577238, -7606.149539783525, -5302.946173968103, -6786.136263178299, -3164.8115453121322, -4035.7304869671157, -890.1282687759726, -2571.5868066953985, -422.61841118419636, -846.8073225836116, -1048.5889359511555, -4662.988566705121, -787.5995677288502, -746.1054578242131, -2454.4677623116822, -725.869736345337, -6731.6496402245175, -4526.622672512214, -746.8516764305083, -1006.9922488393108, -7566.282642767244, -8263.423587209969, -2379.5563710992687, -2475.6441271501617, -5533.2617876013865, -6997.145656402976, -7184.502367929703, -7344.724526540642, -7036.283249488914, -2534.327060433295, -5972.88854509091, -6128.0370923548535, -616.2832190756484, -2015.291382866693, -2198.924525933281, -4739.463937863181, -3105.452274518603, -2488.425309976031, -2.626453339867614, -40.953306178669365, -5641.813133584177, -6770.663479596504, -3509.695598819073, -4340.986852610778, -3012.3314826978135, -7478.752300254692, -5819.263566590843, -5371.588578978816, -4637.632116010342, -4805.086369553585, -1949.6145917027604, -3387.541217820252, -4906.493688256109, -2800.5937358138217, -4983.988486745749, -7480.083052278377, -3225.0589605610667, -7008.547212977284, -5999.800953493546, -4976.740334597827, -7253.956795856868, -3349.3853738770154, -2466.955837632506, -7817.295300356134, -2735.873984374284, -2732.1325849731497, -4607.923750807248, -4866.661617049591, -7238.381953485896, -4554.379900468609, -3597.34677990216, -2430.792876715615, -2083.320423919484, -1776.4842414952643, -9257.293075280719, -9262.131429098647, -647.3317224031391, -1763.5561838324847, -4560.225827856621, -4835.697741457546, -5337.424446637048, -4647.649160055958, -5669.008275463765, -2687.6363204872146, -4384.9364574993215, -3770.694333797113, -93.33396498308444, -23.899486757590815, -5578.945939154108, -3335.143406157461, -1611.599689983153, -1628.746691273602, -2514.0408661963397, -5056.321140288177, -6773.901004484615, -3761.4794263742046, -952.3302659931369, -3378.201260130952, -8337.428417196106, -6349.067261247303, -3546.250460241185, -4337.824483223185, -5415.758735252419, -4407.892810167456, -2208.54123842198, -1895.9940190872496, -357.95369614710256, -86.18821617171416, -1034.0667158069916, -2228.720910126458, -4137.809852347612, -6860.917121351637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3969963315312146, "mean_inference_ms": 0.965684108539945, "mean_action_processing_ms": 0.16649729105437777, "mean_env_wait_ms": 0.05093154589643982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004268646240234375, "StateBufferConnector_ms": 0.0027681589126586914, "ViewRequirementAgentConnector_ms": 0.08145594596862793}, "num_episodes": 25, "episode_return_max": -40.953306178669365, "episode_return_min": -9837.322999251792, "episode_return_mean": -5024.246300147155}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.0100423198677, "num_env_steps_trained_throughput_per_sec": 557.0100423198677, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 7454.245, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7454.21, "sample_time_ms": 810.932, "learn_time_ms": 6630.699, "learn_throughput": 603.255, "synch_weights_time_ms": 12.118}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 152, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-23", "timestamp": 1723232723, "time_this_iter_s": 7.186983823776245, "time_total_s": 1134.6538877487183, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31abdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1134.6538877487183, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 25.1, "ram_util_percent": 82.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.307048673182726, "cur_kl_coeff": 18.725689378211335, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.048384379347166, "policy_loss": -0.0013613225285856363, "vf_loss": 9.974062978227932, "vf_explained_var": 0.0001986159011721611, "kl": 0.004041651541047031, "entropy": 1.3390787507096926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0771977357763463, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991391990802907, "policy_loss": 0.0023394827595443796, "vf_loss": 9.985207826624471, "vf_explained_var": 0.0006785618249701444, "kl": 0.013501210737401846, "entropy": 1.3606666995734764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "env_runners": {"episode_reward_max": -29.701195476899045, "episode_reward_min": -9837.322999251792, "episode_reward_mean": -4993.981530963274, "episode_len_mean": 159.33, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15933, "policy_reward_min": {"agent_policy": 0.43774419208607357, "adversary_policy": -9364.532347761486}, "policy_reward_max": {"agent_policy": 8682.10150512758, "adversary_policy": -0.43774419208607357}, "policy_reward_mean": {"agent_policy": 3003.874914799634, "adversary_policy": -3998.928222881454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4248.325678158683, -4616.119327199559, -6000.678912557113, -1424.132245797803, -8576.013561329812, -8360.05849289355, -2009.8340436820408, -5354.943780528987, -5436.409500817067, -6977.2317271848815, -6832.912907507572, -7076.240466678876, -8933.475238721805, -9121.859454558475, -1559.9967210386112, -6737.559128005357, -4784.706271669892, -9364.532347761486, -56.48106418798311, -8475.708654673223, -6786.136263178299, -4175.044201860978, -2571.5868066953985, -846.8073225836116, -4662.988566705122, -794.6601008092866, -2454.467762311682, -6731.649640224517, -1033.7412485265577, -8666.595994520732, -2570.2127980259806, -7003.899598556933, -7514.3042772024955, -7036.283249488914, -6498.138573671901, -2015.291382866693, -4739.463937863181, -3740.2238051222494, -40.953306178669365, -7047.89748918319, -4423.636806473343, -7478.752300254692, -6306.0952082903, -4913.104581513533, -3707.397125482048, -4906.493688256109, -7480.083052278377, -7606.873703657494, -6198.562325021905, -7557.628777073902, -7817.295300356134, -3195.0020279084665, -5535.283947633349, -7252.043382573127, -3697.5003851806778, -2853.946891555664, -9837.322999251792, -1763.5561838324847, -5765.620594895848, -5552.6696189575, -5823.408904229756, -4601.4054589090065, -93.33396498308446, -5578.945939154108, -2134.4967189336558, -5056.321140288177, -6792.984691093188, -3378.201260130952, -8532.195021967846, -5057.547808376899, -6045.731984374376, -2561.8936692766797, -357.9536961471025, -2565.534500682605, -6860.917121351637, -5506.301626994705, -1225.4064978493602, -3027.5190925171387, -8295.940670461125, -6579.573755062836, -3998.9277568194557, -5122.482405796655, -3613.363415987412, -5090.968091127723, -4336.274804162747, -2096.195449856396, -6596.362905970509, -7886.781427308905, -6503.045843055033, -6620.646088125022, -6915.208556159076, -1581.999567919056, -29.701195476899045, -8009.92514475111, -849.2542234769543, -4843.354008697416, -4543.412047480124, -4180.919580694886, -5126.133886749489, -4651.148422952362], "episode_lengths": [200, 153, 200, 75, 200, 200, 84, 154, 200, 200, 200, 159, 200, 200, 47, 200, 200, 200, 2, 200, 200, 200, 105, 48, 145, 59, 60, 200, 65, 200, 102, 200, 200, 200, 200, 78, 127, 138, 2, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 119, 114, 200, 54, 179, 200, 200, 200, 9, 200, 182, 200, 200, 86, 200, 171, 200, 102, 19, 95, 200, 200, 76, 73, 200, 200, 141, 191, 157, 200, 200, 137, 200, 200, 200, 200, 200, 70, 1, 200, 45, 200, 200, 187, 200, 200], "policy_agent_policy_reward": [3604.9723985951846, 1880.5479026441988, 2928.7990876512645, 1260.769731749254, 3477.112362038135, 6580.977378188084, 666.5938870520471, 2526.4099397273544, 3835.7862506466877, 5313.666288849716, 6358.72256553653, 2033.1569877151423, 6094.939572015712, 4349.662810464653, 422.0707238554917, 2428.9300391303045, 3165.3387801179815, 2517.2110206792386, 2.3304447922734286, 7605.05594968754, 5302.946173968103, 3025.4978304182673, 890.1282687759726, 422.61841118419636, 1048.5889359511555, 739.0449247437766, 725.869736345337, 4526.622672512214, 720.1026767432614, 7163.1102354564855, 2284.987700223449, 5526.50784544743, 7014.922617267849, 2534.327060433295, 5602.787063773862, 616.2832190756484, 2198.924525933281, 1853.6537793723855, 2.626453339867614, 5364.57912399749, 3427.045644956505, 3012.3314826978135, 4884.756937279356, 4529.613904050393, 1629.7586840409654, 2800.5937358138217, 4983.988486745749, 2626.7324698808584, 4777.978963069468, 3045.713392659981, 2466.955837632506, 2273.0045414389624, 3939.3014202234945, 4540.718471381377, 2330.6392714370977, 1005.8577738590844, 8682.10150512758, 647.3317224031391, 3630.3029744183295, 4432.403987735511, 2533.235691721223, 3554.225332387424, 23.899486757590815, 3335.143406157461, 1105.8496623231015, 2514.0408661963397, 3742.395739765632, 952.3302659931369, 6154.300656475564, 2826.5271350874687, 3777.919561045504, 1542.6415882325516, 86.18821617171416, 697.2531252508442, 4137.809852347612, 3816.947529203428, 874.2398284265896, 439.5282513654693, 7543.147675441121, 2408.8838349728417, 2698.6273831025132, 2970.030437551391, 1173.097699982299, 4296.71539469056, 3509.914680102978, 1077.7994386650728, 4747.260296058833, 4374.592787675135, 3333.6426445314664, 2475.954848987118, 4233.685404204914, 974.507345948555, 0.43774419208607357, 5699.70794255276, 442.6967899619777, 2917.0928206160997, 1907.8657976044412, 2091.118153185576, 1271.5831118503895, 3840.338470224563], "policy_adversary_policy_reward": [-3914.9660618796265, -3938.3320148742414, -1880.5479026441988, -4616.11932719956, -3554.164173589652, -5375.313826618725, -1344.3023156352654, -1340.5996619117914, -8576.013561329813, -3477.112362038135, -6632.003604491725, -8309.03226658991, -1858.0839017826838, -818.3440289514042, -2953.5802578338166, -4927.773462422523, -3922.4385027763033, -5349.757248687459, -6864.872399102973, -5426.025616931625, -6535.828159137245, -6655.807313906859, -2037.2947930053338, -7072.102661388684, -6094.939572015712, -8933.475238721805, -9121.859454558475, -4349.662810464653, -1559.996721038611, -422.0707238554917, -2428.9300391303045, -6737.559128005357, -4640.42374063252, -3309.62131115535, -2517.2110206792386, -9364.532347761486, -2.3304447922734286, -56.48106418798311, -8474.615064577238, -7606.149539783525, -5302.946173968103, -6786.136263178299, -3164.8115453121322, -4035.7304869671157, -890.1282687759726, -2571.5868066953985, -422.61841118419636, -846.8073225836116, -1048.5889359511555, -4662.988566705121, -787.5995677288502, -746.1054578242131, -2454.4677623116822, -725.869736345337, -6731.6496402245175, -4526.622672512214, -746.8516764305083, -1006.9922488393108, -7566.282642767244, -8263.423587209969, -2379.5563710992687, -2475.6441271501617, -5533.2617876013865, -6997.145656402976, -7184.502367929703, -7344.724526540642, -7036.283249488914, -2534.327060433295, -5972.88854509091, -6128.0370923548535, -616.2832190756484, -2015.291382866693, -2198.924525933281, -4739.463937863181, -3105.452274518603, -2488.425309976031, -2.626453339867614, -40.953306178669365, -5641.813133584177, -6770.663479596504, -3509.695598819073, -4340.986852610778, -3012.3314826978135, -7478.752300254692, -5819.263566590843, -5371.588578978816, -4637.632116010342, -4805.086369553585, -1949.6145917027604, -3387.541217820252, -4906.493688256109, -2800.5937358138217, -4983.988486745749, -7480.083052278377, -3225.0589605610667, -7008.547212977284, -5999.800953493546, -4976.740334597827, -7253.956795856868, -3349.3853738770154, -2466.955837632506, -7817.295300356134, -2735.873984374284, -2732.1325849731497, -4607.923750807248, -4866.661617049591, -7238.381953485896, -4554.379900468609, -3597.34677990216, -2430.792876715615, -2083.320423919484, -1776.4842414952643, -9257.293075280719, -9262.131429098647, -647.3317224031391, -1763.5561838324847, -4560.225827856621, -4835.697741457546, -5337.424446637048, -4647.649160055958, -5669.008275463765, -2687.6363204872146, -4384.9364574993215, -3770.694333797113, -93.33396498308444, -23.899486757590815, -5578.945939154108, -3335.143406157461, -1611.599689983153, -1628.746691273602, -2514.0408661963397, -5056.321140288177, -6773.901004484615, -3761.4794263742046, -952.3302659931369, -3378.201260130952, -8337.428417196106, -6349.067261247303, -3546.250460241185, -4337.824483223185, -5415.758735252419, -4407.892810167456, -2208.54123842198, -1895.9940190872496, -357.95369614710256, -86.18821617171416, -1034.0667158069916, -2228.720910126458, -4137.809852347612, -6860.917121351637, -3850.598654118533, -5472.650502079599, -930.3388490298013, -1169.3074772461484, -439.5282513654693, -3027.5190925171387, -7688.842795281289, -8150.245550620959, -2408.8838349728417, -6579.573755062837, -3800.701448555865, -2896.853691366103, -4980.530311417386, -3111.9825319306624, -1175.1296150914152, -3611.3315008782956, -4468.294073981227, -4919.389411837056, -3669.205223885137, -4176.984260380591, -1424.8216959706185, -1749.1731925508498, -5634.509099896113, -5709.114102133223, -7462.453611927721, -4798.920603056318, -6503.045843055031, -3333.6426445314664, -6441.706706333182, -2654.894230778947, -5001.114440710768, -6147.7795196532425, -1572.6634663855705, -983.8434474820407, -0.43774419208607357, -29.701195476899045, -6887.808595540642, -6821.824491763238, -849.2542234769543, -442.6967899619777, -3582.751180509601, -4177.695648803922, -1960.056537949886, -4491.221307134678, -4114.856573531616, -2157.181160348845, -1271.5831118503895, -5126.133886749489, -4042.9082390026483, -4448.578654174265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39738044965032776, "mean_inference_ms": 0.9678179406386767, "mean_action_processing_ms": 0.16671829842351585, "mean_env_wait_ms": 0.05099784531237082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041741132736206055, "StateBufferConnector_ms": 0.002742290496826172, "ViewRequirementAgentConnector_ms": 0.08016157150268555}, "num_episodes": 25, "episode_return_max": -29.701195476899045, "episode_return_min": -9837.322999251792, "episode_return_mean": -4993.981530963274}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.8257835222917, "num_env_steps_trained_throughput_per_sec": 546.8257835222917, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1836000, "timers": {"training_iteration_time_ms": 7453.822, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7453.788, "sample_time_ms": 815.624, "learn_time_ms": 6625.459, "learn_throughput": 603.732, "synch_weights_time_ms": 12.244}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "done": false, "training_iteration": 153, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-31", "timestamp": 1723232731, "time_this_iter_s": 7.318886041641235, "time_total_s": 1141.9727737903595, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b315aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1141.9727737903595, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 25.236363636363635, "ram_util_percent": 82.73636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0058044396030406, "cur_kl_coeff": 9.362844689105668, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998445712526639, "policy_loss": 0.0011271554460108746, "vf_loss": 9.975975495576858, "vf_explained_var": 5.9668285151322685e-05, "kl": 0.0022795491130333783, "entropy": 1.360467201595505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0840943128343612, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988993836962987, "policy_loss": -0.0043979390847087695, "vf_loss": 9.989388746937747, "vf_explained_var": -0.0001579958295065259, "kl": 0.014057279690094883, "entropy": 1.3820270284143075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": -29.701195476899045, "episode_reward_min": -9837.322999251792, "episode_reward_mean": -4835.000253117914, "episode_len_mean": 159.28, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 15928, "policy_reward_min": {"agent_policy": 0.43774419208607357, "adversary_policy": -9464.151767119893}, "policy_reward_max": {"agent_policy": 8682.10150512758, "adversary_policy": -0.43774419208607357}, "policy_reward_mean": {"agent_policy": 2905.1985550068293, "adversary_policy": -3870.0994040623727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6601008092866, -2454.467762311682, -6731.649640224517, -1033.7412485265577, -8666.595994520732, -2570.2127980259806, -7003.899598556933, -7514.3042772024955, -7036.283249488914, -6498.138573671901, -2015.291382866693, -4739.463937863181, -3740.2238051222494, -40.953306178669365, -7047.89748918319, -4423.636806473343, -7478.752300254692, -6306.0952082903, -4913.104581513533, -3707.397125482048, -4906.493688256109, -7480.083052278377, -7606.873703657494, -6198.562325021905, -7557.628777073902, -7817.295300356134, -3195.0020279084665, -5535.283947633349, -7252.043382573127, -3697.5003851806778, -2853.946891555664, -9837.322999251792, -1763.5561838324847, -5765.620594895848, -5552.6696189575, -5823.408904229756, -4601.4054589090065, -93.33396498308446, -5578.945939154108, -2134.4967189336558, -5056.321140288177, -6792.984691093188, -3378.201260130952, -8532.195021967846, -5057.547808376899, -6045.731984374376, -2561.8936692766797, -357.9536961471025, -2565.534500682605, -6860.917121351637, -5506.301626994705, -1225.4064978493602, -3027.5190925171387, -8295.940670461125, -6579.573755062836, -3998.9277568194557, -5122.482405796655, -3613.363415987412, -5090.968091127723, -4336.274804162747, -2096.195449856396, -6596.362905970509, -7886.781427308905, -6503.045843055033, -6620.646088125022, -6915.208556159076, -1581.999567919056, -29.701195476899045, -8009.92514475111, -849.2542234769543, -4843.354008697416, -4543.412047480124, -4180.919580694886, -5126.133886749489, -4651.148422952362, -3559.179473907073, -4202.700562659327, -7209.049979614041, -7524.077458976911, -5052.339056714171, -2459.647801795428, -6057.520197165984, -7573.145885645801, -4102.474477496869, -6376.248235714018, -8259.785932758421, -33.94609014594478, -3072.7169981844972, -6221.386385991526, -2409.8223900075504, -3146.986950899025, -6885.8210738303505, -1633.1262786902137, -1365.4015267771067, -6968.147137784126, -9464.151767119893, -6361.3834189815125, -5723.536506941996, -2439.48579003064, -989.5735236078037], "episode_lengths": [59, 60, 200, 65, 200, 102, 200, 200, 200, 200, 78, 127, 138, 2, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 119, 114, 200, 54, 179, 200, 200, 200, 9, 200, 182, 200, 200, 86, 200, 171, 200, 102, 19, 95, 200, 200, 76, 73, 200, 200, 141, 191, 157, 200, 200, 137, 200, 200, 200, 200, 200, 70, 1, 200, 45, 200, 200, 187, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 1, 144, 200, 124, 200, 166, 49, 42, 200, 200, 200, 200, 69, 70], "policy_agent_policy_reward": [739.0449247437766, 725.869736345337, 4526.622672512214, 720.1026767432614, 7163.1102354564855, 2284.987700223449, 5526.50784544743, 7014.922617267849, 2534.327060433295, 5602.787063773862, 616.2832190756484, 2198.924525933281, 1853.6537793723855, 2.626453339867614, 5364.57912399749, 3427.045644956505, 3012.3314826978135, 4884.756937279356, 4529.613904050393, 1629.7586840409654, 2800.5937358138217, 4983.988486745749, 2626.7324698808584, 4777.978963069468, 3045.713392659981, 2466.955837632506, 2273.0045414389624, 3939.3014202234945, 4540.718471381377, 2330.6392714370977, 1005.8577738590844, 8682.10150512758, 647.3317224031391, 3630.3029744183295, 4432.403987735511, 2533.235691721223, 3554.225332387424, 23.899486757590815, 3335.143406157461, 1105.8496623231015, 2514.0408661963397, 3742.395739765632, 952.3302659931369, 6154.300656475564, 2826.5271350874687, 3777.919561045504, 1542.6415882325516, 86.18821617171416, 697.2531252508442, 4137.809852347612, 3816.947529203428, 874.2398284265896, 439.5282513654693, 7543.147675441121, 2408.8838349728417, 2698.6273831025132, 2970.030437551391, 1173.097699982299, 4296.71539469056, 3509.914680102978, 1077.7994386650728, 4747.260296058833, 4374.592787675135, 3333.6426445314664, 2475.954848987118, 4233.685404204914, 974.507345948555, 0.43774419208607357, 5699.70794255276, 442.6967899619777, 2917.0928206160997, 1907.8657976044412, 2091.118153185576, 1271.5831118503895, 3840.338470224563, 1878.1463797180954, 2554.045973112808, 5361.045556368415, 3686.827448744337, 3341.2789622061528, 1216.974024734396, 4907.091024409199, 3178.7171987611405, 2568.500641284227, 1915.9354840685241, 5627.914770286589, 0.5435765623004514, 2259.6046202327857, 3456.184141413717, 2148.8624431315516, 2200.7225589980035, 3379.944079849667, 427.88962204724925, 496.1200649859445, 2898.4316138480654, 7143.58882388919, 2658.3748530012494, 3710.129421509287, 326.4937436716, 531.8307353194966], "policy_adversary_policy_reward": [-787.5995677288502, -746.1054578242131, -2454.4677623116822, -725.869736345337, -6731.6496402245175, -4526.622672512214, -746.8516764305083, -1006.9922488393108, -7566.282642767244, -8263.423587209969, -2379.5563710992687, -2475.6441271501617, -5533.2617876013865, -6997.145656402976, -7184.502367929703, -7344.724526540642, -7036.283249488914, -2534.327060433295, -5972.88854509091, -6128.0370923548535, -616.2832190756484, -2015.291382866693, -2198.924525933281, -4739.463937863181, -3105.452274518603, -2488.425309976031, -2.626453339867614, -40.953306178669365, -5641.813133584177, -6770.663479596504, -3509.695598819073, -4340.986852610778, -3012.3314826978135, -7478.752300254692, -5819.263566590843, -5371.588578978816, -4637.632116010342, -4805.086369553585, -1949.6145917027604, -3387.541217820252, -4906.493688256109, -2800.5937358138217, -4983.988486745749, -7480.083052278377, -3225.0589605610667, -7008.547212977284, -5999.800953493546, -4976.740334597827, -7253.956795856868, -3349.3853738770154, -2466.955837632506, -7817.295300356134, -2735.873984374284, -2732.1325849731497, -4607.923750807248, -4866.661617049591, -7238.381953485896, -4554.379900468609, -3597.34677990216, -2430.792876715615, -2083.320423919484, -1776.4842414952643, -9257.293075280719, -9262.131429098647, -647.3317224031391, -1763.5561838324847, -4560.225827856621, -4835.697741457546, -5337.424446637048, -4647.649160055958, -5669.008275463765, -2687.6363204872146, -4384.9364574993215, -3770.694333797113, -93.33396498308444, -23.899486757590815, -5578.945939154108, -3335.143406157461, -1611.599689983153, -1628.746691273602, -2514.0408661963397, -5056.321140288177, -6773.901004484615, -3761.4794263742046, -952.3302659931369, -3378.201260130952, -8337.428417196106, -6349.067261247303, -3546.250460241185, -4337.824483223185, -5415.758735252419, -4407.892810167456, -2208.54123842198, -1895.9940190872496, -357.95369614710256, -86.18821617171416, -1034.0667158069916, -2228.720910126458, -4137.809852347612, -6860.917121351637, -3850.598654118533, -5472.650502079599, -930.3388490298013, -1169.3074772461484, -439.5282513654693, -3027.5190925171387, -7688.842795281289, -8150.245550620959, -2408.8838349728417, -6579.573755062837, -3800.701448555865, -2896.853691366103, -4980.530311417386, -3111.9825319306624, -1175.1296150914152, -3611.3315008782956, -4468.294073981227, -4919.389411837056, -3669.205223885137, -4176.984260380591, -1424.8216959706185, -1749.1731925508498, -5634.509099896113, -5709.114102133223, -7462.453611927721, -4798.920603056318, -6503.045843055031, -3333.6426445314664, -6441.706706333182, -2654.894230778947, -5001.114440710768, -6147.7795196532425, -1572.6634663855705, -983.8434474820407, -0.43774419208607357, -29.701195476899045, -6887.808595540642, -6821.824491763238, -849.2542234769543, -442.6967899619777, -3582.751180509601, -4177.695648803922, -1960.056537949886, -4491.221307134678, -4114.856573531616, -2157.181160348845, -1271.5831118503895, -5126.133886749489, -4042.9082390026483, -4448.578654174265, -3057.8742818617807, -2379.4515717633876, -4202.091285417366, -2554.65525035477, -7087.861048981021, -5482.2344870014385, -3687.12759708134, -7523.777310639907, -3482.7904272933033, -4910.827591627023, -2367.7114728238444, -1308.9103537059805, -5608.052837744249, -5356.558383830932, -3178.7171987611405, -7573.145885645802, -3947.1492602451062, -2723.825858535991, -1915.9354840685241, -6376.248235714018, -8259.785932758421, -5627.914770286589, -0.5435765623004514, -33.94609014594478, -2564.67673921977, -2767.644879197516, -3456.184141413717, -6221.386385991526, -2150.4063141908464, -2408.278518948255, -2987.3518589783985, -2360.35765091863, -6885.8210738303505, -3379.944079849667, -1633.1262786902134, -427.88962204724925, -1365.4015267771067, -496.1200649859445, -2898.4316138480654, -6968.147137784126, -9464.151767119893, -7143.58882388919, -4194.691325146326, -4825.066946836441, -5347.434056951769, -4086.231871499559, -326.4937436716, -2439.48579003064, -789.0655598509444, -732.3386990763584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3973871653376475, "mean_inference_ms": 0.9670236873751903, "mean_action_processing_ms": 0.16667488491080407, "mean_env_wait_ms": 0.05100061543989526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489851951599121, "StateBufferConnector_ms": 0.0026701688766479492, "ViewRequirementAgentConnector_ms": 0.06792795658111572}, "num_episodes": 25, "episode_return_max": -29.701195476899045, "episode_return_min": -9837.322999251792, "episode_return_mean": -4835.000253117914}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 560.3596275455045, "num_env_steps_trained_throughput_per_sec": 560.3596275455045, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 7432.794, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7432.76, "sample_time_ms": 818.081, "learn_time_ms": 6602.212, "learn_throughput": 605.858, "synch_weights_time_ms": 11.976}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 154, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-38", "timestamp": 1723232738, "time_this_iter_s": 7.142381906509399, "time_total_s": 1149.115155696869, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32180d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1149.115155696869, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 24.340000000000003, "ram_util_percent": 82.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0359956620881954, "cur_kl_coeff": 4.681422344552834, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9816061069568, "policy_loss": 0.002460813989455346, "vf_loss": 9.970079738895098, "vf_explained_var": 0.00013332596669594446, "kl": 0.0019364950507830751, "entropy": 1.4023273731271426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1049933607616123, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97624987698106, "policy_loss": -0.006973015797132301, "vf_loss": 9.978901456903529, "vf_explained_var": 0.0005541323669373043, "kl": 0.015175384235760522, "entropy": 1.3569931386639833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "env_runners": {"episode_reward_max": -29.701195476899045, "episode_reward_min": -9837.322999251792, "episode_reward_mean": -4753.611208655754, "episode_len_mean": 160.95, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 16095, "policy_reward_min": {"agent_policy": 0.43774419208607357, "adversary_policy": -9464.151767119893}, "policy_reward_max": {"agent_policy": 8682.10150512758, "adversary_policy": -0.43774419208607357}, "policy_reward_mean": {"agent_policy": 2784.923849955614, "adversary_policy": -3769.267529305684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7817.295300356134, -3195.0020279084665, -5535.283947633349, -7252.043382573127, -3697.5003851806778, -2853.946891555664, -9837.322999251792, -1763.5561838324847, -5765.620594895848, -5552.6696189575, -5823.408904229756, -4601.4054589090065, -93.33396498308446, -5578.945939154108, -2134.4967189336558, -5056.321140288177, -6792.984691093188, -3378.201260130952, -8532.195021967846, -5057.547808376899, -6045.731984374376, -2561.8936692766797, -357.9536961471025, -2565.534500682605, -6860.917121351637, -5506.301626994705, -1225.4064978493602, -3027.5190925171387, -8295.940670461125, -6579.573755062836, -3998.9277568194557, -5122.482405796655, -3613.363415987412, -5090.968091127723, -4336.274804162747, -2096.195449856396, -6596.362905970509, -7886.781427308905, -6503.045843055033, -6620.646088125022, -6915.208556159076, -1581.999567919056, -29.701195476899045, -8009.92514475111, -849.2542234769543, -4843.354008697416, -4543.412047480124, -4180.919580694886, -5126.133886749489, -4651.148422952362, -3559.179473907073, -4202.700562659327, -7209.049979614041, -7524.077458976911, -5052.339056714171, -2459.647801795428, -6057.520197165984, -7573.145885645801, -4102.474477496869, -6376.248235714018, -8259.785932758421, -33.94609014594478, -3072.7169981844972, -6221.386385991526, -2409.8223900075504, -3146.986950899025, -6885.8210738303505, -1633.1262786902137, -1365.4015267771067, -6968.147137784126, -9464.151767119893, -6361.3834189815125, -5723.536506941996, -2439.48579003064, -989.5735236078037, -4893.6571661777225, -6144.567496634296, -4671.1620913308225, -3656.8069470620753, -4182.996072428562, -1051.216623242422, -4235.293713847707, -3494.7158173063, -177.17536881087761, -4451.093514225952, -6595.264556965884, -6391.180528266286, -905.1230913067726, -4857.882012127404, -6818.717719066881, -6380.024868014954, -8282.346513604221, -4667.559432146302, -7243.6908031928315, -5132.330111876125, -4613.796776031979, -2480.1975453215255, -8638.810505252817, -5779.420842647246, -4582.476169750662], "episode_lengths": [200, 200, 200, 200, 119, 114, 200, 54, 179, 200, 200, 200, 9, 200, 182, 200, 200, 86, 200, 171, 200, 102, 19, 95, 200, 200, 76, 73, 200, 200, 141, 191, 157, 200, 200, 137, 200, 200, 200, 200, 200, 70, 1, 200, 45, 200, 200, 187, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 1, 144, 200, 124, 200, 166, 49, 42, 200, 200, 200, 200, 69, 70, 200, 200, 200, 129, 200, 27, 172, 105, 25, 173, 200, 200, 62, 186, 200, 200, 200, 141, 200, 184, 200, 170, 200, 146, 200], "policy_agent_policy_reward": [2466.955837632506, 2273.0045414389624, 3939.3014202234945, 4540.718471381377, 2330.6392714370977, 1005.8577738590844, 8682.10150512758, 647.3317224031391, 3630.3029744183295, 4432.403987735511, 2533.235691721223, 3554.225332387424, 23.899486757590815, 3335.143406157461, 1105.8496623231015, 2514.0408661963397, 3742.395739765632, 952.3302659931369, 6154.300656475564, 2826.5271350874687, 3777.919561045504, 1542.6415882325516, 86.18821617171416, 697.2531252508442, 4137.809852347612, 3816.947529203428, 874.2398284265896, 439.5282513654693, 7543.147675441121, 2408.8838349728417, 2698.6273831025132, 2970.030437551391, 1173.097699982299, 4296.71539469056, 3509.914680102978, 1077.7994386650728, 4747.260296058833, 4374.592787675135, 3333.6426445314664, 2475.954848987118, 4233.685404204914, 974.507345948555, 0.43774419208607357, 5699.70794255276, 442.6967899619777, 2917.0928206160997, 1907.8657976044412, 2091.118153185576, 1271.5831118503895, 3840.338470224563, 1878.1463797180954, 2554.045973112808, 5361.045556368415, 3686.827448744337, 3341.2789622061528, 1216.974024734396, 4907.091024409199, 3178.7171987611405, 2568.500641284227, 1915.9354840685241, 5627.914770286589, 0.5435765623004514, 2259.6046202327857, 3456.184141413717, 2148.8624431315516, 2200.7225589980035, 3379.944079849667, 427.88962204724925, 496.1200649859445, 2898.4316138480654, 7143.58882388919, 2658.3748530012494, 3710.129421509287, 326.4937436716, 531.8307353194966, 3341.4808566067345, 5595.753715646073, 2745.417024892398, 1569.7084771353639, 3260.6291742835783, 81.6928022001039, 3325.8291771268377, 1137.5152387310372, 124.94669410318295, 1871.7319124134365, 3995.2682586560563, 3226.43628370079, 540.9822300185506, 4299.519877901983, 2974.732289673981, 4178.570458321317, 5026.986273057905, 1211.4984128479234, 5854.967262500072, 2202.9942963385884, 2087.425672547549, 1681.3615713469487, 6159.218677669129, 1946.605228562798, 2124.120964456677], "policy_adversary_policy_reward": [-2466.955837632506, -7817.295300356134, -2735.873984374284, -2732.1325849731497, -4607.923750807248, -4866.661617049591, -7238.381953485896, -4554.379900468609, -3597.34677990216, -2430.792876715615, -2083.320423919484, -1776.4842414952643, -9257.293075280719, -9262.131429098647, -647.3317224031391, -1763.5561838324847, -4560.225827856621, -4835.697741457546, -5337.424446637048, -4647.649160055958, -5669.008275463765, -2687.6363204872146, -4384.9364574993215, -3770.694333797113, -93.33396498308444, -23.899486757590815, -5578.945939154108, -3335.143406157461, -1611.599689983153, -1628.746691273602, -2514.0408661963397, -5056.321140288177, -6773.901004484615, -3761.4794263742046, -952.3302659931369, -3378.201260130952, -8337.428417196106, -6349.067261247303, -3546.250460241185, -4337.824483223185, -5415.758735252419, -4407.892810167456, -2208.54123842198, -1895.9940190872496, -357.95369614710256, -86.18821617171416, -1034.0667158069916, -2228.720910126458, -4137.809852347612, -6860.917121351637, -3850.598654118533, -5472.650502079599, -930.3388490298013, -1169.3074772461484, -439.5282513654693, -3027.5190925171387, -7688.842795281289, -8150.245550620959, -2408.8838349728417, -6579.573755062837, -3800.701448555865, -2896.853691366103, -4980.530311417386, -3111.9825319306624, -1175.1296150914152, -3611.3315008782956, -4468.294073981227, -4919.389411837056, -3669.205223885137, -4176.984260380591, -1424.8216959706185, -1749.1731925508498, -5634.509099896113, -5709.114102133223, -7462.453611927721, -4798.920603056318, -6503.045843055031, -3333.6426445314664, -6441.706706333182, -2654.894230778947, -5001.114440710768, -6147.7795196532425, -1572.6634663855705, -983.8434474820407, -0.43774419208607357, -29.701195476899045, -6887.808595540642, -6821.824491763238, -849.2542234769543, -442.6967899619777, -3582.751180509601, -4177.695648803922, -1960.056537949886, -4491.221307134678, -4114.856573531616, -2157.181160348845, -1271.5831118503895, -5126.133886749489, -4042.9082390026483, -4448.578654174265, -3057.8742818617807, -2379.4515717633876, -4202.091285417366, -2554.65525035477, -7087.861048981021, -5482.2344870014385, -3687.12759708134, -7523.777310639907, -3482.7904272933033, -4910.827591627023, -2367.7114728238444, -1308.9103537059805, -5608.052837744249, -5356.558383830932, -3178.7171987611405, -7573.145885645802, -3947.1492602451062, -2723.825858535991, -1915.9354840685241, -6376.248235714018, -8259.785932758421, -5627.914770286589, -0.5435765623004514, -33.94609014594478, -2564.67673921977, -2767.644879197516, -3456.184141413717, -6221.386385991526, -2150.4063141908464, -2408.278518948255, -2987.3518589783985, -2360.35765091863, -6885.8210738303505, -3379.944079849667, -1633.1262786902134, -427.88962204724925, -1365.4015267771067, -496.1200649859445, -2898.4316138480654, -6968.147137784126, -9464.151767119893, -7143.58882388919, -4194.691325146326, -4825.066946836441, -5347.434056951769, -4086.231871499559, -326.4937436716, -2439.48579003064, -789.0655598509444, -732.3386990763584, -4893.657166177721, -3341.4808566067345, -5966.721811562181, -5773.599400718188, -4671.1620913308225, -2745.417024892398, -1569.7084771353639, -3656.8069470620753, -3260.931129101458, -4182.694117610682, -81.6928022001039, -1051.216623242422, -4189.071688707962, -3372.0512022665825, -1137.5152387310372, -3494.715817306301, -125.28128569694597, -176.84077721711458, -3403.6493658466334, -2919.176060792752, -3995.2682586560563, -6595.264556965884, -6391.180528266285, -3226.43628370079, -654.8113875255559, -791.2939337997672, -4363.473221609776, -4793.928668419611, -6818.717719066881, -2974.732289673981, -5718.618641745267, -4839.976684591002, -8282.346513604221, -5026.986273057905, -4667.559432146302, -1211.4984128479234, -6654.255650755656, -6444.402414937247, -3052.470712527566, -4282.85369568714, -3257.9817441845653, -3443.240704394967, -2422.588334065145, -1738.9707826033311, -8322.085500720392, -6475.943682201543, -5779.420842647245, -1946.605228562798, -3593.1187512045303, -3113.4783830028055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3973340050406124, "mean_inference_ms": 0.9657768251014663, "mean_action_processing_ms": 0.16659329980319512, "mean_env_wait_ms": 0.05101743635654592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032404661178588867, "StateBufferConnector_ms": 0.002589106559753418, "ViewRequirementAgentConnector_ms": 0.06977272033691406}, "num_episodes": 25, "episode_return_max": -29.701195476899045, "episode_return_min": -9837.322999251792, "episode_return_mean": -4753.611208655754}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.6566038375423, "num_env_steps_trained_throughput_per_sec": 542.6566038375423, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1860000, "timers": {"training_iteration_time_ms": 7447.499, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7447.465, "sample_time_ms": 828.193, "learn_time_ms": 6606.744, "learn_throughput": 605.442, "synch_weights_time_ms": 12.046}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "done": false, "training_iteration": 155, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-46", "timestamp": 1723232746, "time_this_iter_s": 7.376065015792847, "time_total_s": 1156.4912207126617, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3218700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1156.4912207126617, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 26.19090909090909, "ram_util_percent": 82.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9411633040755987, "cur_kl_coeff": 2.340711172276417, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.981506566206614, "policy_loss": -0.0005711622655023044, "vf_loss": 9.978960652152697, "vf_explained_var": 0.0004692329093813896, "kl": 0.0013316690655604665, "entropy": 1.4169115122407674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0751205030099424, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990369511659814, "policy_loss": -0.0008760846150970017, "vf_loss": 9.986946832566034, "vf_explained_var": -0.0004038914170845476, "kl": 0.015095873803353657, "entropy": 1.3329366491585182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": -29.701195476899045, "episode_reward_min": -9464.151767119893, "episode_reward_mean": -4812.687779758129, "episode_len_mean": 165.69, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 16569, "policy_reward_min": {"agent_policy": 0.43774419208607357, "adversary_policy": -9464.151767119893}, "policy_reward_max": {"agent_policy": 7543.147675441121, "adversary_policy": -0.43774419208607357}, "policy_reward_mean": {"agent_policy": 2800.1353383000132, "adversary_policy": -3806.411559029071}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2565.534500682605, -6860.917121351637, -5506.301626994705, -1225.4064978493602, -3027.5190925171387, -8295.940670461125, -6579.573755062836, -3998.9277568194557, -5122.482405796655, -3613.363415987412, -5090.968091127723, -4336.274804162747, -2096.195449856396, -6596.362905970509, -7886.781427308905, -6503.045843055033, -6620.646088125022, -6915.208556159076, -1581.999567919056, -29.701195476899045, -8009.92514475111, -849.2542234769543, -4843.354008697416, -4543.412047480124, -4180.919580694886, -5126.133886749489, -4651.148422952362, -3559.179473907073, -4202.700562659327, -7209.049979614041, -7524.077458976911, -5052.339056714171, -2459.647801795428, -6057.520197165984, -7573.145885645801, -4102.474477496869, -6376.248235714018, -8259.785932758421, -33.94609014594478, -3072.7169981844972, -6221.386385991526, -2409.8223900075504, -3146.986950899025, -6885.8210738303505, -1633.1262786902137, -1365.4015267771067, -6968.147137784126, -9464.151767119893, -6361.3834189815125, -5723.536506941996, -2439.48579003064, -989.5735236078037, -4893.6571661777225, -6144.567496634296, -4671.1620913308225, -3656.8069470620753, -4182.996072428562, -1051.216623242422, -4235.293713847707, -3494.7158173063, -177.17536881087761, -4451.093514225952, -6595.264556965884, -6391.180528266286, -905.1230913067726, -4857.882012127404, -6818.717719066881, -6380.024868014954, -8282.346513604221, -4667.559432146302, -7243.6908031928315, -5132.330111876125, -4613.796776031979, -2480.1975453215255, -8638.810505252817, -5779.420842647246, -4582.476169750662, -4935.276478387249, -3145.82740819129, -5454.378444917871, -5411.805320956764, -6975.252001463283, -4006.7094806015602, -6659.340572301643, -4763.182170153047, -7048.014879805629, -7751.074481990393, -5741.563817255474, -6063.547593584308, -2471.462148893301, -3468.194348179445, -6084.687437216844, -3333.314396794021, -4721.845137931099, -6132.78754921536, -7114.052166486859, -3691.6518804881302, -4739.1418146022, -481.5927011087199, -4997.616469722858], "episode_lengths": [95, 200, 200, 76, 73, 200, 200, 141, 191, 157, 200, 200, 137, 200, 200, 200, 200, 200, 70, 1, 200, 45, 200, 200, 187, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 1, 144, 200, 124, 200, 166, 49, 42, 200, 200, 200, 200, 69, 70, 200, 200, 200, 129, 200, 27, 172, 105, 25, 173, 200, 200, 62, 186, 200, 200, 200, 141, 200, 184, 200, 170, 200, 146, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 133, 145, 200, 91, 200, 200, 200, 149, 193, 26, 200], "policy_agent_policy_reward": [697.2531252508442, 4137.809852347612, 3816.947529203428, 874.2398284265896, 439.5282513654693, 7543.147675441121, 2408.8838349728417, 2698.6273831025132, 2970.030437551391, 1173.097699982299, 4296.71539469056, 3509.914680102978, 1077.7994386650728, 4747.260296058833, 4374.592787675135, 3333.6426445314664, 2475.954848987118, 4233.685404204914, 974.507345948555, 0.43774419208607357, 5699.70794255276, 442.6967899619777, 2917.0928206160997, 1907.8657976044412, 2091.118153185576, 1271.5831118503895, 3840.338470224563, 1878.1463797180954, 2554.045973112808, 5361.045556368415, 3686.827448744337, 3341.2789622061528, 1216.974024734396, 4907.091024409199, 3178.7171987611405, 2568.500641284227, 1915.9354840685241, 5627.914770286589, 0.5435765623004514, 2259.6046202327857, 3456.184141413717, 2148.8624431315516, 2200.7225589980035, 3379.944079849667, 427.88962204724925, 496.1200649859445, 2898.4316138480654, 7143.58882388919, 2658.3748530012494, 3710.129421509287, 326.4937436716, 531.8307353194966, 3341.4808566067345, 5595.753715646073, 2745.417024892398, 1569.7084771353639, 3260.6291742835783, 81.6928022001039, 3325.8291771268377, 1137.5152387310372, 124.94669410318295, 1871.7319124134365, 3995.2682586560563, 3226.43628370079, 540.9822300185506, 4299.519877901983, 2974.732289673981, 4178.570458321317, 5026.986273057905, 1211.4984128479234, 5854.967262500072, 2202.9942963385884, 2087.425672547549, 1681.3615713469487, 6159.218677669129, 1946.605228562798, 2124.120964456677, 3218.2143919158643, 2551.3661573893323, 2659.840121844421, 4049.307100101432, 2025.3612394531385, 2364.4383070803888, 2730.661315909388, 2431.754798813334, 6260.161265933976, 6157.074590244626, 3799.2593575901756, 2204.466667939945, 1298.3753798541675, 1061.944489353728, 3543.6866359940564, 971.5932036606852, 3547.5064012037788, 5052.010097792604, 2321.8357874926714, 1456.9324857619426, 3474.36661903306, 145.48329830536355, 4292.824235743595], "policy_adversary_policy_reward": [-1034.0667158069916, -2228.720910126458, -4137.809852347612, -6860.917121351637, -3850.598654118533, -5472.650502079599, -930.3388490298013, -1169.3074772461484, -439.5282513654693, -3027.5190925171387, -7688.842795281289, -8150.245550620959, -2408.8838349728417, -6579.573755062837, -3800.701448555865, -2896.853691366103, -4980.530311417386, -3111.9825319306624, -1175.1296150914152, -3611.3315008782956, -4468.294073981227, -4919.389411837056, -3669.205223885137, -4176.984260380591, -1424.8216959706185, -1749.1731925508498, -5634.509099896113, -5709.114102133223, -7462.453611927721, -4798.920603056318, -6503.045843055031, -3333.6426445314664, -6441.706706333182, -2654.894230778947, -5001.114440710768, -6147.7795196532425, -1572.6634663855705, -983.8434474820407, -0.43774419208607357, -29.701195476899045, -6887.808595540642, -6821.824491763238, -849.2542234769543, -442.6967899619777, -3582.751180509601, -4177.695648803922, -1960.056537949886, -4491.221307134678, -4114.856573531616, -2157.181160348845, -1271.5831118503895, -5126.133886749489, -4042.9082390026483, -4448.578654174265, -3057.8742818617807, -2379.4515717633876, -4202.091285417366, -2554.65525035477, -7087.861048981021, -5482.2344870014385, -3687.12759708134, -7523.777310639907, -3482.7904272933033, -4910.827591627023, -2367.7114728238444, -1308.9103537059805, -5608.052837744249, -5356.558383830932, -3178.7171987611405, -7573.145885645802, -3947.1492602451062, -2723.825858535991, -1915.9354840685241, -6376.248235714018, -8259.785932758421, -5627.914770286589, -0.5435765623004514, -33.94609014594478, -2564.67673921977, -2767.644879197516, -3456.184141413717, -6221.386385991526, -2150.4063141908464, -2408.278518948255, -2987.3518589783985, -2360.35765091863, -6885.8210738303505, -3379.944079849667, -1633.1262786902134, -427.88962204724925, -1365.4015267771067, -496.1200649859445, -2898.4316138480654, -6968.147137784126, -9464.151767119893, -7143.58882388919, -4194.691325146326, -4825.066946836441, -5347.434056951769, -4086.231871499559, -326.4937436716, -2439.48579003064, -789.0655598509444, -732.3386990763584, -4893.657166177721, -3341.4808566067345, -5966.721811562181, -5773.599400718188, -4671.1620913308225, -2745.417024892398, -1569.7084771353639, -3656.8069470620753, -3260.931129101458, -4182.694117610682, -81.6928022001039, -1051.216623242422, -4189.071688707962, -3372.0512022665825, -1137.5152387310372, -3494.715817306301, -125.28128569694597, -176.84077721711458, -3403.6493658466334, -2919.176060792752, -3995.2682586560563, -6595.264556965884, -6391.180528266285, -3226.43628370079, -654.8113875255559, -791.2939337997672, -4363.473221609776, -4793.928668419611, -6818.717719066881, -2974.732289673981, -5718.618641745267, -4839.976684591002, -8282.346513604221, -5026.986273057905, -4667.559432146302, -1211.4984128479234, -6654.255650755656, -6444.402414937247, -3052.470712527566, -4282.85369568714, -3257.9817441845653, -3443.240704394967, -2422.588334065145, -1738.9707826033311, -8322.085500720392, -6475.943682201543, -5779.420842647245, -1946.605228562798, -3593.1187512045303, -3113.4783830028055, -4821.6442643607, -3331.8466059424104, -3143.940720738927, -2553.2528448416947, -5454.378444917871, -2659.840121844421, -4732.936046549422, -4728.176374508773, -6975.252001463283, -2025.3612394531385, -2536.9159654568907, -3834.231822225061, -2730.661315909388, -6659.340572301643, -2431.754798813334, -4763.182170153047, -6479.064193988735, -6829.11195175087, -7751.074481990393, -6157.074590244626, -5741.563817255472, -3799.2593575901756, -2216.1226188860587, -6051.891642638196, -1832.2403101181626, -1937.5972186293052, -3468.194348179444, -1061.944489353728, -6084.687437216843, -3543.6866359940564, -3333.314396794021, -971.5932036606852, -4028.945836525835, -4240.405702609041, -5951.76150712957, -5233.036139878391, -2321.8357874926714, -7114.0521664868575, -1872.1293425570857, -3276.45502369299, -3959.8208960806332, -4253.6875375546315, -145.48329830536355, -481.5927011087199, -4622.074617925868, -4668.366087540591]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39720359255422794, "mean_inference_ms": 0.9665082057424292, "mean_action_processing_ms": 0.16654691204675331, "mean_env_wait_ms": 0.05097946569285848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003302931785583496, "StateBufferConnector_ms": 0.002554774284362793, "ViewRequirementAgentConnector_ms": 0.06953132152557373}, "num_episodes": 23, "episode_return_max": -29.701195476899045, "episode_return_min": -9464.151767119893, "episode_return_mean": -4812.687779758129}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.6273450877975, "num_env_steps_trained_throughput_per_sec": 550.6273450877975, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 7447.923, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7447.89, "sample_time_ms": 826.123, "learn_time_ms": 6609.366, "learn_throughput": 605.202, "synch_weights_time_ms": 11.926}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 156, "trial_id": "3439d_00000", "date": "2024-08-09_15-45-53", "timestamp": 1723232753, "time_this_iter_s": 7.268412828445435, "time_total_s": 1163.7596335411072, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b315af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1163.7596335411072, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 29.563636363636366, "ram_util_percent": 82.14545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9474919480426858, "cur_kl_coeff": 1.1703555861382084, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.951473937431972, "policy_loss": -0.007296390944005301, "vf_loss": 9.954524957140286, "vf_explained_var": 7.5712800025939945e-06, "kl": 0.0036274313171209844, "entropy": 1.4135793340702851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.083513665388501, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.973127185983001, "policy_loss": -0.0011735606995268316, "vf_loss": 9.970780016883971, "vf_explained_var": -0.0014214119898579107, "kl": 0.012363511188418934, "entropy": 1.3075684216287402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "env_runners": {"episode_reward_max": -33.94609014594478, "episode_reward_min": -9464.151767119893, "episode_reward_mean": -4834.492581041871, "episode_len_mean": 169.7, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 16970, "policy_reward_min": {"agent_policy": 0.5435765623004514, "adversary_policy": -9464.151767119893}, "policy_reward_max": {"agent_policy": 7143.58882388919, "adversary_policy": -0.5435765623004514}, "policy_reward_mean": {"agent_policy": 2744.653662351046, "adversary_policy": -3789.5731216964587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4843.354008697416, -4543.412047480124, -4180.919580694886, -5126.133886749489, -4651.148422952362, -3559.179473907073, -4202.700562659327, -7209.049979614041, -7524.077458976911, -5052.339056714171, -2459.647801795428, -6057.520197165984, -7573.145885645801, -4102.474477496869, -6376.248235714018, -8259.785932758421, -33.94609014594478, -3072.7169981844972, -6221.386385991526, -2409.8223900075504, -3146.986950899025, -6885.8210738303505, -1633.1262786902137, -1365.4015267771067, -6968.147137784126, -9464.151767119893, -6361.3834189815125, -5723.536506941996, -2439.48579003064, -989.5735236078037, -4893.6571661777225, -6144.567496634296, -4671.1620913308225, -3656.8069470620753, -4182.996072428562, -1051.216623242422, -4235.293713847707, -3494.7158173063, -177.17536881087761, -4451.093514225952, -6595.264556965884, -6391.180528266286, -905.1230913067726, -4857.882012127404, -6818.717719066881, -6380.024868014954, -8282.346513604221, -4667.559432146302, -7243.6908031928315, -5132.330111876125, -4613.796776031979, -2480.1975453215255, -8638.810505252817, -5779.420842647246, -4582.476169750662, -4935.276478387249, -3145.82740819129, -5454.378444917871, -5411.805320956764, -6975.252001463283, -4006.7094806015602, -6659.340572301643, -4763.182170153047, -7048.014879805629, -7751.074481990393, -5741.563817255474, -6063.547593584308, -2471.462148893301, -3468.194348179445, -6084.687437216844, -3333.314396794021, -4721.845137931099, -6132.78754921536, -7114.052166486859, -3691.6518804881302, -4739.1418146022, -481.5927011087199, -4997.616469722858, -3697.0148705567826, -2804.892489701931, -4213.037603132005, -6505.382853140971, -6416.436743104474, -8941.235655376984, -4668.180346555734, -5162.8454163872175, -4306.663038885404, -5231.628470988344, -4024.015570731376, -5348.857215641721, -1617.2954399149983, -1822.1408971417143, -5606.377195632001, -3078.975211273593, -5054.112180969733, -4073.477406385292, -4903.980867331034, -5205.70237344876, -3939.5169785397557, -8871.041444446784], "episode_lengths": [200, 200, 187, 200, 200, 200, 200, 200, 200, 200, 102, 200, 200, 200, 200, 200, 1, 144, 200, 124, 200, 166, 49, 42, 200, 200, 200, 200, 69, 70, 200, 200, 200, 129, 200, 27, 172, 105, 25, 173, 200, 200, 62, 186, 200, 200, 200, 141, 200, 184, 200, 170, 200, 146, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 133, 145, 200, 91, 200, 200, 200, 149, 193, 26, 200, 200, 87, 127, 200, 200, 194, 200, 200, 170, 200, 133, 178, 86, 83, 200, 129, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2917.0928206160997, 1907.8657976044412, 2091.118153185576, 1271.5831118503895, 3840.338470224563, 1878.1463797180954, 2554.045973112808, 5361.045556368415, 3686.827448744337, 3341.2789622061528, 1216.974024734396, 4907.091024409199, 3178.7171987611405, 2568.500641284227, 1915.9354840685241, 5627.914770286589, 0.5435765623004514, 2259.6046202327857, 3456.184141413717, 2148.8624431315516, 2200.7225589980035, 3379.944079849667, 427.88962204724925, 496.1200649859445, 2898.4316138480654, 7143.58882388919, 2658.3748530012494, 3710.129421509287, 326.4937436716, 531.8307353194966, 3341.4808566067345, 5595.753715646073, 2745.417024892398, 1569.7084771353639, 3260.6291742835783, 81.6928022001039, 3325.8291771268377, 1137.5152387310372, 124.94669410318295, 1871.7319124134365, 3995.2682586560563, 3226.43628370079, 540.9822300185506, 4299.519877901983, 2974.732289673981, 4178.570458321317, 5026.986273057905, 1211.4984128479234, 5854.967262500072, 2202.9942963385884, 2087.425672547549, 1681.3615713469487, 6159.218677669129, 1946.605228562798, 2124.120964456677, 3218.2143919158643, 2551.3661573893323, 2659.840121844421, 4049.307100101432, 2025.3612394531385, 2364.4383070803888, 2730.661315909388, 2431.754798813334, 6260.161265933976, 6157.074590244626, 3799.2593575901756, 2204.466667939945, 1298.3753798541675, 1061.944489353728, 3543.6866359940564, 971.5932036606852, 3547.5064012037788, 5052.010097792604, 2321.8357874926714, 1456.9324857619426, 3474.36661903306, 145.48329830536355, 4292.824235743595, 1782.1559242648414, 1181.1798758689224, 2013.226458216811, 4925.400627153298, 1463.0310821374007, 3915.0512129989343, 4322.7403904859275, 3903.6455763519702, 2634.2683441820814, 3159.0521145436646, 1730.0912330650824, 2200.6901018613326, 809.9107514972709, 679.9536060863064, 4187.418612369168, 918.5599299485075, 2984.96700334023, 2295.354044562752, 1336.0947728358037, 4297.19380572728, 2294.4590146120645, 3343.868858209235], "policy_adversary_policy_reward": [-3582.751180509601, -4177.695648803922, -1960.056537949886, -4491.221307134678, -4114.856573531616, -2157.181160348845, -1271.5831118503895, -5126.133886749489, -4042.9082390026483, -4448.578654174265, -3057.8742818617807, -2379.4515717633876, -4202.091285417366, -2554.65525035477, -7087.861048981021, -5482.2344870014385, -3687.12759708134, -7523.777310639907, -3482.7904272933033, -4910.827591627023, -2367.7114728238444, -1308.9103537059805, -5608.052837744249, -5356.558383830932, -3178.7171987611405, -7573.145885645802, -3947.1492602451062, -2723.825858535991, -1915.9354840685241, -6376.248235714018, -8259.785932758421, -5627.914770286589, -0.5435765623004514, -33.94609014594478, -2564.67673921977, -2767.644879197516, -3456.184141413717, -6221.386385991526, -2150.4063141908464, -2408.278518948255, -2987.3518589783985, -2360.35765091863, -6885.8210738303505, -3379.944079849667, -1633.1262786902134, -427.88962204724925, -1365.4015267771067, -496.1200649859445, -2898.4316138480654, -6968.147137784126, -9464.151767119893, -7143.58882388919, -4194.691325146326, -4825.066946836441, -5347.434056951769, -4086.231871499559, -326.4937436716, -2439.48579003064, -789.0655598509444, -732.3386990763584, -4893.657166177721, -3341.4808566067345, -5966.721811562181, -5773.599400718188, -4671.1620913308225, -2745.417024892398, -1569.7084771353639, -3656.8069470620753, -3260.931129101458, -4182.694117610682, -81.6928022001039, -1051.216623242422, -4189.071688707962, -3372.0512022665825, -1137.5152387310372, -3494.715817306301, -125.28128569694597, -176.84077721711458, -3403.6493658466334, -2919.176060792752, -3995.2682586560563, -6595.264556965884, -6391.180528266285, -3226.43628370079, -654.8113875255559, -791.2939337997672, -4363.473221609776, -4793.928668419611, -6818.717719066881, -2974.732289673981, -5718.618641745267, -4839.976684591002, -8282.346513604221, -5026.986273057905, -4667.559432146302, -1211.4984128479234, -6654.255650755656, -6444.402414937247, -3052.470712527566, -4282.85369568714, -3257.9817441845653, -3443.240704394967, -2422.588334065145, -1738.9707826033311, -8322.085500720392, -6475.943682201543, -5779.420842647245, -1946.605228562798, -3593.1187512045303, -3113.4783830028055, -4821.6442643607, -3331.8466059424104, -3143.940720738927, -2553.2528448416947, -5454.378444917871, -2659.840121844421, -4732.936046549422, -4728.176374508773, -6975.252001463283, -2025.3612394531385, -2536.9159654568907, -3834.231822225061, -2730.661315909388, -6659.340572301643, -2431.754798813334, -4763.182170153047, -6479.064193988735, -6829.11195175087, -7751.074481990393, -6157.074590244626, -5741.563817255472, -3799.2593575901756, -2216.1226188860587, -6051.891642638196, -1832.2403101181626, -1937.5972186293052, -3468.194348179444, -1061.944489353728, -6084.687437216843, -3543.6866359940564, -3333.314396794021, -971.5932036606852, -4028.945836525835, -4240.405702609041, -5951.76150712957, -5233.036139878391, -2321.8357874926714, -7114.0521664868575, -1872.1293425570857, -3276.45502369299, -3959.8208960806332, -4253.6875375546315, -145.48329830536355, -481.5927011087199, -4622.074617925868, -4668.366087540591, -2482.2223573154693, -2996.9484375061534, -1181.1798758689224, -2804.892489701931, -4212.583162500135, -2013.680898848682, -6505.38285314097, -4925.400627153298, -1463.0310821374007, -6416.436743104474, -4013.2411763622913, -8843.045692013628, -4628.1257323800255, -4362.795004661636, -5125.963754138757, -3940.5272386004303, -4305.256300426666, -2635.67508264082, -4725.153400484601, -3665.527185047404, -4024.0155707313766, -1730.0912330650824, -5348.857215641721, -2200.6901018613326, -1617.2954399149983, -809.9107514972709, -679.9536060863064, -1822.1408971417143, -5596.67609924434, -4197.11970875683, -918.5599299485075, -3078.975211273593, -3888.448127227115, -4150.6310570828455, -2477.725330799651, -3891.1061201483926, -4903.980867331034, -1336.0947728358037, -5194.784791154374, -4308.111388021665, -3939.5169785397557, -2294.4590146120645, -3343.868858209235, -8871.041444446784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39715690194630116, "mean_inference_ms": 0.9641115730489099, "mean_action_processing_ms": 0.16650626607041472, "mean_env_wait_ms": 0.05099167397522545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033693313598632812, "StateBufferConnector_ms": 0.0025014877319335938, "ViewRequirementAgentConnector_ms": 0.06804370880126953}, "num_episodes": 22, "episode_return_max": -33.94609014594478, "episode_return_min": -9464.151767119893, "episode_return_mean": -4834.492581041871}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.8935858581784, "num_env_steps_trained_throughput_per_sec": 534.8935858581784, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1884000, "timers": {"training_iteration_time_ms": 7462.466, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7462.433, "sample_time_ms": 836.407, "learn_time_ms": 6613.946, "learn_throughput": 604.783, "synch_weights_time_ms": 11.603}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "done": false, "training_iteration": 157, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-01", "timestamp": 1723232761, "time_this_iter_s": 7.48374605178833, "time_total_s": 1171.2433795928955, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3218790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1171.2433795928955, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 28.580000000000002, "ram_util_percent": 81.93}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9506945565963785, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98294924000899, "policy_loss": -0.00028917075105709954, "vf_loss": 9.978729085127513, "vf_explained_var": 0.00016981512308120728, "kl": 0.007705895452575836, "entropy": 1.4415272327760855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0497549405646702, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988896344704603, "policy_loss": 0.00024885268421183344, "vf_loss": 9.985245772265884, "vf_explained_var": -0.00013286651126922123, "kl": 0.011945724575509312, "entropy": 1.2862280860779778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": -177.17536881087761, "episode_reward_min": -9464.151767119893, "episode_reward_mean": -5017.403004608891, "episode_len_mean": 171.49, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 17149, "policy_reward_min": {"agent_policy": 81.6928022001039, "adversary_policy": -9464.151767119893}, "policy_reward_max": {"agent_policy": 7343.620806026655, "adversary_policy": -81.6928022001039}, "policy_reward_mean": {"agent_policy": 2966.261813986219, "adversary_policy": -3991.832409297554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9464.151767119893, -6361.3834189815125, -5723.536506941996, -2439.48579003064, -989.5735236078037, -4893.6571661777225, -6144.567496634296, -4671.1620913308225, -3656.8069470620753, -4182.996072428562, -1051.216623242422, -4235.293713847707, -3494.7158173063, -177.17536881087761, -4451.093514225952, -6595.264556965884, -6391.180528266286, -905.1230913067726, -4857.882012127404, -6818.717719066881, -6380.024868014954, -8282.346513604221, -4667.559432146302, -7243.6908031928315, -5132.330111876125, -4613.796776031979, -2480.1975453215255, -8638.810505252817, -5779.420842647246, -4582.476169750662, -4935.276478387249, -3145.82740819129, -5454.378444917871, -5411.805320956764, -6975.252001463283, -4006.7094806015602, -6659.340572301643, -4763.182170153047, -7048.014879805629, -7751.074481990393, -5741.563817255474, -6063.547593584308, -2471.462148893301, -3468.194348179445, -6084.687437216844, -3333.314396794021, -4721.845137931099, -6132.78754921536, -7114.052166486859, -3691.6518804881302, -4739.1418146022, -481.5927011087199, -4997.616469722858, -3697.0148705567826, -2804.892489701931, -4213.037603132005, -6505.382853140971, -6416.436743104474, -8941.235655376984, -4668.180346555734, -5162.8454163872175, -4306.663038885404, -5231.628470988344, -4024.015570731376, -5348.857215641721, -1617.2954399149983, -1822.1408971417143, -5606.377195632001, -3078.975211273593, -5054.112180969733, -4073.477406385292, -4903.980867331034, -5205.70237344876, -3939.5169785397557, -8871.041444446784, -6550.839817507735, -7697.013784368587, -8977.974540224739, -1823.052116994077, -5524.278335008487, -3871.4619001341284, -6163.903736964253, -6802.9771454383, -7027.836088241364, -7936.626267348835, -6004.698967801395, -4462.699299684907, -1319.05946284136, -1387.7733892568565, -8132.869647163893, -3826.054578550167, -2748.44969672886, -5682.434942651747, -4221.041243868679, -6334.874122714649, -8293.75357362622, -5649.928008323375, -5387.327102367297, -4394.584886817292, -5528.021543407415], "episode_lengths": [200, 200, 200, 69, 70, 200, 200, 200, 129, 200, 27, 172, 105, 25, 173, 200, 200, 62, 186, 200, 200, 200, 141, 200, 184, 200, 170, 200, 146, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 133, 145, 200, 91, 200, 200, 200, 149, 193, 26, 200, 200, 87, 127, 200, 200, 194, 200, 200, 170, 200, 133, 178, 86, 83, 200, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 48, 200, 175, 200, 200, 200, 200, 200, 149, 36, 82, 200, 200, 144, 200, 173, 200, 200, 200, 200, 187, 200], "policy_agent_policy_reward": [7143.58882388919, 2658.3748530012494, 3710.129421509287, 326.4937436716, 531.8307353194966, 3341.4808566067345, 5595.753715646073, 2745.417024892398, 1569.7084771353639, 3260.6291742835783, 81.6928022001039, 3325.8291771268377, 1137.5152387310372, 124.94669410318295, 1871.7319124134365, 3995.2682586560563, 3226.43628370079, 540.9822300185506, 4299.519877901983, 2974.732289673981, 4178.570458321317, 5026.986273057905, 1211.4984128479234, 5854.967262500072, 2202.9942963385884, 2087.425672547549, 1681.3615713469487, 6159.218677669129, 1946.605228562798, 2124.120964456677, 3218.2143919158643, 2551.3661573893323, 2659.840121844421, 4049.307100101432, 2025.3612394531385, 2364.4383070803888, 2730.661315909388, 2431.754798813334, 6260.161265933976, 6157.074590244626, 3799.2593575901756, 2204.466667939945, 1298.3753798541675, 1061.944489353728, 3543.6866359940564, 971.5932036606852, 3547.5064012037788, 5052.010097792604, 2321.8357874926714, 1456.9324857619426, 3474.36661903306, 145.48329830536355, 4292.824235743595, 1782.1559242648414, 1181.1798758689224, 2013.226458216811, 4925.400627153298, 1463.0310821374007, 3915.0512129989343, 4322.7403904859275, 3903.6455763519702, 2634.2683441820814, 3159.0521145436646, 1730.0912330650824, 2200.6901018613326, 809.9107514972709, 679.9536060863064, 4187.418612369168, 918.5599299485075, 2984.96700334023, 2295.354044562752, 1336.0947728358037, 4297.19380572728, 2294.4590146120645, 3343.868858209235, 4658.041241672719, 7343.620806026655, 5800.456819547095, 269.00441274072193, 2619.7870604763425, 1902.2099151817965, 3988.8970971849562, 5122.787319255364, 5672.937593360574, 6759.521842087116, 1830.1354293012937, 1556.0473503362684, 239.8100602159759, 535.1879480616451, 3389.0661156484784, 3026.2125097635076, 2371.7141803883533, 3784.0935120798517, 1720.7674929445511, 3528.5629937352305, 5174.900107072101, 5133.769168096643, 3589.671132224644, 3256.523030676443, 4419.86856368304], "policy_adversary_policy_reward": [-9464.151767119893, -7143.58882388919, -4194.691325146326, -4825.066946836441, -5347.434056951769, -4086.231871499559, -326.4937436716, -2439.48579003064, -789.0655598509444, -732.3386990763584, -4893.657166177721, -3341.4808566067345, -5966.721811562181, -5773.599400718188, -4671.1620913308225, -2745.417024892398, -1569.7084771353639, -3656.8069470620753, -3260.931129101458, -4182.694117610682, -81.6928022001039, -1051.216623242422, -4189.071688707962, -3372.0512022665825, -1137.5152387310372, -3494.715817306301, -125.28128569694597, -176.84077721711458, -3403.6493658466334, -2919.176060792752, -3995.2682586560563, -6595.264556965884, -6391.180528266285, -3226.43628370079, -654.8113875255559, -791.2939337997672, -4363.473221609776, -4793.928668419611, -6818.717719066881, -2974.732289673981, -5718.618641745267, -4839.976684591002, -8282.346513604221, -5026.986273057905, -4667.559432146302, -1211.4984128479234, -6654.255650755656, -6444.402414937247, -3052.470712527566, -4282.85369568714, -3257.9817441845653, -3443.240704394967, -2422.588334065145, -1738.9707826033311, -8322.085500720392, -6475.943682201543, -5779.420842647245, -1946.605228562798, -3593.1187512045303, -3113.4783830028055, -4821.6442643607, -3331.8466059424104, -3143.940720738927, -2553.2528448416947, -5454.378444917871, -2659.840121844421, -4732.936046549422, -4728.176374508773, -6975.252001463283, -2025.3612394531385, -2536.9159654568907, -3834.231822225061, -2730.661315909388, -6659.340572301643, -2431.754798813334, -4763.182170153047, -6479.064193988735, -6829.11195175087, -7751.074481990393, -6157.074590244626, -5741.563817255472, -3799.2593575901756, -2216.1226188860587, -6051.891642638196, -1832.2403101181626, -1937.5972186293052, -3468.194348179444, -1061.944489353728, -6084.687437216843, -3543.6866359940564, -3333.314396794021, -971.5932036606852, -4028.945836525835, -4240.405702609041, -5951.76150712957, -5233.036139878391, -2321.8357874926714, -7114.0521664868575, -1872.1293425570857, -3276.45502369299, -3959.8208960806332, -4253.6875375546315, -145.48329830536355, -481.5927011087199, -4622.074617925868, -4668.366087540591, -2482.2223573154693, -2996.9484375061534, -1181.1798758689224, -2804.892489701931, -4212.583162500135, -2013.680898848682, -6505.38285314097, -4925.400627153298, -1463.0310821374007, -6416.436743104474, -4013.2411763622913, -8843.045692013628, -4628.1257323800255, -4362.795004661636, -5125.963754138757, -3940.5272386004303, -4305.256300426666, -2635.67508264082, -4725.153400484601, -3665.527185047404, -4024.0155707313766, -1730.0912330650824, -5348.857215641721, -2200.6901018613326, -1617.2954399149983, -809.9107514972709, -679.9536060863064, -1822.1408971417143, -5596.67609924434, -4197.11970875683, -918.5599299485075, -3078.975211273593, -3888.448127227115, -4150.6310570828455, -2477.725330799651, -3891.1061201483926, -4903.980867331034, -1336.0947728358037, -5194.784791154374, -4308.111388021665, -3939.5169785397557, -2294.4590146120645, -3343.868858209235, -8871.041444446784, -6550.839817507735, -4658.041241672719, -7646.535962420316, -7394.098627974927, -8977.974540224735, -5800.456819547095, -1823.052116994077, -269.00441274072193, -5524.278335008486, -2619.7870604763425, -2079.5477070370716, -3694.1241082788533, -6109.523251316117, -4043.2775828330905, -5148.273610466678, -6777.490854226986, -5782.947461568871, -6917.826220033067, -7880.328089719666, -6815.820019716283, -6004.698967801395, -1830.1354293012937, -4462.699299684907, -1556.0473503362684, -1319.0594628413598, -239.8100602159759, -535.1879480616451, -1387.7733892568565, -3389.0661156484784, -8132.869647163893, -3140.8847319048605, -3711.3823564088148, -2559.147742519773, -2561.01613459744, -4432.223341464447, -5034.305113267143, -4221.041243868678, -1720.7674929445511, -6334.874122714648, -3528.5629937352305, -5176.063914883611, -8292.58976581471, -5381.387590140104, -5402.309586279913, -3589.671132224644, -5387.327102367297, -4377.907036291733, -3273.2008812020035, -5528.0215434074125, -4419.86856368304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3970520904400643, "mean_inference_ms": 0.9632373408699497, "mean_action_processing_ms": 0.16643942842021445, "mean_env_wait_ms": 0.05097663573226284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034780502319335938, "StateBufferConnector_ms": 0.002314329147338867, "ViewRequirementAgentConnector_ms": 0.06594550609588623}, "num_episodes": 25, "episode_return_max": -177.17536881087761, "episode_return_min": -9464.151767119893, "episode_return_mean": -5017.403004608891}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.6110718887894, "num_env_steps_trained_throughput_per_sec": 551.6110718887894, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 7463.27, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7463.238, "sample_time_ms": 832.828, "learn_time_ms": 6618.466, "learn_throughput": 604.37, "synch_weights_time_ms": 11.477}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 158, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-08", "timestamp": 1723232768, "time_this_iter_s": 7.255361795425415, "time_total_s": 1178.498741388321, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3218af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1178.498741388321, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 24.400000000000002, "ram_util_percent": 81.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.044517840600262, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.971247411767642, "policy_loss": -0.004040619068352195, "vf_loss": 9.969201991955439, "vf_explained_var": -2.791701505581538e-05, "kl": 0.010400340300111565, "entropy": 1.468961566189925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0358348451909565, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.977577806402136, "policy_loss": -0.003882935182832024, "vf_loss": 9.978830741196083, "vf_explained_var": -0.00031933172669990984, "kl": 0.009235645276026199, "entropy": 1.2636995395655355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "env_runners": {"episode_reward_max": -481.5927011087199, "episode_reward_min": -10253.704527181344, "episode_reward_mean": -5328.113555078895, "episode_len_mean": 175.76, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 17576, "policy_reward_min": {"agent_policy": 145.48329830536355, "adversary_policy": -10253.704527181344}, "policy_reward_max": {"agent_policy": 7552.892185580097, "adversary_policy": -145.48329830536355}, "policy_reward_mean": {"agent_policy": 3077.8960660689418, "adversary_policy": -4203.004810573919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8282.346513604221, -4667.559432146302, -7243.6908031928315, -5132.330111876125, -4613.796776031979, -2480.1975453215255, -8638.810505252817, -5779.420842647246, -4582.476169750662, -4935.276478387249, -3145.82740819129, -5454.378444917871, -5411.805320956764, -6975.252001463283, -4006.7094806015602, -6659.340572301643, -4763.182170153047, -7048.014879805629, -7751.074481990393, -5741.563817255474, -6063.547593584308, -2471.462148893301, -3468.194348179445, -6084.687437216844, -3333.314396794021, -4721.845137931099, -6132.78754921536, -7114.052166486859, -3691.6518804881302, -4739.1418146022, -481.5927011087199, -4997.616469722858, -3697.0148705567826, -2804.892489701931, -4213.037603132005, -6505.382853140971, -6416.436743104474, -8941.235655376984, -4668.180346555734, -5162.8454163872175, -4306.663038885404, -5231.628470988344, -4024.015570731376, -5348.857215641721, -1617.2954399149983, -1822.1408971417143, -5606.377195632001, -3078.975211273593, -5054.112180969733, -4073.477406385292, -4903.980867331034, -5205.70237344876, -3939.5169785397557, -8871.041444446784, -6550.839817507735, -7697.013784368587, -8977.974540224739, -1823.052116994077, -5524.278335008487, -3871.4619001341284, -6163.903736964253, -6802.9771454383, -7027.836088241364, -7936.626267348835, -6004.698967801395, -4462.699299684907, -1319.05946284136, -1387.7733892568565, -8132.869647163893, -3826.054578550167, -2748.44969672886, -5682.434942651747, -4221.041243868679, -6334.874122714649, -8293.75357362622, -5649.928008323375, -5387.327102367297, -4394.584886817292, -5528.021543407415, -8293.39287343935, -2924.810115376192, -9749.290058368702, -5674.3405664235115, -5628.608631561414, -1383.7135845181, -4557.7936778355, -6342.164397368982, -2867.0607403184076, -8565.79546191355, -5501.065774293098, -5877.5715507437835, -2806.8864241204897, -5846.934190492391, -10253.704527181344, -5883.822803135028, -5841.653035630802, -7892.505231108283, -4518.906347393999, -7572.681268273115, -6973.36238100123], "episode_lengths": [200, 141, 200, 184, 200, 170, 200, 146, 200, 200, 200, 200, 200, 172, 200, 200, 200, 200, 200, 200, 200, 133, 145, 200, 91, 200, 200, 200, 149, 193, 26, 200, 200, 87, 127, 200, 200, 194, 200, 200, 170, 200, 133, 178, 86, 83, 200, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 48, 200, 175, 200, 200, 200, 200, 200, 149, 36, 82, 200, 200, 144, 200, 173, 200, 200, 200, 200, 187, 200, 200, 68, 200, 125, 200, 86, 200, 200, 100, 200, 200, 114, 164, 200, 200, 200, 200, 200, 188, 200, 200], "policy_agent_policy_reward": [5026.986273057905, 1211.4984128479234, 5854.967262500072, 2202.9942963385884, 2087.425672547549, 1681.3615713469487, 6159.218677669129, 1946.605228562798, 2124.120964456677, 3218.2143919158643, 2551.3661573893323, 2659.840121844421, 4049.307100101432, 2025.3612394531385, 2364.4383070803888, 2730.661315909388, 2431.754798813334, 6260.161265933976, 6157.074590244626, 3799.2593575901756, 2204.466667939945, 1298.3753798541675, 1061.944489353728, 3543.6866359940564, 971.5932036606852, 3547.5064012037788, 5052.010097792604, 2321.8357874926714, 1456.9324857619426, 3474.36661903306, 145.48329830536355, 4292.824235743595, 1782.1559242648414, 1181.1798758689224, 2013.226458216811, 4925.400627153298, 1463.0310821374007, 3915.0512129989343, 4322.7403904859275, 3903.6455763519702, 2634.2683441820814, 3159.0521145436646, 1730.0912330650824, 2200.6901018613326, 809.9107514972709, 679.9536060863064, 4187.418612369168, 918.5599299485075, 2984.96700334023, 2295.354044562752, 1336.0947728358037, 4297.19380572728, 2294.4590146120645, 3343.868858209235, 4658.041241672719, 7343.620806026655, 5800.456819547095, 269.00441274072193, 2619.7870604763425, 1902.2099151817965, 3988.8970971849562, 5122.787319255364, 5672.937593360574, 6759.521842087116, 1830.1354293012937, 1556.0473503362684, 239.8100602159759, 535.1879480616451, 3389.0661156484784, 3026.2125097635076, 2371.7141803883533, 3784.0935120798517, 1720.7674929445511, 3528.5629937352305, 5174.900107072101, 5133.769168096643, 3589.671132224644, 3256.523030676443, 4419.86856368304, 4992.172121486771, 421.5737435911135, 7552.892185580097, 707.7150659822241, 2969.325460204608, 702.7917574415565, 3785.3361592304786, 2010.7928866490495, 1333.2277840133045, 4991.075395401152, 4184.200280309216, 1365.8730483677068, 2469.138044624935, 4363.372461615991, 6811.392144241838, 2933.2391023188575, 1897.751991621493, 4649.612757724233, 1779.8630875760405, 5275.5580096707745, 2607.153769423197], "policy_adversary_policy_reward": [-8282.346513604221, -5026.986273057905, -4667.559432146302, -1211.4984128479234, -6654.255650755656, -6444.402414937247, -3052.470712527566, -4282.85369568714, -3257.9817441845653, -3443.240704394967, -2422.588334065145, -1738.9707826033311, -8322.085500720392, -6475.943682201543, -5779.420842647245, -1946.605228562798, -3593.1187512045303, -3113.4783830028055, -4821.6442643607, -3331.8466059424104, -3143.940720738927, -2553.2528448416947, -5454.378444917871, -2659.840121844421, -4732.936046549422, -4728.176374508773, -6975.252001463283, -2025.3612394531385, -2536.9159654568907, -3834.231822225061, -2730.661315909388, -6659.340572301643, -2431.754798813334, -4763.182170153047, -6479.064193988735, -6829.11195175087, -7751.074481990393, -6157.074590244626, -5741.563817255472, -3799.2593575901756, -2216.1226188860587, -6051.891642638196, -1832.2403101181626, -1937.5972186293052, -3468.194348179444, -1061.944489353728, -6084.687437216843, -3543.6866359940564, -3333.314396794021, -971.5932036606852, -4028.945836525835, -4240.405702609041, -5951.76150712957, -5233.036139878391, -2321.8357874926714, -7114.0521664868575, -1872.1293425570857, -3276.45502369299, -3959.8208960806332, -4253.6875375546315, -145.48329830536355, -481.5927011087199, -4622.074617925868, -4668.366087540591, -2482.2223573154693, -2996.9484375061534, -1181.1798758689224, -2804.892489701931, -4212.583162500135, -2013.680898848682, -6505.38285314097, -4925.400627153298, -1463.0310821374007, -6416.436743104474, -4013.2411763622913, -8843.045692013628, -4628.1257323800255, -4362.795004661636, -5125.963754138757, -3940.5272386004303, -4305.256300426666, -2635.67508264082, -4725.153400484601, -3665.527185047404, -4024.0155707313766, -1730.0912330650824, -5348.857215641721, -2200.6901018613326, -1617.2954399149983, -809.9107514972709, -679.9536060863064, -1822.1408971417143, -5596.67609924434, -4197.11970875683, -918.5599299485075, -3078.975211273593, -3888.448127227115, -4150.6310570828455, -2477.725330799651, -3891.1061201483926, -4903.980867331034, -1336.0947728358037, -5194.784791154374, -4308.111388021665, -3939.5169785397557, -2294.4590146120645, -3343.868858209235, -8871.041444446784, -6550.839817507735, -4658.041241672719, -7646.535962420316, -7394.098627974927, -8977.974540224735, -5800.456819547095, -1823.052116994077, -269.00441274072193, -5524.278335008486, -2619.7870604763425, -2079.5477070370716, -3694.1241082788533, -6109.523251316117, -4043.2775828330905, -5148.273610466678, -6777.490854226986, -5782.947461568871, -6917.826220033067, -7880.328089719666, -6815.820019716283, -6004.698967801395, -1830.1354293012937, -4462.699299684907, -1556.0473503362684, -1319.0594628413598, -239.8100602159759, -535.1879480616451, -1387.7733892568565, -3389.0661156484784, -8132.869647163893, -3140.8847319048605, -3711.3823564088148, -2559.147742519773, -2561.01613459744, -4432.223341464447, -5034.305113267143, -4221.041243868678, -1720.7674929445511, -6334.874122714648, -3528.5629937352305, -5176.063914883611, -8292.58976581471, -5381.387590140104, -5402.309586279913, -3589.671132224644, -5387.327102367297, -4377.907036291733, -3273.2008812020035, -5528.0215434074125, -4419.86856368304, -8293.39287343935, -4992.172121486771, -2924.810115376192, -421.5737435911135, -9749.2900583687, -7552.892185580097, -707.7150659822241, -5674.3405664235115, -2969.550953328972, -5628.38313843705, -956.8707487986144, -1129.6345931610417, -3895.808037908414, -4447.321799157565, -2010.7928866490495, -6342.164397368982, -1333.2277840133045, -2867.0607403184076, -8565.79546191355, -4991.075395401152, -5494.649128109366, -4190.6169264929495, -1365.8730483677068, -5877.5715507437835, -2684.2763616714387, -2591.748107073986, -5846.934190492392, -4363.372461615991, -10253.704527181344, -6811.392144241838, -2934.479580824926, -5882.58232462896, -5841.6530356308, -1897.751991621493, -7892.505231108282, -4649.612757724233, -4518.906347393998, -1779.8630875760405, -7572.681268273116, -5275.5580096707745, -2607.153769423197, -6973.36238100123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39692187056348954, "mean_inference_ms": 0.963907279069369, "mean_action_processing_ms": 0.16652053563643288, "mean_env_wait_ms": 0.05100923553262393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034922361373901367, "StateBufferConnector_ms": 0.0023425817489624023, "ViewRequirementAgentConnector_ms": 0.06332945823669434}, "num_episodes": 21, "episode_return_max": -481.5927011087199, "episode_return_min": -10253.704527181344, "episode_return_mean": -5328.113555078895}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.7500500137554, "num_env_steps_trained_throughput_per_sec": 542.7500500137554, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1908000, "timers": {"training_iteration_time_ms": 7407.231, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7407.199, "sample_time_ms": 815.322, "learn_time_ms": 6580.044, "learn_throughput": 607.899, "synch_weights_time_ms": 11.366}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "done": false, "training_iteration": 159, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-16", "timestamp": 1723232776, "time_this_iter_s": 7.374510049819946, "time_total_s": 1185.8732514381409, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3218e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1185.8732514381409, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 24.37272727272727, "ram_util_percent": 81.72727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9857779949903488, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993434156974157, "policy_loss": -0.001537461382880186, "vf_loss": 9.98964991370837, "vf_explained_var": -0.0006558720022439956, "kl": 0.009094122103609456, "entropy": 1.4628860497226317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0049822463244988, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996325110379981, "policy_loss": -0.002416297981377553, "vf_loss": 9.995660459427606, "vf_explained_var": 0.00035090383398469794, "kl": 0.01081918299730335, "entropy": 1.2680161756182473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": -481.5927011087199, "episode_reward_min": -10253.704527181344, "episode_reward_mean": -5394.538654098616, "episode_len_mean": 175.23, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17523, "policy_reward_min": {"agent_policy": 145.48329830536355, "adversary_policy": -10253.704527181344}, "policy_reward_max": {"agent_policy": 7991.304131409352, "adversary_policy": -145.48329830536355}, "policy_reward_mean": {"agent_policy": 3173.960552685874, "adversary_policy": -4284.249603392244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3468.194348179445, -6084.687437216844, -3333.314396794021, -4721.845137931099, -6132.78754921536, -7114.052166486859, -3691.6518804881302, -4739.1418146022, -481.5927011087199, -4997.616469722858, -3697.0148705567826, -2804.892489701931, -4213.037603132005, -6505.382853140971, -6416.436743104474, -8941.235655376984, -4668.180346555734, -5162.8454163872175, -4306.663038885404, -5231.628470988344, -4024.015570731376, -5348.857215641721, -1617.2954399149983, -1822.1408971417143, -5606.377195632001, -3078.975211273593, -5054.112180969733, -4073.477406385292, -4903.980867331034, -5205.70237344876, -3939.5169785397557, -8871.041444446784, -6550.839817507735, -7697.013784368587, -8977.974540224739, -1823.052116994077, -5524.278335008487, -3871.4619001341284, -6163.903736964253, -6802.9771454383, -7027.836088241364, -7936.626267348835, -6004.698967801395, -4462.699299684907, -1319.05946284136, -1387.7733892568565, -8132.869647163893, -3826.054578550167, -2748.44969672886, -5682.434942651747, -4221.041243868679, -6334.874122714649, -8293.75357362622, -5649.928008323375, -5387.327102367297, -4394.584886817292, -5528.021543407415, -8293.39287343935, -2924.810115376192, -9749.290058368702, -5674.3405664235115, -5628.608631561414, -1383.7135845181, -4557.7936778355, -6342.164397368982, -2867.0607403184076, -8565.79546191355, -5501.065774293098, -5877.5715507437835, -2806.8864241204897, -5846.934190492391, -10253.704527181344, -5883.822803135028, -5841.653035630802, -7892.505231108283, -4518.906347393999, -7572.681268273115, -6973.36238100123, -6536.472121811145, -2240.9618896663455, -3339.3100843232946, -3225.3368848501063, -8291.139828531068, -5452.1297095401005, -8383.021247749886, -6408.543748998115, -9004.482611564119, -9120.190454536576, -6815.19585899011, -6355.400302545913, -6411.643513379321, -4260.028427120059, -8714.140360615174, -2020.7118885012133, -6076.135992506722, -4414.152598966438, -4401.172883993629, -5651.411110529975, -4765.18411803619, -6603.807763542047], "episode_lengths": [145, 200, 91, 200, 200, 200, 149, 193, 26, 200, 200, 87, 127, 200, 200, 194, 200, 200, 170, 200, 133, 178, 86, 83, 200, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 48, 200, 175, 200, 200, 200, 200, 200, 149, 36, 82, 200, 200, 144, 200, 173, 200, 200, 200, 200, 187, 200, 200, 68, 200, 125, 200, 86, 200, 200, 100, 200, 200, 114, 164, 200, 200, 200, 200, 200, 188, 200, 200, 200, 50, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1061.944489353728, 3543.6866359940564, 971.5932036606852, 3547.5064012037788, 5052.010097792604, 2321.8357874926714, 1456.9324857619426, 3474.36661903306, 145.48329830536355, 4292.824235743595, 1782.1559242648414, 1181.1798758689224, 2013.226458216811, 4925.400627153298, 1463.0310821374007, 3915.0512129989343, 4322.7403904859275, 3903.6455763519702, 2634.2683441820814, 3159.0521145436646, 1730.0912330650824, 2200.6901018613326, 809.9107514972709, 679.9536060863064, 4187.418612369168, 918.5599299485075, 2984.96700334023, 2295.354044562752, 1336.0947728358037, 4297.19380572728, 2294.4590146120645, 3343.868858209235, 4658.041241672719, 7343.620806026655, 5800.456819547095, 269.00441274072193, 2619.7870604763425, 1902.2099151817965, 3988.8970971849562, 5122.787319255364, 5672.937593360574, 6759.521842087116, 1830.1354293012937, 1556.0473503362684, 239.8100602159759, 535.1879480616451, 3389.0661156484784, 3026.2125097635076, 2371.7141803883533, 3784.0935120798517, 1720.7674929445511, 3528.5629937352305, 5174.900107072101, 5133.769168096643, 3589.671132224644, 3256.523030676443, 4419.86856368304, 4992.172121486771, 421.5737435911135, 7552.892185580097, 707.7150659822241, 2969.325460204608, 702.7917574415565, 3785.3361592304786, 2010.7928866490495, 1333.2277840133045, 4991.075395401152, 4184.200280309216, 1365.8730483677068, 2469.138044624935, 4363.372461615991, 6811.392144241838, 2933.2391023188575, 1897.751991621493, 4649.612757724233, 1779.8630875760405, 5275.5580096707745, 2607.153769423197, 3677.027085126949, 357.99581560839675, 401.208343290382, 2181.4045399526262, 4551.646885411033, 1915.8277426689242, 4304.620625687933, 4298.071381425753, 5443.69438013001, 6668.650744065924, 3190.9668548497734, 5573.599523997706, 5647.1483063882, 2026.2100765363894, 7991.304131409352, 770.1179784338431, 5448.944275198283, 3880.0155983861387, 1578.2602281926565, 2659.880092566081, 4215.744550918673, 2869.5685548459987], "policy_adversary_policy_reward": [-3468.194348179444, -1061.944489353728, -6084.687437216843, -3543.6866359940564, -3333.314396794021, -971.5932036606852, -4028.945836525835, -4240.405702609041, -5951.76150712957, -5233.036139878391, -2321.8357874926714, -7114.0521664868575, -1872.1293425570857, -3276.45502369299, -3959.8208960806332, -4253.6875375546315, -145.48329830536355, -481.5927011087199, -4622.074617925868, -4668.366087540591, -2482.2223573154693, -2996.9484375061534, -1181.1798758689224, -2804.892489701931, -4212.583162500135, -2013.680898848682, -6505.38285314097, -4925.400627153298, -1463.0310821374007, -6416.436743104474, -4013.2411763622913, -8843.045692013628, -4628.1257323800255, -4362.795004661636, -5125.963754138757, -3940.5272386004303, -4305.256300426666, -2635.67508264082, -4725.153400484601, -3665.527185047404, -4024.0155707313766, -1730.0912330650824, -5348.857215641721, -2200.6901018613326, -1617.2954399149983, -809.9107514972709, -679.9536060863064, -1822.1408971417143, -5596.67609924434, -4197.11970875683, -918.5599299485075, -3078.975211273593, -3888.448127227115, -4150.6310570828455, -2477.725330799651, -3891.1061201483926, -4903.980867331034, -1336.0947728358037, -5194.784791154374, -4308.111388021665, -3939.5169785397557, -2294.4590146120645, -3343.868858209235, -8871.041444446784, -6550.839817507735, -4658.041241672719, -7646.535962420316, -7394.098627974927, -8977.974540224735, -5800.456819547095, -1823.052116994077, -269.00441274072193, -5524.278335008486, -2619.7870604763425, -2079.5477070370716, -3694.1241082788533, -6109.523251316117, -4043.2775828330905, -5148.273610466678, -6777.490854226986, -5782.947461568871, -6917.826220033067, -7880.328089719666, -6815.820019716283, -6004.698967801395, -1830.1354293012937, -4462.699299684907, -1556.0473503362684, -1319.0594628413598, -239.8100602159759, -535.1879480616451, -1387.7733892568565, -3389.0661156484784, -8132.869647163893, -3140.8847319048605, -3711.3823564088148, -2559.147742519773, -2561.01613459744, -4432.223341464447, -5034.305113267143, -4221.041243868678, -1720.7674929445511, -6334.874122714648, -3528.5629937352305, -5176.063914883611, -8292.58976581471, -5381.387590140104, -5402.309586279913, -3589.671132224644, -5387.327102367297, -4377.907036291733, -3273.2008812020035, -5528.0215434074125, -4419.86856368304, -8293.39287343935, -4992.172121486771, -2924.810115376192, -421.5737435911135, -9749.2900583687, -7552.892185580097, -707.7150659822241, -5674.3405664235115, -2969.550953328972, -5628.38313843705, -956.8707487986144, -1129.6345931610417, -3895.808037908414, -4447.321799157565, -2010.7928866490495, -6342.164397368982, -1333.2277840133045, -2867.0607403184076, -8565.79546191355, -4991.075395401152, -5494.649128109366, -4190.6169264929495, -1365.8730483677068, -5877.5715507437835, -2684.2763616714387, -2591.748107073986, -5846.934190492392, -4363.372461615991, -10253.704527181344, -6811.392144241838, -2934.479580824926, -5882.58232462896, -5841.6530356308, -1897.751991621493, -7892.505231108282, -4649.612757724233, -4518.906347393998, -1779.8630875760405, -7572.681268273116, -5275.5580096707745, -2607.153769423197, -6973.36238100123, -6536.472121811146, -3677.027085126949, -2240.961889666346, -357.99581560839675, -3339.3100843232946, -401.208343290382, -3204.674833199251, -2202.066591603481, -8250.96036645543, -4591.826347486671, -5452.1297095401, -1915.8277426689242, -4304.620625687933, -8383.021247749886, -5619.189789366486, -5087.425341057381, -5443.69438013001, -9004.482611564119, -6674.273575272035, -9114.567623330466, -3190.9668548497734, -6815.19585899011, -5596.828884847801, -6332.170941695817, -6401.295953430257, -5657.495866337264, -2026.724646238637, -4259.513857417812, -8030.566219147059, -8674.878272877468, -1113.327385974703, -1677.5024809603547, -6023.729622278978, -5501.350645426027, -3898.4043944542045, -4395.763802898375, -1596.8077629068378, -4382.625349279439, -2659.880092566081, -5651.411110529975, -4219.606719484187, -4761.321949470675, -2869.5685548459987, -6603.807763542047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39680601144747757, "mean_inference_ms": 0.9635307204908399, "mean_action_processing_ms": 0.16650544029056552, "mean_env_wait_ms": 0.05100846080519627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003503084182739258, "StateBufferConnector_ms": 0.0023446083068847656, "ViewRequirementAgentConnector_ms": 0.06303095817565918}, "num_episodes": 22, "episode_return_max": -481.5927011087199, "episode_return_min": -10253.704527181344, "episode_return_mean": -5394.538654098616}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.3001906750192, "num_env_steps_trained_throughput_per_sec": 516.3001906750192, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 7415.944, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7415.913, "sample_time_ms": 769.727, "learn_time_ms": 6634.317, "learn_throughput": 602.926, "synch_weights_time_ms": 11.425}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 160, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-24", "timestamp": 1723232784, "time_this_iter_s": 7.762283086776733, "time_total_s": 1193.6355345249176, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3223dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1193.6355345249176, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 31.44545454545454, "ram_util_percent": 82.24545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0695772057709594, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97829311688741, "policy_loss": -0.0025726198703826717, "vf_loss": 9.976508325338363, "vf_explained_var": -0.0005938987558086713, "kl": 0.0074462807421999365, "entropy": 1.4673272016147771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.032469380832223, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.986221166136403, "policy_loss": -0.001491239647967396, "vf_loss": 9.984723339383564, "vf_explained_var": 0.0005011009476172231, "kl": 0.010496634593302454, "entropy": 1.2590322625069392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "env_runners": {"episode_reward_max": -143.12193023479955, "episode_reward_min": -10253.704527181344, "episode_reward_mean": -5513.483223684049, "episode_len_mean": 177.87, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 17787, "policy_reward_min": {"agent_policy": 19.53882684573915, "adversary_policy": -10253.704527181344}, "policy_reward_max": {"agent_policy": 7991.304131409352, "adversary_policy": -19.53882684573915}, "policy_reward_mean": {"agent_policy": 3339.202803448389, "adversary_policy": -4426.343013566218}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1822.1408971417143, -5606.377195632001, -3078.975211273593, -5054.112180969733, -4073.477406385292, -4903.980867331034, -5205.70237344876, -3939.5169785397557, -8871.041444446784, -6550.839817507735, -7697.013784368587, -8977.974540224739, -1823.052116994077, -5524.278335008487, -3871.4619001341284, -6163.903736964253, -6802.9771454383, -7027.836088241364, -7936.626267348835, -6004.698967801395, -4462.699299684907, -1319.05946284136, -1387.7733892568565, -8132.869647163893, -3826.054578550167, -2748.44969672886, -5682.434942651747, -4221.041243868679, -6334.874122714649, -8293.75357362622, -5649.928008323375, -5387.327102367297, -4394.584886817292, -5528.021543407415, -8293.39287343935, -2924.810115376192, -9749.290058368702, -5674.3405664235115, -5628.608631561414, -1383.7135845181, -4557.7936778355, -6342.164397368982, -2867.0607403184076, -8565.79546191355, -5501.065774293098, -5877.5715507437835, -2806.8864241204897, -5846.934190492391, -10253.704527181344, -5883.822803135028, -5841.653035630802, -7892.505231108283, -4518.906347393999, -7572.681268273115, -6973.36238100123, -6536.472121811145, -2240.9618896663455, -3339.3100843232946, -3225.3368848501063, -8291.139828531068, -5452.1297095401005, -8383.021247749886, -6408.543748998115, -9004.482611564119, -9120.190454536576, -6815.19585899011, -6355.400302545913, -6411.643513379321, -4260.028427120059, -8714.140360615174, -2020.7118885012133, -6076.135992506722, -4414.152598966438, -4401.172883993629, -5651.411110529975, -4765.18411803619, -6603.807763542047, -6928.5757955569, -2711.2841250922525, -2856.5352809548763, -5795.931634998478, -6401.534199033272, -4038.2089350060783, -5249.125089208376, -3849.172722370811, -8453.271801535891, -8237.196157866667, -7667.448534355732, -5794.801585689792, -6242.200976168517, -3396.0403160818023, -3578.043229051173, -8107.636383982855, -143.12193023479955, -8411.293636401042, -2520.6629656459413, -5755.311866205025, -3482.7307882856826, -1905.1346544757062, -8071.563966205159], "episode_lengths": [83, 200, 129, 200, 200, 200, 200, 200, 200, 200, 200, 200, 48, 200, 175, 200, 200, 200, 200, 200, 149, 36, 82, 200, 200, 144, 200, 173, 200, 200, 200, 200, 187, 200, 200, 68, 200, 125, 200, 86, 200, 200, 100, 200, 200, 114, 164, 200, 200, 200, 200, 200, 188, 200, 200, 200, 50, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 153, 134, 200, 200, 200, 200, 200, 200, 200, 91, 200, 7, 200, 139, 200, 200, 119, 200], "policy_agent_policy_reward": [679.9536060863064, 4187.418612369168, 918.5599299485075, 2984.96700334023, 2295.354044562752, 1336.0947728358037, 4297.19380572728, 2294.4590146120645, 3343.868858209235, 4658.041241672719, 7343.620806026655, 5800.456819547095, 269.00441274072193, 2619.7870604763425, 1902.2099151817965, 3988.8970971849562, 5122.787319255364, 5672.937593360574, 6759.521842087116, 1830.1354293012937, 1556.0473503362684, 239.8100602159759, 535.1879480616451, 3389.0661156484784, 3026.2125097635076, 2371.7141803883533, 3784.0935120798517, 1720.7674929445511, 3528.5629937352305, 5174.900107072101, 5133.769168096643, 3589.671132224644, 3256.523030676443, 4419.86856368304, 4992.172121486771, 421.5737435911135, 7552.892185580097, 707.7150659822241, 2969.325460204608, 702.7917574415565, 3785.3361592304786, 2010.7928866490495, 1333.2277840133045, 4991.075395401152, 4184.200280309216, 1365.8730483677068, 2469.138044624935, 4363.372461615991, 6811.392144241838, 2933.2391023188575, 1897.751991621493, 4649.612757724233, 1779.8630875760405, 5275.5580096707745, 2607.153769423197, 3677.027085126949, 357.99581560839675, 401.208343290382, 2181.4045399526262, 4551.646885411033, 1915.8277426689242, 4304.620625687933, 4298.071381425753, 5443.69438013001, 6668.650744065924, 3190.9668548497734, 5573.599523997706, 5647.1483063882, 2026.2100765363894, 7991.304131409352, 770.1179784338431, 5448.944275198283, 3880.0155983861387, 1578.2602281926565, 2659.880092566081, 4215.744550918673, 2869.5685548459987, 6254.392079175301, 1862.8962644469577, 2113.729890124813, 4374.567092303764, 4805.697940206874, 1044.6194559673024, 753.4579456250166, 2502.392374896909, 4115.1354300949115, 5417.3358301359685, 7056.065459492703, 2731.4379191909156, 5208.421622148693, 1310.1756859091186, 789.159778293904, 7227.419097619293, 19.53882684573915, 7117.570753830092, 1485.8077407705985, 3228.6968593881693, 2177.4568318960437, 1345.0100823906187, 3491.8670624668152], "policy_adversary_policy_reward": [-679.9536060863064, -1822.1408971417143, -5596.67609924434, -4197.11970875683, -918.5599299485075, -3078.975211273593, -3888.448127227115, -4150.6310570828455, -2477.725330799651, -3891.1061201483926, -4903.980867331034, -1336.0947728358037, -5194.784791154374, -4308.111388021665, -3939.5169785397557, -2294.4590146120645, -3343.868858209235, -8871.041444446784, -6550.839817507735, -4658.041241672719, -7646.535962420316, -7394.098627974927, -8977.974540224735, -5800.456819547095, -1823.052116994077, -269.00441274072193, -5524.278335008486, -2619.7870604763425, -2079.5477070370716, -3694.1241082788533, -6109.523251316117, -4043.2775828330905, -5148.273610466678, -6777.490854226986, -5782.947461568871, -6917.826220033067, -7880.328089719666, -6815.820019716283, -6004.698967801395, -1830.1354293012937, -4462.699299684907, -1556.0473503362684, -1319.0594628413598, -239.8100602159759, -535.1879480616451, -1387.7733892568565, -3389.0661156484784, -8132.869647163893, -3140.8847319048605, -3711.3823564088148, -2559.147742519773, -2561.01613459744, -4432.223341464447, -5034.305113267143, -4221.041243868678, -1720.7674929445511, -6334.874122714648, -3528.5629937352305, -5176.063914883611, -8292.58976581471, -5381.387590140104, -5402.309586279913, -3589.671132224644, -5387.327102367297, -4377.907036291733, -3273.2008812020035, -5528.0215434074125, -4419.86856368304, -8293.39287343935, -4992.172121486771, -2924.810115376192, -421.5737435911135, -9749.2900583687, -7552.892185580097, -707.7150659822241, -5674.3405664235115, -2969.550953328972, -5628.38313843705, -956.8707487986144, -1129.6345931610417, -3895.808037908414, -4447.321799157565, -2010.7928866490495, -6342.164397368982, -1333.2277840133045, -2867.0607403184076, -8565.79546191355, -4991.075395401152, -5494.649128109366, -4190.6169264929495, -1365.8730483677068, -5877.5715507437835, -2684.2763616714387, -2591.748107073986, -5846.934190492392, -4363.372461615991, -10253.704527181344, -6811.392144241838, -2934.479580824926, -5882.58232462896, -5841.6530356308, -1897.751991621493, -7892.505231108282, -4649.612757724233, -4518.906347393998, -1779.8630875760405, -7572.681268273116, -5275.5580096707745, -2607.153769423197, -6973.36238100123, -6536.472121811146, -3677.027085126949, -2240.961889666346, -357.99581560839675, -3339.3100843232946, -401.208343290382, -3204.674833199251, -2202.066591603481, -8250.96036645543, -4591.826347486671, -5452.1297095401, -1915.8277426689242, -4304.620625687933, -8383.021247749886, -5619.189789366486, -5087.425341057381, -5443.69438013001, -9004.482611564119, -6674.273575272035, -9114.567623330466, -3190.9668548497734, -6815.19585899011, -5596.828884847801, -6332.170941695817, -6401.295953430257, -5657.495866337264, -2026.724646238637, -4259.513857417812, -8030.566219147059, -8674.878272877468, -1113.327385974703, -1677.5024809603547, -6023.729622278978, -5501.350645426027, -3898.4043944542045, -4395.763802898375, -1596.8077629068378, -4382.625349279439, -2659.880092566081, -5651.411110529975, -4219.606719484187, -4761.321949470675, -2869.5685548459987, -6603.807763542047, -6255.771937551164, -6927.195937181036, -1936.4401867391439, -2637.740202800069, -2539.216752232377, -2431.0484188473124, -5779.434403835748, -4391.064323466492, -5573.936658590922, -5633.29548064923, -4038.2089350060783, -1044.6194559673024, -5249.125089208377, -753.4579456250166, -3849.1727223708112, -2502.392374896909, -8453.271801535891, -4115.1354300949115, -5417.3358301359685, -8237.196157866667, -7138.43686399261, -7585.0771298558275, -5794.405069691546, -2731.8344351891606, -5718.651743319089, -5731.970854998117, -3396.0403160818028, -1310.1756859091186, -789.159778293904, -3578.043229051173, -7618.50124604773, -7716.554235554417, -19.53882684573915, -143.12193023479955, -7202.6060071106995, -8326.258383120432, -1525.0589922629028, -2481.4117141536376, -3566.1571349521582, -5417.851590641039, -3261.324762482525, -2398.8628576992037, -1903.416025485127, -1346.728711381198, -3491.8670624668152, -8071.563966205159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3968245391107583, "mean_inference_ms": 0.9650052562855106, "mean_action_processing_ms": 0.1665861059743604, "mean_env_wait_ms": 0.050991418275946325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035636425018310547, "StateBufferConnector_ms": 0.0025173425674438477, "ViewRequirementAgentConnector_ms": 0.06510043144226074}, "num_episodes": 23, "episode_return_max": -143.12193023479955, "episode_return_min": -10253.704527181344, "episode_return_mean": -5513.483223684049}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.3761918415771, "num_env_steps_trained_throughput_per_sec": 532.3761918415771, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 7363.048, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7363.016, "sample_time_ms": 774.971, "learn_time_ms": 6576.374, "learn_throughput": 608.238, "synch_weights_time_ms": 11.178}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "training_iteration": 161, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-31", "timestamp": 1723232791, "time_this_iter_s": 7.51789402961731, "time_total_s": 1201.153428554535, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32224c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1201.153428554535, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 27.718181818181815, "ram_util_percent": 82.59090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0469317516622445, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983822553356488, "policy_loss": -0.007471037224361984, "vf_loss": 9.986017230153085, "vf_explained_var": 0.0002797035500407219, "kl": 0.0090166868447947, "entropy": 1.486183337122202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0313627693703566, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988526992192345, "policy_loss": -0.0062700051846347315, "vf_loss": 9.991374575902546, "vf_explained_var": 0.00019364744897872683, "kl": 0.01201836193404185, "entropy": 1.2891489363852002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": -143.12193023479955, "episode_reward_min": -10538.645934552284, "episode_reward_mean": -5612.082453861896, "episode_len_mean": 181.35, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18135, "policy_reward_min": {"agent_policy": 19.53882684573915, "adversary_policy": -10538.645934552287}, "policy_reward_max": {"agent_policy": 7991.304131409352, "adversary_policy": -19.53882684573915}, "policy_reward_mean": {"agent_policy": 3419.2340174283613, "adversary_policy": -4515.658235645129}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1319.05946284136, -1387.7733892568565, -8132.869647163893, -3826.054578550167, -2748.44969672886, -5682.434942651747, -4221.041243868679, -6334.874122714649, -8293.75357362622, -5649.928008323375, -5387.327102367297, -4394.584886817292, -5528.021543407415, -8293.39287343935, -2924.810115376192, -9749.290058368702, -5674.3405664235115, -5628.608631561414, -1383.7135845181, -4557.7936778355, -6342.164397368982, -2867.0607403184076, -8565.79546191355, -5501.065774293098, -5877.5715507437835, -2806.8864241204897, -5846.934190492391, -10253.704527181344, -5883.822803135028, -5841.653035630802, -7892.505231108283, -4518.906347393999, -7572.681268273115, -6973.36238100123, -6536.472121811145, -2240.9618896663455, -3339.3100843232946, -3225.3368848501063, -8291.139828531068, -5452.1297095401005, -8383.021247749886, -6408.543748998115, -9004.482611564119, -9120.190454536576, -6815.19585899011, -6355.400302545913, -6411.643513379321, -4260.028427120059, -8714.140360615174, -2020.7118885012133, -6076.135992506722, -4414.152598966438, -4401.172883993629, -5651.411110529975, -4765.18411803619, -6603.807763542047, -6928.5757955569, -2711.2841250922525, -2856.5352809548763, -5795.931634998478, -6401.534199033272, -4038.2089350060783, -5249.125089208376, -3849.172722370811, -8453.271801535891, -8237.196157866667, -7667.448534355732, -5794.801585689792, -6242.200976168517, -3396.0403160818023, -3578.043229051173, -8107.636383982855, -143.12193023479955, -8411.293636401042, -2520.6629656459413, -5755.311866205025, -3482.7307882856826, -1905.1346544757062, -8071.563966205159, -7786.796435333688, -5329.464236762291, -3946.901587462683, -7976.279064105892, -7058.055353218018, -5512.91069407494, -5909.47315514777, -5989.153415626501, -4973.072514773425, -6096.682413451102, -7310.057038635456, -3799.6341671754476, -7484.3032383573445, -4905.013254409716, -2651.5445303100996, -4946.077147444867, -6012.306187463162, -6282.011692810017, -4641.199060246751, -10538.645934552284, -6109.028451308833], "episode_lengths": [36, 82, 200, 200, 144, 200, 173, 200, 200, 200, 200, 187, 200, 200, 68, 200, 125, 200, 86, 200, 200, 100, 200, 200, 114, 164, 200, 200, 200, 200, 200, 188, 200, 200, 200, 50, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 153, 134, 200, 200, 200, 200, 200, 200, 200, 91, 200, 7, 200, 139, 200, 200, 119, 200, 200, 200, 199, 190, 200, 200, 200, 188, 200, 200, 200, 162, 200, 200, 200, 193, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [239.8100602159759, 535.1879480616451, 3389.0661156484784, 3026.2125097635076, 2371.7141803883533, 3784.0935120798517, 1720.7674929445511, 3528.5629937352305, 5174.900107072101, 5133.769168096643, 3589.671132224644, 3256.523030676443, 4419.86856368304, 4992.172121486771, 421.5737435911135, 7552.892185580097, 707.7150659822241, 2969.325460204608, 702.7917574415565, 3785.3361592304786, 2010.7928866490495, 1333.2277840133045, 4991.075395401152, 4184.200280309216, 1365.8730483677068, 2469.138044624935, 4363.372461615991, 6811.392144241838, 2933.2391023188575, 1897.751991621493, 4649.612757724233, 1779.8630875760405, 5275.5580096707745, 2607.153769423197, 3677.027085126949, 357.99581560839675, 401.208343290382, 2181.4045399526262, 4551.646885411033, 1915.8277426689242, 4304.620625687933, 4298.071381425753, 5443.69438013001, 6668.650744065924, 3190.9668548497734, 5573.599523997706, 5647.1483063882, 2026.2100765363894, 7991.304131409352, 770.1179784338431, 5448.944275198283, 3880.0155983861387, 1578.2602281926565, 2659.880092566081, 4215.744550918673, 2869.5685548459987, 6254.392079175301, 1862.8962644469577, 2113.729890124813, 4374.567092303764, 4805.697940206874, 1044.6194559673024, 753.4579456250166, 2502.392374896909, 4115.1354300949115, 5417.3358301359685, 7056.065459492703, 2731.4379191909156, 5208.421622148693, 1310.1756859091186, 789.159778293904, 7227.419097619293, 19.53882684573915, 7117.570753830092, 1485.8077407705985, 3228.6968593881693, 2177.4568318960437, 1345.0100823906187, 3491.8670624668152, 5521.387868826222, 2855.64894337589, 2700.429940120007, 3710.869048279476, 5717.252627237534, 4270.613267515004, 4278.020108299713, 1644.9633425074505, 3975.003622634372, 4382.933237841744, 4459.343733118381, 1514.4505086390695, 7061.978043865392, 1792.2593139645053, 2042.823733342349, 2350.1367559090854, 4468.793191890081, 5227.677339484398, 3691.5418941230587, 3908.3323186465454, 2289.9790932391534], "policy_adversary_policy_reward": [-1319.0594628413598, -239.8100602159759, -535.1879480616451, -1387.7733892568565, -3389.0661156484784, -8132.869647163893, -3140.8847319048605, -3711.3823564088148, -2559.147742519773, -2561.01613459744, -4432.223341464447, -5034.305113267143, -4221.041243868678, -1720.7674929445511, -6334.874122714648, -3528.5629937352305, -5176.063914883611, -8292.58976581471, -5381.387590140104, -5402.309586279913, -3589.671132224644, -5387.327102367297, -4377.907036291733, -3273.2008812020035, -5528.0215434074125, -4419.86856368304, -8293.39287343935, -4992.172121486771, -2924.810115376192, -421.5737435911135, -9749.2900583687, -7552.892185580097, -707.7150659822241, -5674.3405664235115, -2969.550953328972, -5628.38313843705, -956.8707487986144, -1129.6345931610417, -3895.808037908414, -4447.321799157565, -2010.7928866490495, -6342.164397368982, -1333.2277840133045, -2867.0607403184076, -8565.79546191355, -4991.075395401152, -5494.649128109366, -4190.6169264929495, -1365.8730483677068, -5877.5715507437835, -2684.2763616714387, -2591.748107073986, -5846.934190492392, -4363.372461615991, -10253.704527181344, -6811.392144241838, -2934.479580824926, -5882.58232462896, -5841.6530356308, -1897.751991621493, -7892.505231108282, -4649.612757724233, -4518.906347393998, -1779.8630875760405, -7572.681268273116, -5275.5580096707745, -2607.153769423197, -6973.36238100123, -6536.472121811146, -3677.027085126949, -2240.961889666346, -357.99581560839675, -3339.3100843232946, -401.208343290382, -3204.674833199251, -2202.066591603481, -8250.96036645543, -4591.826347486671, -5452.1297095401, -1915.8277426689242, -4304.620625687933, -8383.021247749886, -5619.189789366486, -5087.425341057381, -5443.69438013001, -9004.482611564119, -6674.273575272035, -9114.567623330466, -3190.9668548497734, -6815.19585899011, -5596.828884847801, -6332.170941695817, -6401.295953430257, -5657.495866337264, -2026.724646238637, -4259.513857417812, -8030.566219147059, -8674.878272877468, -1113.327385974703, -1677.5024809603547, -6023.729622278978, -5501.350645426027, -3898.4043944542045, -4395.763802898375, -1596.8077629068378, -4382.625349279439, -2659.880092566081, -5651.411110529975, -4219.606719484187, -4761.321949470675, -2869.5685548459987, -6603.807763542047, -6255.771937551164, -6927.195937181036, -1936.4401867391439, -2637.740202800069, -2539.216752232377, -2431.0484188473124, -5779.434403835748, -4391.064323466492, -5573.936658590922, -5633.29548064923, -4038.2089350060783, -1044.6194559673024, -5249.125089208377, -753.4579456250166, -3849.1727223708112, -2502.392374896909, -8453.271801535891, -4115.1354300949115, -5417.3358301359685, -8237.196157866667, -7138.43686399261, -7585.0771298558275, -5794.405069691546, -2731.8344351891606, -5718.651743319089, -5731.970854998117, -3396.0403160818028, -1310.1756859091186, -789.159778293904, -3578.043229051173, -7618.50124604773, -7716.554235554417, -19.53882684573915, -143.12193023479955, -7202.6060071106995, -8326.258383120432, -1525.0589922629028, -2481.4117141536376, -3566.1571349521582, -5417.851590641039, -3261.324762482525, -2398.8628576992037, -1903.416025485127, -1346.728711381198, -3491.8670624668152, -8071.563966205159, -7786.796435333689, -5521.387868826222, -4921.029226518188, -3264.0839536199996, -2700.825845935123, -3946.505681647567, -3710.869048279476, -7976.279064105892, -6926.039015223473, -5849.268965232081, -5509.462428727884, -4274.061532862059, -5909.473155147769, -4278.020108299713, -1644.9633425074505, -5989.153415626501, -3976.2907498924205, -4971.785387515377, -5603.599931377942, -4876.0157199149035, -7308.521212615657, -4460.879559138182, -3799.634167175447, -1514.4505086390695, -7299.746132865989, -7246.535149356747, -1820.4420714880068, -4876.830496886216, -2634.7955054052222, -2059.5727582472255, -2350.1367559090854, -4946.077147444867, -5961.106759338949, -4519.992620014295, -6272.185986041424, -5237.503046252993, -4352.008227885587, -3980.7327264842165, -10538.645934552287, -3908.3323186465454, -2289.9790932391534, -6109.028451308833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39686129835251405, "mean_inference_ms": 0.9651741377755515, "mean_action_processing_ms": 0.16661681173673892, "mean_env_wait_ms": 0.050994906028679184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034339427947998047, "StateBufferConnector_ms": 0.0024853944778442383, "ViewRequirementAgentConnector_ms": 0.06530165672302246}, "num_episodes": 21, "episode_return_max": -143.12193023479955, "episode_return_min": -10538.645934552284, "episode_return_mean": -5612.082453861896}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.359148947423, "num_env_steps_trained_throughput_per_sec": 557.359148947423, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 7362.598, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7362.566, "sample_time_ms": 778.078, "learn_time_ms": 6572.881, "learn_throughput": 608.561, "synch_weights_time_ms": 11.118}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 162, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-39", "timestamp": 1723232799, "time_this_iter_s": 7.181550025939941, "time_total_s": 1208.3349785804749, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3222550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1208.3349785804749, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 26.43, "ram_util_percent": 82.27000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0282231045886874, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991800996661187, "policy_loss": -0.008168057538568974, "vf_loss": 9.99358404080073, "vf_explained_var": 0.0005543612564603488, "kl": 0.01091122412472032, "entropy": 1.4895784373084704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0194595824789119, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001119659060524, "policy_loss": 0.0010207290975524793, "vf_loss": 9.996780394498634, "vf_explained_var": 0.0006270172419371428, "kl": 0.011653598704961715, "entropy": 1.2412009480769042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "env_runners": {"episode_reward_max": -143.12193023479955, "episode_reward_min": -11555.176119819042, "episode_reward_mean": -5684.720857282535, "episode_len_mean": 185.27, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 18527, "policy_reward_min": {"agent_policy": 19.53882684573915, "adversary_policy": -11555.176119819042}, "policy_reward_max": {"agent_policy": 9153.99271905297, "adversary_policy": -19.53882684573915}, "policy_reward_mean": {"agent_policy": 3446.0398652031827, "adversary_policy": -4565.380361242857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1383.7135845181, -4557.7936778355, -6342.164397368982, -2867.0607403184076, -8565.79546191355, -5501.065774293098, -5877.5715507437835, -2806.8864241204897, -5846.934190492391, -10253.704527181344, -5883.822803135028, -5841.653035630802, -7892.505231108283, -4518.906347393999, -7572.681268273115, -6973.36238100123, -6536.472121811145, -2240.9618896663455, -3339.3100843232946, -3225.3368848501063, -8291.139828531068, -5452.1297095401005, -8383.021247749886, -6408.543748998115, -9004.482611564119, -9120.190454536576, -6815.19585899011, -6355.400302545913, -6411.643513379321, -4260.028427120059, -8714.140360615174, -2020.7118885012133, -6076.135992506722, -4414.152598966438, -4401.172883993629, -5651.411110529975, -4765.18411803619, -6603.807763542047, -6928.5757955569, -2711.2841250922525, -2856.5352809548763, -5795.931634998478, -6401.534199033272, -4038.2089350060783, -5249.125089208376, -3849.172722370811, -8453.271801535891, -8237.196157866667, -7667.448534355732, -5794.801585689792, -6242.200976168517, -3396.0403160818023, -3578.043229051173, -8107.636383982855, -143.12193023479955, -8411.293636401042, -2520.6629656459413, -5755.311866205025, -3482.7307882856826, -1905.1346544757062, -8071.563966205159, -7786.796435333688, -5329.464236762291, -3946.901587462683, -7976.279064105892, -7058.055353218018, -5512.91069407494, -5909.47315514777, -5989.153415626501, -4973.072514773425, -6096.682413451102, -7310.057038635456, -3799.6341671754476, -7484.3032383573445, -4905.013254409716, -2651.5445303100996, -4946.077147444867, -6012.306187463162, -6282.011692810017, -4641.199060246751, -10538.645934552284, -6109.028451308833, -2646.957028568632, -3818.9246403745947, -6857.591491268508, -2900.9689733942687, -6419.502417350147, -4638.60650276558, -5215.806068860981, -6594.798242309853, -6959.932830081424, -5778.622296690311, -8260.332090934453, -11555.176119819042, -2764.871128750031, -2534.87922679028, -8540.01914865435, -7600.8479304407665, -4235.547060228394, -5117.071588269066], "episode_lengths": [86, 200, 200, 100, 200, 200, 114, 164, 200, 200, 200, 200, 200, 188, 200, 200, 200, 50, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 153, 134, 200, 200, 200, 200, 200, 200, 200, 91, 200, 7, 200, 139, 200, 200, 119, 200, 200, 200, 199, 190, 200, 200, 200, 188, 200, 200, 200, 162, 200, 200, 200, 193, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 137, 200, 200, 200, 200], "policy_agent_policy_reward": [702.7917574415565, 3785.3361592304786, 2010.7928866490495, 1333.2277840133045, 4991.075395401152, 4184.200280309216, 1365.8730483677068, 2469.138044624935, 4363.372461615991, 6811.392144241838, 2933.2391023188575, 1897.751991621493, 4649.612757724233, 1779.8630875760405, 5275.5580096707745, 2607.153769423197, 3677.027085126949, 357.99581560839675, 401.208343290382, 2181.4045399526262, 4551.646885411033, 1915.8277426689242, 4304.620625687933, 4298.071381425753, 5443.69438013001, 6668.650744065924, 3190.9668548497734, 5573.599523997706, 5647.1483063882, 2026.2100765363894, 7991.304131409352, 770.1179784338431, 5448.944275198283, 3880.0155983861387, 1578.2602281926565, 2659.880092566081, 4215.744550918673, 2869.5685548459987, 6254.392079175301, 1862.8962644469577, 2113.729890124813, 4374.567092303764, 4805.697940206874, 1044.6194559673024, 753.4579456250166, 2502.392374896909, 4115.1354300949115, 5417.3358301359685, 7056.065459492703, 2731.4379191909156, 5208.421622148693, 1310.1756859091186, 789.159778293904, 7227.419097619293, 19.53882684573915, 7117.570753830092, 1485.8077407705985, 3228.6968593881693, 2177.4568318960437, 1345.0100823906187, 3491.8670624668152, 5521.387868826222, 2855.64894337589, 2700.429940120007, 3710.869048279476, 5717.252627237534, 4270.613267515004, 4278.020108299713, 1644.9633425074505, 3975.003622634372, 4382.933237841744, 4459.343733118381, 1514.4505086390695, 7061.978043865392, 1792.2593139645053, 2042.823733342349, 2350.1367559090854, 4468.793191890081, 5227.677339484398, 3691.5418941230587, 3908.3323186465454, 2289.9790932391534, 2248.687340328184, 2540.980511326015, 5261.47997015421, 552.7357359982961, 3139.2066592681726, 2200.9935792611313, 3116.8744043567253, 4059.952334126542, 2975.498147067235, 4943.417492630374, 3663.105351128985, 9153.99271905297, 1883.584310855386, 1187.8245254919436, 4996.072680611638, 2599.8571016326937, 2638.0799076353164, 2332.0673979915628], "policy_adversary_policy_reward": [-956.8707487986144, -1129.6345931610417, -3895.808037908414, -4447.321799157565, -2010.7928866490495, -6342.164397368982, -1333.2277840133045, -2867.0607403184076, -8565.79546191355, -4991.075395401152, -5494.649128109366, -4190.6169264929495, -1365.8730483677068, -5877.5715507437835, -2684.2763616714387, -2591.748107073986, -5846.934190492392, -4363.372461615991, -10253.704527181344, -6811.392144241838, -2934.479580824926, -5882.58232462896, -5841.6530356308, -1897.751991621493, -7892.505231108282, -4649.612757724233, -4518.906347393998, -1779.8630875760405, -7572.681268273116, -5275.5580096707745, -2607.153769423197, -6973.36238100123, -6536.472121811146, -3677.027085126949, -2240.961889666346, -357.99581560839675, -3339.3100843232946, -401.208343290382, -3204.674833199251, -2202.066591603481, -8250.96036645543, -4591.826347486671, -5452.1297095401, -1915.8277426689242, -4304.620625687933, -8383.021247749886, -5619.189789366486, -5087.425341057381, -5443.69438013001, -9004.482611564119, -6674.273575272035, -9114.567623330466, -3190.9668548497734, -6815.19585899011, -5596.828884847801, -6332.170941695817, -6401.295953430257, -5657.495866337264, -2026.724646238637, -4259.513857417812, -8030.566219147059, -8674.878272877468, -1113.327385974703, -1677.5024809603547, -6023.729622278978, -5501.350645426027, -3898.4043944542045, -4395.763802898375, -1596.8077629068378, -4382.625349279439, -2659.880092566081, -5651.411110529975, -4219.606719484187, -4761.321949470675, -2869.5685548459987, -6603.807763542047, -6255.771937551164, -6927.195937181036, -1936.4401867391439, -2637.740202800069, -2539.216752232377, -2431.0484188473124, -5779.434403835748, -4391.064323466492, -5573.936658590922, -5633.29548064923, -4038.2089350060783, -1044.6194559673024, -5249.125089208377, -753.4579456250166, -3849.1727223708112, -2502.392374896909, -8453.271801535891, -4115.1354300949115, -5417.3358301359685, -8237.196157866667, -7138.43686399261, -7585.0771298558275, -5794.405069691546, -2731.8344351891606, -5718.651743319089, -5731.970854998117, -3396.0403160818028, -1310.1756859091186, -789.159778293904, -3578.043229051173, -7618.50124604773, -7716.554235554417, -19.53882684573915, -143.12193023479955, -7202.6060071106995, -8326.258383120432, -1525.0589922629028, -2481.4117141536376, -3566.1571349521582, -5417.851590641039, -3261.324762482525, -2398.8628576992037, -1903.416025485127, -1346.728711381198, -3491.8670624668152, -8071.563966205159, -7786.796435333689, -5521.387868826222, -4921.029226518188, -3264.0839536199996, -2700.825845935123, -3946.505681647567, -3710.869048279476, -7976.279064105892, -6926.039015223473, -5849.268965232081, -5509.462428727884, -4274.061532862059, -5909.473155147769, -4278.020108299713, -1644.9633425074505, -5989.153415626501, -3976.2907498924205, -4971.785387515377, -5603.599931377942, -4876.0157199149035, -7308.521212615657, -4460.879559138182, -3799.634167175447, -1514.4505086390695, -7299.746132865989, -7246.535149356747, -1820.4420714880068, -4876.830496886216, -2634.7955054052222, -2059.5727582472255, -2350.1367559090854, -4946.077147444867, -5961.106759338949, -4519.992620014295, -6272.185986041424, -5237.503046252993, -4352.008227885587, -3980.7327264842165, -10538.645934552287, -3908.3323186465454, -2289.9790932391534, -6109.028451308833, -2543.7478631693957, -2351.8965057274168, -3040.9628994140635, -3318.9422522865457, -5261.47997015421, -6857.591491268508, -2900.9689733942687, -552.7357359982961, -3139.2066592681726, -6419.502417350147, -2200.9935792611313, -4638.6065027655795, -5215.806068860981, -3116.8744043567253, -6449.430714716421, -4205.319861719974, -6959.932830081424, -2975.498147067235, -5127.160467948278, -5594.8793213723975, -3663.105351128985, -8260.332090934453, -9153.99271905297, -11555.176119819042, -1983.5888590495463, -2664.8665805558717, -2534.879226790279, -1187.8245254919436, -4996.072680611638, -8540.019148654348, -2599.8571016326937, -7600.8479304407665, -2652.361189331766, -4221.265778531944, -5117.071588269066, -2332.0673979915628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3969659869139439, "mean_inference_ms": 0.9658254590543138, "mean_action_processing_ms": 0.1666176624371208, "mean_env_wait_ms": 0.05098723819946609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033614635467529297, "StateBufferConnector_ms": 0.002502918243408203, "ViewRequirementAgentConnector_ms": 0.06549215316772461}, "num_episodes": 18, "episode_return_max": -143.12193023479955, "episode_return_min": -11555.176119819042, "episode_return_mean": -5684.720857282535}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.8433870895857, "num_env_steps_trained_throughput_per_sec": 541.8433870895857, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1956000, "timers": {"training_iteration_time_ms": 7369.324, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7369.292, "sample_time_ms": 784.411, "learn_time_ms": 6573.607, "learn_throughput": 608.494, "synch_weights_time_ms": 10.781}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "done": false, "training_iteration": 163, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-46", "timestamp": 1723232806, "time_this_iter_s": 7.386914014816284, "time_total_s": 1215.7218925952911, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32228b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1215.7218925952911, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 25.245454545454546, "ram_util_percent": 82.21818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9834449812459449, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994102843602498, "policy_loss": -0.0062437277243589055, "vf_loss": 9.994958013296127, "vf_explained_var": -0.0007996462906400362, "kl": 0.00920840307129159, "entropy": 1.4702176747222742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0161692914508638, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996854934995136, "policy_loss": -0.002641165511628426, "vf_loss": 9.996083279766102, "vf_explained_var": 0.0017741375183932995, "kl": 0.01198468095618029, "entropy": 1.277764111662668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": -143.12193023479955, "episode_reward_min": -11555.176119819042, "episode_reward_mean": -5698.39795908176, "episode_len_mean": 190.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19000, "policy_reward_min": {"agent_policy": 19.53882684573915, "adversary_policy": -11555.176119819042}, "policy_reward_max": {"agent_policy": 9153.99271905297, "adversary_policy": -19.53882684573915}, "policy_reward_mean": {"agent_policy": 3587.323417957519, "adversary_policy": -4642.860688519639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8383.021247749886, -6408.543748998115, -9004.482611564119, -9120.190454536576, -6815.19585899011, -6355.400302545913, -6411.643513379321, -4260.028427120059, -8714.140360615174, -2020.7118885012133, -6076.135992506722, -4414.152598966438, -4401.172883993629, -5651.411110529975, -4765.18411803619, -6603.807763542047, -6928.5757955569, -2711.2841250922525, -2856.5352809548763, -5795.931634998478, -6401.534199033272, -4038.2089350060783, -5249.125089208376, -3849.172722370811, -8453.271801535891, -8237.196157866667, -7667.448534355732, -5794.801585689792, -6242.200976168517, -3396.0403160818023, -3578.043229051173, -8107.636383982855, -143.12193023479955, -8411.293636401042, -2520.6629656459413, -5755.311866205025, -3482.7307882856826, -1905.1346544757062, -8071.563966205159, -7786.796435333688, -5329.464236762291, -3946.901587462683, -7976.279064105892, -7058.055353218018, -5512.91069407494, -5909.47315514777, -5989.153415626501, -4973.072514773425, -6096.682413451102, -7310.057038635456, -3799.6341671754476, -7484.3032383573445, -4905.013254409716, -2651.5445303100996, -4946.077147444867, -6012.306187463162, -6282.011692810017, -4641.199060246751, -10538.645934552284, -6109.028451308833, -2646.957028568632, -3818.9246403745947, -6857.591491268508, -2900.9689733942687, -6419.502417350147, -4638.60650276558, -5215.806068860981, -6594.798242309853, -6959.932830081424, -5778.622296690311, -8260.332090934453, -11555.176119819042, -2764.871128750031, -2534.87922679028, -8540.01914865435, -7600.8479304407665, -4235.547060228394, -5117.071588269066, -8126.883371216659, -4290.54015590927, -2743.8284540233526, -5133.682143915176, -5499.313133717918, -5035.33277311901, -6395.403145478279, -6291.022792747332, -8066.215868410058, -5439.1341726639985, -4310.345228756382, -8507.229331286833, -3569.1470354511634, -5802.522328617884, -5098.411211319943, -7531.299734314275, -6153.956426675635, -4913.794527528883, -7539.949021045141, -3865.0911789633838, -3692.1826041011377, -5133.397454710859], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 153, 134, 200, 200, 200, 200, 200, 200, 200, 91, 200, 7, 200, 139, 200, 200, 119, 200, 200, 200, 199, 190, 200, 200, 200, 188, 200, 200, 200, 162, 200, 200, 200, 193, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4304.620625687933, 4298.071381425753, 5443.69438013001, 6668.650744065924, 3190.9668548497734, 5573.599523997706, 5647.1483063882, 2026.2100765363894, 7991.304131409352, 770.1179784338431, 5448.944275198283, 3880.0155983861387, 1578.2602281926565, 2659.880092566081, 4215.744550918673, 2869.5685548459987, 6254.392079175301, 1862.8962644469577, 2113.729890124813, 4374.567092303764, 4805.697940206874, 1044.6194559673024, 753.4579456250166, 2502.392374896909, 4115.1354300949115, 5417.3358301359685, 7056.065459492703, 2731.4379191909156, 5208.421622148693, 1310.1756859091186, 789.159778293904, 7227.419097619293, 19.53882684573915, 7117.570753830092, 1485.8077407705985, 3228.6968593881693, 2177.4568318960437, 1345.0100823906187, 3491.8670624668152, 5521.387868826222, 2855.64894337589, 2700.429940120007, 3710.869048279476, 5717.252627237534, 4270.613267515004, 4278.020108299713, 1644.9633425074505, 3975.003622634372, 4382.933237841744, 4459.343733118381, 1514.4505086390695, 7061.978043865392, 1792.2593139645053, 2042.823733342349, 2350.1367559090854, 4468.793191890081, 5227.677339484398, 3691.5418941230587, 3908.3323186465454, 2289.9790932391534, 2248.687340328184, 2540.980511326015, 5261.47997015421, 552.7357359982961, 3139.2066592681726, 2200.9935792611313, 3116.8744043567253, 4059.952334126542, 2975.498147067235, 4943.417492630374, 3663.105351128985, 9153.99271905297, 1883.584310855386, 1187.8245254919436, 4996.072680611638, 2599.8571016326937, 2638.0799076353164, 2332.0673979915628, 4705.656932990702, 1733.6128055020874, 562.405912141449, 2425.4348368743695, 3475.388266001475, 3922.113409800702, 5495.092021768175, 4137.782878098977, 6774.973657335832, 3680.0554108647843, 3346.5145329120114, 7139.590253577572, 2179.662937140686, 3776.9137044072063, 3381.2495542340757, 1993.5130513512486, 2374.374214175128, 3509.484624399772, 4243.831100993711, 2936.5803400467444, 2867.969151255386, 3711.6447718497134], "policy_adversary_policy_reward": [-4304.620625687933, -8383.021247749886, -5619.189789366486, -5087.425341057381, -5443.69438013001, -9004.482611564119, -6674.273575272035, -9114.567623330466, -3190.9668548497734, -6815.19585899011, -5596.828884847801, -6332.170941695817, -6401.295953430257, -5657.495866337264, -2026.724646238637, -4259.513857417812, -8030.566219147059, -8674.878272877468, -1113.327385974703, -1677.5024809603547, -6023.729622278978, -5501.350645426027, -3898.4043944542045, -4395.763802898375, -1596.8077629068378, -4382.625349279439, -2659.880092566081, -5651.411110529975, -4219.606719484187, -4761.321949470675, -2869.5685548459987, -6603.807763542047, -6255.771937551164, -6927.195937181036, -1936.4401867391439, -2637.740202800069, -2539.216752232377, -2431.0484188473124, -5779.434403835748, -4391.064323466492, -5573.936658590922, -5633.29548064923, -4038.2089350060783, -1044.6194559673024, -5249.125089208377, -753.4579456250166, -3849.1727223708112, -2502.392374896909, -8453.271801535891, -4115.1354300949115, -5417.3358301359685, -8237.196157866667, -7138.43686399261, -7585.0771298558275, -5794.405069691546, -2731.8344351891606, -5718.651743319089, -5731.970854998117, -3396.0403160818028, -1310.1756859091186, -789.159778293904, -3578.043229051173, -7618.50124604773, -7716.554235554417, -19.53882684573915, -143.12193023479955, -7202.6060071106995, -8326.258383120432, -1525.0589922629028, -2481.4117141536376, -3566.1571349521582, -5417.851590641039, -3261.324762482525, -2398.8628576992037, -1903.416025485127, -1346.728711381198, -3491.8670624668152, -8071.563966205159, -7786.796435333689, -5521.387868826222, -4921.029226518188, -3264.0839536199996, -2700.825845935123, -3946.505681647567, -3710.869048279476, -7976.279064105892, -6926.039015223473, -5849.268965232081, -5509.462428727884, -4274.061532862059, -5909.473155147769, -4278.020108299713, -1644.9633425074505, -5989.153415626501, -3976.2907498924205, -4971.785387515377, -5603.599931377942, -4876.0157199149035, -7308.521212615657, -4460.879559138182, -3799.634167175447, -1514.4505086390695, -7299.746132865989, -7246.535149356747, -1820.4420714880068, -4876.830496886216, -2634.7955054052222, -2059.5727582472255, -2350.1367559090854, -4946.077147444867, -5961.106759338949, -4519.992620014295, -6272.185986041424, -5237.503046252993, -4352.008227885587, -3980.7327264842165, -10538.645934552287, -3908.3323186465454, -2289.9790932391534, -6109.028451308833, -2543.7478631693957, -2351.8965057274168, -3040.9628994140635, -3318.9422522865457, -5261.47997015421, -6857.591491268508, -2900.9689733942687, -552.7357359982961, -3139.2066592681726, -6419.502417350147, -2200.9935792611313, -4638.6065027655795, -5215.806068860981, -3116.8744043567253, -6449.430714716421, -4205.319861719974, -6959.932830081424, -2975.498147067235, -5127.160467948278, -5594.8793213723975, -3663.105351128985, -8260.332090934453, -9153.99271905297, -11555.176119819042, -1983.5888590495463, -2664.8665805558717, -2534.879226790279, -1187.8245254919436, -4996.072680611638, -8540.019148654348, -2599.8571016326937, -7600.8479304407665, -2652.361189331766, -4221.265778531944, -5117.071588269066, -2332.0673979915628, -8126.883371216661, -4705.656932990702, -1741.2381605676956, -4282.914800843661, -2743.8284540233526, -562.405912141449, -2450.815818279584, -5108.301162509957, -3475.388266001475, -5499.3131337179175, -4951.565832952993, -4005.8803499667197, -5495.258990056308, -6395.236177190146, -4137.782878098977, -6291.022792747332, -8066.215868410058, -6774.973657335832, -3820.6431310435737, -5298.5464524852105, -3997.6989934290064, -3659.1607682393906, -7157.058797923751, -8489.760786940655, -3567.5407400231475, -2181.2692325687026, -3954.1150947748715, -5625.320938250216, -3381.2495542340757, -5098.4112113199435, -7531.299734314275, -1993.5130513512486, -2374.374214175128, -6153.956426675635, -4913.794527528882, -3509.484624399772, -7539.949021045141, -4243.831100993711, -2945.406347912618, -3856.26517109751, -3278.507169732071, -3281.644585624454, -4912.371451089228, -3932.6707754713384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3970055250974822, "mean_inference_ms": 0.9658649440725826, "mean_action_processing_ms": 0.16669015494124764, "mean_env_wait_ms": 0.05101639966499416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032521486282348633, "StateBufferConnector_ms": 0.002501368522644043, "ViewRequirementAgentConnector_ms": 0.06683707237243652}, "num_episodes": 22, "episode_return_max": -143.12193023479955, "episode_return_min": -11555.176119819042, "episode_return_mean": -5698.39795908176}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.5548220221384, "num_env_steps_trained_throughput_per_sec": 517.5548220221384, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 7428.362, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7428.329, "sample_time_ms": 808.256, "learn_time_ms": 6608.741, "learn_throughput": 605.259, "synch_weights_time_ms": 10.867}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 164, "trial_id": "3439d_00000", "date": "2024-08-09_15-46-54", "timestamp": 1723232814, "time_this_iter_s": 7.7335498332977295, "time_total_s": 1223.4554424285889, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3223dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1223.4554424285889, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 28.44545454545454, "ram_util_percent": 82.12727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0201841877462963, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995801204442978, "policy_loss": -0.004450905416645886, "vf_loss": 9.994721815983455, "vf_explained_var": -0.002278803413112958, "kl": 0.009450643688129883, "entropy": 1.4605668758352597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9963791619690637, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996171502713803, "policy_loss": -0.003325873755766128, "vf_loss": 9.996383911213547, "vf_explained_var": -0.000505659819910766, "kl": 0.010933499811857782, "entropy": 1.262058045245983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "env_runners": {"episode_reward_max": -143.12193023479955, "episode_reward_min": -11555.176119819042, "episode_reward_mean": -5779.7137256814, "episode_len_mean": 190.05, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19005, "policy_reward_min": {"agent_policy": 19.53882684573915, "adversary_policy": -11555.176119819042}, "policy_reward_max": {"agent_policy": 9153.99271905297, "adversary_policy": -19.53882684573915}, "policy_reward_mean": {"agent_policy": 3538.268786162183, "adversary_policy": -4658.991255921791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3849.172722370811, -8453.271801535891, -8237.196157866667, -7667.448534355732, -5794.801585689792, -6242.200976168517, -3396.0403160818023, -3578.043229051173, -8107.636383982855, -143.12193023479955, -8411.293636401042, -2520.6629656459413, -5755.311866205025, -3482.7307882856826, -1905.1346544757062, -8071.563966205159, -7786.796435333688, -5329.464236762291, -3946.901587462683, -7976.279064105892, -7058.055353218018, -5512.91069407494, -5909.47315514777, -5989.153415626501, -4973.072514773425, -6096.682413451102, -7310.057038635456, -3799.6341671754476, -7484.3032383573445, -4905.013254409716, -2651.5445303100996, -4946.077147444867, -6012.306187463162, -6282.011692810017, -4641.199060246751, -10538.645934552284, -6109.028451308833, -2646.957028568632, -3818.9246403745947, -6857.591491268508, -2900.9689733942687, -6419.502417350147, -4638.60650276558, -5215.806068860981, -6594.798242309853, -6959.932830081424, -5778.622296690311, -8260.332090934453, -11555.176119819042, -2764.871128750031, -2534.87922679028, -8540.01914865435, -7600.8479304407665, -4235.547060228394, -5117.071588269066, -8126.883371216659, -4290.54015590927, -2743.8284540233526, -5133.682143915176, -5499.313133717918, -5035.33277311901, -6395.403145478279, -6291.022792747332, -8066.215868410058, -5439.1341726639985, -4310.345228756382, -8507.229331286833, -3569.1470354511634, -5802.522328617884, -5098.411211319943, -7531.299734314275, -6153.956426675635, -4913.794527528883, -7539.949021045141, -3865.0911789633838, -3692.1826041011377, -5133.397454710859, -4834.796825050554, -8977.35661288302, -3985.159063610826, -7168.842263709068, -6460.195349852522, -2955.562861381864, -6163.48277528829, -4083.15316933059, -6162.444593470636, -6868.995803340543, -8554.506251033275, -5615.543367012153, -4920.964072329722, -4442.291590318811, -4375.0410226934255, -2849.354787161151, -8931.83856213238, -5125.118825423751, -5641.182796521454, -7365.34841544223, -9918.227121208693, -7230.321883400911, -8888.266588793993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 91, 200, 7, 200, 139, 200, 200, 119, 200, 200, 200, 199, 190, 200, 200, 200, 188, 200, 200, 200, 162, 200, 200, 200, 193, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2502.392374896909, 4115.1354300949115, 5417.3358301359685, 7056.065459492703, 2731.4379191909156, 5208.421622148693, 1310.1756859091186, 789.159778293904, 7227.419097619293, 19.53882684573915, 7117.570753830092, 1485.8077407705985, 3228.6968593881693, 2177.4568318960437, 1345.0100823906187, 3491.8670624668152, 5521.387868826222, 2855.64894337589, 2700.429940120007, 3710.869048279476, 5717.252627237534, 4270.613267515004, 4278.020108299713, 1644.9633425074505, 3975.003622634372, 4382.933237841744, 4459.343733118381, 1514.4505086390695, 7061.978043865392, 1792.2593139645053, 2042.823733342349, 2350.1367559090854, 4468.793191890081, 5227.677339484398, 3691.5418941230587, 3908.3323186465454, 2289.9790932391534, 2248.687340328184, 2540.980511326015, 5261.47997015421, 552.7357359982961, 3139.2066592681726, 2200.9935792611313, 3116.8744043567253, 4059.952334126542, 2975.498147067235, 4943.417492630374, 3663.105351128985, 9153.99271905297, 1883.584310855386, 1187.8245254919436, 4996.072680611638, 2599.8571016326937, 2638.0799076353164, 2332.0673979915628, 4705.656932990702, 1733.6128055020874, 562.405912141449, 2425.4348368743695, 3475.388266001475, 3922.113409800702, 5495.092021768175, 4137.782878098977, 6774.973657335832, 3680.0554108647843, 3346.5145329120114, 7139.590253577572, 2179.662937140686, 3776.9137044072063, 3381.2495542340757, 1993.5130513512486, 2374.374214175128, 3509.484624399772, 4243.831100993711, 2936.5803400467444, 2867.969151255386, 3711.6447718497134, 1889.4983378898955, 4119.646769065881, 2970.330867652546, 3171.5245366740655, 5398.088760882434, 1587.4413422708503, 4077.555825188072, 1734.3550206071677, 3547.6852491812974, 4729.204134855259, 7441.326223559936, 2997.7183780411674, 3991.539025298783, 2072.510942067531, 2522.4008043741915, 538.052211757274, 2365.9363695693587, 3218.706066801458, 4426.854797139255, 5100.671219880455, 6287.779868074842, 6485.07364868087, 2196.794391836557], "policy_adversary_policy_reward": [-3849.1727223708112, -2502.392374896909, -8453.271801535891, -4115.1354300949115, -5417.3358301359685, -8237.196157866667, -7138.43686399261, -7585.0771298558275, -5794.405069691546, -2731.8344351891606, -5718.651743319089, -5731.970854998117, -3396.0403160818028, -1310.1756859091186, -789.159778293904, -3578.043229051173, -7618.50124604773, -7716.554235554417, -19.53882684573915, -143.12193023479955, -7202.6060071106995, -8326.258383120432, -1525.0589922629028, -2481.4117141536376, -3566.1571349521582, -5417.851590641039, -3261.324762482525, -2398.8628576992037, -1903.416025485127, -1346.728711381198, -3491.8670624668152, -8071.563966205159, -7786.796435333689, -5521.387868826222, -4921.029226518188, -3264.0839536199996, -2700.825845935123, -3946.505681647567, -3710.869048279476, -7976.279064105892, -6926.039015223473, -5849.268965232081, -5509.462428727884, -4274.061532862059, -5909.473155147769, -4278.020108299713, -1644.9633425074505, -5989.153415626501, -3976.2907498924205, -4971.785387515377, -5603.599931377942, -4876.0157199149035, -7308.521212615657, -4460.879559138182, -3799.634167175447, -1514.4505086390695, -7299.746132865989, -7246.535149356747, -1820.4420714880068, -4876.830496886216, -2634.7955054052222, -2059.5727582472255, -2350.1367559090854, -4946.077147444867, -5961.106759338949, -4519.992620014295, -6272.185986041424, -5237.503046252993, -4352.008227885587, -3980.7327264842165, -10538.645934552287, -3908.3323186465454, -2289.9790932391534, -6109.028451308833, -2543.7478631693957, -2351.8965057274168, -3040.9628994140635, -3318.9422522865457, -5261.47997015421, -6857.591491268508, -2900.9689733942687, -552.7357359982961, -3139.2066592681726, -6419.502417350147, -2200.9935792611313, -4638.6065027655795, -5215.806068860981, -3116.8744043567253, -6449.430714716421, -4205.319861719974, -6959.932830081424, -2975.498147067235, -5127.160467948278, -5594.8793213723975, -3663.105351128985, -8260.332090934453, -9153.99271905297, -11555.176119819042, -1983.5888590495463, -2664.8665805558717, -2534.879226790279, -1187.8245254919436, -4996.072680611638, -8540.019148654348, -2599.8571016326937, -7600.8479304407665, -2652.361189331766, -4221.265778531944, -5117.071588269066, -2332.0673979915628, -8126.883371216661, -4705.656932990702, -1741.2381605676956, -4282.914800843661, -2743.8284540233526, -562.405912141449, -2450.815818279584, -5108.301162509957, -3475.388266001475, -5499.3131337179175, -4951.565832952993, -4005.8803499667197, -5495.258990056308, -6395.236177190146, -4137.782878098977, -6291.022792747332, -8066.215868410058, -6774.973657335832, -3820.6431310435737, -5298.5464524852105, -3997.6989934290064, -3659.1607682393906, -7157.058797923751, -8489.760786940655, -3567.5407400231475, -2181.2692325687026, -3954.1150947748715, -5625.320938250216, -3381.2495542340757, -5098.4112113199435, -7531.299734314275, -1993.5130513512486, -2374.374214175128, -6153.956426675635, -4913.794527528882, -3509.484624399772, -7539.949021045141, -4243.831100993711, -2945.406347912618, -3856.26517109751, -3278.507169732071, -3281.644585624454, -4912.371451089228, -3932.6707754713384, -4834.7968250505555, -1889.4983378898955, -4119.646769065881, -8977.35661288302, -2970.330867652546, -3985.1590636108267, -3171.5245366740655, -7168.842263709068, -5623.724008043514, -6234.560102691443, -2869.6856599218363, -1673.3185437308825, -4077.555825188072, -6163.482775288289, -4083.15316933059, -1734.3550206071677, -6003.672261332764, -3706.4575813191714, -4729.204134855259, -6868.995803340543, -8351.826613875295, -7644.005860717914, -3012.970591154511, -5600.291153898809, -3999.022739412573, -4913.480358215931, -2072.510942067531, -4442.291590318811, -3102.8650450570517, -3794.5767820105625, -538.052211757274, -2849.354787161151, -8931.83856213238, -2365.9363695693587, -3218.9952875105528, -5124.829604714657, -5607.024420064165, -4461.013173596546, -7350.539763161679, -5115.479872161006, -6287.779868074842, -9918.227121208693, -7227.117731607631, -6488.277800474149, -8888.266588793993, -2196.794391836557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39696032766152667, "mean_inference_ms": 0.9666021910648536, "mean_action_processing_ms": 0.16674839213801979, "mean_env_wait_ms": 0.05103356500937679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003119945526123047, "StateBufferConnector_ms": 0.002502918243408203, "ViewRequirementAgentConnector_ms": 0.06710565090179443}, "num_episodes": 23, "episode_return_max": -143.12193023479955, "episode_return_min": -11555.176119819042, "episode_return_mean": -5779.7137256814}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 524.8445812770511, "num_env_steps_trained_throughput_per_sec": 524.8445812770511, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1980000, "timers": {"training_iteration_time_ms": 7453.378, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7453.345, "sample_time_ms": 815.953, "learn_time_ms": 6626.053, "learn_throughput": 603.678, "synch_weights_time_ms": 10.868}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "done": false, "training_iteration": 165, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-02", "timestamp": 1723232822, "time_this_iter_s": 7.626132965087891, "time_total_s": 1231.0815753936768, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3222ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1231.0815753936768, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 26.781818181818185, "ram_util_percent": 80.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.049521391497304, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985247916976611, "policy_loss": -0.007200894219082935, "vf_loss": 9.988034218549728, "vf_explained_var": -0.0012241358558336894, "kl": 0.007544053576566512, "entropy": 1.4347105868160726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9924458930180187, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994073409630507, "policy_loss": -0.0019171392848153436, "vf_loss": 9.993090521595466, "vf_explained_var": 0.00040377482535347103, "kl": 0.010183897082541119, "entropy": 1.2456799262415164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": -478.15364499278445, "episode_reward_min": -11877.10284403286, "episode_reward_mean": -6044.223697885055, "episode_len_mean": 193.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19300, "policy_reward_min": {"agent_policy": 194.6231379363052, "adversary_policy": -11865.024894791026}, "policy_reward_max": {"agent_policy": 10692.656982989518, "adversary_policy": -197.71502474934093}, "policy_reward_mean": {"agent_policy": 3796.367651443417, "adversary_policy": -4920.295674664236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7976.279064105892, -7058.055353218018, -5512.91069407494, -5909.47315514777, -5989.153415626501, -4973.072514773425, -6096.682413451102, -7310.057038635456, -3799.6341671754476, -7484.3032383573445, -4905.013254409716, -2651.5445303100996, -4946.077147444867, -6012.306187463162, -6282.011692810017, -4641.199060246751, -10538.645934552284, -6109.028451308833, -2646.957028568632, -3818.9246403745947, -6857.591491268508, -2900.9689733942687, -6419.502417350147, -4638.60650276558, -5215.806068860981, -6594.798242309853, -6959.932830081424, -5778.622296690311, -8260.332090934453, -11555.176119819042, -2764.871128750031, -2534.87922679028, -8540.01914865435, -7600.8479304407665, -4235.547060228394, -5117.071588269066, -8126.883371216659, -4290.54015590927, -2743.8284540233526, -5133.682143915176, -5499.313133717918, -5035.33277311901, -6395.403145478279, -6291.022792747332, -8066.215868410058, -5439.1341726639985, -4310.345228756382, -8507.229331286833, -3569.1470354511634, -5802.522328617884, -5098.411211319943, -7531.299734314275, -6153.956426675635, -4913.794527528883, -7539.949021045141, -3865.0911789633838, -3692.1826041011377, -5133.397454710859, -4834.796825050554, -8977.35661288302, -3985.159063610826, -7168.842263709068, -6460.195349852522, -2955.562861381864, -6163.48277528829, -4083.15316933059, -6162.444593470636, -6868.995803340543, -8554.506251033275, -5615.543367012153, -4920.964072329722, -4442.291590318811, -4375.0410226934255, -2849.354787161151, -8931.83856213238, -5125.118825423751, -5641.182796521454, -7365.34841544223, -9918.227121208693, -7230.321883400911, -8888.266588793993, -8455.427529983543, -11877.10284403286, -6257.1298090860055, -7217.431726452575, -6076.756777670937, -7316.462671076454, -6556.953830716542, -6281.419255992978, -7726.450182593189, -5446.178932518111, -5256.608469322858, -6489.015038605023, -9194.895179548457, -8497.652755559435, -8428.517476458394, -7662.498605509223, -478.15364499278445, -5002.311781295546, -4908.824483065916], "episode_lengths": [190, 200, 200, 200, 188, 200, 200, 200, 162, 200, 200, 200, 193, 200, 200, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 197, 200, 200, 200, 200, 53, 200, 200], "policy_agent_policy_reward": [3710.869048279476, 5717.252627237534, 4270.613267515004, 4278.020108299713, 1644.9633425074505, 3975.003622634372, 4382.933237841744, 4459.343733118381, 1514.4505086390695, 7061.978043865392, 1792.2593139645053, 2042.823733342349, 2350.1367559090854, 4468.793191890081, 5227.677339484398, 3691.5418941230587, 3908.3323186465454, 2289.9790932391534, 2248.687340328184, 2540.980511326015, 5261.47997015421, 552.7357359982961, 3139.2066592681726, 2200.9935792611313, 3116.8744043567253, 4059.952334126542, 2975.498147067235, 4943.417492630374, 3663.105351128985, 9153.99271905297, 1883.584310855386, 1187.8245254919436, 4996.072680611638, 2599.8571016326937, 2638.0799076353164, 2332.0673979915628, 4705.656932990702, 1733.6128055020874, 562.405912141449, 2425.4348368743695, 3475.388266001475, 3922.113409800702, 5495.092021768175, 4137.782878098977, 6774.973657335832, 3680.0554108647843, 3346.5145329120114, 7139.590253577572, 2179.662937140686, 3776.9137044072063, 3381.2495542340757, 1993.5130513512486, 2374.374214175128, 3509.484624399772, 4243.831100993711, 2936.5803400467444, 2867.969151255386, 3711.6447718497134, 1889.4983378898955, 4119.646769065881, 2970.330867652546, 3171.5245366740655, 5398.088760882434, 1587.4413422708503, 4077.555825188072, 1734.3550206071677, 3547.6852491812974, 4729.204134855259, 7441.326223559936, 2997.7183780411674, 3991.539025298783, 2072.510942067531, 2522.4008043741915, 538.052211757274, 2365.9363695693587, 3218.706066801458, 4426.854797139255, 5100.671219880455, 6287.779868074842, 6485.07364868087, 2196.794391836557, 7009.046198715518, 10692.656982989518, 3298.617574736849, 1458.2462500352497, 5221.106851966019, 3666.7334146989797, 5160.612985923802, 5488.344682354776, 4929.709038192366, 3054.179554624884, 3698.830617879234, 2829.917598073208, 8356.913777691376, 7689.82731437203, 7343.1538459930525, 4637.98216952825, 194.6231379363052, 3651.346056732675, 3728.9965833719352], "policy_adversary_policy_reward": [-3710.869048279476, -7976.279064105892, -6926.039015223473, -5849.268965232081, -5509.462428727884, -4274.061532862059, -5909.473155147769, -4278.020108299713, -1644.9633425074505, -5989.153415626501, -3976.2907498924205, -4971.785387515377, -5603.599931377942, -4876.0157199149035, -7308.521212615657, -4460.879559138182, -3799.634167175447, -1514.4505086390695, -7299.746132865989, -7246.535149356747, -1820.4420714880068, -4876.830496886216, -2634.7955054052222, -2059.5727582472255, -2350.1367559090854, -4946.077147444867, -5961.106759338949, -4519.992620014295, -6272.185986041424, -5237.503046252993, -4352.008227885587, -3980.7327264842165, -10538.645934552287, -3908.3323186465454, -2289.9790932391534, -6109.028451308833, -2543.7478631693957, -2351.8965057274168, -3040.9628994140635, -3318.9422522865457, -5261.47997015421, -6857.591491268508, -2900.9689733942687, -552.7357359982961, -3139.2066592681726, -6419.502417350147, -2200.9935792611313, -4638.6065027655795, -5215.806068860981, -3116.8744043567253, -6449.430714716421, -4205.319861719974, -6959.932830081424, -2975.498147067235, -5127.160467948278, -5594.8793213723975, -3663.105351128985, -8260.332090934453, -9153.99271905297, -11555.176119819042, -1983.5888590495463, -2664.8665805558717, -2534.879226790279, -1187.8245254919436, -4996.072680611638, -8540.019148654348, -2599.8571016326937, -7600.8479304407665, -2652.361189331766, -4221.265778531944, -5117.071588269066, -2332.0673979915628, -8126.883371216661, -4705.656932990702, -1741.2381605676956, -4282.914800843661, -2743.8284540233526, -562.405912141449, -2450.815818279584, -5108.301162509957, -3475.388266001475, -5499.3131337179175, -4951.565832952993, -4005.8803499667197, -5495.258990056308, -6395.236177190146, -4137.782878098977, -6291.022792747332, -8066.215868410058, -6774.973657335832, -3820.6431310435737, -5298.5464524852105, -3997.6989934290064, -3659.1607682393906, -7157.058797923751, -8489.760786940655, -3567.5407400231475, -2181.2692325687026, -3954.1150947748715, -5625.320938250216, -3381.2495542340757, -5098.4112113199435, -7531.299734314275, -1993.5130513512486, -2374.374214175128, -6153.956426675635, -4913.794527528882, -3509.484624399772, -7539.949021045141, -4243.831100993711, -2945.406347912618, -3856.26517109751, -3278.507169732071, -3281.644585624454, -4912.371451089228, -3932.6707754713384, -4834.7968250505555, -1889.4983378898955, -4119.646769065881, -8977.35661288302, -2970.330867652546, -3985.1590636108267, -3171.5245366740655, -7168.842263709068, -5623.724008043514, -6234.560102691443, -2869.6856599218363, -1673.3185437308825, -4077.555825188072, -6163.482775288289, -4083.15316933059, -1734.3550206071677, -6003.672261332764, -3706.4575813191714, -4729.204134855259, -6868.995803340543, -8351.826613875295, -7644.005860717914, -3012.970591154511, -5600.291153898809, -3999.022739412573, -4913.480358215931, -2072.510942067531, -4442.291590318811, -3102.8650450570517, -3794.5767820105625, -538.052211757274, -2849.354787161151, -8931.83856213238, -2365.9363695693587, -3218.9952875105528, -5124.829604714657, -5607.024420064165, -4461.013173596546, -7350.539763161679, -5115.479872161006, -6287.779868074842, -9918.227121208693, -7227.117731607631, -6488.277800474149, -8888.266588793993, -2196.794391836557, -7009.046198715518, -8455.427529983543, -10704.734932231348, -11865.024894791026, -5314.2605531546005, -4241.486830668246, -1458.2462500352497, -7217.431726452575, -5917.283489690592, -5380.5801399463635, -3666.7334146989797, -7316.462671076454, -6438.810391463773, -5278.756425176572, -6155.183594325672, -5614.580344022082, -7726.450182593188, -4929.709038192366, -3054.179554624884, -5446.178932518111, -4925.010816054057, -4030.428271148024, -6489.015038605023, -2829.917598073208, -9093.009656902494, -8458.799300337341, -8182.002746460204, -8005.477323471264, -8428.517476458394, -7343.1538459930525, -7654.0966417112895, -4646.3841333261835, -197.71502474934093, -475.0617581797487, -3658.7719983992642, -4994.885839628957, -4474.824427977535, -4162.996638460314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3970627662603617, "mean_inference_ms": 0.9666570584304737, "mean_action_processing_ms": 0.16662049119178987, "mean_env_wait_ms": 0.051018638411736476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030968189239501953, "StateBufferConnector_ms": 0.0023784637451171875, "ViewRequirementAgentConnector_ms": 0.06629669666290283}, "num_episodes": 19, "episode_return_max": -478.15364499278445, "episode_return_min": -11877.10284403286, "episode_return_mean": -6044.223697885055}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 571.5819984752786, "num_env_steps_trained_throughput_per_sec": 571.5819984752786, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 7426.746, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7426.713, "sample_time_ms": 817.526, "learn_time_ms": 6598.032, "learn_throughput": 606.241, "synch_weights_time_ms": 10.68}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 166, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-09", "timestamp": 1723232829, "time_this_iter_s": 7.0028839111328125, "time_total_s": 1238.0844593048096, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3222f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1238.0844593048096, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 23.01818181818182, "ram_util_percent": 81.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0245516599776845, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97947364548842, "policy_loss": -0.006885800208935203, "vf_loss": 9.982072279850643, "vf_explained_var": -0.0020634216566880544, "kl": 0.0073263012743458, "entropy": 1.3794957010696332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0550880795433408, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988028829564493, "policy_loss": -0.0016779424925704323, "vf_loss": 9.986743546036816, "vf_explained_var": 0.00012882777622767857, "kl": 0.010405911828228642, "entropy": 1.190107560157776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "env_runners": {"episode_reward_max": -478.15364499278445, "episode_reward_min": -11877.10284403286, "episode_reward_mean": -6146.964296715617, "episode_len_mean": 188.16, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18816, "policy_reward_min": {"agent_policy": 63.64249688516739, "adversary_policy": -11865.024894791026}, "policy_reward_max": {"agent_policy": 10692.656982989518, "adversary_policy": -63.64249688516739}, "policy_reward_mean": {"agent_policy": 4008.9307588354804, "adversary_policy": -5077.947527775549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5215.806068860981, -6594.798242309853, -6959.932830081424, -5778.622296690311, -8260.332090934453, -11555.176119819042, -2764.871128750031, -2534.87922679028, -8540.01914865435, -7600.8479304407665, -4235.547060228394, -5117.071588269066, -8126.883371216659, -4290.54015590927, -2743.8284540233526, -5133.682143915176, -5499.313133717918, -5035.33277311901, -6395.403145478279, -6291.022792747332, -8066.215868410058, -5439.1341726639985, -4310.345228756382, -8507.229331286833, -3569.1470354511634, -5802.522328617884, -5098.411211319943, -7531.299734314275, -6153.956426675635, -4913.794527528883, -7539.949021045141, -3865.0911789633838, -3692.1826041011377, -5133.397454710859, -4834.796825050554, -8977.35661288302, -3985.159063610826, -7168.842263709068, -6460.195349852522, -2955.562861381864, -6163.48277528829, -4083.15316933059, -6162.444593470636, -6868.995803340543, -8554.506251033275, -5615.543367012153, -4920.964072329722, -4442.291590318811, -4375.0410226934255, -2849.354787161151, -8931.83856213238, -5125.118825423751, -5641.182796521454, -7365.34841544223, -9918.227121208693, -7230.321883400911, -8888.266588793993, -8455.427529983543, -11877.10284403286, -6257.1298090860055, -7217.431726452575, -6076.756777670937, -7316.462671076454, -6556.953830716542, -6281.419255992978, -7726.450182593189, -5446.178932518111, -5256.608469322858, -6489.015038605023, -9194.895179548457, -8497.652755559435, -8428.517476458394, -7662.498605509223, -478.15364499278445, -5002.311781295546, -4908.824483065916, -7947.419202586051, -5439.337802444379, -7917.285782483381, -10509.323247397731, -692.7340094526226, -8595.700377335663, -4460.209613745744, -9012.72514600361, -1977.921852884013, -1122.0540957108801, -8050.623622576864, -5826.7771672769, -5378.121128680513, -1056.3419543666832, -6019.830298606366, -5866.661754904935, -8820.602652429054, -8549.340583952087, -4126.762246861559, -5864.82324425939, -9880.719465965609, -804.2203917460795, -10460.755418592049, -7371.767189627409], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 137, 200, 200, 200, 200, 200, 200, 70, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 197, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 72, 200, 187, 200, 102, 55, 200, 200, 200, 87, 196, 200, 200, 200, 200, 200, 200, 20, 200, 200], "policy_agent_policy_reward": [3116.8744043567253, 4059.952334126542, 2975.498147067235, 4943.417492630374, 3663.105351128985, 9153.99271905297, 1883.584310855386, 1187.8245254919436, 4996.072680611638, 2599.8571016326937, 2638.0799076353164, 2332.0673979915628, 4705.656932990702, 1733.6128055020874, 562.405912141449, 2425.4348368743695, 3475.388266001475, 3922.113409800702, 5495.092021768175, 4137.782878098977, 6774.973657335832, 3680.0554108647843, 3346.5145329120114, 7139.590253577572, 2179.662937140686, 3776.9137044072063, 3381.2495542340757, 1993.5130513512486, 2374.374214175128, 3509.484624399772, 4243.831100993711, 2936.5803400467444, 2867.969151255386, 3711.6447718497134, 1889.4983378898955, 4119.646769065881, 2970.330867652546, 3171.5245366740655, 5398.088760882434, 1587.4413422708503, 4077.555825188072, 1734.3550206071677, 3547.6852491812974, 4729.204134855259, 7441.326223559936, 2997.7183780411674, 3991.539025298783, 2072.510942067531, 2522.4008043741915, 538.052211757274, 2365.9363695693587, 3218.706066801458, 4426.854797139255, 5100.671219880455, 6287.779868074842, 6485.07364868087, 2196.794391836557, 7009.046198715518, 10692.656982989518, 3298.617574736849, 1458.2462500352497, 5221.106851966019, 3666.7334146989797, 5160.612985923802, 5488.344682354776, 4929.709038192366, 3054.179554624884, 3698.830617879234, 2829.917598073208, 8356.913777691376, 7689.82731437203, 7343.1538459930525, 4637.98216952825, 194.6231379363052, 3651.346056732675, 3728.9965833719352, 6815.02548500771, 4252.221917231594, 3762.008877156563, 7820.319131695801, 249.48198522083237, 5386.100287860973, 2673.844519805357, 7977.1311907327245, 528.0965670540878, 376.8704466203095, 6888.682217912427, 5285.445567042216, 4974.429216159537, 572.9517287278497, 2282.8134340333854, 4490.940211803204, 7724.210400976285, 2748.401693125813, 2717.306995199013, 4512.599235816978, 5914.915253195542, 63.64249688516739, 9221.020643599295, 6748.906213217021], "policy_adversary_policy_reward": [-5215.806068860981, -3116.8744043567253, -6449.430714716421, -4205.319861719974, -6959.932830081424, -2975.498147067235, -5127.160467948278, -5594.8793213723975, -3663.105351128985, -8260.332090934453, -9153.99271905297, -11555.176119819042, -1983.5888590495463, -2664.8665805558717, -2534.879226790279, -1187.8245254919436, -4996.072680611638, -8540.019148654348, -2599.8571016326937, -7600.8479304407665, -2652.361189331766, -4221.265778531944, -5117.071588269066, -2332.0673979915628, -8126.883371216661, -4705.656932990702, -1741.2381605676956, -4282.914800843661, -2743.8284540233526, -562.405912141449, -2450.815818279584, -5108.301162509957, -3475.388266001475, -5499.3131337179175, -4951.565832952993, -4005.8803499667197, -5495.258990056308, -6395.236177190146, -4137.782878098977, -6291.022792747332, -8066.215868410058, -6774.973657335832, -3820.6431310435737, -5298.5464524852105, -3997.6989934290064, -3659.1607682393906, -7157.058797923751, -8489.760786940655, -3567.5407400231475, -2181.2692325687026, -3954.1150947748715, -5625.320938250216, -3381.2495542340757, -5098.4112113199435, -7531.299734314275, -1993.5130513512486, -2374.374214175128, -6153.956426675635, -4913.794527528882, -3509.484624399772, -7539.949021045141, -4243.831100993711, -2945.406347912618, -3856.26517109751, -3278.507169732071, -3281.644585624454, -4912.371451089228, -3932.6707754713384, -4834.7968250505555, -1889.4983378898955, -4119.646769065881, -8977.35661288302, -2970.330867652546, -3985.1590636108267, -3171.5245366740655, -7168.842263709068, -5623.724008043514, -6234.560102691443, -2869.6856599218363, -1673.3185437308825, -4077.555825188072, -6163.482775288289, -4083.15316933059, -1734.3550206071677, -6003.672261332764, -3706.4575813191714, -4729.204134855259, -6868.995803340543, -8351.826613875295, -7644.005860717914, -3012.970591154511, -5600.291153898809, -3999.022739412573, -4913.480358215931, -2072.510942067531, -4442.291590318811, -3102.8650450570517, -3794.5767820105625, -538.052211757274, -2849.354787161151, -8931.83856213238, -2365.9363695693587, -3218.9952875105528, -5124.829604714657, -5607.024420064165, -4461.013173596546, -7350.539763161679, -5115.479872161006, -6287.779868074842, -9918.227121208693, -7227.117731607631, -6488.277800474149, -8888.266588793993, -2196.794391836557, -7009.046198715518, -8455.427529983543, -10704.734932231348, -11865.024894791026, -5314.2605531546005, -4241.486830668246, -1458.2462500352497, -7217.431726452575, -5917.283489690592, -5380.5801399463635, -3666.7334146989797, -7316.462671076454, -6438.810391463773, -5278.756425176572, -6155.183594325672, -5614.580344022082, -7726.450182593188, -4929.709038192366, -3054.179554624884, -5446.178932518111, -4925.010816054057, -4030.428271148024, -6489.015038605023, -2829.917598073208, -9093.009656902494, -8458.799300337341, -8182.002746460204, -8005.477323471264, -8428.517476458394, -7343.1538459930525, -7654.0966417112895, -4646.3841333261835, -197.71502474934093, -475.0617581797487, -3658.7719983992642, -4994.885839628957, -4474.824427977535, -4162.996638460314, -7872.942830034027, -6889.501857559733, -5097.309792826515, -4594.249926849454, -7917.285782483381, -3762.008877156563, -7820.319131695801, -10509.323247397731, -692.6121961971645, -249.60379847629025, -5386.100287860973, -8595.700377335663, -4456.407730030437, -2677.646403520658, -9012.72514600361, -7977.1311907327245, -528.0965670540878, -1977.921852884013, -376.8704466203095, -1122.0540957108801, -7896.829754939303, -7042.476085549987, -5603.941019291166, -5508.281715027946, -5069.915572082795, -5282.634772757254, -1002.7129803041315, -626.5807027904018, -2282.8134340333854, -6019.830298606366, -5483.760114369591, -4873.841852338554, -8365.797152194698, -8179.015901210648, -8549.340583952086, -2748.401693125813, -4112.585349714025, -2731.483892346547, -4523.05376651024, -5854.368713566127, -9880.71946596561, -5914.915253195542, -63.64249688516739, -804.2203917460795, -10336.775069813406, -9345.000992377938, -6863.826403012587, -7256.8469998318415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39687876559853535, "mean_inference_ms": 0.9670811935848813, "mean_action_processing_ms": 0.1666324824719235, "mean_env_wait_ms": 0.05099262850960347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032744407653808594, "StateBufferConnector_ms": 0.002339005470275879, "ViewRequirementAgentConnector_ms": 0.06483376026153564}, "num_episodes": 24, "episode_return_max": -478.15364499278445, "episode_return_min": -11877.10284403286, "episode_return_mean": -6146.964296715617}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.4431891462783, "num_env_steps_trained_throughput_per_sec": 535.4431891462783, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2004000, "timers": {"training_iteration_time_ms": 7425.978, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7425.945, "sample_time_ms": 810.126, "learn_time_ms": 6604.068, "learn_throughput": 605.687, "synch_weights_time_ms": 11.273}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "done": false, "training_iteration": 167, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-17", "timestamp": 1723232837, "time_this_iter_s": 7.475930213928223, "time_total_s": 1245.5603895187378, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a0d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1245.5603895187378, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 27.18, "ram_util_percent": 80.94000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0125795434849958, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988903402288754, "policy_loss": -0.005332192150914731, "vf_loss": 9.990464331706365, "vf_explained_var": -0.00444134846329689, "kl": 0.006444678901849936, "entropy": 1.386123136182626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9813488388187671, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993002492410165, "policy_loss": -3.6392681221797986e-05, "vf_loss": 9.990206877895133, "vf_explained_var": 0.00039780139923095703, "kl": 0.009944969714279212, "entropy": 1.1806569472191826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": -478.15364499278445, "episode_reward_min": -11877.10284403286, "episode_reward_mean": -6134.530882827984, "episode_len_mean": 188.23, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18823, "policy_reward_min": {"agent_policy": 63.64249688516739, "adversary_policy": -11865.024894791026}, "policy_reward_max": {"agent_policy": 10692.656982989518, "adversary_policy": -63.64249688516739}, "policy_reward_mean": {"agent_policy": 3978.4352664380144, "adversary_policy": -5056.483074633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4310.345228756382, -8507.229331286833, -3569.1470354511634, -5802.522328617884, -5098.411211319943, -7531.299734314275, -6153.956426675635, -4913.794527528883, -7539.949021045141, -3865.0911789633838, -3692.1826041011377, -5133.397454710859, -4834.796825050554, -8977.35661288302, -3985.159063610826, -7168.842263709068, -6460.195349852522, -2955.562861381864, -6163.48277528829, -4083.15316933059, -6162.444593470636, -6868.995803340543, -8554.506251033275, -5615.543367012153, -4920.964072329722, -4442.291590318811, -4375.0410226934255, -2849.354787161151, -8931.83856213238, -5125.118825423751, -5641.182796521454, -7365.34841544223, -9918.227121208693, -7230.321883400911, -8888.266588793993, -8455.427529983543, -11877.10284403286, -6257.1298090860055, -7217.431726452575, -6076.756777670937, -7316.462671076454, -6556.953830716542, -6281.419255992978, -7726.450182593189, -5446.178932518111, -5256.608469322858, -6489.015038605023, -9194.895179548457, -8497.652755559435, -8428.517476458394, -7662.498605509223, -478.15364499278445, -5002.311781295546, -4908.824483065916, -7947.419202586051, -5439.337802444379, -7917.285782483381, -10509.323247397731, -692.7340094526226, -8595.700377335663, -4460.209613745744, -9012.72514600361, -1977.921852884013, -1122.0540957108801, -8050.623622576864, -5826.7771672769, -5378.121128680513, -1056.3419543666832, -6019.830298606366, -5866.661754904935, -8820.602652429054, -8549.340583952087, -4126.762246861559, -5864.82324425939, -9880.719465965609, -804.2203917460795, -10460.755418592049, -7371.767189627409, -4079.273200618035, -5727.881587816958, -5072.6092003774065, -9409.18623972478, -5642.036614190907, -9310.0454881544, -3055.1679526284333, -5308.622542127949, -9265.873085174588, -10839.24029855183, -5778.301461277358, -7147.327978774941, -1599.2226616406692, -8902.374273647281, -6440.122117719751, -7140.477239013295, -3597.107570807494, -4032.1747609319864, -4346.672198084995, -5821.730970530255, -5551.563340786858, -2868.907571686458], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 197, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 72, 200, 187, 200, 102, 55, 200, 200, 200, 87, 196, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 143, 190, 200, 200, 200], "policy_agent_policy_reward": [3346.5145329120114, 7139.590253577572, 2179.662937140686, 3776.9137044072063, 3381.2495542340757, 1993.5130513512486, 2374.374214175128, 3509.484624399772, 4243.831100993711, 2936.5803400467444, 2867.969151255386, 3711.6447718497134, 1889.4983378898955, 4119.646769065881, 2970.330867652546, 3171.5245366740655, 5398.088760882434, 1587.4413422708503, 4077.555825188072, 1734.3550206071677, 3547.6852491812974, 4729.204134855259, 7441.326223559936, 2997.7183780411674, 3991.539025298783, 2072.510942067531, 2522.4008043741915, 538.052211757274, 2365.9363695693587, 3218.706066801458, 4426.854797139255, 5100.671219880455, 6287.779868074842, 6485.07364868087, 2196.794391836557, 7009.046198715518, 10692.656982989518, 3298.617574736849, 1458.2462500352497, 5221.106851966019, 3666.7334146989797, 5160.612985923802, 5488.344682354776, 4929.709038192366, 3054.179554624884, 3698.830617879234, 2829.917598073208, 8356.913777691376, 7689.82731437203, 7343.1538459930525, 4637.98216952825, 194.6231379363052, 3651.346056732675, 3728.9965833719352, 6815.02548500771, 4252.221917231594, 3762.008877156563, 7820.319131695801, 249.48198522083237, 5386.100287860973, 2673.844519805357, 7977.1311907327245, 528.0965670540878, 376.8704466203095, 6888.682217912427, 5285.445567042216, 4974.429216159537, 572.9517287278497, 2282.8134340333854, 4490.940211803204, 7724.210400976285, 2748.401693125813, 2717.306995199013, 4512.599235816978, 5914.915253195542, 63.64249688516739, 9221.020643599295, 6748.906213217021, 1451.944896913852, 4418.484196835642, 3762.478129953951, 5524.714400067049, 1539.4151948944243, 3691.302748365226, 1885.897589471317, 2315.9889969759874, 3096.577921452447, 8762.639549846866, 4635.328863602354, 4711.151110756002, 839.3255658434314, 6967.4706667083, 2643.430101774748, 2469.331364098321, 2420.501363270016, 1693.6493290089832, 2805.477395699817, 5105.804463730552, 4244.603774720473, 2427.775640223574], "policy_adversary_policy_reward": [-3997.6989934290064, -3659.1607682393906, -7157.058797923751, -8489.760786940655, -3567.5407400231475, -2181.2692325687026, -3954.1150947748715, -5625.320938250216, -3381.2495542340757, -5098.4112113199435, -7531.299734314275, -1993.5130513512486, -2374.374214175128, -6153.956426675635, -4913.794527528882, -3509.484624399772, -7539.949021045141, -4243.831100993711, -2945.406347912618, -3856.26517109751, -3278.507169732071, -3281.644585624454, -4912.371451089228, -3932.6707754713384, -4834.7968250505555, -1889.4983378898955, -4119.646769065881, -8977.35661288302, -2970.330867652546, -3985.1590636108267, -3171.5245366740655, -7168.842263709068, -5623.724008043514, -6234.560102691443, -2869.6856599218363, -1673.3185437308825, -4077.555825188072, -6163.482775288289, -4083.15316933059, -1734.3550206071677, -6003.672261332764, -3706.4575813191714, -4729.204134855259, -6868.995803340543, -8351.826613875295, -7644.005860717914, -3012.970591154511, -5600.291153898809, -3999.022739412573, -4913.480358215931, -2072.510942067531, -4442.291590318811, -3102.8650450570517, -3794.5767820105625, -538.052211757274, -2849.354787161151, -8931.83856213238, -2365.9363695693587, -3218.9952875105528, -5124.829604714657, -5607.024420064165, -4461.013173596546, -7350.539763161679, -5115.479872161006, -6287.779868074842, -9918.227121208693, -7227.117731607631, -6488.277800474149, -8888.266588793993, -2196.794391836557, -7009.046198715518, -8455.427529983543, -10704.734932231348, -11865.024894791026, -5314.2605531546005, -4241.486830668246, -1458.2462500352497, -7217.431726452575, -5917.283489690592, -5380.5801399463635, -3666.7334146989797, -7316.462671076454, -6438.810391463773, -5278.756425176572, -6155.183594325672, -5614.580344022082, -7726.450182593188, -4929.709038192366, -3054.179554624884, -5446.178932518111, -4925.010816054057, -4030.428271148024, -6489.015038605023, -2829.917598073208, -9093.009656902494, -8458.799300337341, -8182.002746460204, -8005.477323471264, -8428.517476458394, -7343.1538459930525, -7654.0966417112895, -4646.3841333261835, -197.71502474934093, -475.0617581797487, -3658.7719983992642, -4994.885839628957, -4474.824427977535, -4162.996638460314, -7872.942830034027, -6889.501857559733, -5097.309792826515, -4594.249926849454, -7917.285782483381, -3762.008877156563, -7820.319131695801, -10509.323247397731, -692.6121961971645, -249.60379847629025, -5386.100287860973, -8595.700377335663, -4456.407730030437, -2677.646403520658, -9012.72514600361, -7977.1311907327245, -528.0965670540878, -1977.921852884013, -376.8704466203095, -1122.0540957108801, -7896.829754939303, -7042.476085549987, -5603.941019291166, -5508.281715027946, -5069.915572082795, -5282.634772757254, -1002.7129803041315, -626.5807027904018, -2282.8134340333854, -6019.830298606366, -5483.760114369591, -4873.841852338554, -8365.797152194698, -8179.015901210648, -8549.340583952086, -2748.401693125813, -4112.585349714025, -2731.483892346547, -4523.05376651024, -5854.368713566127, -9880.71946596561, -5914.915253195542, -63.64249688516739, -804.2203917460795, -10336.775069813406, -9345.000992377938, -6863.826403012587, -7256.8469998318415, -1451.944896913852, -4079.273200618035, -5034.348779321472, -5112.017005331131, -5072.609200377406, -3762.478129953951, -5524.714400067049, -9409.18623972478, -5642.036614190907, -1539.4151948944243, -9310.0454881544, -3691.302748365226, -1886.7262142283307, -3054.3393278714198, -2315.9889969759874, -5308.622542127949, -9265.87308517459, -3096.577921452447, -8766.626008782372, -10835.253839616324, -4657.209433555467, -5756.420891324246, -4711.151110756002, -7147.327978774942, -1576.466683815246, -862.0815436688553, -7507.829970810907, -8362.014969544683, -2643.430101774748, -6440.122117719751, -2469.331364098321, -7140.477239013295, -2933.468328888386, -3084.1406051891177, -1864.3548925413259, -3861.4691973996437, -2818.616987356314, -4333.532606428497, -5105.804463730552, -5821.730970530255, -4244.603774720473, -5551.563340786858, -2788.80570816082, -2507.877503749213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3967171198029107, "mean_inference_ms": 0.9669807327621168, "mean_action_processing_ms": 0.16664255261348562, "mean_env_wait_ms": 0.050988496765986845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032328367233276367, "StateBufferConnector_ms": 0.0023289918899536133, "ViewRequirementAgentConnector_ms": 0.06419253349304199}, "num_episodes": 22, "episode_return_max": -478.15364499278445, "episode_return_min": -11877.10284403286, "episode_return_mean": -6134.530882827984}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.1016438167894, "num_env_steps_trained_throughput_per_sec": 551.1016438167894, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 7426.649, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7426.616, "sample_time_ms": 807.213, "learn_time_ms": 6607.397, "learn_throughput": 605.382, "synch_weights_time_ms": 11.522}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 168, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-24", "timestamp": 1723232844, "time_this_iter_s": 7.261943101882935, "time_total_s": 1252.8223326206207, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3223dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1252.8223326206207, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 24.55454545454546, "ram_util_percent": 81.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0236983037243286, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.989021612207095, "policy_loss": -0.006858794099146811, "vf_loss": 9.991538393497468, "vf_explained_var": -0.00403394674261411, "kl": 0.007419998088638143, "entropy": 1.3548557446648677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9800643389344846, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99753666226826, "policy_loss": 0.000925366826251977, "vf_loss": 9.993162847448279, "vf_explained_var": -0.00026298679371990224, "kl": 0.012109744807498322, "entropy": 1.18294412250872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "env_runners": {"episode_reward_max": -13.7647256552146, "episode_reward_min": -12028.984198063652, "episode_reward_mean": -6327.200824397501, "episode_len_mean": 184.72, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18472, "policy_reward_min": {"agent_policy": 0.9760963246880292, "adversary_policy": -11865.024894791026}, "policy_reward_max": {"agent_policy": 11468.746966847179, "adversary_policy": -0.9760963246880292}, "policy_reward_mean": {"agent_policy": 4311.993720147876, "adversary_policy": -5319.597272272688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6162.444593470636, -6868.995803340543, -8554.506251033275, -5615.543367012153, -4920.964072329722, -4442.291590318811, -4375.0410226934255, -2849.354787161151, -8931.83856213238, -5125.118825423751, -5641.182796521454, -7365.34841544223, -9918.227121208693, -7230.321883400911, -8888.266588793993, -8455.427529983543, -11877.10284403286, -6257.1298090860055, -7217.431726452575, -6076.756777670937, -7316.462671076454, -6556.953830716542, -6281.419255992978, -7726.450182593189, -5446.178932518111, -5256.608469322858, -6489.015038605023, -9194.895179548457, -8497.652755559435, -8428.517476458394, -7662.498605509223, -478.15364499278445, -5002.311781295546, -4908.824483065916, -7947.419202586051, -5439.337802444379, -7917.285782483381, -10509.323247397731, -692.7340094526226, -8595.700377335663, -4460.209613745744, -9012.72514600361, -1977.921852884013, -1122.0540957108801, -8050.623622576864, -5826.7771672769, -5378.121128680513, -1056.3419543666832, -6019.830298606366, -5866.661754904935, -8820.602652429054, -8549.340583952087, -4126.762246861559, -5864.82324425939, -9880.719465965609, -804.2203917460795, -10460.755418592049, -7371.767189627409, -4079.273200618035, -5727.881587816958, -5072.6092003774065, -9409.18623972478, -5642.036614190907, -9310.0454881544, -3055.1679526284333, -5308.622542127949, -9265.873085174588, -10839.24029855183, -5778.301461277358, -7147.327978774941, -1599.2226616406692, -8902.374273647281, -6440.122117719751, -7140.477239013295, -3597.107570807494, -4032.1747609319864, -4346.672198084995, -5821.730970530255, -5551.563340786858, -2868.907571686458, -6513.183937405959, -7128.789901776167, -9151.924350786183, -7884.088357597065, -11021.180855939821, -5306.1911029249495, -9601.733964634443, -3625.094330245803, -8331.382565834032, -9494.193612863617, -2225.6344236928653, -3333.8939323712593, -4816.09625464475, -3469.600603119198, -12028.984198063652, -9203.22804094332, -6198.415216593019, -9552.996655627863, -1112.4921301107872, -13.7647256552146], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 197, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 72, 200, 187, 200, 102, 55, 200, 200, 200, 87, 196, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 143, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 86, 200, 200, 200, 200, 200, 200, 200, 111, 1], "policy_agent_policy_reward": [3547.6852491812974, 4729.204134855259, 7441.326223559936, 2997.7183780411674, 3991.539025298783, 2072.510942067531, 2522.4008043741915, 538.052211757274, 2365.9363695693587, 3218.706066801458, 4426.854797139255, 5100.671219880455, 6287.779868074842, 6485.07364868087, 2196.794391836557, 7009.046198715518, 10692.656982989518, 3298.617574736849, 1458.2462500352497, 5221.106851966019, 3666.7334146989797, 5160.612985923802, 5488.344682354776, 4929.709038192366, 3054.179554624884, 3698.830617879234, 2829.917598073208, 8356.913777691376, 7689.82731437203, 7343.1538459930525, 4637.98216952825, 194.6231379363052, 3651.346056732675, 3728.9965833719352, 6815.02548500771, 4252.221917231594, 3762.008877156563, 7820.319131695801, 249.48198522083237, 5386.100287860973, 2673.844519805357, 7977.1311907327245, 528.0965670540878, 376.8704466203095, 6888.682217912427, 5285.445567042216, 4974.429216159537, 572.9517287278497, 2282.8134340333854, 4490.940211803204, 7724.210400976285, 2748.401693125813, 2717.306995199013, 4512.599235816978, 5914.915253195542, 63.64249688516739, 9221.020643599295, 6748.906213217021, 1451.944896913852, 4418.484196835642, 3762.478129953951, 5524.714400067049, 1539.4151948944243, 3691.302748365226, 1885.897589471317, 2315.9889969759874, 3096.577921452447, 8762.639549846866, 4635.328863602354, 4711.151110756002, 839.3255658434314, 6967.4706667083, 2643.430101774748, 2469.331364098321, 2420.501363270016, 1693.6493290089832, 2805.477395699817, 5105.804463730552, 4244.603774720473, 2427.775640223574, 6105.78662773229, 1421.4437730881887, 8417.64639250161, 7062.473786327982, 10159.341391483535, 2546.485417987717, 3447.261730663351, 2923.7843787563797, 6797.508348788389, 8433.23889888708, 1136.7352138793085, 2821.174536773573, 3173.9142945367103, 2944.7764529754563, 11468.746966847179, 7924.852772086195, 3767.746873951578, 8741.4677089665, 470.2534050025717, 0.9760963246880292], "policy_adversary_policy_reward": [-6003.672261332764, -3706.4575813191714, -4729.204134855259, -6868.995803340543, -8351.826613875295, -7644.005860717914, -3012.970591154511, -5600.291153898809, -3999.022739412573, -4913.480358215931, -2072.510942067531, -4442.291590318811, -3102.8650450570517, -3794.5767820105625, -538.052211757274, -2849.354787161151, -8931.83856213238, -2365.9363695693587, -3218.9952875105528, -5124.829604714657, -5607.024420064165, -4461.013173596546, -7350.539763161679, -5115.479872161006, -6287.779868074842, -9918.227121208693, -7227.117731607631, -6488.277800474149, -8888.266588793993, -2196.794391836557, -7009.046198715518, -8455.427529983543, -10704.734932231348, -11865.024894791026, -5314.2605531546005, -4241.486830668246, -1458.2462500352497, -7217.431726452575, -5917.283489690592, -5380.5801399463635, -3666.7334146989797, -7316.462671076454, -6438.810391463773, -5278.756425176572, -6155.183594325672, -5614.580344022082, -7726.450182593188, -4929.709038192366, -3054.179554624884, -5446.178932518111, -4925.010816054057, -4030.428271148024, -6489.015038605023, -2829.917598073208, -9093.009656902494, -8458.799300337341, -8182.002746460204, -8005.477323471264, -8428.517476458394, -7343.1538459930525, -7654.0966417112895, -4646.3841333261835, -197.71502474934093, -475.0617581797487, -3658.7719983992642, -4994.885839628957, -4474.824427977535, -4162.996638460314, -7872.942830034027, -6889.501857559733, -5097.309792826515, -4594.249926849454, -7917.285782483381, -3762.008877156563, -7820.319131695801, -10509.323247397731, -692.6121961971645, -249.60379847629025, -5386.100287860973, -8595.700377335663, -4456.407730030437, -2677.646403520658, -9012.72514600361, -7977.1311907327245, -528.0965670540878, -1977.921852884013, -376.8704466203095, -1122.0540957108801, -7896.829754939303, -7042.476085549987, -5603.941019291166, -5508.281715027946, -5069.915572082795, -5282.634772757254, -1002.7129803041315, -626.5807027904018, -2282.8134340333854, -6019.830298606366, -5483.760114369591, -4873.841852338554, -8365.797152194698, -8179.015901210648, -8549.340583952086, -2748.401693125813, -4112.585349714025, -2731.483892346547, -4523.05376651024, -5854.368713566127, -9880.71946596561, -5914.915253195542, -63.64249688516739, -804.2203917460795, -10336.775069813406, -9345.000992377938, -6863.826403012587, -7256.8469998318415, -1451.944896913852, -4079.273200618035, -5034.348779321472, -5112.017005331131, -5072.609200377406, -3762.478129953951, -5524.714400067049, -9409.18623972478, -5642.036614190907, -1539.4151948944243, -9310.0454881544, -3691.302748365226, -1886.7262142283307, -3054.3393278714198, -2315.9889969759874, -5308.622542127949, -9265.87308517459, -3096.577921452447, -8766.626008782372, -10835.253839616324, -4657.209433555467, -5756.420891324246, -4711.151110756002, -7147.327978774942, -1576.466683815246, -862.0815436688553, -7507.829970810907, -8362.014969544683, -2643.430101774748, -6440.122117719751, -2469.331364098321, -7140.477239013295, -2933.468328888386, -3084.1406051891177, -1864.3548925413259, -3861.4691973996437, -2818.616987356314, -4333.532606428497, -5105.804463730552, -5821.730970530255, -4244.603774720473, -5551.563340786858, -2788.80570816082, -2507.877503749213, -6382.851924537223, -6236.118640601027, -7102.705046271953, -1447.5286285924074, -8658.26311250937, -8911.307630778427, -7613.582244039516, -7332.979899885527, -10213.185750921984, -10967.336496501373, -4962.952566011421, -2889.7239549012443, -9601.733964634443, -3447.261730663351, -3604.6034458163113, -2944.2752631858716, -8322.095823290252, -6806.79509133217, -8485.647349622786, -9441.78516212791, -1139.6352477952628, -2222.734389776911, -3056.5801935854843, -3098.488275559343, -3422.876974887205, -4567.133574294259, -2971.1511105279283, -3443.225945566726, -11688.23537851965, -11809.495786391179, -9203.228040943322, -7924.852772086195, -3852.896863068726, -6113.265227475871, -8962.884974009972, -9331.57939058439, -1043.8914154923286, -538.8541196210314, -13.7647256552146, -0.9760963246880292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3965932215489572, "mean_inference_ms": 0.967425312271769, "mean_action_processing_ms": 0.16657456781993488, "mean_env_wait_ms": 0.050936527193218485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262758255004883, "StateBufferConnector_ms": 0.00235593318939209, "ViewRequirementAgentConnector_ms": 0.06478524208068848}, "num_episodes": 20, "episode_return_max": -13.7647256552146, "episode_return_min": -12028.984198063652, "episode_return_mean": -6327.200824397501}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.05683224660424, "num_env_steps_trained_throughput_per_sec": 503.05683224660424, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2028000, "timers": {"training_iteration_time_ms": 7484.8, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7484.767, "sample_time_ms": 818.224, "learn_time_ms": 6654.55, "learn_throughput": 601.092, "synch_weights_time_ms": 11.508}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "done": false, "training_iteration": 169, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-32", "timestamp": 1723232852, "time_this_iter_s": 7.9560158252716064, "time_total_s": 1260.7783484458923, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a0d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1260.7783484458923, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 31.33333333333333, "ram_util_percent": 82.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.086045197273294, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.984343599279722, "policy_loss": -0.006623536684977201, "vf_loss": 9.986714119712511, "vf_explained_var": -0.003429829018811385, "kl": 0.007267872009591277, "entropy": 1.3910980720072985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9975480833381573, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991892077430846, "policy_loss": -0.00349503937473018, "vf_loss": 9.992206054263645, "vf_explained_var": -0.00010275610540279006, "kl": 0.01117083338118853, "entropy": 1.2083187201035717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": -13.7647256552146, "episode_reward_min": -12365.754752763285, "episode_reward_mean": -6379.916870727017, "episode_len_mean": 180.56, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18056, "policy_reward_min": {"agent_policy": 0.9760963246880292, "adversary_policy": -12365.754752763285}, "policy_reward_max": {"agent_policy": 11468.746966847179, "adversary_policy": -0.9760963246880292}, "policy_reward_mean": {"agent_policy": 4393.432721587535, "adversary_policy": -5386.674796157276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7726.450182593189, -5446.178932518111, -5256.608469322858, -6489.015038605023, -9194.895179548457, -8497.652755559435, -8428.517476458394, -7662.498605509223, -478.15364499278445, -5002.311781295546, -4908.824483065916, -7947.419202586051, -5439.337802444379, -7917.285782483381, -10509.323247397731, -692.7340094526226, -8595.700377335663, -4460.209613745744, -9012.72514600361, -1977.921852884013, -1122.0540957108801, -8050.623622576864, -5826.7771672769, -5378.121128680513, -1056.3419543666832, -6019.830298606366, -5866.661754904935, -8820.602652429054, -8549.340583952087, -4126.762246861559, -5864.82324425939, -9880.719465965609, -804.2203917460795, -10460.755418592049, -7371.767189627409, -4079.273200618035, -5727.881587816958, -5072.6092003774065, -9409.18623972478, -5642.036614190907, -9310.0454881544, -3055.1679526284333, -5308.622542127949, -9265.873085174588, -10839.24029855183, -5778.301461277358, -7147.327978774941, -1599.2226616406692, -8902.374273647281, -6440.122117719751, -7140.477239013295, -3597.107570807494, -4032.1747609319864, -4346.672198084995, -5821.730970530255, -5551.563340786858, -2868.907571686458, -6513.183937405959, -7128.789901776167, -9151.924350786183, -7884.088357597065, -11021.180855939821, -5306.1911029249495, -9601.733964634443, -3625.094330245803, -8331.382565834032, -9494.193612863617, -2225.6344236928653, -3333.8939323712593, -4816.09625464475, -3469.600603119198, -12028.984198063652, -9203.22804094332, -6198.415216593019, -9552.996655627863, -1112.4921301107872, -13.7647256552146, -6947.273036517681, -9835.50284793121, -5376.023781416727, -4897.2011597418295, -7445.328802790638, -8770.612976662469, -7563.608964854018, -6280.446249340909, -9560.76109538693, -4341.880912992664, -1684.1562789656452, -9369.462665700035, -8032.670205775245, -5672.066750195593, -9444.885730220509, -12365.754752763285, -9049.980216373518, -2864.061803194913, -9616.52764666872, -522.9205766390335, -3593.7173438245454, -9530.475745260306, -9434.415215030307], "episode_lengths": [200, 200, 200, 197, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 72, 200, 187, 200, 102, 55, 200, 200, 200, 87, 196, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 143, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 86, 200, 200, 200, 200, 200, 200, 200, 111, 1, 200, 200, 200, 141, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 76, 200, 14, 200, 200, 200], "policy_agent_policy_reward": [4929.709038192366, 3054.179554624884, 3698.830617879234, 2829.917598073208, 8356.913777691376, 7689.82731437203, 7343.1538459930525, 4637.98216952825, 194.6231379363052, 3651.346056732675, 3728.9965833719352, 6815.02548500771, 4252.221917231594, 3762.008877156563, 7820.319131695801, 249.48198522083237, 5386.100287860973, 2673.844519805357, 7977.1311907327245, 528.0965670540878, 376.8704466203095, 6888.682217912427, 5285.445567042216, 4974.429216159537, 572.9517287278497, 2282.8134340333854, 4490.940211803204, 7724.210400976285, 2748.401693125813, 2717.306995199013, 4512.599235816978, 5914.915253195542, 63.64249688516739, 9221.020643599295, 6748.906213217021, 1451.944896913852, 4418.484196835642, 3762.478129953951, 5524.714400067049, 1539.4151948944243, 3691.302748365226, 1885.897589471317, 2315.9889969759874, 3096.577921452447, 8762.639549846866, 4635.328863602354, 4711.151110756002, 839.3255658434314, 6967.4706667083, 2643.430101774748, 2469.331364098321, 2420.501363270016, 1693.6493290089832, 2805.477395699817, 5105.804463730552, 4244.603774720473, 2427.775640223574, 6105.78662773229, 1421.4437730881887, 8417.64639250161, 7062.473786327982, 10159.341391483535, 2546.485417987717, 3447.261730663351, 2923.7843787563797, 6797.508348788389, 8433.23889888708, 1136.7352138793085, 2821.174536773573, 3173.9142945367103, 2944.7764529754563, 11468.746966847179, 7924.852772086195, 3767.746873951578, 8741.4677089665, 470.2534050025717, 0.9760963246880292, 6595.317728312979, 3552.3687087140756, 4918.878312807845, 1282.1245866714228, 4486.99701979564, 7628.355432854406, 4235.270204917161, 2941.480076923447, 4133.5415973090685, 2899.2366049264365, 161.20600052041453, 5257.835116153446, 5513.163253549601, 3092.963579351357, 8644.303683718059, 9742.582394673462, 3920.8143996896197, 359.6124847280993, 8477.061638567055, 47.04623322480742, 2781.003772542205, 8690.926406997138, 8699.429179557044], "policy_adversary_policy_reward": [-7726.450182593188, -4929.709038192366, -3054.179554624884, -5446.178932518111, -4925.010816054057, -4030.428271148024, -6489.015038605023, -2829.917598073208, -9093.009656902494, -8458.799300337341, -8182.002746460204, -8005.477323471264, -8428.517476458394, -7343.1538459930525, -7654.0966417112895, -4646.3841333261835, -197.71502474934093, -475.0617581797487, -3658.7719983992642, -4994.885839628957, -4474.824427977535, -4162.996638460314, -7872.942830034027, -6889.501857559733, -5097.309792826515, -4594.249926849454, -7917.285782483381, -3762.008877156563, -7820.319131695801, -10509.323247397731, -692.6121961971645, -249.60379847629025, -5386.100287860973, -8595.700377335663, -4456.407730030437, -2677.646403520658, -9012.72514600361, -7977.1311907327245, -528.0965670540878, -1977.921852884013, -376.8704466203095, -1122.0540957108801, -7896.829754939303, -7042.476085549987, -5603.941019291166, -5508.281715027946, -5069.915572082795, -5282.634772757254, -1002.7129803041315, -626.5807027904018, -2282.8134340333854, -6019.830298606366, -5483.760114369591, -4873.841852338554, -8365.797152194698, -8179.015901210648, -8549.340583952086, -2748.401693125813, -4112.585349714025, -2731.483892346547, -4523.05376651024, -5854.368713566127, -9880.71946596561, -5914.915253195542, -63.64249688516739, -804.2203917460795, -10336.775069813406, -9345.000992377938, -6863.826403012587, -7256.8469998318415, -1451.944896913852, -4079.273200618035, -5034.348779321472, -5112.017005331131, -5072.609200377406, -3762.478129953951, -5524.714400067049, -9409.18623972478, -5642.036614190907, -1539.4151948944243, -9310.0454881544, -3691.302748365226, -1886.7262142283307, -3054.3393278714198, -2315.9889969759874, -5308.622542127949, -9265.87308517459, -3096.577921452447, -8766.626008782372, -10835.253839616324, -4657.209433555467, -5756.420891324246, -4711.151110756002, -7147.327978774942, -1576.466683815246, -862.0815436688553, -7507.829970810907, -8362.014969544683, -2643.430101774748, -6440.122117719751, -2469.331364098321, -7140.477239013295, -2933.468328888386, -3084.1406051891177, -1864.3548925413259, -3861.4691973996437, -2818.616987356314, -4333.532606428497, -5105.804463730552, -5821.730970530255, -4244.603774720473, -5551.563340786858, -2788.80570816082, -2507.877503749213, -6382.851924537223, -6236.118640601027, -7102.705046271953, -1447.5286285924074, -8658.26311250937, -8911.307630778427, -7613.582244039516, -7332.979899885527, -10213.185750921984, -10967.336496501373, -4962.952566011421, -2889.7239549012443, -9601.733964634443, -3447.261730663351, -3604.6034458163113, -2944.2752631858716, -8322.095823290252, -6806.79509133217, -8485.647349622786, -9441.78516212791, -1139.6352477952628, -2222.734389776911, -3056.5801935854843, -3098.488275559343, -3422.876974887205, -4567.133574294259, -2971.1511105279283, -3443.225945566726, -11688.23537851965, -11809.495786391179, -9203.228040943322, -7924.852772086195, -3852.896863068726, -6113.265227475871, -8962.884974009972, -9331.57939058439, -1043.8914154923286, -538.8541196210314, -13.7647256552146, -0.9760963246880292, -6846.306925893963, -6696.283838936697, -3552.3687087140756, -9835.50284793121, -5352.984959891705, -4941.917134332867, -1282.1245866714228, -4897.2011597418295, -4486.99701979564, -7445.328802790637, -7993.693910150359, -8405.274499366515, -7563.608964854018, -4235.270204917161, -5213.2150754828535, -4008.711250781507, -4133.5415973090685, -9560.76109538693, -3030.386132665546, -4210.731385253554, -161.20600052041453, -1684.1562789656452, -9369.462665700034, -5257.835116153446, -5531.6467436409175, -8014.18671568393, -3092.963579351357, -5672.066750195593, -9064.521033909348, -9024.668380029221, -12365.754752763285, -9742.582394673462, -9049.98021637352, -3920.8143996896197, -359.6124847280993, -2864.061803194913, -9616.023671659808, -8477.565613575965, -522.9205766390336, -47.04623322480742, -2788.9882849002156, -3585.7328314665347, -9349.095835672046, -8872.306316585398, -9140.102255252988, -8993.742139334377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39664366388403477, "mean_inference_ms": 0.9657244535562859, "mean_action_processing_ms": 0.16654860826037654, "mean_env_wait_ms": 0.05096369544893186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032949447631835938, "StateBufferConnector_ms": 0.0023664236068725586, "ViewRequirementAgentConnector_ms": 0.06660497188568115}, "num_episodes": 23, "episode_return_max": -13.7647256552146, "episode_return_min": -12365.754752763285, "episode_return_mean": -6379.916870727017}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.4111456928573, "num_env_steps_trained_throughput_per_sec": 546.4111456928573, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 7442.106, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7442.073, "sample_time_ms": 817.596, "learn_time_ms": 6612.666, "learn_throughput": 604.9, "synch_weights_time_ms": 11.34}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 170, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-40", "timestamp": 1723232860, "time_this_iter_s": 7.325263261795044, "time_total_s": 1268.1036117076874, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a0dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1268.1036117076874, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 27.939999999999998, "ram_util_percent": 82.28999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0283852893548706, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987227433919907, "policy_loss": -0.0045382926929354046, "vf_loss": 9.98783929546674, "vf_explained_var": -0.004508237726986409, "kl": 0.00670980726548199, "entropy": 1.3888414671023688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9588049150727413, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988328456374072, "policy_loss": -0.00633965871203198, "vf_loss": 9.990923876989456, "vf_explained_var": 0.00045096874237060547, "kl": 0.013148461204889432, "entropy": 1.1691633348111754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "env_runners": {"episode_reward_max": -13.7647256552146, "episode_reward_min": -12365.754752763285, "episode_reward_mean": -6453.9090692765985, "episode_len_mean": 180.37, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18037, "policy_reward_min": {"agent_policy": 0.9760963246880292, "adversary_policy": -12365.754752763285}, "policy_reward_max": {"agent_policy": 11468.746966847179, "adversary_policy": -0.9760963246880292}, "policy_reward_mean": {"agent_policy": 4500.9761153149, "adversary_policy": -5477.442592295751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5378.121128680513, -1056.3419543666832, -6019.830298606366, -5866.661754904935, -8820.602652429054, -8549.340583952087, -4126.762246861559, -5864.82324425939, -9880.719465965609, -804.2203917460795, -10460.755418592049, -7371.767189627409, -4079.273200618035, -5727.881587816958, -5072.6092003774065, -9409.18623972478, -5642.036614190907, -9310.0454881544, -3055.1679526284333, -5308.622542127949, -9265.873085174588, -10839.24029855183, -5778.301461277358, -7147.327978774941, -1599.2226616406692, -8902.374273647281, -6440.122117719751, -7140.477239013295, -3597.107570807494, -4032.1747609319864, -4346.672198084995, -5821.730970530255, -5551.563340786858, -2868.907571686458, -6513.183937405959, -7128.789901776167, -9151.924350786183, -7884.088357597065, -11021.180855939821, -5306.1911029249495, -9601.733964634443, -3625.094330245803, -8331.382565834032, -9494.193612863617, -2225.6344236928653, -3333.8939323712593, -4816.09625464475, -3469.600603119198, -12028.984198063652, -9203.22804094332, -6198.415216593019, -9552.996655627863, -1112.4921301107872, -13.7647256552146, -6947.273036517681, -9835.50284793121, -5376.023781416727, -4897.2011597418295, -7445.328802790638, -8770.612976662469, -7563.608964854018, -6280.446249340909, -9560.76109538693, -4341.880912992664, -1684.1562789656452, -9369.462665700035, -8032.670205775245, -5672.066750195593, -9444.885730220509, -12365.754752763285, -9049.980216373518, -2864.061803194913, -9616.52764666872, -522.9205766390335, -3593.7173438245454, -9530.475745260306, -9434.415215030307, -4642.59778080635, -10310.506341192124, -3250.157053996438, -5538.570844903227, -185.7165756752249, -10258.903391605721, -4434.202921194302, -5588.819784425539, -6800.492701067978, -868.2376040215275, -11238.732336787178, -9635.144746003685, -50.113058968630156, -5877.70200206197, -5618.6887737437755, -6172.866426281156, -5659.2417796236905, -9625.34444685595, -8479.172288496944, -9887.70634530403, -4604.303525649382, -9259.518336585605, -10055.699259074388], "episode_lengths": [200, 87, 196, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 143, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 86, 200, 200, 200, 200, 200, 200, 200, 111, 1, 200, 200, 200, 141, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 76, 200, 14, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 27, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4974.429216159537, 572.9517287278497, 2282.8134340333854, 4490.940211803204, 7724.210400976285, 2748.401693125813, 2717.306995199013, 4512.599235816978, 5914.915253195542, 63.64249688516739, 9221.020643599295, 6748.906213217021, 1451.944896913852, 4418.484196835642, 3762.478129953951, 5524.714400067049, 1539.4151948944243, 3691.302748365226, 1885.897589471317, 2315.9889969759874, 3096.577921452447, 8762.639549846866, 4635.328863602354, 4711.151110756002, 839.3255658434314, 6967.4706667083, 2643.430101774748, 2469.331364098321, 2420.501363270016, 1693.6493290089832, 2805.477395699817, 5105.804463730552, 4244.603774720473, 2427.775640223574, 6105.78662773229, 1421.4437730881887, 8417.64639250161, 7062.473786327982, 10159.341391483535, 2546.485417987717, 3447.261730663351, 2923.7843787563797, 6797.508348788389, 8433.23889888708, 1136.7352138793085, 2821.174536773573, 3173.9142945367103, 2944.7764529754563, 11468.746966847179, 7924.852772086195, 3767.746873951578, 8741.4677089665, 470.2534050025717, 0.9760963246880292, 6595.317728312979, 3552.3687087140756, 4918.878312807845, 1282.1245866714228, 4486.99701979564, 7628.355432854406, 4235.270204917161, 2941.480076923447, 4133.5415973090685, 2899.2366049264365, 161.20600052041453, 5257.835116153446, 5513.163253549601, 3092.963579351357, 8644.303683718059, 9742.582394673462, 3920.8143996896197, 359.6124847280993, 8477.061638567055, 47.04623322480742, 2781.003772542205, 8690.926406997138, 8699.429179557044, 2547.5562627795257, 9740.173877951685, 2232.909898517999, 2074.3118662258566, 51.71260939849494, 9688.369460604714, 2686.211622604102, 4664.991408513583, 6311.9873605623225, 117.91499133180203, 8427.92397820539, 8777.156994652743, 5.547691129553365, 5436.9078428610455, 2862.2761515645498, 5870.656100939602, 3011.4588676641524, 7383.7099609238985, 7833.993379112957, 6510.720778592675, 3989.3025198154432, 7332.52180718239, 5326.7318293380795], "policy_adversary_policy_reward": [-5069.915572082795, -5282.634772757254, -1002.7129803041315, -626.5807027904018, -2282.8134340333854, -6019.830298606366, -5483.760114369591, -4873.841852338554, -8365.797152194698, -8179.015901210648, -8549.340583952086, -2748.401693125813, -4112.585349714025, -2731.483892346547, -4523.05376651024, -5854.368713566127, -9880.71946596561, -5914.915253195542, -63.64249688516739, -804.2203917460795, -10336.775069813406, -9345.000992377938, -6863.826403012587, -7256.8469998318415, -1451.944896913852, -4079.273200618035, -5034.348779321472, -5112.017005331131, -5072.609200377406, -3762.478129953951, -5524.714400067049, -9409.18623972478, -5642.036614190907, -1539.4151948944243, -9310.0454881544, -3691.302748365226, -1886.7262142283307, -3054.3393278714198, -2315.9889969759874, -5308.622542127949, -9265.87308517459, -3096.577921452447, -8766.626008782372, -10835.253839616324, -4657.209433555467, -5756.420891324246, -4711.151110756002, -7147.327978774942, -1576.466683815246, -862.0815436688553, -7507.829970810907, -8362.014969544683, -2643.430101774748, -6440.122117719751, -2469.331364098321, -7140.477239013295, -2933.468328888386, -3084.1406051891177, -1864.3548925413259, -3861.4691973996437, -2818.616987356314, -4333.532606428497, -5105.804463730552, -5821.730970530255, -4244.603774720473, -5551.563340786858, -2788.80570816082, -2507.877503749213, -6382.851924537223, -6236.118640601027, -7102.705046271953, -1447.5286285924074, -8658.26311250937, -8911.307630778427, -7613.582244039516, -7332.979899885527, -10213.185750921984, -10967.336496501373, -4962.952566011421, -2889.7239549012443, -9601.733964634443, -3447.261730663351, -3604.6034458163113, -2944.2752631858716, -8322.095823290252, -6806.79509133217, -8485.647349622786, -9441.78516212791, -1139.6352477952628, -2222.734389776911, -3056.5801935854843, -3098.488275559343, -3422.876974887205, -4567.133574294259, -2971.1511105279283, -3443.225945566726, -11688.23537851965, -11809.495786391179, -9203.228040943322, -7924.852772086195, -3852.896863068726, -6113.265227475871, -8962.884974009972, -9331.57939058439, -1043.8914154923286, -538.8541196210314, -13.7647256552146, -0.9760963246880292, -6846.306925893963, -6696.283838936697, -3552.3687087140756, -9835.50284793121, -5352.984959891705, -4941.917134332867, -1282.1245866714228, -4897.2011597418295, -4486.99701979564, -7445.328802790637, -7993.693910150359, -8405.274499366515, -7563.608964854018, -4235.270204917161, -5213.2150754828535, -4008.711250781507, -4133.5415973090685, -9560.76109538693, -3030.386132665546, -4210.731385253554, -161.20600052041453, -1684.1562789656452, -9369.462665700034, -5257.835116153446, -5531.6467436409175, -8014.18671568393, -3092.963579351357, -5672.066750195593, -9064.521033909348, -9024.668380029221, -12365.754752763285, -9742.582394673462, -9049.98021637352, -3920.8143996896197, -359.6124847280993, -2864.061803194913, -9616.023671659808, -8477.565613575965, -522.9205766390336, -47.04623322480742, -2788.9882849002156, -3585.7328314665347, -9349.095835672046, -8872.306316585398, -9140.102255252988, -8993.742139334377, -4574.887690448817, -2615.2663531370536, -10038.797494449402, -10011.882724694417, -2233.4251139362505, -3249.6418385781867, -2074.3118662258566, -5538.570844903227, -51.71260939849494, -185.7165756752249, -10257.328318287953, -9689.94453392248, -2686.211622604102, -4434.202921194304, -4771.600976713309, -5482.210216225813, -6377.784115360476, -6734.695946269823, -868.2376040215277, -117.91499133180203, -8427.92397820539, -11238.732336787178, -8832.96415173684, -9579.337588919589, -50.11305896863016, -5.547691129553365, -5772.953030337725, -5541.656814585291, -5618.6887737437755, -2862.2761515645498, -6001.495161506566, -6042.02736571419, -3217.7277533017195, -5452.972893986121, -9625.34444685595, -7383.7099609238985, -8018.51326217465, -8294.65240543525, -9887.706345304032, -6510.720778592675, -4055.1176681115003, -4538.488377353322, -9259.518336585605, -7332.52180718239, -10055.69925907439, -5326.7318293380795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39665472787183903, "mean_inference_ms": 0.9649539256747842, "mean_action_processing_ms": 0.16656076525919208, "mean_env_wait_ms": 0.05098080122702852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003371119499206543, "StateBufferConnector_ms": 0.0024160146713256836, "ViewRequirementAgentConnector_ms": 0.06723678112030029}, "num_episodes": 23, "episode_return_max": -13.7647256552146, "episode_return_min": -12365.754752763285, "episode_return_mean": -6453.9090692765985}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 559.9372258943653, "num_env_steps_trained_throughput_per_sec": 559.9372258943653, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2052000, "timers": {"training_iteration_time_ms": 7405.123, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7405.091, "sample_time_ms": 796.669, "learn_time_ms": 6596.539, "learn_throughput": 606.379, "synch_weights_time_ms": 11.459}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "done": false, "training_iteration": 171, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-47", "timestamp": 1723232867, "time_this_iter_s": 7.148876190185547, "time_total_s": 1275.252487897873, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a0dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1275.252487897873, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 24.79090909090909, "ram_util_percent": 82.53636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9803443480593462, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993410698572795, "policy_loss": -0.0037729290896095337, "vf_loss": 9.992717562119166, "vf_explained_var": -0.004835231726368268, "kl": 0.007632019236916676, "entropy": 1.385069798057278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9515783856470118, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99610448413425, "policy_loss": -6.657816819531262e-05, "vf_loss": 9.9938503936485, "vf_explained_var": 0.0001975490302635879, "kl": 0.00814934666342442, "entropy": 1.1955044378679265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": -13.7647256552146, "episode_reward_min": -12365.754752763285, "episode_reward_mean": -6470.698626441505, "episode_len_mean": 179.03, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17903, "policy_reward_min": {"agent_policy": 0.9760963246880292, "adversary_policy": -12365.754752763285}, "policy_reward_max": {"agent_policy": 11468.746966847179, "adversary_policy": -0.9760963246880292}, "policy_reward_mean": {"agent_policy": 4620.287497798005, "adversary_policy": -5545.493062119755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5778.301461277358, -7147.327978774941, -1599.2226616406692, -8902.374273647281, -6440.122117719751, -7140.477239013295, -3597.107570807494, -4032.1747609319864, -4346.672198084995, -5821.730970530255, -5551.563340786858, -2868.907571686458, -6513.183937405959, -7128.789901776167, -9151.924350786183, -7884.088357597065, -11021.180855939821, -5306.1911029249495, -9601.733964634443, -3625.094330245803, -8331.382565834032, -9494.193612863617, -2225.6344236928653, -3333.8939323712593, -4816.09625464475, -3469.600603119198, -12028.984198063652, -9203.22804094332, -6198.415216593019, -9552.996655627863, -1112.4921301107872, -13.7647256552146, -6947.273036517681, -9835.50284793121, -5376.023781416727, -4897.2011597418295, -7445.328802790638, -8770.612976662469, -7563.608964854018, -6280.446249340909, -9560.76109538693, -4341.880912992664, -1684.1562789656452, -9369.462665700035, -8032.670205775245, -5672.066750195593, -9444.885730220509, -12365.754752763285, -9049.980216373518, -2864.061803194913, -9616.52764666872, -522.9205766390335, -3593.7173438245454, -9530.475745260306, -9434.415215030307, -4642.59778080635, -10310.506341192124, -3250.157053996438, -5538.570844903227, -185.7165756752249, -10258.903391605721, -4434.202921194302, -5588.819784425539, -6800.492701067978, -868.2376040215275, -11238.732336787178, -9635.144746003685, -50.113058968630156, -5877.70200206197, -5618.6887737437755, -6172.866426281156, -5659.2417796236905, -9625.34444685595, -8479.172288496944, -9887.70634530403, -4604.303525649382, -9259.518336585605, -10055.699259074388, -10848.11760228455, -6805.332370816672, -10378.19959161337, -1458.8391061024788, -6945.868280001823, -80.45472548503118, -10783.75785867438, -8599.105491788116, -1578.4094521310485, -6798.3290947944, -9111.262126936273, -6488.315219329758, -7723.873030159788, -6252.7725468739245, -9824.704541489427, -6541.206545939078, -7206.628890571358, -6585.080493323942, -6481.120028977711, -4091.964218227501, -7020.885917751519, -1984.6111225754628], "episode_lengths": [200, 200, 107, 200, 200, 200, 200, 143, 190, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 86, 200, 200, 200, 200, 200, 200, 200, 111, 1, 200, 200, 200, 141, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 76, 200, 14, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 27, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 3, 200, 200, 178, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 117], "policy_agent_policy_reward": [4635.328863602354, 4711.151110756002, 839.3255658434314, 6967.4706667083, 2643.430101774748, 2469.331364098321, 2420.501363270016, 1693.6493290089832, 2805.477395699817, 5105.804463730552, 4244.603774720473, 2427.775640223574, 6105.78662773229, 1421.4437730881887, 8417.64639250161, 7062.473786327982, 10159.341391483535, 2546.485417987717, 3447.261730663351, 2923.7843787563797, 6797.508348788389, 8433.23889888708, 1136.7352138793085, 2821.174536773573, 3173.9142945367103, 2944.7764529754563, 11468.746966847179, 7924.852772086195, 3767.746873951578, 8741.4677089665, 470.2534050025717, 0.9760963246880292, 6595.317728312979, 3552.3687087140756, 4918.878312807845, 1282.1245866714228, 4486.99701979564, 7628.355432854406, 4235.270204917161, 2941.480076923447, 4133.5415973090685, 2899.2366049264365, 161.20600052041453, 5257.835116153446, 5513.163253549601, 3092.963579351357, 8644.303683718059, 9742.582394673462, 3920.8143996896197, 359.6124847280993, 8477.061638567055, 47.04623322480742, 2781.003772542205, 8690.926406997138, 8699.429179557044, 2547.5562627795257, 9740.173877951685, 2232.909898517999, 2074.3118662258566, 51.71260939849494, 9688.369460604714, 2686.211622604102, 4664.991408513583, 6311.9873605623225, 117.91499133180203, 8427.92397820539, 8777.156994652743, 5.547691129553365, 5436.9078428610455, 2862.2761515645498, 5870.656100939602, 3011.4588676641524, 7383.7099609238985, 7833.993379112957, 6510.720778592675, 3989.3025198154432, 7332.52180718239, 5326.7318293380795, 7713.459464271731, 2101.6000508484453, 7685.018428406913, 233.05619403966068, 5718.146678846846, 5.053883262070466, 7934.558880470992, 4564.32344819935, 1058.0527242885983, 4832.526985234401, 5901.281369233055, 5740.871915796003, 7181.798389224943, 4450.047148786443, 9135.940015913377, 3826.1664498067726, 5320.7990021382475, 3529.1911676889804, 5690.929924819631, 2849.422313519992, 3674.9362211670236, 1205.5387398628584], "policy_adversary_policy_reward": [-4657.209433555467, -5756.420891324246, -4711.151110756002, -7147.327978774942, -1576.466683815246, -862.0815436688553, -7507.829970810907, -8362.014969544683, -2643.430101774748, -6440.122117719751, -2469.331364098321, -7140.477239013295, -2933.468328888386, -3084.1406051891177, -1864.3548925413259, -3861.4691973996437, -2818.616987356314, -4333.532606428497, -5105.804463730552, -5821.730970530255, -4244.603774720473, -5551.563340786858, -2788.80570816082, -2507.877503749213, -6382.851924537223, -6236.118640601027, -7102.705046271953, -1447.5286285924074, -8658.26311250937, -8911.307630778427, -7613.582244039516, -7332.979899885527, -10213.185750921984, -10967.336496501373, -4962.952566011421, -2889.7239549012443, -9601.733964634443, -3447.261730663351, -3604.6034458163113, -2944.2752631858716, -8322.095823290252, -6806.79509133217, -8485.647349622786, -9441.78516212791, -1139.6352477952628, -2222.734389776911, -3056.5801935854843, -3098.488275559343, -3422.876974887205, -4567.133574294259, -2971.1511105279283, -3443.225945566726, -11688.23537851965, -11809.495786391179, -9203.228040943322, -7924.852772086195, -3852.896863068726, -6113.265227475871, -8962.884974009972, -9331.57939058439, -1043.8914154923286, -538.8541196210314, -13.7647256552146, -0.9760963246880292, -6846.306925893963, -6696.283838936697, -3552.3687087140756, -9835.50284793121, -5352.984959891705, -4941.917134332867, -1282.1245866714228, -4897.2011597418295, -4486.99701979564, -7445.328802790637, -7993.693910150359, -8405.274499366515, -7563.608964854018, -4235.270204917161, -5213.2150754828535, -4008.711250781507, -4133.5415973090685, -9560.76109538693, -3030.386132665546, -4210.731385253554, -161.20600052041453, -1684.1562789656452, -9369.462665700034, -5257.835116153446, -5531.6467436409175, -8014.18671568393, -3092.963579351357, -5672.066750195593, -9064.521033909348, -9024.668380029221, -12365.754752763285, -9742.582394673462, -9049.98021637352, -3920.8143996896197, -359.6124847280993, -2864.061803194913, -9616.023671659808, -8477.565613575965, -522.9205766390336, -47.04623322480742, -2788.9882849002156, -3585.7328314665347, -9349.095835672046, -8872.306316585398, -9140.102255252988, -8993.742139334377, -4574.887690448817, -2615.2663531370536, -10038.797494449402, -10011.882724694417, -2233.4251139362505, -3249.6418385781867, -2074.3118662258566, -5538.570844903227, -51.71260939849494, -185.7165756752249, -10257.328318287953, -9689.94453392248, -2686.211622604102, -4434.202921194304, -4771.600976713309, -5482.210216225813, -6377.784115360476, -6734.695946269823, -868.2376040215277, -117.91499133180203, -8427.92397820539, -11238.732336787178, -8832.96415173684, -9579.337588919589, -50.11305896863016, -5.547691129553365, -5772.953030337725, -5541.656814585291, -5618.6887737437755, -2862.2761515645498, -6001.495161506566, -6042.02736571419, -3217.7277533017195, -5452.972893986121, -9625.34444685595, -7383.7099609238985, -8018.51326217465, -8294.65240543525, -9887.706345304032, -6510.720778592675, -4055.1176681115003, -4538.488377353322, -9259.518336585605, -7332.52180718239, -10055.69925907439, -5326.7318293380795, -7713.459464271731, -10848.11760228455, -2101.6000508484453, -6805.332370816672, -7685.018428406913, -10378.19959161337, -233.05619403966068, -1458.8391061024788, -6945.281707298473, -5718.733251550195, -80.45472548503116, -5.053883262070466, -10783.75785867438, -7934.558880470992, -8599.105491788117, -4564.32344819935, -1532.5571358916536, -1103.905040527994, -6796.188078205208, -4834.668001823593, -5901.281369233055, -9111.262126936273, -6230.560226116327, -5998.6269090094265, -7711.567580575408, -7194.103838809323, -6252.772546873925, -4450.047148786443, -9229.612513866618, -9731.032043536188, -6541.206545939077, -3826.1664498067726, -7206.628890571358, -5320.7990021382475, -6585.080493323942, -3529.1911676889804, -5694.023716232743, -6478.026237564599, -3321.788112419677, -3619.598419327812, -7020.885917751518, -3674.9362211670236, -1615.7543591119738, -1574.3955033263474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396726114386515, "mean_inference_ms": 0.9639899860220502, "mean_action_processing_ms": 0.16649686471804348, "mean_env_wait_ms": 0.05099551379955036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032787322998046875, "StateBufferConnector_ms": 0.002609729766845703, "ViewRequirementAgentConnector_ms": 0.06776392459869385}, "num_episodes": 22, "episode_return_max": -13.7647256552146, "episode_return_min": -12365.754752763285, "episode_return_mean": -6470.698626441505}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.3740625839816, "num_env_steps_trained_throughput_per_sec": 548.3740625839816, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 7416.883, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7416.85, "sample_time_ms": 796.744, "learn_time_ms": 6608.157, "learn_throughput": 605.312, "synch_weights_time_ms": 11.524}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 172, "trial_id": "3439d_00000", "date": "2024-08-09_15-47-55", "timestamp": 1723232875, "time_this_iter_s": 7.297775983810425, "time_total_s": 1282.5502638816833, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3223dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1282.5502638816833, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 30.8, "ram_util_percent": 82.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0195751424568396, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997520092129708, "policy_loss": -0.0019084017684993645, "vf_loss": 9.995810019969941, "vf_explained_var": -0.007088853667179744, "kl": 0.006183567836948593, "entropy": 1.367694645995895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.978929060192966, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995360134266042, "policy_loss": -0.0049869769945169095, "vf_loss": 9.997194633282051, "vf_explained_var": 0.0005968092925964839, "kl": 0.011070410904311944, "entropy": 1.196897137669659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "env_runners": {"episode_reward_max": -13.7647256552146, "episode_reward_min": -12365.754752763285, "episode_reward_mean": -6525.681503270437, "episode_len_mean": 178.23, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 17823, "policy_reward_min": {"agent_policy": 0.9760963246880292, "adversary_policy": -12365.754752763285}, "policy_reward_max": {"agent_policy": 11468.746966847179, "adversary_policy": -0.9760963246880292}, "policy_reward_mean": {"agent_policy": 4665.319886125256, "adversary_policy": -5595.5006946978465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9494.193612863617, -2225.6344236928653, -3333.8939323712593, -4816.09625464475, -3469.600603119198, -12028.984198063652, -9203.22804094332, -6198.415216593019, -9552.996655627863, -1112.4921301107872, -13.7647256552146, -6947.273036517681, -9835.50284793121, -5376.023781416727, -4897.2011597418295, -7445.328802790638, -8770.612976662469, -7563.608964854018, -6280.446249340909, -9560.76109538693, -4341.880912992664, -1684.1562789656452, -9369.462665700035, -8032.670205775245, -5672.066750195593, -9444.885730220509, -12365.754752763285, -9049.980216373518, -2864.061803194913, -9616.52764666872, -522.9205766390335, -3593.7173438245454, -9530.475745260306, -9434.415215030307, -4642.59778080635, -10310.506341192124, -3250.157053996438, -5538.570844903227, -185.7165756752249, -10258.903391605721, -4434.202921194302, -5588.819784425539, -6800.492701067978, -868.2376040215275, -11238.732336787178, -9635.144746003685, -50.113058968630156, -5877.70200206197, -5618.6887737437755, -6172.866426281156, -5659.2417796236905, -9625.34444685595, -8479.172288496944, -9887.70634530403, -4604.303525649382, -9259.518336585605, -10055.699259074388, -10848.11760228455, -6805.332370816672, -10378.19959161337, -1458.8391061024788, -6945.868280001823, -80.45472548503118, -10783.75785867438, -8599.105491788116, -1578.4094521310485, -6798.3290947944, -9111.262126936273, -6488.315219329758, -7723.873030159788, -6252.7725468739245, -9824.704541489427, -6541.206545939078, -7206.628890571358, -6585.080493323942, -6481.120028977711, -4091.964218227501, -7020.885917751519, -1984.6111225754628, -7354.386028520055, -9157.698166904176, -9595.9534446688, -8540.120101168895, -3688.0153009360242, -8757.650595544126, -4382.417987845139, -7767.208610636938, -4419.08326094432, -9684.57737707536, -9776.53105091689, -6556.558172621755, -226.24447991303066, -7336.124062724346, -5478.3190045123, -4454.161423502437, -5333.766352732102, -7403.986130026332, -3454.4886792580455, -4856.901130141214, -9063.64783434671], "episode_lengths": [200, 86, 200, 200, 200, 200, 200, 200, 200, 111, 1, 200, 200, 200, 141, 200, 200, 200, 200, 200, 200, 44, 200, 200, 200, 200, 200, 200, 76, 200, 14, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 27, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 3, 200, 200, 178, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 117, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 145, 200, 200, 200, 200], "policy_agent_policy_reward": [8433.23889888708, 1136.7352138793085, 2821.174536773573, 3173.9142945367103, 2944.7764529754563, 11468.746966847179, 7924.852772086195, 3767.746873951578, 8741.4677089665, 470.2534050025717, 0.9760963246880292, 6595.317728312979, 3552.3687087140756, 4918.878312807845, 1282.1245866714228, 4486.99701979564, 7628.355432854406, 4235.270204917161, 2941.480076923447, 4133.5415973090685, 2899.2366049264365, 161.20600052041453, 5257.835116153446, 5513.163253549601, 3092.963579351357, 8644.303683718059, 9742.582394673462, 3920.8143996896197, 359.6124847280993, 8477.061638567055, 47.04623322480742, 2781.003772542205, 8690.926406997138, 8699.429179557044, 2547.5562627795257, 9740.173877951685, 2232.909898517999, 2074.3118662258566, 51.71260939849494, 9688.369460604714, 2686.211622604102, 4664.991408513583, 6311.9873605623225, 117.91499133180203, 8427.92397820539, 8777.156994652743, 5.547691129553365, 5436.9078428610455, 2862.2761515645498, 5870.656100939602, 3011.4588676641524, 7383.7099609238985, 7833.993379112957, 6510.720778592675, 3989.3025198154432, 7332.52180718239, 5326.7318293380795, 7713.459464271731, 2101.6000508484453, 7685.018428406913, 233.05619403966068, 5718.146678846846, 5.053883262070466, 7934.558880470992, 4564.32344819935, 1058.0527242885983, 4832.526985234401, 5901.281369233055, 5740.871915796003, 7181.798389224943, 4450.047148786443, 9135.940015913377, 3826.1664498067726, 5320.7990021382475, 3529.1911676889804, 5690.929924819631, 2849.422313519992, 3674.9362211670236, 1205.5387398628584, 1383.798556749135, 2813.7599930638453, 8090.301253447667, 7971.574293236789, 2976.0096927104028, 6743.088498497248, 2993.694034102077, 7142.63812791449, 3221.661166134105, 8900.705980511628, 7673.0680310769385, 6177.996126831784, 63.92441299102782, 2485.646232882554, 2889.0782567171004, 2118.330522390888, 2576.6991075324086, 7156.156922340701, 2012.1826802103676, 3202.5885052419108, 5755.917924907996], "policy_adversary_policy_reward": [-8485.647349622786, -9441.78516212791, -1139.6352477952628, -2222.734389776911, -3056.5801935854843, -3098.488275559343, -3422.876974887205, -4567.133574294259, -2971.1511105279283, -3443.225945566726, -11688.23537851965, -11809.495786391179, -9203.228040943322, -7924.852772086195, -3852.896863068726, -6113.265227475871, -8962.884974009972, -9331.57939058439, -1043.8914154923286, -538.8541196210314, -13.7647256552146, -0.9760963246880292, -6846.306925893963, -6696.283838936697, -3552.3687087140756, -9835.50284793121, -5352.984959891705, -4941.917134332867, -1282.1245866714228, -4897.2011597418295, -4486.99701979564, -7445.328802790637, -7993.693910150359, -8405.274499366515, -7563.608964854018, -4235.270204917161, -5213.2150754828535, -4008.711250781507, -4133.5415973090685, -9560.76109538693, -3030.386132665546, -4210.731385253554, -161.20600052041453, -1684.1562789656452, -9369.462665700034, -5257.835116153446, -5531.6467436409175, -8014.18671568393, -3092.963579351357, -5672.066750195593, -9064.521033909348, -9024.668380029221, -12365.754752763285, -9742.582394673462, -9049.98021637352, -3920.8143996896197, -359.6124847280993, -2864.061803194913, -9616.023671659808, -8477.565613575965, -522.9205766390336, -47.04623322480742, -2788.9882849002156, -3585.7328314665347, -9349.095835672046, -8872.306316585398, -9140.102255252988, -8993.742139334377, -4574.887690448817, -2615.2663531370536, -10038.797494449402, -10011.882724694417, -2233.4251139362505, -3249.6418385781867, -2074.3118662258566, -5538.570844903227, -51.71260939849494, -185.7165756752249, -10257.328318287953, -9689.94453392248, -2686.211622604102, -4434.202921194304, -4771.600976713309, -5482.210216225813, -6377.784115360476, -6734.695946269823, -868.2376040215277, -117.91499133180203, -8427.92397820539, -11238.732336787178, -8832.96415173684, -9579.337588919589, -50.11305896863016, -5.547691129553365, -5772.953030337725, -5541.656814585291, -5618.6887737437755, -2862.2761515645498, -6001.495161506566, -6042.02736571419, -3217.7277533017195, -5452.972893986121, -9625.34444685595, -7383.7099609238985, -8018.51326217465, -8294.65240543525, -9887.706345304032, -6510.720778592675, -4055.1176681115003, -4538.488377353322, -9259.518336585605, -7332.52180718239, -10055.69925907439, -5326.7318293380795, -7713.459464271731, -10848.11760228455, -2101.6000508484453, -6805.332370816672, -7685.018428406913, -10378.19959161337, -233.05619403966068, -1458.8391061024788, -6945.281707298473, -5718.733251550195, -80.45472548503116, -5.053883262070466, -10783.75785867438, -7934.558880470992, -8599.105491788117, -4564.32344819935, -1532.5571358916536, -1103.905040527994, -6796.188078205208, -4834.668001823593, -5901.281369233055, -9111.262126936273, -6230.560226116327, -5998.6269090094265, -7711.567580575408, -7194.103838809323, -6252.772546873925, -4450.047148786443, -9229.612513866618, -9731.032043536188, -6541.206545939077, -3826.1664498067726, -7206.628890571358, -5320.7990021382475, -6585.080493323942, -3529.1911676889804, -5694.023716232743, -6478.026237564599, -3321.788112419677, -3619.598419327812, -7020.885917751518, -3674.9362211670236, -1615.7543591119738, -1574.3955033263474, -1383.798556749135, -7354.386028520055, -2813.7599930638453, -9157.698166904176, -8091.050698301844, -9595.203999814623, -8330.050629420228, -8181.643764985459, -3669.280411579003, -2994.7445820674234, -8757.65059554413, -6743.088498497248, -4379.118805101292, -2996.9932168459222, -7625.94745221137, -7283.899286340055, -4024.051021769007, -3616.6934053094205, -8929.571607105356, -9655.711750481632, -7673.0680310769385, -9776.53105091689, -6374.266375474268, -6360.287923979271, -63.92441299102782, -226.24447991303066, -7336.124062724347, -2485.646232882554, -2889.0782567171004, -5478.3190045123, -2118.330522390888, -4454.161423502438, -2576.6991075324086, -5333.766352732101, -7172.177738952034, -7387.965313415, -3432.3764599807114, -2034.2948994877027, -3202.5885052419108, -4856.901130141214, -5755.917924907996, -9063.64783434671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396659667699659, "mean_inference_ms": 0.9643209532150004, "mean_action_processing_ms": 0.16648161158508756, "mean_env_wait_ms": 0.05097913947875055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033048391342163086, "StateBufferConnector_ms": 0.002588033676147461, "ViewRequirementAgentConnector_ms": 0.06747889518737793}, "num_episodes": 21, "episode_return_max": -13.7647256552146, "episode_return_min": -12365.754752763285, "episode_return_mean": -6525.681503270437}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 520.5736742980289, "num_env_steps_trained_throughput_per_sec": 520.5736742980289, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2076000, "timers": {"training_iteration_time_ms": 7447.045, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7447.012, "sample_time_ms": 786.561, "learn_time_ms": 6648.536, "learn_throughput": 601.636, "synch_weights_time_ms": 11.44}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "done": false, "training_iteration": 173, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-02", "timestamp": 1723232882, "time_this_iter_s": 7.688803195953369, "time_total_s": 1290.2390670776367, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31dd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1290.2390670776367, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 28.972727272727276, "ram_util_percent": 82.58181818181816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0252305395280321, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99467010597388, "policy_loss": -0.0041936431696134, "vf_loss": 9.99397281308969, "vf_explained_var": -0.008645689487457276, "kl": 0.008358035788599711, "entropy": 1.3957536868751048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9698694095409737, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996331896605316, "policy_loss": -0.0031139850889938692, "vf_loss": 9.995519999852256, "vf_explained_var": 0.0008390529445870213, "kl": 0.013786325775697906, "entropy": 1.1837812599681672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": -50.113058968630156, "episode_reward_min": -12365.754752763285, "episode_reward_mean": -6595.752257084226, "episode_len_mean": 181.4, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18140, "policy_reward_min": {"agent_policy": 5.053883262070466, "adversary_policy": -12365.754752763285}, "policy_reward_max": {"agent_policy": 9742.582394673462, "adversary_policy": -5.053883262070466}, "policy_reward_mean": {"agent_policy": 4653.046512851937, "adversary_policy": -5624.399384968083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1684.1562789656452, -9369.462665700035, -8032.670205775245, -5672.066750195593, -9444.885730220509, -12365.754752763285, -9049.980216373518, -2864.061803194913, -9616.52764666872, -522.9205766390335, -3593.7173438245454, -9530.475745260306, -9434.415215030307, -4642.59778080635, -10310.506341192124, -3250.157053996438, -5538.570844903227, -185.7165756752249, -10258.903391605721, -4434.202921194302, -5588.819784425539, -6800.492701067978, -868.2376040215275, -11238.732336787178, -9635.144746003685, -50.113058968630156, -5877.70200206197, -5618.6887737437755, -6172.866426281156, -5659.2417796236905, -9625.34444685595, -8479.172288496944, -9887.70634530403, -4604.303525649382, -9259.518336585605, -10055.699259074388, -10848.11760228455, -6805.332370816672, -10378.19959161337, -1458.8391061024788, -6945.868280001823, -80.45472548503118, -10783.75785867438, -8599.105491788116, -1578.4094521310485, -6798.3290947944, -9111.262126936273, -6488.315219329758, -7723.873030159788, -6252.7725468739245, -9824.704541489427, -6541.206545939078, -7206.628890571358, -6585.080493323942, -6481.120028977711, -4091.964218227501, -7020.885917751519, -1984.6111225754628, -7354.386028520055, -9157.698166904176, -9595.9534446688, -8540.120101168895, -3688.0153009360242, -8757.650595544126, -4382.417987845139, -7767.208610636938, -4419.08326094432, -9684.57737707536, -9776.53105091689, -6556.558172621755, -226.24447991303066, -7336.124062724346, -5478.3190045123, -4454.161423502437, -5333.766352732102, -7403.986130026332, -3454.4886792580455, -4856.901130141214, -9063.64783434671, -7027.08528114451, -5727.4849628534175, -5040.200248496383, -6624.928973254474, -9026.780309229987, -3646.7876470880487, -12060.49214712154, -11538.938935169559, -8909.034829108854, -9989.542897355861, -6051.628759270882, -2786.9296808136064, -5888.425510795708, -5983.848981556306, -3575.606659556905, -2638.5444214335557, -6711.005850068348, -6578.015064591366, -6719.633955516902, -6583.9270187216225, -6366.1728695518495], "episode_lengths": [44, 200, 200, 200, 200, 200, 200, 76, 200, 14, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 27, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 3, 200, 200, 178, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 117, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 145, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 199, 200, 200], "policy_agent_policy_reward": [161.20600052041453, 5257.835116153446, 5513.163253549601, 3092.963579351357, 8644.303683718059, 9742.582394673462, 3920.8143996896197, 359.6124847280993, 8477.061638567055, 47.04623322480742, 2781.003772542205, 8690.926406997138, 8699.429179557044, 2547.5562627795257, 9740.173877951685, 2232.909898517999, 2074.3118662258566, 51.71260939849494, 9688.369460604714, 2686.211622604102, 4664.991408513583, 6311.9873605623225, 117.91499133180203, 8427.92397820539, 8777.156994652743, 5.547691129553365, 5436.9078428610455, 2862.2761515645498, 5870.656100939602, 3011.4588676641524, 7383.7099609238985, 7833.993379112957, 6510.720778592675, 3989.3025198154432, 7332.52180718239, 5326.7318293380795, 7713.459464271731, 2101.6000508484453, 7685.018428406913, 233.05619403966068, 5718.146678846846, 5.053883262070466, 7934.558880470992, 4564.32344819935, 1058.0527242885983, 4832.526985234401, 5901.281369233055, 5740.871915796003, 7181.798389224943, 4450.047148786443, 9135.940015913377, 3826.1664498067726, 5320.7990021382475, 3529.1911676889804, 5690.929924819631, 2849.422313519992, 3674.9362211670236, 1205.5387398628584, 1383.798556749135, 2813.7599930638453, 8090.301253447667, 7971.574293236789, 2976.0096927104028, 6743.088498497248, 2993.694034102077, 7142.63812791449, 3221.661166134105, 8900.705980511628, 7673.0680310769385, 6177.996126831784, 63.92441299102782, 2485.646232882554, 2889.0782567171004, 2118.330522390888, 2576.6991075324086, 7156.156922340701, 2012.1826802103676, 3202.5885052419108, 5755.917924907996, 5712.563096563088, 2045.9135844271764, 4021.9867624209423, 5357.53775830624, 8580.894916603376, 1836.2720481112813, 6666.958499011262, 7793.319134885499, 6531.118913319144, 8619.892909044122, 4553.0726296886405, 2214.860287718986, 1810.5361385338379, 3070.5625339537883, 2008.763980661368, 590.240430972639, 3253.270299926012, 3826.6799347009783, 3571.596070629408, 5358.880300153649, 4905.195936500042], "policy_adversary_policy_reward": [-161.20600052041453, -1684.1562789656452, -9369.462665700034, -5257.835116153446, -5531.6467436409175, -8014.18671568393, -3092.963579351357, -5672.066750195593, -9064.521033909348, -9024.668380029221, -12365.754752763285, -9742.582394673462, -9049.98021637352, -3920.8143996896197, -359.6124847280993, -2864.061803194913, -9616.023671659808, -8477.565613575965, -522.9205766390336, -47.04623322480742, -2788.9882849002156, -3585.7328314665347, -9349.095835672046, -8872.306316585398, -9140.102255252988, -8993.742139334377, -4574.887690448817, -2615.2663531370536, -10038.797494449402, -10011.882724694417, -2233.4251139362505, -3249.6418385781867, -2074.3118662258566, -5538.570844903227, -51.71260939849494, -185.7165756752249, -10257.328318287953, -9689.94453392248, -2686.211622604102, -4434.202921194304, -4771.600976713309, -5482.210216225813, -6377.784115360476, -6734.695946269823, -868.2376040215277, -117.91499133180203, -8427.92397820539, -11238.732336787178, -8832.96415173684, -9579.337588919589, -50.11305896863016, -5.547691129553365, -5772.953030337725, -5541.656814585291, -5618.6887737437755, -2862.2761515645498, -6001.495161506566, -6042.02736571419, -3217.7277533017195, -5452.972893986121, -9625.34444685595, -7383.7099609238985, -8018.51326217465, -8294.65240543525, -9887.706345304032, -6510.720778592675, -4055.1176681115003, -4538.488377353322, -9259.518336585605, -7332.52180718239, -10055.69925907439, -5326.7318293380795, -7713.459464271731, -10848.11760228455, -2101.6000508484453, -6805.332370816672, -7685.018428406913, -10378.19959161337, -233.05619403966068, -1458.8391061024788, -6945.281707298473, -5718.733251550195, -80.45472548503116, -5.053883262070466, -10783.75785867438, -7934.558880470992, -8599.105491788117, -4564.32344819935, -1532.5571358916536, -1103.905040527994, -6796.188078205208, -4834.668001823593, -5901.281369233055, -9111.262126936273, -6230.560226116327, -5998.6269090094265, -7711.567580575408, -7194.103838809323, -6252.772546873925, -4450.047148786443, -9229.612513866618, -9731.032043536188, -6541.206545939077, -3826.1664498067726, -7206.628890571358, -5320.7990021382475, -6585.080493323942, -3529.1911676889804, -5694.023716232743, -6478.026237564599, -3321.788112419677, -3619.598419327812, -7020.885917751518, -3674.9362211670236, -1615.7543591119738, -1574.3955033263474, -1383.798556749135, -7354.386028520055, -2813.7599930638453, -9157.698166904176, -8091.050698301844, -9595.203999814623, -8330.050629420228, -8181.643764985459, -3669.280411579003, -2994.7445820674234, -8757.65059554413, -6743.088498497248, -4379.118805101292, -2996.9932168459222, -7625.94745221137, -7283.899286340055, -4024.051021769007, -3616.6934053094205, -8929.571607105356, -9655.711750481632, -7673.0680310769385, -9776.53105091689, -6374.266375474268, -6360.287923979271, -63.92441299102782, -226.24447991303066, -7336.124062724347, -2485.646232882554, -2889.0782567171004, -5478.3190045123, -2118.330522390888, -4454.161423502438, -2576.6991075324086, -5333.766352732101, -7172.177738952034, -7387.965313415, -3432.3764599807114, -2034.2948994877027, -3202.5885052419108, -4856.901130141214, -5755.917924907996, -9063.64783434671, -6589.350674504478, -6150.29770320312, -5727.4849628534175, -2045.9135844271764, -4211.143008336944, -4851.044002580379, -6624.928973254474, -5357.53775830624, -8629.237748999765, -8978.437476833602, -1892.7078953899254, -3590.3517998094057, -6666.958499011262, -12060.492147121544, -7793.319134885499, -11538.93893516956, -6533.893625673572, -8906.260116754425, -9986.840263911474, -8622.595542488507, -5650.696717155785, -4954.004671803739, -2735.9704627693727, -2265.8195057632174, -1853.8707852297764, -5845.090864099768, -3076.5799989131074, -5977.831516596988, -2781.368695325736, -2803.0019448925345, -2638.544421433556, -590.240430972639, -6638.521297629942, -3325.754852364418, -3826.6799347009783, -6578.015064591365, -3571.596070629408, -6719.633955516902, -5635.966343403905, -6306.840975471361, -5099.731806132339, -6171.636999919551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39659425085796235, "mean_inference_ms": 0.9641923299881304, "mean_action_processing_ms": 0.16651027129821108, "mean_env_wait_ms": 0.051015308679143875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032739639282226562, "StateBufferConnector_ms": 0.002533435821533203, "ViewRequirementAgentConnector_ms": 0.06592714786529541}, "num_episodes": 21, "episode_return_max": -50.113058968630156, "episode_return_min": -12365.754752763285, "episode_return_mean": -6595.752257084226}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 566.9807657538158, "num_env_steps_trained_throughput_per_sec": 566.9807657538158, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 7379.671, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7379.639, "sample_time_ms": 759.287, "learn_time_ms": 6608.339, "learn_throughput": 605.296, "synch_weights_time_ms": 11.547}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 174, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-10", "timestamp": 1723232890, "time_this_iter_s": 7.058773040771484, "time_total_s": 1297.2978401184082, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31dd430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1297.2978401184082, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 27.527272727272727, "ram_util_percent": 82.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9902090329676867, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98771786292394, "policy_loss": -0.009772007099915452, "vf_loss": 9.993950475255648, "vf_explained_var": -0.0066891329983870184, "kl": 0.006048388776252978, "entropy": 1.3756537506977717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9631045540489217, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9951651048408, "policy_loss": -0.005934837058423057, "vf_loss": 9.99710595973585, "vf_explained_var": 0.0009341246867306018, "kl": 0.014025525066745344, "entropy": 1.1551695585881592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "env_runners": {"episode_reward_max": -50.113058968630156, "episode_reward_min": -12060.49214712154, "episode_reward_mean": -6657.717906782001, "episode_len_mean": 186.86, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 18686, "policy_reward_min": {"agent_policy": 5.053883262070466, "adversary_policy": -12060.492147121544}, "policy_reward_max": {"agent_policy": 9135.940015913377, "adversary_policy": -5.053883262070466}, "policy_reward_mean": {"agent_policy": 4516.401965829899, "adversary_policy": -5587.05993630595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4434.202921194302, -5588.819784425539, -6800.492701067978, -868.2376040215275, -11238.732336787178, -9635.144746003685, -50.113058968630156, -5877.70200206197, -5618.6887737437755, -6172.866426281156, -5659.2417796236905, -9625.34444685595, -8479.172288496944, -9887.70634530403, -4604.303525649382, -9259.518336585605, -10055.699259074388, -10848.11760228455, -6805.332370816672, -10378.19959161337, -1458.8391061024788, -6945.868280001823, -80.45472548503118, -10783.75785867438, -8599.105491788116, -1578.4094521310485, -6798.3290947944, -9111.262126936273, -6488.315219329758, -7723.873030159788, -6252.7725468739245, -9824.704541489427, -6541.206545939078, -7206.628890571358, -6585.080493323942, -6481.120028977711, -4091.964218227501, -7020.885917751519, -1984.6111225754628, -7354.386028520055, -9157.698166904176, -9595.9534446688, -8540.120101168895, -3688.0153009360242, -8757.650595544126, -4382.417987845139, -7767.208610636938, -4419.08326094432, -9684.57737707536, -9776.53105091689, -6556.558172621755, -226.24447991303066, -7336.124062724346, -5478.3190045123, -4454.161423502437, -5333.766352732102, -7403.986130026332, -3454.4886792580455, -4856.901130141214, -9063.64783434671, -7027.08528114451, -5727.4849628534175, -5040.200248496383, -6624.928973254474, -9026.780309229987, -3646.7876470880487, -12060.49214712154, -11538.938935169559, -8909.034829108854, -9989.542897355861, -6051.628759270882, -2786.9296808136064, -5888.425510795708, -5983.848981556306, -3575.606659556905, -2638.5444214335557, -6711.005850068348, -6578.015064591366, -6719.633955516902, -6583.9270187216225, -6366.1728695518495, -9054.945421231176, -7527.044126301727, -4537.783999592067, -8032.047000762536, -6415.909649663931, -7888.909794373441, -8747.63695352344, -7224.7157880465875, -4827.049079458535, -2622.7778613500936, -7891.22085043272, -7813.919709340173, -9089.29581823998, -3226.9529599207913, -8877.647051841352, -9160.40973449759, -9726.220288420236, -4699.189148782703, -4200.436652788973], "episode_lengths": [200, 200, 200, 27, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 3, 200, 200, 178, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 117, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 145, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 199, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2686.211622604102, 4664.991408513583, 6311.9873605623225, 117.91499133180203, 8427.92397820539, 8777.156994652743, 5.547691129553365, 5436.9078428610455, 2862.2761515645498, 5870.656100939602, 3011.4588676641524, 7383.7099609238985, 7833.993379112957, 6510.720778592675, 3989.3025198154432, 7332.52180718239, 5326.7318293380795, 7713.459464271731, 2101.6000508484453, 7685.018428406913, 233.05619403966068, 5718.146678846846, 5.053883262070466, 7934.558880470992, 4564.32344819935, 1058.0527242885983, 4832.526985234401, 5901.281369233055, 5740.871915796003, 7181.798389224943, 4450.047148786443, 9135.940015913377, 3826.1664498067726, 5320.7990021382475, 3529.1911676889804, 5690.929924819631, 2849.422313519992, 3674.9362211670236, 1205.5387398628584, 1383.798556749135, 2813.7599930638453, 8090.301253447667, 7971.574293236789, 2976.0096927104028, 6743.088498497248, 2993.694034102077, 7142.63812791449, 3221.661166134105, 8900.705980511628, 7673.0680310769385, 6177.996126831784, 63.92441299102782, 2485.646232882554, 2889.0782567171004, 2118.330522390888, 2576.6991075324086, 7156.156922340701, 2012.1826802103676, 3202.5885052419108, 5755.917924907996, 5712.563096563088, 2045.9135844271764, 4021.9867624209423, 5357.53775830624, 8580.894916603376, 1836.2720481112813, 6666.958499011262, 7793.319134885499, 6531.118913319144, 8619.892909044122, 4553.0726296886405, 2214.860287718986, 1810.5361385338379, 3070.5625339537883, 2008.763980661368, 590.240430972639, 3253.270299926012, 3826.6799347009783, 3571.596070629408, 5358.880300153649, 4905.195936500042, 3279.4304750848123, 5094.803207576441, 1720.6696897414333, 7083.275783572741, 5456.200620412182, 2442.1119584060093, 4908.104691233816, 2799.5382896119213, 3185.146215099388, 1934.1895339235741, 4781.522577488596, 2738.928406315694, 6429.2907675108545, 2412.000583062641, 7629.983158200175, 3598.273460859767, 6984.526806725703, 2136.798678459217, 3443.732513261819], "policy_adversary_policy_reward": [-2686.211622604102, -4434.202921194304, -4771.600976713309, -5482.210216225813, -6377.784115360476, -6734.695946269823, -868.2376040215277, -117.91499133180203, -8427.92397820539, -11238.732336787178, -8832.96415173684, -9579.337588919589, -50.11305896863016, -5.547691129553365, -5772.953030337725, -5541.656814585291, -5618.6887737437755, -2862.2761515645498, -6001.495161506566, -6042.02736571419, -3217.7277533017195, -5452.972893986121, -9625.34444685595, -7383.7099609238985, -8018.51326217465, -8294.65240543525, -9887.706345304032, -6510.720778592675, -4055.1176681115003, -4538.488377353322, -9259.518336585605, -7332.52180718239, -10055.69925907439, -5326.7318293380795, -7713.459464271731, -10848.11760228455, -2101.6000508484453, -6805.332370816672, -7685.018428406913, -10378.19959161337, -233.05619403966068, -1458.8391061024788, -6945.281707298473, -5718.733251550195, -80.45472548503116, -5.053883262070466, -10783.75785867438, -7934.558880470992, -8599.105491788117, -4564.32344819935, -1532.5571358916536, -1103.905040527994, -6796.188078205208, -4834.668001823593, -5901.281369233055, -9111.262126936273, -6230.560226116327, -5998.6269090094265, -7711.567580575408, -7194.103838809323, -6252.772546873925, -4450.047148786443, -9229.612513866618, -9731.032043536188, -6541.206545939077, -3826.1664498067726, -7206.628890571358, -5320.7990021382475, -6585.080493323942, -3529.1911676889804, -5694.023716232743, -6478.026237564599, -3321.788112419677, -3619.598419327812, -7020.885917751518, -3674.9362211670236, -1615.7543591119738, -1574.3955033263474, -1383.798556749135, -7354.386028520055, -2813.7599930638453, -9157.698166904176, -8091.050698301844, -9595.203999814623, -8330.050629420228, -8181.643764985459, -3669.280411579003, -2994.7445820674234, -8757.65059554413, -6743.088498497248, -4379.118805101292, -2996.9932168459222, -7625.94745221137, -7283.899286340055, -4024.051021769007, -3616.6934053094205, -8929.571607105356, -9655.711750481632, -7673.0680310769385, -9776.53105091689, -6374.266375474268, -6360.287923979271, -63.92441299102782, -226.24447991303066, -7336.124062724347, -2485.646232882554, -2889.0782567171004, -5478.3190045123, -2118.330522390888, -4454.161423502438, -2576.6991075324086, -5333.766352732101, -7172.177738952034, -7387.965313415, -3432.3764599807114, -2034.2948994877027, -3202.5885052419108, -4856.901130141214, -5755.917924907996, -9063.64783434671, -6589.350674504478, -6150.29770320312, -5727.4849628534175, -2045.9135844271764, -4211.143008336944, -4851.044002580379, -6624.928973254474, -5357.53775830624, -8629.237748999765, -8978.437476833602, -1892.7078953899254, -3590.3517998094057, -6666.958499011262, -12060.492147121544, -7793.319134885499, -11538.93893516956, -6533.893625673572, -8906.260116754425, -9986.840263911474, -8622.595542488507, -5650.696717155785, -4954.004671803739, -2735.9704627693727, -2265.8195057632174, -1853.8707852297764, -5845.090864099768, -3076.5799989131074, -5977.831516596988, -2781.368695325736, -2803.0019448925345, -2638.544421433556, -590.240430972639, -6638.521297629942, -3325.754852364418, -3826.6799347009783, -6578.015064591365, -3571.596070629408, -6719.633955516902, -5635.966343403905, -6306.840975471361, -5099.731806132339, -6171.636999919551, -3279.4304750848123, -9054.945421231176, -7527.044126301727, -5094.803207576441, -1720.6696897414333, -4537.783999592067, -7153.310994909307, -7962.01178942597, -5972.013582261271, -5900.096687814844, -7888.909794373442, -2442.1119584060093, -8747.63695352344, -4908.104691233816, -2799.5382896119213, -7224.7157880465875, -4450.900218522738, -3561.295076035182, -2622.777861350093, -1934.1895339235741, -4781.522577488596, -7891.22085043272, -7813.919709340173, -2738.928406315694, -9052.213405740074, -6466.373180010757, -3162.219437558334, -2476.734105425098, -8488.185325256138, -8019.444884785391, -9160.40973449759, -3598.273460859767, -9715.14588533568, -6995.601209810262, -2136.798678459217, -4699.189148782703, -4200.436652788973, -3443.732513261819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39651364098770403, "mean_inference_ms": 0.9647888699816123, "mean_action_processing_ms": 0.16648577535217204, "mean_env_wait_ms": 0.05098397983006914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033131837844848633, "StateBufferConnector_ms": 0.002543807029724121, "ViewRequirementAgentConnector_ms": 0.06657576560974121}, "num_episodes": 19, "episode_return_max": -50.113058968630156, "episode_return_min": -12060.49214712154, "episode_return_mean": -6657.717906782001}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 562.1847887695844, "num_env_steps_trained_throughput_per_sec": 562.1847887695844, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 7329.05, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7329.018, "sample_time_ms": 745.31, "learn_time_ms": 6571.809, "learn_throughput": 608.66, "synch_weights_time_ms": 11.435}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "training_iteration": 175, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-17", "timestamp": 1723232897, "time_this_iter_s": 7.120326280593872, "time_total_s": 1304.418166399002, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31dd790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1304.418166399002, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 25.049999999999997, "ram_util_percent": 82.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9584230987975995, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.989069217443467, "policy_loss": -0.004717119159856035, "vf_loss": 9.989355767766634, "vf_explained_var": -0.0007073951264222462, "kl": 0.007571347588964272, "entropy": 1.3434709765017032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9793660559824535, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996588352748326, "policy_loss": -0.0019093593276997723, "vf_loss": 9.994801682769937, "vf_explained_var": 0.00023028620336421583, "kl": 0.01297914951093613, "entropy": 1.1585873202041344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": -226.24447991303066, "episode_reward_min": -12060.49214712154, "episode_reward_mean": -6664.809308952125, "episode_len_mean": 191.3, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19130, "policy_reward_min": {"agent_policy": 63.92441299102782, "adversary_policy": -12060.492147121544}, "policy_reward_max": {"agent_policy": 9311.898722109758, "adversary_policy": -63.92441299102782}, "policy_reward_mean": {"agent_policy": 4464.0764598095175, "adversary_policy": -5564.442884380822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10783.75785867438, -8599.105491788116, -1578.4094521310485, -6798.3290947944, -9111.262126936273, -6488.315219329758, -7723.873030159788, -6252.7725468739245, -9824.704541489427, -6541.206545939078, -7206.628890571358, -6585.080493323942, -6481.120028977711, -4091.964218227501, -7020.885917751519, -1984.6111225754628, -7354.386028520055, -9157.698166904176, -9595.9534446688, -8540.120101168895, -3688.0153009360242, -8757.650595544126, -4382.417987845139, -7767.208610636938, -4419.08326094432, -9684.57737707536, -9776.53105091689, -6556.558172621755, -226.24447991303066, -7336.124062724346, -5478.3190045123, -4454.161423502437, -5333.766352732102, -7403.986130026332, -3454.4886792580455, -4856.901130141214, -9063.64783434671, -7027.08528114451, -5727.4849628534175, -5040.200248496383, -6624.928973254474, -9026.780309229987, -3646.7876470880487, -12060.49214712154, -11538.938935169559, -8909.034829108854, -9989.542897355861, -6051.628759270882, -2786.9296808136064, -5888.425510795708, -5983.848981556306, -3575.606659556905, -2638.5444214335557, -6711.005850068348, -6578.015064591366, -6719.633955516902, -6583.9270187216225, -6366.1728695518495, -9054.945421231176, -7527.044126301727, -4537.783999592067, -8032.047000762536, -6415.909649663931, -7888.909794373441, -8747.63695352344, -7224.7157880465875, -4827.049079458535, -2622.7778613500936, -7891.22085043272, -7813.919709340173, -9089.29581823998, -3226.9529599207913, -8877.647051841352, -9160.40973449759, -9726.220288420236, -4699.189148782703, -4200.436652788973, -8551.464345401364, -6037.857741030004, -2660.082649816162, -5400.927199590654, -5704.048727768017, -8854.439114368644, -3996.3734653038655, -5554.452604232032, -7492.534358030019, -8738.731600796544, -8515.923754373003, -9845.2655534019, -9833.945232159811, -6133.359767264472, -6792.999551615867, -5875.21485830406, -4794.197481098165, -7624.486579568703, -3895.675296628033, -10069.29633805606, -6029.57502733419, -7176.649261425618, -1504.4377218949433], "episode_lengths": [200, 200, 178, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 117, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 145, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 199, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 67], "policy_agent_policy_reward": [7934.558880470992, 4564.32344819935, 1058.0527242885983, 4832.526985234401, 5901.281369233055, 5740.871915796003, 7181.798389224943, 4450.047148786443, 9135.940015913377, 3826.1664498067726, 5320.7990021382475, 3529.1911676889804, 5690.929924819631, 2849.422313519992, 3674.9362211670236, 1205.5387398628584, 1383.798556749135, 2813.7599930638453, 8090.301253447667, 7971.574293236789, 2976.0096927104028, 6743.088498497248, 2993.694034102077, 7142.63812791449, 3221.661166134105, 8900.705980511628, 7673.0680310769385, 6177.996126831784, 63.92441299102782, 2485.646232882554, 2889.0782567171004, 2118.330522390888, 2576.6991075324086, 7156.156922340701, 2012.1826802103676, 3202.5885052419108, 5755.917924907996, 5712.563096563088, 2045.9135844271764, 4021.9867624209423, 5357.53775830624, 8580.894916603376, 1836.2720481112813, 6666.958499011262, 7793.319134885499, 6531.118913319144, 8619.892909044122, 4553.0726296886405, 2214.860287718986, 1810.5361385338379, 3070.5625339537883, 2008.763980661368, 590.240430972639, 3253.270299926012, 3826.6799347009783, 3571.596070629408, 5358.880300153649, 4905.195936500042, 3279.4304750848123, 5094.803207576441, 1720.6696897414333, 7083.275783572741, 5456.200620412182, 2442.1119584060093, 4908.104691233816, 2799.5382896119213, 3185.146215099388, 1934.1895339235741, 4781.522577488596, 2738.928406315694, 6429.2907675108545, 2412.000583062641, 7629.983158200175, 3598.273460859767, 6984.526806725703, 2136.798678459217, 3443.732513261819, 4851.89974725921, 4912.702690037128, 1934.37792138771, 4181.7086101317755, 2506.396004812965, 7475.86476070893, 3319.7393160706797, 2408.454923225542, 6349.371430312442, 5294.115672665254, 7993.630367877905, 7575.212186875008, 3270.9574962378488, 4800.72481029257, 5965.642648514688, 3934.8097432374607, 3622.8462711559414, 5265.454599715392, 1125.290332380488, 9311.898722109758, 2303.240972391158, 5899.007109600315, 470.451045631635], "policy_adversary_policy_reward": [-10783.75785867438, -7934.558880470992, -8599.105491788117, -4564.32344819935, -1532.5571358916536, -1103.905040527994, -6796.188078205208, -4834.668001823593, -5901.281369233055, -9111.262126936273, -6230.560226116327, -5998.6269090094265, -7711.567580575408, -7194.103838809323, -6252.772546873925, -4450.047148786443, -9229.612513866618, -9731.032043536188, -6541.206545939077, -3826.1664498067726, -7206.628890571358, -5320.7990021382475, -6585.080493323942, -3529.1911676889804, -5694.023716232743, -6478.026237564599, -3321.788112419677, -3619.598419327812, -7020.885917751518, -3674.9362211670236, -1615.7543591119738, -1574.3955033263474, -1383.798556749135, -7354.386028520055, -2813.7599930638453, -9157.698166904176, -8091.050698301844, -9595.203999814623, -8330.050629420228, -8181.643764985459, -3669.280411579003, -2994.7445820674234, -8757.65059554413, -6743.088498497248, -4379.118805101292, -2996.9932168459222, -7625.94745221137, -7283.899286340055, -4024.051021769007, -3616.6934053094205, -8929.571607105356, -9655.711750481632, -7673.0680310769385, -9776.53105091689, -6374.266375474268, -6360.287923979271, -63.92441299102782, -226.24447991303066, -7336.124062724347, -2485.646232882554, -2889.0782567171004, -5478.3190045123, -2118.330522390888, -4454.161423502438, -2576.6991075324086, -5333.766352732101, -7172.177738952034, -7387.965313415, -3432.3764599807114, -2034.2948994877027, -3202.5885052419108, -4856.901130141214, -5755.917924907996, -9063.64783434671, -6589.350674504478, -6150.29770320312, -5727.4849628534175, -2045.9135844271764, -4211.143008336944, -4851.044002580379, -6624.928973254474, -5357.53775830624, -8629.237748999765, -8978.437476833602, -1892.7078953899254, -3590.3517998094057, -6666.958499011262, -12060.492147121544, -7793.319134885499, -11538.93893516956, -6533.893625673572, -8906.260116754425, -9986.840263911474, -8622.595542488507, -5650.696717155785, -4954.004671803739, -2735.9704627693727, -2265.8195057632174, -1853.8707852297764, -5845.090864099768, -3076.5799989131074, -5977.831516596988, -2781.368695325736, -2803.0019448925345, -2638.544421433556, -590.240430972639, -6638.521297629942, -3325.754852364418, -3826.6799347009783, -6578.015064591365, -3571.596070629408, -6719.633955516902, -5635.966343403905, -6306.840975471361, -5099.731806132339, -6171.636999919551, -3279.4304750848123, -9054.945421231176, -7527.044126301727, -5094.803207576441, -1720.6696897414333, -4537.783999592067, -7153.310994909307, -7962.01178942597, -5972.013582261271, -5900.096687814844, -7888.909794373442, -2442.1119584060093, -8747.63695352344, -4908.104691233816, -2799.5382896119213, -7224.7157880465875, -4450.900218522738, -3561.295076035182, -2622.777861350093, -1934.1895339235741, -4781.522577488596, -7891.22085043272, -7813.919709340173, -2738.928406315694, -9052.213405740074, -6466.373180010757, -3162.219437558334, -2476.734105425098, -8488.185325256138, -8019.444884785391, -9160.40973449759, -3598.273460859767, -9715.14588533568, -6995.601209810262, -2136.798678459217, -4699.189148782703, -4200.436652788973, -3443.732513261819, -4851.89974725921, -8551.464345401364, -5571.1214539099365, -5379.438977157195, -1934.37792138771, -2660.082649816162, -4181.7086101317755, -5400.927199590654, -5704.048727768018, -2506.396004812965, -8471.357526084497, -7858.946348993086, -3615.0642700934864, -3701.0485112810584, -5554.452604232032, -2408.454923225542, -6366.067581704178, -7475.838206638282, -8738.731600796544, -5294.115672665254, -8488.38508101111, -8021.169041239793, -7575.212186875008, -9845.2655534019, -9833.945232159813, -3270.9574962378488, -4991.065557037342, -5943.019020519698, -6769.518270466485, -5989.123929664067, -5875.214858304061, -3934.8097432374607, -4788.3719802835985, -3628.671771970508, -5265.454599715392, -7624.486579568697, -3895.6752966280324, -1125.290332380488, -9984.631722169794, -9396.563337996044, -2303.240972391158, -6029.57502733419, -7093.898982909008, -5981.757388116925, -470.451045631635, -1504.4377218949433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39629574680988966, "mean_inference_ms": 0.9658514341321002, "mean_action_processing_ms": 0.16647789224682977, "mean_env_wait_ms": 0.05093780184432577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003939390182495117, "StateBufferConnector_ms": 0.002381443977355957, "ViewRequirementAgentConnector_ms": 0.065093994140625}, "num_episodes": 23, "episode_return_max": -226.24447991303066, "episode_return_min": -12060.49214712154, "episode_return_mean": -6664.809308952125}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 560.185641201459, "num_env_steps_trained_throughput_per_sec": 560.185641201459, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 7343.287, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7343.255, "sample_time_ms": 742.1, "learn_time_ms": 6588.969, "learn_throughput": 607.075, "synch_weights_time_ms": 11.722}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 176, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-24", "timestamp": 1723232904, "time_this_iter_s": 7.14462685585022, "time_total_s": 1311.5627932548523, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ab13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1311.5627932548523, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 23.38, "ram_util_percent": 82.23}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9605498887908955, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98966116507848, "policy_loss": -0.004859960945517135, "vf_loss": 9.987654418746631, "vf_explained_var": -0.004853673403461775, "kl": 0.011734437427367083, "entropy": 1.3398793573180834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9462259050557222, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992481630315226, "policy_loss": -0.002746851460160638, "vf_loss": 9.992641297093144, "vf_explained_var": 0.0004619094114454966, "kl": 0.00908529316937482, "entropy": 1.1423857861725741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "env_runners": {"episode_reward_max": -226.24447991303066, "episode_reward_min": -12060.49214712154, "episode_reward_mean": -6653.873720921668, "episode_len_mean": 190.21, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19021, "policy_reward_min": {"agent_policy": 63.92441299102782, "adversary_policy": -12060.492147121544}, "policy_reward_max": {"agent_policy": 9756.087363635821, "adversary_policy": -63.92441299102782}, "policy_reward_mean": {"agent_policy": 4317.150355840421, "adversary_policy": -5485.512038381045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4382.417987845139, -7767.208610636938, -4419.08326094432, -9684.57737707536, -9776.53105091689, -6556.558172621755, -226.24447991303066, -7336.124062724346, -5478.3190045123, -4454.161423502437, -5333.766352732102, -7403.986130026332, -3454.4886792580455, -4856.901130141214, -9063.64783434671, -7027.08528114451, -5727.4849628534175, -5040.200248496383, -6624.928973254474, -9026.780309229987, -3646.7876470880487, -12060.49214712154, -11538.938935169559, -8909.034829108854, -9989.542897355861, -6051.628759270882, -2786.9296808136064, -5888.425510795708, -5983.848981556306, -3575.606659556905, -2638.5444214335557, -6711.005850068348, -6578.015064591366, -6719.633955516902, -6583.9270187216225, -6366.1728695518495, -9054.945421231176, -7527.044126301727, -4537.783999592067, -8032.047000762536, -6415.909649663931, -7888.909794373441, -8747.63695352344, -7224.7157880465875, -4827.049079458535, -2622.7778613500936, -7891.22085043272, -7813.919709340173, -9089.29581823998, -3226.9529599207913, -8877.647051841352, -9160.40973449759, -9726.220288420236, -4699.189148782703, -4200.436652788973, -8551.464345401364, -6037.857741030004, -2660.082649816162, -5400.927199590654, -5704.048727768017, -8854.439114368644, -3996.3734653038655, -5554.452604232032, -7492.534358030019, -8738.731600796544, -8515.923754373003, -9845.2655534019, -9833.945232159811, -6133.359767264472, -6792.999551615867, -5875.21485830406, -4794.197481098165, -7624.486579568703, -3895.675296628033, -10069.29633805606, -6029.57502733419, -7176.649261425618, -1504.4377218949433, -5573.966587091075, -3626.6115359911023, -10131.059706086724, -5511.430134390942, -9374.324775910336, -3579.9881869415076, -9962.02242802532, -2966.7674156547428, -9300.767013612693, -6084.547357982604, -9964.32442598428, -6493.769564460164, -8070.773997741208, -2918.51624733591, -8299.96570105086, -6639.777459240997, -10929.926628778754, -5888.809504207905, -9549.806210778324, -4343.792814693537, -2789.6090709439604, -11071.734647337093], "episode_lengths": [200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 145, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 199, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 67, 200, 200, 200, 200, 200, 83, 200, 194, 200, 200, 200, 200, 200, 168, 200, 200, 200, 200, 200, 200, 141, 200], "policy_agent_policy_reward": [2993.694034102077, 7142.63812791449, 3221.661166134105, 8900.705980511628, 7673.0680310769385, 6177.996126831784, 63.92441299102782, 2485.646232882554, 2889.0782567171004, 2118.330522390888, 2576.6991075324086, 7156.156922340701, 2012.1826802103676, 3202.5885052419108, 5755.917924907996, 5712.563096563088, 2045.9135844271764, 4021.9867624209423, 5357.53775830624, 8580.894916603376, 1836.2720481112813, 6666.958499011262, 7793.319134885499, 6531.118913319144, 8619.892909044122, 4553.0726296886405, 2214.860287718986, 1810.5361385338379, 3070.5625339537883, 2008.763980661368, 590.240430972639, 3253.270299926012, 3826.6799347009783, 3571.596070629408, 5358.880300153649, 4905.195936500042, 3279.4304750848123, 5094.803207576441, 1720.6696897414333, 7083.275783572741, 5456.200620412182, 2442.1119584060093, 4908.104691233816, 2799.5382896119213, 3185.146215099388, 1934.1895339235741, 4781.522577488596, 2738.928406315694, 6429.2907675108545, 2412.000583062641, 7629.983158200175, 3598.273460859767, 6984.526806725703, 2136.798678459217, 3443.732513261819, 4851.89974725921, 4912.702690037128, 1934.37792138771, 4181.7086101317755, 2506.396004812965, 7475.86476070893, 3319.7393160706797, 2408.454923225542, 6349.371430312442, 5294.115672665254, 7993.630367877905, 7575.212186875008, 3270.9574962378488, 4800.72481029257, 5965.642648514688, 3934.8097432374607, 3622.8462711559414, 5265.454599715392, 1125.290332380488, 9311.898722109758, 2303.240972391158, 5899.007109600315, 470.451045631635, 4003.571099096145, 1817.8609576638735, 6733.3263123757115, 4127.895077554165, 3729.9836823157475, 1065.5338569821029, 5189.832602413462, 1837.4571526405196, 6264.523643199392, 2787.4909649699275, 3943.3960562595435, 1823.9322608524355, 5913.170350882827, 1032.2698955976498, 6494.011105237659, 4592.411886345538, 4799.971511787171, 4158.2111231413855, 7371.993890434919, 3547.8727956680864, 1191.5029978920163, 9756.087363635821], "policy_adversary_policy_reward": [-4379.118805101292, -2996.9932168459222, -7625.94745221137, -7283.899286340055, -4024.051021769007, -3616.6934053094205, -8929.571607105356, -9655.711750481632, -7673.0680310769385, -9776.53105091689, -6374.266375474268, -6360.287923979271, -63.92441299102782, -226.24447991303066, -7336.124062724347, -2485.646232882554, -2889.0782567171004, -5478.3190045123, -2118.330522390888, -4454.161423502438, -2576.6991075324086, -5333.766352732101, -7172.177738952034, -7387.965313415, -3432.3764599807114, -2034.2948994877027, -3202.5885052419108, -4856.901130141214, -5755.917924907996, -9063.64783434671, -6589.350674504478, -6150.29770320312, -5727.4849628534175, -2045.9135844271764, -4211.143008336944, -4851.044002580379, -6624.928973254474, -5357.53775830624, -8629.237748999765, -8978.437476833602, -1892.7078953899254, -3590.3517998094057, -6666.958499011262, -12060.492147121544, -7793.319134885499, -11538.93893516956, -6533.893625673572, -8906.260116754425, -9986.840263911474, -8622.595542488507, -5650.696717155785, -4954.004671803739, -2735.9704627693727, -2265.8195057632174, -1853.8707852297764, -5845.090864099768, -3076.5799989131074, -5977.831516596988, -2781.368695325736, -2803.0019448925345, -2638.544421433556, -590.240430972639, -6638.521297629942, -3325.754852364418, -3826.6799347009783, -6578.015064591365, -3571.596070629408, -6719.633955516902, -5635.966343403905, -6306.840975471361, -5099.731806132339, -6171.636999919551, -3279.4304750848123, -9054.945421231176, -7527.044126301727, -5094.803207576441, -1720.6696897414333, -4537.783999592067, -7153.310994909307, -7962.01178942597, -5972.013582261271, -5900.096687814844, -7888.909794373442, -2442.1119584060093, -8747.63695352344, -4908.104691233816, -2799.5382896119213, -7224.7157880465875, -4450.900218522738, -3561.295076035182, -2622.777861350093, -1934.1895339235741, -4781.522577488596, -7891.22085043272, -7813.919709340173, -2738.928406315694, -9052.213405740074, -6466.373180010757, -3162.219437558334, -2476.734105425098, -8488.185325256138, -8019.444884785391, -9160.40973449759, -3598.273460859767, -9715.14588533568, -6995.601209810262, -2136.798678459217, -4699.189148782703, -4200.436652788973, -3443.732513261819, -4851.89974725921, -8551.464345401364, -5571.1214539099365, -5379.438977157195, -1934.37792138771, -2660.082649816162, -4181.7086101317755, -5400.927199590654, -5704.048727768018, -2506.396004812965, -8471.357526084497, -7858.946348993086, -3615.0642700934864, -3701.0485112810584, -5554.452604232032, -2408.454923225542, -6366.067581704178, -7475.838206638282, -8738.731600796544, -5294.115672665254, -8488.38508101111, -8021.169041239793, -7575.212186875008, -9845.2655534019, -9833.945232159813, -3270.9574962378488, -4991.065557037342, -5943.019020519698, -6769.518270466485, -5989.123929664067, -5875.214858304061, -3934.8097432374607, -4788.3719802835985, -3628.671771970508, -5265.454599715392, -7624.486579568697, -3895.6752966280324, -1125.290332380488, -9984.631722169794, -9396.563337996044, -2303.240972391158, -6029.57502733419, -7093.898982909008, -5981.757388116925, -470.451045631635, -1504.4377218949433, -5421.3898149022225, -4156.147871284997, -2866.706488145886, -2577.766005509104, -10131.059706086726, -6733.3263123757115, -5511.430134390944, -4127.895077554165, -9374.324775910336, -3729.9836823157475, -1065.5338569821029, -3579.9881869415076, -9962.02242802532, -5189.832602413462, -2909.677024448715, -1894.5475438465471, -6264.523643199392, -9300.767013612693, -6084.547357982604, -2787.4909649699275, -9964.324425984281, -3943.3960562595435, -6493.7695644601645, -1823.9322608524355, -5913.170350882827, -8070.773997741208, -2918.51624733591, -1032.2698955976498, -8299.332107919876, -6494.644698368643, -5924.6297183122115, -5307.559627274321, -10929.926628778754, -4799.971511787171, -5881.7108453530755, -4165.309781996214, -7371.993890434919, -9549.806210778324, -3622.827551954055, -4268.838058407571, -2789.6090709439595, -1191.5029978920163, -10063.92769613314, -10763.894314839774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3962144729306487, "mean_inference_ms": 0.9645650372689236, "mean_action_processing_ms": 0.16642797685057256, "mean_env_wait_ms": 0.05094816464760916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038548707962036133, "StateBufferConnector_ms": 0.0023365020751953125, "ViewRequirementAgentConnector_ms": 0.0633702278137207}, "num_episodes": 22, "episode_return_max": -226.24447991303066, "episode_return_min": -12060.49214712154, "episode_return_mean": -6653.873720921668}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 564.3569368874614, "num_env_steps_trained_throughput_per_sec": 564.3569368874614, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2124000, "timers": {"training_iteration_time_ms": 7305.014, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7304.982, "sample_time_ms": 739.617, "learn_time_ms": 6553.588, "learn_throughput": 610.353, "synch_weights_time_ms": 11.32}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "done": false, "training_iteration": 177, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-32", "timestamp": 1723232912, "time_this_iter_s": 7.0920939445495605, "time_total_s": 1318.6548871994019, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31dde50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1318.6548871994019, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 22.68181818181818, "ram_util_percent": 81.93636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9587139809193711, "cur_kl_coeff": 0.5851777930691042, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99051641424497, "policy_loss": -0.0017640283098444343, "vf_loss": 9.989595405260722, "vf_explained_var": -0.006299329300721486, "kl": 0.004588414418928248, "entropy": 1.294052577142914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9510398344861136, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993304460515422, "policy_loss": -0.0030020571289160265, "vf_loss": 9.994074202845336, "vf_explained_var": 0.0010557313760121664, "kl": 0.00783909203745819, "entropy": 1.1415146921677564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": -1504.4377218949433, "episode_reward_min": -12060.49214712154, "episode_reward_mean": -6854.586281715922, "episode_len_mean": 191.45, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19145, "policy_reward_min": {"agent_policy": 470.451045631635, "adversary_policy": -12060.492147121544}, "policy_reward_max": {"agent_policy": 9949.902219846945, "adversary_policy": -470.451045631635}, "policy_reward_mean": {"agent_policy": 4322.26874218939, "adversary_policy": -5588.4275119526565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3646.7876470880487, -12060.49214712154, -11538.938935169559, -8909.034829108854, -9989.542897355861, -6051.628759270882, -2786.9296808136064, -5888.425510795708, -5983.848981556306, -3575.606659556905, -2638.5444214335557, -6711.005850068348, -6578.015064591366, -6719.633955516902, -6583.9270187216225, -6366.1728695518495, -9054.945421231176, -7527.044126301727, -4537.783999592067, -8032.047000762536, -6415.909649663931, -7888.909794373441, -8747.63695352344, -7224.7157880465875, -4827.049079458535, -2622.7778613500936, -7891.22085043272, -7813.919709340173, -9089.29581823998, -3226.9529599207913, -8877.647051841352, -9160.40973449759, -9726.220288420236, -4699.189148782703, -4200.436652788973, -8551.464345401364, -6037.857741030004, -2660.082649816162, -5400.927199590654, -5704.048727768017, -8854.439114368644, -3996.3734653038655, -5554.452604232032, -7492.534358030019, -8738.731600796544, -8515.923754373003, -9845.2655534019, -9833.945232159811, -6133.359767264472, -6792.999551615867, -5875.21485830406, -4794.197481098165, -7624.486579568703, -3895.675296628033, -10069.29633805606, -6029.57502733419, -7176.649261425618, -1504.4377218949433, -5573.966587091075, -3626.6115359911023, -10131.059706086724, -5511.430134390942, -9374.324775910336, -3579.9881869415076, -9962.02242802532, -2966.7674156547428, -9300.767013612693, -6084.547357982604, -9964.32442598428, -6493.769564460164, -8070.773997741208, -2918.51624733591, -8299.96570105086, -6639.777459240997, -10929.926628778754, -5888.809504207905, -9549.806210778324, -4343.792814693537, -2789.6090709439604, -11071.734647337093, -5374.190747006651, -8063.320068906967, -4025.497926646047, -2366.2021984918224, -7832.988406467783, -3753.8990359871555, -10336.374603168504, -5520.363495327665, -2909.173521993017, -7389.816876228592, -8607.338577743569, -9371.770092653813, -11185.809409506666, -8030.513981182983, -5709.581502955537, -9191.23681706348, -8729.76801097819, -8085.20022152016, -10274.608392629834, -6954.097525142644], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 199, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 67, 200, 200, 200, 200, 200, 83, 200, 194, 200, 200, 200, 200, 200, 168, 200, 200, 200, 200, 200, 200, 141, 200, 200, 200, 200, 189, 200, 200, 200, 200, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1836.2720481112813, 6666.958499011262, 7793.319134885499, 6531.118913319144, 8619.892909044122, 4553.0726296886405, 2214.860287718986, 1810.5361385338379, 3070.5625339537883, 2008.763980661368, 590.240430972639, 3253.270299926012, 3826.6799347009783, 3571.596070629408, 5358.880300153649, 4905.195936500042, 3279.4304750848123, 5094.803207576441, 1720.6696897414333, 7083.275783572741, 5456.200620412182, 2442.1119584060093, 4908.104691233816, 2799.5382896119213, 3185.146215099388, 1934.1895339235741, 4781.522577488596, 2738.928406315694, 6429.2907675108545, 2412.000583062641, 7629.983158200175, 3598.273460859767, 6984.526806725703, 2136.798678459217, 3443.732513261819, 4851.89974725921, 4912.702690037128, 1934.37792138771, 4181.7086101317755, 2506.396004812965, 7475.86476070893, 3319.7393160706797, 2408.454923225542, 6349.371430312442, 5294.115672665254, 7993.630367877905, 7575.212186875008, 3270.9574962378488, 4800.72481029257, 5965.642648514688, 3934.8097432374607, 3622.8462711559414, 5265.454599715392, 1125.290332380488, 9311.898722109758, 2303.240972391158, 5899.007109600315, 470.451045631635, 4003.571099096145, 1817.8609576638735, 6733.3263123757115, 4127.895077554165, 3729.9836823157475, 1065.5338569821029, 5189.832602413462, 1837.4571526405196, 6264.523643199392, 2787.4909649699275, 3943.3960562595435, 1823.9322608524355, 5913.170350882827, 1032.2698955976498, 6494.011105237659, 4592.411886345538, 4799.971511787171, 4158.2111231413855, 7371.993890434919, 3547.8727956680864, 1191.5029978920163, 9756.087363635821, 2844.5439192444724, 6229.718886752158, 2145.449060794553, 1507.4916978940548, 3152.395066136043, 2729.8435402857194, 8761.663053903147, 5042.379900623322, 1288.250901117421, 2026.4784793109015, 4604.376716768902, 5327.85710226758, 9949.902219846945, 7094.773778059844, 3479.7239491625146, 6587.192412138622, 2835.3753745930403, 5955.532427436941, 6594.072976118415, 2444.001322549083], "policy_adversary_policy_reward": [-1892.7078953899254, -3590.3517998094057, -6666.958499011262, -12060.492147121544, -7793.319134885499, -11538.93893516956, -6533.893625673572, -8906.260116754425, -9986.840263911474, -8622.595542488507, -5650.696717155785, -4954.004671803739, -2735.9704627693727, -2265.8195057632174, -1853.8707852297764, -5845.090864099768, -3076.5799989131074, -5977.831516596988, -2781.368695325736, -2803.0019448925345, -2638.544421433556, -590.240430972639, -6638.521297629942, -3325.754852364418, -3826.6799347009783, -6578.015064591365, -3571.596070629408, -6719.633955516902, -5635.966343403905, -6306.840975471361, -5099.731806132339, -6171.636999919551, -3279.4304750848123, -9054.945421231176, -7527.044126301727, -5094.803207576441, -1720.6696897414333, -4537.783999592067, -7153.310994909307, -7962.01178942597, -5972.013582261271, -5900.096687814844, -7888.909794373442, -2442.1119584060093, -8747.63695352344, -4908.104691233816, -2799.5382896119213, -7224.7157880465875, -4450.900218522738, -3561.295076035182, -2622.777861350093, -1934.1895339235741, -4781.522577488596, -7891.22085043272, -7813.919709340173, -2738.928406315694, -9052.213405740074, -6466.373180010757, -3162.219437558334, -2476.734105425098, -8488.185325256138, -8019.444884785391, -9160.40973449759, -3598.273460859767, -9715.14588533568, -6995.601209810262, -2136.798678459217, -4699.189148782703, -4200.436652788973, -3443.732513261819, -4851.89974725921, -8551.464345401364, -5571.1214539099365, -5379.438977157195, -1934.37792138771, -2660.082649816162, -4181.7086101317755, -5400.927199590654, -5704.048727768018, -2506.396004812965, -8471.357526084497, -7858.946348993086, -3615.0642700934864, -3701.0485112810584, -5554.452604232032, -2408.454923225542, -6366.067581704178, -7475.838206638282, -8738.731600796544, -5294.115672665254, -8488.38508101111, -8021.169041239793, -7575.212186875008, -9845.2655534019, -9833.945232159813, -3270.9574962378488, -4991.065557037342, -5943.019020519698, -6769.518270466485, -5989.123929664067, -5875.214858304061, -3934.8097432374607, -4788.3719802835985, -3628.671771970508, -5265.454599715392, -7624.486579568697, -3895.6752966280324, -1125.290332380488, -9984.631722169794, -9396.563337996044, -2303.240972391158, -6029.57502733419, -7093.898982909008, -5981.757388116925, -470.451045631635, -1504.4377218949433, -5421.3898149022225, -4156.147871284997, -2866.706488145886, -2577.766005509104, -10131.059706086726, -6733.3263123757115, -5511.430134390944, -4127.895077554165, -9374.324775910336, -3729.9836823157475, -1065.5338569821029, -3579.9881869415076, -9962.02242802532, -5189.832602413462, -2909.677024448715, -1894.5475438465471, -6264.523643199392, -9300.767013612693, -6084.547357982604, -2787.4909649699275, -9964.324425984281, -3943.3960562595435, -6493.7695644601645, -1823.9322608524355, -5913.170350882827, -8070.773997741208, -2918.51624733591, -1032.2698955976498, -8299.332107919876, -6494.644698368643, -5924.6297183122115, -5307.559627274321, -10929.926628778754, -4799.971511787171, -5881.7108453530755, -4165.309781996214, -7371.993890434919, -9549.806210778324, -3622.827551954055, -4268.838058407571, -2789.6090709439595, -1191.5029978920163, -10063.92769613314, -10763.894314839774, -2850.3810036506566, -5368.3536626004625, -6244.404597904359, -8048.634357754766, -2145.6323679846355, -4025.314619455965, -1507.5793797690292, -2366.1145166168485, -7832.9884064677835, -3152.395066136043, -3090.3126452858482, -3393.4299309870253, -9866.457300453223, -9231.580356618419, -5204.944868513939, -5357.798527437043, -2909.1735219930174, -1288.250901117421, -7389.816876228592, -2026.4784793109015, -4604.376716768902, -8607.338577743569, -9371.770092653811, -5327.85710226758, -11030.649259677233, -10105.062369676378, -7447.20072403457, -7678.087035208255, -5709.581502955537, -3479.7239491625146, -6587.192412138622, -9191.23681706348, -2835.3753745930403, -8729.76801097819, -5969.16926679877, -8071.563382158337, -6594.072976118415, -10274.608392629834, -6954.0975251426435, -2444.001322549083]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39602476636652606, "mean_inference_ms": 0.965111573192821, "mean_action_processing_ms": 0.16640046568703798, "mean_env_wait_ms": 0.05092283034795531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003928184509277344, "StateBufferConnector_ms": 0.0023474693298339844, "ViewRequirementAgentConnector_ms": 0.06673884391784668}, "num_episodes": 20, "episode_return_max": -1504.4377218949433, "episode_return_min": -12060.49214712154, "episode_return_mean": -6854.586281715922}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 560.0518991880838, "num_env_steps_trained_throughput_per_sec": 560.0518991880838, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 7293.414, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7293.382, "sample_time_ms": 737.972, "learn_time_ms": 6543.686, "learn_throughput": 611.276, "synch_weights_time_ms": 11.267}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 178, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-39", "timestamp": 1723232919, "time_this_iter_s": 7.147408723831177, "time_total_s": 1325.802295923233, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ddee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1325.802295923233, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 23.740000000000002, "ram_util_percent": 81.49000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9723719594068825, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.989672868450482, "policy_loss": -0.005575108632910997, "vf_loss": 9.993539764483769, "vf_explained_var": -0.00526400754849116, "kl": 0.005838276554519932, "entropy": 1.308093703041474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9275418752242648, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992198764457905, "policy_loss": -0.005014538677488133, "vf_loss": 9.994423305168354, "vf_explained_var": -0.0012629684001680404, "kl": 0.009797513409315672, "entropy": 1.08735129757533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "env_runners": {"episode_reward_max": -1312.3823973963956, "episode_reward_min": -12468.273065435971, "episode_reward_mean": -6943.7023221918525, "episode_len_mean": 192.2, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19220, "policy_reward_min": {"agent_policy": 470.451045631635, "adversary_policy": -12468.273065435971}, "policy_reward_max": {"agent_policy": 10415.003750727763, "adversary_policy": -470.451045631635}, "policy_reward_mean": {"agent_policy": 4429.4980053042655, "adversary_policy": -5686.600163748059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8032.047000762536, -6415.909649663931, -7888.909794373441, -8747.63695352344, -7224.7157880465875, -4827.049079458535, -2622.7778613500936, -7891.22085043272, -7813.919709340173, -9089.29581823998, -3226.9529599207913, -8877.647051841352, -9160.40973449759, -9726.220288420236, -4699.189148782703, -4200.436652788973, -8551.464345401364, -6037.857741030004, -2660.082649816162, -5400.927199590654, -5704.048727768017, -8854.439114368644, -3996.3734653038655, -5554.452604232032, -7492.534358030019, -8738.731600796544, -8515.923754373003, -9845.2655534019, -9833.945232159811, -6133.359767264472, -6792.999551615867, -5875.21485830406, -4794.197481098165, -7624.486579568703, -3895.675296628033, -10069.29633805606, -6029.57502733419, -7176.649261425618, -1504.4377218949433, -5573.966587091075, -3626.6115359911023, -10131.059706086724, -5511.430134390942, -9374.324775910336, -3579.9881869415076, -9962.02242802532, -2966.7674156547428, -9300.767013612693, -6084.547357982604, -9964.32442598428, -6493.769564460164, -8070.773997741208, -2918.51624733591, -8299.96570105086, -6639.777459240997, -10929.926628778754, -5888.809504207905, -9549.806210778324, -4343.792814693537, -2789.6090709439604, -11071.734647337093, -5374.190747006651, -8063.320068906967, -4025.497926646047, -2366.2021984918224, -7832.988406467783, -3753.8990359871555, -10336.374603168504, -5520.363495327665, -2909.173521993017, -7389.816876228592, -8607.338577743569, -9371.770092653813, -11185.809409506666, -8030.513981182983, -5709.581502955537, -9191.23681706348, -8729.76801097819, -8085.20022152016, -10274.608392629834, -6954.097525142644, -5671.794455168725, -8932.884135915763, -5022.855725789885, -5994.299484350153, -1312.3823973963956, -6850.4466733371655, -6555.21834881384, -3570.638303188596, -8714.123798222783, -7914.3022207195345, -6634.1544263224405, -12468.273065435971, -8209.720763020263, -6653.822425957111, -9832.017302006936, -5822.576391817937, -11171.17774084095, -10175.108436804312, -4554.116727330103], "episode_lengths": [200, 200, 200, 200, 200, 200, 174, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 165, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 67, 200, 200, 200, 200, 200, 83, 200, 194, 200, 200, 200, 200, 200, 168, 200, 200, 200, 200, 200, 200, 141, 200, 200, 200, 200, 189, 200, 200, 200, 200, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7083.275783572741, 5456.200620412182, 2442.1119584060093, 4908.104691233816, 2799.5382896119213, 3185.146215099388, 1934.1895339235741, 4781.522577488596, 2738.928406315694, 6429.2907675108545, 2412.000583062641, 7629.983158200175, 3598.273460859767, 6984.526806725703, 2136.798678459217, 3443.732513261819, 4851.89974725921, 4912.702690037128, 1934.37792138771, 4181.7086101317755, 2506.396004812965, 7475.86476070893, 3319.7393160706797, 2408.454923225542, 6349.371430312442, 5294.115672665254, 7993.630367877905, 7575.212186875008, 3270.9574962378488, 4800.72481029257, 5965.642648514688, 3934.8097432374607, 3622.8462711559414, 5265.454599715392, 1125.290332380488, 9311.898722109758, 2303.240972391158, 5899.007109600315, 470.451045631635, 4003.571099096145, 1817.8609576638735, 6733.3263123757115, 4127.895077554165, 3729.9836823157475, 1065.5338569821029, 5189.832602413462, 1837.4571526405196, 6264.523643199392, 2787.4909649699275, 3943.3960562595435, 1823.9322608524355, 5913.170350882827, 1032.2698955976498, 6494.011105237659, 4592.411886345538, 4799.971511787171, 4158.2111231413855, 7371.993890434919, 3547.8727956680864, 1191.5029978920163, 9756.087363635821, 2844.5439192444724, 6229.718886752158, 2145.449060794553, 1507.4916978940548, 3152.395066136043, 2729.8435402857194, 8761.663053903147, 5042.379900623322, 1288.250901117421, 2026.4784793109015, 4604.376716768902, 5327.85710226758, 9949.902219846945, 7094.773778059844, 3479.7239491625146, 6587.192412138622, 2835.3753745930403, 5955.532427436941, 6594.072976118415, 2444.001322549083, 3150.527796159302, 7018.4806788890055, 2570.1719739819846, 3933.31466845734, 481.0009730298178, 4394.0066526602095, 3306.328804198083, 1954.2979370499427, 3019.9106087827636, 5852.50578505846, 3462.520030909561, 10415.003750727763, 6526.466035307285, 5503.1234661289145, 5940.427334945255, 3446.6284209255764, 7577.422777125372, 5104.995832743529, 3771.9162046206616], "policy_adversary_policy_reward": [-7153.310994909307, -7962.01178942597, -5972.013582261271, -5900.096687814844, -7888.909794373442, -2442.1119584060093, -8747.63695352344, -4908.104691233816, -2799.5382896119213, -7224.7157880465875, -4450.900218522738, -3561.295076035182, -2622.777861350093, -1934.1895339235741, -4781.522577488596, -7891.22085043272, -7813.919709340173, -2738.928406315694, -9052.213405740074, -6466.373180010757, -3162.219437558334, -2476.734105425098, -8488.185325256138, -8019.444884785391, -9160.40973449759, -3598.273460859767, -9715.14588533568, -6995.601209810262, -2136.798678459217, -4699.189148782703, -4200.436652788973, -3443.732513261819, -4851.89974725921, -8551.464345401364, -5571.1214539099365, -5379.438977157195, -1934.37792138771, -2660.082649816162, -4181.7086101317755, -5400.927199590654, -5704.048727768018, -2506.396004812965, -8471.357526084497, -7858.946348993086, -3615.0642700934864, -3701.0485112810584, -5554.452604232032, -2408.454923225542, -6366.067581704178, -7475.838206638282, -8738.731600796544, -5294.115672665254, -8488.38508101111, -8021.169041239793, -7575.212186875008, -9845.2655534019, -9833.945232159813, -3270.9574962378488, -4991.065557037342, -5943.019020519698, -6769.518270466485, -5989.123929664067, -5875.214858304061, -3934.8097432374607, -4788.3719802835985, -3628.671771970508, -5265.454599715392, -7624.486579568697, -3895.6752966280324, -1125.290332380488, -9984.631722169794, -9396.563337996044, -2303.240972391158, -6029.57502733419, -7093.898982909008, -5981.757388116925, -470.451045631635, -1504.4377218949433, -5421.3898149022225, -4156.147871284997, -2866.706488145886, -2577.766005509104, -10131.059706086726, -6733.3263123757115, -5511.430134390944, -4127.895077554165, -9374.324775910336, -3729.9836823157475, -1065.5338569821029, -3579.9881869415076, -9962.02242802532, -5189.832602413462, -2909.677024448715, -1894.5475438465471, -6264.523643199392, -9300.767013612693, -6084.547357982604, -2787.4909649699275, -9964.324425984281, -3943.3960562595435, -6493.7695644601645, -1823.9322608524355, -5913.170350882827, -8070.773997741208, -2918.51624733591, -1032.2698955976498, -8299.332107919876, -6494.644698368643, -5924.6297183122115, -5307.559627274321, -10929.926628778754, -4799.971511787171, -5881.7108453530755, -4165.309781996214, -7371.993890434919, -9549.806210778324, -3622.827551954055, -4268.838058407571, -2789.6090709439595, -1191.5029978920163, -10063.92769613314, -10763.894314839774, -2850.3810036506566, -5368.3536626004625, -6244.404597904359, -8048.634357754766, -2145.6323679846355, -4025.314619455965, -1507.5793797690292, -2366.1145166168485, -7832.9884064677835, -3152.395066136043, -3090.3126452858482, -3393.4299309870253, -9866.457300453223, -9231.580356618419, -5204.944868513939, -5357.798527437043, -2909.1735219930174, -1288.250901117421, -7389.816876228592, -2026.4784793109015, -4604.376716768902, -8607.338577743569, -9371.770092653811, -5327.85710226758, -11030.649259677233, -10105.062369676378, -7447.20072403457, -7678.087035208255, -5709.581502955537, -3479.7239491625146, -6587.192412138622, -9191.23681706348, -2835.3753745930403, -8729.76801097819, -5969.16926679877, -8071.563382158337, -6594.072976118415, -10274.608392629834, -6954.0975251426435, -2444.001322549083, -5579.010397371454, -3243.311853956573, -7018.4806788890055, -8932.884135915763, -2606.716674119124, -4986.311025652748, -4114.0639839933365, -5813.550168814155, -481.0009730298178, -1312.3823973963956, -4394.0066526602095, -6850.446673337165, -6555.21834881384, -3306.328804198083, -1954.2979370499427, -3570.638303188596, -8714.123798222783, -3019.9106087827636, -5852.50578505846, -7914.3022207195345, -6634.15442632244, -3462.520030909561, -12468.273065435971, -10415.003750727763, -7825.552311121755, -6910.63448720579, -6131.5610324315985, -6025.384859654428, -5940.427334945255, -9832.017302006936, -3446.6284209255764, -5822.576391817937, -7577.422777125372, -11171.17774084095, -10175.10843680431, -5104.995832743529, -3779.958079158039, -4546.074852792725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960332082033184, "mean_inference_ms": 0.9640619879975477, "mean_action_processing_ms": 0.16631161022497495, "mean_env_wait_ms": 0.050925116121089894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003867030143737793, "StateBufferConnector_ms": 0.002305150032043457, "ViewRequirementAgentConnector_ms": 0.0657494068145752}, "num_episodes": 19, "episode_return_max": -1312.3823973963956, "episode_return_min": -12468.273065435971, "episode_return_mean": -6943.7023221918525}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 567.0527242059311, "num_env_steps_trained_throughput_per_sec": 567.0527242059311, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2148000, "timers": {"training_iteration_time_ms": 7203.677, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7203.645, "sample_time_ms": 727.26, "learn_time_ms": 6465.018, "learn_throughput": 618.714, "synch_weights_time_ms": 10.911}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "done": false, "training_iteration": 179, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-46", "timestamp": 1723232926, "time_this_iter_s": 7.059254169464111, "time_total_s": 1332.8615500926971, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ec550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1332.8615500926971, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 22.81, "ram_util_percent": 81.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9779735438836118, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98315823872884, "policy_loss": -0.0050481104762487424, "vf_loss": 9.984579528371492, "vf_explained_var": -0.006010288372635841, "kl": 0.012395566194027197, "entropy": 1.3005456294864417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9087194866604276, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987957725827656, "policy_loss": -0.003336348387328957, "vf_loss": 9.988121022118463, "vf_explained_var": -0.0012769914177990463, "kl": 0.011142678117064177, "entropy": 1.016126023903095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": -489.9946280077378, "episode_reward_min": -12468.273065435971, "episode_reward_mean": -7027.457884232728, "episode_len_mean": 189.15, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18915, "policy_reward_min": {"agent_policy": 349.3359592031699, "adversary_policy": -12468.273065435971}, "policy_reward_max": {"agent_policy": 10415.003750727763, "adversary_policy": -391.2611707858401}, "policy_reward_mean": {"agent_policy": 4431.947766733934, "adversary_policy": -5729.70282548333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7492.534358030019, -8738.731600796544, -8515.923754373003, -9845.2655534019, -9833.945232159811, -6133.359767264472, -6792.999551615867, -5875.21485830406, -4794.197481098165, -7624.486579568703, -3895.675296628033, -10069.29633805606, -6029.57502733419, -7176.649261425618, -1504.4377218949433, -5573.966587091075, -3626.6115359911023, -10131.059706086724, -5511.430134390942, -9374.324775910336, -3579.9881869415076, -9962.02242802532, -2966.7674156547428, -9300.767013612693, -6084.547357982604, -9964.32442598428, -6493.769564460164, -8070.773997741208, -2918.51624733591, -8299.96570105086, -6639.777459240997, -10929.926628778754, -5888.809504207905, -9549.806210778324, -4343.792814693537, -2789.6090709439604, -11071.734647337093, -5374.190747006651, -8063.320068906967, -4025.497926646047, -2366.2021984918224, -7832.988406467783, -3753.8990359871555, -10336.374603168504, -5520.363495327665, -2909.173521993017, -7389.816876228592, -8607.338577743569, -9371.770092653813, -11185.809409506666, -8030.513981182983, -5709.581502955537, -9191.23681706348, -8729.76801097819, -8085.20022152016, -10274.608392629834, -6954.097525142644, -5671.794455168725, -8932.884135915763, -5022.855725789885, -5994.299484350153, -1312.3823973963956, -6850.4466733371655, -6555.21834881384, -3570.638303188596, -8714.123798222783, -7914.3022207195345, -6634.1544263224405, -12468.273065435971, -8209.720763020263, -6653.822425957111, -9832.017302006936, -5822.576391817937, -11171.17774084095, -10175.108436804312, -4554.116727330103, -9560.52637145873, -10456.60777866776, -9816.498295491092, -5719.497986852235, -5782.390555742701, -7729.04175109088, -8729.102499812952, -9773.955109045684, -7704.964338196845, -1331.4770013681778, -9110.70863870591, -8708.704117448595, -9421.625234896586, -6803.1361084198925, -6616.144956938174, -489.9946280077378, -4721.127330315102, -6417.5093800345, -7343.186450418993, -9772.622793314378, -6880.171089860923, -5813.2557742114395, -2048.4973546698425, -4828.794848072245], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 91, 200, 200, 200, 67, 200, 200, 200, 200, 200, 83, 200, 194, 200, 200, 200, 200, 200, 168, 200, 200, 200, 200, 200, 200, 141, 200, 200, 200, 200, 189, 200, 200, 200, 200, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 85, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 180, 200, 178, 149], "policy_agent_policy_reward": [6349.371430312442, 5294.115672665254, 7993.630367877905, 7575.212186875008, 3270.9574962378488, 4800.72481029257, 5965.642648514688, 3934.8097432374607, 3622.8462711559414, 5265.454599715392, 1125.290332380488, 9311.898722109758, 2303.240972391158, 5899.007109600315, 470.451045631635, 4003.571099096145, 1817.8609576638735, 6733.3263123757115, 4127.895077554165, 3729.9836823157475, 1065.5338569821029, 5189.832602413462, 1837.4571526405196, 6264.523643199392, 2787.4909649699275, 3943.3960562595435, 1823.9322608524355, 5913.170350882827, 1032.2698955976498, 6494.011105237659, 4592.411886345538, 4799.971511787171, 4158.2111231413855, 7371.993890434919, 3547.8727956680864, 1191.5029978920163, 9756.087363635821, 2844.5439192444724, 6229.718886752158, 2145.449060794553, 1507.4916978940548, 3152.395066136043, 2729.8435402857194, 8761.663053903147, 5042.379900623322, 1288.250901117421, 2026.4784793109015, 4604.376716768902, 5327.85710226758, 9949.902219846945, 7094.773778059844, 3479.7239491625146, 6587.192412138622, 2835.3753745930403, 5955.532427436941, 6594.072976118415, 2444.001322549083, 3150.527796159302, 7018.4806788890055, 2570.1719739819846, 3933.31466845734, 481.0009730298178, 4394.0066526602095, 3306.328804198083, 1954.2979370499427, 3019.9106087827636, 5852.50578505846, 3462.520030909561, 10415.003750727763, 6526.466035307285, 5503.1234661289145, 5940.427334945255, 3446.6284209255764, 7577.422777125372, 5104.995832743529, 3771.9162046206616, 7647.649719952861, 9782.434507017504, 7308.134571961858, 5229.062062876418, 2742.0194638590583, 3126.6268418102804, 2970.2893536126353, 7576.986812124591, 5866.4397244515685, 490.8572606169653, 7129.137142941998, 7051.060931854704, 5434.363694826454, 5939.64577525413, 5122.338310112352, 349.3359592031699, 4093.762264371257, 1074.2604477349291, 2944.2371917800465, 2018.6539048330467, 882.9668516799143, 2426.6499159157383, 1396.797395536721, 1196.0340564167468], "policy_adversary_policy_reward": [-6366.067581704178, -7475.838206638282, -8738.731600796544, -5294.115672665254, -8488.38508101111, -8021.169041239793, -7575.212186875008, -9845.2655534019, -9833.945232159813, -3270.9574962378488, -4991.065557037342, -5943.019020519698, -6769.518270466485, -5989.123929664067, -5875.214858304061, -3934.8097432374607, -4788.3719802835985, -3628.671771970508, -5265.454599715392, -7624.486579568697, -3895.6752966280324, -1125.290332380488, -9984.631722169794, -9396.563337996044, -2303.240972391158, -6029.57502733419, -7093.898982909008, -5981.757388116925, -470.451045631635, -1504.4377218949433, -5421.3898149022225, -4156.147871284997, -2866.706488145886, -2577.766005509104, -10131.059706086726, -6733.3263123757115, -5511.430134390944, -4127.895077554165, -9374.324775910336, -3729.9836823157475, -1065.5338569821029, -3579.9881869415076, -9962.02242802532, -5189.832602413462, -2909.677024448715, -1894.5475438465471, -6264.523643199392, -9300.767013612693, -6084.547357982604, -2787.4909649699275, -9964.324425984281, -3943.3960562595435, -6493.7695644601645, -1823.9322608524355, -5913.170350882827, -8070.773997741208, -2918.51624733591, -1032.2698955976498, -8299.332107919876, -6494.644698368643, -5924.6297183122115, -5307.559627274321, -10929.926628778754, -4799.971511787171, -5881.7108453530755, -4165.309781996214, -7371.993890434919, -9549.806210778324, -3622.827551954055, -4268.838058407571, -2789.6090709439595, -1191.5029978920163, -10063.92769613314, -10763.894314839774, -2850.3810036506566, -5368.3536626004625, -6244.404597904359, -8048.634357754766, -2145.6323679846355, -4025.314619455965, -1507.5793797690292, -2366.1145166168485, -7832.9884064677835, -3152.395066136043, -3090.3126452858482, -3393.4299309870253, -9866.457300453223, -9231.580356618419, -5204.944868513939, -5357.798527437043, -2909.1735219930174, -1288.250901117421, -7389.816876228592, -2026.4784793109015, -4604.376716768902, -8607.338577743569, -9371.770092653811, -5327.85710226758, -11030.649259677233, -10105.062369676378, -7447.20072403457, -7678.087035208255, -5709.581502955537, -3479.7239491625146, -6587.192412138622, -9191.23681706348, -2835.3753745930403, -8729.76801097819, -5969.16926679877, -8071.563382158337, -6594.072976118415, -10274.608392629834, -6954.0975251426435, -2444.001322549083, -5579.010397371454, -3243.311853956573, -7018.4806788890055, -8932.884135915763, -2606.716674119124, -4986.311025652748, -4114.0639839933365, -5813.550168814155, -481.0009730298178, -1312.3823973963956, -4394.0066526602095, -6850.446673337165, -6555.21834881384, -3306.328804198083, -1954.2979370499427, -3570.638303188596, -8714.123798222783, -3019.9106087827636, -5852.50578505846, -7914.3022207195345, -6634.15442632244, -3462.520030909561, -12468.273065435971, -10415.003750727763, -7825.552311121755, -6910.63448720579, -6131.5610324315985, -6025.384859654428, -5940.427334945255, -9832.017302006936, -3446.6284209255764, -5822.576391817937, -7577.422777125372, -11171.17774084095, -10175.10843680431, -5104.995832743529, -3779.958079158039, -4546.074852792725, -7668.238013020907, -9539.938078390694, -9805.96310765366, -10433.079178031609, -7308.134571961858, -9816.498295491092, -5245.987911899757, -5702.572137828893, -5782.3905557427, -2742.0194638590583, -7729.041751090881, -3126.6268418102804, -2970.2893536126353, -8729.102499812952, -9773.955109045684, -7576.986812124591, -5866.4397244515685, -7704.964338196845, -490.8572606169653, -1331.4770013681778, -9110.70863870591, -7129.137142941998, -7051.325887810811, -8708.439161492486, -9421.625234896588, -5434.363694826454, -6686.268965681277, -6056.512917992747, -5123.709153179661, -6614.774113870864, -448.0694164250675, -391.2611707858401, -4656.753705357803, -4158.135889328552, -6417.5093800345, -1074.2604477349291, -2944.2371917800465, -7343.186450418993, -9772.622793314376, -2018.6539048330467, -882.9668516799143, -6880.171089860923, -5812.0600501772315, -2427.8456399499455, -1465.4481644103653, -1979.8465857961985, -1196.0340564167468, -4828.794848072245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957288498198404, "mean_inference_ms": 0.96311687441707, "mean_action_processing_ms": 0.16621439335584598, "mean_env_wait_ms": 0.05089741127454696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003930926322937012, "StateBufferConnector_ms": 0.002253890037536621, "ViewRequirementAgentConnector_ms": 0.06494545936584473}, "num_episodes": 24, "episode_return_max": -489.9946280077378, "episode_return_min": -12468.273065435971, "episode_return_mean": -7027.457884232728}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.9020704760542, "num_env_steps_trained_throughput_per_sec": 557.9020704760542, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 7188.599, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7188.567, "sample_time_ms": 728.564, "learn_time_ms": 6448.323, "learn_throughput": 620.316, "synch_weights_time_ms": 11.226}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 180, "trial_id": "3439d_00000", "date": "2024-08-09_15-48-53", "timestamp": 1723232933, "time_this_iter_s": 7.175148010253906, "time_total_s": 1340.036698102951, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ddca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1340.036698102951, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 22.336363636363636, "ram_util_percent": 81.12727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9419952649623156, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992380926012993, "policy_loss": -0.00731850604400582, "vf_loss": 9.996137754122417, "vf_explained_var": -0.009158161282539368, "kl": 0.012172893750054451, "entropy": 1.2404295533895493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9057770572326801, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997965445341887, "policy_loss": -0.0020953142202444494, "vf_loss": 9.99603808317235, "vf_explained_var": 0.00039680691623183154, "kl": 0.014126270977908341, "entropy": 1.0377753798923794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "env_runners": {"episode_reward_max": -489.9946280077378, "episode_reward_min": -12468.273065435971, "episode_reward_mean": -6958.2593287487925, "episode_len_mean": 191.57, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19157, "policy_reward_min": {"agent_policy": 349.3359592031699, "adversary_policy": -12468.273065435971}, "policy_reward_max": {"agent_policy": 10415.003750727763, "adversary_policy": -391.2611707858401}, "policy_reward_mean": {"agent_policy": 4371.149168138744, "adversary_policy": -5664.704248443767}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3579.9881869415076, -9962.02242802532, -2966.7674156547428, -9300.767013612693, -6084.547357982604, -9964.32442598428, -6493.769564460164, -8070.773997741208, -2918.51624733591, -8299.96570105086, -6639.777459240997, -10929.926628778754, -5888.809504207905, -9549.806210778324, -4343.792814693537, -2789.6090709439604, -11071.734647337093, -5374.190747006651, -8063.320068906967, -4025.497926646047, -2366.2021984918224, -7832.988406467783, -3753.8990359871555, -10336.374603168504, -5520.363495327665, -2909.173521993017, -7389.816876228592, -8607.338577743569, -9371.770092653813, -11185.809409506666, -8030.513981182983, -5709.581502955537, -9191.23681706348, -8729.76801097819, -8085.20022152016, -10274.608392629834, -6954.097525142644, -5671.794455168725, -8932.884135915763, -5022.855725789885, -5994.299484350153, -1312.3823973963956, -6850.4466733371655, -6555.21834881384, -3570.638303188596, -8714.123798222783, -7914.3022207195345, -6634.1544263224405, -12468.273065435971, -8209.720763020263, -6653.822425957111, -9832.017302006936, -5822.576391817937, -11171.17774084095, -10175.108436804312, -4554.116727330103, -9560.52637145873, -10456.60777866776, -9816.498295491092, -5719.497986852235, -5782.390555742701, -7729.04175109088, -8729.102499812952, -9773.955109045684, -7704.964338196845, -1331.4770013681778, -9110.70863870591, -8708.704117448595, -9421.625234896586, -6803.1361084198925, -6616.144956938174, -489.9946280077378, -4721.127330315102, -6417.5093800345, -7343.186450418993, -9772.622793314378, -6880.171089860923, -5813.2557742114395, -2048.4973546698425, -4828.794848072245, -5404.692834647908, -5010.253645767564, -6003.320799267501, -3965.150624872495, -5025.75016033752, -8506.251908887934, -7565.4604855235275, -9453.452391320589, -6553.802197386832, -3890.654316012604, -9777.37486679311, -4770.120116351461, -9091.829619963091, -3252.679273737666, -10710.22923919282, -2925.976233737692, -7205.247939190725, -7132.54577358762, -10210.880623962608, -5164.15652248667], "episode_lengths": [83, 200, 194, 200, 200, 200, 200, 200, 168, 200, 200, 200, 200, 200, 200, 141, 200, 200, 200, 200, 189, 200, 200, 200, 200, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 85, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 180, 200, 178, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1065.5338569821029, 5189.832602413462, 1837.4571526405196, 6264.523643199392, 2787.4909649699275, 3943.3960562595435, 1823.9322608524355, 5913.170350882827, 1032.2698955976498, 6494.011105237659, 4592.411886345538, 4799.971511787171, 4158.2111231413855, 7371.993890434919, 3547.8727956680864, 1191.5029978920163, 9756.087363635821, 2844.5439192444724, 6229.718886752158, 2145.449060794553, 1507.4916978940548, 3152.395066136043, 2729.8435402857194, 8761.663053903147, 5042.379900623322, 1288.250901117421, 2026.4784793109015, 4604.376716768902, 5327.85710226758, 9949.902219846945, 7094.773778059844, 3479.7239491625146, 6587.192412138622, 2835.3753745930403, 5955.532427436941, 6594.072976118415, 2444.001322549083, 3150.527796159302, 7018.4806788890055, 2570.1719739819846, 3933.31466845734, 481.0009730298178, 4394.0066526602095, 3306.328804198083, 1954.2979370499427, 3019.9106087827636, 5852.50578505846, 3462.520030909561, 10415.003750727763, 6526.466035307285, 5503.1234661289145, 5940.427334945255, 3446.6284209255764, 7577.422777125372, 5104.995832743529, 3771.9162046206616, 7647.649719952861, 9782.434507017504, 7308.134571961858, 5229.062062876418, 2742.0194638590583, 3126.6268418102804, 2970.2893536126353, 7576.986812124591, 5866.4397244515685, 490.8572606169653, 7129.137142941998, 7051.060931854704, 5434.363694826454, 5939.64577525413, 5122.338310112352, 349.3359592031699, 4093.762264371257, 1074.2604477349291, 2944.2371917800465, 2018.6539048330467, 882.9668516799143, 2426.6499159157383, 1396.797395536721, 1196.0340564167468, 1342.5209540910116, 3343.0974392959947, 2584.674577626118, 2438.8208374616556, 1495.4984149806696, 7310.944178308656, 1509.7476779173332, 4696.121800849036, 5794.771732220381, 3324.5127516267376, 5899.550862963683, 3148.55861355913, 7824.684798849143, 1899.427383959516, 9097.993616761087, 1837.5475054029935, 6310.280135492324, 4460.239228646457, 9047.368719792103, 4149.069448680497], "policy_adversary_policy_reward": [-1065.5338569821029, -3579.9881869415076, -9962.02242802532, -5189.832602413462, -2909.677024448715, -1894.5475438465471, -6264.523643199392, -9300.767013612693, -6084.547357982604, -2787.4909649699275, -9964.324425984281, -3943.3960562595435, -6493.7695644601645, -1823.9322608524355, -5913.170350882827, -8070.773997741208, -2918.51624733591, -1032.2698955976498, -8299.332107919876, -6494.644698368643, -5924.6297183122115, -5307.559627274321, -10929.926628778754, -4799.971511787171, -5881.7108453530755, -4165.309781996214, -7371.993890434919, -9549.806210778324, -3622.827551954055, -4268.838058407571, -2789.6090709439595, -1191.5029978920163, -10063.92769613314, -10763.894314839774, -2850.3810036506566, -5368.3536626004625, -6244.404597904359, -8048.634357754766, -2145.6323679846355, -4025.314619455965, -1507.5793797690292, -2366.1145166168485, -7832.9884064677835, -3152.395066136043, -3090.3126452858482, -3393.4299309870253, -9866.457300453223, -9231.580356618419, -5204.944868513939, -5357.798527437043, -2909.1735219930174, -1288.250901117421, -7389.816876228592, -2026.4784793109015, -4604.376716768902, -8607.338577743569, -9371.770092653811, -5327.85710226758, -11030.649259677233, -10105.062369676378, -7447.20072403457, -7678.087035208255, -5709.581502955537, -3479.7239491625146, -6587.192412138622, -9191.23681706348, -2835.3753745930403, -8729.76801097819, -5969.16926679877, -8071.563382158337, -6594.072976118415, -10274.608392629834, -6954.0975251426435, -2444.001322549083, -5579.010397371454, -3243.311853956573, -7018.4806788890055, -8932.884135915763, -2606.716674119124, -4986.311025652748, -4114.0639839933365, -5813.550168814155, -481.0009730298178, -1312.3823973963956, -4394.0066526602095, -6850.446673337165, -6555.21834881384, -3306.328804198083, -1954.2979370499427, -3570.638303188596, -8714.123798222783, -3019.9106087827636, -5852.50578505846, -7914.3022207195345, -6634.15442632244, -3462.520030909561, -12468.273065435971, -10415.003750727763, -7825.552311121755, -6910.63448720579, -6131.5610324315985, -6025.384859654428, -5940.427334945255, -9832.017302006936, -3446.6284209255764, -5822.576391817937, -7577.422777125372, -11171.17774084095, -10175.10843680431, -5104.995832743529, -3779.958079158039, -4546.074852792725, -7668.238013020907, -9539.938078390694, -9805.96310765366, -10433.079178031609, -7308.134571961858, -9816.498295491092, -5245.987911899757, -5702.572137828893, -5782.3905557427, -2742.0194638590583, -7729.041751090881, -3126.6268418102804, -2970.2893536126353, -8729.102499812952, -9773.955109045684, -7576.986812124591, -5866.4397244515685, -7704.964338196845, -490.8572606169653, -1331.4770013681778, -9110.70863870591, -7129.137142941998, -7051.325887810811, -8708.439161492486, -9421.625234896588, -5434.363694826454, -6686.268965681277, -6056.512917992747, -5123.709153179661, -6614.774113870864, -448.0694164250675, -391.2611707858401, -4656.753705357803, -4158.135889328552, -6417.5093800345, -1074.2604477349291, -2944.2371917800465, -7343.186450418993, -9772.622793314376, -2018.6539048330467, -882.9668516799143, -6880.171089860923, -5812.0600501772315, -2427.8456399499455, -1465.4481644103653, -1979.8465857961985, -1196.0340564167468, -4828.794848072245, -5404.692834647908, -1342.5209540910116, -5010.253645767564, -3343.0974392959947, -2597.2988829573737, -5990.696493936239, -2442.83260286685, -3961.138859467301, -5024.559766185801, -1496.688809132391, -8421.93177290996, -7395.264314286634, -7565.4604855235275, -1509.7476779173332, -9453.452391320587, -4696.121800849036, -6088.712475102427, -6259.861454504788, -3340.761975558473, -3874.4050920808686, -9777.37486679311, -5899.550862963683, -4744.527539929989, -3174.1511899806046, -7998.0874952877875, -8918.426923524443, -1899.427383959516, -3252.679273737665, -10183.961942913622, -9624.260913040267, -2902.888660199002, -1860.6350789416829, -6311.317695516664, -7204.210379166386, -4460.239228646457, -7132.545773587621, -10202.503843141118, -9055.745500613592, -4493.227112824261, -4819.9988583429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957184035184367, "mean_inference_ms": 0.9629602905176493, "mean_action_processing_ms": 0.16617915499498964, "mean_env_wait_ms": 0.05088931611940049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031936168670654297, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.06527209281921387}, "num_episodes": 20, "episode_return_max": -489.9946280077378, "episode_return_min": -12468.273065435971, "episode_return_mean": -6958.2593287487925}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.5999793595728, "num_env_steps_trained_throughput_per_sec": 510.5999793595728, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2172000, "timers": {"training_iteration_time_ms": 7257.626, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7257.594, "sample_time_ms": 730.421, "learn_time_ms": 6515.325, "learn_throughput": 613.937, "synch_weights_time_ms": 11.396}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "done": false, "training_iteration": 181, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-01", "timestamp": 1723232941, "time_this_iter_s": 7.838450193405151, "time_total_s": 1347.8751482963562, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ec5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1347.8751482963562, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 30.44545454545454, "ram_util_percent": 82.34545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8828862357574204, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.981697883208593, "policy_loss": -0.00961232661793474, "vf_loss": 9.987602462371191, "vf_explained_var": -0.007222726444403331, "kl": 0.01267212733606963, "entropy": 1.17935880869627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9199070458453168, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995984634015926, "policy_loss": -5.4820471014531835e-05, "vf_loss": 9.993284787072076, "vf_explained_var": 0.00030806275902601777, "kl": 0.009673343114949093, "entropy": 1.0080497753683222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": -489.9946280077378, "episode_reward_min": -12468.273065435971, "episode_reward_mean": -6943.903508806712, "episode_len_mean": 193.34, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19334, "policy_reward_min": {"agent_policy": 349.3359592031699, "adversary_policy": -12468.273065435971}, "policy_reward_max": {"agent_policy": 10415.003750727763, "adversary_policy": -391.2611707858401}, "policy_reward_mean": {"agent_policy": 4381.68808701124, "adversary_policy": -5662.795797908977}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4025.497926646047, -2366.2021984918224, -7832.988406467783, -3753.8990359871555, -10336.374603168504, -5520.363495327665, -2909.173521993017, -7389.816876228592, -8607.338577743569, -9371.770092653813, -11185.809409506666, -8030.513981182983, -5709.581502955537, -9191.23681706348, -8729.76801097819, -8085.20022152016, -10274.608392629834, -6954.097525142644, -5671.794455168725, -8932.884135915763, -5022.855725789885, -5994.299484350153, -1312.3823973963956, -6850.4466733371655, -6555.21834881384, -3570.638303188596, -8714.123798222783, -7914.3022207195345, -6634.1544263224405, -12468.273065435971, -8209.720763020263, -6653.822425957111, -9832.017302006936, -5822.576391817937, -11171.17774084095, -10175.108436804312, -4554.116727330103, -9560.52637145873, -10456.60777866776, -9816.498295491092, -5719.497986852235, -5782.390555742701, -7729.04175109088, -8729.102499812952, -9773.955109045684, -7704.964338196845, -1331.4770013681778, -9110.70863870591, -8708.704117448595, -9421.625234896586, -6803.1361084198925, -6616.144956938174, -489.9946280077378, -4721.127330315102, -6417.5093800345, -7343.186450418993, -9772.622793314378, -6880.171089860923, -5813.2557742114395, -2048.4973546698425, -4828.794848072245, -5404.692834647908, -5010.253645767564, -6003.320799267501, -3965.150624872495, -5025.75016033752, -8506.251908887934, -7565.4604855235275, -9453.452391320589, -6553.802197386832, -3890.654316012604, -9777.37486679311, -4770.120116351461, -9091.829619963091, -3252.679273737666, -10710.22923919282, -2925.976233737692, -7205.247939190725, -7132.54577358762, -10210.880623962608, -5164.15652248667, -4587.330050717917, -10018.062395809231, -12310.396437277996, -9005.499853089314, -9616.901536738958, -6683.485299896632, -4327.784857187652, -4859.000465746473, -7496.897411704905, -5079.947114587838, -5409.611591696958, -3449.149557302196, -11490.426373455812, -1419.6338994379914, -11998.135315963482, -1604.2568665302674, -5999.466242255251, -7166.400600174432, -8334.441626902251], "episode_lengths": [200, 189, 200, 200, 200, 200, 95, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 85, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 180, 200, 178, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 200], "policy_agent_policy_reward": [2145.449060794553, 1507.4916978940548, 3152.395066136043, 2729.8435402857194, 8761.663053903147, 5042.379900623322, 1288.250901117421, 2026.4784793109015, 4604.376716768902, 5327.85710226758, 9949.902219846945, 7094.773778059844, 3479.7239491625146, 6587.192412138622, 2835.3753745930403, 5955.532427436941, 6594.072976118415, 2444.001322549083, 3150.527796159302, 7018.4806788890055, 2570.1719739819846, 3933.31466845734, 481.0009730298178, 4394.0066526602095, 3306.328804198083, 1954.2979370499427, 3019.9106087827636, 5852.50578505846, 3462.520030909561, 10415.003750727763, 6526.466035307285, 5503.1234661289145, 5940.427334945255, 3446.6284209255764, 7577.422777125372, 5104.995832743529, 3771.9162046206616, 7647.649719952861, 9782.434507017504, 7308.134571961858, 5229.062062876418, 2742.0194638590583, 3126.6268418102804, 2970.2893536126353, 7576.986812124591, 5866.4397244515685, 490.8572606169653, 7129.137142941998, 7051.060931854704, 5434.363694826454, 5939.64577525413, 5122.338310112352, 349.3359592031699, 4093.762264371257, 1074.2604477349291, 2944.2371917800465, 2018.6539048330467, 882.9668516799143, 2426.6499159157383, 1396.797395536721, 1196.0340564167468, 1342.5209540910116, 3343.0974392959947, 2584.674577626118, 2438.8208374616556, 1495.4984149806696, 7310.944178308656, 1509.7476779173332, 4696.121800849036, 5794.771732220381, 3324.5127516267376, 5899.550862963683, 3148.55861355913, 7824.684798849143, 1899.427383959516, 9097.993616761087, 1837.5475054029935, 6310.280135492324, 4460.239228646457, 9047.368719792103, 4149.069448680497, 2498.816329460985, 5405.018103354561, 6027.339497831892, 7533.914216817158, 6561.7324054163255, 4591.379755238449, 2785.0643692769745, 3006.694689964775, 4504.120174728456, 3003.0819762553615, 5053.37618007203, 2146.905127269865, 10107.44900951664, 1073.9655849566432, 7126.466043816066, 809.057818483817, 3949.2973588363093, 2906.2970140724096, 2807.848495817944], "policy_adversary_policy_reward": [-2145.6323679846355, -4025.314619455965, -1507.5793797690292, -2366.1145166168485, -7832.9884064677835, -3152.395066136043, -3090.3126452858482, -3393.4299309870253, -9866.457300453223, -9231.580356618419, -5204.944868513939, -5357.798527437043, -2909.1735219930174, -1288.250901117421, -7389.816876228592, -2026.4784793109015, -4604.376716768902, -8607.338577743569, -9371.770092653811, -5327.85710226758, -11030.649259677233, -10105.062369676378, -7447.20072403457, -7678.087035208255, -5709.581502955537, -3479.7239491625146, -6587.192412138622, -9191.23681706348, -2835.3753745930403, -8729.76801097819, -5969.16926679877, -8071.563382158337, -6594.072976118415, -10274.608392629834, -6954.0975251426435, -2444.001322549083, -5579.010397371454, -3243.311853956573, -7018.4806788890055, -8932.884135915763, -2606.716674119124, -4986.311025652748, -4114.0639839933365, -5813.550168814155, -481.0009730298178, -1312.3823973963956, -4394.0066526602095, -6850.446673337165, -6555.21834881384, -3306.328804198083, -1954.2979370499427, -3570.638303188596, -8714.123798222783, -3019.9106087827636, -5852.50578505846, -7914.3022207195345, -6634.15442632244, -3462.520030909561, -12468.273065435971, -10415.003750727763, -7825.552311121755, -6910.63448720579, -6131.5610324315985, -6025.384859654428, -5940.427334945255, -9832.017302006936, -3446.6284209255764, -5822.576391817937, -7577.422777125372, -11171.17774084095, -10175.10843680431, -5104.995832743529, -3779.958079158039, -4546.074852792725, -7668.238013020907, -9539.938078390694, -9805.96310765366, -10433.079178031609, -7308.134571961858, -9816.498295491092, -5245.987911899757, -5702.572137828893, -5782.3905557427, -2742.0194638590583, -7729.041751090881, -3126.6268418102804, -2970.2893536126353, -8729.102499812952, -9773.955109045684, -7576.986812124591, -5866.4397244515685, -7704.964338196845, -490.8572606169653, -1331.4770013681778, -9110.70863870591, -7129.137142941998, -7051.325887810811, -8708.439161492486, -9421.625234896588, -5434.363694826454, -6686.268965681277, -6056.512917992747, -5123.709153179661, -6614.774113870864, -448.0694164250675, -391.2611707858401, -4656.753705357803, -4158.135889328552, -6417.5093800345, -1074.2604477349291, -2944.2371917800465, -7343.186450418993, -9772.622793314376, -2018.6539048330467, -882.9668516799143, -6880.171089860923, -5812.0600501772315, -2427.8456399499455, -1465.4481644103653, -1979.8465857961985, -1196.0340564167468, -4828.794848072245, -5404.692834647908, -1342.5209540910116, -5010.253645767564, -3343.0974392959947, -2597.2988829573737, -5990.696493936239, -2442.83260286685, -3961.138859467301, -5024.559766185801, -1496.688809132391, -8421.93177290996, -7395.264314286634, -7565.4604855235275, -1509.7476779173332, -9453.452391320587, -4696.121800849036, -6088.712475102427, -6259.861454504788, -3340.761975558473, -3874.4050920808686, -9777.37486679311, -5899.550862963683, -4744.527539929989, -3174.1511899806046, -7998.0874952877875, -8918.426923524443, -1899.427383959516, -3252.679273737665, -10183.961942913622, -9624.260913040267, -2902.888660199002, -1860.6350789416829, -6311.317695516664, -7204.210379166386, -4460.239228646457, -7132.545773587621, -10202.503843141118, -9055.745500613592, -4493.227112824261, -4819.9988583429, -2498.816329460985, -4587.330050717917, -5405.018103354561, -10018.062395809231, -6027.339497831892, -12310.396437277994, -7655.008272870158, -8884.405797036306, -6561.7324054163255, -9616.901536738958, -4591.379755238449, -6683.485299896632, -3592.1610288016195, -3520.6881976630057, -4859.000465746473, -3006.694689964775, -4524.1671012918905, -7476.850485141467, -4302.830877877626, -3780.198212965585, -5347.516593440189, -5115.471178328799, -3373.1686271895096, -2222.8860573825477, -11490.426373455812, -10107.44900951664, -1253.6607070776886, -1239.9387773169458, -11998.135315963482, -7126.466043816066, -1459.3564041968523, -953.9582808172305, -5999.466242255251, -3949.2973588363093, -2906.2970140724096, -7166.400600174432, -2807.848495817944, -8334.441626902251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39568045257760276, "mean_inference_ms": 0.9629566529564653, "mean_action_processing_ms": 0.1661515423297085, "mean_env_wait_ms": 0.050901993547701495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032843351364135742, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.06693410873413086}, "num_episodes": 19, "episode_return_max": -489.9946280077378, "episode_return_min": -12468.273065435971, "episode_return_mean": -6943.903508806712}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.3735306846532, "num_env_steps_trained_throughput_per_sec": 527.3735306846532, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 7286.672, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7286.64, "sample_time_ms": 733.801, "learn_time_ms": 6540.959, "learn_throughput": 611.531, "synch_weights_time_ms": 11.428}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 182, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-09", "timestamp": 1723232949, "time_this_iter_s": 7.589576959609985, "time_total_s": 1355.4647252559662, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ecc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1355.4647252559662, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 30.33636363636364, "ram_util_percent": 82.76363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7997492200384537, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987202775478362, "policy_loss": -0.0069946828303121345, "vf_loss": 9.990482445557912, "vf_explained_var": -0.007737627004583677, "kl": 0.012697093666065484, "entropy": 1.17818321796755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8969968662217811, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994165135439111, "policy_loss": -0.005304054271617027, "vf_loss": 9.996402802543034, "vf_explained_var": -0.0006246300286086148, "kl": 0.010768151487514534, "entropy": 1.0255721993862636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "env_runners": {"episode_reward_max": -489.9946280077378, "episode_reward_min": -12468.273065435971, "episode_reward_mean": -6787.747815597822, "episode_len_mean": 193.04, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19304, "policy_reward_min": {"agent_policy": 349.3359592031699, "adversary_policy": -12468.273065435971}, "policy_reward_max": {"agent_policy": 10415.003750727763, "adversary_policy": -391.2611707858401}, "policy_reward_mean": {"agent_policy": 4396.641973714264, "adversary_policy": -5592.1948946560415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8932.884135915763, -5022.855725789885, -5994.299484350153, -1312.3823973963956, -6850.4466733371655, -6555.21834881384, -3570.638303188596, -8714.123798222783, -7914.3022207195345, -6634.1544263224405, -12468.273065435971, -8209.720763020263, -6653.822425957111, -9832.017302006936, -5822.576391817937, -11171.17774084095, -10175.108436804312, -4554.116727330103, -9560.52637145873, -10456.60777866776, -9816.498295491092, -5719.497986852235, -5782.390555742701, -7729.04175109088, -8729.102499812952, -9773.955109045684, -7704.964338196845, -1331.4770013681778, -9110.70863870591, -8708.704117448595, -9421.625234896586, -6803.1361084198925, -6616.144956938174, -489.9946280077378, -4721.127330315102, -6417.5093800345, -7343.186450418993, -9772.622793314378, -6880.171089860923, -5813.2557742114395, -2048.4973546698425, -4828.794848072245, -5404.692834647908, -5010.253645767564, -6003.320799267501, -3965.150624872495, -5025.75016033752, -8506.251908887934, -7565.4604855235275, -9453.452391320589, -6553.802197386832, -3890.654316012604, -9777.37486679311, -4770.120116351461, -9091.829619963091, -3252.679273737666, -10710.22923919282, -2925.976233737692, -7205.247939190725, -7132.54577358762, -10210.880623962608, -5164.15652248667, -4587.330050717917, -10018.062395809231, -12310.396437277996, -9005.499853089314, -9616.901536738958, -6683.485299896632, -4327.784857187652, -4859.000465746473, -7496.897411704905, -5079.947114587838, -5409.611591696958, -3449.149557302196, -11490.426373455812, -1419.6338994379914, -11998.135315963482, -1604.2568665302674, -5999.466242255251, -7166.400600174432, -8334.441626902251, -3322.845192245364, -4112.2950558307475, -9533.405982188777, -6301.117389433645, -6231.987647824244, -6408.7885382451495, -4858.28748731109, -4214.737435920901, -6559.261376056264, -10699.573294736332, -8140.236951688608, -3597.076407430716, -8949.323093462715, -2231.520686502405, -10010.161084941805, -4421.766747931155, -4536.936561702479, -8022.995787969156, -8178.149008545595], "episode_lengths": [200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 185, 200, 200, 200, 85, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 180, 200, 178, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7018.4806788890055, 2570.1719739819846, 3933.31466845734, 481.0009730298178, 4394.0066526602095, 3306.328804198083, 1954.2979370499427, 3019.9106087827636, 5852.50578505846, 3462.520030909561, 10415.003750727763, 6526.466035307285, 5503.1234661289145, 5940.427334945255, 3446.6284209255764, 7577.422777125372, 5104.995832743529, 3771.9162046206616, 7647.649719952861, 9782.434507017504, 7308.134571961858, 5229.062062876418, 2742.0194638590583, 3126.6268418102804, 2970.2893536126353, 7576.986812124591, 5866.4397244515685, 490.8572606169653, 7129.137142941998, 7051.060931854704, 5434.363694826454, 5939.64577525413, 5122.338310112352, 349.3359592031699, 4093.762264371257, 1074.2604477349291, 2944.2371917800465, 2018.6539048330467, 882.9668516799143, 2426.6499159157383, 1396.797395536721, 1196.0340564167468, 1342.5209540910116, 3343.0974392959947, 2584.674577626118, 2438.8208374616556, 1495.4984149806696, 7310.944178308656, 1509.7476779173332, 4696.121800849036, 5794.771732220381, 3324.5127516267376, 5899.550862963683, 3148.55861355913, 7824.684798849143, 1899.427383959516, 9097.993616761087, 1837.5475054029935, 6310.280135492324, 4460.239228646457, 9047.368719792103, 4149.069448680497, 2498.816329460985, 5405.018103354561, 6027.339497831892, 7533.914216817158, 6561.7324054163255, 4591.379755238449, 2785.0643692769745, 3006.694689964775, 4504.120174728456, 3003.0819762553615, 5053.37618007203, 2146.905127269865, 10107.44900951664, 1073.9655849566432, 7126.466043816066, 809.057818483817, 3949.2973588363093, 2906.2970140724096, 2807.848495817944, 1649.0859777027617, 3727.508939030561, 6290.997497581724, 3324.1881804876393, 4563.11873348224, 2535.8889874030215, 1662.097725207102, 3220.2234884586433, 5021.424401884176, 10213.922726357405, 7813.281865188492, 2724.3735268593773, 7950.283566845164, 629.1908996343537, 9359.560964650227, 2797.7381689228587, 3356.637446207934, 2903.8120004904786, 6429.341349074626], "policy_adversary_policy_reward": [-7018.4806788890055, -8932.884135915763, -2606.716674119124, -4986.311025652748, -4114.0639839933365, -5813.550168814155, -481.0009730298178, -1312.3823973963956, -4394.0066526602095, -6850.446673337165, -6555.21834881384, -3306.328804198083, -1954.2979370499427, -3570.638303188596, -8714.123798222783, -3019.9106087827636, -5852.50578505846, -7914.3022207195345, -6634.15442632244, -3462.520030909561, -12468.273065435971, -10415.003750727763, -7825.552311121755, -6910.63448720579, -6131.5610324315985, -6025.384859654428, -5940.427334945255, -9832.017302006936, -3446.6284209255764, -5822.576391817937, -7577.422777125372, -11171.17774084095, -10175.10843680431, -5104.995832743529, -3779.958079158039, -4546.074852792725, -7668.238013020907, -9539.938078390694, -9805.96310765366, -10433.079178031609, -7308.134571961858, -9816.498295491092, -5245.987911899757, -5702.572137828893, -5782.3905557427, -2742.0194638590583, -7729.041751090881, -3126.6268418102804, -2970.2893536126353, -8729.102499812952, -9773.955109045684, -7576.986812124591, -5866.4397244515685, -7704.964338196845, -490.8572606169653, -1331.4770013681778, -9110.70863870591, -7129.137142941998, -7051.325887810811, -8708.439161492486, -9421.625234896588, -5434.363694826454, -6686.268965681277, -6056.512917992747, -5123.709153179661, -6614.774113870864, -448.0694164250675, -391.2611707858401, -4656.753705357803, -4158.135889328552, -6417.5093800345, -1074.2604477349291, -2944.2371917800465, -7343.186450418993, -9772.622793314376, -2018.6539048330467, -882.9668516799143, -6880.171089860923, -5812.0600501772315, -2427.8456399499455, -1465.4481644103653, -1979.8465857961985, -1196.0340564167468, -4828.794848072245, -5404.692834647908, -1342.5209540910116, -5010.253645767564, -3343.0974392959947, -2597.2988829573737, -5990.696493936239, -2442.83260286685, -3961.138859467301, -5024.559766185801, -1496.688809132391, -8421.93177290996, -7395.264314286634, -7565.4604855235275, -1509.7476779173332, -9453.452391320587, -4696.121800849036, -6088.712475102427, -6259.861454504788, -3340.761975558473, -3874.4050920808686, -9777.37486679311, -5899.550862963683, -4744.527539929989, -3174.1511899806046, -7998.0874952877875, -8918.426923524443, -1899.427383959516, -3252.679273737665, -10183.961942913622, -9624.260913040267, -2902.888660199002, -1860.6350789416829, -6311.317695516664, -7204.210379166386, -4460.239228646457, -7132.545773587621, -10202.503843141118, -9055.745500613592, -4493.227112824261, -4819.9988583429, -2498.816329460985, -4587.330050717917, -5405.018103354561, -10018.062395809231, -6027.339497831892, -12310.396437277994, -7655.008272870158, -8884.405797036306, -6561.7324054163255, -9616.901536738958, -4591.379755238449, -6683.485299896632, -3592.1610288016195, -3520.6881976630057, -4859.000465746473, -3006.694689964775, -4524.1671012918905, -7476.850485141467, -4302.830877877626, -3780.198212965585, -5347.516593440189, -5115.471178328799, -3373.1686271895096, -2222.8860573825477, -11490.426373455812, -10107.44900951664, -1253.6607070776886, -1239.9387773169458, -11998.135315963482, -7126.466043816066, -1459.3564041968523, -953.9582808172305, -5999.466242255251, -3949.2973588363093, -2906.2970140724096, -7166.400600174432, -2807.848495817944, -8334.441626902251, -3322.8451922453637, -1649.0859777027617, -3819.0711341965343, -4020.7328606647748, -6290.997497581724, -9533.405982188777, -3324.1881804876393, -6301.117389433645, -6231.987647824244, -4563.11873348224, -6408.7885382451495, -2535.8889874030215, -4817.431440933783, -1702.9537715844046, -4096.916585520957, -3338.0443388585845, -6559.261376056264, -5021.424401884176, -10340.03595378406, -10573.460067309676, -7971.820411129908, -7981.698405747191, -3595.2609635930057, -2726.188970697087, -8012.099116019753, -8887.507544288126, -2231.520686502405, -629.1908996343537, -9444.263453963082, -9925.458595628952, -2798.8888172275156, -4420.616099626498, -3382.6532784124206, -4510.9207294979915, -2903.8120004904786, -8022.995787969156, -8142.100380120399, -6465.3899774998235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39565103143560804, "mean_inference_ms": 0.9631093890542084, "mean_action_processing_ms": 0.16616239374151648, "mean_env_wait_ms": 0.05090406749882476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00324404239654541, "StateBufferConnector_ms": 0.0022982358932495117, "ViewRequirementAgentConnector_ms": 0.06259405612945557}, "num_episodes": 19, "episode_return_max": -489.9946280077378, "episode_return_min": -12468.273065435971, "episode_return_mean": -6787.747815597822}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.119863979654, "num_env_steps_trained_throughput_per_sec": 542.119863979654, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2196000, "timers": {"training_iteration_time_ms": 7256.133, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7256.101, "sample_time_ms": 733.025, "learn_time_ms": 6510.8, "learn_throughput": 614.364, "synch_weights_time_ms": 11.878}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "done": false, "training_iteration": 183, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-17", "timestamp": 1723232957, "time_this_iter_s": 7.383871078491211, "time_total_s": 1362.8485963344574, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ecca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1362.8485963344574, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 26.40909090909091, "ram_util_percent": 82.78181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8686187262336413, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987629315257072, "policy_loss": -0.009193830339063425, "vf_loss": 9.993544041117032, "vf_explained_var": -0.006966852769255638, "kl": 0.011207224414586865, "entropy": 1.1294391450782617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8846439283203196, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994736727961788, "policy_loss": -0.003837321760507409, "vf_loss": 9.996136716812376, "vf_explained_var": 0.00012547998201279414, "kl": 0.00855909265311701, "entropy": 1.030161798977978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": -489.9946280077378, "episode_reward_min": -12310.396437277996, "episode_reward_mean": -6762.494651306825, "episode_len_mean": 194.51, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19451, "policy_reward_min": {"agent_policy": 349.3359592031699, "adversary_policy": -12310.396437277994}, "policy_reward_max": {"agent_policy": 10213.922726357405, "adversary_policy": -391.2611707858401}, "policy_reward_mean": {"agent_policy": 4297.691551302571, "adversary_policy": -5530.093101304698}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5782.390555742701, -7729.04175109088, -8729.102499812952, -9773.955109045684, -7704.964338196845, -1331.4770013681778, -9110.70863870591, -8708.704117448595, -9421.625234896586, -6803.1361084198925, -6616.144956938174, -489.9946280077378, -4721.127330315102, -6417.5093800345, -7343.186450418993, -9772.622793314378, -6880.171089860923, -5813.2557742114395, -2048.4973546698425, -4828.794848072245, -5404.692834647908, -5010.253645767564, -6003.320799267501, -3965.150624872495, -5025.75016033752, -8506.251908887934, -7565.4604855235275, -9453.452391320589, -6553.802197386832, -3890.654316012604, -9777.37486679311, -4770.120116351461, -9091.829619963091, -3252.679273737666, -10710.22923919282, -2925.976233737692, -7205.247939190725, -7132.54577358762, -10210.880623962608, -5164.15652248667, -4587.330050717917, -10018.062395809231, -12310.396437277996, -9005.499853089314, -9616.901536738958, -6683.485299896632, -4327.784857187652, -4859.000465746473, -7496.897411704905, -5079.947114587838, -5409.611591696958, -3449.149557302196, -11490.426373455812, -1419.6338994379914, -11998.135315963482, -1604.2568665302674, -5999.466242255251, -7166.400600174432, -8334.441626902251, -3322.845192245364, -4112.2950558307475, -9533.405982188777, -6301.117389433645, -6231.987647824244, -6408.7885382451495, -4858.28748731109, -4214.737435920901, -6559.261376056264, -10699.573294736332, -8140.236951688608, -3597.076407430716, -8949.323093462715, -2231.520686502405, -10010.161084941805, -4421.766747931155, -4536.936561702479, -8022.995787969156, -8178.149008545595, -10101.504576170484, -6305.342251316125, -3482.8584414028933, -3955.4645754251687, -9926.632347828323, -4188.313165239394, -10560.612558818966, -8102.150326878939, -10362.065775639829, -11434.522026352928, -2285.352997067201, -10093.27214091202, -9593.469982195045, -9085.26715327972, -5651.693443812936, -5174.050070986316, -3682.9286113004205, -8350.050099938668, -5028.68383333561, -9962.42019605152, -6381.870721945814, -9707.407074742134], "episode_lengths": [200, 185, 200, 200, 200, 85, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 180, 200, 178, 149, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2742.0194638590583, 3126.6268418102804, 2970.2893536126353, 7576.986812124591, 5866.4397244515685, 490.8572606169653, 7129.137142941998, 7051.060931854704, 5434.363694826454, 5939.64577525413, 5122.338310112352, 349.3359592031699, 4093.762264371257, 1074.2604477349291, 2944.2371917800465, 2018.6539048330467, 882.9668516799143, 2426.6499159157383, 1396.797395536721, 1196.0340564167468, 1342.5209540910116, 3343.0974392959947, 2584.674577626118, 2438.8208374616556, 1495.4984149806696, 7310.944178308656, 1509.7476779173332, 4696.121800849036, 5794.771732220381, 3324.5127516267376, 5899.550862963683, 3148.55861355913, 7824.684798849143, 1899.427383959516, 9097.993616761087, 1837.5475054029935, 6310.280135492324, 4460.239228646457, 9047.368719792103, 4149.069448680497, 2498.816329460985, 5405.018103354561, 6027.339497831892, 7533.914216817158, 6561.7324054163255, 4591.379755238449, 2785.0643692769745, 3006.694689964775, 4504.120174728456, 3003.0819762553615, 5053.37618007203, 2146.905127269865, 10107.44900951664, 1073.9655849566432, 7126.466043816066, 809.057818483817, 3949.2973588363093, 2906.2970140724096, 2807.848495817944, 1649.0859777027617, 3727.508939030561, 6290.997497581724, 3324.1881804876393, 4563.11873348224, 2535.8889874030215, 1662.097725207102, 3220.2234884586433, 5021.424401884176, 10213.922726357405, 7813.281865188492, 2724.3735268593773, 7950.283566845164, 629.1908996343537, 9359.560964650227, 2797.7381689228587, 3356.637446207934, 2903.8120004904786, 6429.341349074626, 6770.029571935462, 1803.6352291616965, 2493.814249720875, 2863.883818733492, 4034.192518287794, 2991.140770611089, 8712.931823473167, 5284.571103715987, 8640.054299272926, 9800.056535891, 1135.2002804606632, 4607.889263140477, 2603.869809852299, 8361.832737092365, 2456.484630053626, 4435.961118522406, 1988.1981241336127, 4809.624892231545, 2775.0640108026114, 7269.221991823554, 3046.4610973639055, 7466.642679900229], "policy_adversary_policy_reward": [-5782.3905557427, -2742.0194638590583, -7729.041751090881, -3126.6268418102804, -2970.2893536126353, -8729.102499812952, -9773.955109045684, -7576.986812124591, -5866.4397244515685, -7704.964338196845, -490.8572606169653, -1331.4770013681778, -9110.70863870591, -7129.137142941998, -7051.325887810811, -8708.439161492486, -9421.625234896588, -5434.363694826454, -6686.268965681277, -6056.512917992747, -5123.709153179661, -6614.774113870864, -448.0694164250675, -391.2611707858401, -4656.753705357803, -4158.135889328552, -6417.5093800345, -1074.2604477349291, -2944.2371917800465, -7343.186450418993, -9772.622793314376, -2018.6539048330467, -882.9668516799143, -6880.171089860923, -5812.0600501772315, -2427.8456399499455, -1465.4481644103653, -1979.8465857961985, -1196.0340564167468, -4828.794848072245, -5404.692834647908, -1342.5209540910116, -5010.253645767564, -3343.0974392959947, -2597.2988829573737, -5990.696493936239, -2442.83260286685, -3961.138859467301, -5024.559766185801, -1496.688809132391, -8421.93177290996, -7395.264314286634, -7565.4604855235275, -1509.7476779173332, -9453.452391320587, -4696.121800849036, -6088.712475102427, -6259.861454504788, -3340.761975558473, -3874.4050920808686, -9777.37486679311, -5899.550862963683, -4744.527539929989, -3174.1511899806046, -7998.0874952877875, -8918.426923524443, -1899.427383959516, -3252.679273737665, -10183.961942913622, -9624.260913040267, -2902.888660199002, -1860.6350789416829, -6311.317695516664, -7204.210379166386, -4460.239228646457, -7132.545773587621, -10202.503843141118, -9055.745500613592, -4493.227112824261, -4819.9988583429, -2498.816329460985, -4587.330050717917, -5405.018103354561, -10018.062395809231, -6027.339497831892, -12310.396437277994, -7655.008272870158, -8884.405797036306, -6561.7324054163255, -9616.901536738958, -4591.379755238449, -6683.485299896632, -3592.1610288016195, -3520.6881976630057, -4859.000465746473, -3006.694689964775, -4524.1671012918905, -7476.850485141467, -4302.830877877626, -3780.198212965585, -5347.516593440189, -5115.471178328799, -3373.1686271895096, -2222.8860573825477, -11490.426373455812, -10107.44900951664, -1253.6607070776886, -1239.9387773169458, -11998.135315963482, -7126.466043816066, -1459.3564041968523, -953.9582808172305, -5999.466242255251, -3949.2973588363093, -2906.2970140724096, -7166.400600174432, -2807.848495817944, -8334.441626902251, -3322.8451922453637, -1649.0859777027617, -3819.0711341965343, -4020.7328606647748, -6290.997497581724, -9533.405982188777, -3324.1881804876393, -6301.117389433645, -6231.987647824244, -4563.11873348224, -6408.7885382451495, -2535.8889874030215, -4817.431440933783, -1702.9537715844046, -4096.916585520957, -3338.0443388585845, -6559.261376056264, -5021.424401884176, -10340.03595378406, -10573.460067309676, -7971.820411129908, -7981.698405747191, -3595.2609635930057, -2726.188970697087, -8012.099116019753, -8887.507544288126, -2231.520686502405, -629.1908996343537, -9444.263453963082, -9925.458595628952, -2798.8888172275156, -4420.616099626498, -3382.6532784124206, -4510.9207294979915, -2903.8120004904786, -8022.995787969156, -8142.100380120399, -6465.3899774998235, -10101.504576170482, -6770.029571935462, -1804.460260940494, -6304.517219537319, -3456.740400314019, -2519.932290809749, -3036.585394408268, -3782.762999750394, -4034.192518287794, -9926.632347828323, -3836.2297352414316, -3343.2242006090496, -10560.612558818968, -8712.931823473167, -8102.150326878939, -5284.571103715987, -8644.549053166966, -10357.571021745805, -9800.056535891, -11434.522026352928, -2278.65332772535, -1141.8999498025146, -4607.889263140477, -10093.27214091202, -2603.869809852299, -9593.469982195045, -8369.88924034271, -9077.210650029374, -5651.693443812935, -2456.484630053626, -4710.729126675148, -4899.282062833573, -2980.498230328258, -2690.628505105776, -8350.050099938668, -4809.624892231545, -2823.474183846581, -4980.27366029164, -9962.42019605152, -7269.221991823554, -6132.733646138003, -3295.5981731717193, -9707.407074742134, -7466.642679900229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39543577316532563, "mean_inference_ms": 0.963328542583092, "mean_action_processing_ms": 0.16610614003520793, "mean_env_wait_ms": 0.05085466249712045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003161787986755371, "StateBufferConnector_ms": 0.002284407615661621, "ViewRequirementAgentConnector_ms": 0.06166732311248779}, "num_episodes": 22, "episode_return_max": -489.9946280077378, "episode_return_min": -12310.396437277996, "episode_return_mean": -6762.494651306825}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.7097751929923, "num_env_steps_trained_throughput_per_sec": 549.7097751929923, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 7278.299, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7278.266, "sample_time_ms": 739.992, "learn_time_ms": 6526.112, "learn_throughput": 612.922, "synch_weights_time_ms": 11.763}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 184, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-24", "timestamp": 1723232964, "time_this_iter_s": 7.280362129211426, "time_total_s": 1370.1289584636688, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1370.1289584636688, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 24.627272727272725, "ram_util_percent": 82.73636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9090388893149793, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.982849359512329, "policy_loss": -0.007081188627247078, "vf_loss": 9.986806760231653, "vf_explained_var": -0.006250442191958428, "kl": 0.010676347363914828, "entropy": 1.1825069022675356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9616784829784323, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98928322564988, "policy_loss": -0.0037442931634369034, "vf_loss": 9.990487100712206, "vf_explained_var": 0.0004915203682329289, "kl": 0.008921160240701977, "entropy": 1.0720082377630566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "env_runners": {"episode_reward_max": -1419.6338994379914, "episode_reward_min": -12310.396437277996, "episode_reward_mean": -6978.555368921484, "episode_len_mean": 197.53, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19753, "policy_reward_min": {"agent_policy": 629.1908996343537, "adversary_policy": -12310.396437277994}, "policy_reward_max": {"agent_policy": 10591.291507532085, "adversary_policy": -629.1908996343537}, "policy_reward_mean": {"agent_policy": 4687.820754462607, "adversary_policy": -5833.188061692046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6003.320799267501, -3965.150624872495, -5025.75016033752, -8506.251908887934, -7565.4604855235275, -9453.452391320589, -6553.802197386832, -3890.654316012604, -9777.37486679311, -4770.120116351461, -9091.829619963091, -3252.679273737666, -10710.22923919282, -2925.976233737692, -7205.247939190725, -7132.54577358762, -10210.880623962608, -5164.15652248667, -4587.330050717917, -10018.062395809231, -12310.396437277996, -9005.499853089314, -9616.901536738958, -6683.485299896632, -4327.784857187652, -4859.000465746473, -7496.897411704905, -5079.947114587838, -5409.611591696958, -3449.149557302196, -11490.426373455812, -1419.6338994379914, -11998.135315963482, -1604.2568665302674, -5999.466242255251, -7166.400600174432, -8334.441626902251, -3322.845192245364, -4112.2950558307475, -9533.405982188777, -6301.117389433645, -6231.987647824244, -6408.7885382451495, -4858.28748731109, -4214.737435920901, -6559.261376056264, -10699.573294736332, -8140.236951688608, -3597.076407430716, -8949.323093462715, -2231.520686502405, -10010.161084941805, -4421.766747931155, -4536.936561702479, -8022.995787969156, -8178.149008545595, -10101.504576170484, -6305.342251316125, -3482.8584414028933, -3955.4645754251687, -9926.632347828323, -4188.313165239394, -10560.612558818966, -8102.150326878939, -10362.065775639829, -11434.522026352928, -2285.352997067201, -10093.27214091202, -9593.469982195045, -9085.26715327972, -5651.693443812936, -5174.050070986316, -3682.9286113004205, -8350.050099938668, -5028.68383333561, -9962.42019605152, -6381.870721945814, -9707.407074742134, -8596.846287118511, -8342.469256600072, -5049.018504348239, -6956.931867095142, -10019.442559759482, -8656.182956347617, -4450.620070505288, -11786.668546687077, -7213.061641001287, -5523.962115065153, -6178.586110524287, -9615.789963990957, -10610.534315345278, -8396.218556193122, -6392.810170293725, -6993.221627275393, -6130.321621095311, -8235.857662734392, -6601.92500129904, -5068.777318746797, -7746.531173327035, -3481.6508770997084], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2584.674577626118, 2438.8208374616556, 1495.4984149806696, 7310.944178308656, 1509.7476779173332, 4696.121800849036, 5794.771732220381, 3324.5127516267376, 5899.550862963683, 3148.55861355913, 7824.684798849143, 1899.427383959516, 9097.993616761087, 1837.5475054029935, 6310.280135492324, 4460.239228646457, 9047.368719792103, 4149.069448680497, 2498.816329460985, 5405.018103354561, 6027.339497831892, 7533.914216817158, 6561.7324054163255, 4591.379755238449, 2785.0643692769745, 3006.694689964775, 4504.120174728456, 3003.0819762553615, 5053.37618007203, 2146.905127269865, 10107.44900951664, 1073.9655849566432, 7126.466043816066, 809.057818483817, 3949.2973588363093, 2906.2970140724096, 2807.848495817944, 1649.0859777027617, 3727.508939030561, 6290.997497581724, 3324.1881804876393, 4563.11873348224, 2535.8889874030215, 1662.097725207102, 3220.2234884586433, 5021.424401884176, 10213.922726357405, 7813.281865188492, 2724.3735268593773, 7950.283566845164, 629.1908996343537, 9359.560964650227, 2797.7381689228587, 3356.637446207934, 2903.8120004904786, 6429.341349074626, 6770.029571935462, 1803.6352291616965, 2493.814249720875, 2863.883818733492, 4034.192518287794, 2991.140770611089, 8712.931823473167, 5284.571103715987, 8640.054299272926, 9800.056535891, 1135.2002804606632, 4607.889263140477, 2603.869809852299, 8361.832737092365, 2456.484630053626, 4435.961118522406, 1988.1981241336127, 4809.624892231545, 2775.0640108026114, 7269.221991823554, 3046.4610973639055, 7466.642679900229, 6362.949961893778, 5073.20155312699, 1778.2486151587968, 6571.773871331763, 7930.865281965426, 6716.173561372106, 2338.1088190516884, 10591.291507532085, 4621.615640246734, 4093.345117684923, 5312.2882317074145, 6490.891194684593, 8898.504479338886, 3107.3036357697874, 5122.105833349453, 2981.6181246383426, 4712.814787228449, 6829.343266284374, 5751.297224382366, 769.9517186444823, 6819.015853215676, 658.2937297188319], "policy_adversary_policy_reward": [-2597.2988829573737, -5990.696493936239, -2442.83260286685, -3961.138859467301, -5024.559766185801, -1496.688809132391, -8421.93177290996, -7395.264314286634, -7565.4604855235275, -1509.7476779173332, -9453.452391320587, -4696.121800849036, -6088.712475102427, -6259.861454504788, -3340.761975558473, -3874.4050920808686, -9777.37486679311, -5899.550862963683, -4744.527539929989, -3174.1511899806046, -7998.0874952877875, -8918.426923524443, -1899.427383959516, -3252.679273737665, -10183.961942913622, -9624.260913040267, -2902.888660199002, -1860.6350789416829, -6311.317695516664, -7204.210379166386, -4460.239228646457, -7132.545773587621, -10202.503843141118, -9055.745500613592, -4493.227112824261, -4819.9988583429, -2498.816329460985, -4587.330050717917, -5405.018103354561, -10018.062395809231, -6027.339497831892, -12310.396437277994, -7655.008272870158, -8884.405797036306, -6561.7324054163255, -9616.901536738958, -4591.379755238449, -6683.485299896632, -3592.1610288016195, -3520.6881976630057, -4859.000465746473, -3006.694689964775, -4524.1671012918905, -7476.850485141467, -4302.830877877626, -3780.198212965585, -5347.516593440189, -5115.471178328799, -3373.1686271895096, -2222.8860573825477, -11490.426373455812, -10107.44900951664, -1253.6607070776886, -1239.9387773169458, -11998.135315963482, -7126.466043816066, -1459.3564041968523, -953.9582808172305, -5999.466242255251, -3949.2973588363093, -2906.2970140724096, -7166.400600174432, -2807.848495817944, -8334.441626902251, -3322.8451922453637, -1649.0859777027617, -3819.0711341965343, -4020.7328606647748, -6290.997497581724, -9533.405982188777, -3324.1881804876393, -6301.117389433645, -6231.987647824244, -4563.11873348224, -6408.7885382451495, -2535.8889874030215, -4817.431440933783, -1702.9537715844046, -4096.916585520957, -3338.0443388585845, -6559.261376056264, -5021.424401884176, -10340.03595378406, -10573.460067309676, -7971.820411129908, -7981.698405747191, -3595.2609635930057, -2726.188970697087, -8012.099116019753, -8887.507544288126, -2231.520686502405, -629.1908996343537, -9444.263453963082, -9925.458595628952, -2798.8888172275156, -4420.616099626498, -3382.6532784124206, -4510.9207294979915, -2903.8120004904786, -8022.995787969156, -8142.100380120399, -6465.3899774998235, -10101.504576170482, -6770.029571935462, -1804.460260940494, -6304.517219537319, -3456.740400314019, -2519.932290809749, -3036.585394408268, -3782.762999750394, -4034.192518287794, -9926.632347828323, -3836.2297352414316, -3343.2242006090496, -10560.612558818968, -8712.931823473167, -8102.150326878939, -5284.571103715987, -8644.549053166966, -10357.571021745805, -9800.056535891, -11434.522026352928, -2278.65332772535, -1141.8999498025146, -4607.889263140477, -10093.27214091202, -2603.869809852299, -9593.469982195045, -8369.88924034271, -9077.210650029374, -5651.693443812935, -2456.484630053626, -4710.729126675148, -4899.282062833573, -2980.498230328258, -2690.628505105776, -8350.050099938668, -4809.624892231545, -2823.474183846581, -4980.27366029164, -9962.42019605152, -7269.221991823554, -6132.733646138003, -3295.5981731717193, -9707.407074742134, -7466.642679900229, -6362.949961893778, -8596.846287118513, -8342.469256600083, -5073.20155312699, -5049.018504348239, -1778.2486151587968, -6839.962728217568, -6688.743010209336, -10019.442559759484, -7930.865281965426, -8656.182956347619, -6716.173561372106, -3926.9699922116847, -2861.7588973452857, -11786.28167544993, -10591.678378769227, -6229.237405754579, -5605.439875493448, -4230.078686662013, -5387.22854608806, -6060.75919261009, -5430.115149621609, -6490.891194684593, -9615.789963990957, -8898.504479338886, -10610.534315345278, -8396.218556193124, -3107.3036357697874, -5122.105833349453, -6392.810170293725, -6993.221627275393, -2981.6181246383426, -6130.32162109531, -4712.814787228449, -6829.343266284374, -8235.857662734392, -5905.542241721637, -6447.67998395977, -5068.777318746797, -769.9517186444823, -7689.9329116797735, -6875.614114862938, -3481.650877099709, -658.2937297188319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3955234473476094, "mean_inference_ms": 0.96279274188928, "mean_action_processing_ms": 0.16616390922235427, "mean_env_wait_ms": 0.05090310746542391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003243684768676758, "StateBufferConnector_ms": 0.002341628074645996, "ViewRequirementAgentConnector_ms": 0.06419205665588379}, "num_episodes": 22, "episode_return_max": -1419.6338994379914, "episode_return_min": -12310.396437277996, "episode_return_mean": -6978.555368921484}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.7774775953567, "num_env_steps_trained_throughput_per_sec": 543.7774775953567, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2220000, "timers": {"training_iteration_time_ms": 7302.384, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7302.352, "sample_time_ms": 747.749, "learn_time_ms": 6542.173, "learn_throughput": 611.418, "synch_weights_time_ms": 12.001}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "done": false, "training_iteration": 185, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-32", "timestamp": 1723232972, "time_this_iter_s": 7.360667943954468, "time_total_s": 1377.4896264076233, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32a3040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1377.4896264076233, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 26.23, "ram_util_percent": 82.74000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8227151801809669, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001599238316219, "policy_loss": 0.00046037778180713453, "vf_loss": 9.996691579620043, "vf_explained_var": -0.001517977627615134, "kl": 0.015199736099263342, "entropy": 1.1998265222956737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9266018746470017, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99505313489803, "policy_loss": -0.004045876038073508, "vf_loss": 9.99674155068776, "vf_explained_var": 0.00035468869739108615, "kl": 0.008278597781690891, "entropy": 1.0365174406419986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": -1419.6338994379914, "episode_reward_min": -12310.396437277996, "episode_reward_mean": -6857.702031705251, "episode_len_mean": 197.22, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 19722, "policy_reward_min": {"agent_policy": 629.1908996343537, "adversary_policy": -12310.396437277994}, "policy_reward_max": {"agent_policy": 10591.291507532085, "adversary_policy": -629.1908996343537}, "policy_reward_mean": {"agent_policy": 4583.507408218189, "adversary_policy": -5720.60471996172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4587.330050717917, -10018.062395809231, -12310.396437277996, -9005.499853089314, -9616.901536738958, -6683.485299896632, -4327.784857187652, -4859.000465746473, -7496.897411704905, -5079.947114587838, -5409.611591696958, -3449.149557302196, -11490.426373455812, -1419.6338994379914, -11998.135315963482, -1604.2568665302674, -5999.466242255251, -7166.400600174432, -8334.441626902251, -3322.845192245364, -4112.2950558307475, -9533.405982188777, -6301.117389433645, -6231.987647824244, -6408.7885382451495, -4858.28748731109, -4214.737435920901, -6559.261376056264, -10699.573294736332, -8140.236951688608, -3597.076407430716, -8949.323093462715, -2231.520686502405, -10010.161084941805, -4421.766747931155, -4536.936561702479, -8022.995787969156, -8178.149008545595, -10101.504576170484, -6305.342251316125, -3482.8584414028933, -3955.4645754251687, -9926.632347828323, -4188.313165239394, -10560.612558818966, -8102.150326878939, -10362.065775639829, -11434.522026352928, -2285.352997067201, -10093.27214091202, -9593.469982195045, -9085.26715327972, -5651.693443812936, -5174.050070986316, -3682.9286113004205, -8350.050099938668, -5028.68383333561, -9962.42019605152, -6381.870721945814, -9707.407074742134, -8596.846287118511, -8342.469256600072, -5049.018504348239, -6956.931867095142, -10019.442559759482, -8656.182956347617, -4450.620070505288, -11786.668546687077, -7213.061641001287, -5523.962115065153, -6178.586110524287, -9615.789963990957, -10610.534315345278, -8396.218556193122, -6392.810170293725, -6993.221627275393, -6130.321621095311, -8235.857662734392, -6601.92500129904, -5068.777318746797, -7746.531173327035, -3481.6508770997084, -2397.0889799176994, -7989.574802377945, -4335.324663522347, -5440.296968224488, -2531.903328094505, -7520.0281311171875, -5198.444223243406, -2941.059499432896, -9058.507140468768, -5308.7614566060965, -9722.948833099783, -4693.006895709246, -9865.659250288629, -4357.925311047951, -8138.945014490877, -4075.3986806349726, -11626.80660018313, -3917.8695925289794], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 200, 200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2498.816329460985, 5405.018103354561, 6027.339497831892, 7533.914216817158, 6561.7324054163255, 4591.379755238449, 2785.0643692769745, 3006.694689964775, 4504.120174728456, 3003.0819762553615, 5053.37618007203, 2146.905127269865, 10107.44900951664, 1073.9655849566432, 7126.466043816066, 809.057818483817, 3949.2973588363093, 2906.2970140724096, 2807.848495817944, 1649.0859777027617, 3727.508939030561, 6290.997497581724, 3324.1881804876393, 4563.11873348224, 2535.8889874030215, 1662.097725207102, 3220.2234884586433, 5021.424401884176, 10213.922726357405, 7813.281865188492, 2724.3735268593773, 7950.283566845164, 629.1908996343537, 9359.560964650227, 2797.7381689228587, 3356.637446207934, 2903.8120004904786, 6429.341349074626, 6770.029571935462, 1803.6352291616965, 2493.814249720875, 2863.883818733492, 4034.192518287794, 2991.140770611089, 8712.931823473167, 5284.571103715987, 8640.054299272926, 9800.056535891, 1135.2002804606632, 4607.889263140477, 2603.869809852299, 8361.832737092365, 2456.484630053626, 4435.961118522406, 1988.1981241336127, 4809.624892231545, 2775.0640108026114, 7269.221991823554, 3046.4610973639055, 7466.642679900229, 6362.949961893778, 5073.20155312699, 1778.2486151587968, 6571.773871331763, 7930.865281965426, 6716.173561372106, 2338.1088190516884, 10591.291507532085, 4621.615640246734, 4093.345117684923, 5312.2882317074145, 6490.891194684593, 8898.504479338886, 3107.3036357697874, 5122.105833349453, 2981.6181246383426, 4712.814787228449, 6829.343266284374, 5751.297224382366, 769.9517186444823, 6819.015853215676, 658.2937297188319, 1778.5537282947773, 1903.9227109194817, 3191.8056877063145, 3326.1320294951565, 2001.703250794936, 3799.508876406495, 4504.983271329553, 1039.5451080975547, 7896.450130853199, 3146.903991471831, 9464.116161898588, 1883.0808347983177, 6005.425238120516, 3951.2993983810006, 6251.947848304508, 2558.258859540585, 6816.187748142299, 2878.652786100623], "policy_adversary_policy_reward": [-2498.816329460985, -4587.330050717917, -5405.018103354561, -10018.062395809231, -6027.339497831892, -12310.396437277994, -7655.008272870158, -8884.405797036306, -6561.7324054163255, -9616.901536738958, -4591.379755238449, -6683.485299896632, -3592.1610288016195, -3520.6881976630057, -4859.000465746473, -3006.694689964775, -4524.1671012918905, -7476.850485141467, -4302.830877877626, -3780.198212965585, -5347.516593440189, -5115.471178328799, -3373.1686271895096, -2222.8860573825477, -11490.426373455812, -10107.44900951664, -1253.6607070776886, -1239.9387773169458, -11998.135315963482, -7126.466043816066, -1459.3564041968523, -953.9582808172305, -5999.466242255251, -3949.2973588363093, -2906.2970140724096, -7166.400600174432, -2807.848495817944, -8334.441626902251, -3322.8451922453637, -1649.0859777027617, -3819.0711341965343, -4020.7328606647748, -6290.997497581724, -9533.405982188777, -3324.1881804876393, -6301.117389433645, -6231.987647824244, -4563.11873348224, -6408.7885382451495, -2535.8889874030215, -4817.431440933783, -1702.9537715844046, -4096.916585520957, -3338.0443388585845, -6559.261376056264, -5021.424401884176, -10340.03595378406, -10573.460067309676, -7971.820411129908, -7981.698405747191, -3595.2609635930057, -2726.188970697087, -8012.099116019753, -8887.507544288126, -2231.520686502405, -629.1908996343537, -9444.263453963082, -9925.458595628952, -2798.8888172275156, -4420.616099626498, -3382.6532784124206, -4510.9207294979915, -2903.8120004904786, -8022.995787969156, -8142.100380120399, -6465.3899774998235, -10101.504576170482, -6770.029571935462, -1804.460260940494, -6304.517219537319, -3456.740400314019, -2519.932290809749, -3036.585394408268, -3782.762999750394, -4034.192518287794, -9926.632347828323, -3836.2297352414316, -3343.2242006090496, -10560.612558818968, -8712.931823473167, -8102.150326878939, -5284.571103715987, -8644.549053166966, -10357.571021745805, -9800.056535891, -11434.522026352928, -2278.65332772535, -1141.8999498025146, -4607.889263140477, -10093.27214091202, -2603.869809852299, -9593.469982195045, -8369.88924034271, -9077.210650029374, -5651.693443812935, -2456.484630053626, -4710.729126675148, -4899.282062833573, -2980.498230328258, -2690.628505105776, -8350.050099938668, -4809.624892231545, -2823.474183846581, -4980.27366029164, -9962.42019605152, -7269.221991823554, -6132.733646138003, -3295.5981731717193, -9707.407074742134, -7466.642679900229, -6362.949961893778, -8596.846287118513, -8342.469256600083, -5073.20155312699, -5049.018504348239, -1778.2486151587968, -6839.962728217568, -6688.743010209336, -10019.442559759484, -7930.865281965426, -8656.182956347619, -6716.173561372106, -3926.9699922116847, -2861.7588973452857, -11786.28167544993, -10591.678378769227, -6229.237405754579, -5605.439875493448, -4230.078686662013, -5387.22854608806, -6060.75919261009, -5430.115149621609, -6490.891194684593, -9615.789963990957, -8898.504479338886, -10610.534315345278, -8396.218556193124, -3107.3036357697874, -5122.105833349453, -6392.810170293725, -6993.221627275393, -2981.6181246383426, -6130.32162109531, -4712.814787228449, -6829.343266284374, -8235.857662734392, -5905.542241721637, -6447.67998395977, -5068.777318746797, -769.9517186444823, -7689.9329116797735, -6875.614114862938, -3481.650877099709, -658.2937297188319, -2172.7839599062463, -2002.8587483062345, -1903.9227109194817, -7989.574802377945, -3201.9506168140797, -4325.179734414581, -5439.29232322649, -3327.136674493153, -2142.3453743752198, -2391.2612045142223, -3799.508876406495, -7520.0281311171875, -4619.987044531503, -5083.440450041457, -1039.5451080975547, -2941.059499432896, -9058.50714046877, -7896.450130853199, -5308.7614566060965, -3146.903991471831, -9721.862337131994, -9465.202657866377, -1947.9342639581585, -4628.153466549404, -9862.829163422039, -6008.255324987108, -4055.2571766394894, -4253.967532789459, -8138.945014490878, -6251.947848304508, -3507.859946468537, -3125.7975937070214, -11626.806600183127, -6816.187748142299, -3587.284026450958, -3209.2383521786505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.395517955695948, "mean_inference_ms": 0.9635216722565485, "mean_action_processing_ms": 0.1661966300863816, "mean_env_wait_ms": 0.05091333030992855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033761262893676758, "StateBufferConnector_ms": 0.002481698989868164, "ViewRequirementAgentConnector_ms": 0.06862151622772217}, "num_episodes": 18, "episode_return_max": -1419.6338994379914, "episode_return_min": -12310.396437277996, "episode_return_mean": -6857.702031705251}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.7779715393157, "num_env_steps_trained_throughput_per_sec": 530.7779715393157, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 7341.946, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7341.913, "sample_time_ms": 768.104, "learn_time_ms": 6561.245, "learn_throughput": 609.64, "synch_weights_time_ms": 12.13}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 186, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-40", "timestamp": 1723232980, "time_this_iter_s": 7.541778087615967, "time_total_s": 1385.0314044952393, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32a3670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1385.0314044952393, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 29.3, "ram_util_percent": 82.70909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8287819736016293, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997005381186803, "policy_loss": -0.006472304996229165, "vf_loss": 10.0, "vf_explained_var": -0.004890533909201622, "kl": 0.01188605115263878, "entropy": 1.1322962815562885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9029742264558398, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001488088173842, "policy_loss": -0.0013188503054340208, "vf_loss": 10.0, "vf_explained_var": 0.00051324276066331, "kl": 0.009857085911389538, "entropy": 1.0016970557825906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "env_runners": {"episode_reward_max": -2231.520686502405, "episode_reward_min": -11786.668546687077, "episode_reward_mean": -6865.4800323811305, "episode_len_mean": 197.59, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19759, "policy_reward_min": {"agent_policy": 629.1908996343537, "adversary_policy": -11786.28167544993}, "policy_reward_max": {"agent_policy": 10591.291507532085, "adversary_policy": -629.1908996343537}, "policy_reward_mean": {"agent_policy": 4675.959954955323, "adversary_policy": -5770.7199936682255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3322.845192245364, -4112.2950558307475, -9533.405982188777, -6301.117389433645, -6231.987647824244, -6408.7885382451495, -4858.28748731109, -4214.737435920901, -6559.261376056264, -10699.573294736332, -8140.236951688608, -3597.076407430716, -8949.323093462715, -2231.520686502405, -10010.161084941805, -4421.766747931155, -4536.936561702479, -8022.995787969156, -8178.149008545595, -10101.504576170484, -6305.342251316125, -3482.8584414028933, -3955.4645754251687, -9926.632347828323, -4188.313165239394, -10560.612558818966, -8102.150326878939, -10362.065775639829, -11434.522026352928, -2285.352997067201, -10093.27214091202, -9593.469982195045, -9085.26715327972, -5651.693443812936, -5174.050070986316, -3682.9286113004205, -8350.050099938668, -5028.68383333561, -9962.42019605152, -6381.870721945814, -9707.407074742134, -8596.846287118511, -8342.469256600072, -5049.018504348239, -6956.931867095142, -10019.442559759482, -8656.182956347617, -4450.620070505288, -11786.668546687077, -7213.061641001287, -5523.962115065153, -6178.586110524287, -9615.789963990957, -10610.534315345278, -8396.218556193122, -6392.810170293725, -6993.221627275393, -6130.321621095311, -8235.857662734392, -6601.92500129904, -5068.777318746797, -7746.531173327035, -3481.6508770997084, -2397.0889799176994, -7989.574802377945, -4335.324663522347, -5440.296968224488, -2531.903328094505, -7520.0281311171875, -5198.444223243406, -2941.059499432896, -9058.507140468768, -5308.7614566060965, -9722.948833099783, -4693.006895709246, -9865.659250288629, -4357.925311047951, -8138.945014490877, -4075.3986806349726, -11626.80660018313, -3917.8695925289794, -10026.33696858577, -5688.945530966525, -4970.049190769608, -6192.488604825012, -6179.053049648601, -8436.685245012643, -4628.662587225769, -4213.485300113469, -8988.243165765409, -7092.882381472497, -6301.17191830483, -5064.8573748652725, -5767.698807487238, -9788.579537118003, -8584.59615943365, -10879.51039441882, -5078.047989019414, -9428.356743342916, -4324.976615687924], "episode_lengths": [200, 200, 200, 200, 200, 173, 200, 200, 200, 200, 200, 200, 200, 81, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1649.0859777027617, 3727.508939030561, 6290.997497581724, 3324.1881804876393, 4563.11873348224, 2535.8889874030215, 1662.097725207102, 3220.2234884586433, 5021.424401884176, 10213.922726357405, 7813.281865188492, 2724.3735268593773, 7950.283566845164, 629.1908996343537, 9359.560964650227, 2797.7381689228587, 3356.637446207934, 2903.8120004904786, 6429.341349074626, 6770.029571935462, 1803.6352291616965, 2493.814249720875, 2863.883818733492, 4034.192518287794, 2991.140770611089, 8712.931823473167, 5284.571103715987, 8640.054299272926, 9800.056535891, 1135.2002804606632, 4607.889263140477, 2603.869809852299, 8361.832737092365, 2456.484630053626, 4435.961118522406, 1988.1981241336127, 4809.624892231545, 2775.0640108026114, 7269.221991823554, 3046.4610973639055, 7466.642679900229, 6362.949961893778, 5073.20155312699, 1778.2486151587968, 6571.773871331763, 7930.865281965426, 6716.173561372106, 2338.1088190516884, 10591.291507532085, 4621.615640246734, 4093.345117684923, 5312.2882317074145, 6490.891194684593, 8898.504479338886, 3107.3036357697874, 5122.105833349453, 2981.6181246383426, 4712.814787228449, 6829.343266284374, 5751.297224382366, 769.9517186444823, 6819.015853215676, 658.2937297188319, 1778.5537282947773, 1903.9227109194817, 3191.8056877063145, 3326.1320294951565, 2001.703250794936, 3799.508876406495, 4504.983271329553, 1039.5451080975547, 7896.450130853199, 3146.903991471831, 9464.116161898588, 1883.0808347983177, 6005.425238120516, 3951.2993983810006, 6251.947848304508, 2558.258859540585, 6816.187748142299, 2878.652786100623, 7351.251585904763, 4295.471265730133, 1525.9286080027744, 2702.3246654910786, 4996.385730274526, 6868.436718859507, 2461.7830878313944, 1846.832023057829, 7542.055152344704, 3682.5292449333174, 5722.974037762052, 4341.690943516571, 3447.6205031948048, 6345.797828424756, 5284.738870577329, 7036.789636213121, 3315.8760191264982, 9283.934423253575, 3090.658480401371], "policy_adversary_policy_reward": [-3322.8451922453637, -1649.0859777027617, -3819.0711341965343, -4020.7328606647748, -6290.997497581724, -9533.405982188777, -3324.1881804876393, -6301.117389433645, -6231.987647824244, -4563.11873348224, -6408.7885382451495, -2535.8889874030215, -4817.431440933783, -1702.9537715844046, -4096.916585520957, -3338.0443388585845, -6559.261376056264, -5021.424401884176, -10340.03595378406, -10573.460067309676, -7971.820411129908, -7981.698405747191, -3595.2609635930057, -2726.188970697087, -8012.099116019753, -8887.507544288126, -2231.520686502405, -629.1908996343537, -9444.263453963082, -9925.458595628952, -2798.8888172275156, -4420.616099626498, -3382.6532784124206, -4510.9207294979915, -2903.8120004904786, -8022.995787969156, -8142.100380120399, -6465.3899774998235, -10101.504576170482, -6770.029571935462, -1804.460260940494, -6304.517219537319, -3456.740400314019, -2519.932290809749, -3036.585394408268, -3782.762999750394, -4034.192518287794, -9926.632347828323, -3836.2297352414316, -3343.2242006090496, -10560.612558818968, -8712.931823473167, -8102.150326878939, -5284.571103715987, -8644.549053166966, -10357.571021745805, -9800.056535891, -11434.522026352928, -2278.65332772535, -1141.8999498025146, -4607.889263140477, -10093.27214091202, -2603.869809852299, -9593.469982195045, -8369.88924034271, -9077.210650029374, -5651.693443812935, -2456.484630053626, -4710.729126675148, -4899.282062833573, -2980.498230328258, -2690.628505105776, -8350.050099938668, -4809.624892231545, -2823.474183846581, -4980.27366029164, -9962.42019605152, -7269.221991823554, -6132.733646138003, -3295.5981731717193, -9707.407074742134, -7466.642679900229, -6362.949961893778, -8596.846287118513, -8342.469256600083, -5073.20155312699, -5049.018504348239, -1778.2486151587968, -6839.962728217568, -6688.743010209336, -10019.442559759484, -7930.865281965426, -8656.182956347619, -6716.173561372106, -3926.9699922116847, -2861.7588973452857, -11786.28167544993, -10591.678378769227, -6229.237405754579, -5605.439875493448, -4230.078686662013, -5387.22854608806, -6060.75919261009, -5430.115149621609, -6490.891194684593, -9615.789963990957, -8898.504479338886, -10610.534315345278, -8396.218556193124, -3107.3036357697874, -5122.105833349453, -6392.810170293725, -6993.221627275393, -2981.6181246383426, -6130.32162109531, -4712.814787228449, -6829.343266284374, -8235.857662734392, -5905.542241721637, -6447.67998395977, -5068.777318746797, -769.9517186444823, -7689.9329116797735, -6875.614114862938, -3481.650877099709, -658.2937297188319, -2172.7839599062463, -2002.8587483062345, -1903.9227109194817, -7989.574802377945, -3201.9506168140797, -4325.179734414581, -5439.29232322649, -3327.136674493153, -2142.3453743752198, -2391.2612045142223, -3799.508876406495, -7520.0281311171875, -4619.987044531503, -5083.440450041457, -1039.5451080975547, -2941.059499432896, -9058.50714046877, -7896.450130853199, -5308.7614566060965, -3146.903991471831, -9721.862337131994, -9465.202657866377, -1947.9342639581585, -4628.153466549404, -9862.829163422039, -6008.255324987108, -4055.2571766394894, -4253.967532789459, -8138.945014490878, -6251.947848304508, -3507.859946468537, -3125.7975937070214, -11626.806600183127, -6816.187748142299, -3587.284026450958, -3209.2383521786505, -7353.6122671554085, -10023.976287335126, -5672.002187194131, -4312.414609502527, -1525.9286080027744, -4970.049190769608, -2702.3246654910786, -6192.488604825012, -5759.80258693501, -5415.636192988124, -6925.226481011189, -8379.895482860955, -3876.006856845154, -3214.43881821201, -2098.027769939652, -3962.2895532316406, -8708.496684563142, -7821.801633546965, -3682.5292449333174, -7092.882381472497, -5813.664736648888, -6210.481219417995, -4484.479632065062, -4922.068686316782, -3447.6205031948048, -5767.698807487239, -6345.797828424756, -9788.579537118003, -8584.596159433646, -5284.738870577329, -7036.789636213121, -10879.51039441882, -5063.967762474098, -3329.956245671816, -9376.764496068448, -9335.526670528045, -3097.6774834734824, -4317.957612615813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39561121388904724, "mean_inference_ms": 0.9637881085579951, "mean_action_processing_ms": 0.16624229897618695, "mean_env_wait_ms": 0.05093554973386385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003468751907348633, "StateBufferConnector_ms": 0.0025098323822021484, "ViewRequirementAgentConnector_ms": 0.06882739067077637}, "num_episodes": 19, "episode_return_max": -2231.520686502405, "episode_return_min": -11786.668546687077, "episode_return_mean": -6865.4800323811305}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.4733354081761, "num_env_steps_trained_throughput_per_sec": 540.4733354081761, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2244000, "timers": {"training_iteration_time_ms": 7373.267, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7373.234, "sample_time_ms": 777.777, "learn_time_ms": 6582.69, "learn_throughput": 607.654, "synch_weights_time_ms": 12.333}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "done": false, "training_iteration": 187, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-47", "timestamp": 1723232987, "time_this_iter_s": 7.40479588508606, "time_total_s": 1392.4362003803253, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32a39d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1392.4362003803253, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 27.681818181818183, "ram_util_percent": 82.73636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7750350903409223, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997395820418994, "policy_loss": -0.00474517559632659, "vf_loss": 9.997650013367336, "vf_explained_var": -0.002970346249639988, "kl": 0.015349190313524256, "entropy": 1.0241601586962739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8978676544453101, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997935474234284, "policy_loss": -0.0021694609873174203, "vf_loss": 9.997746600297393, "vf_explained_var": 0.00013730554353623162, "kl": 0.008281580036846063, "entropy": 0.9902061505292459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": -2285.352997067201, "episode_reward_min": -11786.668546687077, "episode_reward_mean": -6794.395355615217, "episode_len_mean": 198.49, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19849, "policy_reward_min": {"agent_policy": 658.2937297188319, "adversary_policy": -11786.28167544993}, "policy_reward_max": {"agent_policy": 10591.291507532085, "adversary_policy": -658.2937297188319}, "policy_reward_mean": {"agent_policy": 4613.660691077986, "adversary_policy": -5704.028023346601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3955.4645754251687, -9926.632347828323, -4188.313165239394, -10560.612558818966, -8102.150326878939, -10362.065775639829, -11434.522026352928, -2285.352997067201, -10093.27214091202, -9593.469982195045, -9085.26715327972, -5651.693443812936, -5174.050070986316, -3682.9286113004205, -8350.050099938668, -5028.68383333561, -9962.42019605152, -6381.870721945814, -9707.407074742134, -8596.846287118511, -8342.469256600072, -5049.018504348239, -6956.931867095142, -10019.442559759482, -8656.182956347617, -4450.620070505288, -11786.668546687077, -7213.061641001287, -5523.962115065153, -6178.586110524287, -9615.789963990957, -10610.534315345278, -8396.218556193122, -6392.810170293725, -6993.221627275393, -6130.321621095311, -8235.857662734392, -6601.92500129904, -5068.777318746797, -7746.531173327035, -3481.6508770997084, -2397.0889799176994, -7989.574802377945, -4335.324663522347, -5440.296968224488, -2531.903328094505, -7520.0281311171875, -5198.444223243406, -2941.059499432896, -9058.507140468768, -5308.7614566060965, -9722.948833099783, -4693.006895709246, -9865.659250288629, -4357.925311047951, -8138.945014490877, -4075.3986806349726, -11626.80660018313, -3917.8695925289794, -10026.33696858577, -5688.945530966525, -4970.049190769608, -6192.488604825012, -6179.053049648601, -8436.685245012643, -4628.662587225769, -4213.485300113469, -8988.243165765409, -7092.882381472497, -6301.17191830483, -5064.8573748652725, -5767.698807487238, -9788.579537118003, -8584.59615943365, -10879.51039441882, -5078.047989019414, -9428.356743342916, -4324.976615687924, -6756.544240376164, -5527.006295769764, -8442.774961656218, -4854.079754678353, -4101.6383252422775, -4336.655415615691, -10360.438720275644, -6147.947845671709, -6293.1441435683655, -7580.192302245608, -7514.890104468504, -6070.312326731971, -5875.203594114236, -5768.880645692033, -4536.058283064036, -8696.637418256887, -5601.174130969952, -8208.854837062689, -5183.60844074313, -3929.611648594206, -2691.5291636391535, -4634.520723828916], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200], "policy_agent_policy_reward": [2863.883818733492, 4034.192518287794, 2991.140770611089, 8712.931823473167, 5284.571103715987, 8640.054299272926, 9800.056535891, 1135.2002804606632, 4607.889263140477, 2603.869809852299, 8361.832737092365, 2456.484630053626, 4435.961118522406, 1988.1981241336127, 4809.624892231545, 2775.0640108026114, 7269.221991823554, 3046.4610973639055, 7466.642679900229, 6362.949961893778, 5073.20155312699, 1778.2486151587968, 6571.773871331763, 7930.865281965426, 6716.173561372106, 2338.1088190516884, 10591.291507532085, 4621.615640246734, 4093.345117684923, 5312.2882317074145, 6490.891194684593, 8898.504479338886, 3107.3036357697874, 5122.105833349453, 2981.6181246383426, 4712.814787228449, 6829.343266284374, 5751.297224382366, 769.9517186444823, 6819.015853215676, 658.2937297188319, 1778.5537282947773, 1903.9227109194817, 3191.8056877063145, 3326.1320294951565, 2001.703250794936, 3799.508876406495, 4504.983271329553, 1039.5451080975547, 7896.450130853199, 3146.903991471831, 9464.116161898588, 1883.0808347983177, 6005.425238120516, 3951.2993983810006, 6251.947848304508, 2558.258859540585, 6816.187748142299, 2878.652786100623, 7351.251585904763, 4295.471265730133, 1525.9286080027744, 2702.3246654910786, 4996.385730274526, 6868.436718859507, 2461.7830878313944, 1846.832023057829, 7542.055152344704, 3682.5292449333174, 5722.974037762052, 4341.690943516571, 3447.6205031948048, 6345.797828424756, 5284.738870577329, 7036.789636213121, 3315.8760191264982, 9283.934423253575, 3090.658480401371, 3842.4901252119353, 2567.13641282435, 6557.55000465393, 4222.69020666416, 2844.7256365203707, 3563.346076655559, 4881.110207102305, 3730.2328660379253, 5487.603671172541, 5208.389977443061, 4678.469469802255, 5333.375754980834, 4412.388173814819, 3607.838550818471, 2755.6495235209572, 4521.9172038349725, 4744.270239562614, 7290.500820355594, 3335.566812732805, 3143.5228907091255, 1649.5061098313295, 2631.948374303103], "policy_adversary_policy_reward": [-3036.585394408268, -3782.762999750394, -4034.192518287794, -9926.632347828323, -3836.2297352414316, -3343.2242006090496, -10560.612558818968, -8712.931823473167, -8102.150326878939, -5284.571103715987, -8644.549053166966, -10357.571021745805, -9800.056535891, -11434.522026352928, -2278.65332772535, -1141.8999498025146, -4607.889263140477, -10093.27214091202, -2603.869809852299, -9593.469982195045, -8369.88924034271, -9077.210650029374, -5651.693443812935, -2456.484630053626, -4710.729126675148, -4899.282062833573, -2980.498230328258, -2690.628505105776, -8350.050099938668, -4809.624892231545, -2823.474183846581, -4980.27366029164, -9962.42019605152, -7269.221991823554, -6132.733646138003, -3295.5981731717193, -9707.407074742134, -7466.642679900229, -6362.949961893778, -8596.846287118513, -8342.469256600083, -5073.20155312699, -5049.018504348239, -1778.2486151587968, -6839.962728217568, -6688.743010209336, -10019.442559759484, -7930.865281965426, -8656.182956347619, -6716.173561372106, -3926.9699922116847, -2861.7588973452857, -11786.28167544993, -10591.678378769227, -6229.237405754579, -5605.439875493448, -4230.078686662013, -5387.22854608806, -6060.75919261009, -5430.115149621609, -6490.891194684593, -9615.789963990957, -8898.504479338886, -10610.534315345278, -8396.218556193124, -3107.3036357697874, -5122.105833349453, -6392.810170293725, -6993.221627275393, -2981.6181246383426, -6130.32162109531, -4712.814787228449, -6829.343266284374, -8235.857662734392, -5905.542241721637, -6447.67998395977, -5068.777318746797, -769.9517186444823, -7689.9329116797735, -6875.614114862938, -3481.650877099709, -658.2937297188319, -2172.7839599062463, -2002.8587483062345, -1903.9227109194817, -7989.574802377945, -3201.9506168140797, -4325.179734414581, -5439.29232322649, -3327.136674493153, -2142.3453743752198, -2391.2612045142223, -3799.508876406495, -7520.0281311171875, -4619.987044531503, -5083.440450041457, -1039.5451080975547, -2941.059499432896, -9058.50714046877, -7896.450130853199, -5308.7614566060965, -3146.903991471831, -9721.862337131994, -9465.202657866377, -1947.9342639581585, -4628.153466549404, -9862.829163422039, -6008.255324987108, -4055.2571766394894, -4253.967532789459, -8138.945014490878, -6251.947848304508, -3507.859946468537, -3125.7975937070214, -11626.806600183127, -6816.187748142299, -3587.284026450958, -3209.2383521786505, -7353.6122671554085, -10023.976287335126, -5672.002187194131, -4312.414609502527, -1525.9286080027744, -4970.049190769608, -2702.3246654910786, -6192.488604825012, -5759.80258693501, -5415.636192988124, -6925.226481011189, -8379.895482860955, -3876.006856845154, -3214.43881821201, -2098.027769939652, -3962.2895532316406, -8708.496684563142, -7821.801633546965, -3682.5292449333174, -7092.882381472497, -5813.664736648888, -6210.481219417995, -4484.479632065062, -4922.068686316782, -3447.6205031948048, -5767.698807487239, -6345.797828424756, -9788.579537118003, -8584.596159433646, -5284.738870577329, -7036.789636213121, -10879.51039441882, -5063.967762474098, -3329.956245671816, -9376.764496068448, -9335.526670528045, -3097.6774834734824, -4317.957612615813, -6756.544240376164, -3842.4901252119353, -5527.006295769764, -2567.13641282435, -8442.774961656218, -6557.55000465393, -4706.455642587185, -4370.314318755329, -4085.8462091358797, -2860.517752626767, -3844.666579404498, -4055.33491286675, -10360.438720275644, -4881.110207102305, -3730.2328660379253, -6147.947845671709, -5635.690983051202, -6145.056831689704, -5208.389977443061, -7580.192302245608, -4871.249656813998, -7322.10991745676, -5333.375754980834, -6070.312326731971, -4803.574320838415, -5484.017447090639, -5763.011353937568, -3613.707842572936, -3894.3157362948655, -3397.3920702901232, -8696.637418256889, -4521.9172038349725, -4787.653249060143, -5557.791121472424, -8098.756452694491, -7400.599204723795, -3338.060827617241, -5181.114425858694, -3377.4971345791123, -3695.63740472422, -1817.9615520854113, -2523.0737213850725, -2885.058910392118, -4381.4101877398925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3955607870075355, "mean_inference_ms": 0.9637852405190896, "mean_action_processing_ms": 0.16618862903142925, "mean_env_wait_ms": 0.05090965287848027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034083127975463867, "StateBufferConnector_ms": 0.002548694610595703, "ViewRequirementAgentConnector_ms": 0.06995415687561035}, "num_episodes": 22, "episode_return_max": -2285.352997067201, "episode_return_min": -11786.668546687077, "episode_return_mean": -6794.395355615217}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.4670715844055, "num_env_steps_trained_throughput_per_sec": 545.4670715844055, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 7392.364, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7392.331, "sample_time_ms": 779.984, "learn_time_ms": 6599.632, "learn_throughput": 606.094, "synch_weights_time_ms": 12.283}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 188, "trial_id": "3439d_00000", "date": "2024-08-09_15-49-55", "timestamp": 1723232995, "time_this_iter_s": 7.337253093719482, "time_total_s": 1399.7734534740448, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ac1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1399.7734534740448, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 32.99090909090909, "ram_util_percent": 82.91818181818184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7689111817317704, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98143760462602, "policy_loss": -0.008172080679408585, "vf_loss": 9.9864621758461, "vf_explained_var": -0.006329933057228724, "kl": 0.010757470123644452, "entropy": 0.9615959064414104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8976696004233663, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.989907600766136, "policy_loss": -0.0028462977927158433, "vf_loss": 9.990830984569731, "vf_explained_var": 0.00013615763376629542, "kl": 0.0067526185117592966, "entropy": 0.9817820809820973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "env_runners": {"episode_reward_max": -1608.5063868739676, "episode_reward_min": -11786.668546687077, "episode_reward_mean": -6695.820077188736, "episode_len_mean": 196.7, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19670, "policy_reward_min": {"agent_policy": 338.4092428967367, "adversary_policy": -11786.28167544993}, "policy_reward_max": {"agent_policy": 10591.291507532085, "adversary_policy": -338.4092428967367}, "policy_reward_mean": {"agent_policy": 4538.842734217256, "adversary_policy": -5617.331405702995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6956.931867095142, -10019.442559759482, -8656.182956347617, -4450.620070505288, -11786.668546687077, -7213.061641001287, -5523.962115065153, -6178.586110524287, -9615.789963990957, -10610.534315345278, -8396.218556193122, -6392.810170293725, -6993.221627275393, -6130.321621095311, -8235.857662734392, -6601.92500129904, -5068.777318746797, -7746.531173327035, -3481.6508770997084, -2397.0889799176994, -7989.574802377945, -4335.324663522347, -5440.296968224488, -2531.903328094505, -7520.0281311171875, -5198.444223243406, -2941.059499432896, -9058.507140468768, -5308.7614566060965, -9722.948833099783, -4693.006895709246, -9865.659250288629, -4357.925311047951, -8138.945014490877, -4075.3986806349726, -11626.80660018313, -3917.8695925289794, -10026.33696858577, -5688.945530966525, -4970.049190769608, -6192.488604825012, -6179.053049648601, -8436.685245012643, -4628.662587225769, -4213.485300113469, -8988.243165765409, -7092.882381472497, -6301.17191830483, -5064.8573748652725, -5767.698807487238, -9788.579537118003, -8584.59615943365, -10879.51039441882, -5078.047989019414, -9428.356743342916, -4324.976615687924, -6756.544240376164, -5527.006295769764, -8442.774961656218, -4854.079754678353, -4101.6383252422775, -4336.655415615691, -10360.438720275644, -6147.947845671709, -6293.1441435683655, -7580.192302245608, -7514.890104468504, -6070.312326731971, -5875.203594114236, -5768.880645692033, -4536.058283064036, -8696.637418256887, -5601.174130969952, -8208.854837062689, -5183.60844074313, -3929.611648594206, -2691.5291636391535, -4634.520723828916, -9389.180518909228, -8152.23353760514, -1608.5063868739676, -9506.12256189114, -4157.483602144149, -4218.975891157421, -6916.752123889143, -5772.608204810391, -5744.890566597764, -9702.98922097032, -10216.635811780552, -7381.479355449459, -10257.750973944001, -4519.4138788065, -4445.851171699512, -3773.8406780028545, -6953.565732147743, -10522.852427659385, -10017.458002972879, -9326.192539218493, -6315.277797913957, -6756.972322725543], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 105, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6571.773871331763, 7930.865281965426, 6716.173561372106, 2338.1088190516884, 10591.291507532085, 4621.615640246734, 4093.345117684923, 5312.2882317074145, 6490.891194684593, 8898.504479338886, 3107.3036357697874, 5122.105833349453, 2981.6181246383426, 4712.814787228449, 6829.343266284374, 5751.297224382366, 769.9517186444823, 6819.015853215676, 658.2937297188319, 1778.5537282947773, 1903.9227109194817, 3191.8056877063145, 3326.1320294951565, 2001.703250794936, 3799.508876406495, 4504.983271329553, 1039.5451080975547, 7896.450130853199, 3146.903991471831, 9464.116161898588, 1883.0808347983177, 6005.425238120516, 3951.2993983810006, 6251.947848304508, 2558.258859540585, 6816.187748142299, 2878.652786100623, 7351.251585904763, 4295.471265730133, 1525.9286080027744, 2702.3246654910786, 4996.385730274526, 6868.436718859507, 2461.7830878313944, 1846.832023057829, 7542.055152344704, 3682.5292449333174, 5722.974037762052, 4341.690943516571, 3447.6205031948048, 6345.797828424756, 5284.738870577329, 7036.789636213121, 3315.8760191264982, 9283.934423253575, 3090.658480401371, 3842.4901252119353, 2567.13641282435, 6557.55000465393, 4222.69020666416, 2844.7256365203707, 3563.346076655559, 4881.110207102305, 3730.2328660379253, 5487.603671172541, 5208.389977443061, 4678.469469802255, 5333.375754980834, 4412.388173814819, 3607.838550818471, 2755.6495235209572, 4521.9172038349725, 4744.270239562614, 7290.500820355594, 3335.566812732805, 3143.5228907091255, 1649.5061098313295, 2631.948374303103, 2032.0987869434318, 6298.319455668593, 338.4092428967367, 7982.939682571359, 2270.8536979679247, 3125.909072790812, 4184.134171099187, 3402.504459161476, 3411.8791919620166, 9457.689752789465, 3785.0681744121935, 4504.426372968029, 8836.589703324249, 4108.612368105974, 911.0577866501895, 1725.4098471911525, 3002.9496481578826, 8451.828326075129, 9662.569564284106, 4284.29785092502, 2431.158293203887, 4807.180500320687], "policy_adversary_policy_reward": [-6839.962728217568, -6688.743010209336, -10019.442559759484, -7930.865281965426, -8656.182956347619, -6716.173561372106, -3926.9699922116847, -2861.7588973452857, -11786.28167544993, -10591.678378769227, -6229.237405754579, -5605.439875493448, -4230.078686662013, -5387.22854608806, -6060.75919261009, -5430.115149621609, -6490.891194684593, -9615.789963990957, -8898.504479338886, -10610.534315345278, -8396.218556193124, -3107.3036357697874, -5122.105833349453, -6392.810170293725, -6993.221627275393, -2981.6181246383426, -6130.32162109531, -4712.814787228449, -6829.343266284374, -8235.857662734392, -5905.542241721637, -6447.67998395977, -5068.777318746797, -769.9517186444823, -7689.9329116797735, -6875.614114862938, -3481.650877099709, -658.2937297188319, -2172.7839599062463, -2002.8587483062345, -1903.9227109194817, -7989.574802377945, -3201.9506168140797, -4325.179734414581, -5439.29232322649, -3327.136674493153, -2142.3453743752198, -2391.2612045142223, -3799.508876406495, -7520.0281311171875, -4619.987044531503, -5083.440450041457, -1039.5451080975547, -2941.059499432896, -9058.50714046877, -7896.450130853199, -5308.7614566060965, -3146.903991471831, -9721.862337131994, -9465.202657866377, -1947.9342639581585, -4628.153466549404, -9862.829163422039, -6008.255324987108, -4055.2571766394894, -4253.967532789459, -8138.945014490878, -6251.947848304508, -3507.859946468537, -3125.7975937070214, -11626.806600183127, -6816.187748142299, -3587.284026450958, -3209.2383521786505, -7353.6122671554085, -10023.976287335126, -5672.002187194131, -4312.414609502527, -1525.9286080027744, -4970.049190769608, -2702.3246654910786, -6192.488604825012, -5759.80258693501, -5415.636192988124, -6925.226481011189, -8379.895482860955, -3876.006856845154, -3214.43881821201, -2098.027769939652, -3962.2895532316406, -8708.496684563142, -7821.801633546965, -3682.5292449333174, -7092.882381472497, -5813.664736648888, -6210.481219417995, -4484.479632065062, -4922.068686316782, -3447.6205031948048, -5767.698807487239, -6345.797828424756, -9788.579537118003, -8584.596159433646, -5284.738870577329, -7036.789636213121, -10879.51039441882, -5063.967762474098, -3329.956245671816, -9376.764496068448, -9335.526670528045, -3097.6774834734824, -4317.957612615813, -6756.544240376164, -3842.4901252119353, -5527.006295769764, -2567.13641282435, -8442.774961656218, -6557.55000465393, -4706.455642587185, -4370.314318755329, -4085.8462091358797, -2860.517752626767, -3844.666579404498, -4055.33491286675, -10360.438720275644, -4881.110207102305, -3730.2328660379253, -6147.947845671709, -5635.690983051202, -6145.056831689704, -5208.389977443061, -7580.192302245608, -4871.249656813998, -7322.10991745676, -5333.375754980834, -6070.312326731971, -4803.574320838415, -5484.017447090639, -5763.011353937568, -3613.707842572936, -3894.3157362948655, -3397.3920702901232, -8696.637418256889, -4521.9172038349725, -4787.653249060143, -5557.791121472424, -8098.756452694491, -7400.599204723795, -3338.060827617241, -5181.114425858694, -3377.4971345791123, -3695.63740472422, -1817.9615520854113, -2523.0737213850725, -2885.058910392118, -4381.4101877398925, -9389.180518909228, -2032.0987869434318, -8152.233537605139, -6298.319455668593, -338.4092428967367, -1608.5063868739676, -7982.939682571359, -9506.12256189114, -4126.025488037632, -2302.3118120744407, -3992.632006205685, -3352.2529577425526, -6916.752123889142, -4184.134171099187, -3402.504459161476, -5772.608204810391, -5733.504734620102, -3423.2650239396776, -9487.436882756865, -9673.24209100292, -10216.63581178055, -3785.0681744121935, -4504.426372968029, -7381.479355449459, -9502.227889498468, -9592.112787769793, -4358.584435959795, -4269.441810952681, -911.0577866501895, -4445.851171699512, -3773.8406780028545, -1725.4098471911525, -3002.9496481578826, -6953.565732147742, -8451.828326075129, -10522.852427659385, -10016.946317018605, -9663.081250238378, -9326.192539218495, -4284.29785092502, -6315.277797913957, -2431.158293203887, -6445.623650351012, -5118.529172695222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39585325676854516, "mean_inference_ms": 0.9629942606840933, "mean_action_processing_ms": 0.16628906593626858, "mean_env_wait_ms": 0.050991237477768465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035467147827148438, "StateBufferConnector_ms": 0.002628922462463379, "ViewRequirementAgentConnector_ms": 0.0727231502532959}, "num_episodes": 22, "episode_return_max": -1608.5063868739676, "episode_return_min": -11786.668546687077, "episode_return_mean": -6695.820077188736}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 531.0907076815234, "num_env_steps_trained_throughput_per_sec": 531.0907076815234, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 2268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 7440.129, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7440.095, "sample_time_ms": 788.701, "learn_time_ms": 6638.474, "learn_throughput": 602.548, "synch_weights_time_ms": 12.487}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "training_iteration": 189, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-02", "timestamp": 1723233002, "time_this_iter_s": 7.537054061889648, "time_total_s": 1407.3105075359344, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32a3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1407.3105075359344, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 31.463636363636365, "ram_util_percent": 83.08181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7658605245873332, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.984860226511955, "policy_loss": -0.008752167351728228, "vf_loss": 9.991107291976611, "vf_explained_var": -0.003087602245310942, "kl": 0.008561785952042555, "entropy": 1.005942662494878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.928069951286707, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990203392694866, "policy_loss": -0.005183159474224325, "vf_loss": 9.993191566164532, "vf_explained_var": 0.00032572834580032914, "kl": 0.007708085681035839, "entropy": 1.0113058565154909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": -605.0821524669589, "episode_reward_min": -12415.154973260707, "episode_reward_mean": -6702.219023372661, "episode_len_mean": 194.05, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19405, "policy_reward_min": {"agent_policy": 33.32198273472819, "adversary_policy": -12089.940601411048}, "policy_reward_max": {"agent_policy": 11643.50721765244, "adversary_policy": -33.32198273472819}, "policy_reward_mean": {"agent_policy": 4428.009045754219, "adversary_policy": -5565.11403456344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4335.324663522347, -5440.296968224488, -2531.903328094505, -7520.0281311171875, -5198.444223243406, -2941.059499432896, -9058.507140468768, -5308.7614566060965, -9722.948833099783, -4693.006895709246, -9865.659250288629, -4357.925311047951, -8138.945014490877, -4075.3986806349726, -11626.80660018313, -3917.8695925289794, -10026.33696858577, -5688.945530966525, -4970.049190769608, -6192.488604825012, -6179.053049648601, -8436.685245012643, -4628.662587225769, -4213.485300113469, -8988.243165765409, -7092.882381472497, -6301.17191830483, -5064.8573748652725, -5767.698807487238, -9788.579537118003, -8584.59615943365, -10879.51039441882, -5078.047989019414, -9428.356743342916, -4324.976615687924, -6756.544240376164, -5527.006295769764, -8442.774961656218, -4854.079754678353, -4101.6383252422775, -4336.655415615691, -10360.438720275644, -6147.947845671709, -6293.1441435683655, -7580.192302245608, -7514.890104468504, -6070.312326731971, -5875.203594114236, -5768.880645692033, -4536.058283064036, -8696.637418256887, -5601.174130969952, -8208.854837062689, -5183.60844074313, -3929.611648594206, -2691.5291636391535, -4634.520723828916, -9389.180518909228, -8152.23353760514, -1608.5063868739676, -9506.12256189114, -4157.483602144149, -4218.975891157421, -6916.752123889143, -5772.608204810391, -5744.890566597764, -9702.98922097032, -10216.635811780552, -7381.479355449459, -10257.750973944001, -4519.4138788065, -4445.851171699512, -3773.8406780028545, -6953.565732147743, -10522.852427659385, -10017.458002972879, -9326.192539218493, -6315.277797913957, -6756.972322725543, -9999.77844444025, -5859.372990618038, -5617.46525145459, -5029.066416346682, -7485.537702959051, -5203.261348517833, -10789.256468710708, -5892.614050947962, -605.0821524669589, -3090.9499704391183, -12415.154973260707, -11764.046539029947, -9077.117747852562, -3713.883254324778, -5526.77944835488, -4898.46351856452, -10405.874532426491, -9848.160995034728, -6751.1138879794335, -9963.467007153635, -7149.205854191506], "episode_lengths": [200, 200, 200, 200, 200, 169, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 105, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3191.8056877063145, 3326.1320294951565, 2001.703250794936, 3799.508876406495, 4504.983271329553, 1039.5451080975547, 7896.450130853199, 3146.903991471831, 9464.116161898588, 1883.0808347983177, 6005.425238120516, 3951.2993983810006, 6251.947848304508, 2558.258859540585, 6816.187748142299, 2878.652786100623, 7351.251585904763, 4295.471265730133, 1525.9286080027744, 2702.3246654910786, 4996.385730274526, 6868.436718859507, 2461.7830878313944, 1846.832023057829, 7542.055152344704, 3682.5292449333174, 5722.974037762052, 4341.690943516571, 3447.6205031948048, 6345.797828424756, 5284.738870577329, 7036.789636213121, 3315.8760191264982, 9283.934423253575, 3090.658480401371, 3842.4901252119353, 2567.13641282435, 6557.55000465393, 4222.69020666416, 2844.7256365203707, 3563.346076655559, 4881.110207102305, 3730.2328660379253, 5487.603671172541, 5208.389977443061, 4678.469469802255, 5333.375754980834, 4412.388173814819, 3607.838550818471, 2755.6495235209572, 4521.9172038349725, 4744.270239562614, 7290.500820355594, 3335.566812732805, 3143.5228907091255, 1649.5061098313295, 2631.948374303103, 2032.0987869434318, 6298.319455668593, 338.4092428967367, 7982.939682571359, 2270.8536979679247, 3125.909072790812, 4184.134171099187, 3402.504459161476, 3411.8791919620166, 9457.689752789465, 3785.0681744121935, 4504.426372968029, 8836.589703324249, 4108.612368105974, 911.0577866501895, 1725.4098471911525, 3002.9496481578826, 8451.828326075129, 9662.569564284106, 4284.29785092502, 2431.158293203887, 4807.180500320687, 6147.149324523328, 2564.0685253582615, 4600.759840913462, 1408.2467204868026, 5816.238826240194, 2956.85691766465, 6857.438829196158, 2665.9071843734505, 33.32198273472819, 1191.0367868962862, 11643.50721765244, 9848.57695719354, 7527.424775381322, 2393.9788732283782, 4262.255060787199, 1560.125939522632, 4448.31156009299, 4158.758528585825, 4864.125325013384, 2864.8161786531846, 5102.804116559656], "policy_adversary_policy_reward": [-3201.9506168140797, -4325.179734414581, -5439.29232322649, -3327.136674493153, -2142.3453743752198, -2391.2612045142223, -3799.508876406495, -7520.0281311171875, -4619.987044531503, -5083.440450041457, -1039.5451080975547, -2941.059499432896, -9058.50714046877, -7896.450130853199, -5308.7614566060965, -3146.903991471831, -9721.862337131994, -9465.202657866377, -1947.9342639581585, -4628.153466549404, -9862.829163422039, -6008.255324987108, -4055.2571766394894, -4253.967532789459, -8138.945014490878, -6251.947848304508, -3507.859946468537, -3125.7975937070214, -11626.806600183127, -6816.187748142299, -3587.284026450958, -3209.2383521786505, -7353.6122671554085, -10023.976287335126, -5672.002187194131, -4312.414609502527, -1525.9286080027744, -4970.049190769608, -2702.3246654910786, -6192.488604825012, -5759.80258693501, -5415.636192988124, -6925.226481011189, -8379.895482860955, -3876.006856845154, -3214.43881821201, -2098.027769939652, -3962.2895532316406, -8708.496684563142, -7821.801633546965, -3682.5292449333174, -7092.882381472497, -5813.664736648888, -6210.481219417995, -4484.479632065062, -4922.068686316782, -3447.6205031948048, -5767.698807487239, -6345.797828424756, -9788.579537118003, -8584.596159433646, -5284.738870577329, -7036.789636213121, -10879.51039441882, -5063.967762474098, -3329.956245671816, -9376.764496068448, -9335.526670528045, -3097.6774834734824, -4317.957612615813, -6756.544240376164, -3842.4901252119353, -5527.006295769764, -2567.13641282435, -8442.774961656218, -6557.55000465393, -4706.455642587185, -4370.314318755329, -4085.8462091358797, -2860.517752626767, -3844.666579404498, -4055.33491286675, -10360.438720275644, -4881.110207102305, -3730.2328660379253, -6147.947845671709, -5635.690983051202, -6145.056831689704, -5208.389977443061, -7580.192302245608, -4871.249656813998, -7322.10991745676, -5333.375754980834, -6070.312326731971, -4803.574320838415, -5484.017447090639, -5763.011353937568, -3613.707842572936, -3894.3157362948655, -3397.3920702901232, -8696.637418256889, -4521.9172038349725, -4787.653249060143, -5557.791121472424, -8098.756452694491, -7400.599204723795, -3338.060827617241, -5181.114425858694, -3377.4971345791123, -3695.63740472422, -1817.9615520854113, -2523.0737213850725, -2885.058910392118, -4381.4101877398925, -9389.180518909228, -2032.0987869434318, -8152.233537605139, -6298.319455668593, -338.4092428967367, -1608.5063868739676, -7982.939682571359, -9506.12256189114, -4126.025488037632, -2302.3118120744407, -3992.632006205685, -3352.2529577425526, -6916.752123889142, -4184.134171099187, -3402.504459161476, -5772.608204810391, -5733.504734620102, -3423.2650239396776, -9487.436882756865, -9673.24209100292, -10216.63581178055, -3785.0681744121935, -4504.426372968029, -7381.479355449459, -9502.227889498468, -9592.112787769793, -4358.584435959795, -4269.441810952681, -911.0577866501895, -4445.851171699512, -3773.8406780028545, -1725.4098471911525, -3002.9496481578826, -6953.565732147742, -8451.828326075129, -10522.852427659385, -10016.946317018605, -9663.081250238378, -9326.192539218495, -4284.29785092502, -6315.277797913957, -2431.158293203887, -6445.623650351012, -5118.529172695222, -6147.149324523328, -9999.77844444025, -2564.0685253582615, -5859.372990618038, -5261.399568274696, -4956.825524093362, -2820.544058484926, -3616.769078348549, -7461.602246029122, -5840.1742831701185, -2956.85691766465, -5203.261348517833, -10789.256468710708, -6857.438829196158, -2758.680240685672, -5799.8409946357415, -33.32198273472819, -605.0821524669589, -3090.9499704391183, -1191.0367868962862, -11968.721589502104, -12089.940601411048, -9880.460743393776, -11732.16275282971, -9077.117747852562, -7527.424775381322, -3111.9416484145668, -2995.9204791385855, -4312.665799238599, -5476.368709903482, -4898.463518564519, -1560.125939522632, -4448.31156009299, -10405.874532426491, -4158.758528585825, -9848.160995034728, -4879.576386557252, -6735.662826435566, -9963.467007153637, -2864.8161786531846, -5102.804116559656, -7149.205854191505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39588532839185286, "mean_inference_ms": 0.9644278319435213, "mean_action_processing_ms": 0.1663415767611165, "mean_env_wait_ms": 0.05099438655351581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005669593811035156, "StateBufferConnector_ms": 0.0027238130569458008, "ViewRequirementAgentConnector_ms": 0.07041287422180176}, "num_episodes": 21, "episode_return_max": -605.0821524669589, "episode_return_min": -12415.154973260707, "episode_return_mean": -6702.219023372661}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.120961143767, "num_env_steps_trained_throughput_per_sec": 537.120961143767, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 7467.869, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7467.832, "sample_time_ms": 785.222, "learn_time_ms": 6669.288, "learn_throughput": 599.764, "synch_weights_time_ms": 12.825}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 190, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-10", "timestamp": 1723233010, "time_this_iter_s": 7.452401876449585, "time_total_s": 1414.762909412384, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32a3dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1414.762909412384, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 31.820000000000004, "ram_util_percent": 83.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6729523115946601, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001033465067545, "policy_loss": -0.00242890376636448, "vf_loss": 10.0, "vf_explained_var": -0.0027085432161887486, "kl": 0.011833611071536628, "entropy": 0.8211336160078645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.874937778380182, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997310677281133, "policy_loss": -0.0055533615203337775, "vf_loss": 10.0, "vf_explained_var": -3.192755911085341e-05, "kl": 0.010057500663839241, "entropy": 0.9860583564276417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "env_runners": {"episode_reward_max": -195.88373985211717, "episode_reward_min": -13037.944046569934, "episode_reward_mean": -6804.6116179592445, "episode_len_mean": 192.55, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19255, "policy_reward_min": {"agent_policy": 33.32198273472819, "adversary_policy": -13037.944046569934}, "policy_reward_max": {"agent_policy": 11643.50721765244, "adversary_policy": -33.32198273472819}, "policy_reward_mean": {"agent_policy": 4445.612892297588, "adversary_policy": -5625.112255128416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6179.053049648601, -8436.685245012643, -4628.662587225769, -4213.485300113469, -8988.243165765409, -7092.882381472497, -6301.17191830483, -5064.8573748652725, -5767.698807487238, -9788.579537118003, -8584.59615943365, -10879.51039441882, -5078.047989019414, -9428.356743342916, -4324.976615687924, -6756.544240376164, -5527.006295769764, -8442.774961656218, -4854.079754678353, -4101.6383252422775, -4336.655415615691, -10360.438720275644, -6147.947845671709, -6293.1441435683655, -7580.192302245608, -7514.890104468504, -6070.312326731971, -5875.203594114236, -5768.880645692033, -4536.058283064036, -8696.637418256887, -5601.174130969952, -8208.854837062689, -5183.60844074313, -3929.611648594206, -2691.5291636391535, -4634.520723828916, -9389.180518909228, -8152.23353760514, -1608.5063868739676, -9506.12256189114, -4157.483602144149, -4218.975891157421, -6916.752123889143, -5772.608204810391, -5744.890566597764, -9702.98922097032, -10216.635811780552, -7381.479355449459, -10257.750973944001, -4519.4138788065, -4445.851171699512, -3773.8406780028545, -6953.565732147743, -10522.852427659385, -10017.458002972879, -9326.192539218493, -6315.277797913957, -6756.972322725543, -9999.77844444025, -5859.372990618038, -5617.46525145459, -5029.066416346682, -7485.537702959051, -5203.261348517833, -10789.256468710708, -5892.614050947962, -605.0821524669589, -3090.9499704391183, -12415.154973260707, -11764.046539029947, -9077.117747852562, -3713.883254324778, -5526.77944835488, -4898.46351856452, -10405.874532426491, -9848.160995034728, -6751.1138879794335, -9963.467007153635, -7149.205854191506, -9268.525037939153, -6542.320239308322, -3530.8070407446926, -8042.697947364104, -6054.275165123807, -9715.766629370019, -9828.2759629723, -9727.360799440296, -6123.461971552264, -13037.944046569934, -4202.2356661321755, -7943.623231418134, -5048.812404378034, -5010.6040476723465, -5255.9165918249355, -7438.915607292628, -195.88373985211717, -5799.31716427887, -5269.428080774756, -7813.793968489696], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 105, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200], "policy_agent_policy_reward": [4996.385730274526, 6868.436718859507, 2461.7830878313944, 1846.832023057829, 7542.055152344704, 3682.5292449333174, 5722.974037762052, 4341.690943516571, 3447.6205031948048, 6345.797828424756, 5284.738870577329, 7036.789636213121, 3315.8760191264982, 9283.934423253575, 3090.658480401371, 3842.4901252119353, 2567.13641282435, 6557.55000465393, 4222.69020666416, 2844.7256365203707, 3563.346076655559, 4881.110207102305, 3730.2328660379253, 5487.603671172541, 5208.389977443061, 4678.469469802255, 5333.375754980834, 4412.388173814819, 3607.838550818471, 2755.6495235209572, 4521.9172038349725, 4744.270239562614, 7290.500820355594, 3335.566812732805, 3143.5228907091255, 1649.5061098313295, 2631.948374303103, 2032.0987869434318, 6298.319455668593, 338.4092428967367, 7982.939682571359, 2270.8536979679247, 3125.909072790812, 4184.134171099187, 3402.504459161476, 3411.8791919620166, 9457.689752789465, 3785.0681744121935, 4504.426372968029, 8836.589703324249, 4108.612368105974, 911.0577866501895, 1725.4098471911525, 3002.9496481578826, 8451.828326075129, 9662.569564284106, 4284.29785092502, 2431.158293203887, 4807.180500320687, 6147.149324523328, 2564.0685253582615, 4600.759840913462, 1408.2467204868026, 5816.238826240194, 2956.85691766465, 6857.438829196158, 2665.9071843734505, 33.32198273472819, 1191.0367868962862, 11643.50721765244, 9848.57695719354, 7527.424775381322, 2393.9788732283782, 4262.255060787199, 1560.125939522632, 4448.31156009299, 4158.758528585825, 4864.125325013384, 2864.8161786531846, 5102.804116559656, 7252.09267717158, 5057.0710763717, 2806.249485920894, 2753.552891348674, 4948.166754326324, 9181.166594843771, 3757.80865467112, 5924.912465514277, 3589.070711102946, 6004.912322948634, 2216.326536910943, 6776.439299137876, 3431.602616638163, 4046.221423063741, 4130.647015926818, 4917.708163107693, 57.15272442717164, 3267.345325756271, 2652.5148111753642, 3580.4004505430394], "policy_adversary_policy_reward": [-5759.80258693501, -5415.636192988124, -6925.226481011189, -8379.895482860955, -3876.006856845154, -3214.43881821201, -2098.027769939652, -3962.2895532316406, -8708.496684563142, -7821.801633546965, -3682.5292449333174, -7092.882381472497, -5813.664736648888, -6210.481219417995, -4484.479632065062, -4922.068686316782, -3447.6205031948048, -5767.698807487239, -6345.797828424756, -9788.579537118003, -8584.596159433646, -5284.738870577329, -7036.789636213121, -10879.51039441882, -5063.967762474098, -3329.956245671816, -9376.764496068448, -9335.526670528045, -3097.6774834734824, -4317.957612615813, -6756.544240376164, -3842.4901252119353, -5527.006295769764, -2567.13641282435, -8442.774961656218, -6557.55000465393, -4706.455642587185, -4370.314318755329, -4085.8462091358797, -2860.517752626767, -3844.666579404498, -4055.33491286675, -10360.438720275644, -4881.110207102305, -3730.2328660379253, -6147.947845671709, -5635.690983051202, -6145.056831689704, -5208.389977443061, -7580.192302245608, -4871.249656813998, -7322.10991745676, -5333.375754980834, -6070.312326731971, -4803.574320838415, -5484.017447090639, -5763.011353937568, -3613.707842572936, -3894.3157362948655, -3397.3920702901232, -8696.637418256889, -4521.9172038349725, -4787.653249060143, -5557.791121472424, -8098.756452694491, -7400.599204723795, -3338.060827617241, -5181.114425858694, -3377.4971345791123, -3695.63740472422, -1817.9615520854113, -2523.0737213850725, -2885.058910392118, -4381.4101877398925, -9389.180518909228, -2032.0987869434318, -8152.233537605139, -6298.319455668593, -338.4092428967367, -1608.5063868739676, -7982.939682571359, -9506.12256189114, -4126.025488037632, -2302.3118120744407, -3992.632006205685, -3352.2529577425526, -6916.752123889142, -4184.134171099187, -3402.504459161476, -5772.608204810391, -5733.504734620102, -3423.2650239396776, -9487.436882756865, -9673.24209100292, -10216.63581178055, -3785.0681744121935, -4504.426372968029, -7381.479355449459, -9502.227889498468, -9592.112787769793, -4358.584435959795, -4269.441810952681, -911.0577866501895, -4445.851171699512, -3773.8406780028545, -1725.4098471911525, -3002.9496481578826, -6953.565732147742, -8451.828326075129, -10522.852427659385, -10016.946317018605, -9663.081250238378, -9326.192539218495, -4284.29785092502, -6315.277797913957, -2431.158293203887, -6445.623650351012, -5118.529172695222, -6147.149324523328, -9999.77844444025, -2564.0685253582615, -5859.372990618038, -5261.399568274696, -4956.825524093362, -2820.544058484926, -3616.769078348549, -7461.602246029122, -5840.1742831701185, -2956.85691766465, -5203.261348517833, -10789.256468710708, -6857.438829196158, -2758.680240685672, -5799.8409946357415, -33.32198273472819, -605.0821524669589, -3090.9499704391183, -1191.0367868962862, -11968.721589502104, -12089.940601411048, -9880.460743393776, -11732.16275282971, -9077.117747852562, -7527.424775381322, -3111.9416484145668, -2995.9204791385855, -4312.665799238599, -5476.368709903482, -4898.463518564519, -1560.125939522632, -4448.31156009299, -10405.874532426491, -4158.758528585825, -9848.160995034728, -4879.576386557252, -6735.662826435566, -9963.467007153637, -2864.8161786531846, -5102.804116559656, -7149.205854191505, -9268.525037939153, -7252.09267717158, -5986.877268944054, -5612.514046735965, -2816.357887708024, -3520.69863895756, -8042.697947364105, -2753.552891348674, -4948.166754326324, -6054.275165123807, -9621.589724182742, -9275.34350003105, -9828.2759629723, -3757.80865467112, -9727.360799440297, -5924.912465514277, -6123.461971552264, -3589.070711102946, -6004.912322948634, -13037.944046569934, -2216.326536910943, -4202.2356661321755, -7905.611971776265, -6814.450558779747, -5048.812404378034, -3431.602616638163, -5008.767585026498, -4048.0578857095893, -5255.572471282427, -4130.991136469328, -7438.915607292627, -4917.708163107693, -57.15272442717164, -195.88373985211717, -3283.781121248936, -5782.881368786205, -5269.4280807747555, -2652.5148111753642, -3580.4004505430394, -7813.793968489696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957663572846604, "mean_inference_ms": 0.964537874574032, "mean_action_processing_ms": 0.16638286195089833, "mean_env_wait_ms": 0.0509908812446718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005652427673339844, "StateBufferConnector_ms": 0.0025960206985473633, "ViewRequirementAgentConnector_ms": 0.0670708417892456}, "num_episodes": 20, "episode_return_max": -195.88373985211717, "episode_return_min": -13037.944046569934, "episode_return_mean": -6804.6116179592445}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.9774428138546, "num_env_steps_trained_throughput_per_sec": 538.9774428138546, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 2292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2292000, "timers": {"training_iteration_time_ms": 7426.623, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7426.585, "sample_time_ms": 785.382, "learn_time_ms": 6627.896, "learn_throughput": 603.51, "synch_weights_time_ms": 12.809}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "done": false, "training_iteration": 191, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-18", "timestamp": 1723233018, "time_this_iter_s": 7.426636219024658, "time_total_s": 1422.1895456314087, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ea160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1422.1895456314087, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 28.75454545454545, "ram_util_percent": 83.15454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7626666136085987, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995781761407851, "policy_loss": -0.008148954573456043, "vf_loss": 10.0, "vf_explained_var": -0.0019702713936567305, "kl": 0.0134343098703539, "entropy": 0.9145131795356671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8850190828874629, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000383635929653, "policy_loss": -0.001891817612001899, "vf_loss": 10.0, "vf_explained_var": 0.0005846101455587559, "kl": 0.007990561829258998, "entropy": 0.9823066672635457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": -195.88373985211717, "episode_reward_min": -13037.944046569934, "episode_reward_mean": -6959.648770824648, "episode_len_mean": 192.55, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19255, "policy_reward_min": {"agent_policy": 33.32198273472819, "adversary_policy": -13037.944046569934}, "policy_reward_max": {"agent_policy": 12001.567332143342, "adversary_policy": -33.32198273472819}, "policy_reward_mean": {"agent_policy": 4645.843378633673, "adversary_policy": -5802.746074729162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4336.655415615691, -10360.438720275644, -6147.947845671709, -6293.1441435683655, -7580.192302245608, -7514.890104468504, -6070.312326731971, -5875.203594114236, -5768.880645692033, -4536.058283064036, -8696.637418256887, -5601.174130969952, -8208.854837062689, -5183.60844074313, -3929.611648594206, -2691.5291636391535, -4634.520723828916, -9389.180518909228, -8152.23353760514, -1608.5063868739676, -9506.12256189114, -4157.483602144149, -4218.975891157421, -6916.752123889143, -5772.608204810391, -5744.890566597764, -9702.98922097032, -10216.635811780552, -7381.479355449459, -10257.750973944001, -4519.4138788065, -4445.851171699512, -3773.8406780028545, -6953.565732147743, -10522.852427659385, -10017.458002972879, -9326.192539218493, -6315.277797913957, -6756.972322725543, -9999.77844444025, -5859.372990618038, -5617.46525145459, -5029.066416346682, -7485.537702959051, -5203.261348517833, -10789.256468710708, -5892.614050947962, -605.0821524669589, -3090.9499704391183, -12415.154973260707, -11764.046539029947, -9077.117747852562, -3713.883254324778, -5526.77944835488, -4898.46351856452, -10405.874532426491, -9848.160995034728, -6751.1138879794335, -9963.467007153635, -7149.205854191506, -9268.525037939153, -6542.320239308322, -3530.8070407446926, -8042.697947364104, -6054.275165123807, -9715.766629370019, -9828.2759629723, -9727.360799440296, -6123.461971552264, -13037.944046569934, -4202.2356661321755, -7943.623231418134, -5048.812404378034, -5010.6040476723465, -5255.9165918249355, -7438.915607292628, -195.88373985211717, -5799.31716427887, -5269.428080774756, -7813.793968489696, -7505.321126543602, -7260.61428716689, -4400.835829155201, -4962.7848678950095, -6166.097445752496, -3296.5198083019195, -9003.290665884399, -12603.9663682034, -5782.4729881013245, -2954.4948528841132, -8090.247112033363, -10573.087002322962, -11136.038372297995, -8468.915501040876, -6883.562703637136, -11242.542673548063, -4495.512569099416, -7004.266974207209, -8418.60158509394, -9693.39340001024], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 144, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 105, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3563.346076655559, 4881.110207102305, 3730.2328660379253, 5487.603671172541, 5208.389977443061, 4678.469469802255, 5333.375754980834, 4412.388173814819, 3607.838550818471, 2755.6495235209572, 4521.9172038349725, 4744.270239562614, 7290.500820355594, 3335.566812732805, 3143.5228907091255, 1649.5061098313295, 2631.948374303103, 2032.0987869434318, 6298.319455668593, 338.4092428967367, 7982.939682571359, 2270.8536979679247, 3125.909072790812, 4184.134171099187, 3402.504459161476, 3411.8791919620166, 9457.689752789465, 3785.0681744121935, 4504.426372968029, 8836.589703324249, 4108.612368105974, 911.0577866501895, 1725.4098471911525, 3002.9496481578826, 8451.828326075129, 9662.569564284106, 4284.29785092502, 2431.158293203887, 4807.180500320687, 6147.149324523328, 2564.0685253582615, 4600.759840913462, 1408.2467204868026, 5816.238826240194, 2956.85691766465, 6857.438829196158, 2665.9071843734505, 33.32198273472819, 1191.0367868962862, 11643.50721765244, 9848.57695719354, 7527.424775381322, 2393.9788732283782, 4262.255060787199, 1560.125939522632, 4448.31156009299, 4158.758528585825, 4864.125325013384, 2864.8161786531846, 5102.804116559656, 7252.09267717158, 5057.0710763717, 2806.249485920894, 2753.552891348674, 4948.166754326324, 9181.166594843771, 3757.80865467112, 5924.912465514277, 3589.070711102946, 6004.912322948634, 2216.326536910943, 6776.439299137876, 3431.602616638163, 4046.221423063741, 4130.647015926818, 4917.708163107693, 57.15272442717164, 3267.345325756271, 2652.5148111753642, 3580.4004505430394, 3757.7308555381364, 5895.658899928943, 2893.737992769764, 3765.0904429953644, 5679.722722829867, 2937.6992481255215, 7485.351247311379, 12001.567332143342, 4925.631460694282, 1991.8464712976888, 2161.771960362895, 8704.888383272997, 7861.229257330792, 7669.277896988225, 6016.029093280066, 7689.57066004878, 3011.217720357163, 4758.585792845714, 7879.999281894521, 8239.136999239137], "policy_adversary_policy_reward": [-3844.666579404498, -4055.33491286675, -10360.438720275644, -4881.110207102305, -3730.2328660379253, -6147.947845671709, -5635.690983051202, -6145.056831689704, -5208.389977443061, -7580.192302245608, -4871.249656813998, -7322.10991745676, -5333.375754980834, -6070.312326731971, -4803.574320838415, -5484.017447090639, -5763.011353937568, -3613.707842572936, -3894.3157362948655, -3397.3920702901232, -8696.637418256889, -4521.9172038349725, -4787.653249060143, -5557.791121472424, -8098.756452694491, -7400.599204723795, -3338.060827617241, -5181.114425858694, -3377.4971345791123, -3695.63740472422, -1817.9615520854113, -2523.0737213850725, -2885.058910392118, -4381.4101877398925, -9389.180518909228, -2032.0987869434318, -8152.233537605139, -6298.319455668593, -338.4092428967367, -1608.5063868739676, -7982.939682571359, -9506.12256189114, -4126.025488037632, -2302.3118120744407, -3992.632006205685, -3352.2529577425526, -6916.752123889142, -4184.134171099187, -3402.504459161476, -5772.608204810391, -5733.504734620102, -3423.2650239396776, -9487.436882756865, -9673.24209100292, -10216.63581178055, -3785.0681744121935, -4504.426372968029, -7381.479355449459, -9502.227889498468, -9592.112787769793, -4358.584435959795, -4269.441810952681, -911.0577866501895, -4445.851171699512, -3773.8406780028545, -1725.4098471911525, -3002.9496481578826, -6953.565732147742, -8451.828326075129, -10522.852427659385, -10016.946317018605, -9663.081250238378, -9326.192539218495, -4284.29785092502, -6315.277797913957, -2431.158293203887, -6445.623650351012, -5118.529172695222, -6147.149324523328, -9999.77844444025, -2564.0685253582615, -5859.372990618038, -5261.399568274696, -4956.825524093362, -2820.544058484926, -3616.769078348549, -7461.602246029122, -5840.1742831701185, -2956.85691766465, -5203.261348517833, -10789.256468710708, -6857.438829196158, -2758.680240685672, -5799.8409946357415, -33.32198273472819, -605.0821524669589, -3090.9499704391183, -1191.0367868962862, -11968.721589502104, -12089.940601411048, -9880.460743393776, -11732.16275282971, -9077.117747852562, -7527.424775381322, -3111.9416484145668, -2995.9204791385855, -4312.665799238599, -5476.368709903482, -4898.463518564519, -1560.125939522632, -4448.31156009299, -10405.874532426491, -4158.758528585825, -9848.160995034728, -4879.576386557252, -6735.662826435566, -9963.467007153637, -2864.8161786531846, -5102.804116559656, -7149.205854191505, -9268.525037939153, -7252.09267717158, -5986.877268944054, -5612.514046735965, -2816.357887708024, -3520.69863895756, -8042.697947364105, -2753.552891348674, -4948.166754326324, -6054.275165123807, -9621.589724182742, -9275.34350003105, -9828.2759629723, -3757.80865467112, -9727.360799440297, -5924.912465514277, -6123.461971552264, -3589.070711102946, -6004.912322948634, -13037.944046569934, -2216.326536910943, -4202.2356661321755, -7905.611971776265, -6814.450558779747, -5048.812404378034, -3431.602616638163, -5008.767585026498, -4048.0578857095893, -5255.572471282427, -4130.991136469328, -7438.915607292627, -4917.708163107693, -57.15272442717164, -195.88373985211717, -3283.781121248936, -5782.881368786205, -5269.4280807747555, -2652.5148111753642, -3580.4004505430394, -7813.793968489696, -7505.321126543603, -3757.7308555381364, -6820.478838993663, -6335.794348102179, -2893.737992769764, -4400.835829155201, -3775.299601719476, -4952.575709170894, -6128.487783902351, -5717.332384680012, -3053.4502397533556, -3180.7688166740845, -8716.115786422664, -7772.526126773109, -12592.897380484923, -12012.63631986182, -5149.088997321821, -5559.015451473794, -2587.1943485138454, -2359.1469756679576, -8090.247112033363, -2161.771960362895, -8704.888383272997, -10573.087002322962, -7861.229257330792, -11136.038372297995, -7867.868169442535, -8270.325228586564, -6130.145157996095, -6769.446638921104, -11242.542673548065, -7689.57066004878, -3011.3221343811347, -4495.408155075448, -7004.266974207209, -4758.585792845714, -8376.033462845717, -7922.567404142744, -9683.888703385423, -8248.641695863957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956920153930449, "mean_inference_ms": 0.9642025810000807, "mean_action_processing_ms": 0.166315728197225, "mean_env_wait_ms": 0.05096423122498368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005638480186462402, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06621038913726807}, "num_episodes": 20, "episode_return_max": -195.88373985211717, "episode_return_min": -13037.944046569934, "episode_return_mean": -6959.648770824648}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.4470208096986, "num_env_steps_trained_throughput_per_sec": 537.4470208096986, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 7412.407, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7412.369, "sample_time_ms": 782.944, "learn_time_ms": 6616.137, "learn_throughput": 604.582, "synch_weights_time_ms": 12.789}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 192, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-25", "timestamp": 1723233025, "time_this_iter_s": 7.446977615356445, "time_total_s": 1429.6365232467651, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327a98550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1429.6365232467651, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 28.009090909090904, "ram_util_percent": 82.93636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6708714529871941, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992381599545478, "policy_loss": -0.0038010401020680245, "vf_loss": 9.992701636751493, "vf_explained_var": -0.005555133459468683, "kl": 0.011897284379422975, "entropy": 0.8610905616854628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8617169099194663, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.989212242509954, "policy_loss": -0.004708496738402616, "vf_loss": 9.991133206483548, "vf_explained_var": 0.0002192521852160257, "kl": 0.009788884155738054, "entropy": 0.9435114783269388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "env_runners": {"episode_reward_max": -109.80325898604397, "episode_reward_min": -13037.944046569934, "episode_reward_mean": -7015.344955725829, "episode_len_mean": 189.18, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18918, "policy_reward_min": {"agent_policy": 10.893922173514111, "adversary_policy": -13037.944046569934}, "policy_reward_max": {"agent_policy": 12001.567332143342, "adversary_policy": -10.893922173514111}, "policy_reward_mean": {"agent_policy": 4709.413765884158, "adversary_policy": -5862.379360804993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6916.752123889143, -5772.608204810391, -5744.890566597764, -9702.98922097032, -10216.635811780552, -7381.479355449459, -10257.750973944001, -4519.4138788065, -4445.851171699512, -3773.8406780028545, -6953.565732147743, -10522.852427659385, -10017.458002972879, -9326.192539218493, -6315.277797913957, -6756.972322725543, -9999.77844444025, -5859.372990618038, -5617.46525145459, -5029.066416346682, -7485.537702959051, -5203.261348517833, -10789.256468710708, -5892.614050947962, -605.0821524669589, -3090.9499704391183, -12415.154973260707, -11764.046539029947, -9077.117747852562, -3713.883254324778, -5526.77944835488, -4898.46351856452, -10405.874532426491, -9848.160995034728, -6751.1138879794335, -9963.467007153635, -7149.205854191506, -9268.525037939153, -6542.320239308322, -3530.8070407446926, -8042.697947364104, -6054.275165123807, -9715.766629370019, -9828.2759629723, -9727.360799440296, -6123.461971552264, -13037.944046569934, -4202.2356661321755, -7943.623231418134, -5048.812404378034, -5010.6040476723465, -5255.9165918249355, -7438.915607292628, -195.88373985211717, -5799.31716427887, -5269.428080774756, -7813.793968489696, -7505.321126543602, -7260.61428716689, -4400.835829155201, -4962.7848678950095, -6166.097445752496, -3296.5198083019195, -9003.290665884399, -12603.9663682034, -5782.4729881013245, -2954.4948528841132, -8090.247112033363, -10573.087002322962, -11136.038372297995, -8468.915501040876, -6883.562703637136, -11242.542673548063, -4495.512569099416, -7004.266974207209, -8418.60158509394, -9693.39340001024, -9432.788921338357, -4123.1834371606255, -9732.651367611394, -5687.9129074985885, -10633.61748871006, -9557.014581151903, -5235.520453985624, -4439.384276735246, -10277.83006202353, -8200.680268943705, -8419.49949680898, -5339.9233786008845, -5522.959476082508, -7849.849696172586, -296.09364354906546, -109.80325898604397, -3136.6554104201196, -6403.152609879033, -10074.78074880922, -6756.772262335286, -608.4882263479482, -8406.02182695919, -5787.196933131889], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 105, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 7, 200, 200, 200, 200, 44, 200, 200], "policy_agent_policy_reward": [4184.134171099187, 3402.504459161476, 3411.8791919620166, 9457.689752789465, 3785.0681744121935, 4504.426372968029, 8836.589703324249, 4108.612368105974, 911.0577866501895, 1725.4098471911525, 3002.9496481578826, 8451.828326075129, 9662.569564284106, 4284.29785092502, 2431.158293203887, 4807.180500320687, 6147.149324523328, 2564.0685253582615, 4600.759840913462, 1408.2467204868026, 5816.238826240194, 2956.85691766465, 6857.438829196158, 2665.9071843734505, 33.32198273472819, 1191.0367868962862, 11643.50721765244, 9848.57695719354, 7527.424775381322, 2393.9788732283782, 4262.255060787199, 1560.125939522632, 4448.31156009299, 4158.758528585825, 4864.125325013384, 2864.8161786531846, 5102.804116559656, 7252.09267717158, 5057.0710763717, 2806.249485920894, 2753.552891348674, 4948.166754326324, 9181.166594843771, 3757.80865467112, 5924.912465514277, 3589.070711102946, 6004.912322948634, 2216.326536910943, 6776.439299137876, 3431.602616638163, 4046.221423063741, 4130.647015926818, 4917.708163107693, 57.15272442717164, 3267.345325756271, 2652.5148111753642, 3580.4004505430394, 3757.7308555381364, 5895.658899928943, 2893.737992769764, 3765.0904429953644, 5679.722722829867, 2937.6992481255215, 7485.351247311379, 12001.567332143342, 4925.631460694282, 1991.8464712976888, 2161.771960362895, 8704.888383272997, 7861.229257330792, 7669.277896988225, 6016.029093280066, 7689.57066004878, 3011.217720357163, 4758.585792845714, 7879.999281894521, 8239.136999239137, 5037.552404319991, 3239.1609659609317, 2945.912028299328, 3229.300539237989, 6903.41145726324, 7023.947831077397, 3446.684959038476, 3488.5353689317103, 9752.159104059418, 4701.6653482166175, 8066.351434244029, 3811.5069402604113, 3638.6713596332665, 4106.8801718263, 13.795756877992469, 10.893922173514111, 2282.430598028857, 5624.12985882376, 6242.453991566324, 5635.203059776915, 343.5634278214758, 5159.170508027638, 4677.824351100015], "policy_adversary_policy_reward": [-6916.752123889142, -4184.134171099187, -3402.504459161476, -5772.608204810391, -5733.504734620102, -3423.2650239396776, -9487.436882756865, -9673.24209100292, -10216.63581178055, -3785.0681744121935, -4504.426372968029, -7381.479355449459, -9502.227889498468, -9592.112787769793, -4358.584435959795, -4269.441810952681, -911.0577866501895, -4445.851171699512, -3773.8406780028545, -1725.4098471911525, -3002.9496481578826, -6953.565732147742, -8451.828326075129, -10522.852427659385, -10016.946317018605, -9663.081250238378, -9326.192539218495, -4284.29785092502, -6315.277797913957, -2431.158293203887, -6445.623650351012, -5118.529172695222, -6147.149324523328, -9999.77844444025, -2564.0685253582615, -5859.372990618038, -5261.399568274696, -4956.825524093362, -2820.544058484926, -3616.769078348549, -7461.602246029122, -5840.1742831701185, -2956.85691766465, -5203.261348517833, -10789.256468710708, -6857.438829196158, -2758.680240685672, -5799.8409946357415, -33.32198273472819, -605.0821524669589, -3090.9499704391183, -1191.0367868962862, -11968.721589502104, -12089.940601411048, -9880.460743393776, -11732.16275282971, -9077.117747852562, -7527.424775381322, -3111.9416484145668, -2995.9204791385855, -4312.665799238599, -5476.368709903482, -4898.463518564519, -1560.125939522632, -4448.31156009299, -10405.874532426491, -4158.758528585825, -9848.160995034728, -4879.576386557252, -6735.662826435566, -9963.467007153637, -2864.8161786531846, -5102.804116559656, -7149.205854191505, -9268.525037939153, -7252.09267717158, -5986.877268944054, -5612.514046735965, -2816.357887708024, -3520.69863895756, -8042.697947364105, -2753.552891348674, -4948.166754326324, -6054.275165123807, -9621.589724182742, -9275.34350003105, -9828.2759629723, -3757.80865467112, -9727.360799440297, -5924.912465514277, -6123.461971552264, -3589.070711102946, -6004.912322948634, -13037.944046569934, -2216.326536910943, -4202.2356661321755, -7905.611971776265, -6814.450558779747, -5048.812404378034, -3431.602616638163, -5008.767585026498, -4048.0578857095893, -5255.572471282427, -4130.991136469328, -7438.915607292627, -4917.708163107693, -57.15272442717164, -195.88373985211717, -3283.781121248936, -5782.881368786205, -5269.4280807747555, -2652.5148111753642, -3580.4004505430394, -7813.793968489696, -7505.321126543603, -3757.7308555381364, -6820.478838993663, -6335.794348102179, -2893.737992769764, -4400.835829155201, -3775.299601719476, -4952.575709170894, -6128.487783902351, -5717.332384680012, -3053.4502397533556, -3180.7688166740845, -8716.115786422664, -7772.526126773109, -12592.897380484923, -12012.63631986182, -5149.088997321821, -5559.015451473794, -2587.1943485138454, -2359.1469756679576, -8090.247112033363, -2161.771960362895, -8704.888383272997, -10573.087002322962, -7861.229257330792, -11136.038372297995, -7867.868169442535, -8270.325228586564, -6130.145157996095, -6769.446638921104, -11242.542673548065, -7689.57066004878, -3011.3221343811347, -4495.408155075448, -7004.266974207209, -4758.585792845714, -8376.033462845717, -7922.567404142744, -9683.888703385423, -8248.641695863957, -5037.552404319991, -9432.788921338357, -4091.181310963057, -3271.163092158499, -2945.912028299328, -9732.651367611394, -3229.300539237989, -5687.9129074985885, -6903.41145726324, -10633.617488710064, -9557.014581151905, -7023.947831077397, -3446.684959038476, -5235.520453985624, -4237.082591779543, -3690.8370538874105, -9986.665344550014, -10043.323821532926, -4701.6653482166175, -8200.680268943705, -8346.554603518834, -8139.296327534176, -3811.5069402604113, -5339.923378600885, -4589.253072051085, -4572.377763664687, -4106.8801718263, -7849.849696172586, -296.09364354906546, -13.795756877992469, -10.893922173514111, -109.80325898604397, -3092.7727230695255, -2326.3132853794514, -5736.769309452294, -6290.5131592504995, -6242.453991566324, -10074.78074880922, -6749.647800293697, -5642.327521818503, -601.0135894767354, -351.03806469268847, -5159.170508027638, -8406.02182695919, -5520.860100570791, -4944.1611836611155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956952228354986, "mean_inference_ms": 0.9635570616100475, "mean_action_processing_ms": 0.16632422266772842, "mean_env_wait_ms": 0.050998370175199266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005718350410461426, "StateBufferConnector_ms": 0.00261843204498291, "ViewRequirementAgentConnector_ms": 0.06748616695404053}, "num_episodes": 23, "episode_return_max": -109.80325898604397, "episode_return_min": -13037.944046569934, "episode_return_mean": -7015.344955725829}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.2216282288975, "num_env_steps_trained_throughput_per_sec": 532.2216282288975, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 2316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2316000, "timers": {"training_iteration_time_ms": 7426.129, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7426.091, "sample_time_ms": 791.375, "learn_time_ms": 6621.87, "learn_throughput": 604.059, "synch_weights_time_ms": 12.35}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "done": false, "training_iteration": 193, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-33", "timestamp": 1723233033, "time_this_iter_s": 7.520669937133789, "time_total_s": 1437.157193183899, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31ea4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1437.157193183899, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 27.027272727272727, "ram_util_percent": 82.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7609034479130059, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998739657799403, "policy_loss": -0.0027739849387823294, "vf_loss": 9.995734040935835, "vf_explained_var": -0.006860197770098845, "kl": 0.01975323027484895, "entropy": 0.9583701935286323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8502797862445867, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997376609479309, "policy_loss": -0.0020428231739926905, "vf_loss": 9.997025058383034, "vf_explained_var": 0.00017367352253545528, "kl": 0.008408145094043994, "entropy": 0.9490314949441839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": -109.80325898604397, "episode_reward_min": -13037.944046569934, "episode_reward_mean": -6777.286152371442, "episode_len_mean": 188.06, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18806, "policy_reward_min": {"agent_policy": 10.893922173514111, "adversary_policy": -13037.944046569934}, "policy_reward_max": {"agent_policy": 12001.567332143342, "adversary_policy": -10.893922173514111}, "policy_reward_mean": {"agent_policy": 4545.074642909648, "adversary_policy": -5661.180397640546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7485.537702959051, -5203.261348517833, -10789.256468710708, -5892.614050947962, -605.0821524669589, -3090.9499704391183, -12415.154973260707, -11764.046539029947, -9077.117747852562, -3713.883254324778, -5526.77944835488, -4898.46351856452, -10405.874532426491, -9848.160995034728, -6751.1138879794335, -9963.467007153635, -7149.205854191506, -9268.525037939153, -6542.320239308322, -3530.8070407446926, -8042.697947364104, -6054.275165123807, -9715.766629370019, -9828.2759629723, -9727.360799440296, -6123.461971552264, -13037.944046569934, -4202.2356661321755, -7943.623231418134, -5048.812404378034, -5010.6040476723465, -5255.9165918249355, -7438.915607292628, -195.88373985211717, -5799.31716427887, -5269.428080774756, -7813.793968489696, -7505.321126543602, -7260.61428716689, -4400.835829155201, -4962.7848678950095, -6166.097445752496, -3296.5198083019195, -9003.290665884399, -12603.9663682034, -5782.4729881013245, -2954.4948528841132, -8090.247112033363, -10573.087002322962, -11136.038372297995, -8468.915501040876, -6883.562703637136, -11242.542673548063, -4495.512569099416, -7004.266974207209, -8418.60158509394, -9693.39340001024, -9432.788921338357, -4123.1834371606255, -9732.651367611394, -5687.9129074985885, -10633.61748871006, -9557.014581151903, -5235.520453985624, -4439.384276735246, -10277.83006202353, -8200.680268943705, -8419.49949680898, -5339.9233786008845, -5522.959476082508, -7849.849696172586, -296.09364354906546, -109.80325898604397, -3136.6554104201196, -6403.152609879033, -10074.78074880922, -6756.772262335286, -608.4882263479482, -8406.02182695919, -5787.196933131889, -5460.153816544653, -5150.228262786806, -5470.228697436454, -7392.5371566754775, -7487.466500667516, -830.1499303822976, -4363.185169129658, -6734.731377855433, -10188.96923816577, -6459.487053381248, -7268.536299969566, -6103.187256235932, -7165.048717782758, -5077.222493003384, -8223.612252812916, -6881.86994140356, -7315.538933594037, -3265.4630969839636, -5813.030937180061, -4673.686444017994], "episode_lengths": [200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 122, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 7, 200, 200, 200, 200, 44, 200, 200, 200, 200, 130, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5816.238826240194, 2956.85691766465, 6857.438829196158, 2665.9071843734505, 33.32198273472819, 1191.0367868962862, 11643.50721765244, 9848.57695719354, 7527.424775381322, 2393.9788732283782, 4262.255060787199, 1560.125939522632, 4448.31156009299, 4158.758528585825, 4864.125325013384, 2864.8161786531846, 5102.804116559656, 7252.09267717158, 5057.0710763717, 2806.249485920894, 2753.552891348674, 4948.166754326324, 9181.166594843771, 3757.80865467112, 5924.912465514277, 3589.070711102946, 6004.912322948634, 2216.326536910943, 6776.439299137876, 3431.602616638163, 4046.221423063741, 4130.647015926818, 4917.708163107693, 57.15272442717164, 3267.345325756271, 2652.5148111753642, 3580.4004505430394, 3757.7308555381364, 5895.658899928943, 2893.737992769764, 3765.0904429953644, 5679.722722829867, 2937.6992481255215, 7485.351247311379, 12001.567332143342, 4925.631460694282, 1991.8464712976888, 2161.771960362895, 8704.888383272997, 7861.229257330792, 7669.277896988225, 6016.029093280066, 7689.57066004878, 3011.217720357163, 4758.585792845714, 7879.999281894521, 8239.136999239137, 5037.552404319991, 3239.1609659609317, 2945.912028299328, 3229.300539237989, 6903.41145726324, 7023.947831077397, 3446.684959038476, 3488.5353689317103, 9752.159104059418, 4701.6653482166175, 8066.351434244029, 3811.5069402604113, 3638.6713596332665, 4106.8801718263, 13.795756877992469, 10.893922173514111, 2282.430598028857, 5624.12985882376, 6242.453991566324, 5635.203059776915, 343.5634278214758, 5159.170508027638, 4677.824351100015, 4020.809090439185, 4157.562507052967, 1852.6829113382892, 6407.981443982242, 6612.5888163499785, 525.5773461692185, 1918.2718787594956, 4187.325173592538, 5847.371387293404, 6345.9188972648435, 4200.137182388959, 3662.398466226319, 2949.2878599626097, 2657.0587127644476, 3524.8552260129077, 2875.665980679744, 4836.3986674815405, 2616.4703481551633, 3122.9885690975084, 2932.317659450158], "policy_adversary_policy_reward": [-7461.602246029122, -5840.1742831701185, -2956.85691766465, -5203.261348517833, -10789.256468710708, -6857.438829196158, -2758.680240685672, -5799.8409946357415, -33.32198273472819, -605.0821524669589, -3090.9499704391183, -1191.0367868962862, -11968.721589502104, -12089.940601411048, -9880.460743393776, -11732.16275282971, -9077.117747852562, -7527.424775381322, -3111.9416484145668, -2995.9204791385855, -4312.665799238599, -5476.368709903482, -4898.463518564519, -1560.125939522632, -4448.31156009299, -10405.874532426491, -4158.758528585825, -9848.160995034728, -4879.576386557252, -6735.662826435566, -9963.467007153637, -2864.8161786531846, -5102.804116559656, -7149.205854191505, -9268.525037939153, -7252.09267717158, -5986.877268944054, -5612.514046735965, -2816.357887708024, -3520.69863895756, -8042.697947364105, -2753.552891348674, -4948.166754326324, -6054.275165123807, -9621.589724182742, -9275.34350003105, -9828.2759629723, -3757.80865467112, -9727.360799440297, -5924.912465514277, -6123.461971552264, -3589.070711102946, -6004.912322948634, -13037.944046569934, -2216.326536910943, -4202.2356661321755, -7905.611971776265, -6814.450558779747, -5048.812404378034, -3431.602616638163, -5008.767585026498, -4048.0578857095893, -5255.572471282427, -4130.991136469328, -7438.915607292627, -4917.708163107693, -57.15272442717164, -195.88373985211717, -3283.781121248936, -5782.881368786205, -5269.4280807747555, -2652.5148111753642, -3580.4004505430394, -7813.793968489696, -7505.321126543603, -3757.7308555381364, -6820.478838993663, -6335.794348102179, -2893.737992769764, -4400.835829155201, -3775.299601719476, -4952.575709170894, -6128.487783902351, -5717.332384680012, -3053.4502397533556, -3180.7688166740845, -8716.115786422664, -7772.526126773109, -12592.897380484923, -12012.63631986182, -5149.088997321821, -5559.015451473794, -2587.1943485138454, -2359.1469756679576, -8090.247112033363, -2161.771960362895, -8704.888383272997, -10573.087002322962, -7861.229257330792, -11136.038372297995, -7867.868169442535, -8270.325228586564, -6130.145157996095, -6769.446638921104, -11242.542673548065, -7689.57066004878, -3011.3221343811347, -4495.408155075448, -7004.266974207209, -4758.585792845714, -8376.033462845717, -7922.567404142744, -9683.888703385423, -8248.641695863957, -5037.552404319991, -9432.788921338357, -4091.181310963057, -3271.163092158499, -2945.912028299328, -9732.651367611394, -3229.300539237989, -5687.9129074985885, -6903.41145726324, -10633.617488710064, -9557.014581151905, -7023.947831077397, -3446.684959038476, -5235.520453985624, -4237.082591779543, -3690.8370538874105, -9986.665344550014, -10043.323821532926, -4701.6653482166175, -8200.680268943705, -8346.554603518834, -8139.296327534176, -3811.5069402604113, -5339.923378600885, -4589.253072051085, -4572.377763664687, -4106.8801718263, -7849.849696172586, -296.09364354906546, -13.795756877992469, -10.893922173514111, -109.80325898604397, -3092.7727230695255, -2326.3132853794514, -5736.769309452294, -6290.5131592504995, -6242.453991566324, -10074.78074880922, -6749.647800293697, -5642.327521818503, -601.0135894767354, -351.03806469268847, -5159.170508027638, -8406.02182695919, -5520.860100570791, -4944.1611836611155, -5388.506151375947, -4092.4567556078778, -5034.353118123558, -4273.437651716217, -5470.228697436454, -1852.6829113382892, -7392.5371566754775, -6407.981443982242, -7212.2502691276995, -6887.805047889797, -683.2559442770693, -672.4713322744459, -3040.02783992395, -3241.429207965199, -6235.885362900823, -4686.171188547163, -5855.314050808426, -10181.026574650748, -6361.1794907803815, -6444.22645986571, -4541.712970491501, -6926.960511867025, -6103.187256235932, -3662.398466226319, -7165.048717782755, -2949.2878599626097, -2689.2293042396755, -5045.051901528155, -8223.612252812916, -3524.8552260129077, -6881.869941403559, -2875.665980679744, -4836.3986674815405, -7315.538933594032, -2699.760365460069, -3182.1730796790553, -5813.030937180061, -3122.9885690975084, -4245.080882714921, -3360.9232207532386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957574053669192, "mean_inference_ms": 0.9635223218926311, "mean_action_processing_ms": 0.16625002850186724, "mean_env_wait_ms": 0.050991326339167885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005637168884277344, "StateBufferConnector_ms": 0.0025697946548461914, "ViewRequirementAgentConnector_ms": 0.06535482406616211}, "num_episodes": 20, "episode_return_max": -109.80325898604397, "episode_return_min": -13037.944046569934, "episode_return_mean": -6777.286152371442}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.399899511279, "num_env_steps_trained_throughput_per_sec": 558.399899511279, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 7414.805, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7414.767, "sample_time_ms": 789.188, "learn_time_ms": 6612.416, "learn_throughput": 604.923, "synch_weights_time_ms": 12.599}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 194, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-40", "timestamp": 1723233040, "time_this_iter_s": 7.167617082595825, "time_total_s": 1444.3248102664948, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31eaaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1444.3248102664948, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 25.36, "ram_util_percent": 82.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7120838132376472, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998937158783276, "policy_loss": -0.0051616817926211905, "vf_loss": 10.0, "vf_explained_var": -0.007575962568322817, "kl": 0.014008888481960942, "entropy": 0.9039634032174945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8476356690838224, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99911101659139, "policy_loss": -0.002436382421809766, "vf_loss": 10.0, "vf_explained_var": 3.768886838640485e-05, "kl": 0.0054339252493625124, "entropy": 0.9238023855698803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "env_runners": {"episode_reward_max": -109.80325898604397, "episode_reward_min": -13037.944046569934, "episode_reward_mean": -6830.39407479331, "episode_len_mean": 190.71, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19071, "policy_reward_min": {"agent_policy": 10.893922173514111, "adversary_policy": -13037.944046569934}, "policy_reward_max": {"agent_policy": 12001.567332143342, "adversary_policy": -10.893922173514111}, "policy_reward_mean": {"agent_policy": 4810.916130149316, "adversary_policy": -5820.6551024713135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6054.275165123807, -9715.766629370019, -9828.2759629723, -9727.360799440296, -6123.461971552264, -13037.944046569934, -4202.2356661321755, -7943.623231418134, -5048.812404378034, -5010.6040476723465, -5255.9165918249355, -7438.915607292628, -195.88373985211717, -5799.31716427887, -5269.428080774756, -7813.793968489696, -7505.321126543602, -7260.61428716689, -4400.835829155201, -4962.7848678950095, -6166.097445752496, -3296.5198083019195, -9003.290665884399, -12603.9663682034, -5782.4729881013245, -2954.4948528841132, -8090.247112033363, -10573.087002322962, -11136.038372297995, -8468.915501040876, -6883.562703637136, -11242.542673548063, -4495.512569099416, -7004.266974207209, -8418.60158509394, -9693.39340001024, -9432.788921338357, -4123.1834371606255, -9732.651367611394, -5687.9129074985885, -10633.61748871006, -9557.014581151903, -5235.520453985624, -4439.384276735246, -10277.83006202353, -8200.680268943705, -8419.49949680898, -5339.9233786008845, -5522.959476082508, -7849.849696172586, -296.09364354906546, -109.80325898604397, -3136.6554104201196, -6403.152609879033, -10074.78074880922, -6756.772262335286, -608.4882263479482, -8406.02182695919, -5787.196933131889, -5460.153816544653, -5150.228262786806, -5470.228697436454, -7392.5371566754775, -7487.466500667516, -830.1499303822976, -4363.185169129658, -6734.731377855433, -10188.96923816577, -6459.487053381248, -7268.536299969566, -6103.187256235932, -7165.048717782758, -5077.222493003384, -8223.612252812916, -6881.86994140356, -7315.538933594037, -3265.4630969839636, -5813.030937180061, -4673.686444017994, -7061.994447957147, -8780.270142441634, -11059.994340063393, -6837.801403316619, -5225.8479587826405, -11401.631115751723, -6562.90969714432, -6089.337506485263, -4183.5097082101165, -12519.056772890077, -7135.550099159183, -7520.369659027155, -7430.908458889906, -5137.194693999264, -6720.443779161696, -9750.396263814519, -9437.572862400662, -6001.034929647429, -6562.616595226657, -5952.467641263328, -5904.203884124986], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 7, 200, 200, 200, 200, 44, 200, 200, 200, 200, 130, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4948.166754326324, 9181.166594843771, 3757.80865467112, 5924.912465514277, 3589.070711102946, 6004.912322948634, 2216.326536910943, 6776.439299137876, 3431.602616638163, 4046.221423063741, 4130.647015926818, 4917.708163107693, 57.15272442717164, 3267.345325756271, 2652.5148111753642, 3580.4004505430394, 3757.7308555381364, 5895.658899928943, 2893.737992769764, 3765.0904429953644, 5679.722722829867, 2937.6992481255215, 7485.351247311379, 12001.567332143342, 4925.631460694282, 1991.8464712976888, 2161.771960362895, 8704.888383272997, 7861.229257330792, 7669.277896988225, 6016.029093280066, 7689.57066004878, 3011.217720357163, 4758.585792845714, 7879.999281894521, 8239.136999239137, 5037.552404319991, 3239.1609659609317, 2945.912028299328, 3229.300539237989, 6903.41145726324, 7023.947831077397, 3446.684959038476, 3488.5353689317103, 9752.159104059418, 4701.6653482166175, 8066.351434244029, 3811.5069402604113, 3638.6713596332665, 4106.8801718263, 13.795756877992469, 10.893922173514111, 2282.430598028857, 5624.12985882376, 6242.453991566324, 5635.203059776915, 343.5634278214758, 5159.170508027638, 4677.824351100015, 4020.809090439185, 4157.562507052967, 1852.6829113382892, 6407.981443982242, 6612.5888163499785, 525.5773461692185, 1918.2718787594956, 4187.325173592538, 5847.371387293404, 6345.9188972648435, 4200.137182388959, 3662.398466226319, 2949.2878599626097, 2657.0587127644476, 3524.8552260129077, 2875.665980679744, 4836.3986674815405, 2616.4703481551633, 3122.9885690975084, 2932.317659450158, 5955.531005890663, 3733.0463244866683, 9173.025502675257, 5500.873187009724, 3174.1929453772864, 10366.889276237622, 5607.302558741302, 4310.001418652562, 2006.3836677691995, 10280.63835019801, 5668.943827149225, 6064.8211827296645, 5601.382330643212, 4783.81615966359, 5913.63456090881, 7269.708620438958, 7615.918644239229, 5011.785098860637, 5225.735334835623, 5274.183347661942, 4110.786570386598], "policy_adversary_policy_reward": [-4948.166754326324, -6054.275165123807, -9621.589724182742, -9275.34350003105, -9828.2759629723, -3757.80865467112, -9727.360799440297, -5924.912465514277, -6123.461971552264, -3589.070711102946, -6004.912322948634, -13037.944046569934, -2216.326536910943, -4202.2356661321755, -7905.611971776265, -6814.450558779747, -5048.812404378034, -3431.602616638163, -5008.767585026498, -4048.0578857095893, -5255.572471282427, -4130.991136469328, -7438.915607292627, -4917.708163107693, -57.15272442717164, -195.88373985211717, -3283.781121248936, -5782.881368786205, -5269.4280807747555, -2652.5148111753642, -3580.4004505430394, -7813.793968489696, -7505.321126543603, -3757.7308555381364, -6820.478838993663, -6335.794348102179, -2893.737992769764, -4400.835829155201, -3775.299601719476, -4952.575709170894, -6128.487783902351, -5717.332384680012, -3053.4502397533556, -3180.7688166740845, -8716.115786422664, -7772.526126773109, -12592.897380484923, -12012.63631986182, -5149.088997321821, -5559.015451473794, -2587.1943485138454, -2359.1469756679576, -8090.247112033363, -2161.771960362895, -8704.888383272997, -10573.087002322962, -7861.229257330792, -11136.038372297995, -7867.868169442535, -8270.325228586564, -6130.145157996095, -6769.446638921104, -11242.542673548065, -7689.57066004878, -3011.3221343811347, -4495.408155075448, -7004.266974207209, -4758.585792845714, -8376.033462845717, -7922.567404142744, -9683.888703385423, -8248.641695863957, -5037.552404319991, -9432.788921338357, -4091.181310963057, -3271.163092158499, -2945.912028299328, -9732.651367611394, -3229.300539237989, -5687.9129074985885, -6903.41145726324, -10633.617488710064, -9557.014581151905, -7023.947831077397, -3446.684959038476, -5235.520453985624, -4237.082591779543, -3690.8370538874105, -9986.665344550014, -10043.323821532926, -4701.6653482166175, -8200.680268943705, -8346.554603518834, -8139.296327534176, -3811.5069402604113, -5339.923378600885, -4589.253072051085, -4572.377763664687, -4106.8801718263, -7849.849696172586, -296.09364354906546, -13.795756877992469, -10.893922173514111, -109.80325898604397, -3092.7727230695255, -2326.3132853794514, -5736.769309452294, -6290.5131592504995, -6242.453991566324, -10074.78074880922, -6749.647800293697, -5642.327521818503, -601.0135894767354, -351.03806469268847, -5159.170508027638, -8406.02182695919, -5520.860100570791, -4944.1611836611155, -5388.506151375947, -4092.4567556078778, -5034.353118123558, -4273.437651716217, -5470.228697436454, -1852.6829113382892, -7392.5371566754775, -6407.981443982242, -7212.2502691276995, -6887.805047889797, -683.2559442770693, -672.4713322744459, -3040.02783992395, -3241.429207965199, -6235.885362900823, -4686.171188547163, -5855.314050808426, -10181.026574650748, -6361.1794907803815, -6444.22645986571, -4541.712970491501, -6926.960511867025, -6103.187256235932, -3662.398466226319, -7165.048717782755, -2949.2878599626097, -2689.2293042396755, -5045.051901528155, -8223.612252812916, -3524.8552260129077, -6881.869941403559, -2875.665980679744, -4836.3986674815405, -7315.538933594032, -2699.760365460069, -3182.1730796790553, -5813.030937180061, -3122.9885690975084, -4245.080882714921, -3360.9232207532386, -6148.5706014433445, -6868.95485240447, -3733.0463244866683, -8780.270142441634, -11059.994340063393, -9173.025502675257, -6837.801403316618, -5500.873187009724, -3232.6655676361493, -5167.375336523781, -10367.222546779461, -11401.297845209883, -6349.340227445228, -5820.872028440394, -4310.001418652562, -6089.337506485263, -2501.094163973634, -3688.7992120056856, -12519.056772890077, -10280.63835019801, -5668.943827149225, -7135.550099159183, -6064.8211827296645, -7520.369659027155, -7430.908458889906, -5601.382330643212, -4951.571465425371, -4969.439388237484, -6212.846054641884, -6421.232285428623, -9731.044074272848, -7289.060809980629, -9437.572862400659, -7615.918644239229, -5827.059229208319, -5185.760799299746, -6562.616595226658, -5225.735334835623, -5474.240554489787, -5752.410434435481, -4754.467915468745, -5260.522539042835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957408192801941, "mean_inference_ms": 0.9635570647208462, "mean_action_processing_ms": 0.16630982401057726, "mean_env_wait_ms": 0.05100238115237607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407597541809082, "StateBufferConnector_ms": 0.0023959875106811523, "ViewRequirementAgentConnector_ms": 0.06425297260284424}, "num_episodes": 21, "episode_return_max": -109.80325898604397, "episode_return_min": -13037.944046569934, "episode_return_mean": -6830.39407479331}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 568.909761568265, "num_env_steps_trained_throughput_per_sec": 568.909761568265, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 2340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2340000, "timers": {"training_iteration_time_ms": 7382.309, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7382.271, "sample_time_ms": 780.991, "learn_time_ms": 6588.312, "learn_throughput": 607.136, "synch_weights_time_ms": 12.435}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "done": false, "training_iteration": 195, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-47", "timestamp": 1723233047, "time_this_iter_s": 7.0356361865997314, "time_total_s": 1451.3604464530945, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b31eae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1451.3604464530945, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 22.136363636363633, "ram_util_percent": 82.44545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6259025028751543, "cur_kl_coeff": 0.2925888965345521, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004960011442503, "policy_loss": -0.0006822724792679461, "vf_loss": 9.998031717538833, "vf_explained_var": -0.011962011083960533, "kl": 0.02601110631561217, "entropy": 0.9544043514877558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8048805750393994, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997185672780194, "policy_loss": -0.002875290002190956, "vf_loss": 9.998511242740369, "vf_explained_var": 7.21010581526176e-05, "kl": 0.0054421097184309646, "entropy": 0.9053446389379955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": -109.80325898604397, "episode_reward_min": -12603.9663682034, "episode_reward_mean": -6831.327411452749, "episode_len_mean": 192.52, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19252, "policy_reward_min": {"agent_policy": 10.893922173514111, "adversary_policy": -12592.897380484923}, "policy_reward_max": {"agent_policy": 12001.567332143342, "adversary_policy": -10.893922173514111}, "policy_reward_mean": {"agent_policy": 4849.035539512271, "adversary_policy": -5840.18147548251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3296.5198083019195, -9003.290665884399, -12603.9663682034, -5782.4729881013245, -2954.4948528841132, -8090.247112033363, -10573.087002322962, -11136.038372297995, -8468.915501040876, -6883.562703637136, -11242.542673548063, -4495.512569099416, -7004.266974207209, -8418.60158509394, -9693.39340001024, -9432.788921338357, -4123.1834371606255, -9732.651367611394, -5687.9129074985885, -10633.61748871006, -9557.014581151903, -5235.520453985624, -4439.384276735246, -10277.83006202353, -8200.680268943705, -8419.49949680898, -5339.9233786008845, -5522.959476082508, -7849.849696172586, -296.09364354906546, -109.80325898604397, -3136.6554104201196, -6403.152609879033, -10074.78074880922, -6756.772262335286, -608.4882263479482, -8406.02182695919, -5787.196933131889, -5460.153816544653, -5150.228262786806, -5470.228697436454, -7392.5371566754775, -7487.466500667516, -830.1499303822976, -4363.185169129658, -6734.731377855433, -10188.96923816577, -6459.487053381248, -7268.536299969566, -6103.187256235932, -7165.048717782758, -5077.222493003384, -8223.612252812916, -6881.86994140356, -7315.538933594037, -3265.4630969839636, -5813.030937180061, -4673.686444017994, -7061.994447957147, -8780.270142441634, -11059.994340063393, -6837.801403316619, -5225.8479587826405, -11401.631115751723, -6562.90969714432, -6089.337506485263, -4183.5097082101165, -12519.056772890077, -7135.550099159183, -7520.369659027155, -7430.908458889906, -5137.194693999264, -6720.443779161696, -9750.396263814519, -9437.572862400662, -6001.034929647429, -6562.616595226657, -5952.467641263328, -5904.203884124986, -4222.506207847308, -5713.480032782698, -9087.425931716096, -7070.571425991507, -4607.171810753586, -7417.321610129658, -3161.6208135059956, -4023.3605247890646, -9952.339120641343, -4999.855306137341, -4969.150175035404, -8873.369035592399, -10012.65393446569, -8816.626585112801, -3493.217784866187, -3451.0729687719127, -12463.609182473134, -7290.429753499866, -9358.025752957288, -4432.780737701433, -5438.013604828747], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 7, 200, 200, 200, 200, 44, 200, 200, 200, 200, 130, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2937.6992481255215, 7485.351247311379, 12001.567332143342, 4925.631460694282, 1991.8464712976888, 2161.771960362895, 8704.888383272997, 7861.229257330792, 7669.277896988225, 6016.029093280066, 7689.57066004878, 3011.217720357163, 4758.585792845714, 7879.999281894521, 8239.136999239137, 5037.552404319991, 3239.1609659609317, 2945.912028299328, 3229.300539237989, 6903.41145726324, 7023.947831077397, 3446.684959038476, 3488.5353689317103, 9752.159104059418, 4701.6653482166175, 8066.351434244029, 3811.5069402604113, 3638.6713596332665, 4106.8801718263, 13.795756877992469, 10.893922173514111, 2282.430598028857, 5624.12985882376, 6242.453991566324, 5635.203059776915, 343.5634278214758, 5159.170508027638, 4677.824351100015, 4020.809090439185, 4157.562507052967, 1852.6829113382892, 6407.981443982242, 6612.5888163499785, 525.5773461692185, 1918.2718787594956, 4187.325173592538, 5847.371387293404, 6345.9188972648435, 4200.137182388959, 3662.398466226319, 2949.2878599626097, 2657.0587127644476, 3524.8552260129077, 2875.665980679744, 4836.3986674815405, 2616.4703481551633, 3122.9885690975084, 2932.317659450158, 5955.531005890663, 3733.0463244866683, 9173.025502675257, 5500.873187009724, 3174.1929453772864, 10366.889276237622, 5607.302558741302, 4310.001418652562, 2006.3836677691995, 10280.63835019801, 5668.943827149225, 6064.8211827296645, 5601.382330643212, 4783.81615966359, 5913.63456090881, 7269.708620438958, 7615.918644239229, 5011.785098860637, 5225.735334835623, 5274.183347661942, 4110.786570386598, 3540.5829770750543, 4464.755493670212, 2791.719594256173, 3379.684142919594, 4179.028643569877, 3169.7169180405313, 2735.3771546065445, 3257.889576502043, 6384.7476129485385, 4063.217064644066, 3247.758223285171, 6396.155513559371, 9141.975684015253, 8323.230380554482, 2107.4530314478257, 2829.9200105576588, 8505.730325705095, 3239.3881631244008, 4408.791842179132, 3222.17210869766, 4896.983259092982], "policy_adversary_policy_reward": [-3053.4502397533556, -3180.7688166740845, -8716.115786422664, -7772.526126773109, -12592.897380484923, -12012.63631986182, -5149.088997321821, -5559.015451473794, -2587.1943485138454, -2359.1469756679576, -8090.247112033363, -2161.771960362895, -8704.888383272997, -10573.087002322962, -7861.229257330792, -11136.038372297995, -7867.868169442535, -8270.325228586564, -6130.145157996095, -6769.446638921104, -11242.542673548065, -7689.57066004878, -3011.3221343811347, -4495.408155075448, -7004.266974207209, -4758.585792845714, -8376.033462845717, -7922.567404142744, -9683.888703385423, -8248.641695863957, -5037.552404319991, -9432.788921338357, -4091.181310963057, -3271.163092158499, -2945.912028299328, -9732.651367611394, -3229.300539237989, -5687.9129074985885, -6903.41145726324, -10633.617488710064, -9557.014581151905, -7023.947831077397, -3446.684959038476, -5235.520453985624, -4237.082591779543, -3690.8370538874105, -9986.665344550014, -10043.323821532926, -4701.6653482166175, -8200.680268943705, -8346.554603518834, -8139.296327534176, -3811.5069402604113, -5339.923378600885, -4589.253072051085, -4572.377763664687, -4106.8801718263, -7849.849696172586, -296.09364354906546, -13.795756877992469, -10.893922173514111, -109.80325898604397, -3092.7727230695255, -2326.3132853794514, -5736.769309452294, -6290.5131592504995, -6242.453991566324, -10074.78074880922, -6749.647800293697, -5642.327521818503, -601.0135894767354, -351.03806469268847, -5159.170508027638, -8406.02182695919, -5520.860100570791, -4944.1611836611155, -5388.506151375947, -4092.4567556078778, -5034.353118123558, -4273.437651716217, -5470.228697436454, -1852.6829113382892, -7392.5371566754775, -6407.981443982242, -7212.2502691276995, -6887.805047889797, -683.2559442770693, -672.4713322744459, -3040.02783992395, -3241.429207965199, -6235.885362900823, -4686.171188547163, -5855.314050808426, -10181.026574650748, -6361.1794907803815, -6444.22645986571, -4541.712970491501, -6926.960511867025, -6103.187256235932, -3662.398466226319, -7165.048717782755, -2949.2878599626097, -2689.2293042396755, -5045.051901528155, -8223.612252812916, -3524.8552260129077, -6881.869941403559, -2875.665980679744, -4836.3986674815405, -7315.538933594032, -2699.760365460069, -3182.1730796790553, -5813.030937180061, -3122.9885690975084, -4245.080882714921, -3360.9232207532386, -6148.5706014433445, -6868.95485240447, -3733.0463244866683, -8780.270142441634, -11059.994340063393, -9173.025502675257, -6837.801403316618, -5500.873187009724, -3232.6655676361493, -5167.375336523781, -10367.222546779461, -11401.297845209883, -6349.340227445228, -5820.872028440394, -4310.001418652562, -6089.337506485263, -2501.094163973634, -3688.7992120056856, -12519.056772890077, -10280.63835019801, -5668.943827149225, -7135.550099159183, -6064.8211827296645, -7520.369659027155, -7430.908458889906, -5601.382330643212, -4951.571465425371, -4969.439388237484, -6212.846054641884, -6421.232285428623, -9731.044074272848, -7289.060809980629, -9437.572862400659, -7615.918644239229, -5827.059229208319, -5185.760799299746, -6562.616595226658, -5225.735334835623, -5474.240554489787, -5752.410434435481, -4754.467915468745, -5260.522539042835, -3654.0886850873694, -4109.000499834994, -4469.501716512999, -5708.73380993991, -2791.719594256173, -9087.425931716096, -7070.571425991508, -3379.684142919594, -4470.7345515948755, -4315.46590272859, -7417.321610129658, -3169.7169180405313, -3159.9471370190267, -2737.050831093512, -3258.1149986072687, -4023.135102683839, -6384.7476129485385, -9952.339120641343, -4438.162712596647, -4624.909658184761, -3247.758223285171, -4969.150175035404, -8873.369035592399, -6396.155513559371, -10011.250613562832, -9143.379004918112, -8707.362356184069, -8432.494609483212, -2374.9979364070978, -3225.6728799069156, -2974.2776990906937, -3306.7152802388778, -12463.60918247313, -8505.730325705095, -7290.429753499868, -3239.3881631244008, -9358.025752957288, -4408.791842179132, -4095.4776223714684, -3559.4752240276275, -5062.711298832129, -5272.285565089599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39561906576080397, "mean_inference_ms": 0.9632106946998167, "mean_action_processing_ms": 0.16621307166272473, "mean_env_wait_ms": 0.05097789179374058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032143592834472656, "StateBufferConnector_ms": 0.00238037109375, "ViewRequirementAgentConnector_ms": 0.06476080417633057}, "num_episodes": 21, "episode_return_max": -109.80325898604397, "episode_return_min": -12603.9663682034, "episode_return_mean": -6831.327411452749}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 564.1110682970098, "num_env_steps_trained_throughput_per_sec": 564.1110682970098, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 7337.778, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7337.741, "sample_time_ms": 762.102, "learn_time_ms": 6563.085, "learn_throughput": 609.47, "synch_weights_time_ms": 12.024}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 196, "trial_id": "3439d_00000", "date": "2024-08-09_15-50-55", "timestamp": 1723233055, "time_this_iter_s": 7.095453977584839, "time_total_s": 1458.4559004306793, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32a3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1458.4559004306793, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 24.3, "ram_util_percent": 82.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7836886589570592, "cur_kl_coeff": 0.43888334480182833, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999689624706905, "policy_loss": -0.005090864723509488, "vf_loss": 9.99707625110944, "vf_explained_var": -0.004811643933256467, "kl": 0.017554118113669876, "entropy": 0.9778466960415244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8412882224434898, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995426057886194, "policy_loss": -0.005180310643839813, "vf_loss": 9.998375836125126, "vf_explained_var": -0.0001275267235185734, "kl": 0.007832860212068433, "entropy": 0.9174096272420631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "env_runners": {"episode_reward_max": -109.80325898604397, "episode_reward_min": -12519.056772890077, "episode_reward_mean": -6535.159358203419, "episode_len_mean": 189.29, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18929, "policy_reward_min": {"agent_policy": 10.893922173514111, "adversary_policy": -12519.056772890077}, "policy_reward_max": {"agent_policy": 10763.226580507764, "adversary_policy": -10.893922173514111}, "policy_reward_mean": {"agent_policy": 4648.821872097348, "adversary_policy": -5591.990615150384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9557.014581151903, -5235.520453985624, -4439.384276735246, -10277.83006202353, -8200.680268943705, -8419.49949680898, -5339.9233786008845, -5522.959476082508, -7849.849696172586, -296.09364354906546, -109.80325898604397, -3136.6554104201196, -6403.152609879033, -10074.78074880922, -6756.772262335286, -608.4882263479482, -8406.02182695919, -5787.196933131889, -5460.153816544653, -5150.228262786806, -5470.228697436454, -7392.5371566754775, -7487.466500667516, -830.1499303822976, -4363.185169129658, -6734.731377855433, -10188.96923816577, -6459.487053381248, -7268.536299969566, -6103.187256235932, -7165.048717782758, -5077.222493003384, -8223.612252812916, -6881.86994140356, -7315.538933594037, -3265.4630969839636, -5813.030937180061, -4673.686444017994, -7061.994447957147, -8780.270142441634, -11059.994340063393, -6837.801403316619, -5225.8479587826405, -11401.631115751723, -6562.90969714432, -6089.337506485263, -4183.5097082101165, -12519.056772890077, -7135.550099159183, -7520.369659027155, -7430.908458889906, -5137.194693999264, -6720.443779161696, -9750.396263814519, -9437.572862400662, -6001.034929647429, -6562.616595226657, -5952.467641263328, -5904.203884124986, -4222.506207847308, -5713.480032782698, -9087.425931716096, -7070.571425991507, -4607.171810753586, -7417.321610129658, -3161.6208135059956, -4023.3605247890646, -9952.339120641343, -4999.855306137341, -4969.150175035404, -8873.369035592399, -10012.65393446569, -8816.626585112801, -3493.217784866187, -3451.0729687719127, -12463.609182473134, -7290.429753499866, -9358.025752957288, -4432.780737701433, -5438.013604828747, -3791.6287739406707, -6527.757174080003, -6301.00680210913, -11641.01928322392, -9913.68494760859, -6012.66843030881, -7673.0582060190045, -313.5163328837309, -8567.15663179096, -7378.807270825509, -8189.781748922857, -6792.263616300186, -6132.997500217118, -9012.401894943756, -3174.72936299801, -6161.540531359684, -9077.197889002917, -1291.0775127789002, -5878.406645384886, -5809.560819353747], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 7, 200, 200, 200, 200, 44, 200, 200, 200, 200, 130, 200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 200], "policy_agent_policy_reward": [7023.947831077397, 3446.684959038476, 3488.5353689317103, 9752.159104059418, 4701.6653482166175, 8066.351434244029, 3811.5069402604113, 3638.6713596332665, 4106.8801718263, 13.795756877992469, 10.893922173514111, 2282.430598028857, 5624.12985882376, 6242.453991566324, 5635.203059776915, 343.5634278214758, 5159.170508027638, 4677.824351100015, 4020.809090439185, 4157.562507052967, 1852.6829113382892, 6407.981443982242, 6612.5888163499785, 525.5773461692185, 1918.2718787594956, 4187.325173592538, 5847.371387293404, 6345.9188972648435, 4200.137182388959, 3662.398466226319, 2949.2878599626097, 2657.0587127644476, 3524.8552260129077, 2875.665980679744, 4836.3986674815405, 2616.4703481551633, 3122.9885690975084, 2932.317659450158, 5955.531005890663, 3733.0463244866683, 9173.025502675257, 5500.873187009724, 3174.1929453772864, 10366.889276237622, 5607.302558741302, 4310.001418652562, 2006.3836677691995, 10280.63835019801, 5668.943827149225, 6064.8211827296645, 5601.382330643212, 4783.81615966359, 5913.63456090881, 7269.708620438958, 7615.918644239229, 5011.785098860637, 5225.735334835623, 5274.183347661942, 4110.786570386598, 3540.5829770750543, 4464.755493670212, 2791.719594256173, 3379.684142919594, 4179.028643569877, 3169.7169180405313, 2735.3771546065445, 3257.889576502043, 6384.7476129485385, 4063.217064644066, 3247.758223285171, 6396.155513559371, 9141.975684015253, 8323.230380554482, 2107.4530314478257, 2829.9200105576588, 8505.730325705095, 3239.3881631244008, 4408.791842179132, 3222.17210869766, 4896.983259092982, 2010.884410794504, 4881.435514625713, 5785.106312058551, 10763.226580507764, 4579.543800606571, 5084.66986435867, 4541.6800657950635, 28.31139517100639, 8038.123626754226, 5700.727955237371, 4703.507994982572, 3104.390139090301, 3631.995111141976, 6978.721801395832, 2976.9114872643277, 5479.956433007493, 8407.108980196583, 430.0414051844229, 3710.507606881292, 3830.922973727455], "policy_adversary_policy_reward": [-9557.014581151905, -7023.947831077397, -3446.684959038476, -5235.520453985624, -4237.082591779543, -3690.8370538874105, -9986.665344550014, -10043.323821532926, -4701.6653482166175, -8200.680268943705, -8346.554603518834, -8139.296327534176, -3811.5069402604113, -5339.923378600885, -4589.253072051085, -4572.377763664687, -4106.8801718263, -7849.849696172586, -296.09364354906546, -13.795756877992469, -10.893922173514111, -109.80325898604397, -3092.7727230695255, -2326.3132853794514, -5736.769309452294, -6290.5131592504995, -6242.453991566324, -10074.78074880922, -6749.647800293697, -5642.327521818503, -601.0135894767354, -351.03806469268847, -5159.170508027638, -8406.02182695919, -5520.860100570791, -4944.1611836611155, -5388.506151375947, -4092.4567556078778, -5034.353118123558, -4273.437651716217, -5470.228697436454, -1852.6829113382892, -7392.5371566754775, -6407.981443982242, -7212.2502691276995, -6887.805047889797, -683.2559442770693, -672.4713322744459, -3040.02783992395, -3241.429207965199, -6235.885362900823, -4686.171188547163, -5855.314050808426, -10181.026574650748, -6361.1794907803815, -6444.22645986571, -4541.712970491501, -6926.960511867025, -6103.187256235932, -3662.398466226319, -7165.048717782755, -2949.2878599626097, -2689.2293042396755, -5045.051901528155, -8223.612252812916, -3524.8552260129077, -6881.869941403559, -2875.665980679744, -4836.3986674815405, -7315.538933594032, -2699.760365460069, -3182.1730796790553, -5813.030937180061, -3122.9885690975084, -4245.080882714921, -3360.9232207532386, -6148.5706014433445, -6868.95485240447, -3733.0463244866683, -8780.270142441634, -11059.994340063393, -9173.025502675257, -6837.801403316618, -5500.873187009724, -3232.6655676361493, -5167.375336523781, -10367.222546779461, -11401.297845209883, -6349.340227445228, -5820.872028440394, -4310.001418652562, -6089.337506485263, -2501.094163973634, -3688.7992120056856, -12519.056772890077, -10280.63835019801, -5668.943827149225, -7135.550099159183, -6064.8211827296645, -7520.369659027155, -7430.908458889906, -5601.382330643212, -4951.571465425371, -4969.439388237484, -6212.846054641884, -6421.232285428623, -9731.044074272848, -7289.060809980629, -9437.572862400659, -7615.918644239229, -5827.059229208319, -5185.760799299746, -6562.616595226658, -5225.735334835623, -5474.240554489787, -5752.410434435481, -4754.467915468745, -5260.522539042835, -3654.0886850873694, -4109.000499834994, -4469.501716512999, -5708.73380993991, -2791.719594256173, -9087.425931716096, -7070.571425991508, -3379.684142919594, -4470.7345515948755, -4315.46590272859, -7417.321610129658, -3169.7169180405313, -3159.9471370190267, -2737.050831093512, -3258.1149986072687, -4023.135102683839, -6384.7476129485385, -9952.339120641343, -4438.162712596647, -4624.909658184761, -3247.758223285171, -4969.150175035404, -8873.369035592399, -6396.155513559371, -10011.250613562832, -9143.379004918112, -8707.362356184069, -8432.494609483212, -2374.9979364070978, -3225.6728799069156, -2974.2776990906937, -3306.7152802388778, -12463.60918247313, -8505.730325705095, -7290.429753499868, -3239.3881631244008, -9358.025752957288, -4408.791842179132, -4095.4776223714684, -3559.4752240276275, -5062.711298832129, -5272.285565089599, -3791.6287739406703, -2010.884410794504, -5202.305236853271, -6206.887451852447, -6088.717947344113, -5997.395166823574, -10763.226580507764, -11641.019283223923, -4579.543800606571, -9913.684947608592, -5453.564292659889, -5643.774002007591, -7673.0582060190045, -4541.6800657950635, -313.5163328837309, -28.31139517100639, -8562.653835849696, -8042.626422695489, -7378.687515862066, -5700.8477102008155, -4703.507994982572, -8189.781748922855, -6792.263616300186, -3104.390139090301, -3631.995111141976, -6132.997500217118, -9012.401894943754, -6978.721801395832, -3049.302125676761, -3102.338724585578, -6161.540531359684, -5479.956433007493, -9077.197889002917, -8407.108980196583, -430.0414051844229, -1291.0775127789002, -5870.365330465259, -3718.548921800919, -5778.3003486667885, -3862.1834444144138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39552827061727625, "mean_inference_ms": 0.962949567108141, "mean_action_processing_ms": 0.1662415595491894, "mean_env_wait_ms": 0.05098986287693798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031796693801879883, "StateBufferConnector_ms": 0.0023747682571411133, "ViewRequirementAgentConnector_ms": 0.06652259826660156}, "num_episodes": 20, "episode_return_max": -109.80325898604397, "episode_return_min": -12519.056772890077, "episode_return_mean": -6535.159358203419}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 568.3700338388736, "num_env_steps_trained_throughput_per_sec": 568.3700338388736, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 2364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2364000, "timers": {"training_iteration_time_ms": 7301.453, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7301.416, "sample_time_ms": 749.838, "learn_time_ms": 6539.219, "learn_throughput": 611.694, "synch_weights_time_ms": 11.83}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "done": false, "training_iteration": 197, "trial_id": "3439d_00000", "date": "2024-08-09_15-51-02", "timestamp": 1723233062, "time_this_iter_s": 7.04164981842041, "time_total_s": 1465.4975502490997, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b315aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1465.4975502490997, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 23.509999999999998, "ram_util_percent": 81.30999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8046687769082685, "cur_kl_coeff": 0.43888334480182833, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00379110078017, "policy_loss": -0.0032530171835484603, "vf_loss": 10.0, "vf_explained_var": -0.0051910335198044775, "kl": 0.016050081686504805, "entropy": 1.0686969462161262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8650400065398091, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000649151978669, "policy_loss": -0.0018338503776778462, "vf_loss": 10.0, "vf_explained_var": 0.00013247747269887772, "kl": 0.008719500496850482, "entropy": 0.9255080317378674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": -313.5163328837309, "episode_reward_min": -12645.621184578727, "episode_reward_mean": -6849.363645349208, "episode_len_mean": 195.4, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19540, "policy_reward_min": {"agent_policy": 28.31139517100639, "adversary_policy": -12645.621184578727}, "policy_reward_max": {"agent_policy": 10763.226580507764, "adversary_policy": -28.31139517100639}, "policy_reward_mean": {"agent_policy": 4921.1020383559035, "adversary_policy": -5885.232841852557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7392.5371566754775, -7487.466500667516, -830.1499303822976, -4363.185169129658, -6734.731377855433, -10188.96923816577, -6459.487053381248, -7268.536299969566, -6103.187256235932, -7165.048717782758, -5077.222493003384, -8223.612252812916, -6881.86994140356, -7315.538933594037, -3265.4630969839636, -5813.030937180061, -4673.686444017994, -7061.994447957147, -8780.270142441634, -11059.994340063393, -6837.801403316619, -5225.8479587826405, -11401.631115751723, -6562.90969714432, -6089.337506485263, -4183.5097082101165, -12519.056772890077, -7135.550099159183, -7520.369659027155, -7430.908458889906, -5137.194693999264, -6720.443779161696, -9750.396263814519, -9437.572862400662, -6001.034929647429, -6562.616595226657, -5952.467641263328, -5904.203884124986, -4222.506207847308, -5713.480032782698, -9087.425931716096, -7070.571425991507, -4607.171810753586, -7417.321610129658, -3161.6208135059956, -4023.3605247890646, -9952.339120641343, -4999.855306137341, -4969.150175035404, -8873.369035592399, -10012.65393446569, -8816.626585112801, -3493.217784866187, -3451.0729687719127, -12463.609182473134, -7290.429753499866, -9358.025752957288, -4432.780737701433, -5438.013604828747, -3791.6287739406707, -6527.757174080003, -6301.00680210913, -11641.01928322392, -9913.68494760859, -6012.66843030881, -7673.0582060190045, -313.5163328837309, -8567.15663179096, -7378.807270825509, -8189.781748922857, -6792.263616300186, -6132.997500217118, -9012.401894943756, -3174.72936299801, -6161.540531359684, -9077.197889002917, -1291.0775127789002, -5878.406645384886, -5809.560819353747, -9504.308758931327, -8116.660492795836, -4548.589648744745, -4931.599952351135, -9461.628117221755, -7046.882709258052, -6979.3830150980875, -9955.418652154667, -9575.0874276029, -7339.02950529948, -8353.046580604216, -9248.662838162847, -4424.848078968684, -6522.1893978866365, -5755.198628033566, -8294.862627577573, -6598.632974258395, -4215.108004173696, -5407.278550406616, -12645.621184578727, -4998.628958160795], "episode_lengths": [200, 200, 63, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6407.981443982242, 6612.5888163499785, 525.5773461692185, 1918.2718787594956, 4187.325173592538, 5847.371387293404, 6345.9188972648435, 4200.137182388959, 3662.398466226319, 2949.2878599626097, 2657.0587127644476, 3524.8552260129077, 2875.665980679744, 4836.3986674815405, 2616.4703481551633, 3122.9885690975084, 2932.317659450158, 5955.531005890663, 3733.0463244866683, 9173.025502675257, 5500.873187009724, 3174.1929453772864, 10366.889276237622, 5607.302558741302, 4310.001418652562, 2006.3836677691995, 10280.63835019801, 5668.943827149225, 6064.8211827296645, 5601.382330643212, 4783.81615966359, 5913.63456090881, 7269.708620438958, 7615.918644239229, 5011.785098860637, 5225.735334835623, 5274.183347661942, 4110.786570386598, 3540.5829770750543, 4464.755493670212, 2791.719594256173, 3379.684142919594, 4179.028643569877, 3169.7169180405313, 2735.3771546065445, 3257.889576502043, 6384.7476129485385, 4063.217064644066, 3247.758223285171, 6396.155513559371, 9141.975684015253, 8323.230380554482, 2107.4530314478257, 2829.9200105576588, 8505.730325705095, 3239.3881631244008, 4408.791842179132, 3222.17210869766, 4896.983259092982, 2010.884410794504, 4881.435514625713, 5785.106312058551, 10763.226580507764, 4579.543800606571, 5084.66986435867, 4541.6800657950635, 28.31139517100639, 8038.123626754226, 5700.727955237371, 4703.507994982572, 3104.390139090301, 3631.995111141976, 6978.721801395832, 2976.9114872643277, 5479.956433007493, 8407.108980196583, 430.0414051844229, 3710.507606881292, 3830.922973727455, 6392.812287616898, 7764.343339639575, 3044.951060104079, 3978.3181241810466, 8533.28490534856, 5766.323053783339, 6367.50772984954, 9710.535994095411, 4979.12832315278, 2527.137586857335, 6109.988061676798, 5745.50169307326, 3939.479261005363, 3536.911232954474, 4995.928084815354, 8098.051184501647, 4699.154103081705, 3628.24541846886, 3884.1579021708717, 7926.332907628632, 3656.84687216463], "policy_adversary_policy_reward": [-7392.5371566754775, -6407.981443982242, -7212.2502691276995, -6887.805047889797, -683.2559442770693, -672.4713322744459, -3040.02783992395, -3241.429207965199, -6235.885362900823, -4686.171188547163, -5855.314050808426, -10181.026574650748, -6361.1794907803815, -6444.22645986571, -4541.712970491501, -6926.960511867025, -6103.187256235932, -3662.398466226319, -7165.048717782755, -2949.2878599626097, -2689.2293042396755, -5045.051901528155, -8223.612252812916, -3524.8552260129077, -6881.869941403559, -2875.665980679744, -4836.3986674815405, -7315.538933594032, -2699.760365460069, -3182.1730796790553, -5813.030937180061, -3122.9885690975084, -4245.080882714921, -3360.9232207532386, -6148.5706014433445, -6868.95485240447, -3733.0463244866683, -8780.270142441634, -11059.994340063393, -9173.025502675257, -6837.801403316618, -5500.873187009724, -3232.6655676361493, -5167.375336523781, -10367.222546779461, -11401.297845209883, -6349.340227445228, -5820.872028440394, -4310.001418652562, -6089.337506485263, -2501.094163973634, -3688.7992120056856, -12519.056772890077, -10280.63835019801, -5668.943827149225, -7135.550099159183, -6064.8211827296645, -7520.369659027155, -7430.908458889906, -5601.382330643212, -4951.571465425371, -4969.439388237484, -6212.846054641884, -6421.232285428623, -9731.044074272848, -7289.060809980629, -9437.572862400659, -7615.918644239229, -5827.059229208319, -5185.760799299746, -6562.616595226658, -5225.735334835623, -5474.240554489787, -5752.410434435481, -4754.467915468745, -5260.522539042835, -3654.0886850873694, -4109.000499834994, -4469.501716512999, -5708.73380993991, -2791.719594256173, -9087.425931716096, -7070.571425991508, -3379.684142919594, -4470.7345515948755, -4315.46590272859, -7417.321610129658, -3169.7169180405313, -3159.9471370190267, -2737.050831093512, -3258.1149986072687, -4023.135102683839, -6384.7476129485385, -9952.339120641343, -4438.162712596647, -4624.909658184761, -3247.758223285171, -4969.150175035404, -8873.369035592399, -6396.155513559371, -10011.250613562832, -9143.379004918112, -8707.362356184069, -8432.494609483212, -2374.9979364070978, -3225.6728799069156, -2974.2776990906937, -3306.7152802388778, -12463.60918247313, -8505.730325705095, -7290.429753499868, -3239.3881631244008, -9358.025752957288, -4408.791842179132, -4095.4776223714684, -3559.4752240276275, -5062.711298832129, -5272.285565089599, -3791.6287739406703, -2010.884410794504, -5202.305236853271, -6206.887451852447, -6088.717947344113, -5997.395166823574, -10763.226580507764, -11641.019283223923, -4579.543800606571, -9913.684947608592, -5453.564292659889, -5643.774002007591, -7673.0582060190045, -4541.6800657950635, -313.5163328837309, -28.31139517100639, -8562.653835849696, -8042.626422695489, -7378.687515862066, -5700.8477102008155, -4703.507994982572, -8189.781748922855, -6792.263616300186, -3104.390139090301, -3631.995111141976, -6132.997500217118, -9012.401894943754, -6978.721801395832, -3049.302125676761, -3102.338724585578, -6161.540531359684, -5479.956433007493, -9077.197889002917, -8407.108980196583, -430.0414051844229, -1291.0775127789002, -5870.365330465259, -3718.548921800919, -5778.3003486667885, -3862.1834444144138, -9504.308758931325, -6392.812287616898, -8054.268464551383, -7826.73536788403, -3554.223716311692, -4039.316992537133, -4804.454432610046, -4105.463643922141, -8964.299019327369, -9030.61400324294, -6506.986164422038, -6306.21959861935, -6416.22732601942, -6930.663418928209, -9748.804227893048, -9917.150418357032, -9575.0874276029, -4979.12832315278, -7339.029505299478, -2527.137586857335, -6186.6612766638555, -8276.37336561715, -5745.50169307326, -9248.662838162847, -4423.9703279954265, -3940.3570119786204, -6522.189397886636, -3536.911232954474, -5421.460215308205, -5329.6664975407175, -8174.009908744048, -8218.903903335171, -6594.66168803242, -4703.125389307682, -3671.747844670176, -4171.605577972382, -4710.906680521081, -4580.529772056401, -7926.332907628632, -12645.621184578727, -4997.319573928061, -3658.1562563973644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3956326590327584, "mean_inference_ms": 0.962555200952213, "mean_action_processing_ms": 0.1661943379958588, "mean_env_wait_ms": 0.05098520531063389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003075242042541504, "StateBufferConnector_ms": 0.0023126602172851562, "ViewRequirementAgentConnector_ms": 0.06508374214172363}, "num_episodes": 21, "episode_return_max": -313.5163328837309, "episode_return_min": -12645.621184578727, "episode_return_mean": -6849.363645349208}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 566.6749497803162, "num_env_steps_trained_throughput_per_sec": 566.6749497803162, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 7274.008, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7273.971, "sample_time_ms": 751.883, "learn_time_ms": 6509.614, "learn_throughput": 614.476, "synch_weights_time_ms": 11.945}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 198, "trial_id": "3439d_00000", "date": "2024-08-09_15-51-09", "timestamp": 1723233069, "time_this_iter_s": 7.062941074371338, "time_total_s": 1472.560491323471, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3218e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1472.560491323471, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 22.263636363636365, "ram_util_percent": 81.14545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7498004590782027, "cur_kl_coeff": 0.43888334480182833, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003460241357486, "policy_loss": -0.003965614871898045, "vf_loss": 10.0, "vf_explained_var": -0.007619043812155724, "kl": 0.016919892329800252, "entropy": 1.0145222945759693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8019928206842413, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005412636105977, "policy_loss": 0.0014285305693558363, "vf_loss": 10.0, "vf_explained_var": -0.0001225058048490494, "kl": 0.013990824669353152, "entropy": 0.8829544501014488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "env_runners": {"episode_reward_max": -313.5163328837309, "episode_reward_min": -12645.621184578727, "episode_reward_mean": -7186.506237673579, "episode_len_mean": 196.77, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19677, "policy_reward_min": {"agent_policy": 28.31139517100639, "adversary_policy": -12645.621184578727}, "policy_reward_max": {"agent_policy": 10896.232702130692, "adversary_policy": -28.31139517100639}, "policy_reward_mean": {"agent_policy": 5341.386407784952, "adversary_policy": -6263.946322729266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6837.801403316619, -5225.8479587826405, -11401.631115751723, -6562.90969714432, -6089.337506485263, -4183.5097082101165, -12519.056772890077, -7135.550099159183, -7520.369659027155, -7430.908458889906, -5137.194693999264, -6720.443779161696, -9750.396263814519, -9437.572862400662, -6001.034929647429, -6562.616595226657, -5952.467641263328, -5904.203884124986, -4222.506207847308, -5713.480032782698, -9087.425931716096, -7070.571425991507, -4607.171810753586, -7417.321610129658, -3161.6208135059956, -4023.3605247890646, -9952.339120641343, -4999.855306137341, -4969.150175035404, -8873.369035592399, -10012.65393446569, -8816.626585112801, -3493.217784866187, -3451.0729687719127, -12463.609182473134, -7290.429753499866, -9358.025752957288, -4432.780737701433, -5438.013604828747, -3791.6287739406707, -6527.757174080003, -6301.00680210913, -11641.01928322392, -9913.68494760859, -6012.66843030881, -7673.0582060190045, -313.5163328837309, -8567.15663179096, -7378.807270825509, -8189.781748922857, -6792.263616300186, -6132.997500217118, -9012.401894943756, -3174.72936299801, -6161.540531359684, -9077.197889002917, -1291.0775127789002, -5878.406645384886, -5809.560819353747, -9504.308758931327, -8116.660492795836, -4548.589648744745, -4931.599952351135, -9461.628117221755, -7046.882709258052, -6979.3830150980875, -9955.418652154667, -9575.0874276029, -7339.02950529948, -8353.046580604216, -9248.662838162847, -4424.848078968684, -6522.1893978866365, -5755.198628033566, -8294.862627577573, -6598.632974258395, -4215.108004173696, -5407.278550406616, -12645.621184578727, -4998.628958160795, -10092.293192268507, -11765.57245623371, -12538.411529277946, -7877.526472781466, -9148.329673027047, -9721.519607073134, -6122.371436358394, -5888.923328169638, -8248.3849448294, -9041.804703681226, -6741.381166315485, -8034.44725053708, -10226.496389682896, -6975.247890670071, -5146.149453022777, -9223.926380816749, -4232.883689591898, -6928.125883016769, -11874.798330391919, -6031.647184394717], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5500.873187009724, 3174.1929453772864, 10366.889276237622, 5607.302558741302, 4310.001418652562, 2006.3836677691995, 10280.63835019801, 5668.943827149225, 6064.8211827296645, 5601.382330643212, 4783.81615966359, 5913.63456090881, 7269.708620438958, 7615.918644239229, 5011.785098860637, 5225.735334835623, 5274.183347661942, 4110.786570386598, 3540.5829770750543, 4464.755493670212, 2791.719594256173, 3379.684142919594, 4179.028643569877, 3169.7169180405313, 2735.3771546065445, 3257.889576502043, 6384.7476129485385, 4063.217064644066, 3247.758223285171, 6396.155513559371, 9141.975684015253, 8323.230380554482, 2107.4530314478257, 2829.9200105576588, 8505.730325705095, 3239.3881631244008, 4408.791842179132, 3222.17210869766, 4896.983259092982, 2010.884410794504, 4881.435514625713, 5785.106312058551, 10763.226580507764, 4579.543800606571, 5084.66986435867, 4541.6800657950635, 28.31139517100639, 8038.123626754226, 5700.727955237371, 4703.507994982572, 3104.390139090301, 3631.995111141976, 6978.721801395832, 2976.9114872643277, 5479.956433007493, 8407.108980196583, 430.0414051844229, 3710.507606881292, 3830.922973727455, 6392.812287616898, 7764.343339639575, 3044.951060104079, 3978.3181241810466, 8533.28490534856, 5766.323053783339, 6367.50772984954, 9710.535994095411, 4979.12832315278, 2527.137586857335, 6109.988061676798, 5745.50169307326, 3939.479261005363, 3536.911232954474, 4995.928084815354, 8098.051184501647, 4699.154103081705, 3628.24541846886, 3884.1579021708717, 7926.332907628632, 3656.84687216463, 8091.948981343333, 7407.537092797062, 9735.762186589878, 5206.447325111134, 8116.766478105787, 6915.304637387361, 3231.3207609879905, 3151.698518104558, 6664.420992594197, 7969.56290389465, 6028.729545384012, 5397.18746727436, 8738.341494466129, 4253.6327002348535, 4250.165494404594, 7305.315454083256, 3342.836656128486, 4673.027229918324, 10896.232702130692, 4736.414770647838], "policy_adversary_policy_reward": [-6837.801403316618, -5500.873187009724, -3232.6655676361493, -5167.375336523781, -10367.222546779461, -11401.297845209883, -6349.340227445228, -5820.872028440394, -4310.001418652562, -6089.337506485263, -2501.094163973634, -3688.7992120056856, -12519.056772890077, -10280.63835019801, -5668.943827149225, -7135.550099159183, -6064.8211827296645, -7520.369659027155, -7430.908458889906, -5601.382330643212, -4951.571465425371, -4969.439388237484, -6212.846054641884, -6421.232285428623, -9731.044074272848, -7289.060809980629, -9437.572862400659, -7615.918644239229, -5827.059229208319, -5185.760799299746, -6562.616595226658, -5225.735334835623, -5474.240554489787, -5752.410434435481, -4754.467915468745, -5260.522539042835, -3654.0886850873694, -4109.000499834994, -4469.501716512999, -5708.73380993991, -2791.719594256173, -9087.425931716096, -7070.571425991508, -3379.684142919594, -4470.7345515948755, -4315.46590272859, -7417.321610129658, -3169.7169180405313, -3159.9471370190267, -2737.050831093512, -3258.1149986072687, -4023.135102683839, -6384.7476129485385, -9952.339120641343, -4438.162712596647, -4624.909658184761, -3247.758223285171, -4969.150175035404, -8873.369035592399, -6396.155513559371, -10011.250613562832, -9143.379004918112, -8707.362356184069, -8432.494609483212, -2374.9979364070978, -3225.6728799069156, -2974.2776990906937, -3306.7152802388778, -12463.60918247313, -8505.730325705095, -7290.429753499868, -3239.3881631244008, -9358.025752957288, -4408.791842179132, -4095.4776223714684, -3559.4752240276275, -5062.711298832129, -5272.285565089599, -3791.6287739406703, -2010.884410794504, -5202.305236853271, -6206.887451852447, -6088.717947344113, -5997.395166823574, -10763.226580507764, -11641.019283223923, -4579.543800606571, -9913.684947608592, -5453.564292659889, -5643.774002007591, -7673.0582060190045, -4541.6800657950635, -313.5163328837309, -28.31139517100639, -8562.653835849696, -8042.626422695489, -7378.687515862066, -5700.8477102008155, -4703.507994982572, -8189.781748922855, -6792.263616300186, -3104.390139090301, -3631.995111141976, -6132.997500217118, -9012.401894943754, -6978.721801395832, -3049.302125676761, -3102.338724585578, -6161.540531359684, -5479.956433007493, -9077.197889002917, -8407.108980196583, -430.0414051844229, -1291.0775127789002, -5870.365330465259, -3718.548921800919, -5778.3003486667885, -3862.1834444144138, -9504.308758931325, -6392.812287616898, -8054.268464551383, -7826.73536788403, -3554.223716311692, -4039.316992537133, -4804.454432610046, -4105.463643922141, -8964.299019327369, -9030.61400324294, -6506.986164422038, -6306.21959861935, -6416.22732601942, -6930.663418928209, -9748.804227893048, -9917.150418357032, -9575.0874276029, -4979.12832315278, -7339.029505299478, -2527.137586857335, -6186.6612766638555, -8276.37336561715, -5745.50169307326, -9248.662838162847, -4423.9703279954265, -3940.3570119786204, -6522.189397886636, -3536.911232954474, -5421.460215308205, -5329.6664975407175, -8174.009908744048, -8218.903903335171, -6594.66168803242, -4703.125389307682, -3671.747844670176, -4171.605577972382, -4710.906680521081, -4580.529772056401, -7926.332907628632, -12645.621184578727, -4997.319573928061, -3658.1562563973644, -8264.498623516414, -9919.743550095425, -7407.537092797062, -11765.572456233709, -9735.762186589878, -12538.411529277946, -5206.447325111134, -7877.526472781466, -8832.87914514277, -8432.217005990064, -6915.304637387361, -9721.519607073134, -6122.371436358393, -3231.3207609879905, -3312.4191404121375, -5728.202705862059, -8248.384944829399, -6664.420992594197, -9041.804703681226, -7969.56290389465, -6679.946468629291, -6090.164243070205, -5397.18746727436, -8034.44725053708, -8738.341494466129, -10226.496389682894, -6327.59822476262, -4901.282366142314, -4634.690191445135, -4761.624755982242, -7374.558937663197, -9154.682897236824, -3671.860486198671, -3903.859859521712, -6920.775015898211, -4680.3780970368825, -11006.754040686028, -11764.276991836585, -6031.458615476825, -4736.603339565733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39551614232159066, "mean_inference_ms": 0.9624621669763951, "mean_action_processing_ms": 0.1661541185193775, "mean_env_wait_ms": 0.05097660987029358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030106306076049805, "StateBufferConnector_ms": 0.0023087263107299805, "ViewRequirementAgentConnector_ms": 0.0651543140411377}, "num_episodes": 20, "episode_return_max": -313.5163328837309, "episode_return_min": -12645.621184578727, "episode_return_mean": -7186.506237673579}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 561.3934961040087, "num_env_steps_trained_throughput_per_sec": 561.3934961040087, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 2388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2388000, "timers": {"training_iteration_time_ms": 7233.354, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7233.318, "sample_time_ms": 741.181, "learn_time_ms": 6479.509, "learn_throughput": 617.331, "synch_weights_time_ms": 12.1}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "done": false, "training_iteration": 199, "trial_id": "3439d_00000", "date": "2024-08-09_15-51-17", "timestamp": 1723233077, "time_this_iter_s": 7.130542755126953, "time_total_s": 1479.691034078598, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32ae9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1479.691034078598, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 24.65, "ram_util_percent": 81.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7654810762343307, "cur_kl_coeff": 0.43888334480182833, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000193289915721, "policy_loss": -0.006364340098904601, "vf_loss": 10.0, "vf_explained_var": -0.01004243219892184, "kl": 0.01494156513363123, "entropy": 1.0180918430288632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8210740625858307, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999735737856103, "policy_loss": -0.0029651888393644223, "vf_loss": 10.0, "vf_explained_var": 0.00028270902457060637, "kl": 0.009484717373307498, "entropy": 0.8137548470938647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": -313.5163328837309, "episode_reward_min": -12645.621184578727, "episode_reward_mean": -7397.905880294693, "episode_len_mean": 196.77, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19677, "policy_reward_min": {"agent_policy": 28.31139517100639, "adversary_policy": -12645.621184578727}, "policy_reward_max": {"agent_policy": 10896.232702130692, "adversary_policy": -28.31139517100639}, "policy_reward_mean": {"agent_policy": 5491.27861615041, "adversary_policy": -6444.592248222552}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9087.425931716096, -7070.571425991507, -4607.171810753586, -7417.321610129658, -3161.6208135059956, -4023.3605247890646, -9952.339120641343, -4999.855306137341, -4969.150175035404, -8873.369035592399, -10012.65393446569, -8816.626585112801, -3493.217784866187, -3451.0729687719127, -12463.609182473134, -7290.429753499866, -9358.025752957288, -4432.780737701433, -5438.013604828747, -3791.6287739406707, -6527.757174080003, -6301.00680210913, -11641.01928322392, -9913.68494760859, -6012.66843030881, -7673.0582060190045, -313.5163328837309, -8567.15663179096, -7378.807270825509, -8189.781748922857, -6792.263616300186, -6132.997500217118, -9012.401894943756, -3174.72936299801, -6161.540531359684, -9077.197889002917, -1291.0775127789002, -5878.406645384886, -5809.560819353747, -9504.308758931327, -8116.660492795836, -4548.589648744745, -4931.599952351135, -9461.628117221755, -7046.882709258052, -6979.3830150980875, -9955.418652154667, -9575.0874276029, -7339.02950529948, -8353.046580604216, -9248.662838162847, -4424.848078968684, -6522.1893978866365, -5755.198628033566, -8294.862627577573, -6598.632974258395, -4215.108004173696, -5407.278550406616, -12645.621184578727, -4998.628958160795, -10092.293192268507, -11765.57245623371, -12538.411529277946, -7877.526472781466, -9148.329673027047, -9721.519607073134, -6122.371436358394, -5888.923328169638, -8248.3849448294, -9041.804703681226, -6741.381166315485, -8034.44725053708, -10226.496389682896, -6975.247890670071, -5146.149453022777, -9223.926380816749, -4232.883689591898, -6928.125883016769, -11874.798330391919, -6031.647184394717, -6074.939493138816, -10247.801476703713, -12089.228100992099, -8871.92877074694, -7846.0299486685435, -8664.017948735198, -5391.678762897228, -6057.068496829579, -10027.264749986083, -7828.853431540731, -6754.950761452407, -5859.95240481922, -5192.766286331947, -8952.430116814485, -4858.275594572329, -11447.27181915275, -6248.799094661999, -10815.759759728218, -9640.29843380292, -8579.488080461688], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 64, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2791.719594256173, 3379.684142919594, 4179.028643569877, 3169.7169180405313, 2735.3771546065445, 3257.889576502043, 6384.7476129485385, 4063.217064644066, 3247.758223285171, 6396.155513559371, 9141.975684015253, 8323.230380554482, 2107.4530314478257, 2829.9200105576588, 8505.730325705095, 3239.3881631244008, 4408.791842179132, 3222.17210869766, 4896.983259092982, 2010.884410794504, 4881.435514625713, 5785.106312058551, 10763.226580507764, 4579.543800606571, 5084.66986435867, 4541.6800657950635, 28.31139517100639, 8038.123626754226, 5700.727955237371, 4703.507994982572, 3104.390139090301, 3631.995111141976, 6978.721801395832, 2976.9114872643277, 5479.956433007493, 8407.108980196583, 430.0414051844229, 3710.507606881292, 3830.922973727455, 6392.812287616898, 7764.343339639575, 3044.951060104079, 3978.3181241810466, 8533.28490534856, 5766.323053783339, 6367.50772984954, 9710.535994095411, 4979.12832315278, 2527.137586857335, 6109.988061676798, 5745.50169307326, 3939.479261005363, 3536.911232954474, 4995.928084815354, 8098.051184501647, 4699.154103081705, 3628.24541846886, 3884.1579021708717, 7926.332907628632, 3656.84687216463, 8091.948981343333, 7407.537092797062, 9735.762186589878, 5206.447325111134, 8116.766478105787, 6915.304637387361, 3231.3207609879905, 3151.698518104558, 6664.420992594197, 7969.56290389465, 6028.729545384012, 5397.18746727436, 8738.341494466129, 4253.6327002348535, 4250.165494404594, 7305.315454083256, 3342.836656128486, 4673.027229918324, 10896.232702130692, 4736.414770647838, 4362.686557229106, 9101.8125758725, 9853.738051601153, 8293.833003464188, 5436.810785790175, 8155.152190048497, 4625.616122979601, 3260.6062526615356, 6906.9731049217735, 4697.356472664749, 4342.173107691549, 4628.070582644103, 3953.010019829118, 8101.1366811599155, 4176.0329156153575, 9065.70256778756, 3711.2840833082555, 9663.116322665577, 9326.665079232676, 5119.779911626924], "policy_adversary_policy_reward": [-2791.719594256173, -9087.425931716096, -7070.571425991508, -3379.684142919594, -4470.7345515948755, -4315.46590272859, -7417.321610129658, -3169.7169180405313, -3159.9471370190267, -2737.050831093512, -3258.1149986072687, -4023.135102683839, -6384.7476129485385, -9952.339120641343, -4438.162712596647, -4624.909658184761, -3247.758223285171, -4969.150175035404, -8873.369035592399, -6396.155513559371, -10011.250613562832, -9143.379004918112, -8707.362356184069, -8432.494609483212, -2374.9979364070978, -3225.6728799069156, -2974.2776990906937, -3306.7152802388778, -12463.60918247313, -8505.730325705095, -7290.429753499868, -3239.3881631244008, -9358.025752957288, -4408.791842179132, -4095.4776223714684, -3559.4752240276275, -5062.711298832129, -5272.285565089599, -3791.6287739406703, -2010.884410794504, -5202.305236853271, -6206.887451852447, -6088.717947344113, -5997.395166823574, -10763.226580507764, -11641.019283223923, -4579.543800606571, -9913.684947608592, -5453.564292659889, -5643.774002007591, -7673.0582060190045, -4541.6800657950635, -313.5163328837309, -28.31139517100639, -8562.653835849696, -8042.626422695489, -7378.687515862066, -5700.8477102008155, -4703.507994982572, -8189.781748922855, -6792.263616300186, -3104.390139090301, -3631.995111141976, -6132.997500217118, -9012.401894943754, -6978.721801395832, -3049.302125676761, -3102.338724585578, -6161.540531359684, -5479.956433007493, -9077.197889002917, -8407.108980196583, -430.0414051844229, -1291.0775127789002, -5870.365330465259, -3718.548921800919, -5778.3003486667885, -3862.1834444144138, -9504.308758931325, -6392.812287616898, -8054.268464551383, -7826.73536788403, -3554.223716311692, -4039.316992537133, -4804.454432610046, -4105.463643922141, -8964.299019327369, -9030.61400324294, -6506.986164422038, -6306.21959861935, -6416.22732601942, -6930.663418928209, -9748.804227893048, -9917.150418357032, -9575.0874276029, -4979.12832315278, -7339.029505299478, -2527.137586857335, -6186.6612766638555, -8276.37336561715, -5745.50169307326, -9248.662838162847, -4423.9703279954265, -3940.3570119786204, -6522.189397886636, -3536.911232954474, -5421.460215308205, -5329.6664975407175, -8174.009908744048, -8218.903903335171, -6594.66168803242, -4703.125389307682, -3671.747844670176, -4171.605577972382, -4710.906680521081, -4580.529772056401, -7926.332907628632, -12645.621184578727, -4997.319573928061, -3658.1562563973644, -8264.498623516414, -9919.743550095425, -7407.537092797062, -11765.572456233709, -9735.762186589878, -12538.411529277946, -5206.447325111134, -7877.526472781466, -8832.87914514277, -8432.217005990064, -6915.304637387361, -9721.519607073134, -6122.371436358393, -3231.3207609879905, -3312.4191404121375, -5728.202705862059, -8248.384944829399, -6664.420992594197, -9041.804703681226, -7969.56290389465, -6679.946468629291, -6090.164243070205, -5397.18746727436, -8034.44725053708, -8738.341494466129, -10226.496389682894, -6327.59822476262, -4901.282366142314, -4634.690191445135, -4761.624755982242, -7374.558937663197, -9154.682897236824, -3671.860486198671, -3903.859859521712, -6920.775015898211, -4680.3780970368825, -11006.754040686028, -11764.276991836585, -6031.458615476825, -4736.603339565733, -4362.686557229106, -6074.939493138816, -10203.672020935908, -9145.942031640321, -12063.670690176597, -9879.295462416654, -8869.487887589998, -8296.273886621133, -5436.810785790175, -7846.029948668546, -8536.285810498854, -8282.884328284843, -5161.579356543904, -4855.715529332931, -6057.06849682958, -3260.6062526615356, -6906.9731049217735, -10027.264749986083, -7828.853431540731, -4697.356472664749, -6754.950761452408, -4342.173107691549, -4628.070582644103, -5859.95240481922, -3996.8836894296974, -5148.8926167313675, -8235.042612459618, -8818.524185514772, -4176.0329156153575, -4858.275594572328, -11447.271819152751, -9065.70256778756, -6248.799094662, -3711.2840833082555, -10327.810968606887, -10151.065113786903, -9609.70733717584, -9357.256175859755, -8577.33713970683, -5121.930852381786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3953292059639129, "mean_inference_ms": 0.9618399040640125, "mean_action_processing_ms": 0.16602054271885558, "mean_env_wait_ms": 0.0509523027095356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030573606491088867, "StateBufferConnector_ms": 0.0023453235626220703, "ViewRequirementAgentConnector_ms": 0.06618010997772217}, "num_episodes": 20, "episode_return_max": -313.5163328837309, "episode_return_min": -12645.621184578727, "episode_return_mean": -7397.905880294693}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.2237102376783, "num_env_steps_trained_throughput_per_sec": 558.2237102376783, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 7205.202, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7205.168, "sample_time_ms": 738.453, "learn_time_ms": 6454.714, "learn_throughput": 619.702, "synch_weights_time_ms": 11.531}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": true, "training_iteration": 200, "trial_id": "3439d_00000", "date": "2024-08-09_15-51-24", "timestamp": 1723233084, "time_this_iter_s": 7.170609951019287, "time_total_s": 1486.8616440296173, "pid": 48842, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327abfd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1486.8616440296173, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 22.472727272727273, "ram_util_percent": 81.40909090909089}}
