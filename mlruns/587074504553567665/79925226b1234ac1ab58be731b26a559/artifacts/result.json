{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7037077817021223, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997709815212028, "policy_loss": -0.0034542664656386016, "vf_loss": 10.0, "vf_explained_var": -3.6377755422440784e-07, "kl": 0.005820338621461579, "entropy": 1.604056063530937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8602548988536001, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9735726694266, "policy_loss": -0.010126781640186286, "vf_loss": 9.981191237767538, "vf_explained_var": -0.0001029061774412791, "kl": 0.012541207689942269, "entropy": 1.5973455018053453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 23606.537826152464, "episode_reward_min": 688.9260829702613, "episode_reward_mean": 18330.80782176686, "episode_len_mean": 175.2, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 3504, "policy_reward_min": {"agent_policy": 13.301729384002247, "adversary_policy": 193.9513361396779}, "policy_reward_max": {"agent_policy": 9170.03289481167, "adversary_policy": 12901.359720146987}, "policy_reward_mean": {"agent_policy": 3593.578464675667, "adversary_policy": 7368.6146785455985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20344.777829777082, 22464.318704277433, 19515.78104500568, 18585.72383216213, 3726.4625944251948, 20155.694433472458, 15280.663523740812, 11849.283968508824, 21790.789828220648, 688.9260829702613, 18454.154866277604, 22592.360744865757, 23606.537826152464, 21512.51793204894, 21657.841881363514, 19470.038813965886, 18756.751106289274, 20180.50713000115, 23212.309986905286, 22770.71430490681], "episode_lengths": [200, 200, 200, 200, 33, 200, 165, 99, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2144.0301899615583, 3991.4957649811968, 4233.572202072565, 8279.759255021165, 241.74424221007249, 2929.6806775620685, 1647.798356300321, 1007.1260485885329, 5209.446925966115, 13.301729384002247, 9170.03289481167, 1716.7209506055517, 1240.7759035839726, 3088.1399092253732, 2130.3934211216633, 6030.143720805833, 3644.8789458793476, 6500.2076702679, 3788.085344580111, 4864.235140584315], "policy_adversary_policy_reward": [6202.642206046119, 11998.105433769393, 8333.290092697685, 10139.532846598584, 5373.645421274817, 9908.563421658391, 4811.431049625495, 5494.533527515448, 1393.0102165095875, 2091.7081357055345, 6013.558809741445, 11212.454946168888, 3613.4016341627835, 10019.463533277712, 4911.421500761657, 5930.736419158644, 8834.190895015983, 7747.152007238553, 193.9513361396779, 481.67301744658096, 4593.810317606668, 4690.31165385926, 12425.4146731254, 8450.225121134823, 9464.40220242157, 12901.359720146987, 11053.995714505574, 7370.382308317971, 7515.706257632539, 12011.742202609283, 8111.991902925118, 5327.903190234933, 10497.256677851605, 4614.615482558347, 7083.8595987269055, 6596.439861006372, 9076.793145409063, 10347.431496916071, 8797.898456308243, 9108.58070801426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346627681568996, "mean_inference_ms": 1.3379224067960345, "mean_action_processing_ms": 0.2144745113735878, "mean_env_wait_ms": 0.08049761857975399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684064865112305, "StateBufferConnector_ms": 0.002982616424560547, "ViewRequirementAgentConnector_ms": 0.09948611259460449}, "num_episodes": 20, "episode_return_max": 23606.537826152464, "episode_return_min": 688.9260829702613, "episode_return_mean": 18330.80782176686}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.5821761236576, "num_env_steps_trained_throughput_per_sec": 514.5821761236576, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 7773.304, "restore_workers_time_ms": 0.017, "training_step_time_ms": 7773.262, "sample_time_ms": 1041.346, "learn_time_ms": 6722.153, "learn_throughput": 595.047, "synch_weights_time_ms": 9.214}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-29-31", "timestamp": 1723235371, "time_this_iter_s": 7.775995969772339, "time_total_s": 7.775995969772339, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e9550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7.775995969772339, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.575, "ram_util_percent": 83.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6124599463725217, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997324496476107, "policy_loss": -0.005005789968239331, "vf_loss": 10.0, "vf_explained_var": 4.4615180404097944e-07, "kl": 0.011651527467947552, "entropy": 1.59332326335251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8672334725347658, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.984640756249428, "policy_loss": -0.007825026469314858, "vf_loss": 9.98988955616951, "vf_explained_var": -0.0001776908834775289, "kl": 0.012881063666888319, "entropy": 1.567931867390871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 24852.517970156397, "episode_reward_min": 688.9260829702613, "episode_reward_mean": 18852.424628578687, "episode_len_mean": 178.975, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 7159, "policy_reward_min": {"agent_policy": 13.301729384002247, "adversary_policy": 193.9513361396779}, "policy_reward_max": {"agent_policy": 9892.862254256632, "adversary_policy": 12901.359720146987}, "policy_reward_mean": {"agent_policy": 3868.6124946305317, "adversary_policy": 7491.906066974075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20344.777829777082, 22464.318704277433, 19515.78104500568, 18585.72383216213, 3726.4625944251948, 20155.694433472458, 15280.663523740812, 11849.283968508824, 21790.789828220648, 688.9260829702613, 18454.154866277604, 22592.360744865757, 23606.537826152464, 21512.51793204894, 21657.841881363514, 19470.038813965886, 18756.751106289274, 20180.50713000115, 23212.309986905286, 22770.71430490681, 23963.73253134211, 4462.388868008053, 20308.610332977638, 20151.961064001305, 24030.575040633885, 22986.927198535, 17067.475109214814, 20538.73234724843, 19594.150538691345, 1764.8677394657368, 19544.00865569163, 19202.294766720966, 24852.517970156397, 19290.291213415938, 20756.300067335946, 19935.265215951877, 22391.207497363645, 22629.423440137885, 20915.019743132594, 23095.0793677849], "episode_lengths": [200, 200, 200, 200, 33, 200, 165, 99, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2144.0301899615583, 3991.4957649811968, 4233.572202072565, 8279.759255021165, 241.74424221007249, 2929.6806775620685, 1647.798356300321, 1007.1260485885329, 5209.446925966115, 13.301729384002247, 9170.03289481167, 1716.7209506055517, 1240.7759035839726, 3088.1399092253732, 2130.3934211216633, 6030.143720805833, 3644.8789458793476, 6500.2076702679, 3788.085344580111, 4864.235140584315, 2645.562434165469, 237.9906162776775, 5639.355526327289, 7537.433212704128, 2203.688854011295, 4222.9399410232345, 9892.862254256632, 5371.741388249743, 3946.031339546503, 53.39613350109328, 4312.142839753517, 2194.127669216035, 2278.733423186025, 8408.030694707046, 3876.634940342032, 2416.3392842426633, 4626.498267925418, 2399.307373542267, 6422.031411409291, 4188.082887320585], "policy_adversary_policy_reward": [6202.642206046119, 11998.105433769393, 8333.290092697685, 10139.532846598584, 5373.645421274817, 9908.563421658391, 4811.431049625495, 5494.533527515448, 1393.0102165095875, 2091.7081357055345, 6013.558809741445, 11212.454946168888, 3613.4016341627835, 10019.463533277712, 4911.421500761657, 5930.736419158644, 8834.190895015983, 7747.152007238553, 193.9513361396779, 481.67301744658096, 4593.810317606668, 4690.31165385926, 12425.4146731254, 8450.225121134823, 9464.40220242157, 12901.359720146987, 11053.995714505574, 7370.382308317971, 7515.706257632539, 12011.742202609283, 8111.991902925118, 5327.903190234933, 10497.256677851605, 4614.615482558347, 7083.8595987269055, 6596.439861006372, 9076.793145409063, 10347.431496916071, 8797.898456308243, 9108.58070801426, 11442.705863436484, 9875.464233740135, 1633.9617432618609, 2590.436508468513, 8502.78009740366, 6166.474709246647, 6097.759159679331, 6516.768691617808, 11853.631691259892, 9973.254495362744, 9417.433428163447, 9346.553829348324, 4239.134600712516, 2935.478254245679, 6396.596723517465, 8770.394235481202, 10196.104284184441, 5452.01491496039, 704.2075676859156, 1007.2640382787279, 9829.992783977445, 5401.873031960691, 11948.00795451492, 5060.159142990019, 10811.585340861187, 11762.19920610917, 5217.90053939899, 5664.359979309908, 6614.1644436050055, 10265.500683388924, 11725.79633948829, 5793.129592220919, 9148.313665947633, 8616.395563490627, 11742.828250188684, 8487.28781640694, 6976.906493625491, 7516.081838097764, 9914.563778978554, 8992.43270148579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4964686848000134, "mean_inference_ms": 1.2386772890772455, "mean_action_processing_ms": 0.2014047828800579, "mean_env_wait_ms": 0.07289149361867278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005519390106201172, "StateBufferConnector_ms": 0.0027313828468322754, "ViewRequirementAgentConnector_ms": 0.08116811513900757}, "num_episodes": 20, "episode_return_max": 24852.517970156397, "episode_return_min": 688.9260829702613, "episode_return_mean": 18852.424628578687}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 562.939118399769, "num_env_steps_trained_throughput_per_sec": 562.939118399769, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 7439.437, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7439.388, "sample_time_ms": 877.912, "learn_time_ms": 6550.022, "learn_throughput": 610.685, "synch_weights_time_ms": 10.894}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-29-38", "timestamp": 1723235378, "time_this_iter_s": 7.109196186065674, "time_total_s": 14.885192155838013, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.885192155838013, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.589999999999996, "ram_util_percent": 83.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6507245384511493, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00077824264607, "policy_loss": -0.00167124461550167, "vf_loss": 10.0, "vf_explained_var": -7.707605916987021e-07, "kl": 0.012247476235978187, "entropy": 1.5927519134743504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8352612198640903, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.976990668972332, "policy_loss": -0.007863781927396, "vf_loss": 9.982911973198254, "vf_explained_var": -1.2080247203509014e-05, "kl": 0.009712307416824236, "entropy": 1.55710407619675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 25121.46578004201, "episode_reward_min": 688.9260829702613, "episode_reward_mean": 19099.498862261975, "episode_len_mean": 181.91666666666666, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10915, "policy_reward_min": {"agent_policy": 13.301729384002247, "adversary_policy": 193.9513361396779}, "policy_reward_max": {"agent_policy": 9892.862254256632, "adversary_policy": 12901.359720146987}, "policy_reward_mean": {"agent_policy": 3857.388352329695, "adversary_policy": 7621.055254966138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20344.777829777082, 22464.318704277433, 19515.78104500568, 18585.72383216213, 3726.4625944251948, 20155.694433472458, 15280.663523740812, 11849.283968508824, 21790.789828220648, 688.9260829702613, 18454.154866277604, 22592.360744865757, 23606.537826152464, 21512.51793204894, 21657.841881363514, 19470.038813965886, 18756.751106289274, 20180.50713000115, 23212.309986905286, 22770.71430490681, 23963.73253134211, 4462.388868008053, 20308.610332977638, 20151.961064001305, 24030.575040633885, 22986.927198535, 17067.475109214814, 20538.73234724843, 19594.150538691345, 1764.8677394657368, 19544.00865569163, 19202.294766720966, 24852.517970156397, 19290.291213415938, 20756.300067335946, 19935.265215951877, 22391.207497363645, 22629.423440137885, 20915.019743132594, 23095.0793677849, 17868.800875857738, 14046.19206695902, 19476.55901545854, 25121.46578004201, 21480.692820491317, 18607.373108039876, 24241.9135546785, 19735.01831838313, 21385.9644270232, 17334.49887913082, 24054.754295960778, 23063.19781836967, 22547.123013238644, 19609.79411946496, 18409.475986311692, 19705.576220815674, 19950.795865501772, 20280.042819609997, 2987.4345440567563, 21966.27306317704], "episode_lengths": [200, 200, 200, 200, 33, 200, 165, 99, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200], "policy_agent_policy_reward": [2144.0301899615583, 3991.4957649811968, 4233.572202072565, 8279.759255021165, 241.74424221007249, 2929.6806775620685, 1647.798356300321, 1007.1260485885329, 5209.446925966115, 13.301729384002247, 9170.03289481167, 1716.7209506055517, 1240.7759035839726, 3088.1399092253732, 2130.3934211216633, 6030.143720805833, 3644.8789458793476, 6500.2076702679, 3788.085344580111, 4864.235140584315, 2645.562434165469, 237.9906162776775, 5639.355526327289, 7537.433212704128, 2203.688854011295, 4222.9399410232345, 9892.862254256632, 5371.741388249743, 3946.031339546503, 53.39613350109328, 4312.142839753517, 2194.127669216035, 2278.733423186025, 8408.030694707046, 3876.634940342032, 2416.3392842426633, 4626.498267925418, 2399.307373542267, 6422.031411409291, 4188.082887320585, 3080.6855299081785, 1201.4047256410477, 6185.910899471062, 2493.1190915163957, 5446.217236079837, 3582.9871105990755, 2297.4439914740406, 5605.19484217997, 4355.03658587527, 4878.277818503951, 1936.521785217135, 2886.7082600709355, 2605.9396100140134, 5118.371113299637, 3517.566511177911, 5159.137054288812, 6586.138008225538, 7031.688248437291, 184.14361692312343, 2546.3093156572036], "policy_adversary_policy_reward": [6202.642206046119, 11998.105433769393, 8333.290092697685, 10139.532846598584, 5373.645421274817, 9908.563421658391, 4811.431049625495, 5494.533527515448, 1393.0102165095875, 2091.7081357055345, 6013.558809741445, 11212.454946168888, 3613.4016341627835, 10019.463533277712, 4911.421500761657, 5930.736419158644, 8834.190895015983, 7747.152007238553, 193.9513361396779, 481.67301744658096, 4593.810317606668, 4690.31165385926, 12425.4146731254, 8450.225121134823, 9464.40220242157, 12901.359720146987, 11053.995714505574, 7370.382308317971, 7515.706257632539, 12011.742202609283, 8111.991902925118, 5327.903190234933, 10497.256677851605, 4614.615482558347, 7083.8595987269055, 6596.439861006372, 9076.793145409063, 10347.431496916071, 8797.898456308243, 9108.58070801426, 11442.705863436484, 9875.464233740135, 1633.9617432618609, 2590.436508468513, 8502.78009740366, 6166.474709246647, 6097.759159679331, 6516.768691617808, 11853.631691259892, 9973.254495362744, 9417.433428163447, 9346.553829348324, 4239.134600712516, 2935.478254245679, 6396.596723517465, 8770.394235481202, 10196.104284184441, 5452.01491496039, 704.2075676859156, 1007.2640382787279, 9829.992783977445, 5401.873031960691, 11948.00795451492, 5060.159142990019, 10811.585340861187, 11762.19920610917, 5217.90053939899, 5664.359979309908, 6614.1644436050055, 10265.500683388924, 11725.79633948829, 5793.129592220919, 9148.313665947633, 8616.395563490627, 11742.828250188684, 8487.28781640694, 6976.906493625491, 7516.081838097764, 9914.563778978554, 8992.43270148579, 3726.6652521267265, 11061.450093822781, 7637.430039190795, 5207.357302127182, 5334.423391727561, 7956.2247242598805, 11568.030870252835, 11060.31581827277, 8692.267451336076, 7342.208133075368, 10559.148513131871, 4465.2374843089265, 11770.718511419858, 10173.7510517846, 5613.320034088046, 8516.503442115123, 9787.099037855685, 7243.828803292259, 3192.363255399864, 9263.857805226995, 10011.256130705578, 12106.97638003806, 9358.442098940744, 10818.047459357962, 10573.26458914911, 9367.91881407551, 5467.658495734036, 9023.764510431329, 4267.340362580701, 10624.569112553028, 5563.440597084744, 8982.998569442138, 7280.202943936403, 6084.45491333981, 7025.529727104957, 6222.824844067783, 795.4035223784591, 2007.887404755174, 8155.329982086165, 11264.633765433646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4761589160061615, "mean_inference_ms": 1.1875596210780803, "mean_action_processing_ms": 0.19435790160283636, "mean_env_wait_ms": 0.06892330589106122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005092422167460124, "StateBufferConnector_ms": 0.0026208162307739258, "ViewRequirementAgentConnector_ms": 0.07627089818318684}, "num_episodes": 20, "episode_return_max": 25121.46578004201, "episode_return_min": 688.9260829702613, "episode_return_mean": 19099.498862261975}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 555.7350124483106, "num_env_steps_trained_throughput_per_sec": 555.7350124483106, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7358.854, "restore_workers_time_ms": 0.017, "training_step_time_ms": 7358.805, "sample_time_ms": 828.854, "learn_time_ms": 6518.981, "learn_throughput": 613.593, "synch_weights_time_ms": 10.437}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-29-46", "timestamp": 1723235386, "time_this_iter_s": 7.200636863708496, "time_total_s": 22.08582901954651, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22.08582901954651, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.00909090909091, "ram_util_percent": 83.16363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.677234985194509, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996965774152645, "policy_loss": -0.005801589022237788, "vf_loss": 10.0, "vf_explained_var": 1.9634842241882648e-07, "kl": 0.013836728439237627, "entropy": 1.5807800345950656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8545010626936952, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.984717897574107, "policy_loss": -0.010594870532562103, "vf_loss": 9.992347699403762, "vf_explained_var": -0.00010771422336498896, "kl": 0.014825420443473073, "entropy": 1.553308643400669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 25121.46578004201, "episode_reward_min": 688.9260829702613, "episode_reward_mean": 19501.660008421335, "episode_len_mean": 185.6375, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 14851, "policy_reward_min": {"agent_policy": 13.301729384002247, "adversary_policy": 193.9513361396779}, "policy_reward_max": {"agent_policy": 9892.862254256632, "adversary_policy": 12901.359720146987}, "policy_reward_mean": {"agent_policy": 3899.6462850980124, "adversary_policy": 7801.006861661657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20344.777829777082, 22464.318704277433, 19515.78104500568, 18585.72383216213, 3726.4625944251948, 20155.694433472458, 15280.663523740812, 11849.283968508824, 21790.789828220648, 688.9260829702613, 18454.154866277604, 22592.360744865757, 23606.537826152464, 21512.51793204894, 21657.841881363514, 19470.038813965886, 18756.751106289274, 20180.50713000115, 23212.309986905286, 22770.71430490681, 23963.73253134211, 4462.388868008053, 20308.610332977638, 20151.961064001305, 24030.575040633885, 22986.927198535, 17067.475109214814, 20538.73234724843, 19594.150538691345, 1764.8677394657368, 19544.00865569163, 19202.294766720966, 24852.517970156397, 19290.291213415938, 20756.300067335946, 19935.265215951877, 22391.207497363645, 22629.423440137885, 20915.019743132594, 23095.0793677849, 17868.800875857738, 14046.19206695902, 19476.55901545854, 25121.46578004201, 21480.692820491317, 18607.373108039876, 24241.9135546785, 19735.01831838313, 21385.9644270232, 17334.49887913082, 24054.754295960778, 23063.19781836967, 22547.123013238644, 19609.79411946496, 18409.475986311692, 19705.576220815674, 19950.795865501772, 20280.042819609997, 2987.4345440567563, 21966.27306317704, 24129.069841487188, 21043.082385513742, 24657.376050634284, 22088.605328094112, 23266.810649938227, 18335.46796190954, 19557.150798682203, 17881.194603076638, 20527.289115532647, 15067.66706060145, 18757.71417430089, 21833.683043989466, 18376.129828526955, 20389.771461783876, 23626.55225238632, 23407.507790393825, 19379.075407139168, 20178.22468623799, 21960.34774158172, 19700.148756177827], "episode_lengths": [200, 200, 200, 200, 33, 200, 165, 99, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2144.0301899615583, 3991.4957649811968, 4233.572202072565, 8279.759255021165, 241.74424221007249, 2929.6806775620685, 1647.798356300321, 1007.1260485885329, 5209.446925966115, 13.301729384002247, 9170.03289481167, 1716.7209506055517, 1240.7759035839726, 3088.1399092253732, 2130.3934211216633, 6030.143720805833, 3644.8789458793476, 6500.2076702679, 3788.085344580111, 4864.235140584315, 2645.562434165469, 237.9906162776775, 5639.355526327289, 7537.433212704128, 2203.688854011295, 4222.9399410232345, 9892.862254256632, 5371.741388249743, 3946.031339546503, 53.39613350109328, 4312.142839753517, 2194.127669216035, 2278.733423186025, 8408.030694707046, 3876.634940342032, 2416.3392842426633, 4626.498267925418, 2399.307373542267, 6422.031411409291, 4188.082887320585, 3080.6855299081785, 1201.4047256410477, 6185.910899471062, 2493.1190915163957, 5446.217236079837, 3582.9871105990755, 2297.4439914740406, 5605.19484217997, 4355.03658587527, 4878.277818503951, 1936.521785217135, 2886.7082600709355, 2605.9396100140134, 5118.371113299637, 3517.566511177911, 5159.137054288812, 6586.138008225538, 7031.688248437291, 184.14361692312343, 2546.3093156572036, 2643.9055919554253, 2276.2403244815364, 3126.0188494132253, 4904.256252650759, 2396.9741814488825, 5469.70577743757, 7641.248525028334, 3211.3659308231177, 4081.154964176419, 1446.7185804548938, 5931.851327039632, 4551.334228819727, 6779.206419653641, 2747.47272595686, 3782.6058255398275, 3324.722578614691, 5447.032820705579, 4333.934894296043, 3295.811789259452, 3136.8400803037102], "policy_adversary_policy_reward": [6202.642206046119, 11998.105433769393, 8333.290092697685, 10139.532846598584, 5373.645421274817, 9908.563421658391, 4811.431049625495, 5494.533527515448, 1393.0102165095875, 2091.7081357055345, 6013.558809741445, 11212.454946168888, 3613.4016341627835, 10019.463533277712, 4911.421500761657, 5930.736419158644, 8834.190895015983, 7747.152007238553, 193.9513361396779, 481.67301744658096, 4593.810317606668, 4690.31165385926, 12425.4146731254, 8450.225121134823, 9464.40220242157, 12901.359720146987, 11053.995714505574, 7370.382308317971, 7515.706257632539, 12011.742202609283, 8111.991902925118, 5327.903190234933, 10497.256677851605, 4614.615482558347, 7083.8595987269055, 6596.439861006372, 9076.793145409063, 10347.431496916071, 8797.898456308243, 9108.58070801426, 11442.705863436484, 9875.464233740135, 1633.9617432618609, 2590.436508468513, 8502.78009740366, 6166.474709246647, 6097.759159679331, 6516.768691617808, 11853.631691259892, 9973.254495362744, 9417.433428163447, 9346.553829348324, 4239.134600712516, 2935.478254245679, 6396.596723517465, 8770.394235481202, 10196.104284184441, 5452.01491496039, 704.2075676859156, 1007.2640382787279, 9829.992783977445, 5401.873031960691, 11948.00795451492, 5060.159142990019, 10811.585340861187, 11762.19920610917, 5217.90053939899, 5664.359979309908, 6614.1644436050055, 10265.500683388924, 11725.79633948829, 5793.129592220919, 9148.313665947633, 8616.395563490627, 11742.828250188684, 8487.28781640694, 6976.906493625491, 7516.081838097764, 9914.563778978554, 8992.43270148579, 3726.6652521267265, 11061.450093822781, 7637.430039190795, 5207.357302127182, 5334.423391727561, 7956.2247242598805, 11568.030870252835, 11060.31581827277, 8692.267451336076, 7342.208133075368, 10559.148513131871, 4465.2374843089265, 11770.718511419858, 10173.7510517846, 5613.320034088046, 8516.503442115123, 9787.099037855685, 7243.828803292259, 3192.363255399864, 9263.857805226995, 10011.256130705578, 12106.97638003806, 9358.442098940744, 10818.047459357962, 10573.26458914911, 9367.91881407551, 5467.658495734036, 9023.764510431329, 4267.340362580701, 10624.569112553028, 5563.440597084744, 8982.998569442138, 7280.202943936403, 6084.45491333981, 7025.529727104957, 6222.824844067783, 795.4035223784591, 2007.887404755174, 8155.329982086165, 11264.633765433646, 10128.859074742146, 11356.30517478965, 11865.895299249425, 6900.94676178278, 10944.986428229662, 10586.37077299138, 9009.322117283922, 8175.0269581593975, 9460.011432318655, 11409.825036170663, 4193.332338178588, 8672.429846293382, 6381.56698226126, 5534.335291392602, 3739.0589793457125, 10930.769692907832, 6385.153491801622, 10060.980659554529, 5451.014836464369, 8169.933643682156, 4615.5785505699805, 8210.284296691312, 8200.62022900717, 9081.728586162522, 7362.929204077302, 4233.994204795989, 11394.662897774087, 6247.635838052943, 9515.491995725972, 10328.454431120532, 10634.960499501563, 9447.824712277568, 8695.102803025371, 5236.939783408245, 9808.200729434908, 6036.089062507026, 10846.323834471485, 7818.212117850774, 5558.01313244686, 11005.295543427228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46229440736501815, "mean_inference_ms": 1.1514759994203208, "mean_action_processing_ms": 0.18955231243590104, "mean_env_wait_ms": 0.06634484039092084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004766285419464111, "StateBufferConnector_ms": 0.002535879611968994, "ViewRequirementAgentConnector_ms": 0.07226958870887756}, "num_episodes": 20, "episode_return_max": 25121.46578004201, "episode_return_min": 688.9260829702613, "episode_return_mean": 19501.660008421335}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 563.7713380688575, "num_env_steps_trained_throughput_per_sec": 563.7713380688575, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7292.911, "restore_workers_time_ms": 0.016, "training_step_time_ms": 7292.865, "sample_time_ms": 804.916, "learn_time_ms": 6477.388, "learn_throughput": 617.533, "synch_weights_time_ms": 10.06}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-29-53", "timestamp": 1723235393, "time_this_iter_s": 7.097782135009766, "time_total_s": 29.183611154556274, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e9550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29.183611154556274, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.150000000000006, "ram_util_percent": 82.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.644765265293853, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002751355953318, "policy_loss": -0.00016984714604125766, "vf_loss": 10.0, "vf_explained_var": -6.849803621806795e-08, "kl": 0.014606011011908768, "entropy": 1.5800882079613903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7903544308928152, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990065861741702, "policy_loss": -0.004206696365630099, "vf_loss": 9.989967439572016, "vf_explained_var": -3.675644596417745e-05, "kl": 0.021525555227223474, "entropy": 1.5444030774136384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 25121.46578004201, "episode_reward_min": 688.9260829702613, "episode_reward_mean": 19616.030362447073, "episode_len_mean": 186.59, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18659, "policy_reward_min": {"agent_policy": 13.301729384002247, "adversary_policy": 193.9513361396779}, "policy_reward_max": {"agent_policy": 10601.71456248916, "adversary_policy": 12901.359720146987}, "policy_reward_mean": {"agent_policy": 3989.589469382793, "adversary_policy": 7813.220446532138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18585.72383216213, 3726.4625944251948, 20155.694433472458, 15280.663523740812, 11849.283968508824, 21790.789828220648, 688.9260829702613, 18454.154866277604, 22592.360744865757, 23606.537826152464, 21512.51793204894, 21657.841881363514, 19470.038813965886, 18756.751106289274, 20180.50713000115, 23212.309986905286, 22770.71430490681, 23963.73253134211, 4462.388868008053, 20308.610332977638, 20151.961064001305, 24030.575040633885, 22986.927198535, 17067.475109214814, 20538.73234724843, 19594.150538691345, 1764.8677394657368, 19544.00865569163, 19202.294766720966, 24852.517970156397, 19290.291213415938, 20756.300067335946, 19935.265215951877, 22391.207497363645, 22629.423440137885, 20915.019743132594, 23095.0793677849, 17868.800875857738, 14046.19206695902, 19476.55901545854, 25121.46578004201, 21480.692820491317, 18607.373108039876, 24241.9135546785, 19735.01831838313, 21385.9644270232, 17334.49887913082, 24054.754295960778, 23063.19781836967, 22547.123013238644, 19609.79411946496, 18409.475986311692, 19705.576220815674, 19950.795865501772, 20280.042819609997, 2987.4345440567563, 21966.27306317704, 24129.069841487188, 21043.082385513742, 24657.376050634284, 22088.605328094112, 23266.810649938227, 18335.46796190954, 19557.150798682203, 17881.194603076638, 20527.289115532647, 15067.66706060145, 18757.71417430089, 21833.683043989466, 18376.129828526955, 20389.771461783876, 23626.55225238632, 23407.507790393825, 19379.075407139168, 20178.22468623799, 21960.34774158172, 19700.148756177827, 16165.162242284765, 22728.75717566481, 20234.813957751063, 23625.752608198833, 20409.746617474113, 17763.72753314284, 24025.699499248058, 23867.899644265475, 20372.932531426464, 16882.65084448732, 22392.81512762063, 21704.35387383642, 19510.61064544061, 16410.90012147365, 19908.761804081907, 22378.569075295007, 21276.852474197112, 21012.13570593744, 23183.74787977652, 7899.445059627439, 20063.363590151326, 21804.9857432228, 20171.429395456635], "episode_lengths": [200, 33, 200, 165, 99, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200], "policy_agent_policy_reward": [8279.759255021165, 241.74424221007249, 2929.6806775620685, 1647.798356300321, 1007.1260485885329, 5209.446925966115, 13.301729384002247, 9170.03289481167, 1716.7209506055517, 1240.7759035839726, 3088.1399092253732, 2130.3934211216633, 6030.143720805833, 3644.8789458793476, 6500.2076702679, 3788.085344580111, 4864.235140584315, 2645.562434165469, 237.9906162776775, 5639.355526327289, 7537.433212704128, 2203.688854011295, 4222.9399410232345, 9892.862254256632, 5371.741388249743, 3946.031339546503, 53.39613350109328, 4312.142839753517, 2194.127669216035, 2278.733423186025, 8408.030694707046, 3876.634940342032, 2416.3392842426633, 4626.498267925418, 2399.307373542267, 6422.031411409291, 4188.082887320585, 3080.6855299081785, 1201.4047256410477, 6185.910899471062, 2493.1190915163957, 5446.217236079837, 3582.9871105990755, 2297.4439914740406, 5605.19484217997, 4355.03658587527, 4878.277818503951, 1936.521785217135, 2886.7082600709355, 2605.9396100140134, 5118.371113299637, 3517.566511177911, 5159.137054288812, 6586.138008225538, 7031.688248437291, 184.14361692312343, 2546.3093156572036, 2643.9055919554253, 2276.2403244815364, 3126.0188494132253, 4904.256252650759, 2396.9741814488825, 5469.70577743757, 7641.248525028334, 3211.3659308231177, 4081.154964176419, 1446.7185804548938, 5931.851327039632, 4551.334228819727, 6779.206419653641, 2747.47272595686, 3782.6058255398275, 3324.722578614691, 5447.032820705579, 4333.934894296043, 3295.811789259452, 3136.8400803037102, 1578.7609487206341, 4378.672863002639, 4840.935500342143, 2547.0019864936057, 3230.8216010847277, 3545.9612976086705, 2023.004608260691, 2456.7974826858144, 2085.922416161866, 7912.866253012625, 4744.698282104752, 3073.3852146101412, 4729.115798939164, 10601.71456248916, 2702.806406122046, 2317.5970599961847, 6235.757307132413, 5726.800461603448, 4441.710566111276, 480.67425150120096, 6755.398439820466, 3821.5273379305086, 7124.411641719443], "policy_adversary_policy_reward": [4811.431049625495, 5494.533527515448, 1393.0102165095875, 2091.7081357055345, 6013.558809741445, 11212.454946168888, 3613.4016341627835, 10019.463533277712, 4911.421500761657, 5930.736419158644, 8834.190895015983, 7747.152007238553, 193.9513361396779, 481.67301744658096, 4593.810317606668, 4690.31165385926, 12425.4146731254, 8450.225121134823, 9464.40220242157, 12901.359720146987, 11053.995714505574, 7370.382308317971, 7515.706257632539, 12011.742202609283, 8111.991902925118, 5327.903190234933, 10497.256677851605, 4614.615482558347, 7083.8595987269055, 6596.439861006372, 9076.793145409063, 10347.431496916071, 8797.898456308243, 9108.58070801426, 11442.705863436484, 9875.464233740135, 1633.9617432618609, 2590.436508468513, 8502.78009740366, 6166.474709246647, 6097.759159679331, 6516.768691617808, 11853.631691259892, 9973.254495362744, 9417.433428163447, 9346.553829348324, 4239.134600712516, 2935.478254245679, 6396.596723517465, 8770.394235481202, 10196.104284184441, 5452.01491496039, 704.2075676859156, 1007.2640382787279, 9829.992783977445, 5401.873031960691, 11948.00795451492, 5060.159142990019, 10811.585340861187, 11762.19920610917, 5217.90053939899, 5664.359979309908, 6614.1644436050055, 10265.500683388924, 11725.79633948829, 5793.129592220919, 9148.313665947633, 8616.395563490627, 11742.828250188684, 8487.28781640694, 6976.906493625491, 7516.081838097764, 9914.563778978554, 8992.43270148579, 3726.6652521267265, 11061.450093822781, 7637.430039190795, 5207.357302127182, 5334.423391727561, 7956.2247242598805, 11568.030870252835, 11060.31581827277, 8692.267451336076, 7342.208133075368, 10559.148513131871, 4465.2374843089265, 11770.718511419858, 10173.7510517846, 5613.320034088046, 8516.503442115123, 9787.099037855685, 7243.828803292259, 3192.363255399864, 9263.857805226995, 10011.256130705578, 12106.97638003806, 9358.442098940744, 10818.047459357962, 10573.26458914911, 9367.91881407551, 5467.658495734036, 9023.764510431329, 4267.340362580701, 10624.569112553028, 5563.440597084744, 8982.998569442138, 7280.202943936403, 6084.45491333981, 7025.529727104957, 6222.824844067783, 795.4035223784591, 2007.887404755174, 8155.329982086165, 11264.633765433646, 10128.859074742146, 11356.30517478965, 11865.895299249425, 6900.94676178278, 10944.986428229662, 10586.37077299138, 9009.322117283922, 8175.0269581593975, 9460.011432318655, 11409.825036170663, 4193.332338178588, 8672.429846293382, 6381.56698226126, 5534.335291392602, 3739.0589793457125, 10930.769692907832, 6385.153491801622, 10060.980659554529, 5451.014836464369, 8169.933643682156, 4615.5785505699805, 8210.284296691312, 8200.62022900717, 9081.728586162522, 7362.929204077302, 4233.994204795989, 11394.662897774087, 6247.635838052943, 9515.491995725972, 10328.454431120532, 10634.960499501563, 9447.824712277568, 8695.102803025371, 5236.939783408245, 9808.200729434908, 6036.089062507026, 10846.323834471485, 7818.212117850774, 5558.01313244686, 11005.295543427228, 8320.733987891026, 6265.667305673068, 9700.996386759123, 8649.087925902983, 9301.20012338881, 6092.678334020123, 11595.133637237344, 9483.61698446789, 6267.610993743157, 10911.314022646218, 3621.5919094118854, 10596.174326122282, 11071.565110342342, 10931.12978064498, 11684.520963510737, 9726.581198068909, 12056.213207569077, 6230.796907695553, 6229.269370718332, 2740.515220756384, 8842.851170903228, 8805.26567461268, 7715.244662234449, 10915.723996991836, 9413.0198247918, 5368.47502170968, 2305.6697733332453, 3503.5157856512483, 5766.626180350946, 11439.329217608902, 8269.196309959068, 11791.775705339789, 7536.701797872029, 7504.39336919262, 6870.000082206474, 8415.335162127505, 9073.274926581555, 9668.762387083701, 4327.651860567322, 3091.118947558916, 5942.841302786975, 7365.1238475438895, 7662.850119491802, 10320.608285800454, 6861.18279491068, 6185.834958826475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.449530526353081, "mean_inference_ms": 1.1172215844129731, "mean_action_processing_ms": 0.1843606211474291, "mean_env_wait_ms": 0.06374367421945172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004502058029174805, "StateBufferConnector_ms": 0.002514481544494629, "ViewRequirementAgentConnector_ms": 0.07092344760894775}, "num_episodes": 23, "episode_return_max": 25121.46578004201, "episode_return_min": 688.9260829702613, "episode_return_mean": 19616.030362447073}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.8956345931679, "num_env_steps_trained_throughput_per_sec": 506.8956345931679, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7412.564, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7412.521, "sample_time_ms": 785.235, "learn_time_ms": 6615.054, "learn_throughput": 604.681, "synch_weights_time_ms": 11.596}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-01", "timestamp": 1723235401, "time_this_iter_s": 7.943285942077637, "time_total_s": 37.12689709663391, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32072c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.12689709663391, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.190909090909095, "ram_util_percent": 82.27272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6290784334537214, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000675698436757, "policy_loss": -0.0012895438053876793, "vf_loss": 10.0, "vf_explained_var": -2.640265005606192e-07, "kl": 0.009826164014351668, "entropy": 1.5807974491169843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8462366523221135, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.982790727416674, "policy_loss": -5.999216033766667e-05, "vf_loss": 9.978899190823237, "vf_explained_var": -0.0001308627426624298, "kl": 0.013171759687247686, "entropy": 1.5105273090302944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 25121.46578004201, "episode_reward_min": 1764.8677394657368, "episode_reward_mean": 19836.199422897218, "episode_len_mean": 188.44, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18844, "policy_reward_min": {"agent_policy": 53.39613350109328, "adversary_policy": 704.2075676859156}, "policy_reward_max": {"agent_policy": 10601.71456248916, "adversary_policy": 12494.643835900551}, "policy_reward_mean": {"agent_policy": 4004.4022810139563, "adversary_policy": 7915.898570941629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22986.927198535, 17067.475109214814, 20538.73234724843, 19594.150538691345, 1764.8677394657368, 19544.00865569163, 19202.294766720966, 24852.517970156397, 19290.291213415938, 20756.300067335946, 19935.265215951877, 22391.207497363645, 22629.423440137885, 20915.019743132594, 23095.0793677849, 17868.800875857738, 14046.19206695902, 19476.55901545854, 25121.46578004201, 21480.692820491317, 18607.373108039876, 24241.9135546785, 19735.01831838313, 21385.9644270232, 17334.49887913082, 24054.754295960778, 23063.19781836967, 22547.123013238644, 19609.79411946496, 18409.475986311692, 19705.576220815674, 19950.795865501772, 20280.042819609997, 2987.4345440567563, 21966.27306317704, 24129.069841487188, 21043.082385513742, 24657.376050634284, 22088.605328094112, 23266.810649938227, 18335.46796190954, 19557.150798682203, 17881.194603076638, 20527.289115532647, 15067.66706060145, 18757.71417430089, 21833.683043989466, 18376.129828526955, 20389.771461783876, 23626.55225238632, 23407.507790393825, 19379.075407139168, 20178.22468623799, 21960.34774158172, 19700.148756177827, 16165.162242284765, 22728.75717566481, 20234.813957751063, 23625.752608198833, 20409.746617474113, 17763.72753314284, 24025.699499248058, 23867.899644265475, 20372.932531426464, 16882.65084448732, 22392.81512762063, 21704.35387383642, 19510.61064544061, 16410.90012147365, 19908.761804081907, 22378.569075295007, 21276.852474197112, 21012.13570593744, 23183.74787977652, 7899.445059627439, 20063.363590151326, 21804.9857432228, 20171.429395456635, 22477.37238326204, 24693.250508519748, 18209.110847963966, 20622.32464487332, 24479.51438730467, 20678.30653601458, 18711.949890399486, 2252.868768491594, 19733.770028990584, 19523.561835712848, 11345.829996662183, 20015.41495568175, 9172.730083016982, 15622.746502278804, 20930.109073575517, 24467.538318626466, 22780.671092033008, 19597.403896503067, 18466.940334371502, 21478.475264220346, 23924.26240206431, 20041.300987687504], "episode_lengths": [200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 125, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 88, 200, 92, 130, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4222.9399410232345, 9892.862254256632, 5371.741388249743, 3946.031339546503, 53.39613350109328, 4312.142839753517, 2194.127669216035, 2278.733423186025, 8408.030694707046, 3876.634940342032, 2416.3392842426633, 4626.498267925418, 2399.307373542267, 6422.031411409291, 4188.082887320585, 3080.6855299081785, 1201.4047256410477, 6185.910899471062, 2493.1190915163957, 5446.217236079837, 3582.9871105990755, 2297.4439914740406, 5605.19484217997, 4355.03658587527, 4878.277818503951, 1936.521785217135, 2886.7082600709355, 2605.9396100140134, 5118.371113299637, 3517.566511177911, 5159.137054288812, 6586.138008225538, 7031.688248437291, 184.14361692312343, 2546.3093156572036, 2643.9055919554253, 2276.2403244815364, 3126.0188494132253, 4904.256252650759, 2396.9741814488825, 5469.70577743757, 7641.248525028334, 3211.3659308231177, 4081.154964176419, 1446.7185804548938, 5931.851327039632, 4551.334228819727, 6779.206419653641, 2747.47272595686, 3782.6058255398275, 3324.722578614691, 5447.032820705579, 4333.934894296043, 3295.811789259452, 3136.8400803037102, 1578.7609487206341, 4378.672863002639, 4840.935500342143, 2547.0019864936057, 3230.8216010847277, 3545.9612976086705, 2023.004608260691, 2456.7974826858144, 2085.922416161866, 7912.866253012625, 4744.698282104752, 3073.3852146101412, 4729.115798939164, 10601.71456248916, 2702.806406122046, 2317.5970599961847, 6235.757307132413, 5726.800461603448, 4441.710566111276, 480.67425150120096, 6755.398439820466, 3821.5273379305086, 7124.411641719443, 2965.3156575839353, 1608.6439236883157, 7768.794649563955, 2556.016968045566, 2673.46474797137, 3830.8083880327654, 7309.910808813948, 154.72838192355113, 5615.375050992065, 4342.962556159641, 921.894636125479, 7510.509373992517, 698.1118224062006, 1549.4870537310187, 4947.9117385814625, 2675.0198744655745, 3736.798154585932, 5210.964971222364, 6291.530090097653, 2575.680591595514, 2512.469963953284, 3791.38353956811], "policy_adversary_policy_reward": [9417.433428163447, 9346.553829348324, 4239.134600712516, 2935.478254245679, 6396.596723517465, 8770.394235481202, 10196.104284184441, 5452.01491496039, 704.2075676859156, 1007.2640382787279, 9829.992783977445, 5401.873031960691, 11948.00795451492, 5060.159142990019, 10811.585340861187, 11762.19920610917, 5217.90053939899, 5664.359979309908, 6614.1644436050055, 10265.500683388924, 11725.79633948829, 5793.129592220919, 9148.313665947633, 8616.395563490627, 11742.828250188684, 8487.28781640694, 6976.906493625491, 7516.081838097764, 9914.563778978554, 8992.43270148579, 3726.6652521267265, 11061.450093822781, 7637.430039190795, 5207.357302127182, 5334.423391727561, 7956.2247242598805, 11568.030870252835, 11060.31581827277, 8692.267451336076, 7342.208133075368, 10559.148513131871, 4465.2374843089265, 11770.718511419858, 10173.7510517846, 5613.320034088046, 8516.503442115123, 9787.099037855685, 7243.828803292259, 3192.363255399864, 9263.857805226995, 10011.256130705578, 12106.97638003806, 9358.442098940744, 10818.047459357962, 10573.26458914911, 9367.91881407551, 5467.658495734036, 9023.764510431329, 4267.340362580701, 10624.569112553028, 5563.440597084744, 8982.998569442138, 7280.202943936403, 6084.45491333981, 7025.529727104957, 6222.824844067783, 795.4035223784591, 2007.887404755174, 8155.329982086165, 11264.633765433646, 10128.859074742146, 11356.30517478965, 11865.895299249425, 6900.94676178278, 10944.986428229662, 10586.37077299138, 9009.322117283922, 8175.0269581593975, 9460.011432318655, 11409.825036170663, 4193.332338178588, 8672.429846293382, 6381.56698226126, 5534.335291392602, 3739.0589793457125, 10930.769692907832, 6385.153491801622, 10060.980659554529, 5451.014836464369, 8169.933643682156, 4615.5785505699805, 8210.284296691312, 8200.62022900717, 9081.728586162522, 7362.929204077302, 4233.994204795989, 11394.662897774087, 6247.635838052943, 9515.491995725972, 10328.454431120532, 10634.960499501563, 9447.824712277568, 8695.102803025371, 5236.939783408245, 9808.200729434908, 6036.089062507026, 10846.323834471485, 7818.212117850774, 5558.01313244686, 11005.295543427228, 8320.733987891026, 6265.667305673068, 9700.996386759123, 8649.087925902983, 9301.20012338881, 6092.678334020123, 11595.133637237344, 9483.61698446789, 6267.610993743157, 10911.314022646218, 3621.5919094118854, 10596.174326122282, 11071.565110342342, 10931.12978064498, 11684.520963510737, 9726.581198068909, 12056.213207569077, 6230.796907695553, 6229.269370718332, 2740.515220756384, 8842.851170903228, 8805.26567461268, 7715.244662234449, 10915.723996991836, 9413.0198247918, 5368.47502170968, 2305.6697733332453, 3503.5157856512483, 5766.626180350946, 11439.329217608902, 8269.196309959068, 11791.775705339789, 7536.701797872029, 7504.39336919262, 6870.000082206474, 8415.335162127505, 9073.274926581555, 9668.762387083701, 4327.651860567322, 3091.118947558916, 5942.841302786975, 7365.1238475438895, 7662.850119491802, 10320.608285800454, 6861.18279491068, 6185.834958826475, 11176.819966147023, 8335.236759531152, 10589.962748930882, 12494.643835900551, 6373.340974167001, 4066.975224233035, 6480.1890211423415, 11586.118655685388, 11398.590938348065, 10407.458700985246, 6536.170912283615, 10311.327235698178, 6832.2248149170055, 4569.814266668612, 909.3658842371538, 1188.7745023308892, 8526.760572738887, 5591.634405259652, 9799.173067571319, 5381.426211981894, 5206.601058814506, 5217.334301722206, 6613.446263982228, 5891.459317707016, 5807.270564510036, 2667.3476961007536, 7294.454812302513, 6778.804636245278, 6817.159868893568, 9165.037466100495, 11352.755953061358, 10439.762491099493, 9059.472662795264, 9984.400274651774, 5455.268272772094, 8931.17065250859, 4324.804710640568, 7850.605533633312, 7336.339640489345, 11566.455032135429, 9962.454873031733, 11449.33756507926, 5899.165363956585, 10350.752084162843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4310605570295849, "mean_inference_ms": 1.0650947734004355, "mean_action_processing_ms": 0.17695962320622313, "mean_env_wait_ms": 0.05986107282116267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00385892391204834, "StateBufferConnector_ms": 0.0024232864379882812, "ViewRequirementAgentConnector_ms": 0.06605017185211182}, "num_episodes": 22, "episode_return_max": 25121.46578004201, "episode_return_min": 1764.8677394657368, "episode_return_mean": 19836.199422897218}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.7912501370091, "num_env_steps_trained_throughput_per_sec": 500.7912501370091, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7508.366, "restore_workers_time_ms": 0.016, "training_step_time_ms": 7508.32, "sample_time_ms": 824.771, "learn_time_ms": 6671.365, "learn_throughput": 599.577, "synch_weights_time_ms": 11.569}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-09", "timestamp": 1723235409, "time_this_iter_s": 7.990095853805542, "time_total_s": 45.11699295043945, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206b74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45.11699295043945, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.708333333333336, "ram_util_percent": 83.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6560551325164775, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997800886063349, "policy_loss": -0.004568798194033286, "vf_loss": 10.0, "vf_explained_var": -3.022806985037667e-07, "kl": 0.011848400688912502, "entropy": 1.5834891168528764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8093364142812789, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994986841082573, "policy_loss": -0.003418435062970578, "vf_loss": 9.994269349177678, "vf_explained_var": 3.5552680492401124e-05, "kl": 0.01378625060315244, "entropy": 1.5171041319767633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 24771.7201747626, "episode_reward_min": 2252.868768491594, "episode_reward_mean": 20171.04650538066, "episode_len_mean": 190.59, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19059, "policy_reward_min": {"agent_policy": 154.72838192355113, "adversary_policy": 795.4035223784591}, "policy_reward_max": {"agent_policy": 10601.71456248916, "adversary_policy": 12909.121149576235}, "policy_reward_mean": {"agent_policy": 3934.343932482114, "adversary_policy": 8118.351286449271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18607.373108039876, 24241.9135546785, 19735.01831838313, 21385.9644270232, 17334.49887913082, 24054.754295960778, 23063.19781836967, 22547.123013238644, 19609.79411946496, 18409.475986311692, 19705.576220815674, 19950.795865501772, 20280.042819609997, 2987.4345440567563, 21966.27306317704, 24129.069841487188, 21043.082385513742, 24657.376050634284, 22088.605328094112, 23266.810649938227, 18335.46796190954, 19557.150798682203, 17881.194603076638, 20527.289115532647, 15067.66706060145, 18757.71417430089, 21833.683043989466, 18376.129828526955, 20389.771461783876, 23626.55225238632, 23407.507790393825, 19379.075407139168, 20178.22468623799, 21960.34774158172, 19700.148756177827, 16165.162242284765, 22728.75717566481, 20234.813957751063, 23625.752608198833, 20409.746617474113, 17763.72753314284, 24025.699499248058, 23867.899644265475, 20372.932531426464, 16882.65084448732, 22392.81512762063, 21704.35387383642, 19510.61064544061, 16410.90012147365, 19908.761804081907, 22378.569075295007, 21276.852474197112, 21012.13570593744, 23183.74787977652, 7899.445059627439, 20063.363590151326, 21804.9857432228, 20171.429395456635, 22477.37238326204, 24693.250508519748, 18209.110847963966, 20622.32464487332, 24479.51438730467, 20678.30653601458, 18711.949890399486, 2252.868768491594, 19733.770028990584, 19523.561835712848, 11345.829996662183, 20015.41495568175, 9172.730083016982, 15622.746502278804, 20930.109073575517, 24467.538318626466, 22780.671092033008, 19597.403896503067, 18466.940334371502, 21478.475264220346, 23924.26240206431, 20041.300987687504, 23581.820539362066, 19490.024015219402, 19455.08321601427, 20304.124726422866, 19857.865842838153, 20068.121700238986, 20348.350608620935, 24009.281272558423, 22499.095031228244, 18111.00029070937, 19216.545752898186, 22718.58681634883, 24771.7201747626, 23546.305595923557, 22639.49584467474, 22814.16156176799, 18955.74924396299, 24336.59840422529, 22349.640013799155, 16968.409026423877], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 88, 200, 92, 130, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 155], "policy_agent_policy_reward": [3582.9871105990755, 2297.4439914740406, 5605.19484217997, 4355.03658587527, 4878.277818503951, 1936.521785217135, 2886.7082600709355, 2605.9396100140134, 5118.371113299637, 3517.566511177911, 5159.137054288812, 6586.138008225538, 7031.688248437291, 184.14361692312343, 2546.3093156572036, 2643.9055919554253, 2276.2403244815364, 3126.0188494132253, 4904.256252650759, 2396.9741814488825, 5469.70577743757, 7641.248525028334, 3211.3659308231177, 4081.154964176419, 1446.7185804548938, 5931.851327039632, 4551.334228819727, 6779.206419653641, 2747.47272595686, 3782.6058255398275, 3324.722578614691, 5447.032820705579, 4333.934894296043, 3295.811789259452, 3136.8400803037102, 1578.7609487206341, 4378.672863002639, 4840.935500342143, 2547.0019864936057, 3230.8216010847277, 3545.9612976086705, 2023.004608260691, 2456.7974826858144, 2085.922416161866, 7912.866253012625, 4744.698282104752, 3073.3852146101412, 4729.115798939164, 10601.71456248916, 2702.806406122046, 2317.5970599961847, 6235.757307132413, 5726.800461603448, 4441.710566111276, 480.67425150120096, 6755.398439820466, 3821.5273379305086, 7124.411641719443, 2965.3156575839353, 1608.6439236883157, 7768.794649563955, 2556.016968045566, 2673.46474797137, 3830.8083880327654, 7309.910808813948, 154.72838192355113, 5615.375050992065, 4342.962556159641, 921.894636125479, 7510.509373992517, 698.1118224062006, 1549.4870537310187, 4947.9117385814625, 2675.0198744655745, 3736.798154585932, 5210.964971222364, 6291.530090097653, 2575.680591595514, 2512.469963953284, 3791.38353956811, 2492.89716896918, 7481.291266598212, 3301.29790190353, 4044.2157709668645, 3443.825878248809, 5797.907567631879, 7441.265022196324, 2694.9603172887987, 2652.4681851763, 3901.2104936794076, 6559.18889073097, 3369.17391194734, 2123.2914143931207, 2050.7988550888676, 1233.0144741547022, 4698.096874950075, 3667.7922854343, 2228.730514140827, 5387.203492392589, 1441.7721917621418], "policy_adversary_policy_reward": [10559.148513131871, 4465.2374843089265, 11770.718511419858, 10173.7510517846, 5613.320034088046, 8516.503442115123, 9787.099037855685, 7243.828803292259, 3192.363255399864, 9263.857805226995, 10011.256130705578, 12106.97638003806, 9358.442098940744, 10818.047459357962, 10573.26458914911, 9367.91881407551, 5467.658495734036, 9023.764510431329, 4267.340362580701, 10624.569112553028, 5563.440597084744, 8982.998569442138, 7280.202943936403, 6084.45491333981, 7025.529727104957, 6222.824844067783, 795.4035223784591, 2007.887404755174, 8155.329982086165, 11264.633765433646, 10128.859074742146, 11356.30517478965, 11865.895299249425, 6900.94676178278, 10944.986428229662, 10586.37077299138, 9009.322117283922, 8175.0269581593975, 9460.011432318655, 11409.825036170663, 4193.332338178588, 8672.429846293382, 6381.56698226126, 5534.335291392602, 3739.0589793457125, 10930.769692907832, 6385.153491801622, 10060.980659554529, 5451.014836464369, 8169.933643682156, 4615.5785505699805, 8210.284296691312, 8200.62022900717, 9081.728586162522, 7362.929204077302, 4233.994204795989, 11394.662897774087, 6247.635838052943, 9515.491995725972, 10328.454431120532, 10634.960499501563, 9447.824712277568, 8695.102803025371, 5236.939783408245, 9808.200729434908, 6036.089062507026, 10846.323834471485, 7818.212117850774, 5558.01313244686, 11005.295543427228, 8320.733987891026, 6265.667305673068, 9700.996386759123, 8649.087925902983, 9301.20012338881, 6092.678334020123, 11595.133637237344, 9483.61698446789, 6267.610993743157, 10911.314022646218, 3621.5919094118854, 10596.174326122282, 11071.565110342342, 10931.12978064498, 11684.520963510737, 9726.581198068909, 12056.213207569077, 6230.796907695553, 6229.269370718332, 2740.515220756384, 8842.851170903228, 8805.26567461268, 7715.244662234449, 10915.723996991836, 9413.0198247918, 5368.47502170968, 2305.6697733332453, 3503.5157856512483, 5766.626180350946, 11439.329217608902, 8269.196309959068, 11791.775705339789, 7536.701797872029, 7504.39336919262, 6870.000082206474, 8415.335162127505, 9073.274926581555, 9668.762387083701, 4327.651860567322, 3091.118947558916, 5942.841302786975, 7365.1238475438895, 7662.850119491802, 10320.608285800454, 6861.18279491068, 6185.834958826475, 11176.819966147023, 8335.236759531152, 10589.962748930882, 12494.643835900551, 6373.340974167001, 4066.975224233035, 6480.1890211423415, 11586.118655685388, 11398.590938348065, 10407.458700985246, 6536.170912283615, 10311.327235698178, 6832.2248149170055, 4569.814266668612, 909.3658842371538, 1188.7745023308892, 8526.760572738887, 5591.634405259652, 9799.173067571319, 5381.426211981894, 5206.601058814506, 5217.334301722206, 6613.446263982228, 5891.459317707016, 5807.270564510036, 2667.3476961007536, 7294.454812302513, 6778.804636245278, 6817.159868893568, 9165.037466100495, 11352.755953061358, 10439.762491099493, 9059.472662795264, 9984.400274651774, 5455.268272772094, 8931.17065250859, 4324.804710640568, 7850.605533633312, 7336.339640489345, 11566.455032135429, 9962.454873031733, 11449.33756507926, 5899.165363956585, 10350.752084162843, 9506.633089757583, 11582.290280635321, 5373.100358491103, 6635.632390130077, 10840.837721827424, 5312.947592283302, 10097.919852764091, 6161.9891026918995, 5715.730219107233, 10698.309745482142, 8343.913979070827, 5926.300153536256, 6548.683333691349, 6358.402252733241, 11302.67258698634, 10011.648368283297, 8356.959407497247, 11489.667438554661, 3968.864666978438, 10240.925130051535, 7582.946732999987, 5074.410129167289, 8853.990583135785, 10495.422321265713, 10861.095716755144, 11787.333043614311, 9404.169972192618, 12091.336768642093, 12909.121149576235, 8497.360220943785, 9195.452367687392, 8920.612319130503, 10474.343338296656, 4813.613620232018, 11775.901523500945, 10331.966366583516, 8636.708704747807, 8325.72781665882, 9518.382916629345, 6008.253918032357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4263585437069139, "mean_inference_ms": 1.0490836067689722, "mean_action_processing_ms": 0.17455644135362638, "mean_env_wait_ms": 0.05861509541518183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710031509399414, "StateBufferConnector_ms": 0.0024445056915283203, "ViewRequirementAgentConnector_ms": 0.06616902351379395}, "num_episodes": 20, "episode_return_max": 24771.7201747626, "episode_return_min": 2252.868768491594, "episode_return_mean": 20171.04650538066}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 526.6941032555787, "num_env_steps_trained_throughput_per_sec": 526.6941032555787, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7520.678, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7520.633, "sample_time_ms": 818.68, "learn_time_ms": 6689.985, "learn_throughput": 597.909, "synch_weights_time_ms": 11.383}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-17", "timestamp": 1723235417, "time_this_iter_s": 7.598328113555908, "time_total_s": 52.71532106399536, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320739ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.71532106399536, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.936363636363637, "ram_util_percent": 82.53636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.648908494783457, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998335675335435, "policy_loss": -0.0037982569619392356, "vf_loss": 10.0, "vf_explained_var": -7.677645910353888e-07, "kl": 0.01066960829566356, "entropy": 1.5750538035675332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8572066736097137, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.974734629193941, "policy_loss": -0.011021643703376565, "vf_loss": 9.982019325097403, "vf_explained_var": 4.1468627750873564e-05, "kl": 0.01245642102973458, "entropy": 1.4861695669591426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 24792.96910799965, "episode_reward_min": 2252.868768491594, "episode_reward_mean": 20072.989902324818, "episode_len_mean": 190.18, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19018, "policy_reward_min": {"agent_policy": 154.72838192355113, "adversary_policy": 909.3658842371538}, "policy_reward_max": {"agent_policy": 10601.71456248916, "adversary_policy": 12909.121149576235}, "policy_reward_mean": {"agent_policy": 4090.2227718667127, "adversary_policy": 7991.383565229052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18335.46796190954, 19557.150798682203, 17881.194603076638, 20527.289115532647, 15067.66706060145, 18757.71417430089, 21833.683043989466, 18376.129828526955, 20389.771461783876, 23626.55225238632, 23407.507790393825, 19379.075407139168, 20178.22468623799, 21960.34774158172, 19700.148756177827, 16165.162242284765, 22728.75717566481, 20234.813957751063, 23625.752608198833, 20409.746617474113, 17763.72753314284, 24025.699499248058, 23867.899644265475, 20372.932531426464, 16882.65084448732, 22392.81512762063, 21704.35387383642, 19510.61064544061, 16410.90012147365, 19908.761804081907, 22378.569075295007, 21276.852474197112, 21012.13570593744, 23183.74787977652, 7899.445059627439, 20063.363590151326, 21804.9857432228, 20171.429395456635, 22477.37238326204, 24693.250508519748, 18209.110847963966, 20622.32464487332, 24479.51438730467, 20678.30653601458, 18711.949890399486, 2252.868768491594, 19733.770028990584, 19523.561835712848, 11345.829996662183, 20015.41495568175, 9172.730083016982, 15622.746502278804, 20930.109073575517, 24467.538318626466, 22780.671092033008, 19597.403896503067, 18466.940334371502, 21478.475264220346, 23924.26240206431, 20041.300987687504, 23581.820539362066, 19490.024015219402, 19455.08321601427, 20304.124726422866, 19857.865842838153, 20068.121700238986, 20348.350608620935, 24009.281272558423, 22499.095031228244, 18111.00029070937, 19216.545752898186, 22718.58681634883, 24771.7201747626, 23546.305595923557, 22639.49584467474, 22814.16156176799, 18955.74924396299, 24336.59840422529, 22349.640013799155, 16968.409026423877, 17924.512798292155, 21061.26317494891, 19399.18297388763, 18839.32086002622, 21079.506919269457, 19568.157317681987, 23121.865857262266, 22900.359108843048, 21640.211152027692, 21553.786503766936, 22811.53031645655, 24792.96910799965, 18622.067769665162, 17964.172951929977, 17577.969826665725, 22280.256586349253, 6957.7437419699745, 17339.875625623703, 22549.14674190334, 21274.620649276232], "episode_lengths": [200, 200, 200, 200, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 140, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 88, 200, 92, 130, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 155, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 144, 185, 200], "policy_agent_policy_reward": [5469.70577743757, 7641.248525028334, 3211.3659308231177, 4081.154964176419, 1446.7185804548938, 5931.851327039632, 4551.334228819727, 6779.206419653641, 2747.47272595686, 3782.6058255398275, 3324.722578614691, 5447.032820705579, 4333.934894296043, 3295.811789259452, 3136.8400803037102, 1578.7609487206341, 4378.672863002639, 4840.935500342143, 2547.0019864936057, 3230.8216010847277, 3545.9612976086705, 2023.004608260691, 2456.7974826858144, 2085.922416161866, 7912.866253012625, 4744.698282104752, 3073.3852146101412, 4729.115798939164, 10601.71456248916, 2702.806406122046, 2317.5970599961847, 6235.757307132413, 5726.800461603448, 4441.710566111276, 480.67425150120096, 6755.398439820466, 3821.5273379305086, 7124.411641719443, 2965.3156575839353, 1608.6439236883157, 7768.794649563955, 2556.016968045566, 2673.46474797137, 3830.8083880327654, 7309.910808813948, 154.72838192355113, 5615.375050992065, 4342.962556159641, 921.894636125479, 7510.509373992517, 698.1118224062006, 1549.4870537310187, 4947.9117385814625, 2675.0198744655745, 3736.798154585932, 5210.964971222364, 6291.530090097653, 2575.680591595514, 2512.469963953284, 3791.38353956811, 2492.89716896918, 7481.291266598212, 3301.29790190353, 4044.2157709668645, 3443.825878248809, 5797.907567631879, 7441.265022196324, 2694.9603172887987, 2652.4681851763, 3901.2104936794076, 6559.18889073097, 3369.17391194734, 2123.2914143931207, 2050.7988550888676, 1233.0144741547022, 4698.096874950075, 3667.7922854343, 2228.730514140827, 5387.203492392589, 1441.7721917621418, 7255.842231240787, 5917.08293867492, 4565.948724755896, 3437.919099657067, 4834.085088459346, 7707.7270493018905, 3692.7037021845917, 4279.8006060409625, 3669.706646502519, 6103.092412725664, 3498.353599376568, 2882.2637975703574, 7004.88093427768, 8081.19863791065, 5774.68468297673, 2195.551666239487, 280.9092434031773, 1889.474124981271, 2313.6829070243784, 3841.834917049715], "policy_adversary_policy_reward": [4193.332338178588, 8672.429846293382, 6381.56698226126, 5534.335291392602, 3739.0589793457125, 10930.769692907832, 6385.153491801622, 10060.980659554529, 5451.014836464369, 8169.933643682156, 4615.5785505699805, 8210.284296691312, 8200.62022900717, 9081.728586162522, 7362.929204077302, 4233.994204795989, 11394.662897774087, 6247.635838052943, 9515.491995725972, 10328.454431120532, 10634.960499501563, 9447.824712277568, 8695.102803025371, 5236.939783408245, 9808.200729434908, 6036.089062507026, 10846.323834471485, 7818.212117850774, 5558.01313244686, 11005.295543427228, 8320.733987891026, 6265.667305673068, 9700.996386759123, 8649.087925902983, 9301.20012338881, 6092.678334020123, 11595.133637237344, 9483.61698446789, 6267.610993743157, 10911.314022646218, 3621.5919094118854, 10596.174326122282, 11071.565110342342, 10931.12978064498, 11684.520963510737, 9726.581198068909, 12056.213207569077, 6230.796907695553, 6229.269370718332, 2740.515220756384, 8842.851170903228, 8805.26567461268, 7715.244662234449, 10915.723996991836, 9413.0198247918, 5368.47502170968, 2305.6697733332453, 3503.5157856512483, 5766.626180350946, 11439.329217608902, 8269.196309959068, 11791.775705339789, 7536.701797872029, 7504.39336919262, 6870.000082206474, 8415.335162127505, 9073.274926581555, 9668.762387083701, 4327.651860567322, 3091.118947558916, 5942.841302786975, 7365.1238475438895, 7662.850119491802, 10320.608285800454, 6861.18279491068, 6185.834958826475, 11176.819966147023, 8335.236759531152, 10589.962748930882, 12494.643835900551, 6373.340974167001, 4066.975224233035, 6480.1890211423415, 11586.118655685388, 11398.590938348065, 10407.458700985246, 6536.170912283615, 10311.327235698178, 6832.2248149170055, 4569.814266668612, 909.3658842371538, 1188.7745023308892, 8526.760572738887, 5591.634405259652, 9799.173067571319, 5381.426211981894, 5206.601058814506, 5217.334301722206, 6613.446263982228, 5891.459317707016, 5807.270564510036, 2667.3476961007536, 7294.454812302513, 6778.804636245278, 6817.159868893568, 9165.037466100495, 11352.755953061358, 10439.762491099493, 9059.472662795264, 9984.400274651774, 5455.268272772094, 8931.17065250859, 4324.804710640568, 7850.605533633312, 7336.339640489345, 11566.455032135429, 9962.454873031733, 11449.33756507926, 5899.165363956585, 10350.752084162843, 9506.633089757583, 11582.290280635321, 5373.100358491103, 6635.632390130077, 10840.837721827424, 5312.947592283302, 10097.919852764091, 6161.9891026918995, 5715.730219107233, 10698.309745482142, 8343.913979070827, 5926.300153536256, 6548.683333691349, 6358.402252733241, 11302.67258698634, 10011.648368283297, 8356.959407497247, 11489.667438554661, 3968.864666978438, 10240.925130051535, 7582.946732999987, 5074.410129167289, 8853.990583135785, 10495.422321265713, 10861.095716755144, 11787.333043614311, 9404.169972192618, 12091.336768642093, 12909.121149576235, 8497.360220943785, 9195.452367687392, 8920.612319130503, 10474.343338296656, 4813.613620232018, 11775.901523500945, 10331.966366583516, 8636.708704747807, 8325.72781665882, 9518.382916629345, 6008.253918032357, 3782.3771745611843, 6886.29339249017, 7478.350418336485, 7665.82981793748, 5257.04735015666, 9576.18689897507, 10704.216524073887, 4697.185236295274, 9308.05053527161, 6937.37129553849, 5577.281614963174, 6283.1486534169435, 9162.172931412473, 10266.989223665203, 9842.08734354318, 8778.471159258872, 7498.075528296754, 10472.42897722843, 7540.883395580555, 7909.810695460672, 10633.497053208377, 8679.679663871639, 10778.691982139491, 11132.013328289751, 4479.932145934215, 7137.25468945328, 6060.936985820302, 3822.0373281990037, 3435.8342029347978, 8367.450940754208, 11946.58395749147, 8138.120962618327, 2644.3923767320366, 4032.442121834763, 8292.863524105014, 7157.537976537412, 10767.744415299365, 9467.719419579575, 7132.485025545297, 10300.300706681233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4264133560947381, "mean_inference_ms": 1.0456567701905346, "mean_action_processing_ms": 0.17363657144446015, "mean_env_wait_ms": 0.058355993857258585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00435185432434082, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.07141971588134766}, "num_episodes": 20, "episode_return_max": 24792.96910799965, "episode_return_min": 2252.868768491594, "episode_return_mean": 20072.989902324818}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.5446634778318, "num_env_steps_trained_throughput_per_sec": 530.5446634778318, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7523.022, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7522.978, "sample_time_ms": 824.89, "learn_time_ms": 6686.45, "learn_throughput": 598.225, "synch_weights_time_ms": 11.074}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-25", "timestamp": 1723235425, "time_this_iter_s": 7.542140007019043, "time_total_s": 60.257461071014404, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32072c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.257461071014404, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.3, "ram_util_percent": 82.22727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6343175554559344, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9975095572295, "policy_loss": -0.0050268104848102055, "vf_loss": 10.0, "vf_explained_var": -5.822963815517526e-07, "kl": 0.012681974970770104, "entropy": 1.57901243154334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8756406469270587, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.976031915346782, "policy_loss": -0.006668625976211236, "vf_loss": 9.978178055087726, "vf_explained_var": 0.00012217493106921515, "kl": 0.015074960665757923, "entropy": 1.4677449053774276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 24792.96910799965, "episode_reward_min": 2252.868768491594, "episode_reward_mean": 19735.239486285252, "episode_len_mean": 185.33, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18533, "policy_reward_min": {"agent_policy": 71.57776383936606, "adversary_policy": 909.3658842371538}, "policy_reward_max": {"agent_policy": 10601.71456248916, "adversary_policy": 12909.121149576235}, "policy_reward_mean": {"agent_policy": 4040.294199345326, "adversary_policy": 7847.472643469962}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16882.65084448732, 22392.81512762063, 21704.35387383642, 19510.61064544061, 16410.90012147365, 19908.761804081907, 22378.569075295007, 21276.852474197112, 21012.13570593744, 23183.74787977652, 7899.445059627439, 20063.363590151326, 21804.9857432228, 20171.429395456635, 22477.37238326204, 24693.250508519748, 18209.110847963966, 20622.32464487332, 24479.51438730467, 20678.30653601458, 18711.949890399486, 2252.868768491594, 19733.770028990584, 19523.561835712848, 11345.829996662183, 20015.41495568175, 9172.730083016982, 15622.746502278804, 20930.109073575517, 24467.538318626466, 22780.671092033008, 19597.403896503067, 18466.940334371502, 21478.475264220346, 23924.26240206431, 20041.300987687504, 23581.820539362066, 19490.024015219402, 19455.08321601427, 20304.124726422866, 19857.865842838153, 20068.121700238986, 20348.350608620935, 24009.281272558423, 22499.095031228244, 18111.00029070937, 19216.545752898186, 22718.58681634883, 24771.7201747626, 23546.305595923557, 22639.49584467474, 22814.16156176799, 18955.74924396299, 24336.59840422529, 22349.640013799155, 16968.409026423877, 17924.512798292155, 21061.26317494891, 19399.18297388763, 18839.32086002622, 21079.506919269457, 19568.157317681987, 23121.865857262266, 22900.359108843048, 21640.211152027692, 21553.786503766936, 22811.53031645655, 24792.96910799965, 18622.067769665162, 17964.172951929977, 17577.969826665725, 22280.256586349253, 6957.7437419699745, 17339.875625623703, 22549.14674190334, 21274.620649276232, 21502.55805346701, 19872.089304144032, 22814.093149258988, 18772.15368239602, 23288.968596376166, 20714.088781256338, 6491.645387889899, 21935.902850864954, 18614.39025463654, 23156.93555003314, 20396.062447179625, 7903.528647358507, 20817.318908853267, 2281.0225975297594, 19201.305325461217, 24769.167469162, 21068.73969985962, 24478.960070969653, 23871.246786908876, 18285.771017129024, 6437.873165224727, 23087.312861251783, 21287.883339178778, 23348.356941430167], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 68, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 88, 200, 92, 130, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 155, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 144, 185, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 66, 200, 19, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200], "policy_agent_policy_reward": [7912.866253012625, 4744.698282104752, 3073.3852146101412, 4729.115798939164, 10601.71456248916, 2702.806406122046, 2317.5970599961847, 6235.757307132413, 5726.800461603448, 4441.710566111276, 480.67425150120096, 6755.398439820466, 3821.5273379305086, 7124.411641719443, 2965.3156575839353, 1608.6439236883157, 7768.794649563955, 2556.016968045566, 2673.46474797137, 3830.8083880327654, 7309.910808813948, 154.72838192355113, 5615.375050992065, 4342.962556159641, 921.894636125479, 7510.509373992517, 698.1118224062006, 1549.4870537310187, 4947.9117385814625, 2675.0198744655745, 3736.798154585932, 5210.964971222364, 6291.530090097653, 2575.680591595514, 2512.469963953284, 3791.38353956811, 2492.89716896918, 7481.291266598212, 3301.29790190353, 4044.2157709668645, 3443.825878248809, 5797.907567631879, 7441.265022196324, 2694.9603172887987, 2652.4681851763, 3901.2104936794076, 6559.18889073097, 3369.17391194734, 2123.2914143931207, 2050.7988550888676, 1233.0144741547022, 4698.096874950075, 3667.7922854343, 2228.730514140827, 5387.203492392589, 1441.7721917621418, 7255.842231240787, 5917.08293867492, 4565.948724755896, 3437.919099657067, 4834.085088459346, 7707.7270493018905, 3692.7037021845917, 4279.8006060409625, 3669.706646502519, 6103.092412725664, 3498.353599376568, 2882.2637975703574, 7004.88093427768, 8081.19863791065, 5774.68468297673, 2195.551666239487, 280.9092434031773, 1889.474124981271, 2313.6829070243784, 3841.834917049715, 1928.0654345113076, 5993.747312402626, 3491.2984522730826, 4689.341901265424, 3518.4226304245485, 5578.504386376061, 665.0848853736302, 4270.200979233968, 8419.938418303924, 3512.9862201420383, 6522.592852451615, 414.56670581859555, 5038.588397931295, 71.57776383936606, 2342.140787328799, 1493.9859251868224, 5605.740222016402, 1495.7630725516117, 3489.051503106423, 9140.691352923071, 468.46094792399134, 1970.4521544221993, 2600.9650662255685, 4153.860548299263], "policy_adversary_policy_reward": [6229.269370718332, 2740.515220756384, 8842.851170903228, 8805.26567461268, 7715.244662234449, 10915.723996991836, 9413.0198247918, 5368.47502170968, 2305.6697733332453, 3503.5157856512483, 5766.626180350946, 11439.329217608902, 8269.196309959068, 11791.775705339789, 7536.701797872029, 7504.39336919262, 6870.000082206474, 8415.335162127505, 9073.274926581555, 9668.762387083701, 4327.651860567322, 3091.118947558916, 5942.841302786975, 7365.1238475438895, 7662.850119491802, 10320.608285800454, 6861.18279491068, 6185.834958826475, 11176.819966147023, 8335.236759531152, 10589.962748930882, 12494.643835900551, 6373.340974167001, 4066.975224233035, 6480.1890211423415, 11586.118655685388, 11398.590938348065, 10407.458700985246, 6536.170912283615, 10311.327235698178, 6832.2248149170055, 4569.814266668612, 909.3658842371538, 1188.7745023308892, 8526.760572738887, 5591.634405259652, 9799.173067571319, 5381.426211981894, 5206.601058814506, 5217.334301722206, 6613.446263982228, 5891.459317707016, 5807.270564510036, 2667.3476961007536, 7294.454812302513, 6778.804636245278, 6817.159868893568, 9165.037466100495, 11352.755953061358, 10439.762491099493, 9059.472662795264, 9984.400274651774, 5455.268272772094, 8931.17065250859, 4324.804710640568, 7850.605533633312, 7336.339640489345, 11566.455032135429, 9962.454873031733, 11449.33756507926, 5899.165363956585, 10350.752084162843, 9506.633089757583, 11582.290280635321, 5373.100358491103, 6635.632390130077, 10840.837721827424, 5312.947592283302, 10097.919852764091, 6161.9891026918995, 5715.730219107233, 10698.309745482142, 8343.913979070827, 5926.300153536256, 6548.683333691349, 6358.402252733241, 11302.67258698634, 10011.648368283297, 8356.959407497247, 11489.667438554661, 3968.864666978438, 10240.925130051535, 7582.946732999987, 5074.410129167289, 8853.990583135785, 10495.422321265713, 10861.095716755144, 11787.333043614311, 9404.169972192618, 12091.336768642093, 12909.121149576235, 8497.360220943785, 9195.452367687392, 8920.612319130503, 10474.343338296656, 4813.613620232018, 11775.901523500945, 10331.966366583516, 8636.708704747807, 8325.72781665882, 9518.382916629345, 6008.253918032357, 3782.3771745611843, 6886.29339249017, 7478.350418336485, 7665.82981793748, 5257.04735015666, 9576.18689897507, 10704.216524073887, 4697.185236295274, 9308.05053527161, 6937.37129553849, 5577.281614963174, 6283.1486534169435, 9162.172931412473, 10266.989223665203, 9842.08734354318, 8778.471159258872, 7498.075528296754, 10472.42897722843, 7540.883395580555, 7909.810695460672, 10633.497053208377, 8679.679663871639, 10778.691982139491, 11132.013328289751, 4479.932145934215, 7137.25468945328, 6060.936985820302, 3822.0373281990037, 3435.8342029347978, 8367.450940754208, 11946.58395749147, 8138.120962618327, 2644.3923767320366, 4032.442121834763, 8292.863524105014, 7157.537976537412, 10767.744415299365, 9467.719419579575, 7132.485025545297, 10300.300706681233, 12214.070189219638, 7360.422429736071, 8142.296019834637, 5736.045971906762, 8795.040980288137, 10527.753716697775, 9452.793722465527, 4630.018058665083, 9490.875991553412, 10279.669974398186, 6577.351803738225, 8558.232591142021, 3153.291733033727, 2673.2687694825436, 9871.934644496981, 7793.767227134025, 4659.6182423943155, 5534.8335939383205, 9122.318626216793, 10521.63070367434, 7601.639598184387, 6271.829996543639, 4252.338050012619, 3236.6238915272925, 9103.547225799659, 6675.183285122294, 1271.9251204150742, 937.5197132753191, 5059.169701730247, 11799.994836402157, 12636.756268899331, 10638.425275075837, 8536.395401714553, 6926.604076128697, 12620.016027856047, 10363.180970561953, 10131.999837241203, 10250.195446561233, 4672.215891996712, 4472.863772209252, 3208.4943142460556, 2760.917903054679, 8945.177237520813, 12171.68346930874, 7145.747715447867, 11541.170557505378, 9248.197601825928, 9946.29879130503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4284405952127531, "mean_inference_ms": 1.0494739140795957, "mean_action_processing_ms": 0.17379174770483924, "mean_env_wait_ms": 0.058530418245249294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004125356674194336, "StateBufferConnector_ms": 0.0026001930236816406, "ViewRequirementAgentConnector_ms": 0.07126319408416748}, "num_episodes": 24, "episode_return_max": 24792.96910799965, "episode_return_min": 2252.868768491594, "episode_return_mean": 19735.239486285252}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 528.7960524466139, "num_env_steps_trained_throughput_per_sec": 528.7960524466139, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7527.615, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7527.572, "sample_time_ms": 816.122, "learn_time_ms": 6700.019, "learn_throughput": 597.013, "synch_weights_time_ms": 10.881}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-32", "timestamp": 1723235432, "time_this_iter_s": 7.567132949829102, "time_total_s": 67.8245940208435, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320739f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 67.8245940208435, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.827272727272724, "ram_util_percent": 82.26363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6299925766215122, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.006067506093828, "policy_loss": 0.002705795608125824, "vf_loss": 10.0, "vf_explained_var": 5.925143206561054e-07, "kl": 0.01680853055868909, "entropy": 1.5681543226595278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.872614158441623, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.975770383079846, "policy_loss": -0.005962640301731881, "vf_loss": 9.977848424514134, "vf_explained_var": -2.61289378007253e-05, "kl": 0.012948607042199, "entropy": 1.4744874878476064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 24792.96910799965, "episode_reward_min": 2281.0225975297594, "episode_reward_mean": 19576.47079448646, "episode_len_mean": 184.27, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18427, "policy_reward_min": {"agent_policy": 71.57776383936606, "adversary_policy": 937.5197132753191}, "policy_reward_max": {"agent_policy": 9140.691352923071, "adversary_policy": 12909.121149576235}, "policy_reward_mean": {"agent_policy": 4197.352584537294, "adversary_policy": 7689.559104974584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19523.561835712848, 11345.829996662183, 20015.41495568175, 9172.730083016982, 15622.746502278804, 20930.109073575517, 24467.538318626466, 22780.671092033008, 19597.403896503067, 18466.940334371502, 21478.475264220346, 23924.26240206431, 20041.300987687504, 23581.820539362066, 19490.024015219402, 19455.08321601427, 20304.124726422866, 19857.865842838153, 20068.121700238986, 20348.350608620935, 24009.281272558423, 22499.095031228244, 18111.00029070937, 19216.545752898186, 22718.58681634883, 24771.7201747626, 23546.305595923557, 22639.49584467474, 22814.16156176799, 18955.74924396299, 24336.59840422529, 22349.640013799155, 16968.409026423877, 17924.512798292155, 21061.26317494891, 19399.18297388763, 18839.32086002622, 21079.506919269457, 19568.157317681987, 23121.865857262266, 22900.359108843048, 21640.211152027692, 21553.786503766936, 22811.53031645655, 24792.96910799965, 18622.067769665162, 17964.172951929977, 17577.969826665725, 22280.256586349253, 6957.7437419699745, 17339.875625623703, 22549.14674190334, 21274.620649276232, 21502.55805346701, 19872.089304144032, 22814.093149258988, 18772.15368239602, 23288.968596376166, 20714.088781256338, 6491.645387889899, 21935.902850864954, 18614.39025463654, 23156.93555003314, 20396.062447179625, 7903.528647358507, 20817.318908853267, 2281.0225975297594, 19201.305325461217, 24769.167469162, 21068.73969985962, 24478.960070969653, 23871.246786908876, 18285.771017129024, 6437.873165224727, 23087.312861251783, 21287.883339178778, 23348.356941430167, 18256.405985536312, 19516.510259654624, 21844.036783887306, 22496.87705081394, 22474.862024442875, 18751.372335336167, 21757.617136694604, 23288.697824051873, 22947.88560102755, 20384.63907502028, 17352.22658604447, 17931.626315839603, 21487.81155875877, 19191.294677812435, 20335.41341085638, 2421.9342140608223, 21048.64293925128, 18736.809729946774, 17400.819156600024, 11990.910782851526, 20705.67908117907, 22344.955614138922, 7915.19201274053], "episode_lengths": [200, 88, 200, 92, 130, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 155, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 144, 185, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 66, 200, 19, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 95, 200, 200, 67], "policy_agent_policy_reward": [4342.962556159641, 921.894636125479, 7510.509373992517, 698.1118224062006, 1549.4870537310187, 4947.9117385814625, 2675.0198744655745, 3736.798154585932, 5210.964971222364, 6291.530090097653, 2575.680591595514, 2512.469963953284, 3791.38353956811, 2492.89716896918, 7481.291266598212, 3301.29790190353, 4044.2157709668645, 3443.825878248809, 5797.907567631879, 7441.265022196324, 2694.9603172887987, 2652.4681851763, 3901.2104936794076, 6559.18889073097, 3369.17391194734, 2123.2914143931207, 2050.7988550888676, 1233.0144741547022, 4698.096874950075, 3667.7922854343, 2228.730514140827, 5387.203492392589, 1441.7721917621418, 7255.842231240787, 5917.08293867492, 4565.948724755896, 3437.919099657067, 4834.085088459346, 7707.7270493018905, 3692.7037021845917, 4279.8006060409625, 3669.706646502519, 6103.092412725664, 3498.353599376568, 2882.2637975703574, 7004.88093427768, 8081.19863791065, 5774.68468297673, 2195.551666239487, 280.9092434031773, 1889.474124981271, 2313.6829070243784, 3841.834917049715, 1928.0654345113076, 5993.747312402626, 3491.2984522730826, 4689.341901265424, 3518.4226304245485, 5578.504386376061, 665.0848853736302, 4270.200979233968, 8419.938418303924, 3512.9862201420383, 6522.592852451615, 414.56670581859555, 5038.588397931295, 71.57776383936606, 2342.140787328799, 1493.9859251868224, 5605.740222016402, 1495.7630725516117, 3489.051503106423, 9140.691352923071, 468.46094792399134, 1970.4521544221993, 2600.9650662255685, 4153.860548299263, 8624.002531055661, 6826.966036204625, 5479.294983164933, 2218.1122444638095, 4122.214526387649, 8934.67158124344, 5609.06147701185, 3965.3207799479396, 3887.918070367129, 6797.3767013459565, 9043.828019632696, 9123.06131812228, 5783.427115824294, 4220.2640809394825, 7238.01336729606, 164.09660183454795, 5272.008806309693, 6075.37765338048, 8679.71102116656, 609.4346816036833, 6530.126425827553, 1268.8690394119021, 384.2036163629217], "policy_adversary_policy_reward": [9799.173067571319, 5381.426211981894, 5206.601058814506, 5217.334301722206, 6613.446263982228, 5891.459317707016, 5807.270564510036, 2667.3476961007536, 7294.454812302513, 6778.804636245278, 6817.159868893568, 9165.037466100495, 11352.755953061358, 10439.762491099493, 9059.472662795264, 9984.400274651774, 5455.268272772094, 8931.17065250859, 4324.804710640568, 7850.605533633312, 7336.339640489345, 11566.455032135429, 9962.454873031733, 11449.33756507926, 5899.165363956585, 10350.752084162843, 9506.633089757583, 11582.290280635321, 5373.100358491103, 6635.632390130077, 10840.837721827424, 5312.947592283302, 10097.919852764091, 6161.9891026918995, 5715.730219107233, 10698.309745482142, 8343.913979070827, 5926.300153536256, 6548.683333691349, 6358.402252733241, 11302.67258698634, 10011.648368283297, 8356.959407497247, 11489.667438554661, 3968.864666978438, 10240.925130051535, 7582.946732999987, 5074.410129167289, 8853.990583135785, 10495.422321265713, 10861.095716755144, 11787.333043614311, 9404.169972192618, 12091.336768642093, 12909.121149576235, 8497.360220943785, 9195.452367687392, 8920.612319130503, 10474.343338296656, 4813.613620232018, 11775.901523500945, 10331.966366583516, 8636.708704747807, 8325.72781665882, 9518.382916629345, 6008.253918032357, 3782.3771745611843, 6886.29339249017, 7478.350418336485, 7665.82981793748, 5257.04735015666, 9576.18689897507, 10704.216524073887, 4697.185236295274, 9308.05053527161, 6937.37129553849, 5577.281614963174, 6283.1486534169435, 9162.172931412473, 10266.989223665203, 9842.08734354318, 8778.471159258872, 7498.075528296754, 10472.42897722843, 7540.883395580555, 7909.810695460672, 10633.497053208377, 8679.679663871639, 10778.691982139491, 11132.013328289751, 4479.932145934215, 7137.25468945328, 6060.936985820302, 3822.0373281990037, 3435.8342029347978, 8367.450940754208, 11946.58395749147, 8138.120962618327, 2644.3923767320366, 4032.442121834763, 8292.863524105014, 7157.537976537412, 10767.744415299365, 9467.719419579575, 7132.485025545297, 10300.300706681233, 12214.070189219638, 7360.422429736071, 8142.296019834637, 5736.045971906762, 8795.040980288137, 10527.753716697775, 9452.793722465527, 4630.018058665083, 9490.875991553412, 10279.669974398186, 6577.351803738225, 8558.232591142021, 3153.291733033727, 2673.2687694825436, 9871.934644496981, 7793.767227134025, 4659.6182423943155, 5534.8335939383205, 9122.318626216793, 10521.63070367434, 7601.639598184387, 6271.829996543639, 4252.338050012619, 3236.6238915272925, 9103.547225799659, 6675.183285122294, 1271.9251204150742, 937.5197132753191, 5059.169701730247, 11799.994836402157, 12636.756268899331, 10638.425275075837, 8536.395401714553, 6926.604076128697, 12620.016027856047, 10363.180970561953, 10131.999837241203, 10250.195446561233, 4672.215891996712, 4472.863772209252, 3208.4943142460556, 2760.917903054679, 8945.177237520813, 12171.68346930874, 7145.747715447867, 11541.170557505378, 9248.197601825928, 9946.29879130503, 5518.133092675285, 4114.270361805365, 7303.066458397176, 5386.477765052808, 7755.067028895106, 8609.674771827275, 10991.933551570235, 9286.831254779923, 8467.59024466325, 9885.057253391911, 4619.2796867644065, 5197.42106732829, 7631.922655979846, 8516.633003703, 9213.771060028634, 10109.605984075275, 8855.00472327742, 10204.962807383055, 6262.5509872058565, 7324.711386468454, 5096.286917647546, 3212.111648764227, 5008.9971365297015, 3799.5678611876274, 7578.290671913341, 8126.0937710211365, 5049.159054081522, 9921.871542791467, 6389.030467716043, 6708.369575844281, 1250.1169605385473, 1007.7206516877278, 8822.121151072897, 6954.512981868704, 4594.674106215791, 8066.757970350473, 5462.196233754559, 3258.911901678903, 5273.396361579334, 6108.079739668522, 7519.248908597834, 6656.303746753671, 12873.26658431903, 8202.819990407923, 3177.5765787906635, 4353.411817586946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42998715883717104, "mean_inference_ms": 1.0532891094195502, "mean_action_processing_ms": 0.17407269356621996, "mean_env_wait_ms": 0.058927814506352955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004015922546386719, "StateBufferConnector_ms": 0.002629399299621582, "ViewRequirementAgentConnector_ms": 0.07339131832122803}, "num_episodes": 23, "episode_return_max": 24792.96910799965, "episode_return_min": 2281.0225975297594, "episode_return_mean": 19576.47079448646}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.6976740955912, "num_env_steps_trained_throughput_per_sec": 535.6976740955912, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 7521.544, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7521.502, "sample_time_ms": 820.562, "learn_time_ms": 6689.668, "learn_throughput": 597.937, "synch_weights_time_ms": 10.731}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-40", "timestamp": 1723235440, "time_this_iter_s": 7.470121145248413, "time_total_s": 75.29471516609192, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206c3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.29471516609192, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.481818181818184, "ram_util_percent": 81.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6681775322036138, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001134321424697, "policy_loss": -0.0016531573756346626, "vf_loss": 10.0, "vf_explained_var": 1.6022926915890326e-06, "kl": 0.013937314771234043, "entropy": 1.534891526219706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8575403871014714, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99214767018954, "policy_loss": -0.008086924509552774, "vf_loss": 9.996760100126266, "vf_explained_var": -0.0001980499674876531, "kl": 0.011581584564555669, "entropy": 1.4093841741482416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 24913.393129316948, "episode_reward_min": 2281.0225975297594, "episode_reward_mean": 19681.11117505606, "episode_len_mean": 187.17, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 18717, "policy_reward_min": {"agent_policy": 71.57776383936606, "adversary_policy": 937.5197132753191}, "policy_reward_max": {"agent_policy": 10518.225444632708, "adversary_policy": 12909.121149576235}, "policy_reward_mean": {"agent_policy": 4594.047338704296, "adversary_policy": 7543.531918175881}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20348.350608620935, 24009.281272558423, 22499.095031228244, 18111.00029070937, 19216.545752898186, 22718.58681634883, 24771.7201747626, 23546.305595923557, 22639.49584467474, 22814.16156176799, 18955.74924396299, 24336.59840422529, 22349.640013799155, 16968.409026423877, 17924.512798292155, 21061.26317494891, 19399.18297388763, 18839.32086002622, 21079.506919269457, 19568.157317681987, 23121.865857262266, 22900.359108843048, 21640.211152027692, 21553.786503766936, 22811.53031645655, 24792.96910799965, 18622.067769665162, 17964.172951929977, 17577.969826665725, 22280.256586349253, 6957.7437419699745, 17339.875625623703, 22549.14674190334, 21274.620649276232, 21502.55805346701, 19872.089304144032, 22814.093149258988, 18772.15368239602, 23288.968596376166, 20714.088781256338, 6491.645387889899, 21935.902850864954, 18614.39025463654, 23156.93555003314, 20396.062447179625, 7903.528647358507, 20817.318908853267, 2281.0225975297594, 19201.305325461217, 24769.167469162, 21068.73969985962, 24478.960070969653, 23871.246786908876, 18285.771017129024, 6437.873165224727, 23087.312861251783, 21287.883339178778, 23348.356941430167, 18256.405985536312, 19516.510259654624, 21844.036783887306, 22496.87705081394, 22474.862024442875, 18751.372335336167, 21757.617136694604, 23288.697824051873, 22947.88560102755, 20384.63907502028, 17352.22658604447, 17931.626315839603, 21487.81155875877, 19191.294677812435, 20335.41341085638, 2421.9342140608223, 21048.64293925128, 18736.809729946774, 17400.819156600024, 11990.910782851526, 20705.67908117907, 22344.955614138922, 7915.19201274053, 17893.490703551353, 21326.505390529328, 17300.40244413091, 20145.644907699494, 16070.585331640706, 23647.135346096773, 18967.107928731748, 22024.961944754716, 19204.1267966479, 24913.393129316948, 18344.476002045616, 17296.376254477847, 19331.789248304, 24781.018780728486, 19806.90111488483, 19389.085170315437, 24326.761440787133, 19335.110880378827, 16483.190024467647], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 155, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 144, 185, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 66, 200, 19, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 95, 200, 200, 67, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7441.265022196324, 2694.9603172887987, 2652.4681851763, 3901.2104936794076, 6559.18889073097, 3369.17391194734, 2123.2914143931207, 2050.7988550888676, 1233.0144741547022, 4698.096874950075, 3667.7922854343, 2228.730514140827, 5387.203492392589, 1441.7721917621418, 7255.842231240787, 5917.08293867492, 4565.948724755896, 3437.919099657067, 4834.085088459346, 7707.7270493018905, 3692.7037021845917, 4279.8006060409625, 3669.706646502519, 6103.092412725664, 3498.353599376568, 2882.2637975703574, 7004.88093427768, 8081.19863791065, 5774.68468297673, 2195.551666239487, 280.9092434031773, 1889.474124981271, 2313.6829070243784, 3841.834917049715, 1928.0654345113076, 5993.747312402626, 3491.2984522730826, 4689.341901265424, 3518.4226304245485, 5578.504386376061, 665.0848853736302, 4270.200979233968, 8419.938418303924, 3512.9862201420383, 6522.592852451615, 414.56670581859555, 5038.588397931295, 71.57776383936606, 2342.140787328799, 1493.9859251868224, 5605.740222016402, 1495.7630725516117, 3489.051503106423, 9140.691352923071, 468.46094792399134, 1970.4521544221993, 2600.9650662255685, 4153.860548299263, 8624.002531055661, 6826.966036204625, 5479.294983164933, 2218.1122444638095, 4122.214526387649, 8934.67158124344, 5609.06147701185, 3965.3207799479396, 3887.918070367129, 6797.3767013459565, 9043.828019632696, 9123.06131812228, 5783.427115824294, 4220.2640809394825, 7238.01336729606, 164.09660183454795, 5272.008806309693, 6075.37765338048, 8679.71102116656, 609.4346816036833, 6530.126425827553, 1268.8690394119021, 384.2036163629217, 8658.66910594017, 5401.803485551911, 10518.225444632708, 7527.928283148653, 5207.538099528586, 1535.138876595543, 7981.771640821832, 5590.923693434021, 3092.3335613684344, 1691.9280090715756, 7663.288943103026, 9098.183024263644, 6208.79478717324, 2223.8765174994783, 3909.490114480669, 8458.997747400079, 2135.3753584872006, 6659.668951348133, 9431.699693654524], "policy_adversary_policy_reward": [6548.683333691349, 6358.402252733241, 11302.67258698634, 10011.648368283297, 8356.959407497247, 11489.667438554661, 3968.864666978438, 10240.925130051535, 7582.946732999987, 5074.410129167289, 8853.990583135785, 10495.422321265713, 10861.095716755144, 11787.333043614311, 9404.169972192618, 12091.336768642093, 12909.121149576235, 8497.360220943785, 9195.452367687392, 8920.612319130503, 10474.343338296656, 4813.613620232018, 11775.901523500945, 10331.966366583516, 8636.708704747807, 8325.72781665882, 9518.382916629345, 6008.253918032357, 3782.3771745611843, 6886.29339249017, 7478.350418336485, 7665.82981793748, 5257.04735015666, 9576.18689897507, 10704.216524073887, 4697.185236295274, 9308.05053527161, 6937.37129553849, 5577.281614963174, 6283.1486534169435, 9162.172931412473, 10266.989223665203, 9842.08734354318, 8778.471159258872, 7498.075528296754, 10472.42897722843, 7540.883395580555, 7909.810695460672, 10633.497053208377, 8679.679663871639, 10778.691982139491, 11132.013328289751, 4479.932145934215, 7137.25468945328, 6060.936985820302, 3822.0373281990037, 3435.8342029347978, 8367.450940754208, 11946.58395749147, 8138.120962618327, 2644.3923767320366, 4032.442121834763, 8292.863524105014, 7157.537976537412, 10767.744415299365, 9467.719419579575, 7132.485025545297, 10300.300706681233, 12214.070189219638, 7360.422429736071, 8142.296019834637, 5736.045971906762, 8795.040980288137, 10527.753716697775, 9452.793722465527, 4630.018058665083, 9490.875991553412, 10279.669974398186, 6577.351803738225, 8558.232591142021, 3153.291733033727, 2673.2687694825436, 9871.934644496981, 7793.767227134025, 4659.6182423943155, 5534.8335939383205, 9122.318626216793, 10521.63070367434, 7601.639598184387, 6271.829996543639, 4252.338050012619, 3236.6238915272925, 9103.547225799659, 6675.183285122294, 1271.9251204150742, 937.5197132753191, 5059.169701730247, 11799.994836402157, 12636.756268899331, 10638.425275075837, 8536.395401714553, 6926.604076128697, 12620.016027856047, 10363.180970561953, 10131.999837241203, 10250.195446561233, 4672.215891996712, 4472.863772209252, 3208.4943142460556, 2760.917903054679, 8945.177237520813, 12171.68346930874, 7145.747715447867, 11541.170557505378, 9248.197601825928, 9946.29879130503, 5518.133092675285, 4114.270361805365, 7303.066458397176, 5386.477765052808, 7755.067028895106, 8609.674771827275, 10991.933551570235, 9286.831254779923, 8467.59024466325, 9885.057253391911, 4619.2796867644065, 5197.42106732829, 7631.922655979846, 8516.633003703, 9213.771060028634, 10109.605984075275, 8855.00472327742, 10204.962807383055, 6262.5509872058565, 7324.711386468454, 5096.286917647546, 3212.111648764227, 5008.9971365297015, 3799.5678611876274, 7578.290671913341, 8126.0937710211365, 5049.159054081522, 9921.871542791467, 6389.030467716043, 6708.369575844281, 1250.1169605385473, 1007.7206516877278, 8822.121151072897, 6954.512981868704, 4594.674106215791, 8066.757970350473, 5462.196233754559, 3258.911901678903, 5273.396361579334, 6108.079739668522, 7519.248908597834, 6656.303746753671, 12873.26658431903, 8202.819990407923, 3177.5765787906635, 4353.411817586946, 5483.46651779078, 3751.3550798203937, 7195.842642287699, 8728.85926268975, 3324.2446561577412, 3457.9323433404443, 6584.6745821758095, 6033.042042375034, 1928.4497079097564, 8934.59752420237, 12606.996747135407, 9504.99972236585, 6129.042186350917, 4856.294101558993, 8379.942014234532, 8054.09623708615, 11049.802062362513, 5061.991172916974, 12448.998378790337, 10772.466741455099, 4202.340378314675, 6478.8466806279275, 3154.3064752970167, 5043.88675491719, 6672.978778653347, 6450.015682477402, 10779.86942697547, 11777.272836253524, 5664.76549115386, 10232.645509250284, 5651.330277323996, 5278.757145591345, 11856.26118002376, 10335.12490227618, 7482.466672382808, 5192.97525664786, 2444.9250005746926, 4606.565330238379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4277566493110655, "mean_inference_ms": 1.0527289705202163, "mean_action_processing_ms": 0.17401980527558547, "mean_env_wait_ms": 0.05846661757132148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004027366638183594, "StateBufferConnector_ms": 0.002625703811645508, "ViewRequirementAgentConnector_ms": 0.07195127010345459}, "num_episodes": 19, "episode_return_max": 24913.393129316948, "episode_return_min": 2281.0225975297594, "episode_return_mean": 19681.11117505606}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.1047550888622, "num_env_steps_trained_throughput_per_sec": 539.1047550888622, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 7486.185, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7486.144, "sample_time_ms": 801.077, "learn_time_ms": 6673.768, "learn_throughput": 599.362, "synch_weights_time_ms": 10.769}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 11, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-47", "timestamp": 1723235447, "time_this_iter_s": 7.423363208770752, "time_total_s": 82.71807837486267, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206c3e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.71807837486267, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.7, "ram_util_percent": 81.81}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6966456893732939, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000026256319076, "policy_loss": -0.0028145533919866597, "vf_loss": 10.0, "vf_explained_var": -4.868658762129526e-07, "kl": 0.014204134369791342, "entropy": 1.4985845772677628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8226352367860575, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000960517923037, "policy_loss": -0.004666431965112376, "vf_loss": 10.0, "vf_explained_var": -0.000358430544535319, "kl": 0.0187564348714659, "entropy": 1.442605256040891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 24913.393129316948, "episode_reward_min": 2281.0225975297594, "episode_reward_mean": 19489.216993830305, "episode_len_mean": 187.62, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18762, "policy_reward_min": {"agent_policy": 71.57776383936606, "adversary_policy": 937.5197132753191}, "policy_reward_max": {"agent_policy": 10518.225444632708, "adversary_policy": 12873.26658431903}, "policy_reward_mean": {"agent_policy": 4843.858324420198, "adversary_policy": 7322.679334705055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22900.359108843048, 21640.211152027692, 21553.786503766936, 22811.53031645655, 24792.96910799965, 18622.067769665162, 17964.172951929977, 17577.969826665725, 22280.256586349253, 6957.7437419699745, 17339.875625623703, 22549.14674190334, 21274.620649276232, 21502.55805346701, 19872.089304144032, 22814.093149258988, 18772.15368239602, 23288.968596376166, 20714.088781256338, 6491.645387889899, 21935.902850864954, 18614.39025463654, 23156.93555003314, 20396.062447179625, 7903.528647358507, 20817.318908853267, 2281.0225975297594, 19201.305325461217, 24769.167469162, 21068.73969985962, 24478.960070969653, 23871.246786908876, 18285.771017129024, 6437.873165224727, 23087.312861251783, 21287.883339178778, 23348.356941430167, 18256.405985536312, 19516.510259654624, 21844.036783887306, 22496.87705081394, 22474.862024442875, 18751.372335336167, 21757.617136694604, 23288.697824051873, 22947.88560102755, 20384.63907502028, 17352.22658604447, 17931.626315839603, 21487.81155875877, 19191.294677812435, 20335.41341085638, 2421.9342140608223, 21048.64293925128, 18736.809729946774, 17400.819156600024, 11990.910782851526, 20705.67908117907, 22344.955614138922, 7915.19201274053, 17893.490703551353, 21326.505390529328, 17300.40244413091, 20145.644907699494, 16070.585331640706, 23647.135346096773, 18967.107928731748, 22024.961944754716, 19204.1267966479, 24913.393129316948, 18344.476002045616, 17296.376254477847, 19331.789248304, 24781.018780728486, 19806.90111488483, 19389.085170315437, 24326.761440787133, 19335.110880378827, 16483.190024467647, 19040.11736208582, 24175.56410316404, 19983.927515979878, 17699.727102197834, 16874.189372301506, 22591.38381940103, 18862.036034905464, 21807.252835064286, 23434.462206607714, 21754.553210545873, 18087.693585969217, 19898.719968720892, 22792.21570240934, 19211.102212802954, 19171.015968801003, 17968.90353989994, 19124.443092789857, 21663.98988517665, 18470.24930543633, 19417.478696574824, 23060.305895863086], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 61, 144, 185, 200, 200, 200, 200, 200, 200, 200, 54, 200, 200, 200, 200, 66, 200, 19, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 95, 200, 200, 67, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4279.8006060409625, 3669.706646502519, 6103.092412725664, 3498.353599376568, 2882.2637975703574, 7004.88093427768, 8081.19863791065, 5774.68468297673, 2195.551666239487, 280.9092434031773, 1889.474124981271, 2313.6829070243784, 3841.834917049715, 1928.0654345113076, 5993.747312402626, 3491.2984522730826, 4689.341901265424, 3518.4226304245485, 5578.504386376061, 665.0848853736302, 4270.200979233968, 8419.938418303924, 3512.9862201420383, 6522.592852451615, 414.56670581859555, 5038.588397931295, 71.57776383936606, 2342.140787328799, 1493.9859251868224, 5605.740222016402, 1495.7630725516117, 3489.051503106423, 9140.691352923071, 468.46094792399134, 1970.4521544221993, 2600.9650662255685, 4153.860548299263, 8624.002531055661, 6826.966036204625, 5479.294983164933, 2218.1122444638095, 4122.214526387649, 8934.67158124344, 5609.06147701185, 3965.3207799479396, 3887.918070367129, 6797.3767013459565, 9043.828019632696, 9123.06131812228, 5783.427115824294, 4220.2640809394825, 7238.01336729606, 164.09660183454795, 5272.008806309693, 6075.37765338048, 8679.71102116656, 609.4346816036833, 6530.126425827553, 1268.8690394119021, 384.2036163629217, 8658.66910594017, 5401.803485551911, 10518.225444632708, 7527.928283148653, 5207.538099528586, 1535.138876595543, 7981.771640821832, 5590.923693434021, 3092.3335613684344, 1691.9280090715756, 7663.288943103026, 9098.183024263644, 6208.79478717324, 2223.8765174994783, 3909.490114480669, 8458.997747400079, 2135.3753584872006, 6659.668951348133, 9431.699693654524, 7506.620280404464, 1531.1372542906734, 4465.029725151594, 8696.548246061575, 6989.150349431711, 4896.458441108862, 7090.649446246742, 4552.611329047789, 3350.612697462464, 4431.571234823898, 6090.891594077294, 7089.745533173894, 4337.1213195523205, 7203.080378011705, 3533.3470329627426, 5169.415071149497, 8048.322776573045, 3578.0907243780416, 5005.7125269451, 4825.690261189534, 3449.5681071574513], "policy_adversary_policy_reward": [9842.08734354318, 8778.471159258872, 7498.075528296754, 10472.42897722843, 7540.883395580555, 7909.810695460672, 10633.497053208377, 8679.679663871639, 10778.691982139491, 11132.013328289751, 4479.932145934215, 7137.25468945328, 6060.936985820302, 3822.0373281990037, 3435.8342029347978, 8367.450940754208, 11946.58395749147, 8138.120962618327, 2644.3923767320366, 4032.442121834763, 8292.863524105014, 7157.537976537412, 10767.744415299365, 9467.719419579575, 7132.485025545297, 10300.300706681233, 12214.070189219638, 7360.422429736071, 8142.296019834637, 5736.045971906762, 8795.040980288137, 10527.753716697775, 9452.793722465527, 4630.018058665083, 9490.875991553412, 10279.669974398186, 6577.351803738225, 8558.232591142021, 3153.291733033727, 2673.2687694825436, 9871.934644496981, 7793.767227134025, 4659.6182423943155, 5534.8335939383205, 9122.318626216793, 10521.63070367434, 7601.639598184387, 6271.829996543639, 4252.338050012619, 3236.6238915272925, 9103.547225799659, 6675.183285122294, 1271.9251204150742, 937.5197132753191, 5059.169701730247, 11799.994836402157, 12636.756268899331, 10638.425275075837, 8536.395401714553, 6926.604076128697, 12620.016027856047, 10363.180970561953, 10131.999837241203, 10250.195446561233, 4672.215891996712, 4472.863772209252, 3208.4943142460556, 2760.917903054679, 8945.177237520813, 12171.68346930874, 7145.747715447867, 11541.170557505378, 9248.197601825928, 9946.29879130503, 5518.133092675285, 4114.270361805365, 7303.066458397176, 5386.477765052808, 7755.067028895106, 8609.674771827275, 10991.933551570235, 9286.831254779923, 8467.59024466325, 9885.057253391911, 4619.2796867644065, 5197.42106732829, 7631.922655979846, 8516.633003703, 9213.771060028634, 10109.605984075275, 8855.00472327742, 10204.962807383055, 6262.5509872058565, 7324.711386468454, 5096.286917647546, 3212.111648764227, 5008.9971365297015, 3799.5678611876274, 7578.290671913341, 8126.0937710211365, 5049.159054081522, 9921.871542791467, 6389.030467716043, 6708.369575844281, 1250.1169605385473, 1007.7206516877278, 8822.121151072897, 6954.512981868704, 4594.674106215791, 8066.757970350473, 5462.196233754559, 3258.911901678903, 5273.396361579334, 6108.079739668522, 7519.248908597834, 6656.303746753671, 12873.26658431903, 8202.819990407923, 3177.5765787906635, 4353.411817586946, 5483.46651779078, 3751.3550798203937, 7195.842642287699, 8728.85926268975, 3324.2446561577412, 3457.9323433404443, 6584.6745821758095, 6033.042042375034, 1928.4497079097564, 8934.59752420237, 12606.996747135407, 9504.99972236585, 6129.042186350917, 4856.294101558993, 8379.942014234532, 8054.09623708615, 11049.802062362513, 5061.991172916974, 12448.998378790337, 10772.466741455099, 4202.340378314675, 6478.8466806279275, 3154.3064752970167, 5043.88675491719, 6672.978778653347, 6450.015682477402, 10779.86942697547, 11777.272836253524, 5664.76549115386, 10232.645509250284, 5651.330277323996, 5278.757145591345, 11856.26118002376, 10335.12490227618, 7482.466672382808, 5192.97525664786, 2444.9250005746926, 4606.565330238379, 6474.846253784653, 5058.650827896663, 12610.998369440265, 10033.428479433054, 5841.791892248916, 9677.105898579362, 5400.316773862725, 3602.8620822735334, 7152.985274299241, 2732.053748570613, 9051.48205542698, 8643.44332286517, 7051.486177484208, 4719.900411174482, 7672.060751161131, 9582.580754855402, 9612.55118571379, 10471.298323431482, 7612.417586814948, 9710.564388907058, 3945.5579622382634, 8051.244029653655, 5993.709294593612, 6815.265140953386, 9774.13448583203, 8680.959897024979, 6432.771775888626, 5575.2500589026295, 10608.788590768201, 5028.880345070085, 3826.767916168953, 8972.720552581452, 5445.596383052673, 5630.523933164139, 7729.194770362259, 10356.704390436373, 4346.796104736164, 9117.74067375509, 5275.343072843909, 9316.445362541415, 8984.19466636202, 10626.543122343604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.425747844822763, "mean_inference_ms": 1.0505413586306758, "mean_action_processing_ms": 0.17394673906268493, "mean_env_wait_ms": 0.05833250556178667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030927658081054688, "StateBufferConnector_ms": 0.0025326013565063477, "ViewRequirementAgentConnector_ms": 0.06861531734466553}, "num_episodes": 21, "episode_return_max": 24913.393129316948, "episode_return_min": 2281.0225975297594, "episode_return_mean": 19489.216993830305}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.6374870151986, "num_env_steps_trained_throughput_per_sec": 549.6374870151986, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7503.381, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7503.343, "sample_time_ms": 809.368, "learn_time_ms": 6682.974, "learn_throughput": 598.536, "synch_weights_time_ms": 10.488}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 12, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-30-55", "timestamp": 1723235455, "time_this_iter_s": 7.2805070877075195, "time_total_s": 89.99858546257019, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320739f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.99858546257019, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.527272727272727, "ram_util_percent": 82.13636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7066208681574574, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005526299451395, "policy_loss": 0.0021063593982487286, "vf_loss": 10.0, "vf_explained_var": -9.735425313313802e-08, "kl": 0.017099740474470077, "entropy": 1.4673033797551716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8969721330329776, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.968894976377488, "policy_loss": -0.012918330283234051, "vf_loss": 9.975146651268005, "vf_explained_var": -0.000429093341032664, "kl": 0.02222221217525657, "entropy": 1.456744590650002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 25853.933968959936, "episode_reward_min": 2281.0225975297594, "episode_reward_mean": 19050.633375268764, "episode_len_mean": 185.63, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18563, "policy_reward_min": {"agent_policy": 55.17904950707777, "adversary_policy": 937.5197132753191}, "policy_reward_max": {"agent_policy": 10518.225444632708, "adversary_policy": 12873.26658431903}, "policy_reward_mean": {"agent_policy": 5107.818915344342, "adversary_policy": 6971.407229962211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23156.93555003314, 20396.062447179625, 7903.528647358507, 20817.318908853267, 2281.0225975297594, 19201.305325461217, 24769.167469162, 21068.73969985962, 24478.960070969653, 23871.246786908876, 18285.771017129024, 6437.873165224727, 23087.312861251783, 21287.883339178778, 23348.356941430167, 18256.405985536312, 19516.510259654624, 21844.036783887306, 22496.87705081394, 22474.862024442875, 18751.372335336167, 21757.617136694604, 23288.697824051873, 22947.88560102755, 20384.63907502028, 17352.22658604447, 17931.626315839603, 21487.81155875877, 19191.294677812435, 20335.41341085638, 2421.9342140608223, 21048.64293925128, 18736.809729946774, 17400.819156600024, 11990.910782851526, 20705.67908117907, 22344.955614138922, 7915.19201274053, 17893.490703551353, 21326.505390529328, 17300.40244413091, 20145.644907699494, 16070.585331640706, 23647.135346096773, 18967.107928731748, 22024.961944754716, 19204.1267966479, 24913.393129316948, 18344.476002045616, 17296.376254477847, 19331.789248304, 24781.018780728486, 19806.90111488483, 19389.085170315437, 24326.761440787133, 19335.110880378827, 16483.190024467647, 19040.11736208582, 24175.56410316404, 19983.927515979878, 17699.727102197834, 16874.189372301506, 22591.38381940103, 18862.036034905464, 21807.252835064286, 23434.462206607714, 21754.553210545873, 18087.693585969217, 19898.719968720892, 22792.21570240934, 19211.102212802954, 19171.015968801003, 17968.90353989994, 19124.443092789857, 21663.98988517665, 18470.24930543633, 19417.478696574824, 23060.305895863086, 18189.936328501222, 23706.59572633306, 21331.85896728313, 19462.906235002072, 20395.153419558806, 17926.60410687968, 19500.7485907074, 17609.756958735234, 23956.295607883367, 18166.183128190325, 2329.2519399966363, 12353.30746072371, 18710.458714696037, 25853.933968959936, 7357.0301312033325, 18444.43283217052, 16988.28272678636, 17462.091029876057, 18693.017448675884, 11281.140637136134, 21889.852403679746, 16803.399923634224], "episode_lengths": [200, 200, 66, 200, 19, 200, 200, 200, 200, 200, 200, 52, 200, 200, 200, 200, 200, 200, 199, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 95, 200, 200, 67, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 19, 109, 200, 200, 66, 200, 200, 200, 200, 90, 200, 200], "policy_agent_policy_reward": [3512.9862201420383, 6522.592852451615, 414.56670581859555, 5038.588397931295, 71.57776383936606, 2342.140787328799, 1493.9859251868224, 5605.740222016402, 1495.7630725516117, 3489.051503106423, 9140.691352923071, 468.46094792399134, 1970.4521544221993, 2600.9650662255685, 4153.860548299263, 8624.002531055661, 6826.966036204625, 5479.294983164933, 2218.1122444638095, 4122.214526387649, 8934.67158124344, 5609.06147701185, 3965.3207799479396, 3887.918070367129, 6797.3767013459565, 9043.828019632696, 9123.06131812228, 5783.427115824294, 4220.2640809394825, 7238.01336729606, 164.09660183454795, 5272.008806309693, 6075.37765338048, 8679.71102116656, 609.4346816036833, 6530.126425827553, 1268.8690394119021, 384.2036163629217, 8658.66910594017, 5401.803485551911, 10518.225444632708, 7527.928283148653, 5207.538099528586, 1535.138876595543, 7981.771640821832, 5590.923693434021, 3092.3335613684344, 1691.9280090715756, 7663.288943103026, 9098.183024263644, 6208.79478717324, 2223.8765174994783, 3909.490114480669, 8458.997747400079, 2135.3753584872006, 6659.668951348133, 9431.699693654524, 7506.620280404464, 1531.1372542906734, 4465.029725151594, 8696.548246061575, 6989.150349431711, 4896.458441108862, 7090.649446246742, 4552.611329047789, 3350.612697462464, 4431.571234823898, 6090.891594077294, 7089.745533173894, 4337.1213195523205, 7203.080378011705, 3533.3470329627426, 5169.415071149497, 8048.322776573045, 3578.0907243780416, 5005.7125269451, 4825.690261189534, 3449.5681071574513, 8577.917908186264, 2914.7557209431493, 5828.3536183477945, 6305.36834874618, 956.118384119868, 5716.655285634887, 7118.619914240594, 8482.064820458536, 4010.9099139535856, 8104.182680248136, 55.17904950707777, 1667.361086011001, 6548.409575628767, 1719.5795856952116, 788.2952368576015, 8583.793495905657, 9280.907499663825, 5838.261714832857, 7560.353478502316, 1020.9024371845562, 5767.710296882702, 9920.397617107685], "policy_adversary_policy_reward": [9122.318626216793, 10521.63070367434, 7601.639598184387, 6271.829996543639, 4252.338050012619, 3236.6238915272925, 9103.547225799659, 6675.183285122294, 1271.9251204150742, 937.5197132753191, 5059.169701730247, 11799.994836402157, 12636.756268899331, 10638.425275075837, 8536.395401714553, 6926.604076128697, 12620.016027856047, 10363.180970561953, 10131.999837241203, 10250.195446561233, 4672.215891996712, 4472.863772209252, 3208.4943142460556, 2760.917903054679, 8945.177237520813, 12171.68346930874, 7145.747715447867, 11541.170557505378, 9248.197601825928, 9946.29879130503, 5518.133092675285, 4114.270361805365, 7303.066458397176, 5386.477765052808, 7755.067028895106, 8609.674771827275, 10991.933551570235, 9286.831254779923, 8467.59024466325, 9885.057253391911, 4619.2796867644065, 5197.42106732829, 7631.922655979846, 8516.633003703, 9213.771060028634, 10109.605984075275, 8855.00472327742, 10204.962807383055, 6262.5509872058565, 7324.711386468454, 5096.286917647546, 3212.111648764227, 5008.9971365297015, 3799.5678611876274, 7578.290671913341, 8126.0937710211365, 5049.159054081522, 9921.871542791467, 6389.030467716043, 6708.369575844281, 1250.1169605385473, 1007.7206516877278, 8822.121151072897, 6954.512981868704, 4594.674106215791, 8066.757970350473, 5462.196233754559, 3258.911901678903, 5273.396361579334, 6108.079739668522, 7519.248908597834, 6656.303746753671, 12873.26658431903, 8202.819990407923, 3177.5765787906635, 4353.411817586946, 5483.46651779078, 3751.3550798203937, 7195.842642287699, 8728.85926268975, 3324.2446561577412, 3457.9323433404443, 6584.6745821758095, 6033.042042375034, 1928.4497079097564, 8934.59752420237, 12606.996747135407, 9504.99972236585, 6129.042186350917, 4856.294101558993, 8379.942014234532, 8054.09623708615, 11049.802062362513, 5061.991172916974, 12448.998378790337, 10772.466741455099, 4202.340378314675, 6478.8466806279275, 3154.3064752970167, 5043.88675491719, 6672.978778653347, 6450.015682477402, 10779.86942697547, 11777.272836253524, 5664.76549115386, 10232.645509250284, 5651.330277323996, 5278.757145591345, 11856.26118002376, 10335.12490227618, 7482.466672382808, 5192.97525664786, 2444.9250005746926, 4606.565330238379, 6474.846253784653, 5058.650827896663, 12610.998369440265, 10033.428479433054, 5841.791892248916, 9677.105898579362, 5400.316773862725, 3602.8620822735334, 7152.985274299241, 2732.053748570613, 9051.48205542698, 8643.44332286517, 7051.486177484208, 4719.900411174482, 7672.060751161131, 9582.580754855402, 9612.55118571379, 10471.298323431482, 7612.417586814948, 9710.564388907058, 3945.5579622382634, 8051.244029653655, 5993.709294593612, 6815.265140953386, 9774.13448583203, 8680.959897024979, 6432.771775888626, 5575.2500589026295, 10608.788590768201, 5028.880345070085, 3826.767916168953, 8972.720552581452, 5445.596383052673, 5630.523933164139, 7729.194770362259, 10356.704390436373, 4346.796104736164, 9117.74067375509, 5275.343072843909, 9316.445362541415, 8984.19466636202, 10626.543122343604, 4068.9557246002346, 5543.0626957147015, 9883.358819500607, 10908.481185889346, 7972.567933235262, 7530.937415700076, 7836.767274984774, 5320.770611271108, 9996.148763818259, 9442.886271620688, 3784.468483148779, 8425.480338096067, 6891.981527596771, 5490.147148870061, 3493.1684932503545, 5634.523645026356, 9988.923503086284, 9956.462190843498, 4024.0475044593873, 6037.952943482813, 1288.3238347473625, 985.749055742196, 5430.919586276272, 5255.026788436441, 7498.278446537668, 4663.770692529555, 11720.160246171192, 12414.194137093535, 3878.609518973612, 2690.1253753721157, 5017.629692077124, 4843.009644187752, 4861.228124067127, 2846.147103055425, 8303.873908898102, 3319.955406145128, 4577.70298907278, 6554.960981100785, 5319.355889691224, 4940.882310260346, 8088.858942803358, 8033.283163993676, 2796.912129441636, 4086.090177084928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4234620110191024, "mean_inference_ms": 1.0461742167798271, "mean_action_processing_ms": 0.17360171322477455, "mean_env_wait_ms": 0.05809280022088098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003033161163330078, "StateBufferConnector_ms": 0.0024722814559936523, "ViewRequirementAgentConnector_ms": 0.06460082530975342}, "num_episodes": 22, "episode_return_max": 25853.933968959936, "episode_return_min": 2281.0225975297594, "episode_return_mean": 19050.633375268764}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.07859060749837, "num_env_steps_trained_throughput_per_sec": 493.07859060749837, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 7594.843, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7594.806, "sample_time_ms": 808.811, "learn_time_ms": 6774.793, "learn_throughput": 590.424, "synch_weights_time_ms": 10.551}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 13, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-03", "timestamp": 1723235463, "time_this_iter_s": 8.161896228790283, "time_total_s": 98.16048169136047, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32073e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.16048169136047, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.64545454545454, "ram_util_percent": 82.81818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7282497137075379, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00367886931808, "policy_loss": 0.0006430058772109016, "vf_loss": 10.0, "vf_explained_var": 6.442978268577939e-08, "kl": 0.015179288844582896, "entropy": 1.4581525641774373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8389592429623007, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003177935878435, "policy_loss": 0.003803009816328995, "vf_loss": 9.991129688421886, "vf_explained_var": -0.00033603844543298085, "kl": 0.018322799494975093, "entropy": 1.5250230802843967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 26179.001631784933, "episode_reward_min": 487.329685240445, "episode_reward_mean": 19284.94078907785, "episode_len_mean": 187.85, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18785, "policy_reward_min": {"agent_policy": 10.730564745032781, "adversary_policy": 204.4869727658259}, "policy_reward_max": {"agent_policy": 11453.132204202275, "adversary_policy": 12900.776948042212}, "policy_reward_mean": {"agent_policy": 5261.572007289424, "adversary_policy": 7011.684390894214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18751.372335336167, 21757.617136694604, 23288.697824051873, 22947.88560102755, 20384.63907502028, 17352.22658604447, 17931.626315839603, 21487.81155875877, 19191.294677812435, 20335.41341085638, 2421.9342140608223, 21048.64293925128, 18736.809729946774, 17400.819156600024, 11990.910782851526, 20705.67908117907, 22344.955614138922, 7915.19201274053, 17893.490703551353, 21326.505390529328, 17300.40244413091, 20145.644907699494, 16070.585331640706, 23647.135346096773, 18967.107928731748, 22024.961944754716, 19204.1267966479, 24913.393129316948, 18344.476002045616, 17296.376254477847, 19331.789248304, 24781.018780728486, 19806.90111488483, 19389.085170315437, 24326.761440787133, 19335.110880378827, 16483.190024467647, 19040.11736208582, 24175.56410316404, 19983.927515979878, 17699.727102197834, 16874.189372301506, 22591.38381940103, 18862.036034905464, 21807.252835064286, 23434.462206607714, 21754.553210545873, 18087.693585969217, 19898.719968720892, 22792.21570240934, 19211.102212802954, 19171.015968801003, 17968.90353989994, 19124.443092789857, 21663.98988517665, 18470.24930543633, 19417.478696574824, 23060.305895863086, 18189.936328501222, 23706.59572633306, 21331.85896728313, 19462.906235002072, 20395.153419558806, 17926.60410687968, 19500.7485907074, 17609.756958735234, 23956.295607883367, 18166.183128190325, 2329.2519399966363, 12353.30746072371, 18710.458714696037, 25853.933968959936, 7357.0301312033325, 18444.43283217052, 16988.28272678636, 17462.091029876057, 18693.017448675884, 11281.140637136134, 21889.852403679746, 16803.399923634224, 24966.31859322465, 22180.402710522743, 21621.463189407124, 22674.82113416001, 24302.008681350555, 19041.01664969237, 16665.50162729184, 26179.001631784933, 19967.787175654186, 26099.576694695217, 18643.398729183715, 25494.329299869867, 15960.355342854677, 20068.685021010697, 19721.036500042257, 19406.33737228989, 21223.787168413357, 22827.340471497624, 20880.42063458731, 487.329685240445], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 95, 200, 200, 67, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 19, 109, 200, 200, 66, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4], "policy_agent_policy_reward": [8934.67158124344, 5609.06147701185, 3965.3207799479396, 3887.918070367129, 6797.3767013459565, 9043.828019632696, 9123.06131812228, 5783.427115824294, 4220.2640809394825, 7238.01336729606, 164.09660183454795, 5272.008806309693, 6075.37765338048, 8679.71102116656, 609.4346816036833, 6530.126425827553, 1268.8690394119021, 384.2036163629217, 8658.66910594017, 5401.803485551911, 10518.225444632708, 7527.928283148653, 5207.538099528586, 1535.138876595543, 7981.771640821832, 5590.923693434021, 3092.3335613684344, 1691.9280090715756, 7663.288943103026, 9098.183024263644, 6208.79478717324, 2223.8765174994783, 3909.490114480669, 8458.997747400079, 2135.3753584872006, 6659.668951348133, 9431.699693654524, 7506.620280404464, 1531.1372542906734, 4465.029725151594, 8696.548246061575, 6989.150349431711, 4896.458441108862, 7090.649446246742, 4552.611329047789, 3350.612697462464, 4431.571234823898, 6090.891594077294, 7089.745533173894, 4337.1213195523205, 7203.080378011705, 3533.3470329627426, 5169.415071149497, 8048.322776573045, 3578.0907243780416, 5005.7125269451, 4825.690261189534, 3449.5681071574513, 8577.917908186264, 2914.7557209431493, 5828.3536183477945, 6305.36834874618, 956.118384119868, 5716.655285634887, 7118.619914240594, 8482.064820458536, 4010.9099139535856, 8104.182680248136, 55.17904950707777, 1667.361086011001, 6548.409575628767, 1719.5795856952116, 788.2952368576015, 8583.793495905657, 9280.907499663825, 5838.261714832857, 7560.353478502316, 1020.9024371845562, 5767.710296882702, 9920.397617107685, 1687.193639528931, 5782.375943362882, 4073.320589012252, 2105.578091276318, 2481.847964892471, 833.9053689821338, 9999.80914860438, 1586.3218782716679, 7439.207186764147, 1205.696343994278, 7858.8424670944705, 2261.2044435242547, 11453.132204202275, 2540.409883738297, 8037.628743908334, 6426.928994342117, 4988.394680961063, 3395.595449483306, 6799.1994492631875, 10.730564745032781], "policy_adversary_policy_reward": [4619.2796867644065, 5197.42106732829, 7631.922655979846, 8516.633003703, 9213.771060028634, 10109.605984075275, 8855.00472327742, 10204.962807383055, 6262.5509872058565, 7324.711386468454, 5096.286917647546, 3212.111648764227, 5008.9971365297015, 3799.5678611876274, 7578.290671913341, 8126.0937710211365, 5049.159054081522, 9921.871542791467, 6389.030467716043, 6708.369575844281, 1250.1169605385473, 1007.7206516877278, 8822.121151072897, 6954.512981868704, 4594.674106215791, 8066.757970350473, 5462.196233754559, 3258.911901678903, 5273.396361579334, 6108.079739668522, 7519.248908597834, 6656.303746753671, 12873.26658431903, 8202.819990407923, 3177.5765787906635, 4353.411817586946, 5483.46651779078, 3751.3550798203937, 7195.842642287699, 8728.85926268975, 3324.2446561577412, 3457.9323433404443, 6584.6745821758095, 6033.042042375034, 1928.4497079097564, 8934.59752420237, 12606.996747135407, 9504.99972236585, 6129.042186350917, 4856.294101558993, 8379.942014234532, 8054.09623708615, 11049.802062362513, 5061.991172916974, 12448.998378790337, 10772.466741455099, 4202.340378314675, 6478.8466806279275, 3154.3064752970167, 5043.88675491719, 6672.978778653347, 6450.015682477402, 10779.86942697547, 11777.272836253524, 5664.76549115386, 10232.645509250284, 5651.330277323996, 5278.757145591345, 11856.26118002376, 10335.12490227618, 7482.466672382808, 5192.97525664786, 2444.9250005746926, 4606.565330238379, 6474.846253784653, 5058.650827896663, 12610.998369440265, 10033.428479433054, 5841.791892248916, 9677.105898579362, 5400.316773862725, 3602.8620822735334, 7152.985274299241, 2732.053748570613, 9051.48205542698, 8643.44332286517, 7051.486177484208, 4719.900411174482, 7672.060751161131, 9582.580754855402, 9612.55118571379, 10471.298323431482, 7612.417586814948, 9710.564388907058, 3945.5579622382634, 8051.244029653655, 5993.709294593612, 6815.265140953386, 9774.13448583203, 8680.959897024979, 6432.771775888626, 5575.2500589026295, 10608.788590768201, 5028.880345070085, 3826.767916168953, 8972.720552581452, 5445.596383052673, 5630.523933164139, 7729.194770362259, 10356.704390436373, 4346.796104736164, 9117.74067375509, 5275.343072843909, 9316.445362541415, 8984.19466636202, 10626.543122343604, 4068.9557246002346, 5543.0626957147015, 9883.358819500607, 10908.481185889346, 7972.567933235262, 7530.937415700076, 7836.767274984774, 5320.770611271108, 9996.148763818259, 9442.886271620688, 3784.468483148779, 8425.480338096067, 6891.981527596771, 5490.147148870061, 3493.1684932503545, 5634.523645026356, 9988.923503086284, 9956.462190843498, 4024.0475044593873, 6037.952943482813, 1288.3238347473625, 985.749055742196, 5430.919586276272, 5255.026788436441, 7498.278446537668, 4663.770692529555, 11720.160246171192, 12414.194137093535, 3878.609518973612, 2690.1253753721157, 5017.629692077124, 4843.009644187752, 4861.228124067127, 2846.147103055425, 8303.873908898102, 3319.955406145128, 4577.70298907278, 6554.960981100785, 5319.355889691224, 4940.882310260346, 8088.858942803358, 8033.283163993676, 2796.912129441636, 4086.090177084928, 12428.999022333588, 10850.125931362136, 8287.89182289859, 8110.134944261233, 10068.815034718698, 7479.327565676211, 12036.557532454635, 8532.685510429088, 11030.041561683704, 10790.119154774375, 9709.695853947818, 8497.415426762418, 2523.366003560898, 4142.32647512656, 12423.961602365567, 12168.718151147708, 6650.506702379604, 5878.073286510452, 12900.776948042212, 11993.103402658742, 4506.884249945521, 6277.672012143736, 11575.452884071447, 11657.671972274096, 2683.847081258557, 1823.3760573938011, 5926.549397279842, 11601.72573999263, 5696.726943494333, 5986.680812639617, 5264.201748558963, 7715.206629388832, 9153.740942769897, 7081.651544682449, 8691.047875091412, 10740.697146922883, 7287.239952352633, 6793.981232971516, 272.11214772958624, 204.4869727658259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42053820421117116, "mean_inference_ms": 1.0422734601773755, "mean_action_processing_ms": 0.17306490107026282, "mean_env_wait_ms": 0.057538697201307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031070709228515625, "StateBufferConnector_ms": 0.0025360584259033203, "ViewRequirementAgentConnector_ms": 0.06493580341339111}, "num_episodes": 20, "episode_return_max": 26179.001631784933, "episode_return_min": 487.329685240445, "episode_return_mean": 19284.94078907785}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.43340476958133, "num_env_steps_trained_throughput_per_sec": 464.43340476958133, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 7746.6, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7746.563, "sample_time_ms": 812.449, "learn_time_ms": 6922.668, "learn_throughput": 577.812, "synch_weights_time_ms": 10.791}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 14, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-12", "timestamp": 1723235472, "time_this_iter_s": 8.617634057998657, "time_total_s": 106.77811574935913, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32073e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.77811574935913, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.276923076923076, "ram_util_percent": 82.82307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7432276645980814, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005853097905558, "policy_loss": 0.008057388552297005, "vf_loss": 9.993387035591892, "vf_explained_var": 8.680044658600338e-06, "kl": 0.0220434489955623, "entropy": 1.4152637081802206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8787177327709893, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99318185945352, "policy_loss": -0.002321511618598985, "vf_loss": 9.99081862171491, "vf_explained_var": -0.0010323972751696904, "kl": 0.010410520227257318, "entropy": 1.4936025340110064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 26179.001631784933, "episode_reward_min": 139.94290542164683, "episode_reward_mean": 19346.367950928856, "episode_len_mean": 187.47, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18747, "policy_reward_min": {"agent_policy": 0.36549732635209375, "adversary_policy": 69.23222730299207}, "policy_reward_max": {"agent_policy": 11453.132204202275, "adversary_policy": 12900.776948042212}, "policy_reward_mean": {"agent_policy": 5207.395268439668, "adversary_policy": 7069.486341244596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23647.135346096773, 18967.107928731748, 22024.961944754716, 19204.1267966479, 24913.393129316948, 18344.476002045616, 17296.376254477847, 19331.789248304, 24781.018780728486, 19806.90111488483, 19389.085170315437, 24326.761440787133, 19335.110880378827, 16483.190024467647, 19040.11736208582, 24175.56410316404, 19983.927515979878, 17699.727102197834, 16874.189372301506, 22591.38381940103, 18862.036034905464, 21807.252835064286, 23434.462206607714, 21754.553210545873, 18087.693585969217, 19898.719968720892, 22792.21570240934, 19211.102212802954, 19171.015968801003, 17968.90353989994, 19124.443092789857, 21663.98988517665, 18470.24930543633, 19417.478696574824, 23060.305895863086, 18189.936328501222, 23706.59572633306, 21331.85896728313, 19462.906235002072, 20395.153419558806, 17926.60410687968, 19500.7485907074, 17609.756958735234, 23956.295607883367, 18166.183128190325, 2329.2519399966363, 12353.30746072371, 18710.458714696037, 25853.933968959936, 7357.0301312033325, 18444.43283217052, 16988.28272678636, 17462.091029876057, 18693.017448675884, 11281.140637136134, 21889.852403679746, 16803.399923634224, 24966.31859322465, 22180.402710522743, 21621.463189407124, 22674.82113416001, 24302.008681350555, 19041.01664969237, 16665.50162729184, 26179.001631784933, 19967.787175654186, 26099.576694695217, 18643.398729183715, 25494.329299869867, 15960.355342854677, 20068.685021010697, 19721.036500042257, 19406.33737228989, 21223.787168413357, 22827.340471497624, 20880.42063458731, 487.329685240445, 25665.56637415813, 18429.702786998154, 18173.084463934872, 23750.952185528517, 18385.557820618764, 23941.744743262316, 213.83054729583444, 15544.13007121649, 20832.8158584245, 20328.372848175615, 22129.467397852255, 18504.50543481014, 23511.240151388807, 20988.092075825036, 19527.496732766693, 18784.752162151788, 16487.757734421928, 22176.659139561263, 16763.73568758429, 18642.685195844817, 139.94290542164683, 18884.782168719383, 23065.998528902594], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 19, 109, 200, 200, 66, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 2, 141, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200], "policy_agent_policy_reward": [1535.138876595543, 7981.771640821832, 5590.923693434021, 3092.3335613684344, 1691.9280090715756, 7663.288943103026, 9098.183024263644, 6208.79478717324, 2223.8765174994783, 3909.490114480669, 8458.997747400079, 2135.3753584872006, 6659.668951348133, 9431.699693654524, 7506.620280404464, 1531.1372542906734, 4465.029725151594, 8696.548246061575, 6989.150349431711, 4896.458441108862, 7090.649446246742, 4552.611329047789, 3350.612697462464, 4431.571234823898, 6090.891594077294, 7089.745533173894, 4337.1213195523205, 7203.080378011705, 3533.3470329627426, 5169.415071149497, 8048.322776573045, 3578.0907243780416, 5005.7125269451, 4825.690261189534, 3449.5681071574513, 8577.917908186264, 2914.7557209431493, 5828.3536183477945, 6305.36834874618, 956.118384119868, 5716.655285634887, 7118.619914240594, 8482.064820458536, 4010.9099139535856, 8104.182680248136, 55.17904950707777, 1667.361086011001, 6548.409575628767, 1719.5795856952116, 788.2952368576015, 8583.793495905657, 9280.907499663825, 5838.261714832857, 7560.353478502316, 1020.9024371845562, 5767.710296882702, 9920.397617107685, 1687.193639528931, 5782.375943362882, 4073.320589012252, 2105.578091276318, 2481.847964892471, 833.9053689821338, 9999.80914860438, 1586.3218782716679, 7439.207186764147, 1205.696343994278, 7858.8424670944705, 2261.2044435242547, 11453.132204202275, 2540.409883738297, 8037.628743908334, 6426.928994342117, 4988.394680961063, 3395.595449483306, 6799.1994492631875, 10.730564745032781, 1953.4450308758692, 9288.100430646142, 6443.231298123277, 3782.634000160177, 6293.996508831813, 2284.794675095628, 2.5334129718370746, 1203.8386781471543, 6350.559481843633, 6917.568332692607, 4153.3562235278105, 9228.253064097824, 2816.0859813973398, 6330.957023508006, 6350.4257169935445, 8921.632855967708, 10155.97303021723, 5460.565969229747, 8251.763821134333, 8470.479991972503, 0.36549732635209375, 7864.758855675561, 2957.9410110188323], "policy_adversary_policy_reward": [12606.996747135407, 9504.99972236585, 6129.042186350917, 4856.294101558993, 8379.942014234532, 8054.09623708615, 11049.802062362513, 5061.991172916974, 12448.998378790337, 10772.466741455099, 4202.340378314675, 6478.8466806279275, 3154.3064752970167, 5043.88675491719, 6672.978778653347, 6450.015682477402, 10779.86942697547, 11777.272836253524, 5664.76549115386, 10232.645509250284, 5651.330277323996, 5278.757145591345, 11856.26118002376, 10335.12490227618, 7482.466672382808, 5192.97525664786, 2444.9250005746926, 4606.565330238379, 6474.846253784653, 5058.650827896663, 12610.998369440265, 10033.428479433054, 5841.791892248916, 9677.105898579362, 5400.316773862725, 3602.8620822735334, 7152.985274299241, 2732.053748570613, 9051.48205542698, 8643.44332286517, 7051.486177484208, 4719.900411174482, 7672.060751161131, 9582.580754855402, 9612.55118571379, 10471.298323431482, 7612.417586814948, 9710.564388907058, 3945.5579622382634, 8051.244029653655, 5993.709294593612, 6815.265140953386, 9774.13448583203, 8680.959897024979, 6432.771775888626, 5575.2500589026295, 10608.788590768201, 5028.880345070085, 3826.767916168953, 8972.720552581452, 5445.596383052673, 5630.523933164139, 7729.194770362259, 10356.704390436373, 4346.796104736164, 9117.74067375509, 5275.343072843909, 9316.445362541415, 8984.19466636202, 10626.543122343604, 4068.9557246002346, 5543.0626957147015, 9883.358819500607, 10908.481185889346, 7972.567933235262, 7530.937415700076, 7836.767274984774, 5320.770611271108, 9996.148763818259, 9442.886271620688, 3784.468483148779, 8425.480338096067, 6891.981527596771, 5490.147148870061, 3493.1684932503545, 5634.523645026356, 9988.923503086284, 9956.462190843498, 4024.0475044593873, 6037.952943482813, 1288.3238347473625, 985.749055742196, 5430.919586276272, 5255.026788436441, 7498.278446537668, 4663.770692529555, 11720.160246171192, 12414.194137093535, 3878.609518973612, 2690.1253753721157, 5017.629692077124, 4843.009644187752, 4861.228124067127, 2846.147103055425, 8303.873908898102, 3319.955406145128, 4577.70298907278, 6554.960981100785, 5319.355889691224, 4940.882310260346, 8088.858942803358, 8033.283163993676, 2796.912129441636, 4086.090177084928, 12428.999022333588, 10850.125931362136, 8287.89182289859, 8110.134944261233, 10068.815034718698, 7479.327565676211, 12036.557532454635, 8532.685510429088, 11030.041561683704, 10790.119154774375, 9709.695853947818, 8497.415426762418, 2523.366003560898, 4142.32647512656, 12423.961602365567, 12168.718151147708, 6650.506702379604, 5878.073286510452, 12900.776948042212, 11993.103402658742, 4506.884249945521, 6277.672012143736, 11575.452884071447, 11657.671972274096, 2683.847081258557, 1823.3760573938011, 5926.549397279842, 11601.72573999263, 5696.726943494333, 5986.680812639617, 5264.201748558963, 7715.206629388832, 9153.740942769897, 7081.651544682449, 8691.047875091412, 10740.697146922883, 7287.239952352633, 6793.981232971516, 272.11214772958624, 204.4869727658259, 11562.304829570297, 12149.816513712003, 4826.017034061297, 4315.58532229068, 7698.904325607678, 4030.948840203974, 9755.610688232855, 10212.707497135503, 4243.422196887866, 7848.1391148991315, 9846.225146102219, 11810.724922064448, 72.4091910585249, 138.88794326547244, 8766.366936583167, 5573.924456486158, 7019.076668339123, 7463.1797082417725, 6580.76761897067, 6830.036896512323, 7992.454883803884, 9983.656290520536, 4551.419975086282, 4724.832395626038, 10920.963446028798, 9774.19072396267, 7811.178600222941, 6845.956452094051, 5385.361109035747, 7791.709906737416, 4854.947164416998, 5008.172141767069, 3986.1625935137226, 2345.6221106910098, 8414.630174420254, 8301.462995911279, 5890.371802596611, 2621.600063853324, 5671.655631758447, 4500.5495721139105, 70.34518079230266, 69.23222730299207, 6275.234152579872, 4744.78916046397, 9085.183609552962, 11022.873908330756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.417678215143386, "mean_inference_ms": 1.0373425758327353, "mean_action_processing_ms": 0.17252877855046644, "mean_env_wait_ms": 0.05712309713491063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003130316734313965, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06499242782592773}, "num_episodes": 23, "episode_return_max": 26179.001631784933, "episode_return_min": 139.94290542164683, "episode_return_mean": 19346.367950928856}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.54355139233553, "num_env_steps_trained_throughput_per_sec": 507.54355139233553, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 7745.594, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7745.553, "sample_time_ms": 826.853, "learn_time_ms": 6908.065, "learn_throughput": 579.033, "synch_weights_time_ms": 10.056}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 15, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-20", "timestamp": 1723235480, "time_this_iter_s": 7.887542009353638, "time_total_s": 114.66565775871277, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3222563a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.66565775871277, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.718181818181822, "ram_util_percent": 82.72727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7832589705785116, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97805874385531, "policy_loss": 0.001590805249436507, "vf_loss": 9.971540308250953, "vf_explained_var": 6.556920904331106e-06, "kl": 0.016425462865896485, "entropy": 1.3505632941054289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8863275350381931, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97829536497593, "policy_loss": -0.004187039141349184, "vf_loss": 9.977526619036992, "vf_explained_var": -0.0009059435377518336, "kl": 0.011012816438839461, "entropy": 1.5087806769957146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 26179.001631784933, "episode_reward_min": 139.94290542164683, "episode_reward_mean": 18881.04094861869, "episode_len_mean": 183.53, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18353, "policy_reward_min": {"agent_policy": 0.36549732635209375, "adversary_policy": 69.23222730299207}, "policy_reward_max": {"agent_policy": 11465.846158903625, "adversary_policy": 12963.797554241588}, "policy_reward_mean": {"agent_policy": 5186.172197842698, "adversary_policy": 6847.434375387998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23434.462206607714, 21754.553210545873, 18087.693585969217, 19898.719968720892, 22792.21570240934, 19211.102212802954, 19171.015968801003, 17968.90353989994, 19124.443092789857, 21663.98988517665, 18470.24930543633, 19417.478696574824, 23060.305895863086, 18189.936328501222, 23706.59572633306, 21331.85896728313, 19462.906235002072, 20395.153419558806, 17926.60410687968, 19500.7485907074, 17609.756958735234, 23956.295607883367, 18166.183128190325, 2329.2519399966363, 12353.30746072371, 18710.458714696037, 25853.933968959936, 7357.0301312033325, 18444.43283217052, 16988.28272678636, 17462.091029876057, 18693.017448675884, 11281.140637136134, 21889.852403679746, 16803.399923634224, 24966.31859322465, 22180.402710522743, 21621.463189407124, 22674.82113416001, 24302.008681350555, 19041.01664969237, 16665.50162729184, 26179.001631784933, 19967.787175654186, 26099.576694695217, 18643.398729183715, 25494.329299869867, 15960.355342854677, 20068.685021010697, 19721.036500042257, 19406.33737228989, 21223.787168413357, 22827.340471497624, 20880.42063458731, 487.329685240445, 25665.56637415813, 18429.702786998154, 18173.084463934872, 23750.952185528517, 18385.557820618764, 23941.744743262316, 213.83054729583444, 15544.13007121649, 20832.8158584245, 20328.372848175615, 22129.467397852255, 18504.50543481014, 23511.240151388807, 20988.092075825036, 19527.496732766693, 18784.752162151788, 16487.757734421928, 22176.659139561263, 16763.73568758429, 18642.685195844817, 139.94290542164683, 18884.782168719383, 23065.998528902594, 16464.07482249352, 13479.972954484314, 595.2403257938619, 22343.21694599853, 19275.351261234333, 20269.249965959854, 18790.66293806033, 21349.4219255655, 22679.47677597871, 22035.880156937965, 18761.92340627826, 17040.14958693676, 17399.499699872402, 21913.261272157248, 12719.340689462919, 15094.77268177612, 24347.92171757125, 19198.150957724276, 18167.62400175389, 24653.2937059881, 19524.262594547756, 16250.183589445238], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 161, 200, 200, 200, 200, 200, 19, 109, 200, 200, 66, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 2, 141, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 109, 5, 200, 200, 200, 200, 164, 200, 200, 200, 200, 200, 200, 128, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3350.612697462464, 4431.571234823898, 6090.891594077294, 7089.745533173894, 4337.1213195523205, 7203.080378011705, 3533.3470329627426, 5169.415071149497, 8048.322776573045, 3578.0907243780416, 5005.7125269451, 4825.690261189534, 3449.5681071574513, 8577.917908186264, 2914.7557209431493, 5828.3536183477945, 6305.36834874618, 956.118384119868, 5716.655285634887, 7118.619914240594, 8482.064820458536, 4010.9099139535856, 8104.182680248136, 55.17904950707777, 1667.361086011001, 6548.409575628767, 1719.5795856952116, 788.2952368576015, 8583.793495905657, 9280.907499663825, 5838.261714832857, 7560.353478502316, 1020.9024371845562, 5767.710296882702, 9920.397617107685, 1687.193639528931, 5782.375943362882, 4073.320589012252, 2105.578091276318, 2481.847964892471, 833.9053689821338, 9999.80914860438, 1586.3218782716679, 7439.207186764147, 1205.696343994278, 7858.8424670944705, 2261.2044435242547, 11453.132204202275, 2540.409883738297, 8037.628743908334, 6426.928994342117, 4988.394680961063, 3395.595449483306, 6799.1994492631875, 10.730564745032781, 1953.4450308758692, 9288.100430646142, 6443.231298123277, 3782.634000160177, 6293.996508831813, 2284.794675095628, 2.5334129718370746, 1203.8386781471543, 6350.559481843633, 6917.568332692607, 4153.3562235278105, 9228.253064097824, 2816.0859813973398, 6330.957023508006, 6350.4257169935445, 8921.632855967708, 10155.97303021723, 5460.565969229747, 8251.763821134333, 8470.479991972503, 0.36549732635209375, 7864.758855675561, 2957.9410110188323, 9609.38148221563, 981.985512020109, 9.659460081385609, 4996.810904009444, 4872.684125850518, 7102.675453900472, 7037.35949853772, 1445.6374802794653, 4191.59719051361, 4050.1542410558463, 6099.112477195577, 7775.363167958915, 9979.851105864796, 2535.815700461637, 1550.8083955424129, 11465.846158903625, 1178.3380694893688, 5460.2193298495795, 9647.117437966002, 2857.688031952205, 7201.3649006403375, 9237.898806459143], "policy_adversary_policy_reward": [9612.55118571379, 10471.298323431482, 7612.417586814948, 9710.564388907058, 3945.5579622382634, 8051.244029653655, 5993.709294593612, 6815.265140953386, 9774.13448583203, 8680.959897024979, 6432.771775888626, 5575.2500589026295, 10608.788590768201, 5028.880345070085, 3826.767916168953, 8972.720552581452, 5445.596383052673, 5630.523933164139, 7729.194770362259, 10356.704390436373, 4346.796104736164, 9117.74067375509, 5275.343072843909, 9316.445362541415, 8984.19466636202, 10626.543122343604, 4068.9557246002346, 5543.0626957147015, 9883.358819500607, 10908.481185889346, 7972.567933235262, 7530.937415700076, 7836.767274984774, 5320.770611271108, 9996.148763818259, 9442.886271620688, 3784.468483148779, 8425.480338096067, 6891.981527596771, 5490.147148870061, 3493.1684932503545, 5634.523645026356, 9988.923503086284, 9956.462190843498, 4024.0475044593873, 6037.952943482813, 1288.3238347473625, 985.749055742196, 5430.919586276272, 5255.026788436441, 7498.278446537668, 4663.770692529555, 11720.160246171192, 12414.194137093535, 3878.609518973612, 2690.1253753721157, 5017.629692077124, 4843.009644187752, 4861.228124067127, 2846.147103055425, 8303.873908898102, 3319.955406145128, 4577.70298907278, 6554.960981100785, 5319.355889691224, 4940.882310260346, 8088.858942803358, 8033.283163993676, 2796.912129441636, 4086.090177084928, 12428.999022333588, 10850.125931362136, 8287.89182289859, 8110.134944261233, 10068.815034718698, 7479.327565676211, 12036.557532454635, 8532.685510429088, 11030.041561683704, 10790.119154774375, 9709.695853947818, 8497.415426762418, 2523.366003560898, 4142.32647512656, 12423.961602365567, 12168.718151147708, 6650.506702379604, 5878.073286510452, 12900.776948042212, 11993.103402658742, 4506.884249945521, 6277.672012143736, 11575.452884071447, 11657.671972274096, 2683.847081258557, 1823.3760573938011, 5926.549397279842, 11601.72573999263, 5696.726943494333, 5986.680812639617, 5264.201748558963, 7715.206629388832, 9153.740942769897, 7081.651544682449, 8691.047875091412, 10740.697146922883, 7287.239952352633, 6793.981232971516, 272.11214772958624, 204.4869727658259, 11562.304829570297, 12149.816513712003, 4826.017034061297, 4315.58532229068, 7698.904325607678, 4030.948840203974, 9755.610688232855, 10212.707497135503, 4243.422196887866, 7848.1391148991315, 9846.225146102219, 11810.724922064448, 72.4091910585249, 138.88794326547244, 8766.366936583167, 5573.924456486158, 7019.076668339123, 7463.1797082417725, 6580.76761897067, 6830.036896512323, 7992.454883803884, 9983.656290520536, 4551.419975086282, 4724.832395626038, 10920.963446028798, 9774.19072396267, 7811.178600222941, 6845.956452094051, 5385.361109035747, 7791.709906737416, 4854.947164416998, 5008.172141767069, 3986.1625935137226, 2345.6221106910098, 8414.630174420254, 8301.462995911279, 5890.371802596611, 2621.600063853324, 5671.655631758447, 4500.5495721139105, 70.34518079230266, 69.23222730299207, 6275.234152579872, 4744.78916046397, 9085.183609552962, 11022.873908330756, 2336.9209765423807, 4517.77236373549, 6125.541512929228, 6372.445929534948, 241.6869352005881, 343.8939305118882, 8207.895398859391, 9138.510643129672, 5133.215637503433, 9269.451497880438, 6130.801683099367, 7035.772828960027, 7104.03759756139, 4649.265841961201, 9797.868127232565, 10105.91631805348, 9950.53843321734, 8537.341152247802, 10091.981382675112, 7893.744533207027, 4619.787782547317, 8043.023146535372, 6366.772455772033, 2898.0139632057894, 3852.6222122272457, 3567.0263817803993, 11606.319923269308, 7771.125648426319, 7500.158403645395, 3668.37389027511, 975.432643146339, 2653.4938797261416, 10205.786093840243, 12963.797554241588, 5056.015333993323, 8681.916293881375, 4068.634031365527, 4451.872532422382, 11063.431228415406, 10732.17444562054, 6841.468157546646, 5481.429536360807, 4904.236817271821, 2108.047965714274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4157399796864469, "mean_inference_ms": 1.0318750438904762, "mean_action_processing_ms": 0.17175600669844798, "mean_env_wait_ms": 0.05683680552880528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003304123878479004, "StateBufferConnector_ms": 0.002934694290161133, "ViewRequirementAgentConnector_ms": 0.0712895393371582}, "num_episodes": 22, "episode_return_max": 26179.001631784933, "episode_return_min": 139.94290542164683, "episode_return_mean": 18881.04094861869}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.4653906325447, "num_env_steps_trained_throughput_per_sec": 518.4653906325447, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 7718.365, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7718.326, "sample_time_ms": 802.421, "learn_time_ms": 6905.16, "learn_throughput": 579.277, "synch_weights_time_ms": 10.179}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 16, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-28", "timestamp": 1723235488, "time_this_iter_s": 7.719738721847534, "time_total_s": 122.3853964805603, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322256550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 122.3853964805603, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.325, "ram_util_percent": 83.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7676027093930219, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.982820141504682, "policy_loss": 0.0014087167662129832, "vf_loss": 9.978046055950186, "vf_explained_var": 2.6899103134397477e-05, "kl": 0.01121790959504704, "entropy": 1.3243110469409398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9028736104567846, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.979995466272037, "policy_loss": -0.0019903770386008545, "vf_loss": 9.977488744258881, "vf_explained_var": -0.00042962344984213513, "kl": 0.009993516226434926, "entropy": 1.5118253144125144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": 26179.001631784933, "episode_reward_min": 139.94290542164683, "episode_reward_mean": 18348.66333805701, "episode_len_mean": 179.32, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17932, "policy_reward_min": {"agent_policy": 0.36549732635209375, "adversary_policy": 69.23222730299207}, "policy_reward_max": {"agent_policy": 11868.622341020837, "adversary_policy": 12963.797554241588}, "policy_reward_mean": {"agent_policy": 5319.877608149288, "adversary_policy": 6514.392864953867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18166.183128190325, 2329.2519399966363, 12353.30746072371, 18710.458714696037, 25853.933968959936, 7357.0301312033325, 18444.43283217052, 16988.28272678636, 17462.091029876057, 18693.017448675884, 11281.140637136134, 21889.852403679746, 16803.399923634224, 24966.31859322465, 22180.402710522743, 21621.463189407124, 22674.82113416001, 24302.008681350555, 19041.01664969237, 16665.50162729184, 26179.001631784933, 19967.787175654186, 26099.576694695217, 18643.398729183715, 25494.329299869867, 15960.355342854677, 20068.685021010697, 19721.036500042257, 19406.33737228989, 21223.787168413357, 22827.340471497624, 20880.42063458731, 487.329685240445, 25665.56637415813, 18429.702786998154, 18173.084463934872, 23750.952185528517, 18385.557820618764, 23941.744743262316, 213.83054729583444, 15544.13007121649, 20832.8158584245, 20328.372848175615, 22129.467397852255, 18504.50543481014, 23511.240151388807, 20988.092075825036, 19527.496732766693, 18784.752162151788, 16487.757734421928, 22176.659139561263, 16763.73568758429, 18642.685195844817, 139.94290542164683, 18884.782168719383, 23065.998528902594, 16464.07482249352, 13479.972954484314, 595.2403257938619, 22343.21694599853, 19275.351261234333, 20269.249965959854, 18790.66293806033, 21349.4219255655, 22679.47677597871, 22035.880156937965, 18761.92340627826, 17040.14958693676, 17399.499699872402, 21913.261272157248, 12719.340689462919, 15094.77268177612, 24347.92171757125, 19198.150957724276, 18167.62400175389, 24653.2937059881, 19524.262594547756, 16250.183589445238, 18162.168781522563, 20836.363896204322, 20366.38075513778, 22545.345248240297, 18508.761513354537, 24218.887563472796, 17673.085045505384, 19046.15406297277, 4161.60883318722, 20353.376772564858, 18464.926866937858, 15104.963698252925, 2099.052664217745, 16378.250968530168, 22288.878605366208, 23414.504525280987, 15492.878125844998, 15981.466160703887, 16302.13641912848, 19239.75457084812, 19606.974777028943, 22651.308302011057], "episode_lengths": [200, 19, 109, 200, 200, 66, 200, 200, 200, 200, 90, 200, 200, 200, 200, 200, 200, 200, 154, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 2, 141, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 109, 5, 200, 200, 200, 200, 164, 200, 200, 200, 200, 200, 200, 128, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 126, 18, 200, 200, 200, 200, 200, 160, 200, 200, 200], "policy_agent_policy_reward": [8104.182680248136, 55.17904950707777, 1667.361086011001, 6548.409575628767, 1719.5795856952116, 788.2952368576015, 8583.793495905657, 9280.907499663825, 5838.261714832857, 7560.353478502316, 1020.9024371845562, 5767.710296882702, 9920.397617107685, 1687.193639528931, 5782.375943362882, 4073.320589012252, 2105.578091276318, 2481.847964892471, 833.9053689821338, 9999.80914860438, 1586.3218782716679, 7439.207186764147, 1205.696343994278, 7858.8424670944705, 2261.2044435242547, 11453.132204202275, 2540.409883738297, 8037.628743908334, 6426.928994342117, 4988.394680961063, 3395.595449483306, 6799.1994492631875, 10.730564745032781, 1953.4450308758692, 9288.100430646142, 6443.231298123277, 3782.634000160177, 6293.996508831813, 2284.794675095628, 2.5334129718370746, 1203.8386781471543, 6350.559481843633, 6917.568332692607, 4153.3562235278105, 9228.253064097824, 2816.0859813973398, 6330.957023508006, 6350.4257169935445, 8921.632855967708, 10155.97303021723, 5460.565969229747, 8251.763821134333, 8470.479991972503, 0.36549732635209375, 7864.758855675561, 2957.9410110188323, 9609.38148221563, 981.985512020109, 9.659460081385609, 4996.810904009444, 4872.684125850518, 7102.675453900472, 7037.35949853772, 1445.6374802794653, 4191.59719051361, 4050.1542410558463, 6099.112477195577, 7775.363167958915, 9979.851105864796, 2535.815700461637, 1550.8083955424129, 11465.846158903625, 1178.3380694893688, 5460.2193298495795, 9647.117437966002, 2857.688031952205, 7201.3649006403375, 9237.898806459143, 7423.981276060704, 6512.460053154532, 6158.439766127704, 3053.9006112178895, 6076.9537243539735, 2472.4825837760054, 8593.887379377778, 8335.982170091633, 289.2857501482909, 6066.693248471427, 8902.007455132858, 1526.0645231891292, 132.37820595661202, 10394.110973509527, 5312.052711751215, 3006.0504633108053, 11868.622341020837, 11678.715252185142, 2395.398601799533, 8279.935509112629, 6251.431556047657, 4663.640046951046], "policy_adversary_policy_reward": [4024.0475044593873, 6037.952943482813, 1288.3238347473625, 985.749055742196, 5430.919586276272, 5255.026788436441, 7498.278446537668, 4663.770692529555, 11720.160246171192, 12414.194137093535, 3878.609518973612, 2690.1253753721157, 5017.629692077124, 4843.009644187752, 4861.228124067127, 2846.147103055425, 8303.873908898102, 3319.955406145128, 4577.70298907278, 6554.960981100785, 5319.355889691224, 4940.882310260346, 8088.858942803358, 8033.283163993676, 2796.912129441636, 4086.090177084928, 12428.999022333588, 10850.125931362136, 8287.89182289859, 8110.134944261233, 10068.815034718698, 7479.327565676211, 12036.557532454635, 8532.685510429088, 11030.041561683704, 10790.119154774375, 9709.695853947818, 8497.415426762418, 2523.366003560898, 4142.32647512656, 12423.961602365567, 12168.718151147708, 6650.506702379604, 5878.073286510452, 12900.776948042212, 11993.103402658742, 4506.884249945521, 6277.672012143736, 11575.452884071447, 11657.671972274096, 2683.847081258557, 1823.3760573938011, 5926.549397279842, 11601.72573999263, 5696.726943494333, 5986.680812639617, 5264.201748558963, 7715.206629388832, 9153.740942769897, 7081.651544682449, 8691.047875091412, 10740.697146922883, 7287.239952352633, 6793.981232971516, 272.11214772958624, 204.4869727658259, 11562.304829570297, 12149.816513712003, 4826.017034061297, 4315.58532229068, 7698.904325607678, 4030.948840203974, 9755.610688232855, 10212.707497135503, 4243.422196887866, 7848.1391148991315, 9846.225146102219, 11810.724922064448, 72.4091910585249, 138.88794326547244, 8766.366936583167, 5573.924456486158, 7019.076668339123, 7463.1797082417725, 6580.76761897067, 6830.036896512323, 7992.454883803884, 9983.656290520536, 4551.419975086282, 4724.832395626038, 10920.963446028798, 9774.19072396267, 7811.178600222941, 6845.956452094051, 5385.361109035747, 7791.709906737416, 4854.947164416998, 5008.172141767069, 3986.1625935137226, 2345.6221106910098, 8414.630174420254, 8301.462995911279, 5890.371802596611, 2621.600063853324, 5671.655631758447, 4500.5495721139105, 70.34518079230266, 69.23222730299207, 6275.234152579872, 4744.78916046397, 9085.183609552962, 11022.873908330756, 2336.9209765423807, 4517.77236373549, 6125.541512929228, 6372.445929534948, 241.6869352005881, 343.8939305118882, 8207.895398859391, 9138.510643129672, 5133.215637503433, 9269.451497880438, 6130.801683099367, 7035.772828960027, 7104.03759756139, 4649.265841961201, 9797.868127232565, 10105.91631805348, 9950.53843321734, 8537.341152247802, 10091.981382675112, 7893.744533207027, 4619.787782547317, 8043.023146535372, 6366.772455772033, 2898.0139632057894, 3852.6222122272457, 3567.0263817803993, 11606.319923269308, 7771.125648426319, 7500.158403645395, 3668.37389027511, 975.432643146339, 2653.4938797261416, 10205.786093840243, 12963.797554241588, 5056.015333993323, 8681.916293881375, 4068.634031365527, 4451.872532422382, 11063.431228415406, 10732.17444562054, 6841.468157546646, 5481.429536360807, 4904.236817271821, 2108.047965714274, 4020.0331577916613, 6718.154347670243, 6695.631357588895, 7628.272485460872, 6314.48968395707, 7893.451305052997, 11088.235012513076, 8403.209624509389, 8065.1818993769875, 4366.62588962359, 10437.30160115757, 11309.103378539154, 3530.949421774443, 5548.248244353162, 5795.151740194108, 4915.020152687, 1616.0244209156483, 2256.2986621232794, 6211.241148833953, 8075.442375259525, 5225.539791151705, 4337.379620653328, 7195.048657109899, 6383.850517953901, 826.26045808196, 1140.4140001791736, 3541.03786650105, 2443.102128519606, 8443.195087863014, 8533.630805752104, 9459.996658084723, 10948.457403885499, 1371.6996839105407, 2252.5561009136263, 2278.0188692611346, 2024.7320392576257, 8918.309897185229, 4988.427920143711, 5145.027609112687, 5814.791452622837, 5464.839153297997, 7890.7040676832985, 8737.4806438089, 9250.187611251144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4144854979306017, "mean_inference_ms": 1.0275947260378007, "mean_action_processing_ms": 0.17114350157645375, "mean_env_wait_ms": 0.05653802493718535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498077392578125, "StateBufferConnector_ms": 0.0029528141021728516, "ViewRequirementAgentConnector_ms": 0.0732349157333374}, "num_episodes": 22, "episode_return_max": 26179.001631784933, "episode_return_min": 139.94290542164683, "episode_return_mean": 18348.66333805701}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.03606615917977, "num_env_steps_trained_throughput_per_sec": 507.03606615917977, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 7747.81, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7747.771, "sample_time_ms": 797.892, "learn_time_ms": 6938.84, "learn_throughput": 576.465, "synch_weights_time_ms": 10.472}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 17, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-36", "timestamp": 1723235496, "time_this_iter_s": 7.893703937530518, "time_total_s": 130.27910041809082, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207309d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.27910041809082, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.90909090909091, "ram_util_percent": 82.2909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7355251460557892, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993295542903677, "policy_loss": -0.0006433990478476204, "vf_loss": 9.990662395134175, "vf_explained_var": 7.739773503056279e-06, "kl": 0.010921832807017145, "entropy": 1.228775605259749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.873127987080564, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98858128885428, "policy_loss": -0.004883139537802587, "vf_loss": 9.989369164903959, "vf_explained_var": -0.0005407202988862991, "kl": 0.009100551758213745, "entropy": 1.4785482460012038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 26099.576694695217, "episode_reward_min": 139.94290542164683, "episode_reward_mean": 18510.52526804116, "episode_len_mean": 181.96, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18196, "policy_reward_min": {"agent_policy": 0.36549732635209375, "adversary_policy": 69.23222730299207}, "policy_reward_max": {"agent_policy": 11868.622341020837, "adversary_policy": 12963.797554241588}, "policy_reward_mean": {"agent_policy": 5490.1366174419345, "adversary_policy": 6510.194325299617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26099.576694695217, 18643.398729183715, 25494.329299869867, 15960.355342854677, 20068.685021010697, 19721.036500042257, 19406.33737228989, 21223.787168413357, 22827.340471497624, 20880.42063458731, 487.329685240445, 25665.56637415813, 18429.702786998154, 18173.084463934872, 23750.952185528517, 18385.557820618764, 23941.744743262316, 213.83054729583444, 15544.13007121649, 20832.8158584245, 20328.372848175615, 22129.467397852255, 18504.50543481014, 23511.240151388807, 20988.092075825036, 19527.496732766693, 18784.752162151788, 16487.757734421928, 22176.659139561263, 16763.73568758429, 18642.685195844817, 139.94290542164683, 18884.782168719383, 23065.998528902594, 16464.07482249352, 13479.972954484314, 595.2403257938619, 22343.21694599853, 19275.351261234333, 20269.249965959854, 18790.66293806033, 21349.4219255655, 22679.47677597871, 22035.880156937965, 18761.92340627826, 17040.14958693676, 17399.499699872402, 21913.261272157248, 12719.340689462919, 15094.77268177612, 24347.92171757125, 19198.150957724276, 18167.62400175389, 24653.2937059881, 19524.262594547756, 16250.183589445238, 18162.168781522563, 20836.363896204322, 20366.38075513778, 22545.345248240297, 18508.761513354537, 24218.887563472796, 17673.085045505384, 19046.15406297277, 4161.60883318722, 20353.376772564858, 18464.926866937858, 15104.963698252925, 2099.052664217745, 16378.250968530168, 22288.878605366208, 23414.504525280987, 15492.878125844998, 15981.466160703887, 16302.13641912848, 19239.75457084812, 19606.974777028943, 22651.308302011057, 23015.475138538935, 20997.049720898394, 15759.987358954162, 17671.683540775823, 16636.84090863434, 3064.8673383332057, 17682.317483447387, 22621.95028853621, 21143.501298032184, 8985.627004850867, 19239.179997301482, 19911.939823678065, 24476.471577705983, 20642.880021694244, 22213.954235715846, 18323.063343724814, 22599.7433476614, 17988.47512928701, 23928.358632060466, 22668.611018964493, 17206.051639662932, 23338.867888773955], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 2, 141, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 109, 5, 200, 200, 200, 200, 164, 200, 200, 200, 200, 200, 200, 128, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 126, 18, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1205.696343994278, 7858.8424670944705, 2261.2044435242547, 11453.132204202275, 2540.409883738297, 8037.628743908334, 6426.928994342117, 4988.394680961063, 3395.595449483306, 6799.1994492631875, 10.730564745032781, 1953.4450308758692, 9288.100430646142, 6443.231298123277, 3782.634000160177, 6293.996508831813, 2284.794675095628, 2.5334129718370746, 1203.8386781471543, 6350.559481843633, 6917.568332692607, 4153.3562235278105, 9228.253064097824, 2816.0859813973398, 6330.957023508006, 6350.4257169935445, 8921.632855967708, 10155.97303021723, 5460.565969229747, 8251.763821134333, 8470.479991972503, 0.36549732635209375, 7864.758855675561, 2957.9410110188323, 9609.38148221563, 981.985512020109, 9.659460081385609, 4996.810904009444, 4872.684125850518, 7102.675453900472, 7037.35949853772, 1445.6374802794653, 4191.59719051361, 4050.1542410558463, 6099.112477195577, 7775.363167958915, 9979.851105864796, 2535.815700461637, 1550.8083955424129, 11465.846158903625, 1178.3380694893688, 5460.2193298495795, 9647.117437966002, 2857.688031952205, 7201.3649006403375, 9237.898806459143, 7423.981276060704, 6512.460053154532, 6158.439766127704, 3053.9006112178895, 6076.9537243539735, 2472.4825837760054, 8593.887379377778, 8335.982170091633, 289.2857501482909, 6066.693248471427, 8902.007455132858, 1526.0645231891292, 132.37820595661202, 10394.110973509527, 5312.052711751215, 3006.0504633108053, 11868.622341020837, 11678.715252185142, 2395.398601799533, 8279.935509112629, 6251.431556047657, 4663.640046951046, 3345.379159105349, 6120.4624666348045, 11146.566581481577, 7669.410327785378, 10601.034829568682, 328.526219327475, 7682.449231515996, 3410.6368629997996, 4196.666410943524, 906.7845775944826, 7202.67293581487, 7374.123791879715, 2274.1439610802768, 4661.753571411584, 5432.707944967584, 7449.063198203738, 3685.219254807852, 5308.267871707101, 3715.7081455070634, 4488.824871852643, 10626.495836025957, 2243.89644377175], "policy_adversary_policy_reward": [12900.776948042212, 11993.103402658742, 4506.884249945521, 6277.672012143736, 11575.452884071447, 11657.671972274096, 2683.847081258557, 1823.3760573938011, 5926.549397279842, 11601.72573999263, 5696.726943494333, 5986.680812639617, 5264.201748558963, 7715.206629388832, 9153.740942769897, 7081.651544682449, 8691.047875091412, 10740.697146922883, 7287.239952352633, 6793.981232971516, 272.11214772958624, 204.4869727658259, 11562.304829570297, 12149.816513712003, 4826.017034061297, 4315.58532229068, 7698.904325607678, 4030.948840203974, 9755.610688232855, 10212.707497135503, 4243.422196887866, 7848.1391148991315, 9846.225146102219, 11810.724922064448, 72.4091910585249, 138.88794326547244, 8766.366936583167, 5573.924456486158, 7019.076668339123, 7463.1797082417725, 6580.76761897067, 6830.036896512323, 7992.454883803884, 9983.656290520536, 4551.419975086282, 4724.832395626038, 10920.963446028798, 9774.19072396267, 7811.178600222941, 6845.956452094051, 5385.361109035747, 7791.709906737416, 4854.947164416998, 5008.172141767069, 3986.1625935137226, 2345.6221106910098, 8414.630174420254, 8301.462995911279, 5890.371802596611, 2621.600063853324, 5671.655631758447, 4500.5495721139105, 70.34518079230266, 69.23222730299207, 6275.234152579872, 4744.78916046397, 9085.183609552962, 11022.873908330756, 2336.9209765423807, 4517.77236373549, 6125.541512929228, 6372.445929534948, 241.6869352005881, 343.8939305118882, 8207.895398859391, 9138.510643129672, 5133.215637503433, 9269.451497880438, 6130.801683099367, 7035.772828960027, 7104.03759756139, 4649.265841961201, 9797.868127232565, 10105.91631805348, 9950.53843321734, 8537.341152247802, 10091.981382675112, 7893.744533207027, 4619.787782547317, 8043.023146535372, 6366.772455772033, 2898.0139632057894, 3852.6222122272457, 3567.0263817803993, 11606.319923269308, 7771.125648426319, 7500.158403645395, 3668.37389027511, 975.432643146339, 2653.4938797261416, 10205.786093840243, 12963.797554241588, 5056.015333993323, 8681.916293881375, 4068.634031365527, 4451.872532422382, 11063.431228415406, 10732.17444562054, 6841.468157546646, 5481.429536360807, 4904.236817271821, 2108.047965714274, 4020.0331577916613, 6718.154347670243, 6695.631357588895, 7628.272485460872, 6314.48968395707, 7893.451305052997, 11088.235012513076, 8403.209624509389, 8065.1818993769875, 4366.62588962359, 10437.30160115757, 11309.103378539154, 3530.949421774443, 5548.248244353162, 5795.151740194108, 4915.020152687, 1616.0244209156483, 2256.2986621232794, 6211.241148833953, 8075.442375259525, 5225.539791151705, 4337.379620653328, 7195.048657109899, 6383.850517953901, 826.26045808196, 1140.4140001791736, 3541.03786650105, 2443.102128519606, 8443.195087863014, 8533.630805752104, 9459.996658084723, 10948.457403885499, 1371.6996839105407, 2252.5561009136263, 2278.0188692611346, 2024.7320392576257, 8918.309897185229, 4988.427920143711, 5145.027609112687, 5814.791452622837, 5464.839153297997, 7890.7040676832985, 8737.4806438089, 9250.187611251144, 8880.951616274757, 10789.144363158814, 7941.098686710526, 6935.488567553018, 2995.569042249378, 1617.8517352232166, 4679.323923386877, 5322.949289603561, 2500.303138709374, 3535.5029403563008, 1722.0834461135128, 1014.2576728922172, 6406.624068455357, 3593.2441834760352, 10138.115739408388, 9073.197686128095, 9942.713959616642, 7004.120927472029, 4231.644821133191, 3847.1976061231917, 6921.07346382028, 5115.433597666327, 5769.977871883706, 6767.838159914662, 11861.605012238942, 10340.722604386749, 6500.744397963283, 9480.382052319366, 8082.610222395986, 8698.636068352282, 4188.5463520721105, 6685.453793448928, 10287.981564309608, 8626.542528543943, 3846.339505556031, 8833.867752023842, 9790.057914307463, 10422.592572245938, 9587.347573553783, 8592.43857355808, 3511.4790158658584, 3068.076787771138, 11861.319023470236, 9233.652421531884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4133216113700773, "mean_inference_ms": 1.0244595889631853, "mean_action_processing_ms": 0.17079944738723907, "mean_env_wait_ms": 0.05625423977264862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003585338592529297, "StateBufferConnector_ms": 0.002995014190673828, "ViewRequirementAgentConnector_ms": 0.07490122318267822}, "num_episodes": 22, "episode_return_max": 26099.576694695217, "episode_return_min": 139.94290542164683, "episode_return_mean": 18510.52526804116}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.19636712987, "num_env_steps_trained_throughput_per_sec": 523.19636712987, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 7758.399, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7758.36, "sample_time_ms": 788.731, "learn_time_ms": 6958.185, "learn_throughput": 574.863, "synch_weights_time_ms": 10.832}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 18, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-44", "timestamp": 1723235504, "time_this_iter_s": 7.650496006011963, "time_total_s": 137.92959642410278, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3222568b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 137.92959642410278, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.609090909090913, "ram_util_percent": 81.87272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7322535570730608, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987956987108504, "policy_loss": -0.0028028619314282737, "vf_loss": 9.987852703578888, "vf_explained_var": 4.57763671875e-06, "kl": 0.009690450203836595, "entropy": 1.1144039442930271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8550035438500345, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9982783695062, "policy_loss": -0.005968160519842058, "vf_loss": 10.0, "vf_explained_var": -0.00042720710237820946, "kl": 0.009436668380415843, "entropy": 1.48944453385969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 24653.2937059881, "episode_reward_min": 139.94290542164683, "episode_reward_mean": 18833.168406604025, "episode_len_mean": 186.49, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18649, "policy_reward_min": {"agent_policy": 0.36549732635209375, "adversary_policy": 69.23222730299207}, "policy_reward_max": {"agent_policy": 11868.622341020837, "adversary_policy": 12963.797554241588}, "policy_reward_mean": {"agent_policy": 5660.586893568251, "adversary_policy": 6586.290756517889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22129.467397852255, 18504.50543481014, 23511.240151388807, 20988.092075825036, 19527.496732766693, 18784.752162151788, 16487.757734421928, 22176.659139561263, 16763.73568758429, 18642.685195844817, 139.94290542164683, 18884.782168719383, 23065.998528902594, 16464.07482249352, 13479.972954484314, 595.2403257938619, 22343.21694599853, 19275.351261234333, 20269.249965959854, 18790.66293806033, 21349.4219255655, 22679.47677597871, 22035.880156937965, 18761.92340627826, 17040.14958693676, 17399.499699872402, 21913.261272157248, 12719.340689462919, 15094.77268177612, 24347.92171757125, 19198.150957724276, 18167.62400175389, 24653.2937059881, 19524.262594547756, 16250.183589445238, 18162.168781522563, 20836.363896204322, 20366.38075513778, 22545.345248240297, 18508.761513354537, 24218.887563472796, 17673.085045505384, 19046.15406297277, 4161.60883318722, 20353.376772564858, 18464.926866937858, 15104.963698252925, 2099.052664217745, 16378.250968530168, 22288.878605366208, 23414.504525280987, 15492.878125844998, 15981.466160703887, 16302.13641912848, 19239.75457084812, 19606.974777028943, 22651.308302011057, 23015.475138538935, 20997.049720898394, 15759.987358954162, 17671.683540775823, 16636.84090863434, 3064.8673383332057, 17682.317483447387, 22621.95028853621, 21143.501298032184, 8985.627004850867, 19239.179997301482, 19911.939823678065, 24476.471577705983, 20642.880021694244, 22213.954235715846, 18323.063343724814, 22599.7433476614, 17988.47512928701, 23928.358632060466, 22668.611018964493, 17206.051639662932, 23338.867888773955, 17225.52851468864, 22179.671786339644, 21298.412481962616, 23660.224039811124, 21120.050515656654, 16994.490595230996, 17776.331462056027, 19378.633604257357, 21342.330614471117, 19365.298089978987, 20965.619057181142, 22475.756247709698, 22238.39579037186, 18615.232524315506, 23481.02849746937, 17116.50622191743, 18444.05333839019, 21275.34490124422, 19063.05883528705, 22982.487476472816, 21344.213880772353], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 109, 5, 200, 200, 200, 200, 164, 200, 200, 200, 200, 200, 200, 128, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 126, 18, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4153.3562235278105, 9228.253064097824, 2816.0859813973398, 6330.957023508006, 6350.4257169935445, 8921.632855967708, 10155.97303021723, 5460.565969229747, 8251.763821134333, 8470.479991972503, 0.36549732635209375, 7864.758855675561, 2957.9410110188323, 9609.38148221563, 981.985512020109, 9.659460081385609, 4996.810904009444, 4872.684125850518, 7102.675453900472, 7037.35949853772, 1445.6374802794653, 4191.59719051361, 4050.1542410558463, 6099.112477195577, 7775.363167958915, 9979.851105864796, 2535.815700461637, 1550.8083955424129, 11465.846158903625, 1178.3380694893688, 5460.2193298495795, 9647.117437966002, 2857.688031952205, 7201.3649006403375, 9237.898806459143, 7423.981276060704, 6512.460053154532, 6158.439766127704, 3053.9006112178895, 6076.9537243539735, 2472.4825837760054, 8593.887379377778, 8335.982170091633, 289.2857501482909, 6066.693248471427, 8902.007455132858, 1526.0645231891292, 132.37820595661202, 10394.110973509527, 5312.052711751215, 3006.0504633108053, 11868.622341020837, 11678.715252185142, 2395.398601799533, 8279.935509112629, 6251.431556047657, 4663.640046951046, 3345.379159105349, 6120.4624666348045, 11146.566581481577, 7669.410327785378, 10601.034829568682, 328.526219327475, 7682.449231515996, 3410.6368629997996, 4196.666410943524, 906.7845775944826, 7202.67293581487, 7374.123791879715, 2274.1439610802768, 4661.753571411584, 5432.707944967584, 7449.063198203738, 3685.219254807852, 5308.267871707101, 3715.7081455070634, 4488.824871852643, 10626.495836025957, 2243.89644377175, 7624.318740423429, 4771.9729558134995, 6392.126414678335, 3171.71960124436, 6381.912297971414, 9748.873980914886, 8904.941789467524, 7687.68595215967, 2247.693869198744, 7377.395986849773, 4046.0005870827717, 2189.732113146666, 4138.811319576, 7607.586878718891, 1990.1332010261588, 9219.563288396797, 5330.713703892769, 3215.0605166315845, 7901.486075028244, 3290.025935991384, 3305.737479063486], "policy_adversary_policy_reward": [7992.454883803884, 9983.656290520536, 4551.419975086282, 4724.832395626038, 10920.963446028798, 9774.19072396267, 7811.178600222941, 6845.956452094051, 5385.361109035747, 7791.709906737416, 4854.947164416998, 5008.172141767069, 3986.1625935137226, 2345.6221106910098, 8414.630174420254, 8301.462995911279, 5890.371802596611, 2621.600063853324, 5671.655631758447, 4500.5495721139105, 70.34518079230266, 69.23222730299207, 6275.234152579872, 4744.78916046397, 9085.183609552962, 11022.873908330756, 2336.9209765423807, 4517.77236373549, 6125.541512929228, 6372.445929534948, 241.6869352005881, 343.8939305118882, 8207.895398859391, 9138.510643129672, 5133.215637503433, 9269.451497880438, 6130.801683099367, 7035.772828960027, 7104.03759756139, 4649.265841961201, 9797.868127232565, 10105.91631805348, 9950.53843321734, 8537.341152247802, 10091.981382675112, 7893.744533207027, 4619.787782547317, 8043.023146535372, 6366.772455772033, 2898.0139632057894, 3852.6222122272457, 3567.0263817803993, 11606.319923269308, 7771.125648426319, 7500.158403645395, 3668.37389027511, 975.432643146339, 2653.4938797261416, 10205.786093840243, 12963.797554241588, 5056.015333993323, 8681.916293881375, 4068.634031365527, 4451.872532422382, 11063.431228415406, 10732.17444562054, 6841.468157546646, 5481.429536360807, 4904.236817271821, 2108.047965714274, 4020.0331577916613, 6718.154347670243, 6695.631357588895, 7628.272485460872, 6314.48968395707, 7893.451305052997, 11088.235012513076, 8403.209624509389, 8065.1818993769875, 4366.62588962359, 10437.30160115757, 11309.103378539154, 3530.949421774443, 5548.248244353162, 5795.151740194108, 4915.020152687, 1616.0244209156483, 2256.2986621232794, 6211.241148833953, 8075.442375259525, 5225.539791151705, 4337.379620653328, 7195.048657109899, 6383.850517953901, 826.26045808196, 1140.4140001791736, 3541.03786650105, 2443.102128519606, 8443.195087863014, 8533.630805752104, 9459.996658084723, 10948.457403885499, 1371.6996839105407, 2252.5561009136263, 2278.0188692611346, 2024.7320392576257, 8918.309897185229, 4988.427920143711, 5145.027609112687, 5814.791452622837, 5464.839153297997, 7890.7040676832985, 8737.4806438089, 9250.187611251144, 8880.951616274757, 10789.144363158814, 7941.098686710526, 6935.488567553018, 2995.569042249378, 1617.8517352232166, 4679.323923386877, 5322.949289603561, 2500.303138709374, 3535.5029403563008, 1722.0834461135128, 1014.2576728922172, 6406.624068455357, 3593.2441834760352, 10138.115739408388, 9073.197686128095, 9942.713959616642, 7004.120927472029, 4231.644821133191, 3847.1976061231917, 6921.07346382028, 5115.433597666327, 5769.977871883706, 6767.838159914662, 11861.605012238942, 10340.722604386749, 6500.744397963283, 9480.382052319366, 8082.610222395986, 8698.636068352282, 4188.5463520721105, 6685.453793448928, 10287.981564309608, 8626.542528543943, 3846.339505556031, 8833.867752023842, 9790.057914307463, 10422.592572245938, 9587.347573553783, 8592.43857355808, 3511.4790158658584, 3068.076787771138, 11861.319023470236, 9233.652421531884, 6517.816883307517, 3083.392890957667, 8037.536162608756, 9370.162667917457, 7683.7469063376075, 7222.539160946634, 10866.599887011753, 9621.904551554997, 7605.704022973649, 7132.434194711562, 4232.24866343255, 3013.3679508835544, 5237.193834263433, 3634.195838325088, 5254.633425466456, 6436.3142266313325, 11845.628771037875, 7249.007974234531, 5681.362872778614, 6306.5392303505905, 6823.483433450187, 10096.13503664817, 11892.1727341323, 8393.85140043074, 9924.74381686837, 8174.840653927415, 4481.228929629152, 6526.416715967456, 9948.679920772372, 11542.215375670856, 4903.7630526865805, 2993.1798808340695, 8811.42191983818, 4301.917714659194, 10927.075107099357, 7133.209277513287, 6240.649548702711, 4920.923211556068, 9490.089569178233, 10202.3719713032, 10780.821911569034, 7257.654490139835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41236870535285797, "mean_inference_ms": 1.0213729341600655, "mean_action_processing_ms": 0.17041980649619737, "mean_env_wait_ms": 0.05605225231000249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035829544067382812, "StateBufferConnector_ms": 0.0029120445251464844, "ViewRequirementAgentConnector_ms": 0.07371330261230469}, "num_episodes": 21, "episode_return_max": 24653.2937059881, "episode_return_min": 139.94290542164683, "episode_return_mean": 18833.168406604025}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.5389993637812, "num_env_steps_trained_throughput_per_sec": 533.5389993637812, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 7751.674, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7751.636, "sample_time_ms": 788.167, "learn_time_ms": 6951.804, "learn_throughput": 575.39, "synch_weights_time_ms": 11.058}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 19, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-51", "timestamp": 1723235511, "time_this_iter_s": 7.522274017333984, "time_total_s": 145.45187044143677, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322256940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.45187044143677, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.75454545454545, "ram_util_percent": 81.25454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7849839409901982, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.969695888499103, "policy_loss": -0.004201927539404659, "vf_loss": 9.972211107627425, "vf_explained_var": 3.7598231482127355e-07, "kl": 0.005622404831752339, "entropy": 1.0952475471471352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8687162788584828, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.986121481657028, "policy_loss": -0.0065318190769176, "vf_loss": 9.988525692621867, "vf_explained_var": -0.00020423146585623423, "kl": 0.009172493281463781, "entropy": 1.4260506770263115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 24653.2937059881, "episode_reward_min": 2099.052664217745, "episode_reward_mean": 18936.663195812234, "episode_len_mean": 189.13, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18913, "policy_reward_min": {"agent_policy": 132.37820595661202, "adversary_policy": 826.26045808196}, "policy_reward_max": {"agent_policy": 12598.818294112483, "adversary_policy": 12963.797554241588}, "policy_reward_mean": {"agent_policy": 5916.687158862993, "adversary_policy": 6509.988018474625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22679.47677597871, 22035.880156937965, 18761.92340627826, 17040.14958693676, 17399.499699872402, 21913.261272157248, 12719.340689462919, 15094.77268177612, 24347.92171757125, 19198.150957724276, 18167.62400175389, 24653.2937059881, 19524.262594547756, 16250.183589445238, 18162.168781522563, 20836.363896204322, 20366.38075513778, 22545.345248240297, 18508.761513354537, 24218.887563472796, 17673.085045505384, 19046.15406297277, 4161.60883318722, 20353.376772564858, 18464.926866937858, 15104.963698252925, 2099.052664217745, 16378.250968530168, 22288.878605366208, 23414.504525280987, 15492.878125844998, 15981.466160703887, 16302.13641912848, 19239.75457084812, 19606.974777028943, 22651.308302011057, 23015.475138538935, 20997.049720898394, 15759.987358954162, 17671.683540775823, 16636.84090863434, 3064.8673383332057, 17682.317483447387, 22621.95028853621, 21143.501298032184, 8985.627004850867, 19239.179997301482, 19911.939823678065, 24476.471577705983, 20642.880021694244, 22213.954235715846, 18323.063343724814, 22599.7433476614, 17988.47512928701, 23928.358632060466, 22668.611018964493, 17206.051639662932, 23338.867888773955, 17225.52851468864, 22179.671786339644, 21298.412481962616, 23660.224039811124, 21120.050515656654, 16994.490595230996, 17776.331462056027, 19378.633604257357, 21342.330614471117, 19365.298089978987, 20965.619057181142, 22475.756247709698, 22238.39579037186, 18615.232524315506, 23481.02849746937, 17116.50622191743, 18444.05333839019, 21275.34490124422, 19063.05883528705, 22982.487476472816, 21344.213880772353, 22468.383750515397, 22033.15344992511, 22703.072928797326, 13896.55637495073, 20268.084690156513, 16748.430592649907, 17902.755782553308, 14991.215689525758, 19286.276311127756, 20379.35118288533, 18026.711208233806, 21226.703873246468, 19086.81901437186, 18949.573755173264, 17345.224658233525, 19661.5639258969, 3800.1852100216242, 18296.33468999948, 17071.111121334838, 20120.812792068147, 18261.464373994815], "episode_lengths": [200, 200, 200, 200, 200, 200, 128, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 126, 18, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 109, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200], "policy_agent_policy_reward": [4191.59719051361, 4050.1542410558463, 6099.112477195577, 7775.363167958915, 9979.851105864796, 2535.815700461637, 1550.8083955424129, 11465.846158903625, 1178.3380694893688, 5460.2193298495795, 9647.117437966002, 2857.688031952205, 7201.3649006403375, 9237.898806459143, 7423.981276060704, 6512.460053154532, 6158.439766127704, 3053.9006112178895, 6076.9537243539735, 2472.4825837760054, 8593.887379377778, 8335.982170091633, 289.2857501482909, 6066.693248471427, 8902.007455132858, 1526.0645231891292, 132.37820595661202, 10394.110973509527, 5312.052711751215, 3006.0504633108053, 11868.622341020837, 11678.715252185142, 2395.398601799533, 8279.935509112629, 6251.431556047657, 4663.640046951046, 3345.379159105349, 6120.4624666348045, 11146.566581481577, 7669.410327785378, 10601.034829568682, 328.526219327475, 7682.449231515996, 3410.6368629997996, 4196.666410943524, 906.7845775944826, 7202.67293581487, 7374.123791879715, 2274.1439610802768, 4661.753571411584, 5432.707944967584, 7449.063198203738, 3685.219254807852, 5308.267871707101, 3715.7081455070634, 4488.824871852643, 10626.495836025957, 2243.89644377175, 7624.318740423429, 4771.9729558134995, 6392.126414678335, 3171.71960124436, 6381.912297971414, 9748.873980914886, 8904.941789467524, 7687.68595215967, 2247.693869198744, 7377.395986849773, 4046.0005870827717, 2189.732113146666, 4138.811319576, 7607.586878718891, 1990.1332010261588, 9219.563288396797, 5330.713703892769, 3215.0605166315845, 7901.486075028244, 3290.025935991384, 3305.737479063486, 5191.407508856661, 5524.025938810858, 1680.831617801633, 1027.646012671281, 7307.497709608106, 9188.000286797109, 7829.3993448286865, 12598.818294112483, 8641.172546944637, 7632.395600629957, 8584.526332802223, 6289.184432496358, 5687.909210036859, 6642.30386410323, 9114.54833487438, 7697.4982837771, 295.4949627962951, 9803.833669981925, 8749.042431665877, 6091.280765290246, 7051.962339549676], "policy_adversary_policy_reward": [9950.53843321734, 8537.341152247802, 10091.981382675112, 7893.744533207027, 4619.787782547317, 8043.023146535372, 6366.772455772033, 2898.0139632057894, 3852.6222122272457, 3567.0263817803993, 11606.319923269308, 7771.125648426319, 7500.158403645395, 3668.37389027511, 975.432643146339, 2653.4938797261416, 10205.786093840243, 12963.797554241588, 5056.015333993323, 8681.916293881375, 4068.634031365527, 4451.872532422382, 11063.431228415406, 10732.17444562054, 6841.468157546646, 5481.429536360807, 4904.236817271821, 2108.047965714274, 4020.0331577916613, 6718.154347670243, 6695.631357588895, 7628.272485460872, 6314.48968395707, 7893.451305052997, 11088.235012513076, 8403.209624509389, 8065.1818993769875, 4366.62588962359, 10437.30160115757, 11309.103378539154, 3530.949421774443, 5548.248244353162, 5795.151740194108, 4915.020152687, 1616.0244209156483, 2256.2986621232794, 6211.241148833953, 8075.442375259525, 5225.539791151705, 4337.379620653328, 7195.048657109899, 6383.850517953901, 826.26045808196, 1140.4140001791736, 3541.03786650105, 2443.102128519606, 8443.195087863014, 8533.630805752104, 9459.996658084723, 10948.457403885499, 1371.6996839105407, 2252.5561009136263, 2278.0188692611346, 2024.7320392576257, 8918.309897185229, 4988.427920143711, 5145.027609112687, 5814.791452622837, 5464.839153297997, 7890.7040676832985, 8737.4806438089, 9250.187611251144, 8880.951616274757, 10789.144363158814, 7941.098686710526, 6935.488567553018, 2995.569042249378, 1617.8517352232166, 4679.323923386877, 5322.949289603561, 2500.303138709374, 3535.5029403563008, 1722.0834461135128, 1014.2576728922172, 6406.624068455357, 3593.2441834760352, 10138.115739408388, 9073.197686128095, 9942.713959616642, 7004.120927472029, 4231.644821133191, 3847.1976061231917, 6921.07346382028, 5115.433597666327, 5769.977871883706, 6767.838159914662, 11861.605012238942, 10340.722604386749, 6500.744397963283, 9480.382052319366, 8082.610222395986, 8698.636068352282, 4188.5463520721105, 6685.453793448928, 10287.981564309608, 8626.542528543943, 3846.339505556031, 8833.867752023842, 9790.057914307463, 10422.592572245938, 9587.347573553783, 8592.43857355808, 3511.4790158658584, 3068.076787771138, 11861.319023470236, 9233.652421531884, 6517.816883307517, 3083.392890957667, 8037.536162608756, 9370.162667917457, 7683.7469063376075, 7222.539160946634, 10866.599887011753, 9621.904551554997, 7605.704022973649, 7132.434194711562, 4232.24866343255, 3013.3679508835544, 5237.193834263433, 3634.195838325088, 5254.633425466456, 6436.3142266313325, 11845.628771037875, 7249.007974234531, 5681.362872778614, 6306.5392303505905, 6823.483433450187, 10096.13503664817, 11892.1727341323, 8393.85140043074, 9924.74381686837, 8174.840653927415, 4481.228929629152, 6526.416715967456, 9948.679920772372, 11542.215375670856, 4903.7630526865805, 2993.1798808340695, 8811.42191983818, 4301.917714659194, 10927.075107099357, 7133.209277513287, 6240.649548702711, 4920.923211556068, 9490.089569178233, 10202.3719713032, 10780.821911569034, 7257.654490139835, 8367.5634935415, 8909.412748117187, 8601.703062539937, 7907.4244485743475, 12126.111255826532, 8896.130055169171, 6284.3360445934295, 6584.574317686024, 6207.526924207858, 6753.060056340529, 4836.660883446289, 2723.7694224065144, 3760.620158822352, 6312.736278902271, 1536.8332746548626, 855.5641207584143, 5494.3549120108655, 5150.7488521722435, 6267.8205213348765, 6479.135060920522, 5553.7154666312545, 3888.469408800309, 7832.813843234388, 7104.705597515772, 4944.683390640946, 8454.226413694103, 6234.9954163174825, 6072.27447475254, 5027.587288856569, 3203.0890345025946, 5532.432653607867, 6431.632988511921, 2108.668093237967, 1396.022153987364, 4222.866115416739, 4269.63490460082, 4242.595155026496, 4079.473534642473, 8050.8548584407035, 5978.67716833715, 4119.328750263781, 7090.17328418128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41138679296318836, "mean_inference_ms": 1.017396532273382, "mean_action_processing_ms": 0.16992014791644594, "mean_env_wait_ms": 0.055841793631804304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506898880004883, "StateBufferConnector_ms": 0.0028150081634521484, "ViewRequirementAgentConnector_ms": 0.07196295261383057}, "num_episodes": 21, "episode_return_max": 24653.2937059881, "episode_return_min": 2099.052664217745, "episode_return_mean": 18936.663195812234}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.0745512176627, "num_env_steps_trained_throughput_per_sec": 533.0745512176627, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 7755.349, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7755.309, "sample_time_ms": 773.476, "learn_time_ms": 6969.985, "learn_throughput": 573.889, "synch_weights_time_ms": 11.241}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 20, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-31-59", "timestamp": 1723235519, "time_this_iter_s": 7.507657051086426, "time_total_s": 152.9595274925232, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322256c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.9595274925232, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.718181818181822, "ram_util_percent": 81.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.721584514382655, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99810198173321, "policy_loss": -0.0035506569196484864, "vf_loss": 10.0, "vf_explained_var": 6.875033101076802e-09, "kl": 0.005508818947734735, "entropy": 1.0540127910634198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8436018242500722, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994893789291382, "policy_loss": -0.00461791586955466, "vf_loss": 9.994178439180056, "vf_explained_var": -0.0003002908080816269, "kl": 0.011851740991793728, "entropy": 1.464809730152289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": 25428.06466460086, "episode_reward_min": 1866.116593670646, "episode_reward_mean": 18893.998449778814, "episode_len_mean": 188.04, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18804, "policy_reward_min": {"agent_policy": 117.88448998137916, "adversary_policy": 522.6137094162056}, "policy_reward_max": {"agent_policy": 12598.818294112483, "adversary_policy": 12126.111255826532}, "policy_reward_mean": {"agent_policy": 5969.3753372233805, "adversary_policy": 6462.31155627772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17673.085045505384, 19046.15406297277, 4161.60883318722, 20353.376772564858, 18464.926866937858, 15104.963698252925, 2099.052664217745, 16378.250968530168, 22288.878605366208, 23414.504525280987, 15492.878125844998, 15981.466160703887, 16302.13641912848, 19239.75457084812, 19606.974777028943, 22651.308302011057, 23015.475138538935, 20997.049720898394, 15759.987358954162, 17671.683540775823, 16636.84090863434, 3064.8673383332057, 17682.317483447387, 22621.95028853621, 21143.501298032184, 8985.627004850867, 19239.179997301482, 19911.939823678065, 24476.471577705983, 20642.880021694244, 22213.954235715846, 18323.063343724814, 22599.7433476614, 17988.47512928701, 23928.358632060466, 22668.611018964493, 17206.051639662932, 23338.867888773955, 17225.52851468864, 22179.671786339644, 21298.412481962616, 23660.224039811124, 21120.050515656654, 16994.490595230996, 17776.331462056027, 19378.633604257357, 21342.330614471117, 19365.298089978987, 20965.619057181142, 22475.756247709698, 22238.39579037186, 18615.232524315506, 23481.02849746937, 17116.50622191743, 18444.05333839019, 21275.34490124422, 19063.05883528705, 22982.487476472816, 21344.213880772353, 22468.383750515397, 22033.15344992511, 22703.072928797326, 13896.55637495073, 20268.084690156513, 16748.430592649907, 17902.755782553308, 14991.215689525758, 19286.276311127756, 20379.35118288533, 18026.711208233806, 21226.703873246468, 19086.81901437186, 18949.573755173264, 17345.224658233525, 19661.5639258969, 3800.1852100216242, 18296.33468999948, 17071.111121334838, 20120.812792068147, 18261.464373994815, 17139.43703114602, 22699.519482316256, 19165.35911176785, 17818.847824393615, 20572.030648895317, 23200.107147586026, 21061.715339159084, 21653.531236809762, 22313.69878932482, 19158.74991045061, 21202.538473329303, 17338.42255687779, 19578.34425407419, 19126.89566549929, 17015.029489092885, 25011.093749723783, 21704.634955308946, 17103.037066993944, 25428.06466460086, 1866.116593670646], "episode_lengths": [200, 200, 36, 200, 200, 126, 18, 200, 200, 200, 200, 200, 160, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 109, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19], "policy_agent_policy_reward": [8593.887379377778, 8335.982170091633, 289.2857501482909, 6066.693248471427, 8902.007455132858, 1526.0645231891292, 132.37820595661202, 10394.110973509527, 5312.052711751215, 3006.0504633108053, 11868.622341020837, 11678.715252185142, 2395.398601799533, 8279.935509112629, 6251.431556047657, 4663.640046951046, 3345.379159105349, 6120.4624666348045, 11146.566581481577, 7669.410327785378, 10601.034829568682, 328.526219327475, 7682.449231515996, 3410.6368629997996, 4196.666410943524, 906.7845775944826, 7202.67293581487, 7374.123791879715, 2274.1439610802768, 4661.753571411584, 5432.707944967584, 7449.063198203738, 3685.219254807852, 5308.267871707101, 3715.7081455070634, 4488.824871852643, 10626.495836025957, 2243.89644377175, 7624.318740423429, 4771.9729558134995, 6392.126414678335, 3171.71960124436, 6381.912297971414, 9748.873980914886, 8904.941789467524, 7687.68595215967, 2247.693869198744, 7377.395986849773, 4046.0005870827717, 2189.732113146666, 4138.811319576, 7607.586878718891, 1990.1332010261588, 9219.563288396797, 5330.713703892769, 3215.0605166315845, 7901.486075028244, 3290.025935991384, 3305.737479063486, 5191.407508856661, 5524.025938810858, 1680.831617801633, 1027.646012671281, 7307.497709608106, 9188.000286797109, 7829.3993448286865, 12598.818294112483, 8641.172546944637, 7632.395600629957, 8584.526332802223, 6289.184432496358, 5687.909210036859, 6642.30386410323, 9114.54833487438, 7697.4982837771, 295.4949627962951, 9803.833669981925, 8749.042431665877, 6091.280765290246, 7051.962339549676, 8815.634196659892, 4484.197379860569, 6772.738658101043, 10285.035187783069, 7369.41479015083, 4256.088058867428, 6494.099158209321, 5948.704609530333, 3949.670412026429, 8077.271013213478, 5340.249193780089, 8762.871161672138, 4974.982599172883, 8399.95160839029, 7449.430347538677, 2407.3364464607416, 5867.796298591148, 8180.353097077738, 2244.502157515257, 117.88448998137916], "policy_adversary_policy_reward": [3530.949421774443, 5548.248244353162, 5795.151740194108, 4915.020152687, 1616.0244209156483, 2256.2986621232794, 6211.241148833953, 8075.442375259525, 5225.539791151705, 4337.379620653328, 7195.048657109899, 6383.850517953901, 826.26045808196, 1140.4140001791736, 3541.03786650105, 2443.102128519606, 8443.195087863014, 8533.630805752104, 9459.996658084723, 10948.457403885499, 1371.6996839105407, 2252.5561009136263, 2278.0188692611346, 2024.7320392576257, 8918.309897185229, 4988.427920143711, 5145.027609112687, 5814.791452622837, 5464.839153297997, 7890.7040676832985, 8737.4806438089, 9250.187611251144, 8880.951616274757, 10789.144363158814, 7941.098686710526, 6935.488567553018, 2995.569042249378, 1617.8517352232166, 4679.323923386877, 5322.949289603561, 2500.303138709374, 3535.5029403563008, 1722.0834461135128, 1014.2576728922172, 6406.624068455357, 3593.2441834760352, 10138.115739408388, 9073.197686128095, 9942.713959616642, 7004.120927472029, 4231.644821133191, 3847.1976061231917, 6921.07346382028, 5115.433597666327, 5769.977871883706, 6767.838159914662, 11861.605012238942, 10340.722604386749, 6500.744397963283, 9480.382052319366, 8082.610222395986, 8698.636068352282, 4188.5463520721105, 6685.453793448928, 10287.981564309608, 8626.542528543943, 3846.339505556031, 8833.867752023842, 9790.057914307463, 10422.592572245938, 9587.347573553783, 8592.43857355808, 3511.4790158658584, 3068.076787771138, 11861.319023470236, 9233.652421531884, 6517.816883307517, 3083.392890957667, 8037.536162608756, 9370.162667917457, 7683.7469063376075, 7222.539160946634, 10866.599887011753, 9621.904551554997, 7605.704022973649, 7132.434194711562, 4232.24866343255, 3013.3679508835544, 5237.193834263433, 3634.195838325088, 5254.633425466456, 6436.3142266313325, 11845.628771037875, 7249.007974234531, 5681.362872778614, 6306.5392303505905, 6823.483433450187, 10096.13503664817, 11892.1727341323, 8393.85140043074, 9924.74381686837, 8174.840653927415, 4481.228929629152, 6526.416715967456, 9948.679920772372, 11542.215375670856, 4903.7630526865805, 2993.1798808340695, 8811.42191983818, 4301.917714659194, 10927.075107099357, 7133.209277513287, 6240.649548702711, 4920.923211556068, 9490.089569178233, 10202.3719713032, 10780.821911569034, 7257.654490139835, 8367.5634935415, 8909.412748117187, 8601.703062539937, 7907.4244485743475, 12126.111255826532, 8896.130055169171, 6284.3360445934295, 6584.574317686024, 6207.526924207858, 6753.060056340529, 4836.660883446289, 2723.7694224065144, 3760.620158822352, 6312.736278902271, 1536.8332746548626, 855.5641207584143, 5494.3549120108655, 5150.7488521722435, 6267.8205213348765, 6479.135060920522, 5553.7154666312545, 3888.469408800309, 7832.813843234388, 7104.705597515772, 4944.683390640946, 8454.226413694103, 6234.9954163174825, 6072.27447475254, 5027.587288856569, 3203.0890345025946, 5532.432653607867, 6431.632988511921, 2108.668093237967, 1396.022153987364, 4222.866115416739, 4269.63490460082, 4242.595155026496, 4079.473534642473, 8050.8548584407035, 5978.67716833715, 4119.328750263781, 7090.17328418128, 5326.501427071062, 2997.3014074150215, 8559.734207970783, 9655.587894484892, 7369.396965629896, 5023.223488036903, 3788.6498825715303, 3745.1627540390145, 6691.049664513089, 6511.566194231387, 9156.847815549818, 9787.171273168804, 6976.878187006117, 7590.7379939436505, 8143.777459037286, 7561.049168242162, 8856.67906365082, 9507.349313647606, 5167.8711791675, 5913.607718069647, 8292.283170867524, 7570.00610868165, 5379.264462058823, 3196.2869331468423, 9167.153024558085, 5436.208630343271, 5699.027812522394, 5027.916244586587, 6692.7052761922705, 2872.8938653619357, 11714.61851526466, 10889.138787998467, 8233.26480126998, 7603.573855447843, 4162.179406779258, 4760.504563136955, 11323.975376829996, 11859.587130255595, 1225.618394273061, 522.6137094162056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4097076231954342, "mean_inference_ms": 1.013732981985761, "mean_action_processing_ms": 0.16936900865205778, "mean_env_wait_ms": 0.05553644845059923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003282904624938965, "StateBufferConnector_ms": 0.002389073371887207, "ViewRequirementAgentConnector_ms": 0.06469643115997314}, "num_episodes": 20, "episode_return_max": 25428.06466460086, "episode_return_min": 1866.116593670646, "episode_return_mean": 18893.998449778814}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.6310326267468, "num_env_steps_trained_throughput_per_sec": 532.6310326267468, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 7764.367, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7764.327, "sample_time_ms": 761.231, "learn_time_ms": 6991.18, "learn_throughput": 572.149, "synch_weights_time_ms": 11.312}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 21, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-32-07", "timestamp": 1723235527, "time_this_iter_s": 7.514907121658325, "time_total_s": 160.47443461418152, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322256ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.47443461418152, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.136363636363637, "ram_util_percent": 81.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7349006978371156, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.982223506705472, "policy_loss": -0.00030091361798070094, "vf_loss": 9.981476702008928, "vf_explained_var": -2.7006580716087705e-06, "kl": 0.0034923981888116233, "entropy": 1.0263663491874775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8409612986880044, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991015250484148, "policy_loss": -0.007191516142241502, "vf_loss": 9.994059926271438, "vf_explained_var": -0.00011181049048900605, "kl": 0.009215198539216847, "entropy": 1.4455315731465816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 25428.06466460086, "episode_reward_min": 1866.116593670646, "episode_reward_mean": 19391.71476104806, "episode_len_mean": 190.91, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19091, "policy_reward_min": {"agent_policy": 117.88448998137916, "adversary_policy": 522.6137094162056}, "policy_reward_max": {"agent_policy": 12598.818294112483, "adversary_policy": 12126.111255826532}, "policy_reward_mean": {"agent_policy": 5811.440288703799, "adversary_policy": 6790.137236172132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17671.683540775823, 16636.84090863434, 3064.8673383332057, 17682.317483447387, 22621.95028853621, 21143.501298032184, 8985.627004850867, 19239.179997301482, 19911.939823678065, 24476.471577705983, 20642.880021694244, 22213.954235715846, 18323.063343724814, 22599.7433476614, 17988.47512928701, 23928.358632060466, 22668.611018964493, 17206.051639662932, 23338.867888773955, 17225.52851468864, 22179.671786339644, 21298.412481962616, 23660.224039811124, 21120.050515656654, 16994.490595230996, 17776.331462056027, 19378.633604257357, 21342.330614471117, 19365.298089978987, 20965.619057181142, 22475.756247709698, 22238.39579037186, 18615.232524315506, 23481.02849746937, 17116.50622191743, 18444.05333839019, 21275.34490124422, 19063.05883528705, 22982.487476472816, 21344.213880772353, 22468.383750515397, 22033.15344992511, 22703.072928797326, 13896.55637495073, 20268.084690156513, 16748.430592649907, 17902.755782553308, 14991.215689525758, 19286.276311127756, 20379.35118288533, 18026.711208233806, 21226.703873246468, 19086.81901437186, 18949.573755173264, 17345.224658233525, 19661.5639258969, 3800.1852100216242, 18296.33468999948, 17071.111121334838, 20120.812792068147, 18261.464373994815, 17139.43703114602, 22699.519482316256, 19165.35911176785, 17818.847824393615, 20572.030648895317, 23200.107147586026, 21061.715339159084, 21653.531236809762, 22313.69878932482, 19158.74991045061, 21202.538473329303, 17338.42255687779, 19578.34425407419, 19126.89566549929, 17015.029489092885, 25011.093749723783, 21704.634955308946, 17103.037066993944, 25428.06466460086, 1866.116593670646, 23667.77504677816, 19399.570247746247, 22531.744577577872, 23586.482714313952, 18236.34385548241, 16024.459408388877, 22192.000084483214, 21954.442171245388, 3235.9839026534673, 20794.981090142483, 24090.145191972035, 22212.732351217484, 22896.650990836522, 21207.160425663, 16572.878052042353, 18335.61100309632, 23823.111098097615, 20038.67014752959, 17002.721384431014], "episode_lengths": [200, 200, 29, 200, 200, 200, 73, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 109, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7669.410327785378, 10601.034829568682, 328.526219327475, 7682.449231515996, 3410.6368629997996, 4196.666410943524, 906.7845775944826, 7202.67293581487, 7374.123791879715, 2274.1439610802768, 4661.753571411584, 5432.707944967584, 7449.063198203738, 3685.219254807852, 5308.267871707101, 3715.7081455070634, 4488.824871852643, 10626.495836025957, 2243.89644377175, 7624.318740423429, 4771.9729558134995, 6392.126414678335, 3171.71960124436, 6381.912297971414, 9748.873980914886, 8904.941789467524, 7687.68595215967, 2247.693869198744, 7377.395986849773, 4046.0005870827717, 2189.732113146666, 4138.811319576, 7607.586878718891, 1990.1332010261588, 9219.563288396797, 5330.713703892769, 3215.0605166315845, 7901.486075028244, 3290.025935991384, 3305.737479063486, 5191.407508856661, 5524.025938810858, 1680.831617801633, 1027.646012671281, 7307.497709608106, 9188.000286797109, 7829.3993448286865, 12598.818294112483, 8641.172546944637, 7632.395600629957, 8584.526332802223, 6289.184432496358, 5687.909210036859, 6642.30386410323, 9114.54833487438, 7697.4982837771, 295.4949627962951, 9803.833669981925, 8749.042431665877, 6091.280765290246, 7051.962339549676, 8815.634196659892, 4484.197379860569, 6772.738658101043, 10285.035187783069, 7369.41479015083, 4256.088058867428, 6494.099158209321, 5948.704609530333, 3949.670412026429, 8077.271013213478, 5340.249193780089, 8762.871161672138, 4974.982599172883, 8399.95160839029, 7449.430347538677, 2407.3364464607416, 5867.796298591148, 8180.353097077738, 2244.502157515257, 117.88448998137916, 4219.8709669987975, 5880.326137473694, 3460.576482347861, 4173.412556997429, 6359.536338215714, 11285.589780551865, 4833.0246912610455, 6127.290260515074, 207.2677451648846, 5760.590262740609, 2300.257315917917, 4543.600613744492, 5155.20745631184, 6054.959384076166, 10148.108403586715, 7748.919700854266, 3420.9850526013142, 5658.716284244924, 5176.92010971519], "policy_adversary_policy_reward": [4679.323923386877, 5322.949289603561, 2500.303138709374, 3535.5029403563008, 1722.0834461135128, 1014.2576728922172, 6406.624068455357, 3593.2441834760352, 10138.115739408388, 9073.197686128095, 9942.713959616642, 7004.120927472029, 4231.644821133191, 3847.1976061231917, 6921.07346382028, 5115.433597666327, 5769.977871883706, 6767.838159914662, 11861.605012238942, 10340.722604386749, 6500.744397963283, 9480.382052319366, 8082.610222395986, 8698.636068352282, 4188.5463520721105, 6685.453793448928, 10287.981564309608, 8626.542528543943, 3846.339505556031, 8833.867752023842, 9790.057914307463, 10422.592572245938, 9587.347573553783, 8592.43857355808, 3511.4790158658584, 3068.076787771138, 11861.319023470236, 9233.652421531884, 6517.816883307517, 3083.392890957667, 8037.536162608756, 9370.162667917457, 7683.7469063376075, 7222.539160946634, 10866.599887011753, 9621.904551554997, 7605.704022973649, 7132.434194711562, 4232.24866343255, 3013.3679508835544, 5237.193834263433, 3634.195838325088, 5254.633425466456, 6436.3142266313325, 11845.628771037875, 7249.007974234531, 5681.362872778614, 6306.5392303505905, 6823.483433450187, 10096.13503664817, 11892.1727341323, 8393.85140043074, 9924.74381686837, 8174.840653927415, 4481.228929629152, 6526.416715967456, 9948.679920772372, 11542.215375670856, 4903.7630526865805, 2993.1798808340695, 8811.42191983818, 4301.917714659194, 10927.075107099357, 7133.209277513287, 6240.649548702711, 4920.923211556068, 9490.089569178233, 10202.3719713032, 10780.821911569034, 7257.654490139835, 8367.5634935415, 8909.412748117187, 8601.703062539937, 7907.4244485743475, 12126.111255826532, 8896.130055169171, 6284.3360445934295, 6584.574317686024, 6207.526924207858, 6753.060056340529, 4836.660883446289, 2723.7694224065144, 3760.620158822352, 6312.736278902271, 1536.8332746548626, 855.5641207584143, 5494.3549120108655, 5150.7488521722435, 6267.8205213348765, 6479.135060920522, 5553.7154666312545, 3888.469408800309, 7832.813843234388, 7104.705597515772, 4944.683390640946, 8454.226413694103, 6234.9954163174825, 6072.27447475254, 5027.587288856569, 3203.0890345025946, 5532.432653607867, 6431.632988511921, 2108.668093237967, 1396.022153987364, 4222.866115416739, 4269.63490460082, 4242.595155026496, 4079.473534642473, 8050.8548584407035, 5978.67716833715, 4119.328750263781, 7090.17328418128, 5326.501427071062, 2997.3014074150215, 8559.734207970783, 9655.587894484892, 7369.396965629896, 5023.223488036903, 3788.6498825715303, 3745.1627540390145, 6691.049664513089, 6511.566194231387, 9156.847815549818, 9787.171273168804, 6976.878187006117, 7590.7379939436505, 8143.777459037286, 7561.049168242162, 8856.67906365082, 9507.349313647606, 5167.8711791675, 5913.607718069647, 8292.283170867524, 7570.00610868165, 5379.264462058823, 3196.2869331468423, 9167.153024558085, 5436.208630343271, 5699.027812522394, 5027.916244586587, 6692.7052761922705, 2872.8938653619357, 11714.61851526466, 10889.138787998467, 8233.26480126998, 7603.573855447843, 4162.179406779258, 4760.504563136955, 11323.975376829996, 11859.587130255595, 1225.618394273061, 522.6137094162056, 9596.674725945424, 9851.229353833958, 5271.653143392836, 8247.59096687971, 8434.589283372266, 10636.57881185775, 9517.34428943016, 9895.725867886324, 7782.599285515243, 4094.208231751449, 2824.4015857043187, 1914.4680421327075, 8062.644636134972, 9296.330757087213, 8006.198624738717, 7820.953285991586, 1670.7147577949618, 1358.00139969362, 8377.064932718533, 6657.325894683344, 11789.904034891162, 9999.983841162963, 8070.596727486589, 9598.535009986472, 8858.783117159986, 8882.660417364681, 8050.539125344078, 7101.661916242773, 3992.7166649882297, 2432.052983467384, 5781.21237329467, 4805.47892894739, 9684.6188867388, 10717.507158757498, 5896.53452379861, 8483.41933948603, 2860.585760700112, 8965.21551401577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4081258149442439, "mean_inference_ms": 1.0109452646462609, "mean_action_processing_ms": 0.16901473222166719, "mean_env_wait_ms": 0.055285871044063344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003141641616821289, "StateBufferConnector_ms": 0.0023474693298339844, "ViewRequirementAgentConnector_ms": 0.06434345245361328}, "num_episodes": 19, "episode_return_max": 25428.06466460086, "episode_return_min": 1866.116593670646, "episode_return_mean": 19391.71476104806}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.31725544594923, "num_env_steps_trained_throughput_per_sec": 502.31725544594923, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 7832.924, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7832.883, "sample_time_ms": 755.981, "learn_time_ms": 7064.858, "learn_throughput": 566.183, "synch_weights_time_ms": 11.436}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 22, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-32-15", "timestamp": 1723235535, "time_this_iter_s": 7.968431234359741, "time_total_s": 168.44286584854126, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320730040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.44286584854126, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.972727272727273, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7355175938634645, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.981876187097459, "policy_loss": -0.002315076179408207, "vf_loss": 9.983356747299275, "vf_explained_var": 7.493155343191964e-07, "kl": 0.00556341110662158, "entropy": 0.9882868306977408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8333359898068011, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000787245233854, "policy_loss": 0.004491747542730688, "vf_loss": 9.984765576322873, "vf_explained_var": -0.00012135890622933705, "kl": 0.025622040493180974, "entropy": 1.4439262023816506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 25428.06466460086, "episode_reward_min": 814.4066858500203, "episode_reward_mean": 18830.564475218176, "episode_len_mean": 188.21, "episode_media": {}, "episodes_this_iter": 25, "episodes_timesteps_total": 18821, "policy_reward_min": {"agent_policy": 27.488859586054634, "adversary_policy": 274.56127597452326}, "policy_reward_max": {"agent_policy": 12763.426401809342, "adversary_policy": 12126.111255826532}, "policy_reward_mean": {"agent_policy": 5905.632954695121, "adversary_policy": 6462.465760261528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17776.331462056027, 19378.633604257357, 21342.330614471117, 19365.298089978987, 20965.619057181142, 22475.756247709698, 22238.39579037186, 18615.232524315506, 23481.02849746937, 17116.50622191743, 18444.05333839019, 21275.34490124422, 19063.05883528705, 22982.487476472816, 21344.213880772353, 22468.383750515397, 22033.15344992511, 22703.072928797326, 13896.55637495073, 20268.084690156513, 16748.430592649907, 17902.755782553308, 14991.215689525758, 19286.276311127756, 20379.35118288533, 18026.711208233806, 21226.703873246468, 19086.81901437186, 18949.573755173264, 17345.224658233525, 19661.5639258969, 3800.1852100216242, 18296.33468999948, 17071.111121334838, 20120.812792068147, 18261.464373994815, 17139.43703114602, 22699.519482316256, 19165.35911176785, 17818.847824393615, 20572.030648895317, 23200.107147586026, 21061.715339159084, 21653.531236809762, 22313.69878932482, 19158.74991045061, 21202.538473329303, 17338.42255687779, 19578.34425407419, 19126.89566549929, 17015.029489092885, 25011.093749723783, 21704.634955308946, 17103.037066993944, 25428.06466460086, 1866.116593670646, 23667.77504677816, 19399.570247746247, 22531.744577577872, 23586.482714313952, 18236.34385548241, 16024.459408388877, 22192.000084483214, 21954.442171245388, 3235.9839026534673, 20794.981090142483, 24090.145191972035, 22212.732351217484, 22896.650990836522, 21207.160425663, 16572.878052042353, 18335.61100309632, 23823.111098097615, 20038.67014752959, 17002.721384431014, 18432.31013418467, 14842.565851656353, 17797.11806927896, 18695.578477723007, 17133.27592359482, 1697.292635365792, 16492.524170117456, 23386.475949951186, 15322.263456663586, 21021.160006878265, 910.9573790424159, 22374.664562314494, 24229.342585193048, 22680.772910255302, 20935.36259164556, 15043.076797426638, 15858.567324670352, 18914.796355389204, 17445.40473385745, 19855.39964345479, 814.4066858500203, 23104.506948635448, 20025.972191805053, 22023.669906537463, 17670.268578050323], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 109, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200], "policy_agent_policy_reward": [8904.941789467524, 7687.68595215967, 2247.693869198744, 7377.395986849773, 4046.0005870827717, 2189.732113146666, 4138.811319576, 7607.586878718891, 1990.1332010261588, 9219.563288396797, 5330.713703892769, 3215.0605166315845, 7901.486075028244, 3290.025935991384, 3305.737479063486, 5191.407508856661, 5524.025938810858, 1680.831617801633, 1027.646012671281, 7307.497709608106, 9188.000286797109, 7829.3993448286865, 12598.818294112483, 8641.172546944637, 7632.395600629957, 8584.526332802223, 6289.184432496358, 5687.909210036859, 6642.30386410323, 9114.54833487438, 7697.4982837771, 295.4949627962951, 9803.833669981925, 8749.042431665877, 6091.280765290246, 7051.962339549676, 8815.634196659892, 4484.197379860569, 6772.738658101043, 10285.035187783069, 7369.41479015083, 4256.088058867428, 6494.099158209321, 5948.704609530333, 3949.670412026429, 8077.271013213478, 5340.249193780089, 8762.871161672138, 4974.982599172883, 8399.95160839029, 7449.430347538677, 2407.3364464607416, 5867.796298591148, 8180.353097077738, 2244.502157515257, 117.88448998137916, 4219.8709669987975, 5880.326137473694, 3460.576482347861, 4173.412556997429, 6359.536338215714, 11285.589780551865, 4833.0246912610455, 6127.290260515074, 207.2677451648846, 5760.590262740609, 2300.257315917917, 4543.600613744492, 5155.20745631184, 6054.959384076166, 10148.108403586715, 7748.919700854266, 3420.9850526013142, 5658.716284244924, 5176.92010971519, 8317.589265212968, 11544.477871689405, 6994.481549720686, 3616.215926656153, 5816.638352316895, 90.68219116924331, 8849.737902341789, 3245.79239651477, 12763.426401809342, 6514.132077527449, 27.488859586054634, 2946.146139473055, 3307.9041281052873, 4708.340680180762, 2355.5176983221354, 11224.833664663338, 10520.002710083365, 3548.794393171162, 7665.993964507567, 7822.813331262289, 29.692950629945653, 4621.440430676232, 6892.994640425359, 3993.7070026480055, 9349.732348250358], "policy_adversary_policy_reward": [5237.193834263433, 3634.195838325088, 5254.633425466456, 6436.3142266313325, 11845.628771037875, 7249.007974234531, 5681.362872778614, 6306.5392303505905, 6823.483433450187, 10096.13503664817, 11892.1727341323, 8393.85140043074, 9924.74381686837, 8174.840653927415, 4481.228929629152, 6526.416715967456, 9948.679920772372, 11542.215375670856, 4903.7630526865805, 2993.1798808340695, 8811.42191983818, 4301.917714659194, 10927.075107099357, 7133.209277513287, 6240.649548702711, 4920.923211556068, 9490.089569178233, 10202.3719713032, 10780.821911569034, 7257.654490139835, 8367.5634935415, 8909.412748117187, 8601.703062539937, 7907.4244485743475, 12126.111255826532, 8896.130055169171, 6284.3360445934295, 6584.574317686024, 6207.526924207858, 6753.060056340529, 4836.660883446289, 2723.7694224065144, 3760.620158822352, 6312.736278902271, 1536.8332746548626, 855.5641207584143, 5494.3549120108655, 5150.7488521722435, 6267.8205213348765, 6479.135060920522, 5553.7154666312545, 3888.469408800309, 7832.813843234388, 7104.705597515772, 4944.683390640946, 8454.226413694103, 6234.9954163174825, 6072.27447475254, 5027.587288856569, 3203.0890345025946, 5532.432653607867, 6431.632988511921, 2108.668093237967, 1396.022153987364, 4222.866115416739, 4269.63490460082, 4242.595155026496, 4079.473534642473, 8050.8548584407035, 5978.67716833715, 4119.328750263781, 7090.17328418128, 5326.501427071062, 2997.3014074150215, 8559.734207970783, 9655.587894484892, 7369.396965629896, 5023.223488036903, 3788.6498825715303, 3745.1627540390145, 6691.049664513089, 6511.566194231387, 9156.847815549818, 9787.171273168804, 6976.878187006117, 7590.7379939436505, 8143.777459037286, 7561.049168242162, 8856.67906365082, 9507.349313647606, 5167.8711791675, 5913.607718069647, 8292.283170867524, 7570.00610868165, 5379.264462058823, 3196.2869331468423, 9167.153024558085, 5436.208630343271, 5699.027812522394, 5027.916244586587, 6692.7052761922705, 2872.8938653619357, 11714.61851526466, 10889.138787998467, 8233.26480126998, 7603.573855447843, 4162.179406779258, 4760.504563136955, 11323.975376829996, 11859.587130255595, 1225.618394273061, 522.6137094162056, 9596.674725945424, 9851.229353833958, 5271.653143392836, 8247.59096687971, 8434.589283372266, 10636.57881185775, 9517.34428943016, 9895.725867886324, 7782.599285515243, 4094.208231751449, 2824.4015857043187, 1914.4680421327075, 8062.644636134972, 9296.330757087213, 8006.198624738717, 7820.953285991586, 1670.7147577949618, 1358.00139969362, 8377.064932718533, 6657.325894683344, 11789.904034891162, 9999.983841162963, 8070.596727486589, 9598.535009986472, 8858.783117159986, 8882.660417364681, 8050.539125344078, 7101.661916242773, 3992.7166649882297, 2432.052983467384, 5781.21237329467, 4805.47892894739, 9684.6188867388, 10717.507158757498, 5896.53452379861, 8483.41933948603, 2860.585760700112, 8965.21551401577, 4594.456628232587, 5520.26424073914, 700.4302279254096, 2597.657752041552, 7147.654074010265, 3654.9824455480243, 4553.442853992039, 10525.919697074787, 2991.140299863808, 8325.497271414051, 565.9217854673158, 1040.6886587292327, 5292.397721389164, 2350.3885463864945, 10896.343227216183, 9244.340326220243, 1310.3076631684569, 1248.5293916858188, 7621.390913551581, 6885.637015799284, 608.9072434818382, 274.56127597452326, 11150.974890453748, 8277.543532387668, 10750.526210077158, 10170.912247010641, 9413.817231073159, 8558.61499900132, 6793.226967914619, 11786.61792540881, 900.9411736957103, 2917.301959067608, 3622.1329136475892, 1716.4317009394288, 10593.341230559776, 4772.660731658188, 3303.2691101265373, 6476.141659223387, 5811.0157095232835, 6221.570602669209, 319.4319390194371, 465.2817962006376, 9390.116994596941, 9092.949523362211, 7155.410067747067, 5977.5674836326, 10148.428621082954, 7881.534282806626, 3778.2534431098566, 4542.282786690108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40656779789929387, "mean_inference_ms": 1.0073851485814784, "mean_action_processing_ms": 0.16854095002860758, "mean_env_wait_ms": 0.055076027320545756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003728508949279785, "StateBufferConnector_ms": 0.0024394989013671875, "ViewRequirementAgentConnector_ms": 0.06461310386657715}, "num_episodes": 25, "episode_return_max": 25428.06466460086, "episode_return_min": 814.4066858500203, "episode_return_mean": 18830.564475218176}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 515.0454292954449, "num_env_steps_trained_throughput_per_sec": 515.0454292954449, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 7798.325, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7798.284, "sample_time_ms": 759.54, "learn_time_ms": 7026.741, "learn_throughput": 569.254, "synch_weights_time_ms": 11.537}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 23, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-32-23", "timestamp": 1723235543, "time_this_iter_s": 7.771749258041382, "time_total_s": 176.21461510658264, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322256f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.21461510658264, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 27.727272727272727, "ram_util_percent": 81.23636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7372405071895589, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992743774696633, "policy_loss": -0.002303581749872556, "vf_loss": 9.99430694781914, "vf_explained_var": -9.989296948468244e-07, "kl": 0.004936021769163076, "entropy": 0.985384124485904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8350536459436019, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.023158019781112, "policy_loss": 0.005768412876447352, "vf_loss": 10.0, "vf_explained_var": -8.62139587601026e-05, "kl": 0.025762364858140548, "entropy": 1.48444004021585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 25428.06466460086, "episode_reward_min": 814.4066858500203, "episode_reward_mean": 18646.864613653997, "episode_len_mean": 189.12, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18912, "policy_reward_min": {"agent_policy": 27.488859586054634, "adversary_policy": 274.56127597452326}, "policy_reward_max": {"agent_policy": 12763.426401809342, "adversary_policy": 12360.878744059035}, "policy_reward_mean": {"agent_policy": 6296.529210812833, "adversary_policy": 6175.167701420583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16748.430592649907, 17902.755782553308, 14991.215689525758, 19286.276311127756, 20379.35118288533, 18026.711208233806, 21226.703873246468, 19086.81901437186, 18949.573755173264, 17345.224658233525, 19661.5639258969, 3800.1852100216242, 18296.33468999948, 17071.111121334838, 20120.812792068147, 18261.464373994815, 17139.43703114602, 22699.519482316256, 19165.35911176785, 17818.847824393615, 20572.030648895317, 23200.107147586026, 21061.715339159084, 21653.531236809762, 22313.69878932482, 19158.74991045061, 21202.538473329303, 17338.42255687779, 19578.34425407419, 19126.89566549929, 17015.029489092885, 25011.093749723783, 21704.634955308946, 17103.037066993944, 25428.06466460086, 1866.116593670646, 23667.77504677816, 19399.570247746247, 22531.744577577872, 23586.482714313952, 18236.34385548241, 16024.459408388877, 22192.000084483214, 21954.442171245388, 3235.9839026534673, 20794.981090142483, 24090.145191972035, 22212.732351217484, 22896.650990836522, 21207.160425663, 16572.878052042353, 18335.61100309632, 23823.111098097615, 20038.67014752959, 17002.721384431014, 18432.31013418467, 14842.565851656353, 17797.11806927896, 18695.578477723007, 17133.27592359482, 1697.292635365792, 16492.524170117456, 23386.475949951186, 15322.263456663586, 21021.160006878265, 910.9573790424159, 22374.664562314494, 24229.342585193048, 22680.772910255302, 20935.36259164556, 15043.076797426638, 15858.567324670352, 18914.796355389204, 17445.40473385745, 19855.39964345479, 814.4066858500203, 23104.506948635448, 20025.972191805053, 22023.669906537463, 17670.268578050323, 18379.31094201673, 17335.650225283014, 22364.583126481535, 18912.096065850652, 21758.5420666455, 20085.836452211337, 23106.080650602562, 16818.729378668944, 17891.408469308764, 21791.158005004057, 21317.58829719314, 18439.59106682457, 19608.003686553708, 20931.07829350936, 20110.835737387988, 16901.857996787214, 17358.08838907111, 21515.353353099483, 16586.43431329776, 17651.329064025133], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9188.000286797109, 7829.3993448286865, 12598.818294112483, 8641.172546944637, 7632.395600629957, 8584.526332802223, 6289.184432496358, 5687.909210036859, 6642.30386410323, 9114.54833487438, 7697.4982837771, 295.4949627962951, 9803.833669981925, 8749.042431665877, 6091.280765290246, 7051.962339549676, 8815.634196659892, 4484.197379860569, 6772.738658101043, 10285.035187783069, 7369.41479015083, 4256.088058867428, 6494.099158209321, 5948.704609530333, 3949.670412026429, 8077.271013213478, 5340.249193780089, 8762.871161672138, 4974.982599172883, 8399.95160839029, 7449.430347538677, 2407.3364464607416, 5867.796298591148, 8180.353097077738, 2244.502157515257, 117.88448998137916, 4219.8709669987975, 5880.326137473694, 3460.576482347861, 4173.412556997429, 6359.536338215714, 11285.589780551865, 4833.0246912610455, 6127.290260515074, 207.2677451648846, 5760.590262740609, 2300.257315917917, 4543.600613744492, 5155.20745631184, 6054.959384076166, 10148.108403586715, 7748.919700854266, 3420.9850526013142, 5658.716284244924, 5176.92010971519, 8317.589265212968, 11544.477871689405, 6994.481549720686, 3616.215926656153, 5816.638352316895, 90.68219116924331, 8849.737902341789, 3245.79239651477, 12763.426401809342, 6514.132077527449, 27.488859586054634, 2946.146139473055, 3307.9041281052873, 4708.340680180762, 2355.5176983221354, 11224.833664663338, 10520.002710083365, 3548.794393171162, 7665.993964507567, 7822.813331262289, 29.692950629945653, 4621.440430676232, 6892.994640425359, 3993.7070026480055, 9349.732348250358, 6844.161782211555, 7676.3435615591825, 3516.9871051933487, 7193.319005432547, 5929.379020391678, 6461.607847512921, 4645.536533667237, 10873.851469881516, 9397.04535944376, 5527.656699217408, 6291.809981823276, 9131.404285032957, 2986.6881614079616, 5413.164318995366, 6712.045167473394, 9185.039276595593, 9286.355522763035, 1781.2568796719152, 9807.834219970098, 9612.116897505479], "policy_adversary_policy_reward": [4836.660883446289, 2723.7694224065144, 3760.620158822352, 6312.736278902271, 1536.8332746548626, 855.5641207584143, 5494.3549120108655, 5150.7488521722435, 6267.8205213348765, 6479.135060920522, 5553.7154666312545, 3888.469408800309, 7832.813843234388, 7104.705597515772, 4944.683390640946, 8454.226413694103, 6234.9954163174825, 6072.27447475254, 5027.587288856569, 3203.0890345025946, 5532.432653607867, 6431.632988511921, 2108.668093237967, 1396.022153987364, 4222.866115416739, 4269.63490460082, 4242.595155026496, 4079.473534642473, 8050.8548584407035, 5978.67716833715, 4119.328750263781, 7090.17328418128, 5326.501427071062, 2997.3014074150215, 8559.734207970783, 9655.587894484892, 7369.396965629896, 5023.223488036903, 3788.6498825715303, 3745.1627540390145, 6691.049664513089, 6511.566194231387, 9156.847815549818, 9787.171273168804, 6976.878187006117, 7590.7379939436505, 8143.777459037286, 7561.049168242162, 8856.67906365082, 9507.349313647606, 5167.8711791675, 5913.607718069647, 8292.283170867524, 7570.00610868165, 5379.264462058823, 3196.2869331468423, 9167.153024558085, 5436.208630343271, 5699.027812522394, 5027.916244586587, 6692.7052761922705, 2872.8938653619357, 11714.61851526466, 10889.138787998467, 8233.26480126998, 7603.573855447843, 4162.179406779258, 4760.504563136955, 11323.975376829996, 11859.587130255595, 1225.618394273061, 522.6137094162056, 9596.674725945424, 9851.229353833958, 5271.653143392836, 8247.59096687971, 8434.589283372266, 10636.57881185775, 9517.34428943016, 9895.725867886324, 7782.599285515243, 4094.208231751449, 2824.4015857043187, 1914.4680421327075, 8062.644636134972, 9296.330757087213, 8006.198624738717, 7820.953285991586, 1670.7147577949618, 1358.00139969362, 8377.064932718533, 6657.325894683344, 11789.904034891162, 9999.983841162963, 8070.596727486589, 9598.535009986472, 8858.783117159986, 8882.660417364681, 8050.539125344078, 7101.661916242773, 3992.7166649882297, 2432.052983467384, 5781.21237329467, 4805.47892894739, 9684.6188867388, 10717.507158757498, 5896.53452379861, 8483.41933948603, 2860.585760700112, 8965.21551401577, 4594.456628232587, 5520.26424073914, 700.4302279254096, 2597.657752041552, 7147.654074010265, 3654.9824455480243, 4553.442853992039, 10525.919697074787, 2991.140299863808, 8325.497271414051, 565.9217854673158, 1040.6886587292327, 5292.397721389164, 2350.3885463864945, 10896.343227216183, 9244.340326220243, 1310.3076631684569, 1248.5293916858188, 7621.390913551581, 6885.637015799284, 608.9072434818382, 274.56127597452326, 11150.974890453748, 8277.543532387668, 10750.526210077158, 10170.912247010641, 9413.817231073159, 8558.61499900132, 6793.226967914619, 11786.61792540881, 900.9411736957103, 2917.301959067608, 3622.1329136475892, 1716.4317009394288, 10593.341230559776, 4772.660731658188, 3303.2691101265373, 6476.141659223387, 5811.0157095232835, 6221.570602669209, 319.4319390194371, 465.2817962006376, 9390.116994596941, 9092.949523362211, 7155.410067747067, 5977.5674836326, 10148.428621082954, 7881.534282806626, 3778.2534431098566, 4542.282786690108, 4237.175318285772, 7297.9738415194, 6457.730691903176, 3201.5759718206414, 8238.339589769525, 10609.256431518683, 4783.0312114817325, 6935.745848936353, 7812.6280028332485, 8016.5350434205975, 5956.247275997997, 7667.981328700418, 9339.207201005258, 9121.336915930025, 3209.3609506688967, 2735.516958118566, 4631.515020180776, 3862.8480896842407, 7653.858306190049, 8609.642999596632, 7841.634903042549, 7184.143412327239, 4965.822250824898, 4342.364530966707, 5465.868062822701, 11155.447462323013, 8140.333295041987, 7377.580679472009, 7430.090456257554, 5968.7001136570125, 4056.1737341599146, 3660.644986031709, 4576.163336883417, 3495.569529424625, 12360.878744059035, 7373.217729368583, 4200.658848941325, 2577.941244386344, 3509.1934402941033, 4530.018726225498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4056579125246161, "mean_inference_ms": 1.005909066233996, "mean_action_processing_ms": 0.16834519006739826, "mean_env_wait_ms": 0.055003209101025394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037758350372314453, "StateBufferConnector_ms": 0.0028204917907714844, "ViewRequirementAgentConnector_ms": 0.06671345233917236}, "num_episodes": 20, "episode_return_max": 25428.06466460086, "episode_return_min": 814.4066858500203, "episode_return_mean": 18646.864613653997}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 528.0596994067439, "num_env_steps_trained_throughput_per_sec": 528.0596994067439, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 7694.55, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7694.509, "sample_time_ms": 768.159, "learn_time_ms": 6914.34, "learn_throughput": 578.508, "synch_weights_time_ms": 11.548}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 24, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-32-30", "timestamp": 1723235550, "time_this_iter_s": 7.579360008239746, "time_total_s": 183.7939751148224, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320722160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.7939751148224, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.718181818181815, "ram_util_percent": 81.11818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6921944769207763, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997458825287996, "policy_loss": -0.000928117000010042, "vf_loss": 9.99785304801174, "vf_explained_var": 8.39854674364524e-06, "kl": 0.00711871831906989, "entropy": 0.9584805759803328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8314652348247668, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.015510055422784, "policy_loss": 0.0035519870381297853, "vf_loss": 9.994499468803406, "vf_explained_var": -0.0001345318431655566, "kl": 0.017243058077292518, "entropy": 1.5312208441396555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 25428.06466460086, "episode_reward_min": 814.4066858500203, "episode_reward_mean": 18736.24057934519, "episode_len_mean": 189.02, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18902, "policy_reward_min": {"agent_policy": 27.488859586054634, "adversary_policy": 274.56127597452326}, "policy_reward_max": {"agent_policy": 12763.426401809342, "adversary_policy": 12360.878744059035}, "policy_reward_mean": {"agent_policy": 6243.944973442153, "adversary_policy": 6246.14780295152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23200.107147586026, 21061.715339159084, 21653.531236809762, 22313.69878932482, 19158.74991045061, 21202.538473329303, 17338.42255687779, 19578.34425407419, 19126.89566549929, 17015.029489092885, 25011.093749723783, 21704.634955308946, 17103.037066993944, 25428.06466460086, 1866.116593670646, 23667.77504677816, 19399.570247746247, 22531.744577577872, 23586.482714313952, 18236.34385548241, 16024.459408388877, 22192.000084483214, 21954.442171245388, 3235.9839026534673, 20794.981090142483, 24090.145191972035, 22212.732351217484, 22896.650990836522, 21207.160425663, 16572.878052042353, 18335.61100309632, 23823.111098097615, 20038.67014752959, 17002.721384431014, 18432.31013418467, 14842.565851656353, 17797.11806927896, 18695.578477723007, 17133.27592359482, 1697.292635365792, 16492.524170117456, 23386.475949951186, 15322.263456663586, 21021.160006878265, 910.9573790424159, 22374.664562314494, 24229.342585193048, 22680.772910255302, 20935.36259164556, 15043.076797426638, 15858.567324670352, 18914.796355389204, 17445.40473385745, 19855.39964345479, 814.4066858500203, 23104.506948635448, 20025.972191805053, 22023.669906537463, 17670.268578050323, 18379.31094201673, 17335.650225283014, 22364.583126481535, 18912.096065850652, 21758.5420666455, 20085.836452211337, 23106.080650602562, 16818.729378668944, 17891.408469308764, 21791.158005004057, 21317.58829719314, 18439.59106682457, 19608.003686553708, 20931.07829350936, 20110.835737387988, 16901.857996787214, 17358.08838907111, 21515.353353099483, 16586.43431329776, 17651.329064025133, 18357.535888923994, 17924.140459600156, 20073.724401901618, 19719.06896023713, 18036.315665500013, 20268.644221344057, 22781.926534006037, 19749.986477940714, 18226.090420781085, 16464.475270852694, 19148.51529770521, 19572.88362190849, 16175.45141411498, 18830.069509570832, 18629.713248151216, 21307.278361936987, 23665.293756297437, 19389.485955797052, 19445.946745296642, 16640.27983939866, 3080.4987976897564], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24], "policy_agent_policy_reward": [4256.088058867428, 6494.099158209321, 5948.704609530333, 3949.670412026429, 8077.271013213478, 5340.249193780089, 8762.871161672138, 4974.982599172883, 8399.95160839029, 7449.430347538677, 2407.3364464607416, 5867.796298591148, 8180.353097077738, 2244.502157515257, 117.88448998137916, 4219.8709669987975, 5880.326137473694, 3460.576482347861, 4173.412556997429, 6359.536338215714, 11285.589780551865, 4833.0246912610455, 6127.290260515074, 207.2677451648846, 5760.590262740609, 2300.257315917917, 4543.600613744492, 5155.20745631184, 6054.959384076166, 10148.108403586715, 7748.919700854266, 3420.9850526013142, 5658.716284244924, 5176.92010971519, 8317.589265212968, 11544.477871689405, 6994.481549720686, 3616.215926656153, 5816.638352316895, 90.68219116924331, 8849.737902341789, 3245.79239651477, 12763.426401809342, 6514.132077527449, 27.488859586054634, 2946.146139473055, 3307.9041281052873, 4708.340680180762, 2355.5176983221354, 11224.833664663338, 10520.002710083365, 3548.794393171162, 7665.993964507567, 7822.813331262289, 29.692950629945653, 4621.440430676232, 6892.994640425359, 3993.7070026480055, 9349.732348250358, 6844.161782211555, 7676.3435615591825, 3516.9871051933487, 7193.319005432547, 5929.379020391678, 6461.607847512921, 4645.536533667237, 10873.851469881516, 9397.04535944376, 5527.656699217408, 6291.809981823276, 9131.404285032957, 2986.6881614079616, 5413.164318995366, 6712.045167473394, 9185.039276595593, 9286.355522763035, 1781.2568796719152, 9807.834219970098, 9612.116897505479, 9562.054313016259, 7886.133472586405, 7470.104000702057, 7700.158158556553, 8063.134921061048, 7483.092714652663, 4079.571183557669, 5899.861590929897, 9641.870439686583, 8330.338407810956, 5876.752048890124, 6983.6839589978, 10192.484300417946, 9044.943839246309, 7520.773256465642, 6576.097718074123, 4109.5588644163145, 8431.423957972202, 8490.54763321029, 10835.965713113466, 187.41668281000605], "policy_adversary_policy_reward": [9156.847815549818, 9787.171273168804, 6976.878187006117, 7590.7379939436505, 8143.777459037286, 7561.049168242162, 8856.67906365082, 9507.349313647606, 5167.8711791675, 5913.607718069647, 8292.283170867524, 7570.00610868165, 5379.264462058823, 3196.2869331468423, 9167.153024558085, 5436.208630343271, 5699.027812522394, 5027.916244586587, 6692.7052761922705, 2872.8938653619357, 11714.61851526466, 10889.138787998467, 8233.26480126998, 7603.573855447843, 4162.179406779258, 4760.504563136955, 11323.975376829996, 11859.587130255595, 1225.618394273061, 522.6137094162056, 9596.674725945424, 9851.229353833958, 5271.653143392836, 8247.59096687971, 8434.589283372266, 10636.57881185775, 9517.34428943016, 9895.725867886324, 7782.599285515243, 4094.208231751449, 2824.4015857043187, 1914.4680421327075, 8062.644636134972, 9296.330757087213, 8006.198624738717, 7820.953285991586, 1670.7147577949618, 1358.00139969362, 8377.064932718533, 6657.325894683344, 11789.904034891162, 9999.983841162963, 8070.596727486589, 9598.535009986472, 8858.783117159986, 8882.660417364681, 8050.539125344078, 7101.661916242773, 3992.7166649882297, 2432.052983467384, 5781.21237329467, 4805.47892894739, 9684.6188867388, 10717.507158757498, 5896.53452379861, 8483.41933948603, 2860.585760700112, 8965.21551401577, 4594.456628232587, 5520.26424073914, 700.4302279254096, 2597.657752041552, 7147.654074010265, 3654.9824455480243, 4553.442853992039, 10525.919697074787, 2991.140299863808, 8325.497271414051, 565.9217854673158, 1040.6886587292327, 5292.397721389164, 2350.3885463864945, 10896.343227216183, 9244.340326220243, 1310.3076631684569, 1248.5293916858188, 7621.390913551581, 6885.637015799284, 608.9072434818382, 274.56127597452326, 11150.974890453748, 8277.543532387668, 10750.526210077158, 10170.912247010641, 9413.817231073159, 8558.61499900132, 6793.226967914619, 11786.61792540881, 900.9411736957103, 2917.301959067608, 3622.1329136475892, 1716.4317009394288, 10593.341230559776, 4772.660731658188, 3303.2691101265373, 6476.141659223387, 5811.0157095232835, 6221.570602669209, 319.4319390194371, 465.2817962006376, 9390.116994596941, 9092.949523362211, 7155.410067747067, 5977.5674836326, 10148.428621082954, 7881.534282806626, 3778.2534431098566, 4542.282786690108, 4237.175318285772, 7297.9738415194, 6457.730691903176, 3201.5759718206414, 8238.339589769525, 10609.256431518683, 4783.0312114817325, 6935.745848936353, 7812.6280028332485, 8016.5350434205975, 5956.247275997997, 7667.981328700418, 9339.207201005258, 9121.336915930025, 3209.3609506688967, 2735.516958118566, 4631.515020180776, 3862.8480896842407, 7653.858306190049, 8609.642999596632, 7841.634903042549, 7184.143412327239, 4965.822250824898, 4342.364530966707, 5465.868062822701, 11155.447462323013, 8140.333295041987, 7377.580679472009, 7430.090456257554, 5968.7001136570125, 4056.1737341599146, 3660.644986031709, 4576.163336883417, 3495.569529424625, 12360.878744059035, 7373.217729368583, 4200.658848941325, 2577.941244386344, 3509.1934402941033, 4530.018726225498, 4261.881181306979, 4533.600394600759, 3782.0048358692725, 6256.002151144545, 6051.293559941801, 6552.326841257826, 6353.7472575915035, 5665.163544089128, 4778.913589933858, 5194.267154505128, 6251.600745897657, 6533.950760793743, 10062.56444017328, 8639.790910275031, 8242.274032801059, 5607.850854209743, 4086.0657104793318, 4498.154270615059, 5811.797215920005, 2322.339647121729, 8265.383574840827, 5006.379673974207, 7158.062282933162, 5431.137379977532, 3949.65132331301, 2033.3157903840424, 5094.481617310572, 4690.644053013934, 4487.577624420262, 6621.362367265305, 7211.6296377627, 7519.5510061001305, 10021.961471371289, 9533.773420509864, 5266.677804796737, 5691.384193028102, 5532.386572262164, 5423.0125398242335, 2498.2529268281955, 3306.0611994570118, 1395.0412071186054, 1498.040907761146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40515227315043484, "mean_inference_ms": 1.0055523393626058, "mean_action_processing_ms": 0.16841686302364317, "mean_env_wait_ms": 0.05496954158384889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038350820541381836, "StateBufferConnector_ms": 0.003232717514038086, "ViewRequirementAgentConnector_ms": 0.06795501708984375}, "num_episodes": 21, "episode_return_max": 25428.06466460086, "episode_return_min": 814.4066858500203, "episode_return_mean": 18736.24057934519}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.0094018040937, "num_env_steps_trained_throughput_per_sec": 530.0094018040937, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 7661.142, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7661.106, "sample_time_ms": 759.907, "learn_time_ms": 6889.283, "learn_throughput": 580.612, "synch_weights_time_ms": 11.456}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 25, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-32-38", "timestamp": 1723235558, "time_this_iter_s": 7.5516228675842285, "time_total_s": 191.34559798240662, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320722310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.34559798240662, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.436363636363637, "ram_util_percent": 81.04545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6275112887775457, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998021959880042, "policy_loss": -0.0030559666388268983, "vf_loss": 10.0, "vf_explained_var": -4.339470434441138e-06, "kl": 0.01437230169891365, "entropy": 0.8350834305639621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8347592568645875, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.019770953059197, "policy_loss": 0.000530926150289209, "vf_loss": 10.0, "vf_explained_var": -8.555979778369268e-05, "kl": 0.019002503564115612, "entropy": 1.5406062290072442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 24229.342585193048, "episode_reward_min": 814.4066858500203, "episode_reward_mean": 18583.07564297624, "episode_len_mean": 190.83, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19083, "policy_reward_min": {"agent_policy": 27.488859586054634, "adversary_policy": 274.56127597452326}, "policy_reward_max": {"agent_policy": 12763.426401809342, "adversary_policy": 12360.878744059035}, "policy_reward_mean": {"agent_policy": 6634.147375680788, "adversary_policy": 5974.464133647724}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18236.34385548241, 16024.459408388877, 22192.000084483214, 21954.442171245388, 3235.9839026534673, 20794.981090142483, 24090.145191972035, 22212.732351217484, 22896.650990836522, 21207.160425663, 16572.878052042353, 18335.61100309632, 23823.111098097615, 20038.67014752959, 17002.721384431014, 18432.31013418467, 14842.565851656353, 17797.11806927896, 18695.578477723007, 17133.27592359482, 1697.292635365792, 16492.524170117456, 23386.475949951186, 15322.263456663586, 21021.160006878265, 910.9573790424159, 22374.664562314494, 24229.342585193048, 22680.772910255302, 20935.36259164556, 15043.076797426638, 15858.567324670352, 18914.796355389204, 17445.40473385745, 19855.39964345479, 814.4066858500203, 23104.506948635448, 20025.972191805053, 22023.669906537463, 17670.268578050323, 18379.31094201673, 17335.650225283014, 22364.583126481535, 18912.096065850652, 21758.5420666455, 20085.836452211337, 23106.080650602562, 16818.729378668944, 17891.408469308764, 21791.158005004057, 21317.58829719314, 18439.59106682457, 19608.003686553708, 20931.07829350936, 20110.835737387988, 16901.857996787214, 17358.08838907111, 21515.353353099483, 16586.43431329776, 17651.329064025133, 18357.535888923994, 17924.140459600156, 20073.724401901618, 19719.06896023713, 18036.315665500013, 20268.644221344057, 22781.926534006037, 19749.986477940714, 18226.090420781085, 16464.475270852694, 19148.51529770521, 19572.88362190849, 16175.45141411498, 18830.069509570832, 18629.713248151216, 21307.278361936987, 23665.293756297437, 19389.485955797052, 19445.946745296642, 16640.27983939866, 3080.4987976897564, 17327.42992093249, 20228.965346601046, 19248.76749281081, 20327.681337319835, 21328.03146697662, 18421.783763416985, 23628.71701232027, 16495.976755435066, 18166.602648760156, 18095.179153998262, 19864.930890399133, 17346.87765031939, 21890.407459642596, 18789.200373272433, 16973.61058300746, 18413.575823975167, 19905.259645727954, 20879.93750492093, 19298.124012186337], "episode_lengths": [200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6359.536338215714, 11285.589780551865, 4833.0246912610455, 6127.290260515074, 207.2677451648846, 5760.590262740609, 2300.257315917917, 4543.600613744492, 5155.20745631184, 6054.959384076166, 10148.108403586715, 7748.919700854266, 3420.9850526013142, 5658.716284244924, 5176.92010971519, 8317.589265212968, 11544.477871689405, 6994.481549720686, 3616.215926656153, 5816.638352316895, 90.68219116924331, 8849.737902341789, 3245.79239651477, 12763.426401809342, 6514.132077527449, 27.488859586054634, 2946.146139473055, 3307.9041281052873, 4708.340680180762, 2355.5176983221354, 11224.833664663338, 10520.002710083365, 3548.794393171162, 7665.993964507567, 7822.813331262289, 29.692950629945653, 4621.440430676232, 6892.994640425359, 3993.7070026480055, 9349.732348250358, 6844.161782211555, 7676.3435615591825, 3516.9871051933487, 7193.319005432547, 5929.379020391678, 6461.607847512921, 4645.536533667237, 10873.851469881516, 9397.04535944376, 5527.656699217408, 6291.809981823276, 9131.404285032957, 2986.6881614079616, 5413.164318995366, 6712.045167473394, 9185.039276595593, 9286.355522763035, 1781.2568796719152, 9807.834219970098, 9612.116897505479, 9562.054313016259, 7886.133472586405, 7470.104000702057, 7700.158158556553, 8063.134921061048, 7483.092714652663, 4079.571183557669, 5899.861590929897, 9641.870439686583, 8330.338407810956, 5876.752048890124, 6983.6839589978, 10192.484300417946, 9044.943839246309, 7520.773256465642, 6576.097718074123, 4109.5588644163145, 8431.423957972202, 8490.54763321029, 10835.965713113466, 187.41668281000605, 7057.789994954968, 6516.136423798177, 6916.8603743134245, 7080.2757230181705, 6495.906833290417, 9056.877303599964, 2582.6136906843763, 9420.711083221166, 9744.672324883883, 9128.344449995446, 7832.839936310736, 9904.53076039794, 5382.422180440945, 7561.002354226981, 9742.146213655693, 9242.679520869064, 7193.423820327014, 4208.478516471567, 4157.905515248773], "policy_adversary_policy_reward": [7782.599285515243, 4094.208231751449, 2824.4015857043187, 1914.4680421327075, 8062.644636134972, 9296.330757087213, 8006.198624738717, 7820.953285991586, 1670.7147577949618, 1358.00139969362, 8377.064932718533, 6657.325894683344, 11789.904034891162, 9999.983841162963, 8070.596727486589, 9598.535009986472, 8858.783117159986, 8882.660417364681, 8050.539125344078, 7101.661916242773, 3992.7166649882297, 2432.052983467384, 5781.21237329467, 4805.47892894739, 9684.6188867388, 10717.507158757498, 5896.53452379861, 8483.41933948603, 2860.585760700112, 8965.21551401577, 4594.456628232587, 5520.26424073914, 700.4302279254096, 2597.657752041552, 7147.654074010265, 3654.9824455480243, 4553.442853992039, 10525.919697074787, 2991.140299863808, 8325.497271414051, 565.9217854673158, 1040.6886587292327, 5292.397721389164, 2350.3885463864945, 10896.343227216183, 9244.340326220243, 1310.3076631684569, 1248.5293916858188, 7621.390913551581, 6885.637015799284, 608.9072434818382, 274.56127597452326, 11150.974890453748, 8277.543532387668, 10750.526210077158, 10170.912247010641, 9413.817231073159, 8558.61499900132, 6793.226967914619, 11786.61792540881, 900.9411736957103, 2917.301959067608, 3622.1329136475892, 1716.4317009394288, 10593.341230559776, 4772.660731658188, 3303.2691101265373, 6476.141659223387, 5811.0157095232835, 6221.570602669209, 319.4319390194371, 465.2817962006376, 9390.116994596941, 9092.949523362211, 7155.410067747067, 5977.5674836326, 10148.428621082954, 7881.534282806626, 3778.2534431098566, 4542.282786690108, 4237.175318285772, 7297.9738415194, 6457.730691903176, 3201.5759718206414, 8238.339589769525, 10609.256431518683, 4783.0312114817325, 6935.745848936353, 7812.6280028332485, 8016.5350434205975, 5956.247275997997, 7667.981328700418, 9339.207201005258, 9121.336915930025, 3209.3609506688967, 2735.516958118566, 4631.515020180776, 3862.8480896842407, 7653.858306190049, 8609.642999596632, 7841.634903042549, 7184.143412327239, 4965.822250824898, 4342.364530966707, 5465.868062822701, 11155.447462323013, 8140.333295041987, 7377.580679472009, 7430.090456257554, 5968.7001136570125, 4056.1737341599146, 3660.644986031709, 4576.163336883417, 3495.569529424625, 12360.878744059035, 7373.217729368583, 4200.658848941325, 2577.941244386344, 3509.1934402941033, 4530.018726225498, 4261.881181306979, 4533.600394600759, 3782.0048358692725, 6256.002151144545, 6051.293559941801, 6552.326841257826, 6353.7472575915035, 5665.163544089128, 4778.913589933858, 5194.267154505128, 6251.600745897657, 6533.950760793743, 10062.56444017328, 8639.790910275031, 8242.274032801059, 5607.850854209743, 4086.0657104793318, 4498.154270615059, 5811.797215920005, 2322.339647121729, 8265.383574840827, 5006.379673974207, 7158.062282933162, 5431.137379977532, 3949.65132331301, 2033.3157903840424, 5094.481617310572, 4690.644053013934, 4487.577624420262, 6621.362367265305, 7211.6296377627, 7519.5510061001305, 10021.961471371289, 9533.773420509864, 5266.677804796737, 5691.384193028102, 5532.386572262164, 5423.0125398242335, 2498.2529268281955, 3306.0611994570118, 1395.0412071186054, 1498.040907761146, 7084.345628775984, 3185.294297201538, 7625.999199932769, 6086.829722870073, 6643.978995917261, 5687.928122580172, 6887.089898041888, 6360.315716259749, 7453.571371582073, 7378.5532621041075, 4292.087280317674, 5072.819179499314, 9486.581388589315, 11559.521933046584, 4721.424540509786, 2353.841131704123, 4078.877590244093, 4343.05273363216, 3953.043530267319, 5013.79117373551, 5755.262658626596, 6276.828295461844, 3204.742026588468, 4237.604863333008, 8211.363918703093, 8296.621360498557, 6581.133269503951, 4647.064749541491, 4381.31691506542, 2850.147454286361, 4406.693324563884, 4764.202978542137, 5848.734269917194, 6863.1015554837495, 6737.801881190001, 9933.65710725939, 9984.23010848219, 5155.988388455391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047523197219992, "mean_inference_ms": 1.0046238032321622, "mean_action_processing_ms": 0.16836532648900465, "mean_env_wait_ms": 0.05493886242047527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003860950469970703, "StateBufferConnector_ms": 0.0032678842544555664, "ViewRequirementAgentConnector_ms": 0.06921708583831787}, "num_episodes": 19, "episode_return_max": 24229.342585193048, "episode_return_min": 814.4066858500203, "episode_return_mean": 18583.07564297624}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.3396366072142, "num_env_steps_trained_throughput_per_sec": 513.3396366072142, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 7668.846, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7668.809, "sample_time_ms": 756.363, "learn_time_ms": 6900.706, "learn_throughput": 579.651, "synch_weights_time_ms": 11.217}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 26, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-32-46", "timestamp": 1723235566, "time_this_iter_s": 7.797595024108887, "time_total_s": 199.1431930065155, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207304c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.1431930065155, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.091666666666665, "ram_util_percent": 81.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7051698629739424, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.945607905413107, "policy_loss": -0.0024635655444519467, "vf_loss": 9.947282869349081, "vf_explained_var": -5.76812123495435e-06, "kl": 0.01051450362010174, "entropy": 0.8608492370635744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8533407979644835, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.016044885913532, "policy_loss": 0.004973715145024471, "vf_loss": 9.993922316034634, "vf_explained_var": -3.1556934118270874e-05, "kl": 0.016937160201875183, "entropy": 1.5441367952773968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": 25131.85825482061, "episode_reward_min": 814.4066858500203, "episode_reward_mean": 18369.554491809133, "episode_len_mean": 191.05, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19105, "policy_reward_min": {"agent_policy": 27.488859586054634, "adversary_policy": 274.56127597452326}, "policy_reward_max": {"agent_policy": 12763.426401809342, "adversary_policy": 12360.878744059035}, "policy_reward_mean": {"agent_policy": 6997.566465508375, "adversary_policy": 5685.994013150379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1697.292635365792, 16492.524170117456, 23386.475949951186, 15322.263456663586, 21021.160006878265, 910.9573790424159, 22374.664562314494, 24229.342585193048, 22680.772910255302, 20935.36259164556, 15043.076797426638, 15858.567324670352, 18914.796355389204, 17445.40473385745, 19855.39964345479, 814.4066858500203, 23104.506948635448, 20025.972191805053, 22023.669906537463, 17670.268578050323, 18379.31094201673, 17335.650225283014, 22364.583126481535, 18912.096065850652, 21758.5420666455, 20085.836452211337, 23106.080650602562, 16818.729378668944, 17891.408469308764, 21791.158005004057, 21317.58829719314, 18439.59106682457, 19608.003686553708, 20931.07829350936, 20110.835737387988, 16901.857996787214, 17358.08838907111, 21515.353353099483, 16586.43431329776, 17651.329064025133, 18357.535888923994, 17924.140459600156, 20073.724401901618, 19719.06896023713, 18036.315665500013, 20268.644221344057, 22781.926534006037, 19749.986477940714, 18226.090420781085, 16464.475270852694, 19148.51529770521, 19572.88362190849, 16175.45141411498, 18830.069509570832, 18629.713248151216, 21307.278361936987, 23665.293756297437, 19389.485955797052, 19445.946745296642, 16640.27983939866, 3080.4987976897564, 17327.42992093249, 20228.965346601046, 19248.76749281081, 20327.681337319835, 21328.03146697662, 18421.783763416985, 23628.71701232027, 16495.976755435066, 18166.602648760156, 18095.179153998262, 19864.930890399133, 17346.87765031939, 21890.407459642596, 18789.200373272433, 16973.61058300746, 18413.575823975167, 19905.259645727954, 20879.93750492093, 19298.124012186337, 17152.383652121658, 21064.480776166307, 18058.542393085998, 19736.47477626609, 19999.384042885697, 18821.552921621656, 17277.348387434093, 16238.250561108109, 19628.433654186752, 17888.606265816, 16190.320193930145, 5370.955031003158, 15856.992595336671, 17354.25841390962, 18500.259770983168, 16630.729337420133, 18605.7522556949, 19598.733629778715, 15061.307583439684, 25131.85825482061], "episode_lengths": [16, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [90.68219116924331, 8849.737902341789, 3245.79239651477, 12763.426401809342, 6514.132077527449, 27.488859586054634, 2946.146139473055, 3307.9041281052873, 4708.340680180762, 2355.5176983221354, 11224.833664663338, 10520.002710083365, 3548.794393171162, 7665.993964507567, 7822.813331262289, 29.692950629945653, 4621.440430676232, 6892.994640425359, 3993.7070026480055, 9349.732348250358, 6844.161782211555, 7676.3435615591825, 3516.9871051933487, 7193.319005432547, 5929.379020391678, 6461.607847512921, 4645.536533667237, 10873.851469881516, 9397.04535944376, 5527.656699217408, 6291.809981823276, 9131.404285032957, 2986.6881614079616, 5413.164318995366, 6712.045167473394, 9185.039276595593, 9286.355522763035, 1781.2568796719152, 9807.834219970098, 9612.116897505479, 9562.054313016259, 7886.133472586405, 7470.104000702057, 7700.158158556553, 8063.134921061048, 7483.092714652663, 4079.571183557669, 5899.861590929897, 9641.870439686583, 8330.338407810956, 5876.752048890124, 6983.6839589978, 10192.484300417946, 9044.943839246309, 7520.773256465642, 6576.097718074123, 4109.5588644163145, 8431.423957972202, 8490.54763321029, 10835.965713113466, 187.41668281000605, 7057.789994954968, 6516.136423798177, 6916.8603743134245, 7080.2757230181705, 6495.906833290417, 9056.877303599964, 2582.6136906843763, 9420.711083221166, 9744.672324883883, 9128.344449995446, 7832.839936310736, 9904.53076039794, 5382.422180440945, 7561.002354226981, 9742.146213655693, 9242.679520869064, 7193.423820327014, 4208.478516471567, 4157.905515248773, 8454.535475269486, 6608.661461613156, 9124.615610641906, 6576.696312110498, 7941.0220455940225, 7660.0093828763265, 6931.424941090547, 10323.523326051634, 8167.63534833444, 8889.001221466742, 9987.297590385897, 710.4556890746006, 11424.756151947415, 9185.866546822119, 8372.45317395235, 8718.85128776146, 8186.622970894729, 6655.773236617105, 10590.159513277058, 2902.924062075349], "policy_adversary_policy_reward": [565.9217854673158, 1040.6886587292327, 5292.397721389164, 2350.3885463864945, 10896.343227216183, 9244.340326220243, 1310.3076631684569, 1248.5293916858188, 7621.390913551581, 6885.637015799284, 608.9072434818382, 274.56127597452326, 11150.974890453748, 8277.543532387668, 10750.526210077158, 10170.912247010641, 9413.817231073159, 8558.61499900132, 6793.226967914619, 11786.61792540881, 900.9411736957103, 2917.301959067608, 3622.1329136475892, 1716.4317009394288, 10593.341230559776, 4772.660731658188, 3303.2691101265373, 6476.141659223387, 5811.0157095232835, 6221.570602669209, 319.4319390194371, 465.2817962006376, 9390.116994596941, 9092.949523362211, 7155.410067747067, 5977.5674836326, 10148.428621082954, 7881.534282806626, 3778.2534431098566, 4542.282786690108, 4237.175318285772, 7297.9738415194, 6457.730691903176, 3201.5759718206414, 8238.339589769525, 10609.256431518683, 4783.0312114817325, 6935.745848936353, 7812.6280028332485, 8016.5350434205975, 5956.247275997997, 7667.981328700418, 9339.207201005258, 9121.336915930025, 3209.3609506688967, 2735.516958118566, 4631.515020180776, 3862.8480896842407, 7653.858306190049, 8609.642999596632, 7841.634903042549, 7184.143412327239, 4965.822250824898, 4342.364530966707, 5465.868062822701, 11155.447462323013, 8140.333295041987, 7377.580679472009, 7430.090456257554, 5968.7001136570125, 4056.1737341599146, 3660.644986031709, 4576.163336883417, 3495.569529424625, 12360.878744059035, 7373.217729368583, 4200.658848941325, 2577.941244386344, 3509.1934402941033, 4530.018726225498, 4261.881181306979, 4533.600394600759, 3782.0048358692725, 6256.002151144545, 6051.293559941801, 6552.326841257826, 6353.7472575915035, 5665.163544089128, 4778.913589933858, 5194.267154505128, 6251.600745897657, 6533.950760793743, 10062.56444017328, 8639.790910275031, 8242.274032801059, 5607.850854209743, 4086.0657104793318, 4498.154270615059, 5811.797215920005, 2322.339647121729, 8265.383574840827, 5006.379673974207, 7158.062282933162, 5431.137379977532, 3949.65132331301, 2033.3157903840424, 5094.481617310572, 4690.644053013934, 4487.577624420262, 6621.362367265305, 7211.6296377627, 7519.5510061001305, 10021.961471371289, 9533.773420509864, 5266.677804796737, 5691.384193028102, 5532.386572262164, 5423.0125398242335, 2498.2529268281955, 3306.0611994570118, 1395.0412071186054, 1498.040907761146, 7084.345628775984, 3185.294297201538, 7625.999199932769, 6086.829722870073, 6643.978995917261, 5687.928122580172, 6887.089898041888, 6360.315716259749, 7453.571371582073, 7378.5532621041075, 4292.087280317674, 5072.819179499314, 9486.581388589315, 11559.521933046584, 4721.424540509786, 2353.841131704123, 4078.877590244093, 4343.05273363216, 3953.043530267319, 5013.79117373551, 5755.262658626596, 6276.828295461844, 3204.742026588468, 4237.604863333008, 8211.363918703093, 8296.621360498557, 6581.133269503951, 4647.064749541491, 4381.31691506542, 2850.147454286361, 4406.693324563884, 4764.202978542137, 5848.734269917194, 6863.1015554837495, 6737.801881190001, 9933.65710725939, 9984.23010848219, 5155.988388455391, 3010.2480283907144, 5687.600148461458, 7239.900146630626, 7215.919167922621, 4445.386361840647, 4488.54042060337, 5594.371963005324, 7565.406501150291, 5936.122265167297, 6122.239732124375, 6285.334955347775, 4876.20858339758, 7210.710682640409, 3135.2127637030962, 3818.6122976793245, 2096.114937377101, 5501.064858437221, 5959.733447415091, 4875.744756922206, 4123.860287427073, 4154.838033345031, 2048.1845701992056, 1910.567069089083, 2749.9322728394745, 1714.8569716057389, 2717.379471783537, 3891.9948495982526, 4276.3970174892675, 5746.675862031681, 4381.1307349991575, 5423.284335969495, 2488.593713689167, 5955.512652836231, 4463.616631963936, 5456.598006047765, 7486.362387113847, 919.1719597087415, 3551.9761104539007, 11230.834190625312, 10998.100002120065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40462031602966186, "mean_inference_ms": 1.0042020570679768, "mean_action_processing_ms": 0.16836664791938968, "mean_env_wait_ms": 0.05496992082703429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005161285400390625, "StateBufferConnector_ms": 0.003338456153869629, "ViewRequirementAgentConnector_ms": 0.07416987419128418}, "num_episodes": 20, "episode_return_max": 25131.85825482061, "episode_return_min": 814.4066858500203, "episode_return_mean": 18369.554491809133}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.3612948658882, "num_env_steps_trained_throughput_per_sec": 534.3612948658882, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 7628.505, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7628.468, "sample_time_ms": 757.474, "learn_time_ms": 6859.389, "learn_throughput": 583.142, "synch_weights_time_ms": 11.085}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 27, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-32-54", "timestamp": 1723235574, "time_this_iter_s": 7.491145849227905, "time_total_s": 206.6343388557434, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207224c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.6343388557434, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 26.339999999999996, "ram_util_percent": 81.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5986735877378908, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990459669708574, "policy_loss": -5.6991804263027254e-05, "vf_loss": 9.989724174378411, "vf_explained_var": 8.593901755317809e-05, "kl": 0.010566416079001058, "entropy": 0.8146490517432097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8601355058761935, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999546162287395, "policy_loss": -0.003751017559261527, "vf_loss": 9.994739036758741, "vf_explained_var": -1.5890846649805706e-05, "kl": 0.00845248362311395, "entropy": 1.5440415777266026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 25131.85825482061, "episode_reward_min": 1226.4522518850633, "episode_reward_mean": 18653.056306080573, "episode_len_mean": 194.84, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 19484, "policy_reward_min": {"agent_policy": 39.367882395556734, "adversary_policy": 448.63479257986097}, "policy_reward_max": {"agent_policy": 11424.756151947415, "adversary_policy": 12360.878744059035}, "policy_reward_mean": {"agent_policy": 7412.04984764655, "adversary_policy": 5620.503229217013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21758.5420666455, 20085.836452211337, 23106.080650602562, 16818.729378668944, 17891.408469308764, 21791.158005004057, 21317.58829719314, 18439.59106682457, 19608.003686553708, 20931.07829350936, 20110.835737387988, 16901.857996787214, 17358.08838907111, 21515.353353099483, 16586.43431329776, 17651.329064025133, 18357.535888923994, 17924.140459600156, 20073.724401901618, 19719.06896023713, 18036.315665500013, 20268.644221344057, 22781.926534006037, 19749.986477940714, 18226.090420781085, 16464.475270852694, 19148.51529770521, 19572.88362190849, 16175.45141411498, 18830.069509570832, 18629.713248151216, 21307.278361936987, 23665.293756297437, 19389.485955797052, 19445.946745296642, 16640.27983939866, 3080.4987976897564, 17327.42992093249, 20228.965346601046, 19248.76749281081, 20327.681337319835, 21328.03146697662, 18421.783763416985, 23628.71701232027, 16495.976755435066, 18166.602648760156, 18095.179153998262, 19864.930890399133, 17346.87765031939, 21890.407459642596, 18789.200373272433, 16973.61058300746, 18413.575823975167, 19905.259645727954, 20879.93750492093, 19298.124012186337, 17152.383652121658, 21064.480776166307, 18058.542393085998, 19736.47477626609, 19999.384042885697, 18821.552921621656, 17277.348387434093, 16238.250561108109, 19628.433654186752, 17888.606265816, 16190.320193930145, 5370.955031003158, 15856.992595336671, 17354.25841390962, 18500.259770983168, 16630.729337420133, 18605.7522556949, 19598.733629778715, 15061.307583439684, 25131.85825482061, 16899.267984492228, 21816.058178923395, 17395.87913291642, 19847.769616531088, 19607.0682029787, 1226.4522518850633, 19224.56240953603, 20108.04637566095, 18881.11972975775, 19460.378753133013, 22131.94688427553, 19496.09230961661, 21288.11761405054, 20612.398870097375, 16097.669775655933, 18994.768125515424, 15054.69182848588, 18486.48530374746, 22796.67117851429, 16727.21470121145, 20892.971550442406, 21669.328500982698, 18298.20196473693, 18135.54595673264], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5929.379020391678, 6461.607847512921, 4645.536533667237, 10873.851469881516, 9397.04535944376, 5527.656699217408, 6291.809981823276, 9131.404285032957, 2986.6881614079616, 5413.164318995366, 6712.045167473394, 9185.039276595593, 9286.355522763035, 1781.2568796719152, 9807.834219970098, 9612.116897505479, 9562.054313016259, 7886.133472586405, 7470.104000702057, 7700.158158556553, 8063.134921061048, 7483.092714652663, 4079.571183557669, 5899.861590929897, 9641.870439686583, 8330.338407810956, 5876.752048890124, 6983.6839589978, 10192.484300417946, 9044.943839246309, 7520.773256465642, 6576.097718074123, 4109.5588644163145, 8431.423957972202, 8490.54763321029, 10835.965713113466, 187.41668281000605, 7057.789994954968, 6516.136423798177, 6916.8603743134245, 7080.2757230181705, 6495.906833290417, 9056.877303599964, 2582.6136906843763, 9420.711083221166, 9744.672324883883, 9128.344449995446, 7832.839936310736, 9904.53076039794, 5382.422180440945, 7561.002354226981, 9742.146213655693, 9242.679520869064, 7193.423820327014, 4208.478516471567, 4157.905515248773, 8454.535475269486, 6608.661461613156, 9124.615610641906, 6576.696312110498, 7941.0220455940225, 7660.0093828763265, 6931.424941090547, 10323.523326051634, 8167.63534833444, 8889.001221466742, 9987.297590385897, 710.4556890746006, 11424.756151947415, 9185.866546822119, 8372.45317395235, 8718.85128776146, 8186.622970894729, 6655.773236617105, 10590.159513277058, 2902.924062075349, 9203.997440592828, 5638.027032524455, 9500.20574812056, 7677.357819572651, 6896.155371091391, 39.367882395556734, 7854.63929330338, 6478.358790128336, 7476.223518459998, 8510.394854315378, 5296.95714303532, 7462.916159374704, 6294.735368189728, 7388.854401901044, 8708.441246041059, 8335.031840722164, 11170.211316481367, 9125.53104561438, 4432.708030556453, 8393.478339528618, 6793.589998117845, 5990.21071769316, 9834.41946943169, 8656.510752369282], "policy_adversary_policy_reward": [7812.6280028332485, 8016.5350434205975, 5956.247275997997, 7667.981328700418, 9339.207201005258, 9121.336915930025, 3209.3609506688967, 2735.516958118566, 4631.515020180776, 3862.8480896842407, 7653.858306190049, 8609.642999596632, 7841.634903042549, 7184.143412327239, 4965.822250824898, 4342.364530966707, 5465.868062822701, 11155.447462323013, 8140.333295041987, 7377.580679472009, 7430.090456257554, 5968.7001136570125, 4056.1737341599146, 3660.644986031709, 4576.163336883417, 3495.569529424625, 12360.878744059035, 7373.217729368583, 4200.658848941325, 2577.941244386344, 3509.1934402941033, 4530.018726225498, 4261.881181306979, 4533.600394600759, 3782.0048358692725, 6256.002151144545, 6051.293559941801, 6552.326841257826, 6353.7472575915035, 5665.163544089128, 4778.913589933858, 5194.267154505128, 6251.600745897657, 6533.950760793743, 10062.56444017328, 8639.790910275031, 8242.274032801059, 5607.850854209743, 4086.0657104793318, 4498.154270615059, 5811.797215920005, 2322.339647121729, 8265.383574840827, 5006.379673974207, 7158.062282933162, 5431.137379977532, 3949.65132331301, 2033.3157903840424, 5094.481617310572, 4690.644053013934, 4487.577624420262, 6621.362367265305, 7211.6296377627, 7519.5510061001305, 10021.961471371289, 9533.773420509864, 5266.677804796737, 5691.384193028102, 5532.386572262164, 5423.0125398242335, 2498.2529268281955, 3306.0611994570118, 1395.0412071186054, 1498.040907761146, 7084.345628775984, 3185.294297201538, 7625.999199932769, 6086.829722870073, 6643.978995917261, 5687.928122580172, 6887.089898041888, 6360.315716259749, 7453.571371582073, 7378.5532621041075, 4292.087280317674, 5072.819179499314, 9486.581388589315, 11559.521933046584, 4721.424540509786, 2353.841131704123, 4078.877590244093, 4343.05273363216, 3953.043530267319, 5013.79117373551, 5755.262658626596, 6276.828295461844, 3204.742026588468, 4237.604863333008, 8211.363918703093, 8296.621360498557, 6581.133269503951, 4647.064749541491, 4381.31691506542, 2850.147454286361, 4406.693324563884, 4764.202978542137, 5848.734269917194, 6863.1015554837495, 6737.801881190001, 9933.65710725939, 9984.23010848219, 5155.988388455391, 3010.2480283907144, 5687.600148461458, 7239.900146630626, 7215.919167922621, 4445.386361840647, 4488.54042060337, 5594.371963005324, 7565.406501150291, 5936.122265167297, 6122.239732124375, 6285.334955347775, 4876.20858339758, 7210.710682640409, 3135.2127637030962, 3818.6122976793245, 2096.114937377101, 5501.064858437221, 5959.733447415091, 4875.744756922206, 4123.860287427073, 4154.838033345031, 2048.1845701992056, 1910.567069089083, 2749.9322728394745, 1714.8569716057389, 2717.379471783537, 3891.9948495982526, 4276.3970174892675, 5746.675862031681, 4381.1307349991575, 5423.284335969495, 2488.593713689167, 5955.512652836231, 4463.616631963936, 5456.598006047765, 7486.362387113847, 919.1719597087415, 3551.9761104539007, 11230.834190625312, 10998.100002120065, 2757.132360761266, 4938.138183138109, 8456.576347161865, 7721.454799237074, 4641.929875610395, 3253.7435091854504, 5784.032321652499, 6386.37947530591, 7245.980252639559, 5464.932579247724, 448.63479257986097, 738.4495769096454, 5082.426785805128, 6287.496330427572, 5989.693027178972, 7639.994558353647, 6558.473531409362, 4846.422679888382, 5345.685561570894, 5604.298337246701, 8100.772615283167, 8734.217125957022, 6672.316855914066, 5360.859294327871, 7720.156078367781, 7273.226167493026, 6635.952129721112, 6587.592338475191, 5433.694377689904, 1955.5341519250267, 4886.1484754279645, 5773.587809365247, 912.5562047549528, 2971.9243072495847, 4395.753818086373, 4965.20044004666, 9610.519607299899, 8753.44354065791, 5748.6572842023415, 2585.0790774805355, 7343.542640200875, 6755.838912123672, 7838.604134670495, 7840.513648619021, 4205.772833161309, 4258.009662143966, 3993.4103330016915, 5485.624871361672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4041220978902543, "mean_inference_ms": 1.0030153049471615, "mean_action_processing_ms": 0.16832767873888355, "mean_env_wait_ms": 0.05489912685313476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004588484764099121, "StateBufferConnector_ms": 0.0029567480087280273, "ViewRequirementAgentConnector_ms": 0.07359719276428223}, "num_episodes": 24, "episode_return_max": 25131.85825482061, "episode_return_min": 1226.4522518850633, "episode_return_mean": 18653.056306080573}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.5086744317307, "num_env_steps_trained_throughput_per_sec": 534.5086744317307, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 7612.324, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7612.287, "sample_time_ms": 753.88, "learn_time_ms": 6847.106, "learn_throughput": 584.188, "synch_weights_time_ms": 10.823}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 28, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-01", "timestamp": 1723235581, "time_this_iter_s": 7.487472295761108, "time_total_s": 214.12181115150452, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320722670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.12181115150452, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 28.099999999999998, "ram_util_percent": 81.63636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6187235776394132, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995666084592305, "policy_loss": 0.0008028563318981064, "vf_loss": 9.993538891323029, "vf_explained_var": 4.891743735661583e-06, "kl": 0.017657825432067353, "entropy": 0.8222388819727318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.844317162130028, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9950972845157, "policy_loss": -0.007302756515855435, "vf_loss": 9.995616471767425, "vf_explained_var": 1.6194519897301992e-05, "kl": 0.006699820938714159, "entropy": 1.5347080059349536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 25131.85825482061, "episode_reward_min": 1226.4522518850633, "episode_reward_mean": 18526.54644109866, "episode_len_mean": 193.24, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19324, "policy_reward_min": {"agent_policy": 39.367882395556734, "adversary_policy": 448.63479257986097}, "policy_reward_max": {"agent_policy": 11424.756151947415, "adversary_policy": 11559.521933046584}, "policy_reward_mean": {"agent_policy": 7331.523016380067, "adversary_policy": 5597.511712359294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18036.315665500013, 20268.644221344057, 22781.926534006037, 19749.986477940714, 18226.090420781085, 16464.475270852694, 19148.51529770521, 19572.88362190849, 16175.45141411498, 18830.069509570832, 18629.713248151216, 21307.278361936987, 23665.293756297437, 19389.485955797052, 19445.946745296642, 16640.27983939866, 3080.4987976897564, 17327.42992093249, 20228.965346601046, 19248.76749281081, 20327.681337319835, 21328.03146697662, 18421.783763416985, 23628.71701232027, 16495.976755435066, 18166.602648760156, 18095.179153998262, 19864.930890399133, 17346.87765031939, 21890.407459642596, 18789.200373272433, 16973.61058300746, 18413.575823975167, 19905.259645727954, 20879.93750492093, 19298.124012186337, 17152.383652121658, 21064.480776166307, 18058.542393085998, 19736.47477626609, 19999.384042885697, 18821.552921621656, 17277.348387434093, 16238.250561108109, 19628.433654186752, 17888.606265816, 16190.320193930145, 5370.955031003158, 15856.992595336671, 17354.25841390962, 18500.259770983168, 16630.729337420133, 18605.7522556949, 19598.733629778715, 15061.307583439684, 25131.85825482061, 16899.267984492228, 21816.058178923395, 17395.87913291642, 19847.769616531088, 19607.0682029787, 1226.4522518850633, 19224.56240953603, 20108.04637566095, 18881.11972975775, 19460.378753133013, 22131.94688427553, 19496.09230961661, 21288.11761405054, 20612.398870097375, 16097.669775655933, 18994.768125515424, 15054.69182848588, 18486.48530374746, 22796.67117851429, 16727.21470121145, 20892.971550442406, 21669.328500982698, 18298.20196473693, 18135.54595673264, 23128.41053696948, 17095.882157229757, 22633.7297520783, 17051.407103139718, 18080.64738185072, 16508.176936487936, 20392.891874615925, 18450.206650882512, 20150.676891494313, 17395.862834509106, 19196.546756206477, 21306.64255034225, 22009.17948906226, 20528.340310272113, 19614.03882317374, 20624.90706828113, 18328.016480059596, 18639.772268622408, 4782.231572846767, 19377.830994537686], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200], "policy_agent_policy_reward": [8063.134921061048, 7483.092714652663, 4079.571183557669, 5899.861590929897, 9641.870439686583, 8330.338407810956, 5876.752048890124, 6983.6839589978, 10192.484300417946, 9044.943839246309, 7520.773256465642, 6576.097718074123, 4109.5588644163145, 8431.423957972202, 8490.54763321029, 10835.965713113466, 187.41668281000605, 7057.789994954968, 6516.136423798177, 6916.8603743134245, 7080.2757230181705, 6495.906833290417, 9056.877303599964, 2582.6136906843763, 9420.711083221166, 9744.672324883883, 9128.344449995446, 7832.839936310736, 9904.53076039794, 5382.422180440945, 7561.002354226981, 9742.146213655693, 9242.679520869064, 7193.423820327014, 4208.478516471567, 4157.905515248773, 8454.535475269486, 6608.661461613156, 9124.615610641906, 6576.696312110498, 7941.0220455940225, 7660.0093828763265, 6931.424941090547, 10323.523326051634, 8167.63534833444, 8889.001221466742, 9987.297590385897, 710.4556890746006, 11424.756151947415, 9185.866546822119, 8372.45317395235, 8718.85128776146, 8186.622970894729, 6655.773236617105, 10590.159513277058, 2902.924062075349, 9203.997440592828, 5638.027032524455, 9500.20574812056, 7677.357819572651, 6896.155371091391, 39.367882395556734, 7854.63929330338, 6478.358790128336, 7476.223518459998, 8510.394854315378, 5296.95714303532, 7462.916159374704, 6294.735368189728, 7388.854401901044, 8708.441246041059, 8335.031840722164, 11170.211316481367, 9125.53104561438, 4432.708030556453, 8393.478339528618, 6793.589998117845, 5990.21071769316, 9834.41946943169, 8656.510752369282, 4637.4290306772755, 9017.366373697125, 5151.046322696348, 9532.418947529784, 6776.043712397309, 10872.524781999397, 5042.4038565373685, 8710.299198288456, 7613.0780714326565, 8539.453876706808, 6497.521202469181, 5877.076077152089, 5020.276444920896, 6693.515745370304, 8049.820236362802, 6250.641916062239, 9510.872544884356, 7896.322637136381, 298.23631984184425, 5622.21116340426], "policy_adversary_policy_reward": [4778.913589933858, 5194.267154505128, 6251.600745897657, 6533.950760793743, 10062.56444017328, 8639.790910275031, 8242.274032801059, 5607.850854209743, 4086.0657104793318, 4498.154270615059, 5811.797215920005, 2322.339647121729, 8265.383574840827, 5006.379673974207, 7158.062282933162, 5431.137379977532, 3949.65132331301, 2033.3157903840424, 5094.481617310572, 4690.644053013934, 4487.577624420262, 6621.362367265305, 7211.6296377627, 7519.5510061001305, 10021.961471371289, 9533.773420509864, 5266.677804796737, 5691.384193028102, 5532.386572262164, 5423.0125398242335, 2498.2529268281955, 3306.0611994570118, 1395.0412071186054, 1498.040907761146, 7084.345628775984, 3185.294297201538, 7625.999199932769, 6086.829722870073, 6643.978995917261, 5687.928122580172, 6887.089898041888, 6360.315716259749, 7453.571371582073, 7378.5532621041075, 4292.087280317674, 5072.819179499314, 9486.581388589315, 11559.521933046584, 4721.424540509786, 2353.841131704123, 4078.877590244093, 4343.05273363216, 3953.043530267319, 5013.79117373551, 5755.262658626596, 6276.828295461844, 3204.742026588468, 4237.604863333008, 8211.363918703093, 8296.621360498557, 6581.133269503951, 4647.064749541491, 4381.31691506542, 2850.147454286361, 4406.693324563884, 4764.202978542137, 5848.734269917194, 6863.1015554837495, 6737.801881190001, 9933.65710725939, 9984.23010848219, 5155.988388455391, 3010.2480283907144, 5687.600148461458, 7239.900146630626, 7215.919167922621, 4445.386361840647, 4488.54042060337, 5594.371963005324, 7565.406501150291, 5936.122265167297, 6122.239732124375, 6285.334955347775, 4876.20858339758, 7210.710682640409, 3135.2127637030962, 3818.6122976793245, 2096.114937377101, 5501.064858437221, 5959.733447415091, 4875.744756922206, 4123.860287427073, 4154.838033345031, 2048.1845701992056, 1910.567069089083, 2749.9322728394745, 1714.8569716057389, 2717.379471783537, 3891.9948495982526, 4276.3970174892675, 5746.675862031681, 4381.1307349991575, 5423.284335969495, 2488.593713689167, 5955.512652836231, 4463.616631963936, 5456.598006047765, 7486.362387113847, 919.1719597087415, 3551.9761104539007, 11230.834190625312, 10998.100002120065, 2757.132360761266, 4938.138183138109, 8456.576347161865, 7721.454799237074, 4641.929875610395, 3253.7435091854504, 5784.032321652499, 6386.37947530591, 7245.980252639559, 5464.932579247724, 448.63479257986097, 738.4495769096454, 5082.426785805128, 6287.496330427572, 5989.693027178972, 7639.994558353647, 6558.473531409362, 4846.422679888382, 5345.685561570894, 5604.298337246701, 8100.772615283167, 8734.217125957022, 6672.316855914066, 5360.859294327871, 7720.156078367781, 7273.226167493026, 6635.952129721112, 6587.592338475191, 5433.694377689904, 1955.5341519250267, 4886.1484754279645, 5773.587809365247, 912.5562047549528, 2971.9243072495847, 4395.753818086373, 4965.20044004666, 9610.519607299899, 8753.44354065791, 5748.6572842023415, 2585.0790774805355, 7343.542640200875, 6755.838912123672, 7838.604134670495, 7840.513648619021, 4205.772833161309, 4258.009662143966, 3993.4103330016915, 5485.624871361672, 8995.151705093756, 9495.829801198386, 5124.769250033832, 2953.746533498815, 8565.216892412654, 8917.466536969234, 2909.2714794087674, 4609.71667620117, 7366.091911333646, 3938.511758119732, 2370.261203645038, 3265.3909508434485, 9070.9698591582, 6279.518158920419, 4351.4892450172465, 5388.418207576769, 6395.492516720999, 6142.1063033406135, 3253.7272107781837, 5602.681747024142, 7644.614421261764, 5054.411132475517, 8265.059546578856, 7164.506926611276, 9053.190060023646, 7935.712984117735, 7022.8750983147675, 6811.949466587033, 5735.063528992117, 5829.155057818782, 7891.4937076687065, 6482.771444550187, 4622.520636543631, 4194.623298631574, 6245.812986594568, 4497.636644891463, 1996.4811862628108, 2487.5140667421106, 8519.924460326702, 5235.695370806787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4033138413563298, "mean_inference_ms": 1.0013066846526721, "mean_action_processing_ms": 0.16819692825667182, "mean_env_wait_ms": 0.05471777136934182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004455685615539551, "StateBufferConnector_ms": 0.0028711557388305664, "ViewRequirementAgentConnector_ms": 0.07272934913635254}, "num_episodes": 20, "episode_return_max": 25131.85825482061, "episode_return_min": 1226.4522518850633, "episode_return_mean": 18526.54644109866}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.0975371382245, "num_env_steps_trained_throughput_per_sec": 544.0975371382245, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 7597.775, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7597.738, "sample_time_ms": 750.569, "learn_time_ms": 6836.059, "learn_throughput": 585.132, "synch_weights_time_ms": 10.628}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 29, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-09", "timestamp": 1723235589, "time_this_iter_s": 7.356184005737305, "time_total_s": 221.47799515724182, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320722820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.47799515724182, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.527272727272727, "ram_util_percent": 81.62727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6466612904554322, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00955705945454, "policy_loss": 0.008691847242326254, "vf_loss": 9.997296497304603, "vf_explained_var": 1.7939421234938202e-05, "kl": 0.04758255172757402, "entropy": 0.9292658930102353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8594923828728497, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.991470172007878, "policy_loss": -0.007835520595593455, "vf_loss": 9.991256840030353, "vf_explained_var": 7.39075243473053e-05, "kl": 0.007949490649722672, "entropy": 1.5299432698637248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 25131.85825482061, "episode_reward_min": 300.9484023069367, "episode_reward_mean": 18246.226708298454, "episode_len_mean": 191.49, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19149, "policy_reward_min": {"agent_policy": 6.2050954630685204, "adversary_policy": 88.81636795097245}, "policy_reward_max": {"agent_policy": 11856.652604173112, "adversary_policy": 11559.521933046584}, "policy_reward_mean": {"agent_policy": 7394.52985217717, "adversary_policy": 5425.848428060642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21328.03146697662, 18421.783763416985, 23628.71701232027, 16495.976755435066, 18166.602648760156, 18095.179153998262, 19864.930890399133, 17346.87765031939, 21890.407459642596, 18789.200373272433, 16973.61058300746, 18413.575823975167, 19905.259645727954, 20879.93750492093, 19298.124012186337, 17152.383652121658, 21064.480776166307, 18058.542393085998, 19736.47477626609, 19999.384042885697, 18821.552921621656, 17277.348387434093, 16238.250561108109, 19628.433654186752, 17888.606265816, 16190.320193930145, 5370.955031003158, 15856.992595336671, 17354.25841390962, 18500.259770983168, 16630.729337420133, 18605.7522556949, 19598.733629778715, 15061.307583439684, 25131.85825482061, 16899.267984492228, 21816.058178923395, 17395.87913291642, 19847.769616531088, 19607.0682029787, 1226.4522518850633, 19224.56240953603, 20108.04637566095, 18881.11972975775, 19460.378753133013, 22131.94688427553, 19496.09230961661, 21288.11761405054, 20612.398870097375, 16097.669775655933, 18994.768125515424, 15054.69182848588, 18486.48530374746, 22796.67117851429, 16727.21470121145, 20892.971550442406, 21669.328500982698, 18298.20196473693, 18135.54595673264, 23128.41053696948, 17095.882157229757, 22633.7297520783, 17051.407103139718, 18080.64738185072, 16508.176936487936, 20392.891874615925, 18450.206650882512, 20150.676891494313, 17395.862834509106, 19196.546756206477, 21306.64255034225, 22009.17948906226, 20528.340310272113, 19614.03882317374, 20624.90706828113, 18328.016480059596, 18639.772268622408, 4782.231572846767, 19377.830994537686, 17100.10890484622, 17686.79415279607, 18231.84753970671, 16816.681813113853, 19375.01895522861, 20097.61261405202, 18421.21953184793, 16817.488798835755, 18408.043206648115, 20868.787261657377, 14923.488740034467, 5430.103047368951, 18343.234479783387, 22275.20026753441, 18503.61082863666, 19405.245845036523, 300.9484023069367, 19690.21055006462, 19616.960036593133, 17828.211565153066, 20372.909414690905], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 3, 200, 200, 200, 200], "policy_agent_policy_reward": [6495.906833290417, 9056.877303599964, 2582.6136906843763, 9420.711083221166, 9744.672324883883, 9128.344449995446, 7832.839936310736, 9904.53076039794, 5382.422180440945, 7561.002354226981, 9742.146213655693, 9242.679520869064, 7193.423820327014, 4208.478516471567, 4157.905515248773, 8454.535475269486, 6608.661461613156, 9124.615610641906, 6576.696312110498, 7941.0220455940225, 7660.0093828763265, 6931.424941090547, 10323.523326051634, 8167.63534833444, 8889.001221466742, 9987.297590385897, 710.4556890746006, 11424.756151947415, 9185.866546822119, 8372.45317395235, 8718.85128776146, 8186.622970894729, 6655.773236617105, 10590.159513277058, 2902.924062075349, 9203.997440592828, 5638.027032524455, 9500.20574812056, 7677.357819572651, 6896.155371091391, 39.367882395556734, 7854.63929330338, 6478.358790128336, 7476.223518459998, 8510.394854315378, 5296.95714303532, 7462.916159374704, 6294.735368189728, 7388.854401901044, 8708.441246041059, 8335.031840722164, 11170.211316481367, 9125.53104561438, 4432.708030556453, 8393.478339528618, 6793.589998117845, 5990.21071769316, 9834.41946943169, 8656.510752369282, 4637.4290306772755, 9017.366373697125, 5151.046322696348, 9532.418947529784, 6776.043712397309, 10872.524781999397, 5042.4038565373685, 8710.299198288456, 7613.0780714326565, 8539.453876706808, 6497.521202469181, 5877.076077152089, 5020.276444920896, 6693.515745370304, 8049.820236362802, 6250.641916062239, 9510.872544884356, 7896.322637136381, 298.23631984184425, 5622.21116340426, 9829.653424692182, 9244.346107296105, 9480.482877539738, 8220.015842417724, 8476.295633717516, 5623.087942875346, 9692.285228026001, 9206.197242477245, 7416.3752580851715, 7056.597491442481, 11856.652604173112, 764.9704892811174, 9160.27996781269, 3976.8008955550017, 8732.357884633573, 7610.577684523445, 6.2050954630685204, 8121.894546781977, 5894.262126658054, 8363.89030178294, 6886.034681873547], "policy_adversary_policy_reward": [7453.571371582073, 7378.5532621041075, 4292.087280317674, 5072.819179499314, 9486.581388589315, 11559.521933046584, 4721.424540509786, 2353.841131704123, 4078.877590244093, 4343.05273363216, 3953.043530267319, 5013.79117373551, 5755.262658626596, 6276.828295461844, 3204.742026588468, 4237.604863333008, 8211.363918703093, 8296.621360498557, 6581.133269503951, 4647.064749541491, 4381.31691506542, 2850.147454286361, 4406.693324563884, 4764.202978542137, 5848.734269917194, 6863.1015554837495, 6737.801881190001, 9933.65710725939, 9984.23010848219, 5155.988388455391, 3010.2480283907144, 5687.600148461458, 7239.900146630626, 7215.919167922621, 4445.386361840647, 4488.54042060337, 5594.371963005324, 7565.406501150291, 5936.122265167297, 6122.239732124375, 6285.334955347775, 4876.20858339758, 7210.710682640409, 3135.2127637030962, 3818.6122976793245, 2096.114937377101, 5501.064858437221, 5959.733447415091, 4875.744756922206, 4123.860287427073, 4154.838033345031, 2048.1845701992056, 1910.567069089083, 2749.9322728394745, 1714.8569716057389, 2717.379471783537, 3891.9948495982526, 4276.3970174892675, 5746.675862031681, 4381.1307349991575, 5423.284335969495, 2488.593713689167, 5955.512652836231, 4463.616631963936, 5456.598006047765, 7486.362387113847, 919.1719597087415, 3551.9761104539007, 11230.834190625312, 10998.100002120065, 2757.132360761266, 4938.138183138109, 8456.576347161865, 7721.454799237074, 4641.929875610395, 3253.7435091854504, 5784.032321652499, 6386.37947530591, 7245.980252639559, 5464.932579247724, 448.63479257986097, 738.4495769096454, 5082.426785805128, 6287.496330427572, 5989.693027178972, 7639.994558353647, 6558.473531409362, 4846.422679888382, 5345.685561570894, 5604.298337246701, 8100.772615283167, 8734.217125957022, 6672.316855914066, 5360.859294327871, 7720.156078367781, 7273.226167493026, 6635.952129721112, 6587.592338475191, 5433.694377689904, 1955.5341519250267, 4886.1484754279645, 5773.587809365247, 912.5562047549528, 2971.9243072495847, 4395.753818086373, 4965.20044004666, 9610.519607299899, 8753.44354065791, 5748.6572842023415, 2585.0790774805355, 7343.542640200875, 6755.838912123672, 7838.604134670495, 7840.513648619021, 4205.772833161309, 4258.009662143966, 3993.4103330016915, 5485.624871361672, 8995.151705093756, 9495.829801198386, 5124.769250033832, 2953.746533498815, 8565.216892412654, 8917.466536969234, 2909.2714794087674, 4609.71667620117, 7366.091911333646, 3938.511758119732, 2370.261203645038, 3265.3909508434485, 9070.9698591582, 6279.518158920419, 4351.4892450172465, 5388.418207576769, 6395.492516720999, 6142.1063033406135, 3253.7272107781837, 5602.681747024142, 7644.614421261764, 5054.411132475517, 8265.059546578856, 7164.506926611276, 9053.190060023646, 7935.712984117735, 7022.8750983147675, 6811.949466587033, 5735.063528992117, 5829.155057818782, 7891.4937076687065, 6482.771444550187, 4622.520636543631, 4194.623298631574, 6245.812986594568, 4497.636644891463, 1996.4811862628108, 2487.5140667421106, 8519.924460326702, 5235.695370806787, 3040.954413789545, 4229.501066364492, 4745.309609357272, 3697.1384361426785, 4656.470979622409, 4094.8936825445476, 2674.5461893828574, 5922.119781313235, 5232.883331497619, 5665.839990013432, 5955.476990321061, 8519.04768085562, 4427.015008239303, 4301.9192955826675, 4935.93838125372, 2675.353175104836, 6725.760365645776, 4265.907582917077, 6743.820703166707, 7068.369067048275, 2285.483019557813, 781.3531163035026, 2483.1584494812187, 2181.9741086066138, 4204.302244748332, 4978.652267222402, 9524.457069593227, 8773.942302386145, 4659.119676241626, 5112.133267761443, 5340.236544754683, 6454.431615758427, 88.81636795097245, 205.92693889289575, 5992.176483866577, 5576.139519416092, 5940.306843622281, 7782.391066312766, 5778.245321948009, 3686.075941422078, 6230.773790959981, 7256.1009418574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026467766278718, "mean_inference_ms": 0.9980645816471942, "mean_action_processing_ms": 0.16776776041215805, "mean_env_wait_ms": 0.05455905665187471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004394412040710449, "StateBufferConnector_ms": 0.0025364160537719727, "ViewRequirementAgentConnector_ms": 0.07109081745147705}, "num_episodes": 21, "episode_return_max": 25131.85825482061, "episode_return_min": 300.9484023069367, "episode_return_mean": 18246.226708298454}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 526.8085484254759, "num_env_steps_trained_throughput_per_sec": 526.8085484254759, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 7606.7, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7606.663, "sample_time_ms": 751.616, "learn_time_ms": 6843.695, "learn_throughput": 584.48, "synch_weights_time_ms": 10.865}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 30, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-16", "timestamp": 1723235596, "time_this_iter_s": 7.598278284072876, "time_total_s": 229.0762734413147, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207304c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.0762734413147, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 26.40909090909091, "ram_util_percent": 81.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6799440743510055, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.0359853542671, "policy_loss": 0.029999778208337605, "vf_loss": 10.0, "vf_explained_var": 6.186583685496497e-06, "kl": 0.05320500951142065, "entropy": 1.0057883359767772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8751763082109392, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998015036185583, "policy_loss": -0.005500084501303112, "vf_loss": 9.99383909702301, "vf_explained_var": 0.00014685603479544322, "kl": 0.00955657623562729, "entropy": 1.52122183231016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": 25131.85825482061, "episode_reward_min": 300.9484023069367, "episode_reward_mean": 18074.125393403192, "episode_len_mean": 189.76, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18976, "policy_reward_min": {"agent_policy": 6.2050954630685204, "adversary_policy": 88.81636795097245}, "policy_reward_max": {"agent_policy": 11856.652604173112, "adversary_policy": 11230.834190625312}, "policy_reward_mean": {"agent_policy": 7335.419635523624, "adversary_policy": 5369.352878939781}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18821.552921621656, 17277.348387434093, 16238.250561108109, 19628.433654186752, 17888.606265816, 16190.320193930145, 5370.955031003158, 15856.992595336671, 17354.25841390962, 18500.259770983168, 16630.729337420133, 18605.7522556949, 19598.733629778715, 15061.307583439684, 25131.85825482061, 16899.267984492228, 21816.058178923395, 17395.87913291642, 19847.769616531088, 19607.0682029787, 1226.4522518850633, 19224.56240953603, 20108.04637566095, 18881.11972975775, 19460.378753133013, 22131.94688427553, 19496.09230961661, 21288.11761405054, 20612.398870097375, 16097.669775655933, 18994.768125515424, 15054.69182848588, 18486.48530374746, 22796.67117851429, 16727.21470121145, 20892.971550442406, 21669.328500982698, 18298.20196473693, 18135.54595673264, 23128.41053696948, 17095.882157229757, 22633.7297520783, 17051.407103139718, 18080.64738185072, 16508.176936487936, 20392.891874615925, 18450.206650882512, 20150.676891494313, 17395.862834509106, 19196.546756206477, 21306.64255034225, 22009.17948906226, 20528.340310272113, 19614.03882317374, 20624.90706828113, 18328.016480059596, 18639.772268622408, 4782.231572846767, 19377.830994537686, 17100.10890484622, 17686.79415279607, 18231.84753970671, 16816.681813113853, 19375.01895522861, 20097.61261405202, 18421.21953184793, 16817.488798835755, 18408.043206648115, 20868.787261657377, 14923.488740034467, 5430.103047368951, 18343.234479783387, 22275.20026753441, 18503.61082863666, 19405.245845036523, 300.9484023069367, 19690.21055006462, 19616.960036593133, 17828.211565153066, 20372.909414690905, 21497.541379030714, 19514.898556008953, 19312.5476013972, 22431.96764656397, 18156.175293545653, 20483.288423406295, 18739.235466636423, 20469.31232415019, 15252.021070836174, 17427.220605039878, 20117.449303762012, 18625.80310510721, 17261.656694347235, 18828.88251379712, 20205.99259620374, 3507.6359509181643, 18032.247405624432, 20873.55728691554, 19185.15060220909, 18376.76506985762], "episode_lengths": [200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200], "policy_agent_policy_reward": [7660.0093828763265, 6931.424941090547, 10323.523326051634, 8167.63534833444, 8889.001221466742, 9987.297590385897, 710.4556890746006, 11424.756151947415, 9185.866546822119, 8372.45317395235, 8718.85128776146, 8186.622970894729, 6655.773236617105, 10590.159513277058, 2902.924062075349, 9203.997440592828, 5638.027032524455, 9500.20574812056, 7677.357819572651, 6896.155371091391, 39.367882395556734, 7854.63929330338, 6478.358790128336, 7476.223518459998, 8510.394854315378, 5296.95714303532, 7462.916159374704, 6294.735368189728, 7388.854401901044, 8708.441246041059, 8335.031840722164, 11170.211316481367, 9125.53104561438, 4432.708030556453, 8393.478339528618, 6793.589998117845, 5990.21071769316, 9834.41946943169, 8656.510752369282, 4637.4290306772755, 9017.366373697125, 5151.046322696348, 9532.418947529784, 6776.043712397309, 10872.524781999397, 5042.4038565373685, 8710.299198288456, 7613.0780714326565, 8539.453876706808, 6497.521202469181, 5877.076077152089, 5020.276444920896, 6693.515745370304, 8049.820236362802, 6250.641916062239, 9510.872544884356, 7896.322637136381, 298.23631984184425, 5622.21116340426, 9829.653424692182, 9244.346107296105, 9480.482877539738, 8220.015842417724, 8476.295633717516, 5623.087942875346, 9692.285228026001, 9206.197242477245, 7416.3752580851715, 7056.597491442481, 11856.652604173112, 764.9704892811174, 9160.27996781269, 3976.8008955550017, 8732.357884633573, 7610.577684523445, 6.2050954630685204, 8121.894546781977, 5894.262126658054, 8363.89030178294, 6886.034681873547, 3678.5192360288497, 8008.262498364275, 7522.752099875455, 5043.555113773024, 8048.1648358484845, 6799.21330502629, 8442.459654959574, 6301.491623299075, 10523.58737363394, 9928.965803565565, 6231.803317007377, 6771.950801365494, 8531.483592367018, 8691.557623487563, 6489.62899137721, 123.24005691234133, 8628.040585146313, 7193.322561415302, 8569.837599910226, 8921.227070135079], "policy_adversary_policy_reward": [6285.334955347775, 4876.20858339758, 7210.710682640409, 3135.2127637030962, 3818.6122976793245, 2096.114937377101, 5501.064858437221, 5959.733447415091, 4875.744756922206, 4123.860287427073, 4154.838033345031, 2048.1845701992056, 1910.567069089083, 2749.9322728394745, 1714.8569716057389, 2717.379471783537, 3891.9948495982526, 4276.3970174892675, 5746.675862031681, 4381.1307349991575, 5423.284335969495, 2488.593713689167, 5955.512652836231, 4463.616631963936, 5456.598006047765, 7486.362387113847, 919.1719597087415, 3551.9761104539007, 11230.834190625312, 10998.100002120065, 2757.132360761266, 4938.138183138109, 8456.576347161865, 7721.454799237074, 4641.929875610395, 3253.7435091854504, 5784.032321652499, 6386.37947530591, 7245.980252639559, 5464.932579247724, 448.63479257986097, 738.4495769096454, 5082.426785805128, 6287.496330427572, 5989.693027178972, 7639.994558353647, 6558.473531409362, 4846.422679888382, 5345.685561570894, 5604.298337246701, 8100.772615283167, 8734.217125957022, 6672.316855914066, 5360.859294327871, 7720.156078367781, 7273.226167493026, 6635.952129721112, 6587.592338475191, 5433.694377689904, 1955.5341519250267, 4886.1484754279645, 5773.587809365247, 912.5562047549528, 2971.9243072495847, 4395.753818086373, 4965.20044004666, 9610.519607299899, 8753.44354065791, 5748.6572842023415, 2585.0790774805355, 7343.542640200875, 6755.838912123672, 7838.604134670495, 7840.513648619021, 4205.772833161309, 4258.009662143966, 3993.4103330016915, 5485.624871361672, 8995.151705093756, 9495.829801198386, 5124.769250033832, 2953.746533498815, 8565.216892412654, 8917.466536969234, 2909.2714794087674, 4609.71667620117, 7366.091911333646, 3938.511758119732, 2370.261203645038, 3265.3909508434485, 9070.9698591582, 6279.518158920419, 4351.4892450172465, 5388.418207576769, 6395.492516720999, 6142.1063033406135, 3253.7272107781837, 5602.681747024142, 7644.614421261764, 5054.411132475517, 8265.059546578856, 7164.506926611276, 9053.190060023646, 7935.712984117735, 7022.8750983147675, 6811.949466587033, 5735.063528992117, 5829.155057818782, 7891.4937076687065, 6482.771444550187, 4622.520636543631, 4194.623298631574, 6245.812986594568, 4497.636644891463, 1996.4811862628108, 2487.5140667421106, 8519.924460326702, 5235.695370806787, 3040.954413789545, 4229.501066364492, 4745.309609357272, 3697.1384361426785, 4656.470979622409, 4094.8936825445476, 2674.5461893828574, 5922.119781313235, 5232.883331497619, 5665.839990013432, 5955.476990321061, 8519.04768085562, 4427.015008239303, 4301.9192955826675, 4935.93838125372, 2675.353175104836, 6725.760365645776, 4265.907582917077, 6743.820703166707, 7068.369067048275, 2285.483019557813, 781.3531163035026, 2483.1584494812187, 2181.9741086066138, 4204.302244748332, 4978.652267222402, 9524.457069593227, 8773.942302386145, 4659.119676241626, 5112.133267761443, 5340.236544754683, 6454.431615758427, 88.81636795097245, 205.92693889289575, 5992.176483866577, 5576.139519416092, 5940.306843622281, 7782.391066312766, 5778.245321948009, 3686.075941422078, 6230.773790959981, 7256.1009418574, 7369.209687240705, 10449.812455761215, 5943.836802479615, 5562.799255165076, 6616.465018601028, 5173.3304829207245, 8364.115145855858, 9024.297386935132, 4014.039669814652, 6093.970787882465, 6350.774178995449, 7333.300939384553, 5420.0216552384945, 4876.754156438377, 7484.053632223204, 6683.767068627952, 1109.8854471052282, 3618.5482500970115, 3572.0120211097706, 3926.2427803645783, 7910.332306723579, 5975.313680031045, 4483.66748137626, 7370.184822365463, 3119.5210706162934, 5610.65203136393, 4692.610365108002, 5444.7145252015125, 7652.506632353745, 6063.856972472787, 1749.0587581588534, 1635.3371358469697, 5323.02118409009, 4081.1856363880397, 6740.728968939213, 6939.505756560997, 5522.860575822936, 5092.452426475937, 5220.7568506421485, 4234.781149080378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019444637848123, "mean_inference_ms": 0.9963553438242979, "mean_action_processing_ms": 0.1675875178643305, "mean_env_wait_ms": 0.05442539562076811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033876895904541016, "StateBufferConnector_ms": 0.0025523900985717773, "ViewRequirementAgentConnector_ms": 0.06853663921356201}, "num_episodes": 20, "episode_return_max": 25131.85825482061, "episode_return_min": 300.9484023069367, "episode_return_mean": 18074.125393403192}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.3500422414816, "num_env_steps_trained_throughput_per_sec": 523.3500422414816, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 7620.018, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7619.981, "sample_time_ms": 754.614, "learn_time_ms": 6853.898, "learn_throughput": 583.609, "synch_weights_time_ms": 10.982}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 31, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-24", "timestamp": 1723235604, "time_this_iter_s": 7.648191928863525, "time_total_s": 236.72446537017822, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207228b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.72446537017822, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.41818181818182, "ram_util_percent": 81.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6797726879123027, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.054114057147313, "policy_loss": 0.04414652195419111, "vf_loss": 9.99685327691376, "vf_explained_var": 1.0142566035033533e-06, "kl": 0.07771413131917596, "entropy": 1.043094584550807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8588511089794337, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998941425482432, "policy_loss": -0.0027285897308805336, "vf_loss": 9.995289123058319, "vf_explained_var": 3.157382210095723e-05, "kl": 0.006302128355794897, "entropy": 1.5202449894199768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 23128.41053696948, "episode_reward_min": 300.9484023069367, "episode_reward_mean": 18396.07163573421, "episode_len_mean": 191.51, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19151, "policy_reward_min": {"agent_policy": 6.2050954630685204, "adversary_policy": 88.81636795097245}, "policy_reward_max": {"agent_policy": 11856.652604173112, "adversary_policy": 10449.812455761215}, "policy_reward_mean": {"agent_policy": 7359.073533002194, "adversary_policy": 5518.499051366006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20108.04637566095, 18881.11972975775, 19460.378753133013, 22131.94688427553, 19496.09230961661, 21288.11761405054, 20612.398870097375, 16097.669775655933, 18994.768125515424, 15054.69182848588, 18486.48530374746, 22796.67117851429, 16727.21470121145, 20892.971550442406, 21669.328500982698, 18298.20196473693, 18135.54595673264, 23128.41053696948, 17095.882157229757, 22633.7297520783, 17051.407103139718, 18080.64738185072, 16508.176936487936, 20392.891874615925, 18450.206650882512, 20150.676891494313, 17395.862834509106, 19196.546756206477, 21306.64255034225, 22009.17948906226, 20528.340310272113, 19614.03882317374, 20624.90706828113, 18328.016480059596, 18639.772268622408, 4782.231572846767, 19377.830994537686, 17100.10890484622, 17686.79415279607, 18231.84753970671, 16816.681813113853, 19375.01895522861, 20097.61261405202, 18421.21953184793, 16817.488798835755, 18408.043206648115, 20868.787261657377, 14923.488740034467, 5430.103047368951, 18343.234479783387, 22275.20026753441, 18503.61082863666, 19405.245845036523, 300.9484023069367, 19690.21055006462, 19616.960036593133, 17828.211565153066, 20372.909414690905, 21497.541379030714, 19514.898556008953, 19312.5476013972, 22431.96764656397, 18156.175293545653, 20483.288423406295, 18739.235466636423, 20469.31232415019, 15252.021070836174, 17427.220605039878, 20117.449303762012, 18625.80310510721, 17261.656694347235, 18828.88251379712, 20205.99259620374, 3507.6359509181643, 18032.247405624432, 20873.55728691554, 19185.15060220909, 18376.76506985762, 17483.302213331986, 20601.447921795898, 19606.98232367843, 22026.271804246822, 19069.58675357452, 21633.10919007279, 18808.54998750562, 4336.433521022269, 17099.802291411277, 18518.775968713962, 20235.56076651121, 18174.75662140694, 18854.58308789088, 18246.867455502597, 19108.06259562816, 20566.266553267036, 20582.04009240314, 17482.948814954918, 18710.129747373143, 15911.996551365746, 20122.330557913014, 19187.2360472784], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6478.358790128336, 7476.223518459998, 8510.394854315378, 5296.95714303532, 7462.916159374704, 6294.735368189728, 7388.854401901044, 8708.441246041059, 8335.031840722164, 11170.211316481367, 9125.53104561438, 4432.708030556453, 8393.478339528618, 6793.589998117845, 5990.21071769316, 9834.41946943169, 8656.510752369282, 4637.4290306772755, 9017.366373697125, 5151.046322696348, 9532.418947529784, 6776.043712397309, 10872.524781999397, 5042.4038565373685, 8710.299198288456, 7613.0780714326565, 8539.453876706808, 6497.521202469181, 5877.076077152089, 5020.276444920896, 6693.515745370304, 8049.820236362802, 6250.641916062239, 9510.872544884356, 7896.322637136381, 298.23631984184425, 5622.21116340426, 9829.653424692182, 9244.346107296105, 9480.482877539738, 8220.015842417724, 8476.295633717516, 5623.087942875346, 9692.285228026001, 9206.197242477245, 7416.3752580851715, 7056.597491442481, 11856.652604173112, 764.9704892811174, 9160.27996781269, 3976.8008955550017, 8732.357884633573, 7610.577684523445, 6.2050954630685204, 8121.894546781977, 5894.262126658054, 8363.89030178294, 6886.034681873547, 3678.5192360288497, 8008.262498364275, 7522.752099875455, 5043.555113773024, 8048.1648358484845, 6799.21330502629, 8442.459654959574, 6301.491623299075, 10523.58737363394, 9928.965803565565, 6231.803317007377, 6771.950801365494, 8531.483592367018, 8691.557623487563, 6489.62899137721, 123.24005691234133, 8628.040585146313, 7193.322561415302, 8569.837599910226, 8921.227070135079, 8892.46304882311, 7342.139665008264, 6777.589366316772, 5163.180184764412, 7915.023067020822, 6452.168885038573, 7687.595455594239, 541.3329413357035, 10624.442654848324, 7929.830341484783, 7462.998387945667, 9072.341468755267, 7678.733845912978, 8707.205192735753, 8652.419431521836, 6176.67046688143, 6821.333656925899, 8357.51070364835, 8973.508182071468, 11642.500400578821, 6938.173032955782, 8072.734397917273], "policy_adversary_policy_reward": [5989.693027178972, 7639.994558353647, 6558.473531409362, 4846.422679888382, 5345.685561570894, 5604.298337246701, 8100.772615283167, 8734.217125957022, 6672.316855914066, 5360.859294327871, 7720.156078367781, 7273.226167493026, 6635.952129721112, 6587.592338475191, 5433.694377689904, 1955.5341519250267, 4886.1484754279645, 5773.587809365247, 912.5562047549528, 2971.9243072495847, 4395.753818086373, 4965.20044004666, 9610.519607299899, 8753.44354065791, 5748.6572842023415, 2585.0790774805355, 7343.542640200875, 6755.838912123672, 7838.604134670495, 7840.513648619021, 4205.772833161309, 4258.009662143966, 3993.4103330016915, 5485.624871361672, 8995.151705093756, 9495.829801198386, 5124.769250033832, 2953.746533498815, 8565.216892412654, 8917.466536969234, 2909.2714794087674, 4609.71667620117, 7366.091911333646, 3938.511758119732, 2370.261203645038, 3265.3909508434485, 9070.9698591582, 6279.518158920419, 4351.4892450172465, 5388.418207576769, 6395.492516720999, 6142.1063033406135, 3253.7272107781837, 5602.681747024142, 7644.614421261764, 5054.411132475517, 8265.059546578856, 7164.506926611276, 9053.190060023646, 7935.712984117735, 7022.8750983147675, 6811.949466587033, 5735.063528992117, 5829.155057818782, 7891.4937076687065, 6482.771444550187, 4622.520636543631, 4194.623298631574, 6245.812986594568, 4497.636644891463, 1996.4811862628108, 2487.5140667421106, 8519.924460326702, 5235.695370806787, 3040.954413789545, 4229.501066364492, 4745.309609357272, 3697.1384361426785, 4656.470979622409, 4094.8936825445476, 2674.5461893828574, 5922.119781313235, 5232.883331497619, 5665.839990013432, 5955.476990321061, 8519.04768085562, 4427.015008239303, 4301.9192955826675, 4935.93838125372, 2675.353175104836, 6725.760365645776, 4265.907582917077, 6743.820703166707, 7068.369067048275, 2285.483019557813, 781.3531163035026, 2483.1584494812187, 2181.9741086066138, 4204.302244748332, 4978.652267222402, 9524.457069593227, 8773.942302386145, 4659.119676241626, 5112.133267761443, 5340.236544754683, 6454.431615758427, 88.81636795097245, 205.92693889289575, 5992.176483866577, 5576.139519416092, 5940.306843622281, 7782.391066312766, 5778.245321948009, 3686.075941422078, 6230.773790959981, 7256.1009418574, 7369.209687240705, 10449.812455761215, 5943.836802479615, 5562.799255165076, 6616.465018601028, 5173.3304829207245, 8364.115145855858, 9024.297386935132, 4014.039669814652, 6093.970787882465, 6350.774178995449, 7333.300939384553, 5420.0216552384945, 4876.754156438377, 7484.053632223204, 6683.767068627952, 1109.8854471052282, 3618.5482500970115, 3572.0120211097706, 3926.2427803645783, 7910.332306723579, 5975.313680031045, 4483.66748137626, 7370.184822365463, 3119.5210706162934, 5610.65203136393, 4692.610365108002, 5444.7145252015125, 7652.506632353745, 6063.856972472787, 1749.0587581588534, 1635.3371358469697, 5323.02118409009, 4081.1856363880397, 6740.728968939213, 6939.505756560997, 5522.860575822936, 5092.452426475937, 5220.7568506421485, 4234.781149080378, 3341.1665896010327, 5249.672574907841, 6796.906411850542, 6462.401844937076, 5525.029850269654, 7304.363107092001, 7888.01752596539, 8975.074093517027, 6227.112556710125, 4927.451129843575, 7535.287471108679, 7645.6528339255, 6126.435138788825, 4994.519393122535, 1918.8180881228877, 1876.2824915636793, 2971.9692197117906, 3503.390416851147, 6154.422456141489, 4434.523171087681, 6572.877628988703, 6199.684749576848, 4081.949576029574, 5020.465576622104, 6462.512087795611, 4713.337154182267, 4146.822203752647, 5392.840059014174, 5487.6556976773145, 4967.9874664290655, 6424.510513690223, 7965.085572695389, 6974.725235796969, 6785.9811996802555, 5782.636094183259, 3342.8020171232947, 5122.627497347321, 4613.99406795433, 1777.6521367422517, 2491.844014044673, 6652.862669572542, 6531.29485538467, 5132.0548308223115, 5982.446818538848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4010800185177976, "mean_inference_ms": 0.9944033856261502, "mean_action_processing_ms": 0.16728920362571478, "mean_env_wait_ms": 0.0542512355058323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032879114151000977, "StateBufferConnector_ms": 0.0024901628494262695, "ViewRequirementAgentConnector_ms": 0.06613457202911377}, "num_episodes": 22, "episode_return_max": 23128.41053696948, "episode_return_min": 300.9484023069367, "episode_return_mean": 18396.07163573421}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.9024655461998, "num_env_steps_trained_throughput_per_sec": 533.9024655461998, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 7572.909, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7572.872, "sample_time_ms": 755.492, "learn_time_ms": 6805.942, "learn_throughput": 587.722, "synch_weights_time_ms": 10.906}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 32, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-32", "timestamp": 1723235612, "time_this_iter_s": 7.496808052062988, "time_total_s": 244.2212734222412, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320722b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.2212734222412, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.41818181818182, "ram_util_percent": 81.73636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8045192262522443, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.967364585714996, "policy_loss": 0.06513606992860635, "vf_loss": 9.879659262157622, "vf_explained_var": 1.2766116510623345e-07, "kl": 0.08916247768337449, "entropy": 1.1297511985062292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8610284830288341, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999542752901712, "policy_loss": -0.003860596778880184, "vf_loss": 9.995441302657127, "vf_explained_var": 8.086773256460826e-05, "kl": 0.007863747598215317, "entropy": 1.498584580173095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 22431.96764656397, "episode_reward_min": 300.9484023069367, "episode_reward_mean": 18053.235033778135, "episode_len_mean": 190.07, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19007, "policy_reward_min": {"agent_policy": 6.2050954630685204, "adversary_policy": 88.81636795097245}, "policy_reward_max": {"agent_policy": 12080.815587339172, "adversary_policy": 10449.812455761215}, "policy_reward_mean": {"agent_policy": 7567.117501141748, "adversary_policy": 5243.058766318191}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18080.64738185072, 16508.176936487936, 20392.891874615925, 18450.206650882512, 20150.676891494313, 17395.862834509106, 19196.546756206477, 21306.64255034225, 22009.17948906226, 20528.340310272113, 19614.03882317374, 20624.90706828113, 18328.016480059596, 18639.772268622408, 4782.231572846767, 19377.830994537686, 17100.10890484622, 17686.79415279607, 18231.84753970671, 16816.681813113853, 19375.01895522861, 20097.61261405202, 18421.21953184793, 16817.488798835755, 18408.043206648115, 20868.787261657377, 14923.488740034467, 5430.103047368951, 18343.234479783387, 22275.20026753441, 18503.61082863666, 19405.245845036523, 300.9484023069367, 19690.21055006462, 19616.960036593133, 17828.211565153066, 20372.909414690905, 21497.541379030714, 19514.898556008953, 19312.5476013972, 22431.96764656397, 18156.175293545653, 20483.288423406295, 18739.235466636423, 20469.31232415019, 15252.021070836174, 17427.220605039878, 20117.449303762012, 18625.80310510721, 17261.656694347235, 18828.88251379712, 20205.99259620374, 3507.6359509181643, 18032.247405624432, 20873.55728691554, 19185.15060220909, 18376.76506985762, 17483.302213331986, 20601.447921795898, 19606.98232367843, 22026.271804246822, 19069.58675357452, 21633.10919007279, 18808.54998750562, 4336.433521022269, 17099.802291411277, 18518.775968713962, 20235.56076651121, 18174.75662140694, 18854.58308789088, 18246.867455502597, 19108.06259562816, 20566.266553267036, 20582.04009240314, 17482.948814954918, 18710.129747373143, 15911.996551365746, 20122.330557913014, 19187.2360472784, 15975.27124710122, 17974.512642643313, 18079.395917465878, 22421.739114920674, 21554.134710204784, 18230.65595157604, 16052.758471999869, 17557.189562018117, 21500.777950470445, 20604.166012498546, 15441.379267122387, 18798.738042301593, 6348.998355356197, 19066.046671545144, 17453.207484188948, 18260.68977308817, 15694.660193057063, 19911.412609953342, 16667.98177928114, 16131.347587994, 21032.355431639415], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6776.043712397309, 10872.524781999397, 5042.4038565373685, 8710.299198288456, 7613.0780714326565, 8539.453876706808, 6497.521202469181, 5877.076077152089, 5020.276444920896, 6693.515745370304, 8049.820236362802, 6250.641916062239, 9510.872544884356, 7896.322637136381, 298.23631984184425, 5622.21116340426, 9829.653424692182, 9244.346107296105, 9480.482877539738, 8220.015842417724, 8476.295633717516, 5623.087942875346, 9692.285228026001, 9206.197242477245, 7416.3752580851715, 7056.597491442481, 11856.652604173112, 764.9704892811174, 9160.27996781269, 3976.8008955550017, 8732.357884633573, 7610.577684523445, 6.2050954630685204, 8121.894546781977, 5894.262126658054, 8363.89030178294, 6886.034681873547, 3678.5192360288497, 8008.262498364275, 7522.752099875455, 5043.555113773024, 8048.1648358484845, 6799.21330502629, 8442.459654959574, 6301.491623299075, 10523.58737363394, 9928.965803565565, 6231.803317007377, 6771.950801365494, 8531.483592367018, 8691.557623487563, 6489.62899137721, 123.24005691234133, 8628.040585146313, 7193.322561415302, 8569.837599910226, 8921.227070135079, 8892.46304882311, 7342.139665008264, 6777.589366316772, 5163.180184764412, 7915.023067020822, 6452.168885038573, 7687.595455594239, 541.3329413357035, 10624.442654848324, 7929.830341484783, 7462.998387945667, 9072.341468755267, 7678.733845912978, 8707.205192735753, 8652.419431521836, 6176.67046688143, 6821.333656925899, 8357.51070364835, 8973.508182071468, 11642.500400578821, 6938.173032955782, 8072.734397917273, 11245.89227771365, 9670.62732197464, 9069.414458515856, 4322.988133374218, 6091.199527882337, 9861.380090945553, 12054.303170820462, 10253.36045944774, 4085.6627161467877, 6561.12908702905, 12080.815587339172, 7846.613471496369, 583.6787376225742, 8346.67902789655, 10406.177175257446, 7881.79788847218, 11792.138832332386, 7824.987185490112, 11222.290732080412, 11574.213146105345, 6715.881452573606], "policy_adversary_policy_reward": [7366.091911333646, 3938.511758119732, 2370.261203645038, 3265.3909508434485, 9070.9698591582, 6279.518158920419, 4351.4892450172465, 5388.418207576769, 6395.492516720999, 6142.1063033406135, 3253.7272107781837, 5602.681747024142, 7644.614421261764, 5054.411132475517, 8265.059546578856, 7164.506926611276, 9053.190060023646, 7935.712984117735, 7022.8750983147675, 6811.949466587033, 5735.063528992117, 5829.155057818782, 7891.4937076687065, 6482.771444550187, 4622.520636543631, 4194.623298631574, 6245.812986594568, 4497.636644891463, 1996.4811862628108, 2487.5140667421106, 8519.924460326702, 5235.695370806787, 3040.954413789545, 4229.501066364492, 4745.309609357272, 3697.1384361426785, 4656.470979622409, 4094.8936825445476, 2674.5461893828574, 5922.119781313235, 5232.883331497619, 5665.839990013432, 5955.476990321061, 8519.04768085562, 4427.015008239303, 4301.9192955826675, 4935.93838125372, 2675.353175104836, 6725.760365645776, 4265.907582917077, 6743.820703166707, 7068.369067048275, 2285.483019557813, 781.3531163035026, 2483.1584494812187, 2181.9741086066138, 4204.302244748332, 4978.652267222402, 9524.457069593227, 8773.942302386145, 4659.119676241626, 5112.133267761443, 5340.236544754683, 6454.431615758427, 88.81636795097245, 205.92693889289575, 5992.176483866577, 5576.139519416092, 5940.306843622281, 7782.391066312766, 5778.245321948009, 3686.075941422078, 6230.773790959981, 7256.1009418574, 7369.209687240705, 10449.812455761215, 5943.836802479615, 5562.799255165076, 6616.465018601028, 5173.3304829207245, 8364.115145855858, 9024.297386935132, 4014.039669814652, 6093.970787882465, 6350.774178995449, 7333.300939384553, 5420.0216552384945, 4876.754156438377, 7484.053632223204, 6683.767068627952, 1109.8854471052282, 3618.5482500970115, 3572.0120211097706, 3926.2427803645783, 7910.332306723579, 5975.313680031045, 4483.66748137626, 7370.184822365463, 3119.5210706162934, 5610.65203136393, 4692.610365108002, 5444.7145252015125, 7652.506632353745, 6063.856972472787, 1749.0587581588534, 1635.3371358469697, 5323.02118409009, 4081.1856363880397, 6740.728968939213, 6939.505756560997, 5522.860575822936, 5092.452426475937, 5220.7568506421485, 4234.781149080378, 3341.1665896010327, 5249.672574907841, 6796.906411850542, 6462.401844937076, 5525.029850269654, 7304.363107092001, 7888.01752596539, 8975.074093517027, 6227.112556710125, 4927.451129843575, 7535.287471108679, 7645.6528339255, 6126.435138788825, 4994.519393122535, 1918.8180881228877, 1876.2824915636793, 2971.9692197117906, 3503.390416851147, 6154.422456141489, 4434.523171087681, 6572.877628988703, 6199.684749576848, 4081.949576029574, 5020.465576622104, 6462.512087795611, 4713.337154182267, 4146.822203752647, 5392.840059014174, 5487.6556976773145, 4967.9874664290655, 6424.510513690223, 7965.085572695389, 6974.725235796969, 6785.9811996802555, 5782.636094183259, 3342.8020171232947, 5122.627497347321, 4613.99406795433, 1777.6521367422517, 2491.844014044673, 6652.862669572542, 6531.29485538467, 5132.0548308223115, 5982.446818538848, 2871.4255108883485, 1857.9534584992284, 4465.198659022435, 3838.6866616462776, 5071.635464507827, 3938.345994442186, 9207.884485892542, 8890.866495653863, 8004.338208464381, 7458.596973858049, 4141.822257092199, 4227.453603538292, 1946.3786553439659, 2052.076645835468, 3875.8878141911146, 3427.941288379285, 10056.472907584155, 7358.642326739497, 6641.726245687114, 7401.310679782332, 2030.8740962480983, 1329.6895835351413, 4718.156217629887, 6233.968353175366, 3141.774919336006, 2623.544698397624, 4940.20077049343, 5779.166873155211, 3732.9123494242576, 3314.1179595072745, 6245.71723878842, 4133.174645827657, 2335.271689844256, 1567.249670880411, 6270.505286746282, 5815.920137716958, 2881.2338880026214, 2564.4571591981044, 1996.4308999085374, 2560.703541980133, 7358.516449658392, 6957.957529407418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40057856688622206, "mean_inference_ms": 0.9933698843278781, "mean_action_processing_ms": 0.1671539149173296, "mean_env_wait_ms": 0.05417459357339178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034482479095458984, "StateBufferConnector_ms": 0.002497434616088867, "ViewRequirementAgentConnector_ms": 0.06559622287750244}, "num_episodes": 21, "episode_return_max": 22431.96764656397, "episode_return_min": 300.9484023069367, "episode_return_mean": 18053.235033778135}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.6006554304865, "num_env_steps_trained_throughput_per_sec": 537.6006554304865, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 7540.325, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7540.289, "sample_time_ms": 758.132, "learn_time_ms": 6770.685, "learn_throughput": 590.782, "synch_weights_time_ms": 10.938}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 33, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-39", "timestamp": 1723235619, "time_this_iter_s": 7.445749998092651, "time_total_s": 251.66702342033386, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320722c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 251.66702342033386, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.227272727272727, "ram_util_percent": 81.64545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8586705197023337, "cur_kl_coeff": 0.3796875000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.963640381041028, "policy_loss": 0.07200508170315217, "vf_loss": 9.862347022566215, "vf_explained_var": 1.7045351563307343e-05, "kl": 0.0771378615880927, "entropy": 1.1516621113454224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8461464401955406, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000266530116399, "policy_loss": -0.003986171874809467, "vf_loss": 9.994552710652352, "vf_explained_var": 4.26148995757103e-05, "kl": 0.0095802446216112, "entropy": 1.5080682933330536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 22431.96764656397, "episode_reward_min": 300.9484023069367, "episode_reward_mean": 17926.123806958847, "episode_len_mean": 190.16, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19016, "policy_reward_min": {"agent_policy": 6.2050954630685204, "adversary_policy": 88.81636795097245}, "policy_reward_max": {"agent_policy": 12080.815587339172, "adversary_policy": 10449.812455761215}, "policy_reward_mean": {"agent_policy": 7842.54282647844, "adversary_policy": 5041.790490240205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19375.01895522861, 20097.61261405202, 18421.21953184793, 16817.488798835755, 18408.043206648115, 20868.787261657377, 14923.488740034467, 5430.103047368951, 18343.234479783387, 22275.20026753441, 18503.61082863666, 19405.245845036523, 300.9484023069367, 19690.21055006462, 19616.960036593133, 17828.211565153066, 20372.909414690905, 21497.541379030714, 19514.898556008953, 19312.5476013972, 22431.96764656397, 18156.175293545653, 20483.288423406295, 18739.235466636423, 20469.31232415019, 15252.021070836174, 17427.220605039878, 20117.449303762012, 18625.80310510721, 17261.656694347235, 18828.88251379712, 20205.99259620374, 3507.6359509181643, 18032.247405624432, 20873.55728691554, 19185.15060220909, 18376.76506985762, 17483.302213331986, 20601.447921795898, 19606.98232367843, 22026.271804246822, 19069.58675357452, 21633.10919007279, 18808.54998750562, 4336.433521022269, 17099.802291411277, 18518.775968713962, 20235.56076651121, 18174.75662140694, 18854.58308789088, 18246.867455502597, 19108.06259562816, 20566.266553267036, 20582.04009240314, 17482.948814954918, 18710.129747373143, 15911.996551365746, 20122.330557913014, 19187.2360472784, 15975.27124710122, 17974.512642643313, 18079.395917465878, 22421.739114920674, 21554.134710204784, 18230.65595157604, 16052.758471999869, 17557.189562018117, 21500.777950470445, 20604.166012498546, 15441.379267122387, 18798.738042301593, 6348.998355356197, 19066.046671545144, 17453.207484188948, 18260.68977308817, 15694.660193057063, 19911.412609953342, 16667.98177928114, 16131.347587994, 21032.355431639415, 18181.723032169873, 16637.19286259881, 17624.553156855738, 17218.845011359743, 15619.941008947973, 17375.696128027834, 19854.774851320435, 19773.96790003797, 19313.569783015693, 18736.667306485593, 19740.08470671719, 18596.481865914426, 21166.584639662993, 18261.32550485074, 15286.914371039826, 19689.413730697182, 16038.89791032002, 5703.165577660809, 18794.401311557624, 18896.07795253873], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200], "policy_agent_policy_reward": [8476.295633717516, 5623.087942875346, 9692.285228026001, 9206.197242477245, 7416.3752580851715, 7056.597491442481, 11856.652604173112, 764.9704892811174, 9160.27996781269, 3976.8008955550017, 8732.357884633573, 7610.577684523445, 6.2050954630685204, 8121.894546781977, 5894.262126658054, 8363.89030178294, 6886.034681873547, 3678.5192360288497, 8008.262498364275, 7522.752099875455, 5043.555113773024, 8048.1648358484845, 6799.21330502629, 8442.459654959574, 6301.491623299075, 10523.58737363394, 9928.965803565565, 6231.803317007377, 6771.950801365494, 8531.483592367018, 8691.557623487563, 6489.62899137721, 123.24005691234133, 8628.040585146313, 7193.322561415302, 8569.837599910226, 8921.227070135079, 8892.46304882311, 7342.139665008264, 6777.589366316772, 5163.180184764412, 7915.023067020822, 6452.168885038573, 7687.595455594239, 541.3329413357035, 10624.442654848324, 7929.830341484783, 7462.998387945667, 9072.341468755267, 7678.733845912978, 8707.205192735753, 8652.419431521836, 6176.67046688143, 6821.333656925899, 8357.51070364835, 8973.508182071468, 11642.500400578821, 6938.173032955782, 8072.734397917273, 11245.89227771365, 9670.62732197464, 9069.414458515856, 4322.988133374218, 6091.199527882337, 9861.380090945553, 12054.303170820462, 10253.36045944774, 4085.6627161467877, 6561.12908702905, 12080.815587339172, 7846.613471496369, 583.6787376225742, 8346.67902789655, 10406.177175257446, 7881.79788847218, 11792.138832332386, 7824.987185490112, 11222.290732080412, 11574.213146105345, 6715.881452573606, 9126.15279862235, 10190.363192457524, 9654.40238348726, 10346.20667300743, 11451.252823456034, 10303.386888882871, 7972.953556201648, 6566.314892513834, 8464.004908603787, 8782.875599931456, 7541.925983198198, 9182.570310940071, 6202.618492817839, 9557.093658301681, 11055.362803884274, 6871.9467753756835, 11990.640823268626, 658.7211006862022, 9304.140956154306, 8364.393948790017], "policy_adversary_policy_reward": [5232.883331497619, 5665.839990013432, 5955.476990321061, 8519.04768085562, 4427.015008239303, 4301.9192955826675, 4935.93838125372, 2675.353175104836, 6725.760365645776, 4265.907582917077, 6743.820703166707, 7068.369067048275, 2285.483019557813, 781.3531163035026, 2483.1584494812187, 2181.9741086066138, 4204.302244748332, 4978.652267222402, 9524.457069593227, 8773.942302386145, 4659.119676241626, 5112.133267761443, 5340.236544754683, 6454.431615758427, 88.81636795097245, 205.92693889289575, 5992.176483866577, 5576.139519416092, 5940.306843622281, 7782.391066312766, 5778.245321948009, 3686.075941422078, 6230.773790959981, 7256.1009418574, 7369.209687240705, 10449.812455761215, 5943.836802479615, 5562.799255165076, 6616.465018601028, 5173.3304829207245, 8364.115145855858, 9024.297386935132, 4014.039669814652, 6093.970787882465, 6350.774178995449, 7333.300939384553, 5420.0216552384945, 4876.754156438377, 7484.053632223204, 6683.767068627952, 1109.8854471052282, 3618.5482500970115, 3572.0120211097706, 3926.2427803645783, 7910.332306723579, 5975.313680031045, 4483.66748137626, 7370.184822365463, 3119.5210706162934, 5610.65203136393, 4692.610365108002, 5444.7145252015125, 7652.506632353745, 6063.856972472787, 1749.0587581588534, 1635.3371358469697, 5323.02118409009, 4081.1856363880397, 6740.728968939213, 6939.505756560997, 5522.860575822936, 5092.452426475937, 5220.7568506421485, 4234.781149080378, 3341.1665896010327, 5249.672574907841, 6796.906411850542, 6462.401844937076, 5525.029850269654, 7304.363107092001, 7888.01752596539, 8975.074093517027, 6227.112556710125, 4927.451129843575, 7535.287471108679, 7645.6528339255, 6126.435138788825, 4994.519393122535, 1918.8180881228877, 1876.2824915636793, 2971.9692197117906, 3503.390416851147, 6154.422456141489, 4434.523171087681, 6572.877628988703, 6199.684749576848, 4081.949576029574, 5020.465576622104, 6462.512087795611, 4713.337154182267, 4146.822203752647, 5392.840059014174, 5487.6556976773145, 4967.9874664290655, 6424.510513690223, 7965.085572695389, 6974.725235796969, 6785.9811996802555, 5782.636094183259, 3342.8020171232947, 5122.627497347321, 4613.99406795433, 1777.6521367422517, 2491.844014044673, 6652.862669572542, 6531.29485538467, 5132.0548308223115, 5982.446818538848, 2871.4255108883485, 1857.9534584992284, 4465.198659022435, 3838.6866616462776, 5071.635464507827, 3938.345994442186, 9207.884485892542, 8890.866495653863, 8004.338208464381, 7458.596973858049, 4141.822257092199, 4227.453603538292, 1946.3786553439659, 2052.076645835468, 3875.8878141911146, 3427.941288379285, 10056.472907584155, 7358.642326739497, 6641.726245687114, 7401.310679782332, 2030.8740962480983, 1329.6895835351413, 4718.156217629887, 6233.968353175366, 3141.774919336006, 2623.544698397624, 4940.20077049343, 5779.166873155211, 3732.9123494242576, 3314.1179595072745, 6245.71723878842, 4133.174645827657, 2335.271689844256, 1567.249670880411, 6270.505286746282, 5815.920137716958, 2881.2338880026214, 2564.4571591981044, 1996.4308999085374, 2560.703541980133, 7358.516449658392, 6957.957529407418, 4112.113427810157, 4943.456805737383, 3937.8542540940844, 2508.975416047235, 3521.551012842688, 4448.599760525762, 3257.788292071651, 3614.850046280673, 2667.674063694996, 1501.0141217970042, 3239.336072124133, 3832.9731670207466, 5731.697558894029, 6150.123736224827, 5647.913537676558, 7559.739469847639, 5185.397954541439, 5664.166919870457, 5239.689198315206, 4714.10250823885, 5669.648604576393, 6528.510118942612, 4943.552880081296, 4470.358674893078, 7557.316647519579, 7406.649499325515, 4144.001378073244, 4560.230468475814, 3075.3258391054806, 1156.2257280500025, 5744.835557991666, 7072.63139732986, 2079.140115361353, 1969.1169716899865, 2311.1575470139396, 2733.28692996067, 4702.101588905002, 4788.1587664982835, 5397.893891948479, 5133.790111800266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40022249367972634, "mean_inference_ms": 0.9918145112136798, "mean_action_processing_ms": 0.1670216331177691, "mean_env_wait_ms": 0.05408205028390856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003571629524230957, "StateBufferConnector_ms": 0.0025113821029663086, "ViewRequirementAgentConnector_ms": 0.0646359920501709}, "num_episodes": 20, "episode_return_max": 22431.96764656397, "episode_return_min": 300.9484023069367, "episode_return_mean": 17926.123806958847}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.6745368615691, "num_env_steps_trained_throughput_per_sec": 545.6745368615691, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 7515.873, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7515.837, "sample_time_ms": 744.21, "learn_time_ms": 6760.4, "learn_throughput": 591.681, "synch_weights_time_ms": 10.692}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 34, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-47", "timestamp": 1723235627, "time_this_iter_s": 7.334944009780884, "time_total_s": 259.00196743011475, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207304c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.00196743011475, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.4, "ram_util_percent": 81.73}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8509898343453647, "cur_kl_coeff": 0.5695312499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.032064145204252, "policy_loss": 0.06111035353107447, "vf_loss": 9.93176422775107, "vf_explained_var": -4.662407769097222e-07, "kl": 0.06881022570979974, "entropy": 1.1331566213299988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8538956723952045, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997787769635519, "policy_loss": -0.0020343260757120637, "vf_loss": 9.993294247984887, "vf_explained_var": 5.575704077879588e-06, "kl": 0.0064472437671308095, "entropy": 1.5086584745595852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 22421.739114920674, "episode_reward_min": 93.9670237931044, "episode_reward_mean": 17747.350615505806, "episode_len_mean": 190.11, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19011, "policy_reward_min": {"agent_policy": 0.802993359085007, "adversary_policy": 23.256345674449648}, "policy_reward_max": {"agent_policy": 12094.410943447478, "adversary_policy": 10056.472907584155}, "policy_reward_mean": {"agent_policy": 8068.260617016769, "adversary_policy": 4839.544999244517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20483.288423406295, 18739.235466636423, 20469.31232415019, 15252.021070836174, 17427.220605039878, 20117.449303762012, 18625.80310510721, 17261.656694347235, 18828.88251379712, 20205.99259620374, 3507.6359509181643, 18032.247405624432, 20873.55728691554, 19185.15060220909, 18376.76506985762, 17483.302213331986, 20601.447921795898, 19606.98232367843, 22026.271804246822, 19069.58675357452, 21633.10919007279, 18808.54998750562, 4336.433521022269, 17099.802291411277, 18518.775968713962, 20235.56076651121, 18174.75662140694, 18854.58308789088, 18246.867455502597, 19108.06259562816, 20566.266553267036, 20582.04009240314, 17482.948814954918, 18710.129747373143, 15911.996551365746, 20122.330557913014, 19187.2360472784, 15975.27124710122, 17974.512642643313, 18079.395917465878, 22421.739114920674, 21554.134710204784, 18230.65595157604, 16052.758471999869, 17557.189562018117, 21500.777950470445, 20604.166012498546, 15441.379267122387, 18798.738042301593, 6348.998355356197, 19066.046671545144, 17453.207484188948, 18260.68977308817, 15694.660193057063, 19911.412609953342, 16667.98177928114, 16131.347587994, 21032.355431639415, 18181.723032169873, 16637.19286259881, 17624.553156855738, 17218.845011359743, 15619.941008947973, 17375.696128027834, 19854.774851320435, 19773.96790003797, 19313.569783015693, 18736.667306485593, 19740.08470671719, 18596.481865914426, 21166.584639662993, 18261.32550485074, 15286.914371039826, 19689.413730697182, 16038.89791032002, 5703.165577660809, 18794.401311557624, 18896.07795253873, 18218.191541779033, 18086.79969541667, 15770.946209799211, 17093.455772589157, 17746.686622516496, 17437.308151148034, 20515.516527031068, 21184.811593799994, 15108.638990029045, 16859.793769246997, 4835.589753645947, 22325.903939367843, 21695.314994393135, 20604.518184867757, 18817.584853218137, 18939.667010141962, 17688.895719317945, 19658.64781539894, 18634.685301337828, 93.9670237931044, 17015.345895123617, 15381.835512753225], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200], "policy_agent_policy_reward": [6799.21330502629, 8442.459654959574, 6301.491623299075, 10523.58737363394, 9928.965803565565, 6231.803317007377, 6771.950801365494, 8531.483592367018, 8691.557623487563, 6489.62899137721, 123.24005691234133, 8628.040585146313, 7193.322561415302, 8569.837599910226, 8921.227070135079, 8892.46304882311, 7342.139665008264, 6777.589366316772, 5163.180184764412, 7915.023067020822, 6452.168885038573, 7687.595455594239, 541.3329413357035, 10624.442654848324, 7929.830341484783, 7462.998387945667, 9072.341468755267, 7678.733845912978, 8707.205192735753, 8652.419431521836, 6176.67046688143, 6821.333656925899, 8357.51070364835, 8973.508182071468, 11642.500400578821, 6938.173032955782, 8072.734397917273, 11245.89227771365, 9670.62732197464, 9069.414458515856, 4322.988133374218, 6091.199527882337, 9861.380090945553, 12054.303170820462, 10253.36045944774, 4085.6627161467877, 6561.12908702905, 12080.815587339172, 7846.613471496369, 583.6787376225742, 8346.67902789655, 10406.177175257446, 7881.79788847218, 11792.138832332386, 7824.987185490112, 11222.290732080412, 11574.213146105345, 6715.881452573606, 9126.15279862235, 10190.363192457524, 9654.40238348726, 10346.20667300743, 11451.252823456034, 10303.386888882871, 7972.953556201648, 6566.314892513834, 8464.004908603787, 8782.875599931456, 7541.925983198198, 9182.570310940071, 6202.618492817839, 9557.093658301681, 11055.362803884274, 6871.9467753756835, 11990.640823268626, 658.7211006862022, 9304.140956154306, 8364.393948790017, 8367.202838847748, 7552.405706832582, 12094.410943447478, 9984.646121228792, 9183.844353384231, 10374.613361563823, 6103.91761802073, 6278.4327137354585, 10251.422336185868, 10817.503015787008, 514.0241608905325, 5770.617819492649, 5977.790116408287, 7265.7732857673755, 8758.541411274146, 6449.571102291531, 10130.628639385865, 8394.052409504113, 8211.339967728407, 0.802993359085007, 10769.46879316992, 10466.78820457984], "policy_adversary_policy_reward": [6350.774178995449, 7333.300939384553, 5420.0216552384945, 4876.754156438377, 7484.053632223204, 6683.767068627952, 1109.8854471052282, 3618.5482500970115, 3572.0120211097706, 3926.2427803645783, 7910.332306723579, 5975.313680031045, 4483.66748137626, 7370.184822365463, 3119.5210706162934, 5610.65203136393, 4692.610365108002, 5444.7145252015125, 7652.506632353745, 6063.856972472787, 1749.0587581588534, 1635.3371358469697, 5323.02118409009, 4081.1856363880397, 6740.728968939213, 6939.505756560997, 5522.860575822936, 5092.452426475937, 5220.7568506421485, 4234.781149080378, 3341.1665896010327, 5249.672574907841, 6796.906411850542, 6462.401844937076, 5525.029850269654, 7304.363107092001, 7888.01752596539, 8975.074093517027, 6227.112556710125, 4927.451129843575, 7535.287471108679, 7645.6528339255, 6126.435138788825, 4994.519393122535, 1918.8180881228877, 1876.2824915636793, 2971.9692197117906, 3503.390416851147, 6154.422456141489, 4434.523171087681, 6572.877628988703, 6199.684749576848, 4081.949576029574, 5020.465576622104, 6462.512087795611, 4713.337154182267, 4146.822203752647, 5392.840059014174, 5487.6556976773145, 4967.9874664290655, 6424.510513690223, 7965.085572695389, 6974.725235796969, 6785.9811996802555, 5782.636094183259, 3342.8020171232947, 5122.627497347321, 4613.99406795433, 1777.6521367422517, 2491.844014044673, 6652.862669572542, 6531.29485538467, 5132.0548308223115, 5982.446818538848, 2871.4255108883485, 1857.9534584992284, 4465.198659022435, 3838.6866616462776, 5071.635464507827, 3938.345994442186, 9207.884485892542, 8890.866495653863, 8004.338208464381, 7458.596973858049, 4141.822257092199, 4227.453603538292, 1946.3786553439659, 2052.076645835468, 3875.8878141911146, 3427.941288379285, 10056.472907584155, 7358.642326739497, 6641.726245687114, 7401.310679782332, 2030.8740962480983, 1329.6895835351413, 4718.156217629887, 6233.968353175366, 3141.774919336006, 2623.544698397624, 4940.20077049343, 5779.166873155211, 3732.9123494242576, 3314.1179595072745, 6245.71723878842, 4133.174645827657, 2335.271689844256, 1567.249670880411, 6270.505286746282, 5815.920137716958, 2881.2338880026214, 2564.4571591981044, 1996.4308999085374, 2560.703541980133, 7358.516449658392, 6957.957529407418, 4112.113427810157, 4943.456805737383, 3937.8542540940844, 2508.975416047235, 3521.551012842688, 4448.599760525762, 3257.788292071651, 3614.850046280673, 2667.674063694996, 1501.0141217970042, 3239.336072124133, 3832.9731670207466, 5731.697558894029, 6150.123736224827, 5647.913537676558, 7559.739469847639, 5185.397954541439, 5664.166919870457, 5239.689198315206, 4714.10250823885, 5669.648604576393, 6528.510118942612, 4943.552880081296, 4470.358674893078, 7557.316647519579, 7406.649499325515, 4144.001378073244, 4560.230468475814, 3075.3258391054806, 1156.2257280500025, 5744.835557991666, 7072.63139732986, 2079.140115361353, 1969.1169716899865, 2311.1575470139396, 2733.28692996067, 4702.101588905002, 4788.1587664982835, 5397.893891948479, 5133.790111800266, 4085.419754879228, 5765.56894805213, 3952.208103394644, 6582.185885189446, 2014.4088293185312, 1662.1264370332453, 3974.2654426157083, 3134.544208744624, 3766.980412289701, 4795.861856842545, 3312.7648657424916, 3749.92992384169, 6720.410953854136, 7691.187955156197, 7350.411234618271, 7555.967645446198, 982.3210322995487, 3874.8956215436333, 3237.063030400759, 2805.2277230591694, 1795.0305945437901, 2526.5349982116218, 8292.482538729, 8262.803581146218, 8148.859523059577, 7568.665354925146, 6832.258751241621, 6506.486147858781, 4705.01016737676, 5354.033274567267, 5466.099882687133, 7023.996025163307, 3986.157366914282, 3572.1097130177614, 5665.559680739669, 5599.035725155194, 4519.954843171836, 5903.390490437509, 69.90768475956975, 23.256345674449648, 3069.971484991548, 3175.905616962087, 1251.3112335151332, 3663.736074658251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39969988935790096, "mean_inference_ms": 0.9913770443638967, "mean_action_processing_ms": 0.16703940205276846, "mean_env_wait_ms": 0.054090863317886165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003620624542236328, "StateBufferConnector_ms": 0.0024358034133911133, "ViewRequirementAgentConnector_ms": 0.06450963020324707}, "num_episodes": 22, "episode_return_max": 22421.739114920674, "episode_return_min": 93.9670237931044, "episode_return_mean": 17747.350615505806}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.7103410573509, "num_env_steps_trained_throughput_per_sec": 539.7103410573509, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 7502.308, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7502.272, "sample_time_ms": 743.346, "learn_time_ms": 6747.619, "learn_throughput": 592.802, "synch_weights_time_ms": 10.775}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 35, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-33-54", "timestamp": 1723235634, "time_this_iter_s": 7.416018962860107, "time_total_s": 266.41798639297485, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320722f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.41798639297485, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 26.03636363636364, "ram_util_percent": 81.52727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9602043111527723, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.919846963125561, "policy_loss": 0.0300826437266238, "vf_loss": 9.856074447732754, "vf_explained_var": 9.801053496264906e-06, "kl": 0.03943577916730964, "entropy": 1.0720736016041388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8620252038662632, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.006433388590812, "policy_loss": -0.003922487481274098, "vf_loss": 10.0, "vf_explained_var": 4.601708302895228e-05, "kl": 0.01022803605737863, "entropy": 1.5389994759112597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 24630.149791178148, "episode_reward_min": 93.9670237931044, "episode_reward_mean": 17797.726757966102, "episode_len_mean": 191.84, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19184, "policy_reward_min": {"agent_policy": 0.802993359085007, "adversary_policy": 23.256345674449648}, "policy_reward_max": {"agent_policy": 12803.15258317007, "adversary_policy": 10816.964533561631}, "policy_reward_mean": {"agent_policy": 8327.985927939393, "adversary_policy": 4734.870415013353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21633.10919007279, 18808.54998750562, 4336.433521022269, 17099.802291411277, 18518.775968713962, 20235.56076651121, 18174.75662140694, 18854.58308789088, 18246.867455502597, 19108.06259562816, 20566.266553267036, 20582.04009240314, 17482.948814954918, 18710.129747373143, 15911.996551365746, 20122.330557913014, 19187.2360472784, 15975.27124710122, 17974.512642643313, 18079.395917465878, 22421.739114920674, 21554.134710204784, 18230.65595157604, 16052.758471999869, 17557.189562018117, 21500.777950470445, 20604.166012498546, 15441.379267122387, 18798.738042301593, 6348.998355356197, 19066.046671545144, 17453.207484188948, 18260.68977308817, 15694.660193057063, 19911.412609953342, 16667.98177928114, 16131.347587994, 21032.355431639415, 18181.723032169873, 16637.19286259881, 17624.553156855738, 17218.845011359743, 15619.941008947973, 17375.696128027834, 19854.774851320435, 19773.96790003797, 19313.569783015693, 18736.667306485593, 19740.08470671719, 18596.481865914426, 21166.584639662993, 18261.32550485074, 15286.914371039826, 19689.413730697182, 16038.89791032002, 5703.165577660809, 18794.401311557624, 18896.07795253873, 18218.191541779033, 18086.79969541667, 15770.946209799211, 17093.455772589157, 17746.686622516496, 17437.308151148034, 20515.516527031068, 21184.811593799994, 15108.638990029045, 16859.793769246997, 4835.589753645947, 22325.903939367843, 21695.314994393135, 20604.518184867757, 18817.584853218137, 18939.667010141962, 17688.895719317945, 19658.64781539894, 18634.685301337828, 93.9670237931044, 17015.345895123617, 15381.835512753225, 17022.337780305428, 16268.964407731124, 24630.149791178148, 16201.428676469835, 19808.198250267727, 17794.543088147977, 20394.338689355147, 17725.682892454464, 16320.254124551157, 18407.876334958935, 21949.073732704408, 17747.620068485558, 21574.87020375225, 14813.16785370575, 17052.025646317394, 18704.063500646193, 17437.480975377526, 17470.302886351117, 21953.525415468885, 17935.519363239455], "episode_lengths": [200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6452.168885038573, 7687.595455594239, 541.3329413357035, 10624.442654848324, 7929.830341484783, 7462.998387945667, 9072.341468755267, 7678.733845912978, 8707.205192735753, 8652.419431521836, 6176.67046688143, 6821.333656925899, 8357.51070364835, 8973.508182071468, 11642.500400578821, 6938.173032955782, 8072.734397917273, 11245.89227771365, 9670.62732197464, 9069.414458515856, 4322.988133374218, 6091.199527882337, 9861.380090945553, 12054.303170820462, 10253.36045944774, 4085.6627161467877, 6561.12908702905, 12080.815587339172, 7846.613471496369, 583.6787376225742, 8346.67902789655, 10406.177175257446, 7881.79788847218, 11792.138832332386, 7824.987185490112, 11222.290732080412, 11574.213146105345, 6715.881452573606, 9126.15279862235, 10190.363192457524, 9654.40238348726, 10346.20667300743, 11451.252823456034, 10303.386888882871, 7972.953556201648, 6566.314892513834, 8464.004908603787, 8782.875599931456, 7541.925983198198, 9182.570310940071, 6202.618492817839, 9557.093658301681, 11055.362803884274, 6871.9467753756835, 11990.640823268626, 658.7211006862022, 9304.140956154306, 8364.393948790017, 8367.202838847748, 7552.405706832582, 12094.410943447478, 9984.646121228792, 9183.844353384231, 10374.613361563823, 6103.91761802073, 6278.4327137354585, 10251.422336185868, 10817.503015787008, 514.0241608905325, 5770.617819492649, 5977.790116408287, 7265.7732857673755, 8758.541411274146, 6449.571102291531, 10130.628639385865, 8394.052409504113, 8211.339967728407, 0.802993359085007, 10769.46879316992, 10466.78820457984, 10495.058108562407, 11033.779325823034, 3260.2368691100633, 10637.386287531956, 7557.904451068665, 9671.258628966307, 6732.057698452033, 9827.236121564034, 10398.569730909388, 8716.841249253992, 4456.174549686016, 10241.644920953071, 6039.7053592527145, 12803.15258317007, 11115.167237937128, 8566.50318573112, 9867.822948270126, 8631.583168787614, 5901.993996006585, 8256.659962767884], "policy_adversary_policy_reward": [7535.287471108679, 7645.6528339255, 6126.435138788825, 4994.519393122535, 1918.8180881228877, 1876.2824915636793, 2971.9692197117906, 3503.390416851147, 6154.422456141489, 4434.523171087681, 6572.877628988703, 6199.684749576848, 4081.949576029574, 5020.465576622104, 6462.512087795611, 4713.337154182267, 4146.822203752647, 5392.840059014174, 5487.6556976773145, 4967.9874664290655, 6424.510513690223, 7965.085572695389, 6974.725235796969, 6785.9811996802555, 5782.636094183259, 3342.8020171232947, 5122.627497347321, 4613.99406795433, 1777.6521367422517, 2491.844014044673, 6652.862669572542, 6531.29485538467, 5132.0548308223115, 5982.446818538848, 2871.4255108883485, 1857.9534584992284, 4465.198659022435, 3838.6866616462776, 5071.635464507827, 3938.345994442186, 9207.884485892542, 8890.866495653863, 8004.338208464381, 7458.596973858049, 4141.822257092199, 4227.453603538292, 1946.3786553439659, 2052.076645835468, 3875.8878141911146, 3427.941288379285, 10056.472907584155, 7358.642326739497, 6641.726245687114, 7401.310679782332, 2030.8740962480983, 1329.6895835351413, 4718.156217629887, 6233.968353175366, 3141.774919336006, 2623.544698397624, 4940.20077049343, 5779.166873155211, 3732.9123494242576, 3314.1179595072745, 6245.71723878842, 4133.174645827657, 2335.271689844256, 1567.249670880411, 6270.505286746282, 5815.920137716958, 2881.2338880026214, 2564.4571591981044, 1996.4308999085374, 2560.703541980133, 7358.516449658392, 6957.957529407418, 4112.113427810157, 4943.456805737383, 3937.8542540940844, 2508.975416047235, 3521.551012842688, 4448.599760525762, 3257.788292071651, 3614.850046280673, 2667.674063694996, 1501.0141217970042, 3239.336072124133, 3832.9731670207466, 5731.697558894029, 6150.123736224827, 5647.913537676558, 7559.739469847639, 5185.397954541439, 5664.166919870457, 5239.689198315206, 4714.10250823885, 5669.648604576393, 6528.510118942612, 4943.552880081296, 4470.358674893078, 7557.316647519579, 7406.649499325515, 4144.001378073244, 4560.230468475814, 3075.3258391054806, 1156.2257280500025, 5744.835557991666, 7072.63139732986, 2079.140115361353, 1969.1169716899865, 2311.1575470139396, 2733.28692996067, 4702.101588905002, 4788.1587664982835, 5397.893891948479, 5133.790111800266, 4085.419754879228, 5765.56894805213, 3952.208103394644, 6582.185885189446, 2014.4088293185312, 1662.1264370332453, 3974.2654426157083, 3134.544208744624, 3766.980412289701, 4795.861856842545, 3312.7648657424916, 3749.92992384169, 6720.410953854136, 7691.187955156197, 7350.411234618271, 7555.967645446198, 982.3210322995487, 3874.8956215436333, 3237.063030400759, 2805.2277230591694, 1795.0305945437901, 2526.5349982116218, 8292.482538729, 8262.803581146218, 8148.859523059577, 7568.665354925146, 6832.258751241621, 6506.486147858781, 4705.01016737676, 5354.033274567267, 5466.099882687133, 7023.996025163307, 3986.157366914282, 3572.1097130177614, 5665.559680739669, 5599.035725155194, 4519.954843171836, 5903.390490437509, 69.90768475956975, 23.256345674449648, 3069.971484991548, 3175.905616962087, 1251.3112335151332, 3663.736074658251, 3634.9765436044695, 2892.3031281385274, 3046.4995704191224, 2188.685511488951, 10816.964533561631, 10552.94838850643, 2062.9625037635733, 3501.0798851743584, 5973.331296229274, 6276.962502969804, 3672.2975887071616, 4450.986870474476, 6677.122343402234, 6985.158647500857, 3942.0319746039577, 3956.4147962864386, 2879.197448254849, 3042.4869453869283, 5381.2033440120595, 4309.831741692901, 9598.146322452007, 7894.752860566388, 3884.197519466315, 3621.777628066147, 8055.592115860573, 7479.572728638968, 683.8396884721323, 1326.1755820635665, 2957.7283753174534, 2979.1300330627746, 5560.7961718739725, 4576.764143041106, 4268.945853042178, 3300.7121740652433, 5492.134314189585, 3346.585403373954, 7837.846867821985, 8213.684551640275, 5871.478368592761, 3807.3810318788105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992495786285042, "mean_inference_ms": 0.9900777815856151, "mean_action_processing_ms": 0.1669258349001406, "mean_env_wait_ms": 0.05402862275722563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035878419876098633, "StateBufferConnector_ms": 0.0025320053100585938, "ViewRequirementAgentConnector_ms": 0.06270015239715576}, "num_episodes": 20, "episode_return_max": 24630.149791178148, "episode_return_min": 93.9670237931044, "episode_return_mean": 17797.726757966102}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.8123798875002, "num_env_steps_trained_throughput_per_sec": 539.8123798875002, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 7464.095, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7464.059, "sample_time_ms": 739.689, "learn_time_ms": 6713.095, "learn_throughput": 595.85, "synch_weights_time_ms": 10.802}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 36, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-02", "timestamp": 1723235642, "time_this_iter_s": 7.414287805557251, "time_total_s": 273.8322741985321, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 273.8322741985321, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.75454545454545, "ram_util_percent": 81.16363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8479764261494869, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.937821721273755, "policy_loss": 0.013537113181753923, "vf_loss": 9.906887244673634, "vf_explained_var": 1.0558537074497767e-07, "kl": 0.013576352197391095, "entropy": 1.0181704354664636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8552791662203769, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000220989187559, "policy_loss": -0.0030376676278441057, "vf_loss": 9.99535042544206, "vf_explained_var": 1.4197205503781636e-05, "kl": 0.0078106037855225924, "entropy": 1.5536047977705796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "env_runners": {"episode_reward_max": 24630.149791178148, "episode_reward_min": 93.9670237931044, "episode_reward_mean": 17854.496614222528, "episode_len_mean": 192.02, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19202, "policy_reward_min": {"agent_policy": 0.802993359085007, "adversary_policy": 23.256345674449648}, "policy_reward_max": {"agent_policy": 12803.15258317007, "adversary_policy": 10816.964533561631}, "policy_reward_mean": {"agent_policy": 8261.013998372362, "adversary_policy": 4796.741307925081}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21554.134710204784, 18230.65595157604, 16052.758471999869, 17557.189562018117, 21500.777950470445, 20604.166012498546, 15441.379267122387, 18798.738042301593, 6348.998355356197, 19066.046671545144, 17453.207484188948, 18260.68977308817, 15694.660193057063, 19911.412609953342, 16667.98177928114, 16131.347587994, 21032.355431639415, 18181.723032169873, 16637.19286259881, 17624.553156855738, 17218.845011359743, 15619.941008947973, 17375.696128027834, 19854.774851320435, 19773.96790003797, 19313.569783015693, 18736.667306485593, 19740.08470671719, 18596.481865914426, 21166.584639662993, 18261.32550485074, 15286.914371039826, 19689.413730697182, 16038.89791032002, 5703.165577660809, 18794.401311557624, 18896.07795253873, 18218.191541779033, 18086.79969541667, 15770.946209799211, 17093.455772589157, 17746.686622516496, 17437.308151148034, 20515.516527031068, 21184.811593799994, 15108.638990029045, 16859.793769246997, 4835.589753645947, 22325.903939367843, 21695.314994393135, 20604.518184867757, 18817.584853218137, 18939.667010141962, 17688.895719317945, 19658.64781539894, 18634.685301337828, 93.9670237931044, 17015.345895123617, 15381.835512753225, 17022.337780305428, 16268.964407731124, 24630.149791178148, 16201.428676469835, 19808.198250267727, 17794.543088147977, 20394.338689355147, 17725.682892454464, 16320.254124551157, 18407.876334958935, 21949.073732704408, 17747.620068485558, 21574.87020375225, 14813.16785370575, 17052.025646317394, 18704.063500646193, 17437.480975377526, 17470.302886351117, 21953.525415468885, 17935.519363239455, 21710.331735303156, 21526.979925828356, 17484.62118209787, 18985.298130659365, 17566.795863469044, 19737.43875721782, 20837.721933942215, 23320.76452892067, 21745.662086924, 19234.47781478162, 18728.81087282314, 17992.246318792888, 16578.36529122497, 15758.26477470047, 15074.60135860327, 18812.204179577526, 22090.592299972355, 5716.956769296549, 17313.614735905216, 17959.30426310582, 19532.301574848403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200], "policy_agent_policy_reward": [6091.199527882337, 9861.380090945553, 12054.303170820462, 10253.36045944774, 4085.6627161467877, 6561.12908702905, 12080.815587339172, 7846.613471496369, 583.6787376225742, 8346.67902789655, 10406.177175257446, 7881.79788847218, 11792.138832332386, 7824.987185490112, 11222.290732080412, 11574.213146105345, 6715.881452573606, 9126.15279862235, 10190.363192457524, 9654.40238348726, 10346.20667300743, 11451.252823456034, 10303.386888882871, 7972.953556201648, 6566.314892513834, 8464.004908603787, 8782.875599931456, 7541.925983198198, 9182.570310940071, 6202.618492817839, 9557.093658301681, 11055.362803884274, 6871.9467753756835, 11990.640823268626, 658.7211006862022, 9304.140956154306, 8364.393948790017, 8367.202838847748, 7552.405706832582, 12094.410943447478, 9984.646121228792, 9183.844353384231, 10374.613361563823, 6103.91761802073, 6278.4327137354585, 10251.422336185868, 10817.503015787008, 514.0241608905325, 5770.617819492649, 5977.790116408287, 7265.7732857673755, 8758.541411274146, 6449.571102291531, 10130.628639385865, 8394.052409504113, 8211.339967728407, 0.802993359085007, 10769.46879316992, 10466.78820457984, 10495.058108562407, 11033.779325823034, 3260.2368691100633, 10637.386287531956, 7557.904451068665, 9671.258628966307, 6732.057698452033, 9827.236121564034, 10398.569730909388, 8716.841249253992, 4456.174549686016, 10241.644920953071, 6039.7053592527145, 12803.15258317007, 11115.167237937128, 8566.50318573112, 9867.822948270126, 8631.583168787614, 5901.993996006585, 8256.659962767884, 5093.838380376005, 5965.404203352222, 10286.556644249578, 8419.111979374622, 8434.521804966522, 8284.739594039935, 6158.808782908835, 4012.241891908228, 4478.200621158847, 7904.498611141798, 6590.859847376557, 9019.049190763328, 10159.919850495708, 11624.82096111563, 12140.55365034865, 6716.985015118107, 5097.747475947706, 1233.5857442001407, 10082.957599852407, 10165.303467513817, 7533.5233648188305], "policy_adversary_policy_reward": [8004.338208464381, 7458.596973858049, 4141.822257092199, 4227.453603538292, 1946.3786553439659, 2052.076645835468, 3875.8878141911146, 3427.941288379285, 10056.472907584155, 7358.642326739497, 6641.726245687114, 7401.310679782332, 2030.8740962480983, 1329.6895835351413, 4718.156217629887, 6233.968353175366, 3141.774919336006, 2623.544698397624, 4940.20077049343, 5779.166873155211, 3732.9123494242576, 3314.1179595072745, 6245.71723878842, 4133.174645827657, 2335.271689844256, 1567.249670880411, 6270.505286746282, 5815.920137716958, 2881.2338880026214, 2564.4571591981044, 1996.4308999085374, 2560.703541980133, 7358.516449658392, 6957.957529407418, 4112.113427810157, 4943.456805737383, 3937.8542540940844, 2508.975416047235, 3521.551012842688, 4448.599760525762, 3257.788292071651, 3614.850046280673, 2667.674063694996, 1501.0141217970042, 3239.336072124133, 3832.9731670207466, 5731.697558894029, 6150.123736224827, 5647.913537676558, 7559.739469847639, 5185.397954541439, 5664.166919870457, 5239.689198315206, 4714.10250823885, 5669.648604576393, 6528.510118942612, 4943.552880081296, 4470.358674893078, 7557.316647519579, 7406.649499325515, 4144.001378073244, 4560.230468475814, 3075.3258391054806, 1156.2257280500025, 5744.835557991666, 7072.63139732986, 2079.140115361353, 1969.1169716899865, 2311.1575470139396, 2733.28692996067, 4702.101588905002, 4788.1587664982835, 5397.893891948479, 5133.790111800266, 4085.419754879228, 5765.56894805213, 3952.208103394644, 6582.185885189446, 2014.4088293185312, 1662.1264370332453, 3974.2654426157083, 3134.544208744624, 3766.980412289701, 4795.861856842545, 3312.7648657424916, 3749.92992384169, 6720.410953854136, 7691.187955156197, 7350.411234618271, 7555.967645446198, 982.3210322995487, 3874.8956215436333, 3237.063030400759, 2805.2277230591694, 1795.0305945437901, 2526.5349982116218, 8292.482538729, 8262.803581146218, 8148.859523059577, 7568.665354925146, 6832.258751241621, 6506.486147858781, 4705.01016737676, 5354.033274567267, 5466.099882687133, 7023.996025163307, 3986.157366914282, 3572.1097130177614, 5665.559680739669, 5599.035725155194, 4519.954843171836, 5903.390490437509, 69.90768475956975, 23.256345674449648, 3069.971484991548, 3175.905616962087, 1251.3112335151332, 3663.736074658251, 3634.9765436044695, 2892.3031281385274, 3046.4995704191224, 2188.685511488951, 10816.964533561631, 10552.94838850643, 2062.9625037635733, 3501.0798851743584, 5973.331296229274, 6276.962502969804, 3672.2975887071616, 4450.986870474476, 6677.122343402234, 6985.158647500857, 3942.0319746039577, 3956.4147962864386, 2879.197448254849, 3042.4869453869283, 5381.2033440120595, 4309.831741692901, 9598.146322452007, 7894.752860566388, 3884.197519466315, 3621.777628066147, 8055.592115860573, 7479.572728638968, 683.8396884721323, 1326.1755820635665, 2957.7283753174534, 2979.1300330627746, 5560.7961718739725, 4576.764143041106, 4268.945853042178, 3300.7121740652433, 5492.134314189585, 3346.585403373954, 7837.846867821985, 8213.684551640275, 5871.478368592761, 3807.3810318788105, 8136.636203070357, 8479.857151856782, 7397.9521295977465, 8163.623592878426, 3575.9543673658354, 3622.110170482455, 4861.312254190307, 5704.8738970944805, 3773.1806293389054, 5359.093429163604, 5838.577510284922, 5614.12165289294, 6817.2429214919675, 7861.670229541448, 10024.792545301243, 9283.730091711172, 8168.54195179117, 9098.919513973953, 5245.286221486921, 6084.692982152963, 4595.58692914665, 7542.3640962998825, 3857.956349130631, 5115.240778898932, 2446.005215168212, 3972.440225561047, 2364.39973203353, 1769.0440815513298, 957.7676655119261, 1976.2800427426841, 7417.379479898644, 4677.83968456077, 8774.890050757644, 8217.954773267018, 1977.201889423495, 2506.169135672914, 3198.3403751984515, 4032.3167608543868, 3841.0834138742716, 3952.9173817177125, 5406.379297386304, 6592.398912643243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39869393581762835, "mean_inference_ms": 0.9884047445341047, "mean_action_processing_ms": 0.16675306652923264, "mean_env_wait_ms": 0.05392781687181629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036096572875976562, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06416082382202148}, "num_episodes": 21, "episode_return_max": 24630.149791178148, "episode_return_min": 93.9670237931044, "episode_return_mean": 17854.496614222528}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.4627033650723, "num_env_steps_trained_throughput_per_sec": 551.4627033650723, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 7440.881, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7440.846, "sample_time_ms": 736.949, "learn_time_ms": 6692.937, "learn_throughput": 597.645, "synch_weights_time_ms": 10.485}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "training_iteration": 37, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-09", "timestamp": 1723235649, "time_this_iter_s": 7.257642984390259, "time_total_s": 281.08991718292236, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.08991718292236, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.240000000000002, "ram_util_percent": 80.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.727474052403812, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997098350524903, "policy_loss": 0.005039748526547873, "vf_loss": 9.980218786411184, "vf_explained_var": 5.181110094464014e-05, "kl": 0.0092394137249954, "entropy": 0.957335520295239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8348861287347973, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00307383040587, "policy_loss": -0.001721691799563511, "vf_loss": 10.0, "vf_explained_var": 1.900667945543925e-05, "kl": 0.004736302865543014, "entropy": 1.5579313493023317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 24630.149791178148, "episode_reward_min": 93.9670237931044, "episode_reward_mean": 18041.6141059853, "episode_len_mean": 193.46, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19346, "policy_reward_min": {"agent_policy": 0.802993359085007, "adversary_policy": 23.256345674449648}, "policy_reward_max": {"agent_policy": 12803.15258317007, "adversary_policy": 10816.964533561631}, "policy_reward_mean": {"agent_policy": 8264.166838227951, "adversary_policy": 4888.723633878674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17218.845011359743, 15619.941008947973, 17375.696128027834, 19854.774851320435, 19773.96790003797, 19313.569783015693, 18736.667306485593, 19740.08470671719, 18596.481865914426, 21166.584639662993, 18261.32550485074, 15286.914371039826, 19689.413730697182, 16038.89791032002, 5703.165577660809, 18794.401311557624, 18896.07795253873, 18218.191541779033, 18086.79969541667, 15770.946209799211, 17093.455772589157, 17746.686622516496, 17437.308151148034, 20515.516527031068, 21184.811593799994, 15108.638990029045, 16859.793769246997, 4835.589753645947, 22325.903939367843, 21695.314994393135, 20604.518184867757, 18817.584853218137, 18939.667010141962, 17688.895719317945, 19658.64781539894, 18634.685301337828, 93.9670237931044, 17015.345895123617, 15381.835512753225, 17022.337780305428, 16268.964407731124, 24630.149791178148, 16201.428676469835, 19808.198250267727, 17794.543088147977, 20394.338689355147, 17725.682892454464, 16320.254124551157, 18407.876334958935, 21949.073732704408, 17747.620068485558, 21574.87020375225, 14813.16785370575, 17052.025646317394, 18704.063500646193, 17437.480975377526, 17470.302886351117, 21953.525415468885, 17935.519363239455, 21710.331735303156, 21526.979925828356, 17484.62118209787, 18985.298130659365, 17566.795863469044, 19737.43875721782, 20837.721933942215, 23320.76452892067, 21745.662086924, 19234.47781478162, 18728.81087282314, 17992.246318792888, 16578.36529122497, 15758.26477470047, 15074.60135860327, 18812.204179577526, 22090.592299972355, 5716.956769296549, 17313.614735905216, 17959.30426310582, 19532.301574848403, 17691.65678985514, 18465.885863790452, 20238.459914877658, 16372.200878675816, 16064.540465138729, 18693.972652535995, 18302.379290225188, 17420.08754818734, 17938.371989372077, 16125.09977818219, 20969.20827115612, 17945.169671177864, 19704.162402624977, 19941.445177068803, 19283.91029504323, 21787.253301838384, 18830.580891473, 18260.287473146986, 19018.53762596925, 18408.507801857828], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [10346.20667300743, 11451.252823456034, 10303.386888882871, 7972.953556201648, 6566.314892513834, 8464.004908603787, 8782.875599931456, 7541.925983198198, 9182.570310940071, 6202.618492817839, 9557.093658301681, 11055.362803884274, 6871.9467753756835, 11990.640823268626, 658.7211006862022, 9304.140956154306, 8364.393948790017, 8367.202838847748, 7552.405706832582, 12094.410943447478, 9984.646121228792, 9183.844353384231, 10374.613361563823, 6103.91761802073, 6278.4327137354585, 10251.422336185868, 10817.503015787008, 514.0241608905325, 5770.617819492649, 5977.790116408287, 7265.7732857673755, 8758.541411274146, 6449.571102291531, 10130.628639385865, 8394.052409504113, 8211.339967728407, 0.802993359085007, 10769.46879316992, 10466.78820457984, 10495.058108562407, 11033.779325823034, 3260.2368691100633, 10637.386287531956, 7557.904451068665, 9671.258628966307, 6732.057698452033, 9827.236121564034, 10398.569730909388, 8716.841249253992, 4456.174549686016, 10241.644920953071, 6039.7053592527145, 12803.15258317007, 11115.167237937128, 8566.50318573112, 9867.822948270126, 8631.583168787614, 5901.993996006585, 8256.659962767884, 5093.838380376005, 5965.404203352222, 10286.556644249578, 8419.111979374622, 8434.521804966522, 8284.739594039935, 6158.808782908835, 4012.241891908228, 4478.200621158847, 7904.498611141798, 6590.859847376557, 9019.049190763328, 10159.919850495708, 11624.82096111563, 12140.55365034865, 6716.985015118107, 5097.747475947706, 1233.5857442001407, 10082.957599852407, 10165.303467513817, 7533.5233648188305, 9637.860470553893, 9226.782994727984, 5853.647324103448, 10997.465705816254, 11947.91867356098, 9318.335497220072, 8302.36930041442, 9611.11991083032, 9447.911053921078, 9211.708655267634, 6754.228117732459, 8519.390068248922, 8330.734389498437, 7483.560121134244, 8806.94895338922, 5733.9330456464595, 8299.51020635244, 9169.815455132968, 8675.670163664458, 9139.600541848053], "policy_adversary_policy_reward": [3257.788292071651, 3614.850046280673, 2667.674063694996, 1501.0141217970042, 3239.336072124133, 3832.9731670207466, 5731.697558894029, 6150.123736224827, 5647.913537676558, 7559.739469847639, 5185.397954541439, 5664.166919870457, 5239.689198315206, 4714.10250823885, 5669.648604576393, 6528.510118942612, 4943.552880081296, 4470.358674893078, 7557.316647519579, 7406.649499325515, 4144.001378073244, 4560.230468475814, 3075.3258391054806, 1156.2257280500025, 5744.835557991666, 7072.63139732986, 2079.140115361353, 1969.1169716899865, 2311.1575470139396, 2733.28692996067, 4702.101588905002, 4788.1587664982835, 5397.893891948479, 5133.790111800266, 4085.419754879228, 5765.56894805213, 3952.208103394644, 6582.185885189446, 2014.4088293185312, 1662.1264370332453, 3974.2654426157083, 3134.544208744624, 3766.980412289701, 4795.861856842545, 3312.7648657424916, 3749.92992384169, 6720.410953854136, 7691.187955156197, 7350.411234618271, 7555.967645446198, 982.3210322995487, 3874.8956215436333, 3237.063030400759, 2805.2277230591694, 1795.0305945437901, 2526.5349982116218, 8292.482538729, 8262.803581146218, 8148.859523059577, 7568.665354925146, 6832.258751241621, 6506.486147858781, 4705.01016737676, 5354.033274567267, 5466.099882687133, 7023.996025163307, 3986.157366914282, 3572.1097130177614, 5665.559680739669, 5599.035725155194, 4519.954843171836, 5903.390490437509, 69.90768475956975, 23.256345674449648, 3069.971484991548, 3175.905616962087, 1251.3112335151332, 3663.736074658251, 3634.9765436044695, 2892.3031281385274, 3046.4995704191224, 2188.685511488951, 10816.964533561631, 10552.94838850643, 2062.9625037635733, 3501.0798851743584, 5973.331296229274, 6276.962502969804, 3672.2975887071616, 4450.986870474476, 6677.122343402234, 6985.158647500857, 3942.0319746039577, 3956.4147962864386, 2879.197448254849, 3042.4869453869283, 5381.2033440120595, 4309.831741692901, 9598.146322452007, 7894.752860566388, 3884.197519466315, 3621.777628066147, 8055.592115860573, 7479.572728638968, 683.8396884721323, 1326.1755820635665, 2957.7283753174534, 2979.1300330627746, 5560.7961718739725, 4576.764143041106, 4268.945853042178, 3300.7121740652433, 5492.134314189585, 3346.585403373954, 7837.846867821985, 8213.684551640275, 5871.478368592761, 3807.3810318788105, 8136.636203070357, 8479.857151856782, 7397.9521295977465, 8163.623592878426, 3575.9543673658354, 3622.110170482455, 4861.312254190307, 5704.8738970944805, 3773.1806293389054, 5359.093429163604, 5838.577510284922, 5614.12165289294, 6817.2429214919675, 7861.670229541448, 10024.792545301243, 9283.730091711172, 8168.54195179117, 9098.919513973953, 5245.286221486921, 6084.692982152963, 4595.58692914665, 7542.3640962998825, 3857.956349130631, 5115.240778898932, 2446.005215168212, 3972.440225561047, 2364.39973203353, 1769.0440815513298, 957.7676655119261, 1976.2800427426841, 7417.379479898644, 4677.83968456077, 8774.890050757644, 8217.954773267018, 1977.201889423495, 2506.169135672914, 3198.3403751984515, 4032.3167608543868, 3841.0834138742716, 3952.9173817177125, 5406.379297386304, 6592.398912643243, 3552.438534360274, 4501.357784940965, 4336.332510393521, 4902.77035866895, 7973.4181223428395, 6411.39446843129, 3138.9792039785652, 2235.7559688810184, 2174.297876073151, 1942.3239155046172, 4806.180236666806, 4569.456918649145, 5839.7663233165285, 4160.243666494205, 3303.570342341805, 4505.397295015228, 3802.760174788355, 4687.700760662639, 4930.426968463324, 1982.964154451261, 6919.182546795841, 7295.797606627755, 3806.9670957840885, 5618.8125071448285, 5687.166129040641, 5686.2618840859195, 6490.4550732170865, 5967.429982717492, 5165.516888609458, 5311.44445304453, 8169.842987121302, 7883.477269070663, 5823.51979227497, 4707.550892845601, 4963.5732793859415, 4126.89873862803, 4890.388913382417, 5452.478548922395, 4780.849217482436, 4488.058042527348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39802333450079, "mean_inference_ms": 0.9863591900300108, "mean_action_processing_ms": 0.16661420208974853, "mean_env_wait_ms": 0.0537369841761857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034416913986206055, "StateBufferConnector_ms": 0.0025200843811035156, "ViewRequirementAgentConnector_ms": 0.06312870979309082}, "num_episodes": 20, "episode_return_max": 24630.149791178148, "episode_return_min": 93.9670237931044, "episode_return_mean": 18041.6141059853}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.9840064553905, "num_env_steps_trained_throughput_per_sec": 498.9840064553905, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 7494.159, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7494.124, "sample_time_ms": 734.639, "learn_time_ms": 6748.386, "learn_throughput": 592.734, "synch_weights_time_ms": 10.626}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 38, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-18", "timestamp": 1723235658, "time_this_iter_s": 8.02253794670105, "time_total_s": 289.1124551296234, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207274c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.1124551296234, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.325000000000003, "ram_util_percent": 81.29166666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8138117942190359, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.952033651947344, "policy_loss": 3.131009667875275e-06, "vf_loss": 9.945028087575599, "vf_explained_var": 1.2078613200515667e-07, "kl": 0.005464491456569661, "entropy": 0.9425048906021017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8700871397120257, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.983740962545077, "policy_loss": -0.010853249941283139, "vf_loss": 9.988234080870946, "vf_explained_var": -9.597130119800567e-05, "kl": 0.012563230922872511, "entropy": 1.5304862504204115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "env_runners": {"episode_reward_max": 24630.149791178148, "episode_reward_min": 93.9670237931044, "episode_reward_mean": 17836.64098468171, "episode_len_mean": 191.29, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19129, "policy_reward_min": {"agent_policy": 0.802993359085007, "adversary_policy": 23.256345674449648}, "policy_reward_max": {"agent_policy": 12803.15258317007, "adversary_policy": 10816.964533561631}, "policy_reward_mean": {"agent_policy": 8127.246060154055, "adversary_policy": 4854.697462263826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17746.686622516496, 17437.308151148034, 20515.516527031068, 21184.811593799994, 15108.638990029045, 16859.793769246997, 4835.589753645947, 22325.903939367843, 21695.314994393135, 20604.518184867757, 18817.584853218137, 18939.667010141962, 17688.895719317945, 19658.64781539894, 18634.685301337828, 93.9670237931044, 17015.345895123617, 15381.835512753225, 17022.337780305428, 16268.964407731124, 24630.149791178148, 16201.428676469835, 19808.198250267727, 17794.543088147977, 20394.338689355147, 17725.682892454464, 16320.254124551157, 18407.876334958935, 21949.073732704408, 17747.620068485558, 21574.87020375225, 14813.16785370575, 17052.025646317394, 18704.063500646193, 17437.480975377526, 17470.302886351117, 21953.525415468885, 17935.519363239455, 21710.331735303156, 21526.979925828356, 17484.62118209787, 18985.298130659365, 17566.795863469044, 19737.43875721782, 20837.721933942215, 23320.76452892067, 21745.662086924, 19234.47781478162, 18728.81087282314, 17992.246318792888, 16578.36529122497, 15758.26477470047, 15074.60135860327, 18812.204179577526, 22090.592299972355, 5716.956769296549, 17313.614735905216, 17959.30426310582, 19532.301574848403, 17691.65678985514, 18465.885863790452, 20238.459914877658, 16372.200878675816, 16064.540465138729, 18693.972652535995, 18302.379290225188, 17420.08754818734, 17938.371989372077, 16125.09977818219, 20969.20827115612, 17945.169671177864, 19704.162402624977, 19941.445177068803, 19283.91029504323, 21787.253301838384, 18830.580891473, 18260.287473146986, 19018.53762596925, 18408.507801857828, 17374.13867679291, 20343.03780653814, 17547.506181380388, 18253.61430018673, 19603.920317316468, 20321.834500406156, 16519.00598961143, 2039.6996683559582, 20781.511161768583, 15808.886226115483, 17857.40008727041, 20215.866966524583, 17371.177176544905, 1475.662653334645, 21709.453651749307, 16040.779716262654, 15472.421513737641, 16150.748879216626, 18305.88656019258, 18141.85247119176, 17404.486144882463], "episode_lengths": [200, 200, 200, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9183.844353384231, 10374.613361563823, 6103.91761802073, 6278.4327137354585, 10251.422336185868, 10817.503015787008, 514.0241608905325, 5770.617819492649, 5977.790116408287, 7265.7732857673755, 8758.541411274146, 6449.571102291531, 10130.628639385865, 8394.052409504113, 8211.339967728407, 0.802993359085007, 10769.46879316992, 10466.78820457984, 10495.058108562407, 11033.779325823034, 3260.2368691100633, 10637.386287531956, 7557.904451068665, 9671.258628966307, 6732.057698452033, 9827.236121564034, 10398.569730909388, 8716.841249253992, 4456.174549686016, 10241.644920953071, 6039.7053592527145, 12803.15258317007, 11115.167237937128, 8566.50318573112, 9867.822948270126, 8631.583168787614, 5901.993996006585, 8256.659962767884, 5093.838380376005, 5965.404203352222, 10286.556644249578, 8419.111979374622, 8434.521804966522, 8284.739594039935, 6158.808782908835, 4012.241891908228, 4478.200621158847, 7904.498611141798, 6590.859847376557, 9019.049190763328, 10159.919850495708, 11624.82096111563, 12140.55365034865, 6716.985015118107, 5097.747475947706, 1233.5857442001407, 10082.957599852407, 10165.303467513817, 7533.5233648188305, 9637.860470553893, 9226.782994727984, 5853.647324103448, 10997.465705816254, 11947.91867356098, 9318.335497220072, 8302.36930041442, 9611.11991083032, 9447.911053921078, 9211.708655267634, 6754.228117732459, 8519.390068248922, 8330.734389498437, 7483.560121134244, 8806.94895338922, 5733.9330456464595, 8299.51020635244, 9169.815455132968, 8675.670163664458, 9139.600541848053, 7499.443552479819, 7061.29109696086, 10281.484485444336, 9475.441235151195, 7839.759798990558, 6886.340363933322, 11033.733298672907, 138.5228820112221, 5816.612304267864, 11907.3223446825, 7412.59349489568, 6871.688644021917, 10504.492735391867, 84.20590308297595, 5456.008016403695, 10807.018021726948, 9698.409620794437, 10885.283756486235, 9357.667301637139, 9886.72214390836, 10018.956998037414], "policy_adversary_policy_reward": [3766.980412289701, 4795.861856842545, 3312.7648657424916, 3749.92992384169, 6720.410953854136, 7691.187955156197, 7350.411234618271, 7555.967645446198, 982.3210322995487, 3874.8956215436333, 3237.063030400759, 2805.2277230591694, 1795.0305945437901, 2526.5349982116218, 8292.482538729, 8262.803581146218, 8148.859523059577, 7568.665354925146, 6832.258751241621, 6506.486147858781, 4705.01016737676, 5354.033274567267, 5466.099882687133, 7023.996025163307, 3986.157366914282, 3572.1097130177614, 5665.559680739669, 5599.035725155194, 4519.954843171836, 5903.390490437509, 69.90768475956975, 23.256345674449648, 3069.971484991548, 3175.905616962087, 1251.3112335151332, 3663.736074658251, 3634.9765436044695, 2892.3031281385274, 3046.4995704191224, 2188.685511488951, 10816.964533561631, 10552.94838850643, 2062.9625037635733, 3501.0798851743584, 5973.331296229274, 6276.962502969804, 3672.2975887071616, 4450.986870474476, 6677.122343402234, 6985.158647500857, 3942.0319746039577, 3956.4147962864386, 2879.197448254849, 3042.4869453869283, 5381.2033440120595, 4309.831741692901, 9598.146322452007, 7894.752860566388, 3884.197519466315, 3621.777628066147, 8055.592115860573, 7479.572728638968, 683.8396884721323, 1326.1755820635665, 2957.7283753174534, 2979.1300330627746, 5560.7961718739725, 4576.764143041106, 4268.945853042178, 3300.7121740652433, 5492.134314189585, 3346.585403373954, 7837.846867821985, 8213.684551640275, 5871.478368592761, 3807.3810318788105, 8136.636203070357, 8479.857151856782, 7397.9521295977465, 8163.623592878426, 3575.9543673658354, 3622.110170482455, 4861.312254190307, 5704.8738970944805, 3773.1806293389054, 5359.093429163604, 5838.577510284922, 5614.12165289294, 6817.2429214919675, 7861.670229541448, 10024.792545301243, 9283.730091711172, 8168.54195179117, 9098.919513973953, 5245.286221486921, 6084.692982152963, 4595.58692914665, 7542.3640962998825, 3857.956349130631, 5115.240778898932, 2446.005215168212, 3972.440225561047, 2364.39973203353, 1769.0440815513298, 957.7676655119261, 1976.2800427426841, 7417.379479898644, 4677.83968456077, 8774.890050757644, 8217.954773267018, 1977.201889423495, 2506.169135672914, 3198.3403751984515, 4032.3167608543868, 3841.0834138742716, 3952.9173817177125, 5406.379297386304, 6592.398912643243, 3552.438534360274, 4501.357784940965, 4336.332510393521, 4902.77035866895, 7973.4181223428395, 6411.39446843129, 3138.9792039785652, 2235.7559688810184, 2174.297876073151, 1942.3239155046172, 4806.180236666806, 4569.456918649145, 5839.7663233165285, 4160.243666494205, 3303.570342341805, 4505.397295015228, 3802.760174788355, 4687.700760662639, 4930.426968463324, 1982.964154451261, 6919.182546795841, 7295.797606627755, 3806.9670957840885, 5618.8125071448285, 5687.166129040641, 5686.2618840859195, 6490.4550732170865, 5967.429982717492, 5165.516888609458, 5311.44445304453, 8169.842987121302, 7883.477269070663, 5823.51979227497, 4707.550892845601, 4963.5732793859415, 4126.89873862803, 4890.388913382417, 5452.478548922395, 4780.849217482436, 4488.058042527348, 3237.3132424357923, 6637.3818818773025, 6876.599229631476, 6405.147479945828, 3475.867865576856, 3790.15383035922, 4655.01909698048, 4123.153968055103, 5520.279541451969, 6243.880976873931, 6206.66168992438, 7228.832446548431, 2394.9672962934296, 3090.3053946451414, 1204.9800022432185, 696.1967841015185, 6910.917543448596, 8053.981314052096, 2209.39044959295, 1692.1734318400515, 6729.206184740734, 3715.6004076339955, 7270.404140214546, 6073.774182288115, 3620.2985545987635, 3246.385886554292, 835.0329124595359, 556.423837792133, 7578.0024307155945, 8675.443204630037, 3332.267924602481, 1901.493769933218, 4443.726002936504, 1330.2858900066844, 2657.1941456543286, 2608.270977076058, 4743.7162753497905, 4204.502983205676, 4024.803019644592, 4230.327307638774, 4114.910259993244, 3270.6188868518334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39730791239266444, "mean_inference_ms": 0.9844883162699586, "mean_action_processing_ms": 0.16636168734108606, "mean_env_wait_ms": 0.05371914348253773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033932924270629883, "StateBufferConnector_ms": 0.002548813819885254, "ViewRequirementAgentConnector_ms": 0.0636301040649414}, "num_episodes": 21, "episode_return_max": 24630.149791178148, "episode_return_min": 93.9670237931044, "episode_return_mean": 17836.64098468171}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.9543816943956, "num_env_steps_trained_throughput_per_sec": 543.9543816943956, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 7494.353, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7494.317, "sample_time_ms": 734.964, "learn_time_ms": 6748.129, "learn_throughput": 592.757, "synch_weights_time_ms": 10.743}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "training_iteration": 39, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-25", "timestamp": 1723235665, "time_this_iter_s": 7.358522176742554, "time_total_s": 296.47097730636597, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206b7e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.47097730636597, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 26.869999999999997, "ram_util_percent": 81.50999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7408824535648502, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00885394363807, "policy_loss": 0.005087663656687019, "vf_loss": 9.996166375074438, "vf_explained_var": 2.381290708269392e-05, "kl": 0.0059307275083724156, "entropy": 0.9548723110130855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8392004339334865, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988222666581471, "policy_loss": -0.007606650452847437, "vf_loss": 9.986028649409612, "vf_explained_var": -2.7346300582091012e-05, "kl": 0.019359316827224877, "entropy": 1.513461769123872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 23320.76452892067, "episode_reward_min": 1475.662653334645, "episode_reward_mean": 17975.30154975949, "episode_len_mean": 191.29, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19129, "policy_reward_min": {"agent_policy": 84.20590308297595, "adversary_policy": 549.4674049997262}, "policy_reward_max": {"agent_policy": 12803.15258317007, "adversary_policy": 10024.792545301243}, "policy_reward_mean": {"agent_policy": 7846.6348852941055, "adversary_policy": 5064.3333322326935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19808.198250267727, 17794.543088147977, 20394.338689355147, 17725.682892454464, 16320.254124551157, 18407.876334958935, 21949.073732704408, 17747.620068485558, 21574.87020375225, 14813.16785370575, 17052.025646317394, 18704.063500646193, 17437.480975377526, 17470.302886351117, 21953.525415468885, 17935.519363239455, 21710.331735303156, 21526.979925828356, 17484.62118209787, 18985.298130659365, 17566.795863469044, 19737.43875721782, 20837.721933942215, 23320.76452892067, 21745.662086924, 19234.47781478162, 18728.81087282314, 17992.246318792888, 16578.36529122497, 15758.26477470047, 15074.60135860327, 18812.204179577526, 22090.592299972355, 5716.956769296549, 17313.614735905216, 17959.30426310582, 19532.301574848403, 17691.65678985514, 18465.885863790452, 20238.459914877658, 16372.200878675816, 16064.540465138729, 18693.972652535995, 18302.379290225188, 17420.08754818734, 17938.371989372077, 16125.09977818219, 20969.20827115612, 17945.169671177864, 19704.162402624977, 19941.445177068803, 19283.91029504323, 21787.253301838384, 18830.580891473, 18260.287473146986, 19018.53762596925, 18408.507801857828, 17374.13867679291, 20343.03780653814, 17547.506181380388, 18253.61430018673, 19603.920317316468, 20321.834500406156, 16519.00598961143, 2039.6996683559582, 20781.511161768583, 15808.886226115483, 17857.40008727041, 20215.866966524583, 17371.177176544905, 1475.662653334645, 21709.453651749307, 16040.779716262654, 15472.421513737641, 16150.748879216626, 18305.88656019258, 18141.85247119176, 17404.486144882463, 15095.362099483043, 21626.607447798226, 2655.5866222240547, 20780.30894352092, 20483.40518035174, 19756.206041281406, 1963.680967372821, 18166.24491356183, 20743.99616471921, 20000.50054116039, 20155.350097286188, 18135.299874089906, 19793.5232883525, 18511.309507460795, 21152.68249661168, 22772.326442361813, 19590.39182785027, 19167.157539068627, 17707.583397456772, 18473.23063426484, 18168.37438361127, 17634.520410705183], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7557.904451068665, 9671.258628966307, 6732.057698452033, 9827.236121564034, 10398.569730909388, 8716.841249253992, 4456.174549686016, 10241.644920953071, 6039.7053592527145, 12803.15258317007, 11115.167237937128, 8566.50318573112, 9867.822948270126, 8631.583168787614, 5901.993996006585, 8256.659962767884, 5093.838380376005, 5965.404203352222, 10286.556644249578, 8419.111979374622, 8434.521804966522, 8284.739594039935, 6158.808782908835, 4012.241891908228, 4478.200621158847, 7904.498611141798, 6590.859847376557, 9019.049190763328, 10159.919850495708, 11624.82096111563, 12140.55365034865, 6716.985015118107, 5097.747475947706, 1233.5857442001407, 10082.957599852407, 10165.303467513817, 7533.5233648188305, 9637.860470553893, 9226.782994727984, 5853.647324103448, 10997.465705816254, 11947.91867356098, 9318.335497220072, 8302.36930041442, 9611.11991083032, 9447.911053921078, 9211.708655267634, 6754.228117732459, 8519.390068248922, 8330.734389498437, 7483.560121134244, 8806.94895338922, 5733.9330456464595, 8299.51020635244, 9169.815455132968, 8675.670163664458, 9139.600541848053, 7499.443552479819, 7061.29109696086, 10281.484485444336, 9475.441235151195, 7839.759798990558, 6886.340363933322, 11033.733298672907, 138.5228820112221, 5816.612304267864, 11907.3223446825, 7412.59349489568, 6871.688644021917, 10504.492735391867, 84.20590308297595, 5456.008016403695, 10807.018021726948, 9698.409620794437, 10885.283756486235, 9357.667301637139, 9886.72214390836, 10018.956998037414, 10111.009085790729, 4269.612279849001, 187.5408005328122, 6867.307757406716, 7058.191306213498, 7909.567321124557, 97.27232153507936, 6400.447559975898, 4919.482669710124, 7672.603581422346, 5944.3948961910855, 10031.583370270557, 6800.053509711804, 5870.670344965821, 3884.864946555992, 5161.474539503615, 7651.1116138580555, 8161.030405327981, 9458.052618802938, 8886.874810584157, 5721.573132621662, 10019.756535606823], "policy_adversary_policy_reward": [5973.331296229274, 6276.962502969804, 3672.2975887071616, 4450.986870474476, 6677.122343402234, 6985.158647500857, 3942.0319746039577, 3956.4147962864386, 2879.197448254849, 3042.4869453869283, 5381.2033440120595, 4309.831741692901, 9598.146322452007, 7894.752860566388, 3884.197519466315, 3621.777628066147, 8055.592115860573, 7479.572728638968, 683.8396884721323, 1326.1755820635665, 2957.7283753174534, 2979.1300330627746, 5560.7961718739725, 4576.764143041106, 4268.945853042178, 3300.7121740652433, 5492.134314189585, 3346.585403373954, 7837.846867821985, 8213.684551640275, 5871.478368592761, 3807.3810318788105, 8136.636203070357, 8479.857151856782, 7397.9521295977465, 8163.623592878426, 3575.9543673658354, 3622.110170482455, 4861.312254190307, 5704.8738970944805, 3773.1806293389054, 5359.093429163604, 5838.577510284922, 5614.12165289294, 6817.2429214919675, 7861.670229541448, 10024.792545301243, 9283.730091711172, 8168.54195179117, 9098.919513973953, 5245.286221486921, 6084.692982152963, 4595.58692914665, 7542.3640962998825, 3857.956349130631, 5115.240778898932, 2446.005215168212, 3972.440225561047, 2364.39973203353, 1769.0440815513298, 957.7676655119261, 1976.2800427426841, 7417.379479898644, 4677.83968456077, 8774.890050757644, 8217.954773267018, 1977.201889423495, 2506.169135672914, 3198.3403751984515, 4032.3167608543868, 3841.0834138742716, 3952.9173817177125, 5406.379297386304, 6592.398912643243, 3552.438534360274, 4501.357784940965, 4336.332510393521, 4902.77035866895, 7973.4181223428395, 6411.39446843129, 3138.9792039785652, 2235.7559688810184, 2174.297876073151, 1942.3239155046172, 4806.180236666806, 4569.456918649145, 5839.7663233165285, 4160.243666494205, 3303.570342341805, 4505.397295015228, 3802.760174788355, 4687.700760662639, 4930.426968463324, 1982.964154451261, 6919.182546795841, 7295.797606627755, 3806.9670957840885, 5618.8125071448285, 5687.166129040641, 5686.2618840859195, 6490.4550732170865, 5967.429982717492, 5165.516888609458, 5311.44445304453, 8169.842987121302, 7883.477269070663, 5823.51979227497, 4707.550892845601, 4963.5732793859415, 4126.89873862803, 4890.388913382417, 5452.478548922395, 4780.849217482436, 4488.058042527348, 3237.3132424357923, 6637.3818818773025, 6876.599229631476, 6405.147479945828, 3475.867865576856, 3790.15383035922, 4655.01909698048, 4123.153968055103, 5520.279541451969, 6243.880976873931, 6206.66168992438, 7228.832446548431, 2394.9672962934296, 3090.3053946451414, 1204.9800022432185, 696.1967841015185, 6910.917543448596, 8053.981314052096, 2209.39044959295, 1692.1734318400515, 6729.206184740734, 3715.6004076339955, 7270.404140214546, 6073.774182288115, 3620.2985545987635, 3246.385886554292, 835.0329124595359, 556.423837792133, 7578.0024307155945, 8675.443204630037, 3332.267924602481, 1901.493769933218, 4443.726002936504, 1330.2858900066844, 2657.1941456543286, 2608.270977076058, 4743.7162753497905, 4204.502983205676, 4024.803019644592, 4230.327307638774, 4114.910259993244, 3270.6188868518334, 4027.7617821512954, 956.5912315410309, 9003.865030628212, 8353.130137320983, 958.5303473763413, 1509.5154743149021, 6832.267106358243, 7080.734079755978, 6350.01163964229, 7075.202234495963, 6152.838819496753, 5693.7999006601, 1316.9412408380156, 549.4674049997262, 7741.6880637550585, 4024.109289830876, 6980.605018530476, 8843.908476478557, 5860.175709271293, 6467.721250466812, 7990.063106334581, 6220.8920947605175, 4010.261656854659, 4093.454846964749, 5673.388917877131, 7320.08086076356, 4369.173883729869, 8271.465278765132, 9698.080597032016, 7569.736953023674, 8649.09664948433, 8961.755253373854, 6483.534575110851, 5455.745638881345, 5801.116978125428, 5205.010155615195, 3581.535825095274, 4667.994953558545, 4336.721305059993, 5249.634518620712, 4026.238759880326, 8420.562491109296, 3551.9982308385315, 4062.7656442598363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39690446743142466, "mean_inference_ms": 0.9829568317817483, "mean_action_processing_ms": 0.16622854354879749, "mean_env_wait_ms": 0.053581261308129645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003270864486694336, "StateBufferConnector_ms": 0.002546072006225586, "ViewRequirementAgentConnector_ms": 0.06390619277954102}, "num_episodes": 22, "episode_return_max": 23320.76452892067, "episode_return_min": 1475.662653334645, "episode_return_mean": 17975.30154975949}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.8064998378048, "num_env_steps_trained_throughput_per_sec": 546.8064998378048, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 7466.584, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7466.549, "sample_time_ms": 741.531, "learn_time_ms": 6714.05, "learn_throughput": 595.766, "synch_weights_time_ms": 10.447}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 40, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-33", "timestamp": 1723235673, "time_this_iter_s": 7.319067001342773, "time_total_s": 303.79004430770874, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 303.79004430770874, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.4, "ram_util_percent": 81.32727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8099322726486852, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.93725214862319, "policy_loss": 0.007800784780860696, "vf_loss": 9.922644970908998, "vf_explained_var": -4.0997903813760745e-09, "kl": 0.0053115066544956, "entropy": 0.971377341015629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7994427635023992, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00420658191045, "policy_loss": 0.0013303661335764142, "vf_loss": 9.993825550874075, "vf_explained_var": 4.250059525171915e-06, "kl": 0.017877857537920743, "entropy": 1.521930580213666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "env_runners": {"episode_reward_max": 23320.76452892067, "episode_reward_min": 1261.3914768931559, "episode_reward_mean": 17837.396727546507, "episode_len_mean": 189.41, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18941, "policy_reward_min": {"agent_policy": 56.77881412018424, "adversary_policy": 412.8633394692989}, "policy_reward_max": {"agent_policy": 12140.55365034865, "adversary_policy": 10024.792545301243}, "policy_reward_mean": {"agent_policy": 7681.436063550018, "adversary_policy": 5077.980331998247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17566.795863469044, 19737.43875721782, 20837.721933942215, 23320.76452892067, 21745.662086924, 19234.47781478162, 18728.81087282314, 17992.246318792888, 16578.36529122497, 15758.26477470047, 15074.60135860327, 18812.204179577526, 22090.592299972355, 5716.956769296549, 17313.614735905216, 17959.30426310582, 19532.301574848403, 17691.65678985514, 18465.885863790452, 20238.459914877658, 16372.200878675816, 16064.540465138729, 18693.972652535995, 18302.379290225188, 17420.08754818734, 17938.371989372077, 16125.09977818219, 20969.20827115612, 17945.169671177864, 19704.162402624977, 19941.445177068803, 19283.91029504323, 21787.253301838384, 18830.580891473, 18260.287473146986, 19018.53762596925, 18408.507801857828, 17374.13867679291, 20343.03780653814, 17547.506181380388, 18253.61430018673, 19603.920317316468, 20321.834500406156, 16519.00598961143, 2039.6996683559582, 20781.511161768583, 15808.886226115483, 17857.40008727041, 20215.866966524583, 17371.177176544905, 1475.662653334645, 21709.453651749307, 16040.779716262654, 15472.421513737641, 16150.748879216626, 18305.88656019258, 18141.85247119176, 17404.486144882463, 15095.362099483043, 21626.607447798226, 2655.5866222240547, 20780.30894352092, 20483.40518035174, 19756.206041281406, 1963.680967372821, 18166.24491356183, 20743.99616471921, 20000.50054116039, 20155.350097286188, 18135.299874089906, 19793.5232883525, 18511.309507460795, 21152.68249661168, 22772.326442361813, 19590.39182785027, 19167.157539068627, 17707.583397456772, 18473.23063426484, 18168.37438361127, 17634.520410705183, 17560.90411363492, 18804.97258395003, 1261.3914768931559, 18808.143478196183, 19614.9501067965, 20593.04171884856, 16662.262149734037, 20405.675779301328, 21010.129768121238, 19291.409992459598, 18084.127516184017, 17895.009402353415, 21152.466568613105, 17061.581928698408, 21843.742346297247, 18327.39236941135, 18480.43349115201, 15817.45432282884, 20333.504177538052, 19996.698487362482], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8434.521804966522, 8284.739594039935, 6158.808782908835, 4012.241891908228, 4478.200621158847, 7904.498611141798, 6590.859847376557, 9019.049190763328, 10159.919850495708, 11624.82096111563, 12140.55365034865, 6716.985015118107, 5097.747475947706, 1233.5857442001407, 10082.957599852407, 10165.303467513817, 7533.5233648188305, 9637.860470553893, 9226.782994727984, 5853.647324103448, 10997.465705816254, 11947.91867356098, 9318.335497220072, 8302.36930041442, 9611.11991083032, 9447.911053921078, 9211.708655267634, 6754.228117732459, 8519.390068248922, 8330.734389498437, 7483.560121134244, 8806.94895338922, 5733.9330456464595, 8299.51020635244, 9169.815455132968, 8675.670163664458, 9139.600541848053, 7499.443552479819, 7061.29109696086, 10281.484485444336, 9475.441235151195, 7839.759798990558, 6886.340363933322, 11033.733298672907, 138.5228820112221, 5816.612304267864, 11907.3223446825, 7412.59349489568, 6871.688644021917, 10504.492735391867, 84.20590308297595, 5456.008016403695, 10807.018021726948, 9698.409620794437, 10885.283756486235, 9357.667301637139, 9886.72214390836, 10018.956998037414, 10111.009085790729, 4269.612279849001, 187.5408005328122, 6867.307757406716, 7058.191306213498, 7909.567321124557, 97.27232153507936, 6400.447559975898, 4919.482669710124, 7672.603581422346, 5944.3948961910855, 10031.583370270557, 6800.053509711804, 5870.670344965821, 3884.864946555992, 5161.474539503615, 7651.1116138580555, 8161.030405327981, 9458.052618802938, 8886.874810584157, 5721.573132621662, 10019.756535606823, 10501.737290077353, 6568.901996525674, 56.77881412018424, 8139.731608393445, 7253.951576272415, 7064.283506904194, 11139.643292428587, 6056.266506078991, 6384.079531835839, 7076.862962054845, 7051.627284285241, 9646.951265564694, 6695.08273546218, 9373.417865001808, 5436.7936478333795, 9761.202850189478, 9106.630876869014, 10241.750832854852, 6581.806186711503, 7891.804196256878], "policy_adversary_policy_reward": [3773.1806293389054, 5359.093429163604, 5838.577510284922, 5614.12165289294, 6817.2429214919675, 7861.670229541448, 10024.792545301243, 9283.730091711172, 8168.54195179117, 9098.919513973953, 5245.286221486921, 6084.692982152963, 4595.58692914665, 7542.3640962998825, 3857.956349130631, 5115.240778898932, 2446.005215168212, 3972.440225561047, 2364.39973203353, 1769.0440815513298, 957.7676655119261, 1976.2800427426841, 7417.379479898644, 4677.83968456077, 8774.890050757644, 8217.954773267018, 1977.201889423495, 2506.169135672914, 3198.3403751984515, 4032.3167608543868, 3841.0834138742716, 3952.9173817177125, 5406.379297386304, 6592.398912643243, 3552.438534360274, 4501.357784940965, 4336.332510393521, 4902.77035866895, 7973.4181223428395, 6411.39446843129, 3138.9792039785652, 2235.7559688810184, 2174.297876073151, 1942.3239155046172, 4806.180236666806, 4569.456918649145, 5839.7663233165285, 4160.243666494205, 3303.570342341805, 4505.397295015228, 3802.760174788355, 4687.700760662639, 4930.426968463324, 1982.964154451261, 6919.182546795841, 7295.797606627755, 3806.9670957840885, 5618.8125071448285, 5687.166129040641, 5686.2618840859195, 6490.4550732170865, 5967.429982717492, 5165.516888609458, 5311.44445304453, 8169.842987121302, 7883.477269070663, 5823.51979227497, 4707.550892845601, 4963.5732793859415, 4126.89873862803, 4890.388913382417, 5452.478548922395, 4780.849217482436, 4488.058042527348, 3237.3132424357923, 6637.3818818773025, 6876.599229631476, 6405.147479945828, 3475.867865576856, 3790.15383035922, 4655.01909698048, 4123.153968055103, 5520.279541451969, 6243.880976873931, 6206.66168992438, 7228.832446548431, 2394.9672962934296, 3090.3053946451414, 1204.9800022432185, 696.1967841015185, 6910.917543448596, 8053.981314052096, 2209.39044959295, 1692.1734318400515, 6729.206184740734, 3715.6004076339955, 7270.404140214546, 6073.774182288115, 3620.2985545987635, 3246.385886554292, 835.0329124595359, 556.423837792133, 7578.0024307155945, 8675.443204630037, 3332.267924602481, 1901.493769933218, 4443.726002936504, 1330.2858900066844, 2657.1941456543286, 2608.270977076058, 4743.7162753497905, 4204.502983205676, 4024.803019644592, 4230.327307638774, 4114.910259993244, 3270.6188868518334, 4027.7617821512954, 956.5912315410309, 9003.865030628212, 8353.130137320983, 958.5303473763413, 1509.5154743149021, 6832.267106358243, 7080.734079755978, 6350.01163964229, 7075.202234495963, 6152.838819496753, 5693.7999006601, 1316.9412408380156, 549.4674049997262, 7741.6880637550585, 4024.109289830876, 6980.605018530476, 8843.908476478557, 5860.175709271293, 6467.721250466812, 7990.063106334581, 6220.8920947605175, 4010.261656854659, 4093.454846964749, 5673.388917877131, 7320.08086076356, 4369.173883729869, 8271.465278765132, 9698.080597032016, 7569.736953023674, 8649.09664948433, 8961.755253373854, 6483.534575110851, 5455.745638881345, 5801.116978125428, 5205.010155615195, 3581.535825095274, 4667.994953558545, 4336.721305059993, 5249.634518620712, 4026.238759880326, 8420.562491109296, 3551.9982308385315, 4062.7656442598363, 3612.538093816792, 3446.628729740764, 4662.836960219131, 7573.233627205279, 791.7493233036729, 412.8633394692989, 4666.977788753123, 6001.43408104956, 5474.712347780262, 6886.286182743798, 6792.234851504508, 6736.523360439802, 2993.7408662206517, 2528.8779910848452, 7386.287122648006, 6963.122150574347, 7749.678073149791, 6876.3721631356475, 5211.573665658723, 7002.973364746011, 7090.508339445708, 3941.991892453058, 3754.261553359458, 4493.796583429247, 7214.819170141842, 7242.564663009033, 2934.222650095184, 4753.941413601465, 8689.080653091465, 7717.868045372356, 4198.381511533755, 4367.808007688062, 4342.315041450514, 5031.48757283262, 3886.8538074023545, 1688.8496825716688, 7096.864306574416, 6654.833684252114, 6042.5510481956535, 6062.343242909982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39650505436937566, "mean_inference_ms": 0.9819871168793881, "mean_action_processing_ms": 0.16613396440790004, "mean_env_wait_ms": 0.05352483846826935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031876564025878906, "StateBufferConnector_ms": 0.0023936033248901367, "ViewRequirementAgentConnector_ms": 0.06457352638244629}, "num_episodes": 20, "episode_return_max": 23320.76452892067, "episode_return_min": 1261.3914768931559, "episode_return_mean": 17837.396727546507}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.3761091411719, "num_env_steps_trained_throughput_per_sec": 545.3761091411719, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 7435.716, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7435.681, "sample_time_ms": 740.174, "learn_time_ms": 6684.545, "learn_throughput": 598.395, "synch_weights_time_ms": 10.442}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "training_iteration": 41, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-40", "timestamp": 1723235680, "time_this_iter_s": 7.339506149291992, "time_total_s": 311.12955045700073, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.12955045700073, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.29090909090909, "ram_util_percent": 81.36363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8104220803294863, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.956560826175428, "policy_loss": 0.005665583081885916, "vf_loss": 9.938293982813597, "vf_explained_var": 5.1770576093562695e-06, "kl": 0.009833615351093825, "entropy": 1.0257756936802436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7853108697260419, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996120203534762, "policy_loss": -0.005148221437169317, "vf_loss": 9.995640290776889, "vf_explained_var": 2.4717425306638083e-05, "kl": 0.011117323658739527, "entropy": 1.4961288484434287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 22772.326442361813, "episode_reward_min": 232.75174379542455, "episode_reward_mean": 17689.797499688422, "episode_len_mean": 188.9, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18890, "policy_reward_min": {"agent_policy": 2.791869579048245, "adversary_policy": 91.330387558115}, "policy_reward_max": {"agent_policy": 12062.815104476158, "adversary_policy": 9698.080597032016}, "policy_reward_mean": {"agent_policy": 7697.506441719481, "adversary_policy": 4996.145528984473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18302.379290225188, 17420.08754818734, 17938.371989372077, 16125.09977818219, 20969.20827115612, 17945.169671177864, 19704.162402624977, 19941.445177068803, 19283.91029504323, 21787.253301838384, 18830.580891473, 18260.287473146986, 19018.53762596925, 18408.507801857828, 17374.13867679291, 20343.03780653814, 17547.506181380388, 18253.61430018673, 19603.920317316468, 20321.834500406156, 16519.00598961143, 2039.6996683559582, 20781.511161768583, 15808.886226115483, 17857.40008727041, 20215.866966524583, 17371.177176544905, 1475.662653334645, 21709.453651749307, 16040.779716262654, 15472.421513737641, 16150.748879216626, 18305.88656019258, 18141.85247119176, 17404.486144882463, 15095.362099483043, 21626.607447798226, 2655.5866222240547, 20780.30894352092, 20483.40518035174, 19756.206041281406, 1963.680967372821, 18166.24491356183, 20743.99616471921, 20000.50054116039, 20155.350097286188, 18135.299874089906, 19793.5232883525, 18511.309507460795, 21152.68249661168, 22772.326442361813, 19590.39182785027, 19167.157539068627, 17707.583397456772, 18473.23063426484, 18168.37438361127, 17634.520410705183, 17560.90411363492, 18804.97258395003, 1261.3914768931559, 18808.143478196183, 19614.9501067965, 20593.04171884856, 16662.262149734037, 20405.675779301328, 21010.129768121238, 19291.409992459598, 18084.127516184017, 17895.009402353415, 21152.466568613105, 17061.581928698408, 21843.742346297247, 18327.39236941135, 18480.43349115201, 15817.45432282884, 20333.504177538052, 19996.698487362482, 20433.551774962245, 18930.164388408997, 19477.83189835769, 17165.31468435661, 15328.828183226808, 15360.663694242905, 18415.259429819835, 16476.494365139715, 18656.827731126607, 19751.835968435582, 18875.844557119242, 16848.085680480057, 21700.89158500563, 18430.02732799911, 232.75174379542455, 18421.233851952085, 19394.833022753533, 15188.26930395847, 16371.98494984834, 15183.228022602458, 20331.066305431134, 19648.97103399207, 20142.957700157007], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8302.36930041442, 9611.11991083032, 9447.911053921078, 9211.708655267634, 6754.228117732459, 8519.390068248922, 8330.734389498437, 7483.560121134244, 8806.94895338922, 5733.9330456464595, 8299.51020635244, 9169.815455132968, 8675.670163664458, 9139.600541848053, 7499.443552479819, 7061.29109696086, 10281.484485444336, 9475.441235151195, 7839.759798990558, 6886.340363933322, 11033.733298672907, 138.5228820112221, 5816.612304267864, 11907.3223446825, 7412.59349489568, 6871.688644021917, 10504.492735391867, 84.20590308297595, 5456.008016403695, 10807.018021726948, 9698.409620794437, 10885.283756486235, 9357.667301637139, 9886.72214390836, 10018.956998037414, 10111.009085790729, 4269.612279849001, 187.5408005328122, 6867.307757406716, 7058.191306213498, 7909.567321124557, 97.27232153507936, 6400.447559975898, 4919.482669710124, 7672.603581422346, 5944.3948961910855, 10031.583370270557, 6800.053509711804, 5870.670344965821, 3884.864946555992, 5161.474539503615, 7651.1116138580555, 8161.030405327981, 9458.052618802938, 8886.874810584157, 5721.573132621662, 10019.756535606823, 10501.737290077353, 6568.901996525674, 56.77881412018424, 8139.731608393445, 7253.951576272415, 7064.283506904194, 11139.643292428587, 6056.266506078991, 6384.079531835839, 7076.862962054845, 7051.627284285241, 9646.951265564694, 6695.08273546218, 9373.417865001808, 5436.7936478333795, 9761.202850189478, 9106.630876869014, 10241.750832854852, 6581.806186711503, 7891.804196256878, 6885.209831584248, 8303.758079366095, 7904.478597385898, 9927.7844284074, 10559.527848842226, 10444.746191293561, 6316.137215092446, 10334.188870765638, 8756.876227532379, 7209.984399572682, 6122.6209707579, 11018.902986314031, 6029.634429227321, 8870.826239472362, 2.791869579048245, 8558.591975803214, 8456.331148781874, 12062.815104476158, 10798.243537094622, 11898.29826060255, 5682.659252465187, 5260.697327517547, 6822.261164669584], "policy_adversary_policy_reward": [5839.7663233165285, 4160.243666494205, 3303.570342341805, 4505.397295015228, 3802.760174788355, 4687.700760662639, 4930.426968463324, 1982.964154451261, 6919.182546795841, 7295.797606627755, 3806.9670957840885, 5618.8125071448285, 5687.166129040641, 5686.2618840859195, 6490.4550732170865, 5967.429982717492, 5165.516888609458, 5311.44445304453, 8169.842987121302, 7883.477269070663, 5823.51979227497, 4707.550892845601, 4963.5732793859415, 4126.89873862803, 4890.388913382417, 5452.478548922395, 4780.849217482436, 4488.058042527348, 3237.3132424357923, 6637.3818818773025, 6876.599229631476, 6405.147479945828, 3475.867865576856, 3790.15383035922, 4655.01909698048, 4123.153968055103, 5520.279541451969, 6243.880976873931, 6206.66168992438, 7228.832446548431, 2394.9672962934296, 3090.3053946451414, 1204.9800022432185, 696.1967841015185, 6910.917543448596, 8053.981314052096, 2209.39044959295, 1692.1734318400515, 6729.206184740734, 3715.6004076339955, 7270.404140214546, 6073.774182288115, 3620.2985545987635, 3246.385886554292, 835.0329124595359, 556.423837792133, 7578.0024307155945, 8675.443204630037, 3332.267924602481, 1901.493769933218, 4443.726002936504, 1330.2858900066844, 2657.1941456543286, 2608.270977076058, 4743.7162753497905, 4204.502983205676, 4024.803019644592, 4230.327307638774, 4114.910259993244, 3270.6188868518334, 4027.7617821512954, 956.5912315410309, 9003.865030628212, 8353.130137320983, 958.5303473763413, 1509.5154743149021, 6832.267106358243, 7080.734079755978, 6350.01163964229, 7075.202234495963, 6152.838819496753, 5693.7999006601, 1316.9412408380156, 549.4674049997262, 7741.6880637550585, 4024.109289830876, 6980.605018530476, 8843.908476478557, 5860.175709271293, 6467.721250466812, 7990.063106334581, 6220.8920947605175, 4010.261656854659, 4093.454846964749, 5673.388917877131, 7320.08086076356, 4369.173883729869, 8271.465278765132, 9698.080597032016, 7569.736953023674, 8649.09664948433, 8961.755253373854, 6483.534575110851, 5455.745638881345, 5801.116978125428, 5205.010155615195, 3581.535825095274, 4667.994953558545, 4336.721305059993, 5249.634518620712, 4026.238759880326, 8420.562491109296, 3551.9982308385315, 4062.7656442598363, 3612.538093816792, 3446.628729740764, 4662.836960219131, 7573.233627205279, 791.7493233036729, 412.8633394692989, 4666.977788753123, 6001.43408104956, 5474.712347780262, 6886.286182743798, 6792.234851504508, 6736.523360439802, 2993.7408662206517, 2528.8779910848452, 7386.287122648006, 6963.122150574347, 7749.678073149791, 6876.3721631356475, 5211.573665658723, 7002.973364746011, 7090.508339445708, 3941.991892453058, 3754.261553359458, 4493.796583429247, 7214.819170141842, 7242.564663009033, 2934.222650095184, 4753.941413601465, 8689.080653091465, 7717.868045372356, 4198.381511533755, 4367.808007688062, 4342.315041450514, 5031.48757283262, 3886.8538074023545, 1688.8496825716688, 7096.864306574416, 6654.833684252114, 6042.5510481956535, 6062.343242909982, 6559.709061630178, 6988.632881747794, 5805.212406091464, 4821.193902951506, 6159.2512054265235, 5414.102095545279, 4202.642295710613, 3034.8879602386114, 3570.203838665409, 1199.0964957191786, 3696.7633698360455, 1219.1541331132673, 7823.992975352727, 4275.1292393747, 2997.327978221371, 3144.977516152733, 5344.78283390023, 4555.16866969396, 5708.9127981994225, 6832.938770663469, 4877.332165631941, 7875.891420729388, 3112.026012761328, 2717.1566814047046, 7887.985718492868, 7783.271437285346, 4424.5518705081895, 5134.649218018533, 91.330387558115, 138.62948665826127, 5579.75919844311, 4282.882677705792, 5288.034805952631, 5650.467068019006, 1074.518777792949, 2050.9354216893676, 3294.3388532223425, 2279.402559531365, 1046.4178853387307, 2238.5118766611336, 6670.994588423243, 7977.412464542669, 8881.43829621339, 5506.835410261113, 6128.646975591682, 7192.049559895788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39627609820023607, "mean_inference_ms": 0.9805288323879517, "mean_action_processing_ms": 0.16594252961708553, "mean_env_wait_ms": 0.05349064463287037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003206491470336914, "StateBufferConnector_ms": 0.002397298812866211, "ViewRequirementAgentConnector_ms": 0.06430721282958984}, "num_episodes": 23, "episode_return_max": 22772.326442361813, "episode_return_min": 232.75174379542455, "episode_return_mean": 17689.797499688422}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.1939258690104, "num_env_steps_trained_throughput_per_sec": 527.1939258690104, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 7445.25, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7445.211, "sample_time_ms": 735.801, "learn_time_ms": 6698.402, "learn_throughput": 597.157, "synch_weights_time_ms": 10.531}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 42, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-48", "timestamp": 1723235688, "time_this_iter_s": 7.592598915100098, "time_total_s": 318.72214937210083, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207279d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.72214937210083, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.763636363636365, "ram_util_percent": 81.50909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8467712254869559, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987016594094575, "policy_loss": 0.002466199997068437, "vf_loss": 9.971007068573483, "vf_explained_var": 1.4506950580253802e-08, "kl": 0.010568780207602435, "entropy": 1.0662941383306312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8059383758809417, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001229334870974, "policy_loss": -0.002706061160521737, "vf_loss": 10.0, "vf_explained_var": -1.112036406993866e-05, "kl": 0.0077736649618600495, "entropy": 1.4852878936876854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "env_runners": {"episode_reward_max": 22772.326442361813, "episode_reward_min": 232.75174379542455, "episode_reward_mean": 17611.9338588785, "episode_len_mean": 188.9, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18890, "policy_reward_min": {"agent_policy": 2.791869579048245, "adversary_policy": 91.330387558115}, "policy_reward_max": {"agent_policy": 12483.934749201775, "adversary_policy": 9698.080597032016}, "policy_reward_mean": {"agent_policy": 7833.233218375572, "adversary_policy": 4889.350320251464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16519.00598961143, 2039.6996683559582, 20781.511161768583, 15808.886226115483, 17857.40008727041, 20215.866966524583, 17371.177176544905, 1475.662653334645, 21709.453651749307, 16040.779716262654, 15472.421513737641, 16150.748879216626, 18305.88656019258, 18141.85247119176, 17404.486144882463, 15095.362099483043, 21626.607447798226, 2655.5866222240547, 20780.30894352092, 20483.40518035174, 19756.206041281406, 1963.680967372821, 18166.24491356183, 20743.99616471921, 20000.50054116039, 20155.350097286188, 18135.299874089906, 19793.5232883525, 18511.309507460795, 21152.68249661168, 22772.326442361813, 19590.39182785027, 19167.157539068627, 17707.583397456772, 18473.23063426484, 18168.37438361127, 17634.520410705183, 17560.90411363492, 18804.97258395003, 1261.3914768931559, 18808.143478196183, 19614.9501067965, 20593.04171884856, 16662.262149734037, 20405.675779301328, 21010.129768121238, 19291.409992459598, 18084.127516184017, 17895.009402353415, 21152.466568613105, 17061.581928698408, 21843.742346297247, 18327.39236941135, 18480.43349115201, 15817.45432282884, 20333.504177538052, 19996.698487362482, 20433.551774962245, 18930.164388408997, 19477.83189835769, 17165.31468435661, 15328.828183226808, 15360.663694242905, 18415.259429819835, 16476.494365139715, 18656.827731126607, 19751.835968435582, 18875.844557119242, 16848.085680480057, 21700.89158500563, 18430.02732799911, 232.75174379542455, 18421.233851952085, 19394.833022753533, 15188.26930395847, 16371.98494984834, 15183.228022602458, 20331.066305431134, 19648.97103399207, 20142.957700157007, 19266.881577015272, 18637.82566373728, 20367.59183305244, 20927.807488601775, 19169.17575639034, 18714.298987477876, 18151.468322857665, 18797.49988037192, 19145.743638143118, 19551.23669136101, 18947.088210021422, 17290.950587269526, 18030.058001624773, 15540.91235745254, 18893.045946726663, 15409.173110053871, 18155.134062014127, 17448.619454267406, 18555.335931130765, 18592.841719381668], "episode_lengths": [200, 19, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [11033.733298672907, 138.5228820112221, 5816.612304267864, 11907.3223446825, 7412.59349489568, 6871.688644021917, 10504.492735391867, 84.20590308297595, 5456.008016403695, 10807.018021726948, 9698.409620794437, 10885.283756486235, 9357.667301637139, 9886.72214390836, 10018.956998037414, 10111.009085790729, 4269.612279849001, 187.5408005328122, 6867.307757406716, 7058.191306213498, 7909.567321124557, 97.27232153507936, 6400.447559975898, 4919.482669710124, 7672.603581422346, 5944.3948961910855, 10031.583370270557, 6800.053509711804, 5870.670344965821, 3884.864946555992, 5161.474539503615, 7651.1116138580555, 8161.030405327981, 9458.052618802938, 8886.874810584157, 5721.573132621662, 10019.756535606823, 10501.737290077353, 6568.901996525674, 56.77881412018424, 8139.731608393445, 7253.951576272415, 7064.283506904194, 11139.643292428587, 6056.266506078991, 6384.079531835839, 7076.862962054845, 7051.627284285241, 9646.951265564694, 6695.08273546218, 9373.417865001808, 5436.7936478333795, 9761.202850189478, 9106.630876869014, 10241.750832854852, 6581.806186711503, 7891.804196256878, 6885.209831584248, 8303.758079366095, 7904.478597385898, 9927.7844284074, 10559.527848842226, 10444.746191293561, 6316.137215092446, 10334.188870765638, 8756.876227532379, 7209.984399572682, 6122.6209707579, 11018.902986314031, 6029.634429227321, 8870.826239472362, 2.791869579048245, 8558.591975803214, 8456.331148781874, 12062.815104476158, 10798.243537094622, 11898.29826060255, 5682.659252465187, 5260.697327517547, 6822.261164669584, 8245.48179075717, 8626.730387360996, 6296.943733032548, 7071.467464571509, 8254.297867174524, 9394.609744323554, 9510.416570190664, 8962.155096172979, 7555.012248580045, 7617.569882304961, 8274.614509910907, 10639.629545087919, 9883.981478989133, 12396.44148220212, 8605.149983266732, 12483.934749201775, 8450.27694938106, 10173.979437045135, 9177.593855266981, 8482.651406829445], "policy_adversary_policy_reward": [2394.9672962934296, 3090.3053946451414, 1204.9800022432185, 696.1967841015185, 6910.917543448596, 8053.981314052096, 2209.39044959295, 1692.1734318400515, 6729.206184740734, 3715.6004076339955, 7270.404140214546, 6073.774182288115, 3620.2985545987635, 3246.385886554292, 835.0329124595359, 556.423837792133, 7578.0024307155945, 8675.443204630037, 3332.267924602481, 1901.493769933218, 4443.726002936504, 1330.2858900066844, 2657.1941456543286, 2608.270977076058, 4743.7162753497905, 4204.502983205676, 4024.803019644592, 4230.327307638774, 4114.910259993244, 3270.6188868518334, 4027.7617821512954, 956.5912315410309, 9003.865030628212, 8353.130137320983, 958.5303473763413, 1509.5154743149021, 6832.267106358243, 7080.734079755978, 6350.01163964229, 7075.202234495963, 6152.838819496753, 5693.7999006601, 1316.9412408380156, 549.4674049997262, 7741.6880637550585, 4024.109289830876, 6980.605018530476, 8843.908476478557, 5860.175709271293, 6467.721250466812, 7990.063106334581, 6220.8920947605175, 4010.261656854659, 4093.454846964749, 5673.388917877131, 7320.08086076356, 4369.173883729869, 8271.465278765132, 9698.080597032016, 7569.736953023674, 8649.09664948433, 8961.755253373854, 6483.534575110851, 5455.745638881345, 5801.116978125428, 5205.010155615195, 3581.535825095274, 4667.994953558545, 4336.721305059993, 5249.634518620712, 4026.238759880326, 8420.562491109296, 3551.9982308385315, 4062.7656442598363, 3612.538093816792, 3446.628729740764, 4662.836960219131, 7573.233627205279, 791.7493233036729, 412.8633394692989, 4666.977788753123, 6001.43408104956, 5474.712347780262, 6886.286182743798, 6792.234851504508, 6736.523360439802, 2993.7408662206517, 2528.8779910848452, 7386.287122648006, 6963.122150574347, 7749.678073149791, 6876.3721631356475, 5211.573665658723, 7002.973364746011, 7090.508339445708, 3941.991892453058, 3754.261553359458, 4493.796583429247, 7214.819170141842, 7242.564663009033, 2934.222650095184, 4753.941413601465, 8689.080653091465, 7717.868045372356, 4198.381511533755, 4367.808007688062, 4342.315041450514, 5031.48757283262, 3886.8538074023545, 1688.8496825716688, 7096.864306574416, 6654.833684252114, 6042.5510481956535, 6062.343242909982, 6559.709061630178, 6988.632881747794, 5805.212406091464, 4821.193902951506, 6159.2512054265235, 5414.102095545279, 4202.642295710613, 3034.8879602386114, 3570.203838665409, 1199.0964957191786, 3696.7633698360455, 1219.1541331132673, 7823.992975352727, 4275.1292393747, 2997.327978221371, 3144.977516152733, 5344.78283390023, 4555.16866969396, 5708.9127981994225, 6832.938770663469, 4877.332165631941, 7875.891420729388, 3112.026012761328, 2717.1566814047046, 7887.985718492868, 7783.271437285346, 4424.5518705081895, 5134.649218018533, 91.330387558115, 138.62948665826127, 5579.75919844311, 4282.882677705792, 5288.034805952631, 5650.467068019006, 1074.518777792949, 2050.9354216893676, 3294.3388532223425, 2279.402559531365, 1046.4178853387307, 2238.5118766611336, 6670.994588423243, 7977.412464542669, 8881.43829621339, 5506.835410261113, 6128.646975591682, 7192.049559895788, 5124.745953284268, 5896.653832973776, 5514.3749826787225, 4496.720293697536, 7845.133635452877, 6225.514464567025, 6926.399802198913, 6929.940221831242, 5030.078671068196, 5884.7992181476275, 4647.247620867415, 4672.4416222868385, 4618.5041832235165, 4022.5475694434067, 5167.953195565941, 4667.391588633004, 6188.948276033311, 5401.783113529763, 5882.636642558314, 6051.030166497757, 4842.6455215621145, 5829.828178548504, 3152.7705288543593, 3498.550513327241, 4053.274768511029, 4092.801754124677, 1407.1775778024578, 1737.2932974479409, 4753.02613816674, 5534.869825293252, 1647.3039328636846, 1277.9344279884053, 4015.2238294561594, 5689.63328317697, 3343.662852940123, 3930.977164282056, 4785.148179455039, 4592.5938964088045, 5649.680075330668, 4460.5102372215315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963539087988057, "mean_inference_ms": 0.9804766059136408, "mean_action_processing_ms": 0.16606913472509954, "mean_env_wait_ms": 0.05350935498880939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032318830490112305, "StateBufferConnector_ms": 0.0024988651275634766, "ViewRequirementAgentConnector_ms": 0.06613457202911377}, "num_episodes": 20, "episode_return_max": 22772.326442361813, "episode_return_min": 232.75174379542455, "episode_return_mean": 17611.9338588785}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.4754112960994, "num_env_steps_trained_throughput_per_sec": 513.4754112960994, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 7480.208, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7480.169, "sample_time_ms": 739.061, "learn_time_ms": 6730.13, "learn_throughput": 594.342, "synch_weights_time_ms": 10.461}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "training_iteration": 43, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-34-56", "timestamp": 1723235696, "time_this_iter_s": 7.795249938964844, "time_total_s": 326.5173993110657, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206b7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.5173993110657, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.76363636363636, "ram_util_percent": 82.00909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8346507913536496, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.029117488861084, "policy_loss": 0.013024366878603817, "vf_loss": 9.993236108305593, "vf_explained_var": 0.00011814788535789207, "kl": 0.01783690378119154, "entropy": 1.1412105597516216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8306586288536588, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.986895446976026, "policy_loss": -0.004639306603833878, "vf_loss": 9.984334593017897, "vf_explained_var": 3.321754435698191e-05, "kl": 0.014222582948665756, "entropy": 1.4650136282046635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 22772.326442361813, "episode_reward_min": 232.75174379542455, "episode_reward_mean": 17903.808487582588, "episode_len_mean": 190.4, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19040, "policy_reward_min": {"agent_policy": 2.791869579048245, "adversary_policy": 91.330387558115}, "policy_reward_max": {"agent_policy": 12483.934749201775, "adversary_policy": 9698.080597032016}, "policy_reward_mean": {"agent_policy": 7802.945395921848, "adversary_policy": 5050.431545830372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18166.24491356183, 20743.99616471921, 20000.50054116039, 20155.350097286188, 18135.299874089906, 19793.5232883525, 18511.309507460795, 21152.68249661168, 22772.326442361813, 19590.39182785027, 19167.157539068627, 17707.583397456772, 18473.23063426484, 18168.37438361127, 17634.520410705183, 17560.90411363492, 18804.97258395003, 1261.3914768931559, 18808.143478196183, 19614.9501067965, 20593.04171884856, 16662.262149734037, 20405.675779301328, 21010.129768121238, 19291.409992459598, 18084.127516184017, 17895.009402353415, 21152.466568613105, 17061.581928698408, 21843.742346297247, 18327.39236941135, 18480.43349115201, 15817.45432282884, 20333.504177538052, 19996.698487362482, 20433.551774962245, 18930.164388408997, 19477.83189835769, 17165.31468435661, 15328.828183226808, 15360.663694242905, 18415.259429819835, 16476.494365139715, 18656.827731126607, 19751.835968435582, 18875.844557119242, 16848.085680480057, 21700.89158500563, 18430.02732799911, 232.75174379542455, 18421.233851952085, 19394.833022753533, 15188.26930395847, 16371.98494984834, 15183.228022602458, 20331.066305431134, 19648.97103399207, 20142.957700157007, 19266.881577015272, 18637.82566373728, 20367.59183305244, 20927.807488601775, 19169.17575639034, 18714.298987477876, 18151.468322857665, 18797.49988037192, 19145.743638143118, 19551.23669136101, 18947.088210021422, 17290.950587269526, 18030.058001624773, 15540.91235745254, 18893.045946726663, 15409.173110053871, 18155.134062014127, 17448.619454267406, 18555.335931130765, 18592.841719381668, 19204.123233171358, 18257.03021902351, 17245.012615314427, 18669.312442671602, 17957.763271919877, 22118.634660760938, 18797.217127298474, 18457.202752092922, 19186.131118597463, 18396.410966209958, 19062.43724103869, 18021.707013811167, 1324.7454490830944, 17113.780108877654, 1473.511528297603, 19644.291545045522, 20228.2035008176, 19322.195951884172, 20951.438779694, 20832.823680718877, 20155.532974967595, 423.95285790395894], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 11, 200, 200, 200, 200, 200, 200, 4], "policy_agent_policy_reward": [6400.447559975898, 4919.482669710124, 7672.603581422346, 5944.3948961910855, 10031.583370270557, 6800.053509711804, 5870.670344965821, 3884.864946555992, 5161.474539503615, 7651.1116138580555, 8161.030405327981, 9458.052618802938, 8886.874810584157, 5721.573132621662, 10019.756535606823, 10501.737290077353, 6568.901996525674, 56.77881412018424, 8139.731608393445, 7253.951576272415, 7064.283506904194, 11139.643292428587, 6056.266506078991, 6384.079531835839, 7076.862962054845, 7051.627284285241, 9646.951265564694, 6695.08273546218, 9373.417865001808, 5436.7936478333795, 9761.202850189478, 9106.630876869014, 10241.750832854852, 6581.806186711503, 7891.804196256878, 6885.209831584248, 8303.758079366095, 7904.478597385898, 9927.7844284074, 10559.527848842226, 10444.746191293561, 6316.137215092446, 10334.188870765638, 8756.876227532379, 7209.984399572682, 6122.6209707579, 11018.902986314031, 6029.634429227321, 8870.826239472362, 2.791869579048245, 8558.591975803214, 8456.331148781874, 12062.815104476158, 10798.243537094622, 11898.29826060255, 5682.659252465187, 5260.697327517547, 6822.261164669584, 8245.48179075717, 8626.730387360996, 6296.943733032548, 7071.467464571509, 8254.297867174524, 9394.609744323554, 9510.416570190664, 8962.155096172979, 7555.012248580045, 7617.569882304961, 8274.614509910907, 10639.629545087919, 9883.981478989133, 12396.44148220212, 8605.149983266732, 12483.934749201775, 8450.27694938106, 10173.979437045135, 9177.593855266981, 8482.651406829445, 7241.845983612841, 8371.017085742475, 8851.229150756393, 9083.879365665025, 9616.295327409487, 4846.660318227328, 8843.296515300832, 6275.025596124033, 8787.207882392693, 8796.080093324314, 8672.770120038553, 10121.042613090205, 58.79557457863696, 9980.003177660608, 62.718560744181275, 7663.849186015841, 6566.981115717407, 8379.878081468407, 6201.125860996503, 7234.26269718993, 7688.9730845577815, 8.018702487839475], "policy_adversary_policy_reward": [7741.6880637550585, 4024.109289830876, 6980.605018530476, 8843.908476478557, 5860.175709271293, 6467.721250466812, 7990.063106334581, 6220.8920947605175, 4010.261656854659, 4093.454846964749, 5673.388917877131, 7320.08086076356, 4369.173883729869, 8271.465278765132, 9698.080597032016, 7569.736953023674, 8649.09664948433, 8961.755253373854, 6483.534575110851, 5455.745638881345, 5801.116978125428, 5205.010155615195, 3581.535825095274, 4667.994953558545, 4336.721305059993, 5249.634518620712, 4026.238759880326, 8420.562491109296, 3551.9982308385315, 4062.7656442598363, 3612.538093816792, 3446.628729740764, 4662.836960219131, 7573.233627205279, 791.7493233036729, 412.8633394692989, 4666.977788753123, 6001.43408104956, 5474.712347780262, 6886.286182743798, 6792.234851504508, 6736.523360439802, 2993.7408662206517, 2528.8779910848452, 7386.287122648006, 6963.122150574347, 7749.678073149791, 6876.3721631356475, 5211.573665658723, 7002.973364746011, 7090.508339445708, 3941.991892453058, 3754.261553359458, 4493.796583429247, 7214.819170141842, 7242.564663009033, 2934.222650095184, 4753.941413601465, 8689.080653091465, 7717.868045372356, 4198.381511533755, 4367.808007688062, 4342.315041450514, 5031.48757283262, 3886.8538074023545, 1688.8496825716688, 7096.864306574416, 6654.833684252114, 6042.5510481956535, 6062.343242909982, 6559.709061630178, 6988.632881747794, 5805.212406091464, 4821.193902951506, 6159.2512054265235, 5414.102095545279, 4202.642295710613, 3034.8879602386114, 3570.203838665409, 1199.0964957191786, 3696.7633698360455, 1219.1541331132673, 7823.992975352727, 4275.1292393747, 2997.327978221371, 3144.977516152733, 5344.78283390023, 4555.16866969396, 5708.9127981994225, 6832.938770663469, 4877.332165631941, 7875.891420729388, 3112.026012761328, 2717.1566814047046, 7887.985718492868, 7783.271437285346, 4424.5518705081895, 5134.649218018533, 91.330387558115, 138.62948665826127, 5579.75919844311, 4282.882677705792, 5288.034805952631, 5650.467068019006, 1074.518777792949, 2050.9354216893676, 3294.3388532223425, 2279.402559531365, 1046.4178853387307, 2238.5118766611336, 6670.994588423243, 7977.412464542669, 8881.43829621339, 5506.835410261113, 6128.646975591682, 7192.049559895788, 5124.745953284268, 5896.653832973776, 5514.3749826787225, 4496.720293697536, 7845.133635452877, 6225.514464567025, 6926.399802198913, 6929.940221831242, 5030.078671068196, 5884.7992181476275, 4647.247620867415, 4672.4416222868385, 4618.5041832235165, 4022.5475694434067, 5167.953195565941, 4667.391588633004, 6188.948276033311, 5401.783113529763, 5882.636642558314, 6051.030166497757, 4842.6455215621145, 5829.828178548504, 3152.7705288543593, 3498.550513327241, 4053.274768511029, 4092.801754124677, 1407.1775778024578, 1737.2932974479409, 4753.02613816674, 5534.869825293252, 1647.3039328636846, 1277.9344279884053, 4015.2238294561594, 5689.63328317697, 3343.662852940123, 3930.977164282056, 4785.148179455039, 4592.5938964088045, 5649.680075330668, 4460.5102372215315, 5429.402863646648, 6532.874385911852, 4182.414979620865, 5703.598153660281, 5285.52915826823, 3108.2543062898, 4858.250846673398, 4727.18223033318, 3872.1245942398737, 4469.3433502705175, 8224.431199389304, 9047.543143144281, 4970.153032622761, 4983.767579374844, 4315.150425557681, 7867.0267304112185, 5065.120608821569, 5333.802627383299, 4258.284524972972, 5342.046347912652, 5465.2830608677905, 4924.384060132337, 3999.984933840239, 3900.679466880759, 719.0218847265653, 546.9279897778921, 2974.628741321193, 4159.14818989584, 714.9073082476368, 695.8856593057853, 5538.848255927742, 6441.594103101928, 6417.59061910847, 7243.631765991665, 5701.13145560364, 5241.186414812157, 7686.97745932152, 7063.335459375978, 6740.059681099042, 6858.5013024298205, 6166.452322417791, 6300.107567992045, 274.8240099867795, 141.11014542933995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39639390016313114, "mean_inference_ms": 0.9809401497559085, "mean_action_processing_ms": 0.1660977705987554, "mean_env_wait_ms": 0.053502550229852106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033675432205200195, "StateBufferConnector_ms": 0.00254058837890625, "ViewRequirementAgentConnector_ms": 0.06591415405273438}, "num_episodes": 22, "episode_return_max": 22772.326442361813, "episode_return_min": 232.75174379542455, "episode_return_mean": 17903.808487582588}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 515.5117349080252, "num_env_steps_trained_throughput_per_sec": 515.5117349080252, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 7523.099, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7523.059, "sample_time_ms": 740.642, "learn_time_ms": 6771.372, "learn_throughput": 590.722, "synch_weights_time_ms": 10.475}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 44, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-35-04", "timestamp": 1723235704, "time_this_iter_s": 7.763512134552002, "time_total_s": 334.2809114456177, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.2809114456177, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.763636363636365, "ram_util_percent": 82.62727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8609005423765334, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.023775331810038, "policy_loss": 0.005027565696749777, "vf_loss": 9.992117887325389, "vf_explained_var": 1.403326710695943e-06, "kl": 0.020781150835728835, "entropy": 1.1952091654141743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8048462548293174, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998818449179332, "policy_loss": -0.0017060526030642602, "vf_loss": 9.994680700699488, "vf_explained_var": -7.542173067728678e-05, "kl": 0.011543295568844768, "entropy": 1.4595966478188833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 22118.634660760938, "episode_reward_min": 232.75174379542455, "episode_reward_mean": 17806.45304134374, "episode_len_mean": 190.76, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19076, "policy_reward_min": {"agent_policy": 2.791869579048245, "adversary_policy": 91.330387558115}, "policy_reward_max": {"agent_policy": 12483.934749201775, "adversary_policy": 9047.543143144281}, "policy_reward_mean": {"agent_policy": 8091.911143956306, "adversary_policy": 4857.2709486937165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20593.04171884856, 16662.262149734037, 20405.675779301328, 21010.129768121238, 19291.409992459598, 18084.127516184017, 17895.009402353415, 21152.466568613105, 17061.581928698408, 21843.742346297247, 18327.39236941135, 18480.43349115201, 15817.45432282884, 20333.504177538052, 19996.698487362482, 20433.551774962245, 18930.164388408997, 19477.83189835769, 17165.31468435661, 15328.828183226808, 15360.663694242905, 18415.259429819835, 16476.494365139715, 18656.827731126607, 19751.835968435582, 18875.844557119242, 16848.085680480057, 21700.89158500563, 18430.02732799911, 232.75174379542455, 18421.233851952085, 19394.833022753533, 15188.26930395847, 16371.98494984834, 15183.228022602458, 20331.066305431134, 19648.97103399207, 20142.957700157007, 19266.881577015272, 18637.82566373728, 20367.59183305244, 20927.807488601775, 19169.17575639034, 18714.298987477876, 18151.468322857665, 18797.49988037192, 19145.743638143118, 19551.23669136101, 18947.088210021422, 17290.950587269526, 18030.058001624773, 15540.91235745254, 18893.045946726663, 15409.173110053871, 18155.134062014127, 17448.619454267406, 18555.335931130765, 18592.841719381668, 19204.123233171358, 18257.03021902351, 17245.012615314427, 18669.312442671602, 17957.763271919877, 22118.634660760938, 18797.217127298474, 18457.202752092922, 19186.131118597463, 18396.410966209958, 19062.43724103869, 18021.707013811167, 1324.7454490830944, 17113.780108877654, 1473.511528297603, 19644.291545045522, 20228.2035008176, 19322.195951884172, 20951.438779694, 20832.823680718877, 20155.532974967595, 423.95285790395894, 15254.324280391475, 18666.1510126593, 17855.806044380093, 18088.739119934977, 18522.59396853525, 5312.918938808935, 19119.64556186907, 21118.43403601824, 17946.58354041438, 19091.412339221897, 19650.025377496215, 17262.711158605, 18591.403626531654, 19853.897073364213, 19524.639036941488, 17310.962091131853, 17905.15710788452, 20595.845131873546, 16976.394167352377, 17839.665040732347], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 11, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7064.283506904194, 11139.643292428587, 6056.266506078991, 6384.079531835839, 7076.862962054845, 7051.627284285241, 9646.951265564694, 6695.08273546218, 9373.417865001808, 5436.7936478333795, 9761.202850189478, 9106.630876869014, 10241.750832854852, 6581.806186711503, 7891.804196256878, 6885.209831584248, 8303.758079366095, 7904.478597385898, 9927.7844284074, 10559.527848842226, 10444.746191293561, 6316.137215092446, 10334.188870765638, 8756.876227532379, 7209.984399572682, 6122.6209707579, 11018.902986314031, 6029.634429227321, 8870.826239472362, 2.791869579048245, 8558.591975803214, 8456.331148781874, 12062.815104476158, 10798.243537094622, 11898.29826060255, 5682.659252465187, 5260.697327517547, 6822.261164669584, 8245.48179075717, 8626.730387360996, 6296.943733032548, 7071.467464571509, 8254.297867174524, 9394.609744323554, 9510.416570190664, 8962.155096172979, 7555.012248580045, 7617.569882304961, 8274.614509910907, 10639.629545087919, 9883.981478989133, 12396.44148220212, 8605.149983266732, 12483.934749201775, 8450.27694938106, 10173.979437045135, 9177.593855266981, 8482.651406829445, 7241.845983612841, 8371.017085742475, 8851.229150756393, 9083.879365665025, 9616.295327409487, 4846.660318227328, 8843.296515300832, 6275.025596124033, 8787.207882392693, 8796.080093324314, 8672.770120038553, 10121.042613090205, 58.79557457863696, 9980.003177660608, 62.718560744181275, 7663.849186015841, 6566.981115717407, 8379.878081468407, 6201.125860996503, 7234.26269718993, 7688.9730845577815, 8.018702487839475, 10897.577829398351, 9366.532448408427, 7722.875806917453, 9191.006886345009, 8409.344474753201, 726.9697137202741, 9077.997939549208, 6548.349305608519, 9235.255263446725, 6894.933033693001, 7766.870756994278, 10385.820256570556, 8967.517307785954, 7752.751891137533, 8207.117385031595, 10524.89480730688, 9160.312504868674, 6631.8413854930395, 11028.405119491736, 9505.2765074232], "policy_adversary_policy_reward": [6792.234851504508, 6736.523360439802, 2993.7408662206517, 2528.8779910848452, 7386.287122648006, 6963.122150574347, 7749.678073149791, 6876.3721631356475, 5211.573665658723, 7002.973364746011, 7090.508339445708, 3941.991892453058, 3754.261553359458, 4493.796583429247, 7214.819170141842, 7242.564663009033, 2934.222650095184, 4753.941413601465, 8689.080653091465, 7717.868045372356, 4198.381511533755, 4367.808007688062, 4342.315041450514, 5031.48757283262, 3886.8538074023545, 1688.8496825716688, 7096.864306574416, 6654.833684252114, 6042.5510481956535, 6062.343242909982, 6559.709061630178, 6988.632881747794, 5805.212406091464, 4821.193902951506, 6159.2512054265235, 5414.102095545279, 4202.642295710613, 3034.8879602386114, 3570.203838665409, 1199.0964957191786, 3696.7633698360455, 1219.1541331132673, 7823.992975352727, 4275.1292393747, 2997.327978221371, 3144.977516152733, 5344.78283390023, 4555.16866969396, 5708.9127981994225, 6832.938770663469, 4877.332165631941, 7875.891420729388, 3112.026012761328, 2717.1566814047046, 7887.985718492868, 7783.271437285346, 4424.5518705081895, 5134.649218018533, 91.330387558115, 138.62948665826127, 5579.75919844311, 4282.882677705792, 5288.034805952631, 5650.467068019006, 1074.518777792949, 2050.9354216893676, 3294.3388532223425, 2279.402559531365, 1046.4178853387307, 2238.5118766611336, 6670.994588423243, 7977.412464542669, 8881.43829621339, 5506.835410261113, 6128.646975591682, 7192.049559895788, 5124.745953284268, 5896.653832973776, 5514.3749826787225, 4496.720293697536, 7845.133635452877, 6225.514464567025, 6926.399802198913, 6929.940221831242, 5030.078671068196, 5884.7992181476275, 4647.247620867415, 4672.4416222868385, 4618.5041832235165, 4022.5475694434067, 5167.953195565941, 4667.391588633004, 6188.948276033311, 5401.783113529763, 5882.636642558314, 6051.030166497757, 4842.6455215621145, 5829.828178548504, 3152.7705288543593, 3498.550513327241, 4053.274768511029, 4092.801754124677, 1407.1775778024578, 1737.2932974479409, 4753.02613816674, 5534.869825293252, 1647.3039328636846, 1277.9344279884053, 4015.2238294561594, 5689.63328317697, 3343.662852940123, 3930.977164282056, 4785.148179455039, 4592.5938964088045, 5649.680075330668, 4460.5102372215315, 5429.402863646648, 6532.874385911852, 4182.414979620865, 5703.598153660281, 5285.52915826823, 3108.2543062898, 4858.250846673398, 4727.18223033318, 3872.1245942398737, 4469.3433502705175, 8224.431199389304, 9047.543143144281, 4970.153032622761, 4983.767579374844, 4315.150425557681, 7867.0267304112185, 5065.120608821569, 5333.802627383299, 4258.284524972972, 5342.046347912652, 5465.2830608677905, 4924.384060132337, 3999.984933840239, 3900.679466880759, 719.0218847265653, 546.9279897778921, 2974.628741321193, 4159.14818989584, 714.9073082476368, 695.8856593057853, 5538.848255927742, 6441.594103101928, 6417.59061910847, 7243.631765991665, 5701.13145560364, 5241.186414812157, 7686.97745932152, 7063.335459375978, 6740.059681099042, 6858.5013024298205, 6166.452322417791, 6300.107567992045, 274.8240099867795, 141.11014542933995, 3234.674841132589, 1122.0716098605512, 4743.805455605775, 4555.813108645087, 6413.372373992736, 3719.55786346991, 3946.603496203974, 4951.128737385943, 4389.529192467451, 5723.720301314589, 1918.8063891135087, 2667.1428359751544, 5049.369417673229, 4992.278204646705, 7313.481863571268, 7256.602866838418, 4657.055070650989, 4054.2732063166295, 4969.402416480839, 7227.076889048077, 6194.776371738887, 5688.378248763042, 3123.104127738576, 3753.7867742958233, 4466.228621054474, 5157.657697691226, 6320.530065431492, 5780.6151167952185, 5388.055424119671, 5929.466227790251, 3392.4731643990162, 3393.5941194259735, 3784.6612578215436, 4960.183345194269, 7216.411795162083, 6747.591951218419, 2848.2196214516307, 3099.7694264089896, 3702.723137304061, 4631.665396005074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963158718523559, "mean_inference_ms": 0.9806381455840326, "mean_action_processing_ms": 0.16605574104393608, "mean_env_wait_ms": 0.05351107298850218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035091638565063477, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.06690335273742676}, "num_episodes": 20, "episode_return_max": 22118.634660760938, "episode_return_min": 232.75174379542455, "episode_return_mean": 17806.45304134374}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.654606324622, "num_env_steps_trained_throughput_per_sec": 499.654606324622, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 7582.514, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7582.474, "sample_time_ms": 740.912, "learn_time_ms": 6830.471, "learn_throughput": 585.611, "synch_weights_time_ms": 10.518}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 45, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-35-12", "timestamp": 1723235712, "time_this_iter_s": 8.009986877441406, "time_total_s": 342.2908983230591, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.2908983230591, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 26.883333333333336, "ram_util_percent": 83.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9273451063210372, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97723700356862, "policy_loss": -0.0019055086690636855, "vf_loss": 9.969540202428425, "vf_explained_var": 1.2214284725290127e-05, "kl": 0.004995575556088061, "entropy": 1.2137078392442573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8278928364627063, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.007198734084765, "policy_loss": -0.0013711041069958203, "vf_loss": 9.997778631250064, "vf_explained_var": 2.272271861632665e-05, "kl": 0.021316029069324335, "entropy": 1.458569228152434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 22118.634660760938, "episode_reward_min": 121.38165608327594, "episode_reward_mean": 17658.225926844752, "episode_len_mean": 188.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18877, "policy_reward_min": {"agent_policy": 0.8211090352170982, "adversary_policy": 50.67097796462119}, "policy_reward_max": {"agent_policy": 12483.934749201775, "adversary_policy": 9047.543143144281}, "policy_reward_mean": {"agent_policy": 8033.719413316788, "adversary_policy": 4812.253256763983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18415.259429819835, 16476.494365139715, 18656.827731126607, 19751.835968435582, 18875.844557119242, 16848.085680480057, 21700.89158500563, 18430.02732799911, 232.75174379542455, 18421.233851952085, 19394.833022753533, 15188.26930395847, 16371.98494984834, 15183.228022602458, 20331.066305431134, 19648.97103399207, 20142.957700157007, 19266.881577015272, 18637.82566373728, 20367.59183305244, 20927.807488601775, 19169.17575639034, 18714.298987477876, 18151.468322857665, 18797.49988037192, 19145.743638143118, 19551.23669136101, 18947.088210021422, 17290.950587269526, 18030.058001624773, 15540.91235745254, 18893.045946726663, 15409.173110053871, 18155.134062014127, 17448.619454267406, 18555.335931130765, 18592.841719381668, 19204.123233171358, 18257.03021902351, 17245.012615314427, 18669.312442671602, 17957.763271919877, 22118.634660760938, 18797.217127298474, 18457.202752092922, 19186.131118597463, 18396.410966209958, 19062.43724103869, 18021.707013811167, 1324.7454490830944, 17113.780108877654, 1473.511528297603, 19644.291545045522, 20228.2035008176, 19322.195951884172, 20951.438779694, 20832.823680718877, 20155.532974967595, 423.95285790395894, 15254.324280391475, 18666.1510126593, 17855.806044380093, 18088.739119934977, 18522.59396853525, 5312.918938808935, 19119.64556186907, 21118.43403601824, 17946.58354041438, 19091.412339221897, 19650.025377496215, 17262.711158605, 18591.403626531654, 19853.897073364213, 19524.639036941488, 17310.962091131853, 17905.15710788452, 20595.845131873546, 16976.394167352377, 17839.665040732347, 20374.55125726939, 19359.230643466704, 19159.95479657041, 18693.857128351065, 121.38165608327594, 17708.86616226018, 18614.713070169615, 20196.51057111455, 20123.27975295772, 20052.63388408671, 17849.481326478268, 17294.949124211376, 18596.67432594973, 18961.100798377178, 16929.304606026948, 20439.71919694933, 16324.31565811343, 18982.82071291328, 18490.45940263582, 20006.16378551108, 20548.60533306407], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 11, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6316.137215092446, 10334.188870765638, 8756.876227532379, 7209.984399572682, 6122.6209707579, 11018.902986314031, 6029.634429227321, 8870.826239472362, 2.791869579048245, 8558.591975803214, 8456.331148781874, 12062.815104476158, 10798.243537094622, 11898.29826060255, 5682.659252465187, 5260.697327517547, 6822.261164669584, 8245.48179075717, 8626.730387360996, 6296.943733032548, 7071.467464571509, 8254.297867174524, 9394.609744323554, 9510.416570190664, 8962.155096172979, 7555.012248580045, 7617.569882304961, 8274.614509910907, 10639.629545087919, 9883.981478989133, 12396.44148220212, 8605.149983266732, 12483.934749201775, 8450.27694938106, 10173.979437045135, 9177.593855266981, 8482.651406829445, 7241.845983612841, 8371.017085742475, 8851.229150756393, 9083.879365665025, 9616.295327409487, 4846.660318227328, 8843.296515300832, 6275.025596124033, 8787.207882392693, 8796.080093324314, 8672.770120038553, 10121.042613090205, 58.79557457863696, 9980.003177660608, 62.718560744181275, 7663.849186015841, 6566.981115717407, 8379.878081468407, 6201.125860996503, 7234.26269718993, 7688.9730845577815, 8.018702487839475, 10897.577829398351, 9366.532448408427, 7722.875806917453, 9191.006886345009, 8409.344474753201, 726.9697137202741, 9077.997939549208, 6548.349305608519, 9235.255263446725, 6894.933033693001, 7766.870756994278, 10385.820256570556, 8967.517307785954, 7752.751891137533, 8207.117385031595, 10524.89480730688, 9160.312504868674, 6631.8413854930395, 11028.405119491736, 9505.2765074232, 7426.508333247221, 8327.397181223325, 7102.474851028303, 7690.37442806431, 0.8211090352170982, 9382.747248252646, 8067.801974106653, 7584.46715081393, 7999.40087912397, 7572.982367289858, 9640.03803372863, 8708.265548504853, 8420.242537019294, 8742.781785596435, 10028.327933263545, 6647.396327968127, 11141.37676799969, 9083.651510420303, 9148.803551706636, 7400.426405688118, 7598.249529178032], "policy_adversary_policy_reward": [7823.992975352727, 4275.1292393747, 2997.327978221371, 3144.977516152733, 5344.78283390023, 4555.16866969396, 5708.9127981994225, 6832.938770663469, 4877.332165631941, 7875.891420729388, 3112.026012761328, 2717.1566814047046, 7887.985718492868, 7783.271437285346, 4424.5518705081895, 5134.649218018533, 91.330387558115, 138.62948665826127, 5579.75919844311, 4282.882677705792, 5288.034805952631, 5650.467068019006, 1074.518777792949, 2050.9354216893676, 3294.3388532223425, 2279.402559531365, 1046.4178853387307, 2238.5118766611336, 6670.994588423243, 7977.412464542669, 8881.43829621339, 5506.835410261113, 6128.646975591682, 7192.049559895788, 5124.745953284268, 5896.653832973776, 5514.3749826787225, 4496.720293697536, 7845.133635452877, 6225.514464567025, 6926.399802198913, 6929.940221831242, 5030.078671068196, 5884.7992181476275, 4647.247620867415, 4672.4416222868385, 4618.5041832235165, 4022.5475694434067, 5167.953195565941, 4667.391588633004, 6188.948276033311, 5401.783113529763, 5882.636642558314, 6051.030166497757, 4842.6455215621145, 5829.828178548504, 3152.7705288543593, 3498.550513327241, 4053.274768511029, 4092.801754124677, 1407.1775778024578, 1737.2932974479409, 4753.02613816674, 5534.869825293252, 1647.3039328636846, 1277.9344279884053, 4015.2238294561594, 5689.63328317697, 3343.662852940123, 3930.977164282056, 4785.148179455039, 4592.5938964088045, 5649.680075330668, 4460.5102372215315, 5429.402863646648, 6532.874385911852, 4182.414979620865, 5703.598153660281, 5285.52915826823, 3108.2543062898, 4858.250846673398, 4727.18223033318, 3872.1245942398737, 4469.3433502705175, 8224.431199389304, 9047.543143144281, 4970.153032622761, 4983.767579374844, 4315.150425557681, 7867.0267304112185, 5065.120608821569, 5333.802627383299, 4258.284524972972, 5342.046347912652, 5465.2830608677905, 4924.384060132337, 3999.984933840239, 3900.679466880759, 719.0218847265653, 546.9279897778921, 2974.628741321193, 4159.14818989584, 714.9073082476368, 695.8856593057853, 5538.848255927742, 6441.594103101928, 6417.59061910847, 7243.631765991665, 5701.13145560364, 5241.186414812157, 7686.97745932152, 7063.335459375978, 6740.059681099042, 6858.5013024298205, 6166.452322417791, 6300.107567992045, 274.8240099867795, 141.11014542933995, 3234.674841132589, 1122.0716098605512, 4743.805455605775, 4555.813108645087, 6413.372373992736, 3719.55786346991, 3946.603496203974, 4951.128737385943, 4389.529192467451, 5723.720301314589, 1918.8063891135087, 2667.1428359751544, 5049.369417673229, 4992.278204646705, 7313.481863571268, 7256.602866838418, 4657.055070650989, 4054.2732063166295, 4969.402416480839, 7227.076889048077, 6194.776371738887, 5688.378248763042, 3123.104127738576, 3753.7867742958233, 4466.228621054474, 5157.657697691226, 6320.530065431492, 5780.6151167952185, 5388.055424119671, 5929.466227790251, 3392.4731643990162, 3393.5941194259735, 3784.6612578215436, 4960.183345194269, 7216.411795162083, 6747.591951218419, 2848.2196214516307, 3099.7694264089896, 3702.723137304061, 4631.665396005074, 6710.791441684653, 6237.251482337494, 5750.0473858681635, 5281.786076375235, 7039.660772702648, 5017.81917283943, 6444.132063319012, 4559.350636967755, 69.88956908343766, 50.67097796462119, 4623.724024004691, 3702.394890002815, 6072.179045619429, 4474.732050443581, 6281.167875169385, 6330.875545131237, 5985.072005387935, 6138.8068684459195, 6022.769903239481, 6456.881613557343, 4502.097590002316, 3707.3457027473287, 5432.158341421412, 3154.525234285161, 4455.1539280648885, 5721.277860865559, 4863.516797696582, 5354.802215084168, 3657.712719351044, 3243.2639534123755, 7290.655820473125, 6501.667048508066, 2194.2423858077136, 2988.696504306041, 4956.339622624732, 4942.829579868285, 4407.555164847782, 4934.100686081383, 6548.3272902123235, 6057.410089610717, 6435.935072357535, 6514.420731528477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.396869874083866, "mean_inference_ms": 0.9828490093758127, "mean_action_processing_ms": 0.16640531760428953, "mean_env_wait_ms": 0.05363940593023465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003650665283203125, "StateBufferConnector_ms": 0.0027208328247070312, "ViewRequirementAgentConnector_ms": 0.07092976570129395}, "num_episodes": 21, "episode_return_max": 22118.634660760938, "episode_return_min": 121.38165608327594, "episode_return_mean": 17658.225926844752}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.6590366288228, "num_env_steps_trained_throughput_per_sec": 486.6590366288228, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 7663.446, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7663.406, "sample_time_ms": 777.837, "learn_time_ms": 6874.553, "learn_throughput": 581.856, "synch_weights_time_ms": 10.436}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 46, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-35-20", "timestamp": 1723235720, "time_this_iter_s": 8.224143028259277, "time_total_s": 350.51504135131836, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.51504135131836, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 32.00833333333333, "ram_util_percent": 82.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.89753201445811, "cur_kl_coeff": 0.9610839843749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.975886554314346, "policy_loss": -0.0005782161785102395, "vf_loss": 9.973622094512617, "vf_explained_var": 0.00014584376698448544, "kl": 0.0029577583731176756, "entropy": 1.2083985813080318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8490615336534878, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004566804567974, "policy_loss": -0.0033012594964626865, "vf_loss": 10.0, "vf_explained_var": 0.00012334057440360386, "kl": 0.010361210118086698, "entropy": 1.4666483469307423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "env_runners": {"episode_reward_max": 22118.634660760938, "episode_reward_min": 121.38165608327594, "episode_reward_mean": 17989.562826349196, "episode_len_mean": 190.75, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19075, "policy_reward_min": {"agent_policy": 0.8211090352170982, "adversary_policy": 50.67097796462119}, "policy_reward_max": {"agent_policy": 12483.934749201775, "adversary_policy": 9047.543143144281}, "policy_reward_mean": {"agent_policy": 8017.323088046329, "adversary_policy": 4986.1198691514355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18714.298987477876, 18151.468322857665, 18797.49988037192, 19145.743638143118, 19551.23669136101, 18947.088210021422, 17290.950587269526, 18030.058001624773, 15540.91235745254, 18893.045946726663, 15409.173110053871, 18155.134062014127, 17448.619454267406, 18555.335931130765, 18592.841719381668, 19204.123233171358, 18257.03021902351, 17245.012615314427, 18669.312442671602, 17957.763271919877, 22118.634660760938, 18797.217127298474, 18457.202752092922, 19186.131118597463, 18396.410966209958, 19062.43724103869, 18021.707013811167, 1324.7454490830944, 17113.780108877654, 1473.511528297603, 19644.291545045522, 20228.2035008176, 19322.195951884172, 20951.438779694, 20832.823680718877, 20155.532974967595, 423.95285790395894, 15254.324280391475, 18666.1510126593, 17855.806044380093, 18088.739119934977, 18522.59396853525, 5312.918938808935, 19119.64556186907, 21118.43403601824, 17946.58354041438, 19091.412339221897, 19650.025377496215, 17262.711158605, 18591.403626531654, 19853.897073364213, 19524.639036941488, 17310.962091131853, 17905.15710788452, 20595.845131873546, 16976.394167352377, 17839.665040732347, 20374.55125726939, 19359.230643466704, 19159.95479657041, 18693.857128351065, 121.38165608327594, 17708.86616226018, 18614.713070169615, 20196.51057111455, 20123.27975295772, 20052.63388408671, 17849.481326478268, 17294.949124211376, 18596.67432594973, 18961.100798377178, 16929.304606026948, 20439.71919694933, 16324.31565811343, 18982.82071291328, 18490.45940263582, 20006.16378551108, 20548.60533306407, 20864.49561272473, 20945.250808964727, 16182.0209228168, 19363.2642644128, 20425.52438317136, 19351.98666227174, 18352.53125900079, 19347.958694758807, 20965.471986012333, 21775.456949109237, 20783.53868315047, 17586.154694296074, 19313.44205440891, 18114.951930126004, 18857.597788044797, 19416.13114323434, 17834.921881522365, 19148.837828843345, 17535.81896243499, 21462.7888417513, 19454.77714861369, 18490.612349188257], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 11, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9394.609744323554, 9510.416570190664, 8962.155096172979, 7555.012248580045, 7617.569882304961, 8274.614509910907, 10639.629545087919, 9883.981478989133, 12396.44148220212, 8605.149983266732, 12483.934749201775, 8450.27694938106, 10173.979437045135, 9177.593855266981, 8482.651406829445, 7241.845983612841, 8371.017085742475, 8851.229150756393, 9083.879365665025, 9616.295327409487, 4846.660318227328, 8843.296515300832, 6275.025596124033, 8787.207882392693, 8796.080093324314, 8672.770120038553, 10121.042613090205, 58.79557457863696, 9980.003177660608, 62.718560744181275, 7663.849186015841, 6566.981115717407, 8379.878081468407, 6201.125860996503, 7234.26269718993, 7688.9730845577815, 8.018702487839475, 10897.577829398351, 9366.532448408427, 7722.875806917453, 9191.006886345009, 8409.344474753201, 726.9697137202741, 9077.997939549208, 6548.349305608519, 9235.255263446725, 6894.933033693001, 7766.870756994278, 10385.820256570556, 8967.517307785954, 7752.751891137533, 8207.117385031595, 10524.89480730688, 9160.312504868674, 6631.8413854930395, 11028.405119491736, 9505.2765074232, 7426.508333247221, 8327.397181223325, 7102.474851028303, 7690.37442806431, 0.8211090352170982, 9382.747248252646, 8067.801974106653, 7584.46715081393, 7999.40087912397, 7572.982367289858, 9640.03803372863, 8708.265548504853, 8420.242537019294, 8742.781785596435, 10028.327933263545, 6647.396327968127, 11141.37676799969, 9083.651510420303, 9148.803551706636, 7400.426405688118, 7598.249529178032, 6352.193971884475, 5758.472861292915, 11788.353697472816, 8288.351822385966, 6693.523391239171, 7269.051460619477, 9788.028266218531, 8586.859461886746, 6835.667802678489, 5496.855874023124, 6730.135046607439, 6886.984054359077, 7188.849447046911, 7961.965892710558, 7781.276831422275, 7956.247874605237, 9671.287497585685, 7368.878022553747, 9689.836128677442, 6140.551427117501, 7604.569037103243, 9219.2098260845], "policy_adversary_policy_reward": [4647.247620867415, 4672.4416222868385, 4618.5041832235165, 4022.5475694434067, 5167.953195565941, 4667.391588633004, 6188.948276033311, 5401.783113529763, 5882.636642558314, 6051.030166497757, 4842.6455215621145, 5829.828178548504, 3152.7705288543593, 3498.550513327241, 4053.274768511029, 4092.801754124677, 1407.1775778024578, 1737.2932974479409, 4753.02613816674, 5534.869825293252, 1647.3039328636846, 1277.9344279884053, 4015.2238294561594, 5689.63328317697, 3343.662852940123, 3930.977164282056, 4785.148179455039, 4592.5938964088045, 5649.680075330668, 4460.5102372215315, 5429.402863646648, 6532.874385911852, 4182.414979620865, 5703.598153660281, 5285.52915826823, 3108.2543062898, 4858.250846673398, 4727.18223033318, 3872.1245942398737, 4469.3433502705175, 8224.431199389304, 9047.543143144281, 4970.153032622761, 4983.767579374844, 4315.150425557681, 7867.0267304112185, 5065.120608821569, 5333.802627383299, 4258.284524972972, 5342.046347912652, 5465.2830608677905, 4924.384060132337, 3999.984933840239, 3900.679466880759, 719.0218847265653, 546.9279897778921, 2974.628741321193, 4159.14818989584, 714.9073082476368, 695.8856593057853, 5538.848255927742, 6441.594103101928, 6417.59061910847, 7243.631765991665, 5701.13145560364, 5241.186414812157, 7686.97745932152, 7063.335459375978, 6740.059681099042, 6858.5013024298205, 6166.452322417791, 6300.107567992045, 274.8240099867795, 141.11014542933995, 3234.674841132589, 1122.0716098605512, 4743.805455605775, 4555.813108645087, 6413.372373992736, 3719.55786346991, 3946.603496203974, 4951.128737385943, 4389.529192467451, 5723.720301314589, 1918.8063891135087, 2667.1428359751544, 5049.369417673229, 4992.278204646705, 7313.481863571268, 7256.602866838418, 4657.055070650989, 4054.2732063166295, 4969.402416480839, 7227.076889048077, 6194.776371738887, 5688.378248763042, 3123.104127738576, 3753.7867742958233, 4466.228621054474, 5157.657697691226, 6320.530065431492, 5780.6151167952185, 5388.055424119671, 5929.466227790251, 3392.4731643990162, 3393.5941194259735, 3784.6612578215436, 4960.183345194269, 7216.411795162083, 6747.591951218419, 2848.2196214516307, 3099.7694264089896, 3702.723137304061, 4631.665396005074, 6710.791441684653, 6237.251482337494, 5750.0473858681635, 5281.786076375235, 7039.660772702648, 5017.81917283943, 6444.132063319012, 4559.350636967755, 69.88956908343766, 50.67097796462119, 4623.724024004691, 3702.394890002815, 6072.179045619429, 4474.732050443581, 6281.167875169385, 6330.875545131237, 5985.072005387935, 6138.8068684459195, 6022.769903239481, 6456.881613557343, 4502.097590002316, 3707.3457027473287, 5432.158341421412, 3154.525234285161, 4455.1539280648885, 5721.277860865559, 4863.516797696582, 5354.802215084168, 3657.712719351044, 3243.2639534123755, 7290.655820473125, 6501.667048508066, 2194.2423858077136, 2988.696504306041, 4956.339622624732, 4942.829579868285, 4407.555164847782, 4934.100686081383, 6548.3272902123235, 6057.410089610717, 6435.935072357535, 6514.420731528477, 7405.941539348469, 7106.360101491836, 7519.425048746274, 7667.352898925499, 2089.447374718798, 2304.2198506251834, 5240.390531351605, 5834.521910675243, 7393.4050327264595, 6338.595959205776, 5210.711023446533, 6872.224178205688, 4223.885423044091, 4340.617569738155, 5476.472349597035, 5284.626883274962, 6885.1542996918, 7244.649883641999, 8160.668811416568, 8117.932263669538, 7281.251206497372, 6772.152430045638, 3444.0190705650684, 7255.151569371872, 5171.306430677971, 6953.286176684036, 6180.169731020403, 3972.8163063950983, 4745.603331958392, 6330.717624664156, 5302.051519467349, 6157.831749161789, 4444.655846169031, 3718.978537767717, 5576.035775722558, 6203.924030567005, 4415.635152175731, 3430.347681581778, 7379.781079367542, 7942.4563352662535, 5312.6415248827025, 6537.566586627717, 4532.258543559703, 4739.1439795440265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39732993797238314, "mean_inference_ms": 0.9852263903866145, "mean_action_processing_ms": 0.16671422255728735, "mean_env_wait_ms": 0.05375597753945579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376129150390625, "StateBufferConnector_ms": 0.002712726593017578, "ViewRequirementAgentConnector_ms": 0.07264304161071777}, "num_episodes": 22, "episode_return_max": 22118.634660760938, "episode_return_min": 121.38165608327594, "episode_return_mean": 17989.562826349196}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.2078732100273, "num_env_steps_trained_throughput_per_sec": 521.2078732100273, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 7705.551, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7705.51, "sample_time_ms": 781.836, "learn_time_ms": 6912.356, "learn_throughput": 578.674, "synch_weights_time_ms": 10.738}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "training_iteration": 47, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-35-28", "timestamp": 1723235728, "time_this_iter_s": 7.679250955581665, "time_total_s": 358.1942923069, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320727f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 358.1942923069, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 26.927272727272726, "ram_util_percent": 82.83636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0656824113042267, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.872695507574333, "policy_loss": -0.0007029668026401725, "vf_loss": 9.871708610575036, "vf_explained_var": 0.00011818888326170583, "kl": 0.003516580103699453, "entropy": 1.2049493295805795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8272479510866105, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99884585638841, "policy_loss": -0.0024755855219458075, "vf_loss": 9.99526030321916, "vf_explained_var": 3.1930084029833473e-05, "kl": 0.00798175077070482, "entropy": 1.4764759447425604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 22118.634660760938, "episode_reward_min": 121.38165608327594, "episode_reward_mean": 17882.79396227168, "episode_len_mean": 188.83, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18883, "policy_reward_min": {"agent_policy": 0.8211090352170982, "adversary_policy": 50.67097796462119}, "policy_reward_max": {"agent_policy": 12496.794692902464, "adversary_policy": 9047.543143144281}, "policy_reward_mean": {"agent_policy": 7827.745955939125, "adversary_policy": 5027.524003166279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22118.634660760938, 18797.217127298474, 18457.202752092922, 19186.131118597463, 18396.410966209958, 19062.43724103869, 18021.707013811167, 1324.7454490830944, 17113.780108877654, 1473.511528297603, 19644.291545045522, 20228.2035008176, 19322.195951884172, 20951.438779694, 20832.823680718877, 20155.532974967595, 423.95285790395894, 15254.324280391475, 18666.1510126593, 17855.806044380093, 18088.739119934977, 18522.59396853525, 5312.918938808935, 19119.64556186907, 21118.43403601824, 17946.58354041438, 19091.412339221897, 19650.025377496215, 17262.711158605, 18591.403626531654, 19853.897073364213, 19524.639036941488, 17310.962091131853, 17905.15710788452, 20595.845131873546, 16976.394167352377, 17839.665040732347, 20374.55125726939, 19359.230643466704, 19159.95479657041, 18693.857128351065, 121.38165608327594, 17708.86616226018, 18614.713070169615, 20196.51057111455, 20123.27975295772, 20052.63388408671, 17849.481326478268, 17294.949124211376, 18596.67432594973, 18961.100798377178, 16929.304606026948, 20439.71919694933, 16324.31565811343, 18982.82071291328, 18490.45940263582, 20006.16378551108, 20548.60533306407, 20864.49561272473, 20945.250808964727, 16182.0209228168, 19363.2642644128, 20425.52438317136, 19351.98666227174, 18352.53125900079, 19347.958694758807, 20965.471986012333, 21775.456949109237, 20783.53868315047, 17586.154694296074, 19313.44205440891, 18114.951930126004, 18857.597788044797, 19416.13114323434, 17834.921881522365, 19148.837828843345, 17535.81896243499, 21462.7888417513, 19454.77714861369, 18490.612349188257, 19367.239750630582, 16940.96818128599, 1039.6577569571293, 18253.788647144953, 16385.799567632967, 20306.201290429388, 15645.065505903978, 20618.401131516777, 18797.054204123222, 17999.39856890487, 21460.33387031668, 20895.501135328697, 21155.862600823453, 17946.872976059476, 18754.093238105877, 16072.64757133773, 15510.661432828781, 18289.496672680703, 18407.593965889864, 18033.124206602493], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 11, 200, 11, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4846.660318227328, 8843.296515300832, 6275.025596124033, 8787.207882392693, 8796.080093324314, 8672.770120038553, 10121.042613090205, 58.79557457863696, 9980.003177660608, 62.718560744181275, 7663.849186015841, 6566.981115717407, 8379.878081468407, 6201.125860996503, 7234.26269718993, 7688.9730845577815, 8.018702487839475, 10897.577829398351, 9366.532448408427, 7722.875806917453, 9191.006886345009, 8409.344474753201, 726.9697137202741, 9077.997939549208, 6548.349305608519, 9235.255263446725, 6894.933033693001, 7766.870756994278, 10385.820256570556, 8967.517307785954, 7752.751891137533, 8207.117385031595, 10524.89480730688, 9160.312504868674, 6631.8413854930395, 11028.405119491736, 9505.2765074232, 7426.508333247221, 8327.397181223325, 7102.474851028303, 7690.37442806431, 0.8211090352170982, 9382.747248252646, 8067.801974106653, 7584.46715081393, 7999.40087912397, 7572.982367289858, 9640.03803372863, 8708.265548504853, 8420.242537019294, 8742.781785596435, 10028.327933263545, 6647.396327968127, 11141.37676799969, 9083.651510420303, 9148.803551706636, 7400.426405688118, 7598.249529178032, 6352.193971884475, 5758.472861292915, 11788.353697472816, 8288.351822385966, 6693.523391239171, 7269.051460619477, 9788.028266218531, 8586.859461886746, 6835.667802678489, 5496.855874023124, 6730.135046607439, 6886.984054359077, 7188.849447046911, 7961.965892710558, 7781.276831422275, 7956.247874605237, 9671.287497585685, 7368.878022553747, 9689.836128677442, 6140.551427117501, 7604.569037103243, 9219.2098260845, 8050.437519212976, 10035.21938975378, 22.88307336633139, 8670.271716542651, 11191.904678892775, 6008.829126481279, 10315.677280390944, 7174.375518568825, 8643.123138284402, 9285.40339653696, 5839.6609586644045, 6896.855331521468, 6171.254578849699, 9506.257048197343, 8720.470572124099, 8736.2857861181, 12496.794692902464, 9684.952584087077, 9416.105015923178, 8947.809234800585], "policy_adversary_policy_reward": [8224.431199389304, 9047.543143144281, 4970.153032622761, 4983.767579374844, 4315.150425557681, 7867.0267304112185, 5065.120608821569, 5333.802627383299, 4258.284524972972, 5342.046347912652, 5465.2830608677905, 4924.384060132337, 3999.984933840239, 3900.679466880759, 719.0218847265653, 546.9279897778921, 2974.628741321193, 4159.14818989584, 714.9073082476368, 695.8856593057853, 5538.848255927742, 6441.594103101928, 6417.59061910847, 7243.631765991665, 5701.13145560364, 5241.186414812157, 7686.97745932152, 7063.335459375978, 6740.059681099042, 6858.5013024298205, 6166.452322417791, 6300.107567992045, 274.8240099867795, 141.11014542933995, 3234.674841132589, 1122.0716098605512, 4743.805455605775, 4555.813108645087, 6413.372373992736, 3719.55786346991, 3946.603496203974, 4951.128737385943, 4389.529192467451, 5723.720301314589, 1918.8063891135087, 2667.1428359751544, 5049.369417673229, 4992.278204646705, 7313.481863571268, 7256.602866838418, 4657.055070650989, 4054.2732063166295, 4969.402416480839, 7227.076889048077, 6194.776371738887, 5688.378248763042, 3123.104127738576, 3753.7867742958233, 4466.228621054474, 5157.657697691226, 6320.530065431492, 5780.6151167952185, 5388.055424119671, 5929.466227790251, 3392.4731643990162, 3393.5941194259735, 3784.6612578215436, 4960.183345194269, 7216.411795162083, 6747.591951218419, 2848.2196214516307, 3099.7694264089896, 3702.723137304061, 4631.665396005074, 6710.791441684653, 6237.251482337494, 5750.0473858681635, 5281.786076375235, 7039.660772702648, 5017.81917283943, 6444.132063319012, 4559.350636967755, 69.88956908343766, 50.67097796462119, 4623.724024004691, 3702.394890002815, 6072.179045619429, 4474.732050443581, 6281.167875169385, 6330.875545131237, 5985.072005387935, 6138.8068684459195, 6022.769903239481, 6456.881613557343, 4502.097590002316, 3707.3457027473287, 5432.158341421412, 3154.525234285161, 4455.1539280648885, 5721.277860865559, 4863.516797696582, 5354.802215084168, 3657.712719351044, 3243.2639534123755, 7290.655820473125, 6501.667048508066, 2194.2423858077136, 2988.696504306041, 4956.339622624732, 4942.829579868285, 4407.555164847782, 4934.100686081383, 6548.3272902123235, 6057.410089610717, 6435.935072357535, 6514.420731528477, 7405.941539348469, 7106.360101491836, 7519.425048746274, 7667.352898925499, 2089.447374718798, 2304.2198506251834, 5240.390531351605, 5834.521910675243, 7393.4050327264595, 6338.595959205776, 5210.711023446533, 6872.224178205688, 4223.885423044091, 4340.617569738155, 5476.472349597035, 5284.626883274962, 6885.1542996918, 7244.649883641999, 8160.668811416568, 8117.932263669538, 7281.251206497372, 6772.152430045638, 3444.0190705650684, 7255.151569371872, 5171.306430677971, 6953.286176684036, 6180.169731020403, 3972.8163063950983, 4745.603331958392, 6330.717624664156, 5302.051519467349, 6157.831749161789, 4444.655846169031, 3718.978537767717, 5576.035775722558, 6203.924030567005, 4415.635152175731, 3430.347681581778, 7379.781079367542, 7942.4563352662535, 5312.6415248827025, 6537.566586627717, 4532.258543559703, 4739.1439795440265, 5345.123462841322, 5971.678768576291, 4102.817321716589, 2802.9314698156113, 473.97233200789134, 542.8023515829067, 5294.116754032583, 4289.400176569703, 2256.297537809242, 2937.5973509309324, 6894.217587890313, 7403.154576057832, 3826.4583433399976, 1502.9298821730576, 6967.192681582367, 6476.832931365574, 5492.042613851651, 4661.888451987084, 4833.371577875948, 3880.6235944919868, 8082.176734713224, 7538.496176939065, 6992.053526965769, 7006.592276841473, 7019.971451683017, 7964.636570290704, 3805.311271052335, 4635.304656809749, 5208.421761345745, 4825.200904636062, 1930.5119476067778, 5405.849837612847, 1517.2687045572293, 1496.5980353691352, 4402.723063079056, 4201.82102551452, 4291.40052037166, 4700.0884295950955, 3926.381198482039, 5158.933773319871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39788503750192256, "mean_inference_ms": 0.9872650014714998, "mean_action_processing_ms": 0.1669837719171247, "mean_env_wait_ms": 0.053868116498359174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150986671447754, "StateBufferConnector_ms": 0.0026873350143432617, "ViewRequirementAgentConnector_ms": 0.07582545280456543}, "num_episodes": 20, "episode_return_max": 22118.634660760938, "episode_return_min": 121.38165608327594, "episode_return_mean": 17882.79396227168}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 522.2927600483715, "num_env_steps_trained_throughput_per_sec": 522.2927600483715, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 7669.776, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7669.736, "sample_time_ms": 794.836, "learn_time_ms": 6863.482, "learn_throughput": 582.795, "synch_weights_time_ms": 10.824}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 48, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-35-36", "timestamp": 1723235736, "time_this_iter_s": 7.66363787651062, "time_total_s": 365.85793018341064, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32073ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 365.85793018341064, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 27.05454545454545, "ram_util_percent": 82.71818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0612818234338963, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.857693014195357, "policy_loss": -0.0013028825163870813, "vf_loss": 9.857889115368879, "vf_explained_var": 2.7546396961918584e-05, "kl": 0.0046063991365757175, "entropy": 1.175576826441225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8220319074268142, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999969247976939, "policy_loss": -0.001557576167397201, "vf_loss": 9.993973863124847, "vf_explained_var": -2.3547373712062835e-05, "kl": 0.009946307861052142, "entropy": 1.4683315119395652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "env_runners": {"episode_reward_max": 21966.573874165206, "episode_reward_min": 121.38165608327594, "episode_reward_mean": 18027.70229897775, "episode_len_mean": 192.69, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19269, "policy_reward_min": {"agent_policy": 0.8211090352170982, "adversary_policy": 50.67097796462119}, "policy_reward_max": {"agent_policy": 12496.794692902464, "adversary_policy": 8160.668811416568}, "policy_reward_mean": {"agent_policy": 8246.28410521003, "adversary_policy": 4890.709096883861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18522.59396853525, 5312.918938808935, 19119.64556186907, 21118.43403601824, 17946.58354041438, 19091.412339221897, 19650.025377496215, 17262.711158605, 18591.403626531654, 19853.897073364213, 19524.639036941488, 17310.962091131853, 17905.15710788452, 20595.845131873546, 16976.394167352377, 17839.665040732347, 20374.55125726939, 19359.230643466704, 19159.95479657041, 18693.857128351065, 121.38165608327594, 17708.86616226018, 18614.713070169615, 20196.51057111455, 20123.27975295772, 20052.63388408671, 17849.481326478268, 17294.949124211376, 18596.67432594973, 18961.100798377178, 16929.304606026948, 20439.71919694933, 16324.31565811343, 18982.82071291328, 18490.45940263582, 20006.16378551108, 20548.60533306407, 20864.49561272473, 20945.250808964727, 16182.0209228168, 19363.2642644128, 20425.52438317136, 19351.98666227174, 18352.53125900079, 19347.958694758807, 20965.471986012333, 21775.456949109237, 20783.53868315047, 17586.154694296074, 19313.44205440891, 18114.951930126004, 18857.597788044797, 19416.13114323434, 17834.921881522365, 19148.837828843345, 17535.81896243499, 21462.7888417513, 19454.77714861369, 18490.612349188257, 19367.239750630582, 16940.96818128599, 1039.6577569571293, 18253.788647144953, 16385.799567632967, 20306.201290429388, 15645.065505903978, 20618.401131516777, 18797.054204123222, 17999.39856890487, 21460.33387031668, 20895.501135328697, 21155.862600823453, 17946.872976059476, 18754.093238105877, 16072.64757133773, 15510.661432828781, 18289.496672680703, 18407.593965889864, 18033.124206602493, 21966.573874165206, 17244.41999017197, 16536.7846171249, 17873.442294222325, 16373.09768491148, 18328.283750369923, 15651.133609718045, 18053.634136250043, 18665.676577116858, 16954.290778791423, 18565.578761453773, 1435.2530661645746, 20450.630480948555, 17559.335091907295, 16069.971593997305, 18593.230595989175, 17762.28650687831, 18257.477058807857, 18487.8168834004, 19789.439927915402, 15247.71410476759], "episode_lengths": [200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8409.344474753201, 726.9697137202741, 9077.997939549208, 6548.349305608519, 9235.255263446725, 6894.933033693001, 7766.870756994278, 10385.820256570556, 8967.517307785954, 7752.751891137533, 8207.117385031595, 10524.89480730688, 9160.312504868674, 6631.8413854930395, 11028.405119491736, 9505.2765074232, 7426.508333247221, 8327.397181223325, 7102.474851028303, 7690.37442806431, 0.8211090352170982, 9382.747248252646, 8067.801974106653, 7584.46715081393, 7999.40087912397, 7572.982367289858, 9640.03803372863, 8708.265548504853, 8420.242537019294, 8742.781785596435, 10028.327933263545, 6647.396327968127, 11141.37676799969, 9083.651510420303, 9148.803551706636, 7400.426405688118, 7598.249529178032, 6352.193971884475, 5758.472861292915, 11788.353697472816, 8288.351822385966, 6693.523391239171, 7269.051460619477, 9788.028266218531, 8586.859461886746, 6835.667802678489, 5496.855874023124, 6730.135046607439, 6886.984054359077, 7188.849447046911, 7961.965892710558, 7781.276831422275, 7956.247874605237, 9671.287497585685, 7368.878022553747, 9689.836128677442, 6140.551427117501, 7604.569037103243, 9219.2098260845, 8050.437519212976, 10035.21938975378, 22.88307336633139, 8670.271716542651, 11191.904678892775, 6008.829126481279, 10315.677280390944, 7174.375518568825, 8643.123138284402, 9285.40339653696, 5839.6609586644045, 6896.855331521468, 6171.254578849699, 9506.257048197343, 8720.470572124099, 8736.2857861181, 12496.794692902464, 9684.952584087077, 9416.105015923178, 8947.809234800585, 6248.136255351428, 9738.793278482239, 10950.73778424666, 9304.464720712751, 11475.066129573393, 8596.84298604056, 11832.738364942767, 9208.540884532254, 8040.780666575531, 10660.101592015644, 9375.232932098877, 59.93858997248683, 7042.503032925798, 9895.921134351327, 10205.051474822923, 8731.42778211571, 10130.684083898772, 8829.02462118204, 8410.084904056905, 8068.655696236164, 12413.770163940673], "policy_adversary_policy_reward": [4389.529192467451, 5723.720301314589, 1918.8063891135087, 2667.1428359751544, 5049.369417673229, 4992.278204646705, 7313.481863571268, 7256.602866838418, 4657.055070650989, 4054.2732063166295, 4969.402416480839, 7227.076889048077, 6194.776371738887, 5688.378248763042, 3123.104127738576, 3753.7867742958233, 4466.228621054474, 5157.657697691226, 6320.530065431492, 5780.6151167952185, 5388.055424119671, 5929.466227790251, 3392.4731643990162, 3393.5941194259735, 3784.6612578215436, 4960.183345194269, 7216.411795162083, 6747.591951218419, 2848.2196214516307, 3099.7694264089896, 3702.723137304061, 4631.665396005074, 6710.791441684653, 6237.251482337494, 5750.0473858681635, 5281.786076375235, 7039.660772702648, 5017.81917283943, 6444.132063319012, 4559.350636967755, 69.88956908343766, 50.67097796462119, 4623.724024004691, 3702.394890002815, 6072.179045619429, 4474.732050443581, 6281.167875169385, 6330.875545131237, 5985.072005387935, 6138.8068684459195, 6022.769903239481, 6456.881613557343, 4502.097590002316, 3707.3457027473287, 5432.158341421412, 3154.525234285161, 4455.1539280648885, 5721.277860865559, 4863.516797696582, 5354.802215084168, 3657.712719351044, 3243.2639534123755, 7290.655820473125, 6501.667048508066, 2194.2423858077136, 2988.696504306041, 4956.339622624732, 4942.829579868285, 4407.555164847782, 4934.100686081383, 6548.3272902123235, 6057.410089610717, 6435.935072357535, 6514.420731528477, 7405.941539348469, 7106.360101491836, 7519.425048746274, 7667.352898925499, 2089.447374718798, 2304.2198506251834, 5240.390531351605, 5834.521910675243, 7393.4050327264595, 6338.595959205776, 5210.711023446533, 6872.224178205688, 4223.885423044091, 4340.617569738155, 5476.472349597035, 5284.626883274962, 6885.1542996918, 7244.649883641999, 8160.668811416568, 8117.932263669538, 7281.251206497372, 6772.152430045638, 3444.0190705650684, 7255.151569371872, 5171.306430677971, 6953.286176684036, 6180.169731020403, 3972.8163063950983, 4745.603331958392, 6330.717624664156, 5302.051519467349, 6157.831749161789, 4444.655846169031, 3718.978537767717, 5576.035775722558, 6203.924030567005, 4415.635152175731, 3430.347681581778, 7379.781079367542, 7942.4563352662535, 5312.6415248827025, 6537.566586627717, 4532.258543559703, 4739.1439795440265, 5345.123462841322, 5971.678768576291, 4102.817321716589, 2802.9314698156113, 473.97233200789134, 542.8023515829067, 5294.116754032583, 4289.400176569703, 2256.297537809242, 2937.5973509309324, 6894.217587890313, 7403.154576057832, 3826.4583433399976, 1502.9298821730576, 6967.192681582367, 6476.832931365574, 5492.042613851651, 4661.888451987084, 4833.371577875948, 3880.6235944919868, 8082.176734713224, 7538.496176939065, 6992.053526965769, 7006.592276841473, 7019.971451683017, 7964.636570290704, 3805.311271052335, 4635.304656809749, 5208.421761345745, 4825.200904636062, 1930.5119476067778, 5405.849837612847, 1517.2687045572293, 1496.5980353691352, 4402.723063079056, 4201.82102551452, 4291.40052037166, 4700.0884295950955, 3926.381198482039, 5158.933773319871, 7851.8772498938515, 7866.560368919947, 3322.763087595594, 4182.863624094124, 2992.2709792113537, 2593.7758536668757, 4834.279173691854, 3734.698399817665, 2272.8328677367936, 2625.198687601307, 5016.239389278105, 4715.201375051293, 2141.5396399472193, 1676.8556048280668, 3936.90502406689, 4908.188227650922, 5660.532560027672, 4964.363350513613, 2831.4167375248703, 3462.7724492509183, 4755.616486140627, 4434.729343214213, 586.7249287407178, 788.5895474513702, 6308.494857217606, 7099.632590805159, 4109.422726820394, 3553.991230735555, 1927.8359702663663, 3937.0841489080262, 4490.083848110947, 5371.718965762522, 4000.9244604352784, 3630.67796254431, 4143.183549934022, 5285.268887691778, 4361.939011362404, 5715.792967981135, 6070.045999115844, 5650.738232563371, 1119.6750746641783, 1714.268866162793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39864945718007094, "mean_inference_ms": 0.9900714932749, "mean_action_processing_ms": 0.16731864120946027, "mean_env_wait_ms": 0.05402983952428408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004059791564941406, "StateBufferConnector_ms": 0.0030243396759033203, "ViewRequirementAgentConnector_ms": 0.07622766494750977}, "num_episodes": 21, "episode_return_max": 21966.573874165206, "episode_return_min": 121.38165608327594, "episode_return_mean": 18027.70229897775}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.55529184852884, "num_env_steps_trained_throughput_per_sec": 464.55529184852884, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 7795.459, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7795.418, "sample_time_ms": 807.834, "learn_time_ms": 6976.116, "learn_throughput": 573.385, "synch_weights_time_ms": 10.824}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "training_iteration": 49, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-35-44", "timestamp": 1723235744, "time_this_iter_s": 8.637050151824951, "time_total_s": 374.4949803352356, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 374.4949803352356, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.625, "ram_util_percent": 83.18333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.985005390218326, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.901983594137524, "policy_loss": -0.0023866589617220655, "vf_loss": 9.903406203739227, "vf_explained_var": 0.00046751007201179624, "kl": 0.008024701590664566, "entropy": 1.1341249021903548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7926952586354067, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00231386522452, "policy_loss": -0.00409865139372414, "vf_loss": 10.0, "vf_explained_var": 2.8544229765733085e-05, "kl": 0.008444480280256053, "entropy": 1.472011560574174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 21966.573874165206, "episode_reward_min": 121.38165608327594, "episode_reward_mean": 17962.01564518126, "episode_len_mean": 194.21, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19421, "policy_reward_min": {"agent_policy": 0.8211090352170982, "adversary_policy": 50.67097796462119}, "policy_reward_max": {"agent_policy": 12496.794692902464, "adversary_policy": 8160.668811416568}, "policy_reward_mean": {"agent_policy": 8431.766082890515, "adversary_policy": 4765.124781145373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18693.857128351065, 121.38165608327594, 17708.86616226018, 18614.713070169615, 20196.51057111455, 20123.27975295772, 20052.63388408671, 17849.481326478268, 17294.949124211376, 18596.67432594973, 18961.100798377178, 16929.304606026948, 20439.71919694933, 16324.31565811343, 18982.82071291328, 18490.45940263582, 20006.16378551108, 20548.60533306407, 20864.49561272473, 20945.250808964727, 16182.0209228168, 19363.2642644128, 20425.52438317136, 19351.98666227174, 18352.53125900079, 19347.958694758807, 20965.471986012333, 21775.456949109237, 20783.53868315047, 17586.154694296074, 19313.44205440891, 18114.951930126004, 18857.597788044797, 19416.13114323434, 17834.921881522365, 19148.837828843345, 17535.81896243499, 21462.7888417513, 19454.77714861369, 18490.612349188257, 19367.239750630582, 16940.96818128599, 1039.6577569571293, 18253.788647144953, 16385.799567632967, 20306.201290429388, 15645.065505903978, 20618.401131516777, 18797.054204123222, 17999.39856890487, 21460.33387031668, 20895.501135328697, 21155.862600823453, 17946.872976059476, 18754.093238105877, 16072.64757133773, 15510.661432828781, 18289.496672680703, 18407.593965889864, 18033.124206602493, 21966.573874165206, 17244.41999017197, 16536.7846171249, 17873.442294222325, 16373.09768491148, 18328.283750369923, 15651.133609718045, 18053.634136250043, 18665.676577116858, 16954.290778791423, 18565.578761453773, 1435.2530661645746, 20450.630480948555, 17559.335091907295, 16069.971593997305, 18593.230595989175, 17762.28650687831, 18257.477058807857, 18487.8168834004, 19789.439927915402, 15247.71410476759, 19243.357547460975, 18014.33323853115, 18962.667890481138, 18964.274314541846, 16221.524651887876, 19694.300039641104, 17059.99007588097, 16286.810449067769, 15973.919551404177, 16994.161231938928, 16637.88678275617, 18806.03031111062, 18805.012957385883, 18777.521970318045, 17049.413697163833, 19104.31760889506, 18213.99171705129, 15144.902137455374, 18992.94334146661], "episode_lengths": [200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7690.37442806431, 0.8211090352170982, 9382.747248252646, 8067.801974106653, 7584.46715081393, 7999.40087912397, 7572.982367289858, 9640.03803372863, 8708.265548504853, 8420.242537019294, 8742.781785596435, 10028.327933263545, 6647.396327968127, 11141.37676799969, 9083.651510420303, 9148.803551706636, 7400.426405688118, 7598.249529178032, 6352.193971884475, 5758.472861292915, 11788.353697472816, 8288.351822385966, 6693.523391239171, 7269.051460619477, 9788.028266218531, 8586.859461886746, 6835.667802678489, 5496.855874023124, 6730.135046607439, 6886.984054359077, 7188.849447046911, 7961.965892710558, 7781.276831422275, 7956.247874605237, 9671.287497585685, 7368.878022553747, 9689.836128677442, 6140.551427117501, 7604.569037103243, 9219.2098260845, 8050.437519212976, 10035.21938975378, 22.88307336633139, 8670.271716542651, 11191.904678892775, 6008.829126481279, 10315.677280390944, 7174.375518568825, 8643.123138284402, 9285.40339653696, 5839.6609586644045, 6896.855331521468, 6171.254578849699, 9506.257048197343, 8720.470572124099, 8736.2857861181, 12496.794692902464, 9684.952584087077, 9416.105015923178, 8947.809234800585, 6248.136255351428, 9738.793278482239, 10950.73778424666, 9304.464720712751, 11475.066129573393, 8596.84298604056, 11832.738364942767, 9208.540884532254, 8040.780666575531, 10660.101592015644, 9375.232932098877, 59.93858997248683, 7042.503032925798, 9895.921134351327, 10205.051474822923, 8731.42778211571, 10130.684083898772, 8829.02462118204, 8410.084904056905, 8068.655696236164, 12413.770163940673, 7649.198715598681, 9547.892186704066, 8508.36689246954, 8832.429002462706, 10996.306024413487, 8113.04572820243, 11014.985547642182, 10995.58058832007, 11960.338080387934, 8978.83323288872, 9075.782944135351, 8029.646824034997, 7626.784230351094, 9099.445975788889, 9593.601854065899, 7422.620219431398, 7371.056453633542, 9190.379301052555, 8221.941984838237], "policy_adversary_policy_reward": [6444.132063319012, 4559.350636967755, 69.88956908343766, 50.67097796462119, 4623.724024004691, 3702.394890002815, 6072.179045619429, 4474.732050443581, 6281.167875169385, 6330.875545131237, 5985.072005387935, 6138.8068684459195, 6022.769903239481, 6456.881613557343, 4502.097590002316, 3707.3457027473287, 5432.158341421412, 3154.525234285161, 4455.1539280648885, 5721.277860865559, 4863.516797696582, 5354.802215084168, 3657.712719351044, 3243.2639534123755, 7290.655820473125, 6501.667048508066, 2194.2423858077136, 2988.696504306041, 4956.339622624732, 4942.829579868285, 4407.555164847782, 4934.100686081383, 6548.3272902123235, 6057.410089610717, 6435.935072357535, 6514.420731528477, 7405.941539348469, 7106.360101491836, 7519.425048746274, 7667.352898925499, 2089.447374718798, 2304.2198506251834, 5240.390531351605, 5834.521910675243, 7393.4050327264595, 6338.595959205776, 5210.711023446533, 6872.224178205688, 4223.885423044091, 4340.617569738155, 5476.472349597035, 5284.626883274962, 6885.1542996918, 7244.649883641999, 8160.668811416568, 8117.932263669538, 7281.251206497372, 6772.152430045638, 3444.0190705650684, 7255.151569371872, 5171.306430677971, 6953.286176684036, 6180.169731020403, 3972.8163063950983, 4745.603331958392, 6330.717624664156, 5302.051519467349, 6157.831749161789, 4444.655846169031, 3718.978537767717, 5576.035775722558, 6203.924030567005, 4415.635152175731, 3430.347681581778, 7379.781079367542, 7942.4563352662535, 5312.6415248827025, 6537.566586627717, 4532.258543559703, 4739.1439795440265, 5345.123462841322, 5971.678768576291, 4102.817321716589, 2802.9314698156113, 473.97233200789134, 542.8023515829067, 5294.116754032583, 4289.400176569703, 2256.297537809242, 2937.5973509309324, 6894.217587890313, 7403.154576057832, 3826.4583433399976, 1502.9298821730576, 6967.192681582367, 6476.832931365574, 5492.042613851651, 4661.888451987084, 4833.371577875948, 3880.6235944919868, 8082.176734713224, 7538.496176939065, 6992.053526965769, 7006.592276841473, 7019.971451683017, 7964.636570290704, 3805.311271052335, 4635.304656809749, 5208.421761345745, 4825.200904636062, 1930.5119476067778, 5405.849837612847, 1517.2687045572293, 1496.5980353691352, 4402.723063079056, 4201.82102551452, 4291.40052037166, 4700.0884295950955, 3926.381198482039, 5158.933773319871, 7851.8772498938515, 7866.560368919947, 3322.763087595594, 4182.863624094124, 2992.2709792113537, 2593.7758536668757, 4834.279173691854, 3734.698399817665, 2272.8328677367936, 2625.198687601307, 5016.239389278105, 4715.201375051293, 2141.5396399472193, 1676.8556048280668, 3936.90502406689, 4908.188227650922, 5660.532560027672, 4964.363350513613, 2831.4167375248703, 3462.7724492509183, 4755.616486140627, 4434.729343214213, 586.7249287407178, 788.5895474513702, 6308.494857217606, 7099.632590805159, 4109.422726820394, 3553.991230735555, 1927.8359702663663, 3937.0841489080262, 4490.083848110947, 5371.718965762522, 4000.9244604352784, 3630.67796254431, 4143.183549934022, 5285.268887691778, 4361.939011362404, 5715.792967981135, 6070.045999115844, 5650.738232563371, 1119.6750746641783, 1714.268866162793, 6384.795924335163, 5209.362907527062, 4564.612164852986, 3901.8288869741186, 5538.990976627501, 4915.310021384045, 4836.568983483279, 5295.276328595798, 2256.6855348737863, 2968.5330926005618, 5731.808688752682, 5849.4456226859975, 2956.1514683499418, 3088.8530598888146, 2146.021107357311, 3145.208753390424, 1849.9898959857617, 2163.5915750304644, 5163.302390842239, 2852.0256082079386, 2505.782352226603, 5056.321486394214, 5429.471516152949, 5346.911970922689, 4718.72699878127, 6459.501728253526, 5028.646828329094, 4649.429166200085, 4548.533769665043, 2907.278073432846, 5274.154885631619, 6407.542503832043, 6771.079170097415, 4071.8560933203294, 1002.7665137244304, 4951.7563226784005, 5088.825180613937, 5682.17617601441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3994378648883549, "mean_inference_ms": 0.9928325992482587, "mean_action_processing_ms": 0.1677729145916772, "mean_env_wait_ms": 0.0540986201472142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004125475883483887, "StateBufferConnector_ms": 0.0030412673950195312, "ViewRequirementAgentConnector_ms": 0.07539784908294678}, "num_episodes": 19, "episode_return_max": 21966.573874165206, "episode_return_min": 121.38165608327594, "episode_return_mean": 17962.01564518126}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.1135541324138, "num_env_steps_trained_throughput_per_sec": 475.1135541324138, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 7905.842, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7905.802, "sample_time_ms": 816.888, "learn_time_ms": 7077.46, "learn_throughput": 565.175, "synch_weights_time_ms": 10.855}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 50, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-35-53", "timestamp": 1723235753, "time_this_iter_s": 8.423878908157349, "time_total_s": 382.91885924339294, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 382.91885924339294, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.516666666666666, "ram_util_percent": 83.18333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9514216959634155, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.944291218247994, "policy_loss": -0.0030364735786206822, "vf_loss": 9.946225974168726, "vf_explained_var": 0.0004628578506449543, "kl": 0.009170358704166517, "entropy": 1.1162276288188955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7967485004259894, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00669440527757, "policy_loss": -3.875201994863649e-05, "vf_loss": 10.0, "vf_explained_var": 8.30690066019694e-06, "kl": 0.008866671359767982, "entropy": 1.4620799604803323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "env_runners": {"episode_reward_max": 21966.573874165206, "episode_reward_min": 1039.6577569571293, "episode_reward_mean": 17941.86778347183, "episode_len_mean": 196.2, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19620, "policy_reward_min": {"agent_policy": 22.88307336633139, "adversary_policy": 473.97233200789134}, "policy_reward_max": {"agent_policy": 12496.794692902464, "adversary_policy": 8160.668811416568}, "policy_reward_mean": {"agent_policy": 8585.670008921514, "adversary_policy": 4678.098887275156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19363.2642644128, 20425.52438317136, 19351.98666227174, 18352.53125900079, 19347.958694758807, 20965.471986012333, 21775.456949109237, 20783.53868315047, 17586.154694296074, 19313.44205440891, 18114.951930126004, 18857.597788044797, 19416.13114323434, 17834.921881522365, 19148.837828843345, 17535.81896243499, 21462.7888417513, 19454.77714861369, 18490.612349188257, 19367.239750630582, 16940.96818128599, 1039.6577569571293, 18253.788647144953, 16385.799567632967, 20306.201290429388, 15645.065505903978, 20618.401131516777, 18797.054204123222, 17999.39856890487, 21460.33387031668, 20895.501135328697, 21155.862600823453, 17946.872976059476, 18754.093238105877, 16072.64757133773, 15510.661432828781, 18289.496672680703, 18407.593965889864, 18033.124206602493, 21966.573874165206, 17244.41999017197, 16536.7846171249, 17873.442294222325, 16373.09768491148, 18328.283750369923, 15651.133609718045, 18053.634136250043, 18665.676577116858, 16954.290778791423, 18565.578761453773, 1435.2530661645746, 20450.630480948555, 17559.335091907295, 16069.971593997305, 18593.230595989175, 17762.28650687831, 18257.477058807857, 18487.8168834004, 19789.439927915402, 15247.71410476759, 19243.357547460975, 18014.33323853115, 18962.667890481138, 18964.274314541846, 16221.524651887876, 19694.300039641104, 17059.99007588097, 16286.810449067769, 15973.919551404177, 16994.161231938928, 16637.88678275617, 18806.03031111062, 18805.012957385883, 18777.521970318045, 17049.413697163833, 19104.31760889506, 18213.99171705129, 15144.902137455374, 18992.94334146661, 16387.495294627308, 16379.631072784492, 17691.997585287674, 16844.344293829643, 18281.776306494477, 17969.588026067922, 17912.81545604911, 17431.74670231658, 17002.977155353543, 17410.588193509466, 18819.438781172503, 17648.08853266691, 16798.37011962743, 17064.421630689798, 18588.05623137157, 19607.70872154612, 20126.651282129154, 18982.220441961683, 19204.226355934396, 16659.874988304586, 19099.80049709207], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8288.351822385966, 6693.523391239171, 7269.051460619477, 9788.028266218531, 8586.859461886746, 6835.667802678489, 5496.855874023124, 6730.135046607439, 6886.984054359077, 7188.849447046911, 7961.965892710558, 7781.276831422275, 7956.247874605237, 9671.287497585685, 7368.878022553747, 9689.836128677442, 6140.551427117501, 7604.569037103243, 9219.2098260845, 8050.437519212976, 10035.21938975378, 22.88307336633139, 8670.271716542651, 11191.904678892775, 6008.829126481279, 10315.677280390944, 7174.375518568825, 8643.123138284402, 9285.40339653696, 5839.6609586644045, 6896.855331521468, 6171.254578849699, 9506.257048197343, 8720.470572124099, 8736.2857861181, 12496.794692902464, 9684.952584087077, 9416.105015923178, 8947.809234800585, 6248.136255351428, 9738.793278482239, 10950.73778424666, 9304.464720712751, 11475.066129573393, 8596.84298604056, 11832.738364942767, 9208.540884532254, 8040.780666575531, 10660.101592015644, 9375.232932098877, 59.93858997248683, 7042.503032925798, 9895.921134351327, 10205.051474822923, 8731.42778211571, 10130.684083898772, 8829.02462118204, 8410.084904056905, 8068.655696236164, 12413.770163940673, 7649.198715598681, 9547.892186704066, 8508.36689246954, 8832.429002462706, 10996.306024413487, 8113.04572820243, 11014.985547642182, 10995.58058832007, 11960.338080387934, 8978.83323288872, 9075.782944135351, 8029.646824034997, 7626.784230351094, 9099.445975788889, 9593.601854065899, 7422.620219431398, 7371.056453633542, 9190.379301052555, 8221.941984838237, 8584.477289202423, 10601.824069190037, 8915.050980657707, 8384.149557912051, 8842.91607289031, 9596.535080125528, 7684.161067385059, 8494.913205282106, 7768.961811814959, 7976.508420597545, 9167.92850971014, 8417.38101677343, 11284.931617680575, 9781.827779920764, 9400.566818504105, 7932.0887470379585, 7420.450935386566, 8485.795581849574, 7548.500626652841, 9524.097379657644, 8334.501653278912], "policy_adversary_policy_reward": [5240.390531351605, 5834.521910675243, 7393.4050327264595, 6338.595959205776, 5210.711023446533, 6872.224178205688, 4223.885423044091, 4340.617569738155, 5476.472349597035, 5284.626883274962, 6885.1542996918, 7244.649883641999, 8160.668811416568, 8117.932263669538, 7281.251206497372, 6772.152430045638, 3444.0190705650684, 7255.151569371872, 5171.306430677971, 6953.286176684036, 6180.169731020403, 3972.8163063950983, 4745.603331958392, 6330.717624664156, 5302.051519467349, 6157.831749161789, 4444.655846169031, 3718.978537767717, 5576.035775722558, 6203.924030567005, 4415.635152175731, 3430.347681581778, 7379.781079367542, 7942.4563352662535, 5312.6415248827025, 6537.566586627717, 4532.258543559703, 4739.1439795440265, 5345.123462841322, 5971.678768576291, 4102.817321716589, 2802.9314698156113, 473.97233200789134, 542.8023515829067, 5294.116754032583, 4289.400176569703, 2256.297537809242, 2937.5973509309324, 6894.217587890313, 7403.154576057832, 3826.4583433399976, 1502.9298821730576, 6967.192681582367, 6476.832931365574, 5492.042613851651, 4661.888451987084, 4833.371577875948, 3880.6235944919868, 8082.176734713224, 7538.496176939065, 6992.053526965769, 7006.592276841473, 7019.971451683017, 7964.636570290704, 3805.311271052335, 4635.304656809749, 5208.421761345745, 4825.200904636062, 1930.5119476067778, 5405.849837612847, 1517.2687045572293, 1496.5980353691352, 4402.723063079056, 4201.82102551452, 4291.40052037166, 4700.0884295950955, 3926.381198482039, 5158.933773319871, 7851.8772498938515, 7866.560368919947, 3322.763087595594, 4182.863624094124, 2992.2709792113537, 2593.7758536668757, 4834.279173691854, 3734.698399817665, 2272.8328677367936, 2625.198687601307, 5016.239389278105, 4715.201375051293, 2141.5396399472193, 1676.8556048280668, 3936.90502406689, 4908.188227650922, 5660.532560027672, 4964.363350513613, 2831.4167375248703, 3462.7724492509183, 4755.616486140627, 4434.729343214213, 586.7249287407178, 788.5895474513702, 6308.494857217606, 7099.632590805159, 4109.422726820394, 3553.991230735555, 1927.8359702663663, 3937.0841489080262, 4490.083848110947, 5371.718965762522, 4000.9244604352784, 3630.67796254431, 4143.183549934022, 5285.268887691778, 4361.939011362404, 5715.792967981135, 6070.045999115844, 5650.738232563371, 1119.6750746641783, 1714.268866162793, 6384.795924335163, 5209.362907527062, 4564.612164852986, 3901.8288869741186, 5538.990976627501, 4915.310021384045, 4836.568983483279, 5295.276328595798, 2256.6855348737863, 2968.5330926005618, 5731.808688752682, 5849.4456226859975, 2956.1514683499418, 3088.8530598888146, 2146.021107357311, 3145.208753390424, 1849.9898959857617, 2163.5915750304644, 5163.302390842239, 2852.0256082079386, 2505.782352226603, 5056.321486394214, 5429.471516152949, 5346.911970922689, 4718.72699878127, 6459.501728253526, 5028.646828329094, 4649.429166200085, 4548.533769665043, 2907.278073432846, 5274.154885631619, 6407.542503832043, 6771.079170097415, 4071.8560933203294, 1002.7665137244304, 4951.7563226784005, 5088.825180613937, 5682.17617601441, 5557.658334528526, 2245.359670896378, 3540.3115545409205, 2237.495449053519, 5110.622947922675, 3666.323656707306, 2702.2086700987134, 5757.986065818897, 5248.39122996153, 4190.469003642643, 3833.885055674481, 4539.167890267964, 3790.9909397270685, 6437.663448936997, 3289.611078585653, 5647.222418448831, 2893.2428985876227, 6340.772444951033, 3268.452569778461, 6165.6272031334165, 4708.752426340536, 4942.757845121796, 5724.754606957507, 3505.952908935914, 2853.3894786770766, 2660.049023269783, 4343.839024294368, 2938.7548264746492, 4454.522196107329, 4732.967216760158, 6205.819559918945, 5469.80041458921, 6631.0015424035955, 6075.198804338934, 5654.639314545734, 4841.785545566407, 6400.6088823971695, 5255.116846884323, 4618.038244073308, 2517.739364573714, 4976.481025682789, 5788.81781813036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998734222200373, "mean_inference_ms": 0.993833347255227, "mean_action_processing_ms": 0.16781661681030788, "mean_env_wait_ms": 0.0541712065364022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039899349212646484, "StateBufferConnector_ms": 0.0029363632202148438, "ViewRequirementAgentConnector_ms": 0.07214510440826416}, "num_episodes": 21, "episode_return_max": 21966.573874165206, "episode_return_min": 1039.6577569571293, "episode_return_mean": 17941.86778347183}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.28879440193106, "num_env_steps_trained_throughput_per_sec": 494.28879440193106, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 7981.647, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7981.607, "sample_time_ms": 819.687, "learn_time_ms": 7150.46, "learn_throughput": 559.405, "synch_weights_time_ms": 10.859}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "training_iteration": 51, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-01", "timestamp": 1723235761, "time_this_iter_s": 8.097040891647339, "time_total_s": 391.0159001350403, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 391.0159001350403, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 29.61666666666667, "ram_util_percent": 83.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3830244965890728, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.882839885085978, "policy_loss": -0.001276153322585203, "vf_loss": 9.883363696002455, "vf_explained_var": 0.000666298058928636, "kl": 0.006262544296785361, "entropy": 1.0797579474550076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7928213087997089, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002669750650723, "policy_loss": -0.0021960129767345884, "vf_loss": 9.99470337331295, "vf_explained_var": 1.5464362998803457e-05, "kl": 0.01338259081336825, "entropy": 1.4660196982324123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 21966.573874165206, "episode_reward_min": 1435.2530661645746, "episode_reward_mean": 17665.555630133127, "episode_len_mean": 196.32, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19632, "policy_reward_min": {"agent_policy": 59.93858997248683, "adversary_policy": 586.7249287407178}, "policy_reward_max": {"agent_policy": 12496.794692902464, "adversary_policy": 8082.176734713224}, "policy_reward_mean": {"agent_policy": 8844.046306012453, "adversary_policy": 4410.754662060336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18253.788647144953, 16385.799567632967, 20306.201290429388, 15645.065505903978, 20618.401131516777, 18797.054204123222, 17999.39856890487, 21460.33387031668, 20895.501135328697, 21155.862600823453, 17946.872976059476, 18754.093238105877, 16072.64757133773, 15510.661432828781, 18289.496672680703, 18407.593965889864, 18033.124206602493, 21966.573874165206, 17244.41999017197, 16536.7846171249, 17873.442294222325, 16373.09768491148, 18328.283750369923, 15651.133609718045, 18053.634136250043, 18665.676577116858, 16954.290778791423, 18565.578761453773, 1435.2530661645746, 20450.630480948555, 17559.335091907295, 16069.971593997305, 18593.230595989175, 17762.28650687831, 18257.477058807857, 18487.8168834004, 19789.439927915402, 15247.71410476759, 19243.357547460975, 18014.33323853115, 18962.667890481138, 18964.274314541846, 16221.524651887876, 19694.300039641104, 17059.99007588097, 16286.810449067769, 15973.919551404177, 16994.161231938928, 16637.88678275617, 18806.03031111062, 18805.012957385883, 18777.521970318045, 17049.413697163833, 19104.31760889506, 18213.99171705129, 15144.902137455374, 18992.94334146661, 16387.495294627308, 16379.631072784492, 17691.997585287674, 16844.344293829643, 18281.776306494477, 17969.588026067922, 17912.81545604911, 17431.74670231658, 17002.977155353543, 17410.588193509466, 18819.438781172503, 17648.08853266691, 16798.37011962743, 17064.421630689798, 18588.05623137157, 19607.70872154612, 20126.651282129154, 18982.220441961683, 19204.226355934396, 16659.874988304586, 19099.80049709207, 18048.97810020981, 17771.27694649779, 18109.75522464386, 16908.593193966037, 17187.008219055584, 18877.35150995434, 17543.970438785025, 18523.12891374787, 17771.855357970875, 18614.242166693628, 17695.40497564192, 18347.043228313767, 17139.040374871824, 18655.616231706823, 15265.701748972713, 18409.631448052052, 18384.75993047417, 2225.0228635076232, 17352.400415080847, 18433.216367896574, 17944.291400809627, 18090.128802502317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200], "policy_agent_policy_reward": [8670.271716542651, 11191.904678892775, 6008.829126481279, 10315.677280390944, 7174.375518568825, 8643.123138284402, 9285.40339653696, 5839.6609586644045, 6896.855331521468, 6171.254578849699, 9506.257048197343, 8720.470572124099, 8736.2857861181, 12496.794692902464, 9684.952584087077, 9416.105015923178, 8947.809234800585, 6248.136255351428, 9738.793278482239, 10950.73778424666, 9304.464720712751, 11475.066129573393, 8596.84298604056, 11832.738364942767, 9208.540884532254, 8040.780666575531, 10660.101592015644, 9375.232932098877, 59.93858997248683, 7042.503032925798, 9895.921134351327, 10205.051474822923, 8731.42778211571, 10130.684083898772, 8829.02462118204, 8410.084904056905, 8068.655696236164, 12413.770163940673, 7649.198715598681, 9547.892186704066, 8508.36689246954, 8832.429002462706, 10996.306024413487, 8113.04572820243, 11014.985547642182, 10995.58058832007, 11960.338080387934, 8978.83323288872, 9075.782944135351, 8029.646824034997, 7626.784230351094, 9099.445975788889, 9593.601854065899, 7422.620219431398, 7371.056453633542, 9190.379301052555, 8221.941984838237, 8584.477289202423, 10601.824069190037, 8915.050980657707, 8384.149557912051, 8842.91607289031, 9596.535080125528, 7684.161067385059, 8494.913205282106, 7768.961811814959, 7976.508420597545, 9167.92850971014, 8417.38101677343, 11284.931617680575, 9781.827779920764, 9400.566818504105, 7932.0887470379585, 7420.450935386566, 8485.795581849574, 7548.500626652841, 9524.097379657644, 8334.501653278912, 9920.40017302195, 9299.835209340981, 8309.532116996083, 7487.90482007245, 10717.107312780288, 8076.318191373125, 10006.30148462785, 7318.919447213754, 8683.480538177475, 8450.296777418862, 8986.441734738004, 9202.181558314043, 8870.13336633044, 9454.76945737474, 12444.564646854773, 9006.438013063536, 9171.777629667282, 197.90273005878106, 8860.091756368003, 9080.334961242224, 8590.66964884236, 8968.89728247516], "policy_adversary_policy_reward": [5294.116754032583, 4289.400176569703, 2256.297537809242, 2937.5973509309324, 6894.217587890313, 7403.154576057832, 3826.4583433399976, 1502.9298821730576, 6967.192681582367, 6476.832931365574, 5492.042613851651, 4661.888451987084, 4833.371577875948, 3880.6235944919868, 8082.176734713224, 7538.496176939065, 6992.053526965769, 7006.592276841473, 7019.971451683017, 7964.636570290704, 3805.311271052335, 4635.304656809749, 5208.421761345745, 4825.200904636062, 1930.5119476067778, 5405.849837612847, 1517.2687045572293, 1496.5980353691352, 4402.723063079056, 4201.82102551452, 4291.40052037166, 4700.0884295950955, 3926.381198482039, 5158.933773319871, 7851.8772498938515, 7866.560368919947, 3322.763087595594, 4182.863624094124, 2992.2709792113537, 2593.7758536668757, 4834.279173691854, 3734.698399817665, 2272.8328677367936, 2625.198687601307, 5016.239389278105, 4715.201375051293, 2141.5396399472193, 1676.8556048280668, 3936.90502406689, 4908.188227650922, 5660.532560027672, 4964.363350513613, 2831.4167375248703, 3462.7724492509183, 4755.616486140627, 4434.729343214213, 586.7249287407178, 788.5895474513702, 6308.494857217606, 7099.632590805159, 4109.422726820394, 3553.991230735555, 1927.8359702663663, 3937.0841489080262, 4490.083848110947, 5371.718965762522, 4000.9244604352784, 3630.67796254431, 4143.183549934022, 5285.268887691778, 4361.939011362404, 5715.792967981135, 6070.045999115844, 5650.738232563371, 1119.6750746641783, 1714.268866162793, 6384.795924335163, 5209.362907527062, 4564.612164852986, 3901.8288869741186, 5538.990976627501, 4915.310021384045, 4836.568983483279, 5295.276328595798, 2256.6855348737863, 2968.5330926005618, 5731.808688752682, 5849.4456226859975, 2956.1514683499418, 3088.8530598888146, 2146.021107357311, 3145.208753390424, 1849.9898959857617, 2163.5915750304644, 5163.302390842239, 2852.0256082079386, 2505.782352226603, 5056.321486394214, 5429.471516152949, 5346.911970922689, 4718.72699878127, 6459.501728253526, 5028.646828329094, 4649.429166200085, 4548.533769665043, 2907.278073432846, 5274.154885631619, 6407.542503832043, 6771.079170097415, 4071.8560933203294, 1002.7665137244304, 4951.7563226784005, 5088.825180613937, 5682.17617601441, 5557.658334528526, 2245.359670896378, 3540.3115545409205, 2237.495449053519, 5110.622947922675, 3666.323656707306, 2702.2086700987134, 5757.986065818897, 5248.39122996153, 4190.469003642643, 3833.885055674481, 4539.167890267964, 3790.9909397270685, 6437.663448936997, 3289.611078585653, 5647.222418448831, 2893.2428985876227, 6340.772444951033, 3268.452569778461, 6165.6272031334165, 4708.752426340536, 4942.757845121796, 5724.754606957507, 3505.952908935914, 2853.3894786770766, 2660.049023269783, 4343.839024294368, 2938.7548264746492, 4454.522196107329, 4732.967216760158, 6205.819559918945, 5469.80041458921, 6631.0015424035955, 6075.198804338934, 5654.639314545734, 4841.785545566407, 6400.6088823971695, 5255.116846884323, 4618.038244073308, 2517.739364573714, 4976.481025682789, 5788.81781813036, 4151.090891528217, 3977.48703565959, 4841.68750229805, 3629.7542348587635, 3968.700038374374, 5831.523069273404, 2766.4575702350744, 6654.230803658497, 3231.9201809195897, 3237.980725355622, 6053.734272766709, 4747.299045814503, 3943.2684341182303, 3594.400520038927, 6823.216176517202, 4380.993290016953, 3782.2155306558557, 5306.159289137585, 5687.437653230509, 4476.507736044267, 4529.9430492295505, 4179.020191674374, 4366.232620977373, 4778.629049022362, 5272.002257400508, 2996.904751140857, 4529.851644666419, 4670.99512966564, 1213.7503594527943, 1607.386742665159, 4498.311176994747, 4904.882257993757, 4934.639256354512, 4278.343044452419, 1216.310832314314, 810.8093011345286, 4343.5479359123, 4148.760722800578, 4887.427630857655, 4465.453775796751, 5211.287581934465, 4142.334170032833, 4786.336694867308, 4334.894825159838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4005601863542873, "mean_inference_ms": 0.9957874150682019, "mean_action_processing_ms": 0.1681125070954255, "mean_env_wait_ms": 0.05428683274860303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004084110260009766, "StateBufferConnector_ms": 0.0032433271408081055, "ViewRequirementAgentConnector_ms": 0.07223176956176758}, "num_episodes": 22, "episode_return_max": 21966.573874165206, "episode_return_min": 1435.2530661645746, "episode_return_mean": 17665.555630133127}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.5758691497686, "num_env_steps_trained_throughput_per_sec": 457.5758691497686, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 8097.084, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8097.047, "sample_time_ms": 836.875, "learn_time_ms": 7248.657, "learn_throughput": 551.826, "synch_weights_time_ms": 10.915}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 52, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-10", "timestamp": 1723235770, "time_this_iter_s": 8.747408866882324, "time_total_s": 399.7633090019226, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 399.7633090019226, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.192307692307686, "ram_util_percent": 83.16153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2105514526524872, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.876119737271909, "policy_loss": -0.0008114745768979586, "vf_loss": 9.875911699022566, "vf_explained_var": 0.0008432405650931061, "kl": 0.00848639258651664, "entropy": 1.0713868954194286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8297103330182533, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.010284256935119, "policy_loss": -0.0005054679136568059, "vf_loss": 9.995778355995814, "vf_explained_var": 3.72694805264473e-05, "kl": 0.019768056508231286, "entropy": 1.520311846335729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "env_runners": {"episode_reward_max": 21626.635494887898, "episode_reward_min": 1435.2530661645746, "episode_reward_mean": 17434.043056970186, "episode_len_mean": 194.69, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19469, "policy_reward_min": {"agent_policy": 59.93858997248683, "adversary_policy": 586.7249287407178}, "policy_reward_max": {"agent_policy": 12444.564646854773, "adversary_policy": 9810.546536093045}, "policy_reward_mean": {"agent_policy": 8708.066190559186, "adversary_policy": 4362.9884332055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17873.442294222325, 16373.09768491148, 18328.283750369923, 15651.133609718045, 18053.634136250043, 18665.676577116858, 16954.290778791423, 18565.578761453773, 1435.2530661645746, 20450.630480948555, 17559.335091907295, 16069.971593997305, 18593.230595989175, 17762.28650687831, 18257.477058807857, 18487.8168834004, 19789.439927915402, 15247.71410476759, 19243.357547460975, 18014.33323853115, 18962.667890481138, 18964.274314541846, 16221.524651887876, 19694.300039641104, 17059.99007588097, 16286.810449067769, 15973.919551404177, 16994.161231938928, 16637.88678275617, 18806.03031111062, 18805.012957385883, 18777.521970318045, 17049.413697163833, 19104.31760889506, 18213.99171705129, 15144.902137455374, 18992.94334146661, 16387.495294627308, 16379.631072784492, 17691.997585287674, 16844.344293829643, 18281.776306494477, 17969.588026067922, 17912.81545604911, 17431.74670231658, 17002.977155353543, 17410.588193509466, 18819.438781172503, 17648.08853266691, 16798.37011962743, 17064.421630689798, 18588.05623137157, 19607.70872154612, 20126.651282129154, 18982.220441961683, 19204.226355934396, 16659.874988304586, 19099.80049709207, 18048.97810020981, 17771.27694649779, 18109.75522464386, 16908.593193966037, 17187.008219055584, 18877.35150995434, 17543.970438785025, 18523.12891374787, 17771.855357970875, 18614.242166693628, 17695.40497564192, 18347.043228313767, 17139.040374871824, 18655.616231706823, 15265.701748972713, 18409.631448052052, 18384.75993047417, 2225.0228635076232, 17352.400415080847, 18433.216367896574, 17944.291400809627, 18090.128802502317, 19513.368116265974, 19279.288233035193, 17511.99037580104, 19996.87404882855, 21626.635494887898, 15127.394234656656, 16136.16874652722, 17218.27355261019, 20752.658931787944, 16733.880473704845, 15912.416938414937, 16145.150194814674, 19199.772732869016, 17525.269756344278, 4446.9733052341735, 17928.77902466527, 16986.931535008454, 18459.25641054101, 15622.783618784366, 21004.55202601632], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9304.464720712751, 11475.066129573393, 8596.84298604056, 11832.738364942767, 9208.540884532254, 8040.780666575531, 10660.101592015644, 9375.232932098877, 59.93858997248683, 7042.503032925798, 9895.921134351327, 10205.051474822923, 8731.42778211571, 10130.684083898772, 8829.02462118204, 8410.084904056905, 8068.655696236164, 12413.770163940673, 7649.198715598681, 9547.892186704066, 8508.36689246954, 8832.429002462706, 10996.306024413487, 8113.04572820243, 11014.985547642182, 10995.58058832007, 11960.338080387934, 8978.83323288872, 9075.782944135351, 8029.646824034997, 7626.784230351094, 9099.445975788889, 9593.601854065899, 7422.620219431398, 7371.056453633542, 9190.379301052555, 8221.941984838237, 8584.477289202423, 10601.824069190037, 8915.050980657707, 8384.149557912051, 8842.91607289031, 9596.535080125528, 7684.161067385059, 8494.913205282106, 7768.961811814959, 7976.508420597545, 9167.92850971014, 8417.38101677343, 11284.931617680575, 9781.827779920764, 9400.566818504105, 7932.0887470379585, 7420.450935386566, 8485.795581849574, 7548.500626652841, 9524.097379657644, 8334.501653278912, 9920.40017302195, 9299.835209340981, 8309.532116996083, 7487.90482007245, 10717.107312780288, 8076.318191373125, 10006.30148462785, 7318.919447213754, 8683.480538177475, 8450.296777418862, 8986.441734738004, 9202.181558314043, 8870.13336633044, 9454.76945737474, 12444.564646854773, 9006.438013063536, 9171.777629667282, 197.90273005878106, 8860.091756368003, 9080.334961242224, 8590.66964884236, 8968.89728247516, 7799.365087793097, 4331.589087637906, 8829.22614514905, 7441.7598536775595, 5530.509738418103, 12388.513704330053, 11728.227107376148, 7973.85405220712, 6405.6841782877045, 7679.682754518359, 11552.066501593868, 8407.572689005368, 8290.280715865767, 10026.48956718068, 383.5144063013411, 9185.545855866605, 8700.790901164652, 8643.972671098547, 8983.856246654348, 6763.185167513685], "policy_adversary_policy_reward": [4834.279173691854, 3734.698399817665, 2272.8328677367936, 2625.198687601307, 5016.239389278105, 4715.201375051293, 2141.5396399472193, 1676.8556048280668, 3936.90502406689, 4908.188227650922, 5660.532560027672, 4964.363350513613, 2831.4167375248703, 3462.7724492509183, 4755.616486140627, 4434.729343214213, 586.7249287407178, 788.5895474513702, 6308.494857217606, 7099.632590805159, 4109.422726820394, 3553.991230735555, 1927.8359702663663, 3937.0841489080262, 4490.083848110947, 5371.718965762522, 4000.9244604352784, 3630.67796254431, 4143.183549934022, 5285.268887691778, 4361.939011362404, 5715.792967981135, 6070.045999115844, 5650.738232563371, 1119.6750746641783, 1714.268866162793, 6384.795924335163, 5209.362907527062, 4564.612164852986, 3901.8288869741186, 5538.990976627501, 4915.310021384045, 4836.568983483279, 5295.276328595798, 2256.6855348737863, 2968.5330926005618, 5731.808688752682, 5849.4456226859975, 2956.1514683499418, 3088.8530598888146, 2146.021107357311, 3145.208753390424, 1849.9898959857617, 2163.5915750304644, 5163.302390842239, 2852.0256082079386, 2505.782352226603, 5056.321486394214, 5429.471516152949, 5346.911970922689, 4718.72699878127, 6459.501728253526, 5028.646828329094, 4649.429166200085, 4548.533769665043, 2907.278073432846, 5274.154885631619, 6407.542503832043, 6771.079170097415, 4071.8560933203294, 1002.7665137244304, 4951.7563226784005, 5088.825180613937, 5682.17617601441, 5557.658334528526, 2245.359670896378, 3540.3115545409205, 2237.495449053519, 5110.622947922675, 3666.323656707306, 2702.2086700987134, 5757.986065818897, 5248.39122996153, 4190.469003642643, 3833.885055674481, 4539.167890267964, 3790.9909397270685, 6437.663448936997, 3289.611078585653, 5647.222418448831, 2893.2428985876227, 6340.772444951033, 3268.452569778461, 6165.6272031334165, 4708.752426340536, 4942.757845121796, 5724.754606957507, 3505.952908935914, 2853.3894786770766, 2660.049023269783, 4343.839024294368, 2938.7548264746492, 4454.522196107329, 4732.967216760158, 6205.819559918945, 5469.80041458921, 6631.0015424035955, 6075.198804338934, 5654.639314545734, 4841.785545566407, 6400.6088823971695, 5255.116846884323, 4618.038244073308, 2517.739364573714, 4976.481025682789, 5788.81781813036, 4151.090891528217, 3977.48703565959, 4841.68750229805, 3629.7542348587635, 3968.700038374374, 5831.523069273404, 2766.4575702350744, 6654.230803658497, 3231.9201809195897, 3237.980725355622, 6053.734272766709, 4747.299045814503, 3943.2684341182303, 3594.400520038927, 6823.216176517202, 4380.993290016953, 3782.2155306558557, 5306.159289137585, 5687.437653230509, 4476.507736044267, 4529.9430492295505, 4179.020191674374, 4366.232620977373, 4778.629049022362, 5272.002257400508, 2996.904751140857, 4529.851644666419, 4670.99512966564, 1213.7503594527943, 1607.386742665159, 4498.311176994747, 4904.882257993757, 4934.639256354512, 4278.343044452419, 1216.310832314314, 810.8093011345286, 4343.5479359123, 4148.760722800578, 4887.427630857655, 4465.453775796751, 5211.287581934465, 4142.334170032833, 4786.336694867308, 4334.894825159838, 5446.38447941957, 6267.6185490533, 5137.152609304211, 9810.546536093045, 4015.0622129108433, 4667.702017741167, 5854.799507344722, 6700.314687806308, 7494.235246331867, 8601.890510137931, 987.3907157342038, 1751.4898145924187, 2043.8587011380455, 2364.082938013045, 6168.281571523832, 3076.1379288792195, 7736.451445443243, 6610.523308056976, 6462.452869212593, 2591.7448499738507, 1770.8483153616148, 2589.5021214594512, 2003.0145710837774, 5734.562934725593, 5671.644453234266, 5237.847563768977, 3882.802155896705, 3615.97803326689, 1863.7537485837343, 2199.7051503490984, 3797.533756958373, 4945.699411840291, 5441.344722566295, 2844.7959112775393, 4574.432837145543, 5240.850902296936, 1480.6479950534876, 5158.279377076608, 7271.07896539234, 6970.287893110332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40097290010228753, "mean_inference_ms": 0.9974011727102274, "mean_action_processing_ms": 0.16823857059312236, "mean_env_wait_ms": 0.05435328121425408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037529468536376953, "StateBufferConnector_ms": 0.0032558441162109375, "ViewRequirementAgentConnector_ms": 0.07148957252502441}, "num_episodes": 20, "episode_return_max": 21626.635494887898, "episode_return_min": 1435.2530661645746, "episode_return_mean": 17434.043056970186}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.159329229974, "num_env_steps_trained_throughput_per_sec": 462.159329229974, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 8183.582, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8183.545, "sample_time_ms": 835.358, "learn_time_ms": 7336.314, "learn_throughput": 545.233, "synch_weights_time_ms": 11.314}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "training_iteration": 53, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-19", "timestamp": 1723235779, "time_this_iter_s": 8.659404039382935, "time_total_s": 408.42271304130554, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.42271304130554, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.366666666666664, "ram_util_percent": 82.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0193197961679843, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.910279730135802, "policy_loss": -0.0009900429526900764, "vf_loss": 9.910189977272477, "vf_explained_var": 0.0009526574422442724, "kl": 0.008988172652214648, "entropy": 0.9913720730120543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.863799667575707, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994254915912945, "policy_loss": -0.002593010676597866, "vf_loss": 9.991081841786702, "vf_explained_var": 6.14851713180542e-05, "kl": 0.007593172492245988, "entropy": 1.5321143654485543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 23433.06943595276, "episode_reward_min": 1497.9409661410668, "episode_reward_mean": 17413.774891157333, "episode_len_mean": 193.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19300, "policy_reward_min": {"agent_policy": 107.43765513474327, "adversary_policy": 437.2807943612454}, "policy_reward_max": {"agent_policy": 12444.564646854773, "adversary_policy": 10279.38235406769}, "policy_reward_mean": {"agent_policy": 8355.933358789996, "adversary_policy": 4528.920766183671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18964.274314541846, 16221.524651887876, 19694.300039641104, 17059.99007588097, 16286.810449067769, 15973.919551404177, 16994.161231938928, 16637.88678275617, 18806.03031111062, 18805.012957385883, 18777.521970318045, 17049.413697163833, 19104.31760889506, 18213.99171705129, 15144.902137455374, 18992.94334146661, 16387.495294627308, 16379.631072784492, 17691.997585287674, 16844.344293829643, 18281.776306494477, 17969.588026067922, 17912.81545604911, 17431.74670231658, 17002.977155353543, 17410.588193509466, 18819.438781172503, 17648.08853266691, 16798.37011962743, 17064.421630689798, 18588.05623137157, 19607.70872154612, 20126.651282129154, 18982.220441961683, 19204.226355934396, 16659.874988304586, 19099.80049709207, 18048.97810020981, 17771.27694649779, 18109.75522464386, 16908.593193966037, 17187.008219055584, 18877.35150995434, 17543.970438785025, 18523.12891374787, 17771.855357970875, 18614.242166693628, 17695.40497564192, 18347.043228313767, 17139.040374871824, 18655.616231706823, 15265.701748972713, 18409.631448052052, 18384.75993047417, 2225.0228635076232, 17352.400415080847, 18433.216367896574, 17944.291400809627, 18090.128802502317, 19513.368116265974, 19279.288233035193, 17511.99037580104, 19996.87404882855, 21626.635494887898, 15127.394234656656, 16136.16874652722, 17218.27355261019, 20752.658931787944, 16733.880473704845, 15912.416938414937, 16145.150194814674, 19199.772732869016, 17525.269756344278, 4446.9733052341735, 17928.77902466527, 16986.931535008454, 18459.25641054101, 15622.783618784366, 21004.55202601632, 18685.449802733026, 16595.53567856486, 17911.7169959512, 15895.138408549528, 17782.526927543666, 17457.61286941058, 17702.813206775143, 19886.10234511244, 18390.851399226598, 18433.150065278085, 14904.940747286295, 20179.20183299178, 15482.61777342125, 22588.31291823072, 1497.9409661410668, 19114.56610896688, 17682.010763685656, 19200.403712507377, 23433.06943595276, 22062.404434424006, 3425.4686060456097], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 28], "policy_agent_policy_reward": [8832.429002462706, 10996.306024413487, 8113.04572820243, 11014.985547642182, 10995.58058832007, 11960.338080387934, 8978.83323288872, 9075.782944135351, 8029.646824034997, 7626.784230351094, 9099.445975788889, 9593.601854065899, 7422.620219431398, 7371.056453633542, 9190.379301052555, 8221.941984838237, 8584.477289202423, 10601.824069190037, 8915.050980657707, 8384.149557912051, 8842.91607289031, 9596.535080125528, 7684.161067385059, 8494.913205282106, 7768.961811814959, 7976.508420597545, 9167.92850971014, 8417.38101677343, 11284.931617680575, 9781.827779920764, 9400.566818504105, 7932.0887470379585, 7420.450935386566, 8485.795581849574, 7548.500626652841, 9524.097379657644, 8334.501653278912, 9920.40017302195, 9299.835209340981, 8309.532116996083, 7487.90482007245, 10717.107312780288, 8076.318191373125, 10006.30148462785, 7318.919447213754, 8683.480538177475, 8450.296777418862, 8986.441734738004, 9202.181558314043, 8870.13336633044, 9454.76945737474, 12444.564646854773, 9006.438013063536, 9171.777629667282, 197.90273005878106, 8860.091756368003, 9080.334961242224, 8590.66964884236, 8968.89728247516, 7799.365087793097, 4331.589087637906, 8829.22614514905, 7441.7598536775595, 5530.509738418103, 12388.513704330053, 11728.227107376148, 7973.85405220712, 6405.6841782877045, 7679.682754518359, 11552.066501593868, 8407.572689005368, 8290.280715865767, 10026.48956718068, 383.5144063013411, 9185.545855866605, 8700.790901164652, 8643.972671098547, 8983.856246654348, 6763.185167513685, 8361.949517174966, 8235.010422689009, 9469.689153145759, 9547.079419897664, 8246.750895213569, 9648.40919619998, 10152.145616791442, 5257.676720159774, 7741.310137383395, 8215.417589957979, 11989.94142517333, 6799.418422952144, 10282.738999142, 5172.745141887106, 107.43765513474327, 8604.807987250932, 8322.476201172534, 8886.88721958133, 3837.876489903703, 3641.6701079041536, 251.5660591323314], "policy_adversary_policy_reward": [4836.568983483279, 5295.276328595798, 2256.6855348737863, 2968.5330926005618, 5731.808688752682, 5849.4456226859975, 2956.1514683499418, 3088.8530598888146, 2146.021107357311, 3145.208753390424, 1849.9898959857617, 2163.5915750304644, 5163.302390842239, 2852.0256082079386, 2505.782352226603, 5056.321486394214, 5429.471516152949, 5346.911970922689, 4718.72699878127, 6459.501728253526, 5028.646828329094, 4649.429166200085, 4548.533769665043, 2907.278073432846, 5274.154885631619, 6407.542503832043, 6771.079170097415, 4071.8560933203294, 1002.7665137244304, 4951.7563226784005, 5088.825180613937, 5682.17617601441, 5557.658334528526, 2245.359670896378, 3540.3115545409205, 2237.495449053519, 5110.622947922675, 3666.323656707306, 2702.2086700987134, 5757.986065818897, 5248.39122996153, 4190.469003642643, 3833.885055674481, 4539.167890267964, 3790.9909397270685, 6437.663448936997, 3289.611078585653, 5647.222418448831, 2893.2428985876227, 6340.772444951033, 3268.452569778461, 6165.6272031334165, 4708.752426340536, 4942.757845121796, 5724.754606957507, 3505.952908935914, 2853.3894786770766, 2660.049023269783, 4343.839024294368, 2938.7548264746492, 4454.522196107329, 4732.967216760158, 6205.819559918945, 5469.80041458921, 6631.0015424035955, 6075.198804338934, 5654.639314545734, 4841.785545566407, 6400.6088823971695, 5255.116846884323, 4618.038244073308, 2517.739364573714, 4976.481025682789, 5788.81781813036, 4151.090891528217, 3977.48703565959, 4841.68750229805, 3629.7542348587635, 3968.700038374374, 5831.523069273404, 2766.4575702350744, 6654.230803658497, 3231.9201809195897, 3237.980725355622, 6053.734272766709, 4747.299045814503, 3943.2684341182303, 3594.400520038927, 6823.216176517202, 4380.993290016953, 3782.2155306558557, 5306.159289137585, 5687.437653230509, 4476.507736044267, 4529.9430492295505, 4179.020191674374, 4366.232620977373, 4778.629049022362, 5272.002257400508, 2996.904751140857, 4529.851644666419, 4670.99512966564, 1213.7503594527943, 1607.386742665159, 4498.311176994747, 4904.882257993757, 4934.639256354512, 4278.343044452419, 1216.310832314314, 810.8093011345286, 4343.5479359123, 4148.760722800578, 4887.427630857655, 4465.453775796751, 5211.287581934465, 4142.334170032833, 4786.336694867308, 4334.894825159838, 5446.38447941957, 6267.6185490533, 5137.152609304211, 9810.546536093045, 4015.0622129108433, 4667.702017741167, 5854.799507344722, 6700.314687806308, 7494.235246331867, 8601.890510137931, 987.3907157342038, 1751.4898145924187, 2043.8587011380455, 2364.082938013045, 6168.281571523832, 3076.1379288792195, 7736.451445443243, 6610.523308056976, 6462.452869212593, 2591.7448499738507, 1770.8483153616148, 2589.5021214594512, 2003.0145710837774, 5734.562934725593, 5671.644453234266, 5237.847563768977, 3882.802155896705, 3615.97803326689, 1863.7537485837343, 2199.7051503490984, 3797.533756958373, 4945.699411840291, 5441.344722566295, 2844.7959112775393, 4574.432837145543, 5240.850902296936, 1480.6479950534876, 5158.279377076608, 7271.07896539234, 6970.287893110332, 4561.8675017006135, 5761.632783857474, 5907.125201041949, 2453.4000548338954, 3772.978934564878, 4669.048908240605, 4595.056203833268, 1753.0027848185684, 4255.464688272715, 5280.311344057354, 3459.9835969386786, 4349.220076271912, 3614.331533020154, 3936.336056963558, 5743.966721381463, 8884.458903571187, 6400.825486347553, 4248.715775495665, 4291.0144415471495, 5926.718033772973, 786.8338573653742, 2128.1654647475334, 6037.066209260844, 7342.717200778807, 1340.4821496903164, 3859.396624588934, 8469.022003294485, 8946.54577304915, 953.222516645078, 437.2807943612454, 5480.525034317068, 5029.233087398922, 3539.87513995467, 5819.659422558406, 5215.7693999588855, 5097.74709296723, 10279.38235406769, 9315.810591981437, 9067.586367867118, 9353.147958652762, 1629.8746373206375, 1544.0279095926412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40147546365163156, "mean_inference_ms": 0.9987845170567573, "mean_action_processing_ms": 0.16844522380389804, "mean_env_wait_ms": 0.05444282320234795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037604570388793945, "StateBufferConnector_ms": 0.0029752254486083984, "ViewRequirementAgentConnector_ms": 0.07320654392242432}, "num_episodes": 21, "episode_return_max": 23433.06943595276, "episode_return_min": 1497.9409661410668, "episode_return_mean": 17413.774891157333}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.6678625235927, "num_env_steps_trained_throughput_per_sec": 502.6678625235927, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 8203.408, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8203.371, "sample_time_ms": 845.577, "learn_time_ms": 7345.753, "learn_throughput": 544.532, "synch_weights_time_ms": 11.539}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 54, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-27", "timestamp": 1723235787, "time_this_iter_s": 7.9615700244903564, "time_total_s": 416.3842830657959, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206b7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 416.3842830657959, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 27.90833333333333, "ram_util_percent": 82.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8467900201284065, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.974034456727367, "policy_loss": -0.0019760674415106967, "vf_loss": 9.975048411838593, "vf_explained_var": 0.00032276476501787784, "kl": 0.00800871866035753, "entropy": 1.02671357721248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8538642697967589, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995203685760497, "policy_loss": -0.009664830207960525, "vf_loss": 9.995665338635444, "vf_explained_var": 4.2996679743131004e-05, "kl": 0.012119371437195998, "entropy": 1.5331125531345606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": 23433.06943595276, "episode_reward_min": 505.96273114604986, "episode_reward_mean": 17516.006820345247, "episode_len_mean": 191.04, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19104, "policy_reward_min": {"agent_policy": 10.32095469804685, "adversary_policy": 223.12001867143084}, "policy_reward_max": {"agent_policy": 12444.564646854773, "adversary_policy": 10279.38235406769}, "policy_reward_mean": {"agent_policy": 8058.6783944335875, "adversary_policy": 4728.664212955829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17969.588026067922, 17912.81545604911, 17431.74670231658, 17002.977155353543, 17410.588193509466, 18819.438781172503, 17648.08853266691, 16798.37011962743, 17064.421630689798, 18588.05623137157, 19607.70872154612, 20126.651282129154, 18982.220441961683, 19204.226355934396, 16659.874988304586, 19099.80049709207, 18048.97810020981, 17771.27694649779, 18109.75522464386, 16908.593193966037, 17187.008219055584, 18877.35150995434, 17543.970438785025, 18523.12891374787, 17771.855357970875, 18614.242166693628, 17695.40497564192, 18347.043228313767, 17139.040374871824, 18655.616231706823, 15265.701748972713, 18409.631448052052, 18384.75993047417, 2225.0228635076232, 17352.400415080847, 18433.216367896574, 17944.291400809627, 18090.128802502317, 19513.368116265974, 19279.288233035193, 17511.99037580104, 19996.87404882855, 21626.635494887898, 15127.394234656656, 16136.16874652722, 17218.27355261019, 20752.658931787944, 16733.880473704845, 15912.416938414937, 16145.150194814674, 19199.772732869016, 17525.269756344278, 4446.9733052341735, 17928.77902466527, 16986.931535008454, 18459.25641054101, 15622.783618784366, 21004.55202601632, 18685.449802733026, 16595.53567856486, 17911.7169959512, 15895.138408549528, 17782.526927543666, 17457.61286941058, 17702.813206775143, 19886.10234511244, 18390.851399226598, 18433.150065278085, 14904.940747286295, 20179.20183299178, 15482.61777342125, 22588.31291823072, 1497.9409661410668, 19114.56610896688, 17682.010763685656, 19200.403712507377, 23433.06943595276, 22062.404434424006, 3425.4686060456097, 17287.925527851046, 17089.719142177742, 15717.763670375318, 19864.714189489507, 20049.979530147495, 21813.486474160236, 18576.984736803206, 17635.399291405713, 17541.24543619629, 16571.12434542467, 22690.340021590673, 21986.874046001176, 21108.24213221556, 18582.24512820976, 17631.88090240039, 505.96273114604986, 18431.241626846706, 16575.55154391864, 20227.873199314323, 22310.724810102874, 16336.159824002403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9596.535080125528, 7684.161067385059, 8494.913205282106, 7768.961811814959, 7976.508420597545, 9167.92850971014, 8417.38101677343, 11284.931617680575, 9781.827779920764, 9400.566818504105, 7932.0887470379585, 7420.450935386566, 8485.795581849574, 7548.500626652841, 9524.097379657644, 8334.501653278912, 9920.40017302195, 9299.835209340981, 8309.532116996083, 7487.90482007245, 10717.107312780288, 8076.318191373125, 10006.30148462785, 7318.919447213754, 8683.480538177475, 8450.296777418862, 8986.441734738004, 9202.181558314043, 8870.13336633044, 9454.76945737474, 12444.564646854773, 9006.438013063536, 9171.777629667282, 197.90273005878106, 8860.091756368003, 9080.334961242224, 8590.66964884236, 8968.89728247516, 7799.365087793097, 4331.589087637906, 8829.22614514905, 7441.7598536775595, 5530.509738418103, 12388.513704330053, 11728.227107376148, 7973.85405220712, 6405.6841782877045, 7679.682754518359, 11552.066501593868, 8407.572689005368, 8290.280715865767, 10026.48956718068, 383.5144063013411, 9185.545855866605, 8700.790901164652, 8643.972671098547, 8983.856246654348, 6763.185167513685, 8361.949517174966, 8235.010422689009, 9469.689153145759, 9547.079419897664, 8246.750895213569, 9648.40919619998, 10152.145616791442, 5257.676720159774, 7741.310137383395, 8215.417589957979, 11989.94142517333, 6799.418422952144, 10282.738999142, 5172.745141887106, 107.43765513474327, 8604.807987250932, 8322.476201172534, 8886.88721958133, 3837.876489903703, 3641.6701079041536, 251.5660591323314, 7438.290339226305, 9738.202638058938, 11212.949216009858, 7792.501696237628, 7724.530250896213, 3849.3627509898733, 8935.555634322782, 9242.430694008182, 9627.326243615888, 9966.47786526645, 5368.1387305317785, 3802.282042461212, 6606.091440436997, 9228.020324682911, 9595.307976787315, 10.32095469804685, 8585.59962459585, 11615.787167791505, 6748.414572430342, 5254.952859962644, 9783.156502850501], "policy_adversary_policy_reward": [3833.885055674481, 4539.167890267964, 3790.9909397270685, 6437.663448936997, 3289.611078585653, 5647.222418448831, 2893.2428985876227, 6340.772444951033, 3268.452569778461, 6165.6272031334165, 4708.752426340536, 4942.757845121796, 5724.754606957507, 3505.952908935914, 2853.3894786770766, 2660.049023269783, 4343.839024294368, 2938.7548264746492, 4454.522196107329, 4732.967216760158, 6205.819559918945, 5469.80041458921, 6631.0015424035955, 6075.198804338934, 5654.639314545734, 4841.785545566407, 6400.6088823971695, 5255.116846884323, 4618.038244073308, 2517.739364573714, 4976.481025682789, 5788.81781813036, 4151.090891528217, 3977.48703565959, 4841.68750229805, 3629.7542348587635, 3968.700038374374, 5831.523069273404, 2766.4575702350744, 6654.230803658497, 3231.9201809195897, 3237.980725355622, 6053.734272766709, 4747.299045814503, 3943.2684341182303, 3594.400520038927, 6823.216176517202, 4380.993290016953, 3782.2155306558557, 5306.159289137585, 5687.437653230509, 4476.507736044267, 4529.9430492295505, 4179.020191674374, 4366.232620977373, 4778.629049022362, 5272.002257400508, 2996.904751140857, 4529.851644666419, 4670.99512966564, 1213.7503594527943, 1607.386742665159, 4498.311176994747, 4904.882257993757, 4934.639256354512, 4278.343044452419, 1216.310832314314, 810.8093011345286, 4343.5479359123, 4148.760722800578, 4887.427630857655, 4465.453775796751, 5211.287581934465, 4142.334170032833, 4786.336694867308, 4334.894825159838, 5446.38447941957, 6267.6185490533, 5137.152609304211, 9810.546536093045, 4015.0622129108433, 4667.702017741167, 5854.799507344722, 6700.314687806308, 7494.235246331867, 8601.890510137931, 987.3907157342038, 1751.4898145924187, 2043.8587011380455, 2364.082938013045, 6168.281571523832, 3076.1379288792195, 7736.451445443243, 6610.523308056976, 6462.452869212593, 2591.7448499738507, 1770.8483153616148, 2589.5021214594512, 2003.0145710837774, 5734.562934725593, 5671.644453234266, 5237.847563768977, 3882.802155896705, 3615.97803326689, 1863.7537485837343, 2199.7051503490984, 3797.533756958373, 4945.699411840291, 5441.344722566295, 2844.7959112775393, 4574.432837145543, 5240.850902296936, 1480.6479950534876, 5158.279377076608, 7271.07896539234, 6970.287893110332, 4561.8675017006135, 5761.632783857474, 5907.125201041949, 2453.4000548338954, 3772.978934564878, 4669.048908240605, 4595.056203833268, 1753.0027848185684, 4255.464688272715, 5280.311344057354, 3459.9835969386786, 4349.220076271912, 3614.331533020154, 3936.336056963558, 5743.966721381463, 8884.458903571187, 6400.825486347553, 4248.715775495665, 4291.0144415471495, 5926.718033772973, 786.8338573653742, 2128.1654647475334, 6037.066209260844, 7342.717200778807, 1340.4821496903164, 3859.396624588934, 8469.022003294485, 8946.54577304915, 953.222516645078, 437.2807943612454, 5480.525034317068, 5029.233087398922, 3539.87513995467, 5819.659422558406, 5215.7693999588855, 5097.74709296723, 10279.38235406769, 9315.810591981437, 9067.586367867118, 9353.147958652762, 1629.8746373206375, 1544.0279095926412, 3145.789904120105, 6703.845284504645, 3108.717795979855, 4242.798708138963, 1575.6280466443125, 2929.186407721094, 6349.633927493326, 5722.578565758551, 6332.839718393519, 5992.609560857737, 10095.986721239115, 7868.137001931317, 5198.088034875887, 4443.341067604543, 4899.704929722781, 3493.2636676747784, 3791.4884992400202, 4122.430693340354, 4175.657758464502, 2428.9887216937045, 8687.159276698325, 8635.04201436057, 8664.344796650208, 9520.2472068898, 7131.759350613735, 7370.391341164813, 4818.1467994537, 4536.078004073195, 4244.4950197454245, 3792.0779058676385, 272.52175777657214, 223.12001867143084, 5109.963478779278, 4735.678523471586, 2444.7864452198937, 2514.9779309072615, 6085.737575583388, 7393.721051300603, 8820.71557258727, 8235.056377552943, 4358.979120880459, 2194.0242002714267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40186141791360064, "mean_inference_ms": 0.9997853053230873, "mean_action_processing_ms": 0.16855573783238406, "mean_env_wait_ms": 0.05454392093143619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035933256149291992, "StateBufferConnector_ms": 0.0033004283905029297, "ViewRequirementAgentConnector_ms": 0.0728079080581665}, "num_episodes": 21, "episode_return_max": 23433.06943595276, "episode_return_min": 505.96273114604986, "episode_return_mean": 17516.006820345247}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.7230828234432, "num_env_steps_trained_throughput_per_sec": 523.7230828234432, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 8166.617, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8166.58, "sample_time_ms": 845.985, "learn_time_ms": 7308.577, "learn_throughput": 547.302, "synch_weights_time_ms": 11.516}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 55, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-35", "timestamp": 1723235795, "time_this_iter_s": 7.641767978668213, "time_total_s": 424.0260510444641, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 424.0260510444641, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 82.6909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.743087687639017, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995258123407918, "policy_loss": -0.003208562096324626, "vf_loss": 9.997603153047107, "vf_explained_var": 0.0001846537703559512, "kl": 0.00718815935462733, "entropy": 0.9655144259412453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.910136516392231, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.984807284673055, "policy_loss": -0.010255624344669438, "vf_loss": 9.985854943593344, "vf_explained_var": 6.983857601881028e-05, "kl": 0.012125745165394618, "entropy": 1.5057571402440468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 23646.10013662699, "episode_reward_min": 421.5269274609438, "episode_reward_mean": 17461.45202147977, "episode_len_mean": 185.3, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18530, "policy_reward_min": {"agent_policy": 10.32095469804685, "adversary_policy": 138.68421498632478}, "policy_reward_max": {"agent_policy": 12444.564646854773, "adversary_policy": 10804.66780763973}, "policy_reward_mean": {"agent_policy": 7328.858981359165, "adversary_policy": 5066.296520060306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17771.855357970875, 18614.242166693628, 17695.40497564192, 18347.043228313767, 17139.040374871824, 18655.616231706823, 15265.701748972713, 18409.631448052052, 18384.75993047417, 2225.0228635076232, 17352.400415080847, 18433.216367896574, 17944.291400809627, 18090.128802502317, 19513.368116265974, 19279.288233035193, 17511.99037580104, 19996.87404882855, 21626.635494887898, 15127.394234656656, 16136.16874652722, 17218.27355261019, 20752.658931787944, 16733.880473704845, 15912.416938414937, 16145.150194814674, 19199.772732869016, 17525.269756344278, 4446.9733052341735, 17928.77902466527, 16986.931535008454, 18459.25641054101, 15622.783618784366, 21004.55202601632, 18685.449802733026, 16595.53567856486, 17911.7169959512, 15895.138408549528, 17782.526927543666, 17457.61286941058, 17702.813206775143, 19886.10234511244, 18390.851399226598, 18433.150065278085, 14904.940747286295, 20179.20183299178, 15482.61777342125, 22588.31291823072, 1497.9409661410668, 19114.56610896688, 17682.010763685656, 19200.403712507377, 23433.06943595276, 22062.404434424006, 3425.4686060456097, 17287.925527851046, 17089.719142177742, 15717.763670375318, 19864.714189489507, 20049.979530147495, 21813.486474160236, 18576.984736803206, 17635.399291405713, 17541.24543619629, 16571.12434542467, 22690.340021590673, 21986.874046001176, 21108.24213221556, 18582.24512820976, 17631.88090240039, 505.96273114604986, 18431.241626846706, 16575.55154391864, 20227.873199314323, 22310.724810102874, 16336.159824002403, 21929.213970376117, 421.5269274609438, 18080.313790569016, 17391.623219726796, 22394.869987829603, 19010.563879980735, 17574.48716297478, 23546.40135575023, 23646.10013662699, 1809.2796015286735, 21587.296329317007, 17815.09795096323, 23059.461236477935, 20097.02473456107, 20442.99777898454, 22483.619722089414, 932.5773886029037, 17247.197670914127, 22677.466636992394, 18267.02952695894, 19832.650266352743, 18713.334765662803, 17749.766327945003, 21131.25540745974], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8683.480538177475, 8450.296777418862, 8986.441734738004, 9202.181558314043, 8870.13336633044, 9454.76945737474, 12444.564646854773, 9006.438013063536, 9171.777629667282, 197.90273005878106, 8860.091756368003, 9080.334961242224, 8590.66964884236, 8968.89728247516, 7799.365087793097, 4331.589087637906, 8829.22614514905, 7441.7598536775595, 5530.509738418103, 12388.513704330053, 11728.227107376148, 7973.85405220712, 6405.6841782877045, 7679.682754518359, 11552.066501593868, 8407.572689005368, 8290.280715865767, 10026.48956718068, 383.5144063013411, 9185.545855866605, 8700.790901164652, 8643.972671098547, 8983.856246654348, 6763.185167513685, 8361.949517174966, 8235.010422689009, 9469.689153145759, 9547.079419897664, 8246.750895213569, 9648.40919619998, 10152.145616791442, 5257.676720159774, 7741.310137383395, 8215.417589957979, 11989.94142517333, 6799.418422952144, 10282.738999142, 5172.745141887106, 107.43765513474327, 8604.807987250932, 8322.476201172534, 8886.88721958133, 3837.876489903703, 3641.6701079041536, 251.5660591323314, 7438.290339226305, 9738.202638058938, 11212.949216009858, 7792.501696237628, 7724.530250896213, 3849.3627509898733, 8935.555634322782, 9242.430694008182, 9627.326243615888, 9966.47786526645, 5368.1387305317785, 3802.282042461212, 6606.091440436997, 9228.020324682911, 9595.307976787315, 10.32095469804685, 8585.59962459585, 11615.787167791505, 6748.414572430342, 5254.952859962644, 9783.156502850501, 5156.321194607066, 12.855405382216288, 5070.219542204692, 8536.355051403598, 5114.250849970274, 5816.2820563470295, 10033.86157452337, 4631.203157384285, 3596.7001711518838, 115.46386577442344, 3604.713588694138, 9335.794153477162, 2829.465672424331, 5719.813203129577, 7634.695362879106, 5100.171272760839, 24.594173406494164, 9145.503383191051, 5045.3602339736235, 8887.510479996745, 7554.6825477402635, 8242.24706903601, 9336.584414769877, 6428.87927541371], "policy_adversary_policy_reward": [3782.2155306558557, 5306.159289137585, 5687.437653230509, 4476.507736044267, 4529.9430492295505, 4179.020191674374, 4366.232620977373, 4778.629049022362, 5272.002257400508, 2996.904751140857, 4529.851644666419, 4670.99512966564, 1213.7503594527943, 1607.386742665159, 4498.311176994747, 4904.882257993757, 4934.639256354512, 4278.343044452419, 1216.310832314314, 810.8093011345286, 4343.5479359123, 4148.760722800578, 4887.427630857655, 4465.453775796751, 5211.287581934465, 4142.334170032833, 4786.336694867308, 4334.894825159838, 5446.38447941957, 6267.6185490533, 5137.152609304211, 9810.546536093045, 4015.0622129108433, 4667.702017741167, 5854.799507344722, 6700.314687806308, 7494.235246331867, 8601.890510137931, 987.3907157342038, 1751.4898145924187, 2043.8587011380455, 2364.082938013045, 6168.281571523832, 3076.1379288792195, 7736.451445443243, 6610.523308056976, 6462.452869212593, 2591.7448499738507, 1770.8483153616148, 2589.5021214594512, 2003.0145710837774, 5734.562934725593, 5671.644453234266, 5237.847563768977, 3882.802155896705, 3615.97803326689, 1863.7537485837343, 2199.7051503490984, 3797.533756958373, 4945.699411840291, 5441.344722566295, 2844.7959112775393, 4574.432837145543, 5240.850902296936, 1480.6479950534876, 5158.279377076608, 7271.07896539234, 6970.287893110332, 4561.8675017006135, 5761.632783857474, 5907.125201041949, 2453.4000548338954, 3772.978934564878, 4669.048908240605, 4595.056203833268, 1753.0027848185684, 4255.464688272715, 5280.311344057354, 3459.9835969386786, 4349.220076271912, 3614.331533020154, 3936.336056963558, 5743.966721381463, 8884.458903571187, 6400.825486347553, 4248.715775495665, 4291.0144415471495, 5926.718033772973, 786.8338573653742, 2128.1654647475334, 6037.066209260844, 7342.717200778807, 1340.4821496903164, 3859.396624588934, 8469.022003294485, 8946.54577304915, 953.222516645078, 437.2807943612454, 5480.525034317068, 5029.233087398922, 3539.87513995467, 5819.659422558406, 5215.7693999588855, 5097.74709296723, 10279.38235406769, 9315.810591981437, 9067.586367867118, 9353.147958652762, 1629.8746373206375, 1544.0279095926412, 3145.789904120105, 6703.845284504645, 3108.717795979855, 4242.798708138963, 1575.6280466443125, 2929.186407721094, 6349.633927493326, 5722.578565758551, 6332.839718393519, 5992.609560857737, 10095.986721239115, 7868.137001931317, 5198.088034875887, 4443.341067604543, 4899.704929722781, 3493.2636676747784, 3791.4884992400202, 4122.430693340354, 4175.657758464502, 2428.9887216937045, 8687.159276698325, 8635.04201436057, 8664.344796650208, 9520.2472068898, 7131.759350613735, 7370.391341164813, 4818.1467994537, 4536.078004073195, 4244.4950197454245, 3792.0779058676385, 272.52175777657214, 223.12001867143084, 5109.963478779278, 4735.678523471586, 2444.7864452198937, 2514.9779309072615, 6085.737575583388, 7393.721051300603, 8820.71557258727, 8235.056377552943, 4358.979120880459, 2194.0242002714267, 8298.110300059705, 8474.782475709375, 269.9873070924027, 138.68421498632478, 3938.178166838069, 9071.916081526257, 4270.096349545407, 4585.171818777766, 8715.139550208893, 8565.479587650514, 4872.574168463304, 8321.70765517041, 3955.0846689401233, 3585.5409195112966, 9479.954024962348, 9435.244173403604, 10525.828670638346, 9523.571294836724, 748.619429748852, 945.1963060053979, 7445.160705586028, 10537.422035036825, 4806.332630229856, 3672.9711672562344, 10804.66780763973, 9425.327756413852, 5979.94184493976, 8397.269686491705, 6404.390672480962, 6403.911743624493, 8351.908453185504, 9031.539996143067, 437.60264177232034, 470.3805734240891, 3109.9006276493856, 4991.793660073681, 8550.464272625306, 9081.642130393457, 5254.625143734217, 4124.893903227999, 5690.514642621764, 6587.4530759906875, 5899.888554694936, 4571.199141931865, 3752.3768527996644, 4660.805060375472, 7013.655129383062, 7688.72100266298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4022027288971347, "mean_inference_ms": 1.0004618346581353, "mean_action_processing_ms": 0.16871273118111246, "mean_env_wait_ms": 0.054659172495459284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035027265548706055, "StateBufferConnector_ms": 0.003309011459350586, "ViewRequirementAgentConnector_ms": 0.07268643379211426}, "num_episodes": 24, "episode_return_max": 23646.10013662699, "episode_return_min": 421.5269274609438, "episode_return_mean": 17461.45202147977}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.7834642644058, "num_env_steps_trained_throughput_per_sec": 518.7834642644058, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 8115.72, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8115.684, "sample_time_ms": 809.563, "learn_time_ms": 7293.896, "learn_throughput": 548.404, "synch_weights_time_ms": 11.731}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 56, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-43", "timestamp": 1723235803, "time_this_iter_s": 7.7160961627960205, "time_total_s": 431.74214720726013, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 431.74214720726013, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 25.209090909090904, "ram_util_percent": 82.67272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.699944276674084, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993754824381027, "policy_loss": -0.0011506463134927408, "vf_loss": 9.993765715947227, "vf_explained_var": 3.933417734014925e-05, "kl": 0.009487148863879382, "entropy": 0.9028838429816817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.897443645944198, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002261155843735, "policy_loss": -0.0009028252272401005, "vf_loss": 9.995941666762034, "vf_explained_var": 6.791676084200541e-05, "kl": 0.009510816523106768, "entropy": 1.4910957944889864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "env_runners": {"episode_reward_max": 24518.36089606663, "episode_reward_min": 421.5269274609438, "episode_reward_mean": 17816.714957040233, "episode_len_mean": 185.31, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18531, "policy_reward_min": {"agent_policy": 10.32095469804685, "adversary_policy": 138.68421498632478}, "policy_reward_max": {"agent_policy": 11989.94142517333, "adversary_policy": 10981.770452225554}, "policy_reward_mean": {"agent_policy": 7026.863265456631, "adversary_policy": 5394.925845791803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16136.16874652722, 17218.27355261019, 20752.658931787944, 16733.880473704845, 15912.416938414937, 16145.150194814674, 19199.772732869016, 17525.269756344278, 4446.9733052341735, 17928.77902466527, 16986.931535008454, 18459.25641054101, 15622.783618784366, 21004.55202601632, 18685.449802733026, 16595.53567856486, 17911.7169959512, 15895.138408549528, 17782.526927543666, 17457.61286941058, 17702.813206775143, 19886.10234511244, 18390.851399226598, 18433.150065278085, 14904.940747286295, 20179.20183299178, 15482.61777342125, 22588.31291823072, 1497.9409661410668, 19114.56610896688, 17682.010763685656, 19200.403712507377, 23433.06943595276, 22062.404434424006, 3425.4686060456097, 17287.925527851046, 17089.719142177742, 15717.763670375318, 19864.714189489507, 20049.979530147495, 21813.486474160236, 18576.984736803206, 17635.399291405713, 17541.24543619629, 16571.12434542467, 22690.340021590673, 21986.874046001176, 21108.24213221556, 18582.24512820976, 17631.88090240039, 505.96273114604986, 18431.241626846706, 16575.55154391864, 20227.873199314323, 22310.724810102874, 16336.159824002403, 21929.213970376117, 421.5269274609438, 18080.313790569016, 17391.623219726796, 22394.869987829603, 19010.563879980735, 17574.48716297478, 23546.40135575023, 23646.10013662699, 1809.2796015286735, 21587.296329317007, 17815.09795096323, 23059.461236477935, 20097.02473456107, 20442.99777898454, 22483.619722089414, 932.5773886029037, 17247.197670914127, 22677.466636992394, 18267.02952695894, 19832.650266352743, 18713.334765662803, 17749.766327945003, 21131.25540745974, 17430.91517986879, 19626.601871007842, 20114.12036987581, 17917.46374372683, 19566.728421183467, 21723.282277805865, 16748.17720754475, 23569.842408295983, 21582.793016285403, 18023.10348248192, 20220.43046261757, 24518.36089606663, 18468.386145665292, 19177.97207078295, 19164.156678108004, 2600.457084435564, 20209.68416257347, 23743.068926118176, 17967.662875151193, 20536.992092421176], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200], "policy_agent_policy_reward": [11728.227107376148, 7973.85405220712, 6405.6841782877045, 7679.682754518359, 11552.066501593868, 8407.572689005368, 8290.280715865767, 10026.48956718068, 383.5144063013411, 9185.545855866605, 8700.790901164652, 8643.972671098547, 8983.856246654348, 6763.185167513685, 8361.949517174966, 8235.010422689009, 9469.689153145759, 9547.079419897664, 8246.750895213569, 9648.40919619998, 10152.145616791442, 5257.676720159774, 7741.310137383395, 8215.417589957979, 11989.94142517333, 6799.418422952144, 10282.738999142, 5172.745141887106, 107.43765513474327, 8604.807987250932, 8322.476201172534, 8886.88721958133, 3837.876489903703, 3641.6701079041536, 251.5660591323314, 7438.290339226305, 9738.202638058938, 11212.949216009858, 7792.501696237628, 7724.530250896213, 3849.3627509898733, 8935.555634322782, 9242.430694008182, 9627.326243615888, 9966.47786526645, 5368.1387305317785, 3802.282042461212, 6606.091440436997, 9228.020324682911, 9595.307976787315, 10.32095469804685, 8585.59962459585, 11615.787167791505, 6748.414572430342, 5254.952859962644, 9783.156502850501, 5156.321194607066, 12.855405382216288, 5070.219542204692, 8536.355051403598, 5114.250849970274, 5816.2820563470295, 10033.86157452337, 4631.203157384285, 3596.7001711518838, 115.46386577442344, 3604.713588694138, 9335.794153477162, 2829.465672424331, 5719.813203129577, 7634.695362879106, 5100.171272760839, 24.594173406494164, 9145.503383191051, 5045.3602339736235, 8887.510479996745, 7554.6825477402635, 8242.24706903601, 9336.584414769877, 6428.87927541371, 10420.297387700975, 8097.728041634535, 6652.821685952613, 7143.555541581087, 7871.705770540559, 6152.145774753573, 9578.768110679508, 4324.780907021106, 5741.651040681787, 6970.514522470202, 6949.743525550026, 2752.1382720718834, 8771.675881512132, 8256.684292426291, 7885.313719441977, 111.0889159793072, 7402.514229374987, 4012.3030809492725, 9532.910170300525, 7461.031257055867], "policy_adversary_policy_reward": [2043.8587011380455, 2364.082938013045, 6168.281571523832, 3076.1379288792195, 7736.451445443243, 6610.523308056976, 6462.452869212593, 2591.7448499738507, 1770.8483153616148, 2589.5021214594512, 2003.0145710837774, 5734.562934725593, 5671.644453234266, 5237.847563768977, 3882.802155896705, 3615.97803326689, 1863.7537485837343, 2199.7051503490984, 3797.533756958373, 4945.699411840291, 5441.344722566295, 2844.7959112775393, 4574.432837145543, 5240.850902296936, 1480.6479950534876, 5158.279377076608, 7271.07896539234, 6970.287893110332, 4561.8675017006135, 5761.632783857474, 5907.125201041949, 2453.4000548338954, 3772.978934564878, 4669.048908240605, 4595.056203833268, 1753.0027848185684, 4255.464688272715, 5280.311344057354, 3459.9835969386786, 4349.220076271912, 3614.331533020154, 3936.336056963558, 5743.966721381463, 8884.458903571187, 6400.825486347553, 4248.715775495665, 4291.0144415471495, 5926.718033772973, 786.8338573653742, 2128.1654647475334, 6037.066209260844, 7342.717200778807, 1340.4821496903164, 3859.396624588934, 8469.022003294485, 8946.54577304915, 953.222516645078, 437.2807943612454, 5480.525034317068, 5029.233087398922, 3539.87513995467, 5819.659422558406, 5215.7693999588855, 5097.74709296723, 10279.38235406769, 9315.810591981437, 9067.586367867118, 9353.147958652762, 1629.8746373206375, 1544.0279095926412, 3145.789904120105, 6703.845284504645, 3108.717795979855, 4242.798708138963, 1575.6280466443125, 2929.186407721094, 6349.633927493326, 5722.578565758551, 6332.839718393519, 5992.609560857737, 10095.986721239115, 7868.137001931317, 5198.088034875887, 4443.341067604543, 4899.704929722781, 3493.2636676747784, 3791.4884992400202, 4122.430693340354, 4175.657758464502, 2428.9887216937045, 8687.159276698325, 8635.04201436057, 8664.344796650208, 9520.2472068898, 7131.759350613735, 7370.391341164813, 4818.1467994537, 4536.078004073195, 4244.4950197454245, 3792.0779058676385, 272.52175777657214, 223.12001867143084, 5109.963478779278, 4735.678523471586, 2444.7864452198937, 2514.9779309072615, 6085.737575583388, 7393.721051300603, 8820.71557258727, 8235.056377552943, 4358.979120880459, 2194.0242002714267, 8298.110300059705, 8474.782475709375, 269.9873070924027, 138.68421498632478, 3938.178166838069, 9071.916081526257, 4270.096349545407, 4585.171818777766, 8715.139550208893, 8565.479587650514, 4872.574168463304, 8321.70765517041, 3955.0846689401233, 3585.5409195112966, 9479.954024962348, 9435.244173403604, 10525.828670638346, 9523.571294836724, 748.619429748852, 945.1963060053979, 7445.160705586028, 10537.422035036825, 4806.332630229856, 3672.9711672562344, 10804.66780763973, 9425.327756413852, 5979.94184493976, 8397.269686491705, 6404.390672480962, 6403.911743624493, 8351.908453185504, 9031.539996143067, 437.60264177232034, 470.3805734240891, 3109.9006276493856, 4991.793660073681, 8550.464272625306, 9081.642130393457, 5254.625143734217, 4124.893903227999, 5690.514642621764, 6587.4530759906875, 5899.888554694936, 4571.199141931865, 3752.3768527996644, 4660.805060375472, 7013.655129383062, 7688.72100266298, 3693.546497437967, 3317.071294729856, 5763.328659812694, 5765.545169560667, 7153.210207038054, 6308.088476885174, 6998.580082149855, 3775.32811999587, 5658.605637465427, 6036.417013177489, 7839.418052473356, 7731.718450578908, 2607.1058279516324, 4562.30326891364, 9492.202124030204, 9752.85937724463, 7440.657392554443, 8400.484583049167, 7171.62110126075, 3880.9678587509575, 6087.0133535986, 7183.673583468893, 10981.770452225554, 10784.45217176919, 4416.946614153088, 5279.763650000049, 5062.054682896877, 5859.233095459824, 6256.821904288978, 5022.021054377071, 1212.1271696189979, 1277.2409988372585, 6077.326000855645, 6729.8439323428975, 9808.493097284541, 9922.272747884308, 3834.1225146466186, 4600.630190204065, 6648.674728486214, 6427.286106879098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024419818528081, "mean_inference_ms": 1.0010274935584054, "mean_action_processing_ms": 0.16881368139923708, "mean_env_wait_ms": 0.054745614179600464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033587217330932617, "StateBufferConnector_ms": 0.0029844045639038086, "ViewRequirementAgentConnector_ms": 0.07133650779724121}, "num_episodes": 20, "episode_return_max": 24518.36089606663, "episode_return_min": 421.5269274609438, "episode_return_mean": 17816.714957040233}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.72224600444355, "num_env_steps_trained_throughput_per_sec": 480.72224600444355, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 8180.353, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8180.317, "sample_time_ms": 818.782, "learn_time_ms": 7349.338, "learn_throughput": 544.267, "synch_weights_time_ms": 11.7}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "training_iteration": 57, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-51", "timestamp": 1723235811, "time_this_iter_s": 8.325366973876953, "time_total_s": 440.0675141811371, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 440.0675141811371, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 27.199999999999992, "ram_util_percent": 82.78333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6098078229597637, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990916623514165, "policy_loss": -0.0014600735755203656, "vf_loss": 9.990781483322225, "vf_explained_var": 5.629791153801812e-05, "kl": 0.01327857778853584, "entropy": 0.7850785200242643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8594670803130915, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998833953340847, "policy_loss": 0.0005988661393833657, "vf_loss": 9.99092965523402, "vf_explained_var": 2.387072890996933e-05, "kl": 0.009620293519886521, "entropy": 1.4777466010302305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 24518.36089606663, "episode_reward_min": 421.5269274609438, "episode_reward_mean": 17794.836216082444, "episode_len_mean": 183.38, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18338, "policy_reward_min": {"agent_policy": 10.32095469804685, "adversary_policy": 138.68421498632478}, "policy_reward_max": {"agent_policy": 11989.94142517333, "adversary_policy": 10981.770452225554}, "policy_reward_mean": {"agent_policy": 6819.38749287341, "adversary_policy": 5487.724361604517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19886.10234511244, 18390.851399226598, 18433.150065278085, 14904.940747286295, 20179.20183299178, 15482.61777342125, 22588.31291823072, 1497.9409661410668, 19114.56610896688, 17682.010763685656, 19200.403712507377, 23433.06943595276, 22062.404434424006, 3425.4686060456097, 17287.925527851046, 17089.719142177742, 15717.763670375318, 19864.714189489507, 20049.979530147495, 21813.486474160236, 18576.984736803206, 17635.399291405713, 17541.24543619629, 16571.12434542467, 22690.340021590673, 21986.874046001176, 21108.24213221556, 18582.24512820976, 17631.88090240039, 505.96273114604986, 18431.241626846706, 16575.55154391864, 20227.873199314323, 22310.724810102874, 16336.159824002403, 21929.213970376117, 421.5269274609438, 18080.313790569016, 17391.623219726796, 22394.869987829603, 19010.563879980735, 17574.48716297478, 23546.40135575023, 23646.10013662699, 1809.2796015286735, 21587.296329317007, 17815.09795096323, 23059.461236477935, 20097.02473456107, 20442.99777898454, 22483.619722089414, 932.5773886029037, 17247.197670914127, 22677.466636992394, 18267.02952695894, 19832.650266352743, 18713.334765662803, 17749.766327945003, 21131.25540745974, 17430.91517986879, 19626.601871007842, 20114.12036987581, 17917.46374372683, 19566.728421183467, 21723.282277805865, 16748.17720754475, 23569.842408295983, 21582.793016285403, 18023.10348248192, 20220.43046261757, 24518.36089606663, 18468.386145665292, 19177.97207078295, 19164.156678108004, 2600.457084435564, 20209.68416257347, 23743.068926118176, 17967.662875151193, 20536.992092421176, 15665.402701963003, 4045.3770948345764, 19486.06445718751, 19103.294568261907, 17651.526864559662, 1006.0583284374844, 19024.219026679006, 17276.292110093924, 20001.58019627009, 20176.512602650942, 19086.664799923576, 17079.28846260387, 16856.850924976377, 18063.710683542602, 20091.110931678064, 18865.69060700317, 17826.6714942287, 15293.915597586203, 17742.97669438703, 19492.798852012766, 20079.780042191236], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 33, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5257.676720159774, 7741.310137383395, 8215.417589957979, 11989.94142517333, 6799.418422952144, 10282.738999142, 5172.745141887106, 107.43765513474327, 8604.807987250932, 8322.476201172534, 8886.88721958133, 3837.876489903703, 3641.6701079041536, 251.5660591323314, 7438.290339226305, 9738.202638058938, 11212.949216009858, 7792.501696237628, 7724.530250896213, 3849.3627509898733, 8935.555634322782, 9242.430694008182, 9627.326243615888, 9966.47786526645, 5368.1387305317785, 3802.282042461212, 6606.091440436997, 9228.020324682911, 9595.307976787315, 10.32095469804685, 8585.59962459585, 11615.787167791505, 6748.414572430342, 5254.952859962644, 9783.156502850501, 5156.321194607066, 12.855405382216288, 5070.219542204692, 8536.355051403598, 5114.250849970274, 5816.2820563470295, 10033.86157452337, 4631.203157384285, 3596.7001711518838, 115.46386577442344, 3604.713588694138, 9335.794153477162, 2829.465672424331, 5719.813203129577, 7634.695362879106, 5100.171272760839, 24.594173406494164, 9145.503383191051, 5045.3602339736235, 8887.510479996745, 7554.6825477402635, 8242.24706903601, 9336.584414769877, 6428.87927541371, 10420.297387700975, 8097.728041634535, 6652.821685952613, 7143.555541581087, 7871.705770540559, 6152.145774753573, 9578.768110679508, 4324.780907021106, 5741.651040681787, 6970.514522470202, 6949.743525550026, 2752.1382720718834, 8771.675881512132, 8256.684292426291, 7885.313719441977, 111.0889159793072, 7402.514229374987, 4012.3030809492725, 9532.910170300525, 7461.031257055867, 9831.520010852364, 487.903656268272, 7479.728551067617, 5960.055472605459, 10234.322234611644, 59.350007924130615, 8671.148604678541, 8802.69449006772, 6657.410503505917, 7434.404403032652, 7793.094314842358, 7792.6017357196015, 6665.01630028083, 9294.66007841781, 7772.226072157091, 9014.584217341053, 9738.238383344753, 10229.601160011352, 8160.4915456835715, 7640.427880530923, 7918.7001544807945], "policy_adversary_policy_reward": [5743.966721381463, 8884.458903571187, 6400.825486347553, 4248.715775495665, 4291.0144415471495, 5926.718033772973, 786.8338573653742, 2128.1654647475334, 6037.066209260844, 7342.717200778807, 1340.4821496903164, 3859.396624588934, 8469.022003294485, 8946.54577304915, 953.222516645078, 437.2807943612454, 5480.525034317068, 5029.233087398922, 3539.87513995467, 5819.659422558406, 5215.7693999588855, 5097.74709296723, 10279.38235406769, 9315.810591981437, 9067.586367867118, 9353.147958652762, 1629.8746373206375, 1544.0279095926412, 3145.789904120105, 6703.845284504645, 3108.717795979855, 4242.798708138963, 1575.6280466443125, 2929.186407721094, 6349.633927493326, 5722.578565758551, 6332.839718393519, 5992.609560857737, 10095.986721239115, 7868.137001931317, 5198.088034875887, 4443.341067604543, 4899.704929722781, 3493.2636676747784, 3791.4884992400202, 4122.430693340354, 4175.657758464502, 2428.9887216937045, 8687.159276698325, 8635.04201436057, 8664.344796650208, 9520.2472068898, 7131.759350613735, 7370.391341164813, 4818.1467994537, 4536.078004073195, 4244.4950197454245, 3792.0779058676385, 272.52175777657214, 223.12001867143084, 5109.963478779278, 4735.678523471586, 2444.7864452198937, 2514.9779309072615, 6085.737575583388, 7393.721051300603, 8820.71557258727, 8235.056377552943, 4358.979120880459, 2194.0242002714267, 8298.110300059705, 8474.782475709375, 269.9873070924027, 138.68421498632478, 3938.178166838069, 9071.916081526257, 4270.096349545407, 4585.171818777766, 8715.139550208893, 8565.479587650514, 4872.574168463304, 8321.70765517041, 3955.0846689401233, 3585.5409195112966, 9479.954024962348, 9435.244173403604, 10525.828670638346, 9523.571294836724, 748.619429748852, 945.1963060053979, 7445.160705586028, 10537.422035036825, 4806.332630229856, 3672.9711672562344, 10804.66780763973, 9425.327756413852, 5979.94184493976, 8397.269686491705, 6404.390672480962, 6403.911743624493, 8351.908453185504, 9031.539996143067, 437.60264177232034, 470.3805734240891, 3109.9006276493856, 4991.793660073681, 8550.464272625306, 9081.642130393457, 5254.625143734217, 4124.893903227999, 5690.514642621764, 6587.4530759906875, 5899.888554694936, 4571.199141931865, 3752.3768527996644, 4660.805060375472, 7013.655129383062, 7688.72100266298, 3693.546497437967, 3317.071294729856, 5763.328659812694, 5765.545169560667, 7153.210207038054, 6308.088476885174, 6998.580082149855, 3775.32811999587, 5658.605637465427, 6036.417013177489, 7839.418052473356, 7731.718450578908, 2607.1058279516324, 4562.30326891364, 9492.202124030204, 9752.85937724463, 7440.657392554443, 8400.484583049167, 7171.62110126075, 3880.9678587509575, 6087.0133535986, 7183.673583468893, 10981.770452225554, 10784.45217176919, 4416.946614153088, 5279.763650000049, 5062.054682896877, 5859.233095459824, 6256.821904288978, 5022.021054377071, 1212.1271696189979, 1277.2409988372585, 6077.326000855645, 6729.8439323428975, 9808.493097284541, 9922.272747884308, 3834.1225146466186, 4600.630190204065, 6648.674728486214, 6427.286106879098, 4310.6156128785915, 1523.267078232047, 1834.4089370441213, 1723.0645015221826, 6661.987425852623, 5344.348480267299, 8182.0801511254995, 4961.158944530966, 3863.1706717344555, 3554.033958213572, 718.4674513810717, 228.240869132282, 4882.083402948042, 5470.98701905241, 5338.6456164824785, 3134.952003543724, 7484.725120225028, 5859.444572539123, 6539.193645504736, 6202.914554113553, 5423.625758313666, 5869.944726767585, 2937.1528388729093, 6349.533888011342, 7477.119323450134, 2714.7153012454096, 4753.688355694776, 4015.3622494299934, 6311.464671358845, 6007.420188162048, 4819.5817122544995, 5031.524677407617, 4159.705691806919, 3928.7274190770063, 1151.7799738552067, 3912.53446371962, 5981.644078047379, 3600.841070656072, 6501.707743200031, 5350.663228281773, 6167.134880943585, 5993.9450067668595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025610368848919, "mean_inference_ms": 1.00096258959138, "mean_action_processing_ms": 0.1688840025741946, "mean_env_wait_ms": 0.05479467138130719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00334012508392334, "StateBufferConnector_ms": 0.0029354095458984375, "ViewRequirementAgentConnector_ms": 0.06817507743835449}, "num_episodes": 21, "episode_return_max": 24518.36089606663, "episode_return_min": 421.5269274609438, "episode_return_mean": 17794.836216082444}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.6841165735888, "num_env_steps_trained_throughput_per_sec": 509.6841165735888, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 8199.299, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8199.262, "sample_time_ms": 806.615, "learn_time_ms": 7380.412, "learn_throughput": 541.975, "synch_weights_time_ms": 11.749}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 58, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-36-59", "timestamp": 1723235819, "time_this_iter_s": 7.853065013885498, "time_total_s": 447.9205791950226, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322241310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 447.9205791950226, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 26.91818181818182, "ram_util_percent": 82.64545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5995154642948398, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99079619160405, "policy_loss": -0.0014898994277236324, "vf_loss": 9.991332587489376, "vf_explained_var": 2.319664551467492e-05, "kl": 0.007937033819256438, "entropy": 0.7195434577565976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8571585728786886, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002440863847733, "policy_loss": -0.0020185545086860656, "vf_loss": 9.997636396686236, "vf_explained_var": -0.00025110157827536265, "kl": 0.008985053612074504, "entropy": 1.4415552151699862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "env_runners": {"episode_reward_max": 24631.668206502007, "episode_reward_min": 111.13834831692867, "episode_reward_mean": 18071.91663623339, "episode_len_mean": 184.96, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18496, "policy_reward_min": {"agent_policy": 0.4349665505778883, "adversary_policy": 40.4276701982739}, "policy_reward_max": {"agent_policy": 11615.787167791505, "adversary_policy": 10981.770452225554}, "policy_reward_mean": {"agent_policy": 6767.478797787806, "adversary_policy": 5652.218919222791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17541.24543619629, 16571.12434542467, 22690.340021590673, 21986.874046001176, 21108.24213221556, 18582.24512820976, 17631.88090240039, 505.96273114604986, 18431.241626846706, 16575.55154391864, 20227.873199314323, 22310.724810102874, 16336.159824002403, 21929.213970376117, 421.5269274609438, 18080.313790569016, 17391.623219726796, 22394.869987829603, 19010.563879980735, 17574.48716297478, 23546.40135575023, 23646.10013662699, 1809.2796015286735, 21587.296329317007, 17815.09795096323, 23059.461236477935, 20097.02473456107, 20442.99777898454, 22483.619722089414, 932.5773886029037, 17247.197670914127, 22677.466636992394, 18267.02952695894, 19832.650266352743, 18713.334765662803, 17749.766327945003, 21131.25540745974, 17430.91517986879, 19626.601871007842, 20114.12036987581, 17917.46374372683, 19566.728421183467, 21723.282277805865, 16748.17720754475, 23569.842408295983, 21582.793016285403, 18023.10348248192, 20220.43046261757, 24518.36089606663, 18468.386145665292, 19177.97207078295, 19164.156678108004, 2600.457084435564, 20209.68416257347, 23743.068926118176, 17967.662875151193, 20536.992092421176, 15665.402701963003, 4045.3770948345764, 19486.06445718751, 19103.294568261907, 17651.526864559662, 1006.0583284374844, 19024.219026679006, 17276.292110093924, 20001.58019627009, 20176.512602650942, 19086.664799923576, 17079.28846260387, 16856.850924976377, 18063.710683542602, 20091.110931678064, 18865.69060700317, 17826.6714942287, 15293.915597586203, 17742.97669438703, 19492.798852012766, 20079.780042191236, 22214.04289738076, 19786.705108038295, 18068.98061995555, 111.13834831692867, 18394.31040911968, 20860.315302566258, 21361.72822996334, 17821.84857496445, 16746.811942976157, 22460.07676906373, 18324.873547843014, 16365.148853314282, 21076.571371649094, 18480.668971557745, 20035.32242719269, 17346.366630920857, 17858.79820753439, 20239.244351800673, 24631.668206502007, 21291.43804618569, 19404.298175512155, 19144.698694417424], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 33, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9627.326243615888, 9966.47786526645, 5368.1387305317785, 3802.282042461212, 6606.091440436997, 9228.020324682911, 9595.307976787315, 10.32095469804685, 8585.59962459585, 11615.787167791505, 6748.414572430342, 5254.952859962644, 9783.156502850501, 5156.321194607066, 12.855405382216288, 5070.219542204692, 8536.355051403598, 5114.250849970274, 5816.2820563470295, 10033.86157452337, 4631.203157384285, 3596.7001711518838, 115.46386577442344, 3604.713588694138, 9335.794153477162, 2829.465672424331, 5719.813203129577, 7634.695362879106, 5100.171272760839, 24.594173406494164, 9145.503383191051, 5045.3602339736235, 8887.510479996745, 7554.6825477402635, 8242.24706903601, 9336.584414769877, 6428.87927541371, 10420.297387700975, 8097.728041634535, 6652.821685952613, 7143.555541581087, 7871.705770540559, 6152.145774753573, 9578.768110679508, 4324.780907021106, 5741.651040681787, 6970.514522470202, 6949.743525550026, 2752.1382720718834, 8771.675881512132, 8256.684292426291, 7885.313719441977, 111.0889159793072, 7402.514229374987, 4012.3030809492725, 9532.910170300525, 7461.031257055867, 9831.520010852364, 487.903656268272, 7479.728551067617, 5960.055472605459, 10234.322234611644, 59.350007924130615, 8671.148604678541, 8802.69449006772, 6657.410503505917, 7434.404403032652, 7793.094314842358, 7792.6017357196015, 6665.01630028083, 9294.66007841781, 7772.226072157091, 9014.584217341053, 9738.238383344753, 10229.601160011352, 8160.4915456835715, 7640.427880530923, 7918.7001544807945, 5613.929170946853, 4944.459502319955, 9540.59221124295, 0.4349665505778883, 9234.753274836596, 5414.250614372375, 3196.092723584237, 8677.576104411053, 9755.13413420108, 5369.162302522629, 9082.091317579174, 8121.160258899091, 6423.661046616171, 6521.99367412607, 7639.055747860382, 9617.918731085674, 9466.292867378794, 7449.713100377192, 3311.784851360484, 5916.340914623033, 6877.816813149594, 7680.709539880686], "policy_adversary_policy_reward": [3791.4884992400202, 4122.430693340354, 4175.657758464502, 2428.9887216937045, 8687.159276698325, 8635.04201436057, 8664.344796650208, 9520.2472068898, 7131.759350613735, 7370.391341164813, 4818.1467994537, 4536.078004073195, 4244.4950197454245, 3792.0779058676385, 272.52175777657214, 223.12001867143084, 5109.963478779278, 4735.678523471586, 2444.7864452198937, 2514.9779309072615, 6085.737575583388, 7393.721051300603, 8820.71557258727, 8235.056377552943, 4358.979120880459, 2194.0242002714267, 8298.110300059705, 8474.782475709375, 269.9873070924027, 138.68421498632478, 3938.178166838069, 9071.916081526257, 4270.096349545407, 4585.171818777766, 8715.139550208893, 8565.479587650514, 4872.574168463304, 8321.70765517041, 3955.0846689401233, 3585.5409195112966, 9479.954024962348, 9435.244173403604, 10525.828670638346, 9523.571294836724, 748.619429748852, 945.1963060053979, 7445.160705586028, 10537.422035036825, 4806.332630229856, 3672.9711672562344, 10804.66780763973, 9425.327756413852, 5979.94184493976, 8397.269686491705, 6404.390672480962, 6403.911743624493, 8351.908453185504, 9031.539996143067, 437.60264177232034, 470.3805734240891, 3109.9006276493856, 4991.793660073681, 8550.464272625306, 9081.642130393457, 5254.625143734217, 4124.893903227999, 5690.514642621764, 6587.4530759906875, 5899.888554694936, 4571.199141931865, 3752.3768527996644, 4660.805060375472, 7013.655129383062, 7688.72100266298, 3693.546497437967, 3317.071294729856, 5763.328659812694, 5765.545169560667, 7153.210207038054, 6308.088476885174, 6998.580082149855, 3775.32811999587, 5658.605637465427, 6036.417013177489, 7839.418052473356, 7731.718450578908, 2607.1058279516324, 4562.30326891364, 9492.202124030204, 9752.85937724463, 7440.657392554443, 8400.484583049167, 7171.62110126075, 3880.9678587509575, 6087.0133535986, 7183.673583468893, 10981.770452225554, 10784.45217176919, 4416.946614153088, 5279.763650000049, 5062.054682896877, 5859.233095459824, 6256.821904288978, 5022.021054377071, 1212.1271696189979, 1277.2409988372585, 6077.326000855645, 6729.8439323428975, 9808.493097284541, 9922.272747884308, 3834.1225146466186, 4600.630190204065, 6648.674728486214, 6427.286106879098, 4310.6156128785915, 1523.267078232047, 1834.4089370441213, 1723.0645015221826, 6661.987425852623, 5344.348480267299, 8182.0801511254995, 4961.158944530966, 3863.1706717344555, 3554.033958213572, 718.4674513810717, 228.240869132282, 4882.083402948042, 5470.98701905241, 5338.6456164824785, 3134.952003543724, 7484.725120225028, 5859.444572539123, 6539.193645504736, 6202.914554113553, 5423.625758313666, 5869.944726767585, 2937.1528388729093, 6349.533888011342, 7477.119323450134, 2714.7153012454096, 4753.688355694776, 4015.3622494299934, 6311.464671358845, 6007.420188162048, 4819.5817122544995, 5031.524677407617, 4159.705691806919, 3928.7274190770063, 1151.7799738552067, 3912.53446371962, 5981.644078047379, 3600.841070656072, 6501.707743200031, 5350.663228281773, 6167.134880943585, 5993.9450067668595, 8515.286704688497, 8084.827021745367, 5700.523836665987, 9141.721769052321, 3946.249379766808, 4582.139028945791, 40.4276701982739, 70.27571156807687, 4771.685800239433, 4387.871334043614, 8225.38362126615, 7220.6810669276965, 7663.1912217127865, 10502.444284666355, 5136.1535321051715, 4008.1189384482736, 2663.7425244199612, 4327.935284355083, 8722.870506607933, 8368.043959933206, 4834.985749121301, 4407.796481142533, 2223.0132295833396, 6020.975364831852, 7059.173286142733, 7593.7370388901845, 7614.075580100361, 4344.599717331355, 6497.928943624872, 5898.337735707391, 3204.2310071898823, 4524.216892645265, 4422.947933405813, 3969.5574067497755, 6171.920753483561, 6617.610497939918, 10801.019394685907, 10518.863960455645, 7384.6865927612, 7990.410538801461, 5428.227154440393, 7098.254207922145, 5445.304713834024, 6018.684440702732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40248570012059853, "mean_inference_ms": 1.001025799504852, "mean_action_processing_ms": 0.16895953777340086, "mean_env_wait_ms": 0.05481248290955538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003466486930847168, "StateBufferConnector_ms": 0.0029168128967285156, "ViewRequirementAgentConnector_ms": 0.06947767734527588}, "num_episodes": 22, "episode_return_max": 24631.668206502007, "episode_return_min": 111.13834831692867, "episode_return_mean": 18071.91663623339}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.8109435181171, "num_env_steps_trained_throughput_per_sec": 495.8109435181171, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 8145.021, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8144.983, "sample_time_ms": 801.347, "learn_time_ms": 7331.451, "learn_throughput": 545.595, "synch_weights_time_ms": 11.759}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "training_iteration": 59, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-37-07", "timestamp": 1723235827, "time_this_iter_s": 8.073645114898682, "time_total_s": 455.99422430992126, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32073ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 455.99422430992126, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 27.125000000000004, "ram_util_percent": 82.40833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7155103513172695, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.97408221058114, "policy_loss": -0.00497195647004499, "vf_loss": 9.977141856138038, "vf_explained_var": -4.0447144281296506e-05, "kl": 0.01591782269275023, "entropy": 0.6884004939170111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8780196031865974, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000486158331235, "policy_loss": -0.004563491611528055, "vf_loss": 9.997604955236117, "vf_explained_var": -0.00025508167843023933, "kl": 0.009803698100343657, "entropy": 1.4537445855637392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 24631.668206502007, "episode_reward_min": 90.28609336219839, "episode_reward_mean": 18114.967945777644, "episode_len_mean": 186.89, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18689, "policy_reward_min": {"agent_policy": 0.4349665505778883, "adversary_policy": 19.57541524354363}, "policy_reward_max": {"agent_policy": 11199.422336392712, "adversary_policy": 10981.770452225554}, "policy_reward_mean": {"agent_policy": 6946.67001493471, "adversary_policy": 5584.148965421466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23646.10013662699, 1809.2796015286735, 21587.296329317007, 17815.09795096323, 23059.461236477935, 20097.02473456107, 20442.99777898454, 22483.619722089414, 932.5773886029037, 17247.197670914127, 22677.466636992394, 18267.02952695894, 19832.650266352743, 18713.334765662803, 17749.766327945003, 21131.25540745974, 17430.91517986879, 19626.601871007842, 20114.12036987581, 17917.46374372683, 19566.728421183467, 21723.282277805865, 16748.17720754475, 23569.842408295983, 21582.793016285403, 18023.10348248192, 20220.43046261757, 24518.36089606663, 18468.386145665292, 19177.97207078295, 19164.156678108004, 2600.457084435564, 20209.68416257347, 23743.068926118176, 17967.662875151193, 20536.992092421176, 15665.402701963003, 4045.3770948345764, 19486.06445718751, 19103.294568261907, 17651.526864559662, 1006.0583284374844, 19024.219026679006, 17276.292110093924, 20001.58019627009, 20176.512602650942, 19086.664799923576, 17079.28846260387, 16856.850924976377, 18063.710683542602, 20091.110931678064, 18865.69060700317, 17826.6714942287, 15293.915597586203, 17742.97669438703, 19492.798852012766, 20079.780042191236, 22214.04289738076, 19786.705108038295, 18068.98061995555, 111.13834831692867, 18394.31040911968, 20860.315302566258, 21361.72822996334, 17821.84857496445, 16746.811942976157, 22460.07676906373, 18324.873547843014, 16365.148853314282, 21076.571371649094, 18480.668971557745, 20035.32242719269, 17346.366630920857, 17858.79820753439, 20239.244351800673, 24631.668206502007, 21291.43804618569, 19404.298175512155, 19144.698694417424, 20630.119445395776, 20184.09366579467, 20506.390947022024, 17487.186521569714, 18475.640923828483, 18687.99449798235, 18180.386472928203, 16228.866778861358, 19954.1846618749, 17852.928853958434, 22555.44531457158, 21274.234600753454, 15114.909593153074, 18574.210487946726, 17418.591254407995, 90.28609336219839, 17869.98080477577, 17693.906803694426, 19472.861518364072, 19968.719402934938, 16932.65835328298], "episode_lengths": [200, 15, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 33, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3596.7001711518838, 115.46386577442344, 3604.713588694138, 9335.794153477162, 2829.465672424331, 5719.813203129577, 7634.695362879106, 5100.171272760839, 24.594173406494164, 9145.503383191051, 5045.3602339736235, 8887.510479996745, 7554.6825477402635, 8242.24706903601, 9336.584414769877, 6428.87927541371, 10420.297387700975, 8097.728041634535, 6652.821685952613, 7143.555541581087, 7871.705770540559, 6152.145774753573, 9578.768110679508, 4324.780907021106, 5741.651040681787, 6970.514522470202, 6949.743525550026, 2752.1382720718834, 8771.675881512132, 8256.684292426291, 7885.313719441977, 111.0889159793072, 7402.514229374987, 4012.3030809492725, 9532.910170300525, 7461.031257055867, 9831.520010852364, 487.903656268272, 7479.728551067617, 5960.055472605459, 10234.322234611644, 59.350007924130615, 8671.148604678541, 8802.69449006772, 6657.410503505917, 7434.404403032652, 7793.094314842358, 7792.6017357196015, 6665.01630028083, 9294.66007841781, 7772.226072157091, 9014.584217341053, 9738.238383344753, 10229.601160011352, 8160.4915456835715, 7640.427880530923, 7918.7001544807945, 5613.929170946853, 4944.459502319955, 9540.59221124295, 0.4349665505778883, 9234.753274836596, 5414.250614372375, 3196.092723584237, 8677.576104411053, 9755.13413420108, 5369.162302522629, 9082.091317579174, 8121.160258899091, 6423.661046616171, 6521.99367412607, 7639.055747860382, 9617.918731085674, 9466.292867378794, 7449.713100377192, 3311.784851360484, 5916.340914623033, 6877.816813149594, 7680.709539880686, 7130.545243265198, 7922.388237222517, 3608.2099155886685, 6664.122281494872, 8992.900642743003, 8816.822801602011, 8389.77953878462, 9932.30623431088, 7912.248956874581, 8710.494990705809, 4855.871968620046, 4060.9642542465403, 11199.422336392712, 5990.816928154252, 9479.889199072097, 0.7023653231384079, 9969.935267100547, 10190.355162488997, 7949.12538123472, 7823.730063647797, 8881.715083751391], "policy_adversary_policy_reward": [10525.828670638346, 9523.571294836724, 748.619429748852, 945.1963060053979, 7445.160705586028, 10537.422035036825, 4806.332630229856, 3672.9711672562344, 10804.66780763973, 9425.327756413852, 5979.94184493976, 8397.269686491705, 6404.390672480962, 6403.911743624493, 8351.908453185504, 9031.539996143067, 437.60264177232034, 470.3805734240891, 3109.9006276493856, 4991.793660073681, 8550.464272625306, 9081.642130393457, 5254.625143734217, 4124.893903227999, 5690.514642621764, 6587.4530759906875, 5899.888554694936, 4571.199141931865, 3752.3768527996644, 4660.805060375472, 7013.655129383062, 7688.72100266298, 3693.546497437967, 3317.071294729856, 5763.328659812694, 5765.545169560667, 7153.210207038054, 6308.088476885174, 6998.580082149855, 3775.32811999587, 5658.605637465427, 6036.417013177489, 7839.418052473356, 7731.718450578908, 2607.1058279516324, 4562.30326891364, 9492.202124030204, 9752.85937724463, 7440.657392554443, 8400.484583049167, 7171.62110126075, 3880.9678587509575, 6087.0133535986, 7183.673583468893, 10981.770452225554, 10784.45217176919, 4416.946614153088, 5279.763650000049, 5062.054682896877, 5859.233095459824, 6256.821904288978, 5022.021054377071, 1212.1271696189979, 1277.2409988372585, 6077.326000855645, 6729.8439323428975, 9808.493097284541, 9922.272747884308, 3834.1225146466186, 4600.630190204065, 6648.674728486214, 6427.286106879098, 4310.6156128785915, 1523.267078232047, 1834.4089370441213, 1723.0645015221826, 6661.987425852623, 5344.348480267299, 8182.0801511254995, 4961.158944530966, 3863.1706717344555, 3554.033958213572, 718.4674513810717, 228.240869132282, 4882.083402948042, 5470.98701905241, 5338.6456164824785, 3134.952003543724, 7484.725120225028, 5859.444572539123, 6539.193645504736, 6202.914554113553, 5423.625758313666, 5869.944726767585, 2937.1528388729093, 6349.533888011342, 7477.119323450134, 2714.7153012454096, 4753.688355694776, 4015.3622494299934, 6311.464671358845, 6007.420188162048, 4819.5817122544995, 5031.524677407617, 4159.705691806919, 3928.7274190770063, 1151.7799738552067, 3912.53446371962, 5981.644078047379, 3600.841070656072, 6501.707743200031, 5350.663228281773, 6167.134880943585, 5993.9450067668595, 8515.286704688497, 8084.827021745367, 5700.523836665987, 9141.721769052321, 3946.249379766808, 4582.139028945791, 40.4276701982739, 70.27571156807687, 4771.685800239433, 4387.871334043614, 8225.38362126615, 7220.6810669276965, 7663.1912217127865, 10502.444284666355, 5136.1535321051715, 4008.1189384482736, 2663.7425244199612, 4327.935284355083, 8722.870506607933, 8368.043959933206, 4834.985749121301, 4407.796481142533, 2223.0132295833396, 6020.975364831852, 7059.173286142733, 7593.7370388901845, 7614.075580100361, 4344.599717331355, 6497.928943624872, 5898.337735707391, 3204.2310071898823, 4524.216892645265, 4422.947933405813, 3969.5574067497755, 6171.920753483561, 6617.610497939918, 10801.019394685907, 10518.863960455645, 7384.6865927612, 7990.410538801461, 5428.227154440393, 7098.254207922145, 5445.304713834024, 6018.684440702732, 6494.8039043531335, 7004.770297777428, 6106.113495871246, 6155.59193270092, 6372.645703800388, 10525.535327632992, 7478.013342236086, 3345.0508978387734, 4425.946150304885, 5056.794130780639, 4579.083850404896, 5292.087845975471, 4594.80618505828, 5195.800749085315, 4143.17525032284, 2153.3852942276253, 5847.7110647742475, 6194.224640226058, 5407.685130082075, 3734.7487331705343, 8547.99807325275, 9151.575272698821, 9922.301151066476, 7290.969195440393, 972.7739694221166, 2942.713287338242, 8151.318695576693, 4432.074864215757, 3276.4556306770246, 4662.246424658858, 70.00831279551635, 19.57541524354363, 3954.6332580739927, 3945.412279601232, 3552.246791817096, 3951.304849388342, 5382.779664514828, 6140.956472614528, 6309.245549132261, 5835.74379015494, 2790.5227295520035, 5260.420539979568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025001118410757, "mean_inference_ms": 1.001222560378167, "mean_action_processing_ms": 0.16902051522773598, "mean_env_wait_ms": 0.054862561007507506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034886598587036133, "StateBufferConnector_ms": 0.0026198625564575195, "ViewRequirementAgentConnector_ms": 0.06848394870758057}, "num_episodes": 21, "episode_return_max": 24631.668206502007, "episode_return_min": 90.28609336219839, "episode_return_mean": 18114.967945777644}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.33390861902774, "num_env_steps_trained_throughput_per_sec": 449.33390861902774, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 8193.323, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8193.286, "sample_time_ms": 800.565, "learn_time_ms": 7380.447, "learn_throughput": 541.973, "synch_weights_time_ms": 11.838}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 60, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-37-17", "timestamp": 1723235837, "time_this_iter_s": 8.93279504776001, "time_total_s": 464.9270193576813, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3222413a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 464.9270193576813, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 31.207692307692305, "ram_util_percent": 82.70769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6391662048363181, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.979803002069866, "policy_loss": -0.0021204258714403426, "vf_loss": 9.980448321690636, "vf_explained_var": 2.1269870182824512e-05, "kl": 0.012278444016298093, "entropy": 0.6780315565999854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9005383689887821, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005440431833268, "policy_loss": -0.0005711073385706793, "vf_loss": 9.995240425070127, "vf_explained_var": -0.00027780719101428987, "kl": 0.014184170993394219, "entropy": 1.471490507821242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "env_runners": {"episode_reward_max": 24631.668206502007, "episode_reward_min": 90.28609336219839, "episode_reward_mean": 18177.875931766226, "episode_len_mean": 188.74, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18874, "policy_reward_min": {"agent_policy": 0.4349665505778883, "adversary_policy": 19.57541524354363}, "policy_reward_max": {"agent_policy": 11233.04890040551, "adversary_policy": 10981.770452225554}, "policy_reward_mean": {"agent_policy": 7039.4931274765495, "adversary_policy": 5569.191402144836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16748.17720754475, 23569.842408295983, 21582.793016285403, 18023.10348248192, 20220.43046261757, 24518.36089606663, 18468.386145665292, 19177.97207078295, 19164.156678108004, 2600.457084435564, 20209.68416257347, 23743.068926118176, 17967.662875151193, 20536.992092421176, 15665.402701963003, 4045.3770948345764, 19486.06445718751, 19103.294568261907, 17651.526864559662, 1006.0583284374844, 19024.219026679006, 17276.292110093924, 20001.58019627009, 20176.512602650942, 19086.664799923576, 17079.28846260387, 16856.850924976377, 18063.710683542602, 20091.110931678064, 18865.69060700317, 17826.6714942287, 15293.915597586203, 17742.97669438703, 19492.798852012766, 20079.780042191236, 22214.04289738076, 19786.705108038295, 18068.98061995555, 111.13834831692867, 18394.31040911968, 20860.315302566258, 21361.72822996334, 17821.84857496445, 16746.811942976157, 22460.07676906373, 18324.873547843014, 16365.148853314282, 21076.571371649094, 18480.668971557745, 20035.32242719269, 17346.366630920857, 17858.79820753439, 20239.244351800673, 24631.668206502007, 21291.43804618569, 19404.298175512155, 19144.698694417424, 20630.119445395776, 20184.09366579467, 20506.390947022024, 17487.186521569714, 18475.640923828483, 18687.99449798235, 18180.386472928203, 16228.866778861358, 19954.1846618749, 17852.928853958434, 22555.44531457158, 21274.234600753454, 15114.909593153074, 18574.210487946726, 17418.591254407995, 90.28609336219839, 17869.98080477577, 17693.906803694426, 19472.861518364072, 19968.719402934938, 16932.65835328298, 18196.209045630938, 19924.651787690822, 21667.973664160734, 19218.29920187841, 17379.024698144192, 22689.57204735279, 18165.31146843049, 17705.532122707147, 23621.87135761923, 19304.393581025917, 16323.80362623242, 23885.66690537996, 19089.48754917898, 816.2170163377392, 20590.26682266403, 16752.284785409607, 18501.674484912768, 21566.93986642987, 20174.7991307941, 17615.939293914766, 20784.339886791768, 16187.80760107765], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 21, 200, 200, 200, 200, 200, 33, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9578.768110679508, 4324.780907021106, 5741.651040681787, 6970.514522470202, 6949.743525550026, 2752.1382720718834, 8771.675881512132, 8256.684292426291, 7885.313719441977, 111.0889159793072, 7402.514229374987, 4012.3030809492725, 9532.910170300525, 7461.031257055867, 9831.520010852364, 487.903656268272, 7479.728551067617, 5960.055472605459, 10234.322234611644, 59.350007924130615, 8671.148604678541, 8802.69449006772, 6657.410503505917, 7434.404403032652, 7793.094314842358, 7792.6017357196015, 6665.01630028083, 9294.66007841781, 7772.226072157091, 9014.584217341053, 9738.238383344753, 10229.601160011352, 8160.4915456835715, 7640.427880530923, 7918.7001544807945, 5613.929170946853, 4944.459502319955, 9540.59221124295, 0.4349665505778883, 9234.753274836596, 5414.250614372375, 3196.092723584237, 8677.576104411053, 9755.13413420108, 5369.162302522629, 9082.091317579174, 8121.160258899091, 6423.661046616171, 6521.99367412607, 7639.055747860382, 9617.918731085674, 9466.292867378794, 7449.713100377192, 3311.784851360484, 5916.340914623033, 6877.816813149594, 7680.709539880686, 7130.545243265198, 7922.388237222517, 3608.2099155886685, 6664.122281494872, 8992.900642743003, 8816.822801602011, 8389.77953878462, 9932.30623431088, 7912.248956874581, 8710.494990705809, 4855.871968620046, 4060.9642542465403, 11199.422336392712, 5990.816928154252, 9479.889199072097, 0.7023653231384079, 9969.935267100547, 10190.355162488997, 7949.12538123472, 7823.730063647797, 8881.715083751391, 9090.712471370569, 3011.9778285737493, 4499.039986281336, 4695.6812842694535, 9802.204508643845, 3350.5199567306017, 7855.627446069575, 9104.038599125375, 4469.237131415971, 8378.622056691645, 8505.680720190165, 3820.090147563502, 6071.067390231262, 29.764233994477685, 6070.2111932512, 11233.04890040551, 9256.53501571859, 5988.754449305272, 7621.999493331019, 9834.830722297243, 7090.5275623551715, 8442.573226351065], "policy_adversary_policy_reward": [2607.1058279516324, 4562.30326891364, 9492.202124030204, 9752.85937724463, 7440.657392554443, 8400.484583049167, 7171.62110126075, 3880.9678587509575, 6087.0133535986, 7183.673583468893, 10981.770452225554, 10784.45217176919, 4416.946614153088, 5279.763650000049, 5062.054682896877, 5859.233095459824, 6256.821904288978, 5022.021054377071, 1212.1271696189979, 1277.2409988372585, 6077.326000855645, 6729.8439323428975, 9808.493097284541, 9922.272747884308, 3834.1225146466186, 4600.630190204065, 6648.674728486214, 6427.286106879098, 4310.6156128785915, 1523.267078232047, 1834.4089370441213, 1723.0645015221826, 6661.987425852623, 5344.348480267299, 8182.0801511254995, 4961.158944530966, 3863.1706717344555, 3554.033958213572, 718.4674513810717, 228.240869132282, 4882.083402948042, 5470.98701905241, 5338.6456164824785, 3134.952003543724, 7484.725120225028, 5859.444572539123, 6539.193645504736, 6202.914554113553, 5423.625758313666, 5869.944726767585, 2937.1528388729093, 6349.533888011342, 7477.119323450134, 2714.7153012454096, 4753.688355694776, 4015.3622494299934, 6311.464671358845, 6007.420188162048, 4819.5817122544995, 5031.524677407617, 4159.705691806919, 3928.7274190770063, 1151.7799738552067, 3912.53446371962, 5981.644078047379, 3600.841070656072, 6501.707743200031, 5350.663228281773, 6167.134880943585, 5993.9450067668595, 8515.286704688497, 8084.827021745367, 5700.523836665987, 9141.721769052321, 3946.249379766808, 4582.139028945791, 40.4276701982739, 70.27571156807687, 4771.685800239433, 4387.871334043614, 8225.38362126615, 7220.6810669276965, 7663.1912217127865, 10502.444284666355, 5136.1535321051715, 4008.1189384482736, 2663.7425244199612, 4327.935284355083, 8722.870506607933, 8368.043959933206, 4834.985749121301, 4407.796481142533, 2223.0132295833396, 6020.975364831852, 7059.173286142733, 7593.7370388901845, 7614.075580100361, 4344.599717331355, 6497.928943624872, 5898.337735707391, 3204.2310071898823, 4524.216892645265, 4422.947933405813, 3969.5574067497755, 6171.920753483561, 6617.610497939918, 10801.019394685907, 10518.863960455645, 7384.6865927612, 7990.410538801461, 5428.227154440393, 7098.254207922145, 5445.304713834024, 6018.684440702732, 6494.8039043531335, 7004.770297777428, 6106.113495871246, 6155.59193270092, 6372.645703800388, 10525.535327632992, 7478.013342236086, 3345.0508978387734, 4425.946150304885, 5056.794130780639, 4579.083850404896, 5292.087845975471, 4594.80618505828, 5195.800749085315, 4143.17525032284, 2153.3852942276253, 5847.7110647742475, 6194.224640226058, 5407.685130082075, 3734.7487331705343, 8547.99807325275, 9151.575272698821, 9922.301151066476, 7290.969195440393, 972.7739694221166, 2942.713287338242, 8151.318695576693, 4432.074864215757, 3276.4556306770246, 4662.246424658858, 70.00831279551635, 19.57541524354363, 3954.6332580739927, 3945.412279601232, 3552.246791817096, 3951.304849388342, 5382.779664514828, 6140.956472614528, 6309.245549132261, 5835.74379015494, 2790.5227295520035, 5260.420539979568, 4305.139706937676, 4800.356867322718, 5934.2929669217865, 10978.380992195316, 7532.780682800483, 9636.15299507889, 9446.454339461503, 5076.1635781474915, 4306.60976301844, 3270.2104264819313, 9632.764480306048, 9706.287610316218, 4053.2537227957678, 6256.4302995651415, 5031.317755254315, 3570.175768327451, 9485.90457189527, 9666.729654307952, 5166.111557500089, 5759.659966834162, 2181.668002501492, 5636.454903540783, 9851.953651077201, 10213.623106739202, 4947.985825207513, 8070.434333740183, 321.242269507156, 465.21051283610564, 6580.484408842863, 7939.57122056992, 2748.192478098088, 2771.0434069060166, 4647.6137354917855, 4597.525733702401, 8060.901309687276, 7517.284107437309, 6033.893697749182, 6518.905939713893, 4295.795442397923, 3485.3131292196003, 7051.575723276644, 6642.236601159943, 5699.562397379882, 2045.6719773467266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4029033947839371, "mean_inference_ms": 1.0021367942392627, "mean_action_processing_ms": 0.16931065463556155, "mean_env_wait_ms": 0.05493854623555146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037022829055786133, "StateBufferConnector_ms": 0.0027354955673217773, "ViewRequirementAgentConnector_ms": 0.07127904891967773}, "num_episodes": 22, "episode_return_max": 24631.668206502007, "episode_return_min": 90.28609336219839, "episode_return_mean": 18177.875931766226}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.7081611276524, "num_env_steps_trained_throughput_per_sec": 442.7081611276524, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 8287.609, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8287.57, "sample_time_ms": 814.559, "learn_time_ms": 7460.246, "learn_throughput": 536.175, "synch_weights_time_ms": 12.052}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "training_iteration": 61, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-37-26", "timestamp": 1723235846, "time_this_iter_s": 9.097567081451416, "time_total_s": 474.0245864391327, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3222415e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.0245864391327, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 38.92307692307693, "ram_util_percent": 83.18461538461537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6551945702660651, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98608977605426, "policy_loss": -0.004629735540963275, "vf_loss": 9.988344754113092, "vf_explained_var": -1.6442398545603274e-05, "kl": 0.019767260332542554, "entropy": 0.6794479260684321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8436541126730541, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00561520755291, "policy_loss": -0.0026191702427847, "vf_loss": 10.0, "vf_explained_var": -0.00035667183498541515, "kl": 0.010843653197419674, "entropy": 1.457767353951931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 24631.668206502007, "episode_reward_min": 90.28609336219839, "episode_reward_mean": 18420.63428827525, "episode_len_mean": 192.2, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 19220, "policy_reward_min": {"agent_policy": 0.4349665505778883, "adversary_policy": 19.57541524354363}, "policy_reward_max": {"agent_policy": 11515.545450678257, "adversary_policy": 10978.380992195316}, "policy_reward_mean": {"agent_policy": 7190.4799823732055, "adversary_policy": 5615.07715295102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17651.526864559662, 1006.0583284374844, 19024.219026679006, 17276.292110093924, 20001.58019627009, 20176.512602650942, 19086.664799923576, 17079.28846260387, 16856.850924976377, 18063.710683542602, 20091.110931678064, 18865.69060700317, 17826.6714942287, 15293.915597586203, 17742.97669438703, 19492.798852012766, 20079.780042191236, 22214.04289738076, 19786.705108038295, 18068.98061995555, 111.13834831692867, 18394.31040911968, 20860.315302566258, 21361.72822996334, 17821.84857496445, 16746.811942976157, 22460.07676906373, 18324.873547843014, 16365.148853314282, 21076.571371649094, 18480.668971557745, 20035.32242719269, 17346.366630920857, 17858.79820753439, 20239.244351800673, 24631.668206502007, 21291.43804618569, 19404.298175512155, 19144.698694417424, 20630.119445395776, 20184.09366579467, 20506.390947022024, 17487.186521569714, 18475.640923828483, 18687.99449798235, 18180.386472928203, 16228.866778861358, 19954.1846618749, 17852.928853958434, 22555.44531457158, 21274.234600753454, 15114.909593153074, 18574.210487946726, 17418.591254407995, 90.28609336219839, 17869.98080477577, 17693.906803694426, 19472.861518364072, 19968.719402934938, 16932.65835328298, 18196.209045630938, 19924.651787690822, 21667.973664160734, 19218.29920187841, 17379.024698144192, 22689.57204735279, 18165.31146843049, 17705.532122707147, 23621.87135761923, 19304.393581025917, 16323.80362623242, 23885.66690537996, 19089.48754917898, 816.2170163377392, 20590.26682266403, 16752.284785409607, 18501.674484912768, 21566.93986642987, 20174.7991307941, 17615.939293914766, 20784.339886791768, 16187.80760107765, 18368.68472779786, 15762.058591222294, 19282.83372001168, 17658.608894324912, 20174.350164125488, 18081.479298305047, 18484.875420808556, 22191.413238045854, 22968.400087852537, 16559.636744914555, 23502.923656056624, 21433.18096578919, 19109.173073735856, 18380.948362496583, 20707.884268353686, 18150.623322477684, 21323.892591508793, 16966.094853870323], "episode_lengths": [200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [10234.322234611644, 59.350007924130615, 8671.148604678541, 8802.69449006772, 6657.410503505917, 7434.404403032652, 7793.094314842358, 7792.6017357196015, 6665.01630028083, 9294.66007841781, 7772.226072157091, 9014.584217341053, 9738.238383344753, 10229.601160011352, 8160.4915456835715, 7640.427880530923, 7918.7001544807945, 5613.929170946853, 4944.459502319955, 9540.59221124295, 0.4349665505778883, 9234.753274836596, 5414.250614372375, 3196.092723584237, 8677.576104411053, 9755.13413420108, 5369.162302522629, 9082.091317579174, 8121.160258899091, 6423.661046616171, 6521.99367412607, 7639.055747860382, 9617.918731085674, 9466.292867378794, 7449.713100377192, 3311.784851360484, 5916.340914623033, 6877.816813149594, 7680.709539880686, 7130.545243265198, 7922.388237222517, 3608.2099155886685, 6664.122281494872, 8992.900642743003, 8816.822801602011, 8389.77953878462, 9932.30623431088, 7912.248956874581, 8710.494990705809, 4855.871968620046, 4060.9642542465403, 11199.422336392712, 5990.816928154252, 9479.889199072097, 0.7023653231384079, 9969.935267100547, 10190.355162488997, 7949.12538123472, 7823.730063647797, 8881.715083751391, 9090.712471370569, 3011.9778285737493, 4499.039986281336, 4695.6812842694535, 9802.204508643845, 3350.5199567306017, 7855.627446069575, 9104.038599125375, 4469.237131415971, 8378.622056691645, 8505.680720190165, 3820.090147563502, 6071.067390231262, 29.764233994477685, 6070.2111932512, 11233.04890040551, 9256.53501571859, 5988.754449305272, 7621.999493331019, 9834.830722297243, 7090.5275623551715, 8442.573226351065, 9294.369660576409, 11515.545450678257, 4776.405433057512, 8491.404461698687, 6095.682801790895, 6239.455945166966, 9213.050222466338, 4737.914593248739, 4453.331548141843, 7654.439073206733, 4088.9510965128006, 5301.9864902082645, 7526.198415574513, 9161.283352752122, 5389.283409465474, 9539.222782713332, 6189.066540166597, 8941.41982854867], "policy_adversary_policy_reward": [3863.1706717344555, 3554.033958213572, 718.4674513810717, 228.240869132282, 4882.083402948042, 5470.98701905241, 5338.6456164824785, 3134.952003543724, 7484.725120225028, 5859.444572539123, 6539.193645504736, 6202.914554113553, 5423.625758313666, 5869.944726767585, 2937.1528388729093, 6349.533888011342, 7477.119323450134, 2714.7153012454096, 4753.688355694776, 4015.3622494299934, 6311.464671358845, 6007.420188162048, 4819.5817122544995, 5031.524677407617, 4159.705691806919, 3928.7274190770063, 1151.7799738552067, 3912.53446371962, 5981.644078047379, 3600.841070656072, 6501.707743200031, 5350.663228281773, 6167.134880943585, 5993.9450067668595, 8515.286704688497, 8084.827021745367, 5700.523836665987, 9141.721769052321, 3946.249379766808, 4582.139028945791, 40.4276701982739, 70.27571156807687, 4771.685800239433, 4387.871334043614, 8225.38362126615, 7220.6810669276965, 7663.1912217127865, 10502.444284666355, 5136.1535321051715, 4008.1189384482736, 2663.7425244199612, 4327.935284355083, 8722.870506607933, 8368.043959933206, 4834.985749121301, 4407.796481142533, 2223.0132295833396, 6020.975364831852, 7059.173286142733, 7593.7370388901845, 7614.075580100361, 4344.599717331355, 6497.928943624872, 5898.337735707391, 3204.2310071898823, 4524.216892645265, 4422.947933405813, 3969.5574067497755, 6171.920753483561, 6617.610497939918, 10801.019394685907, 10518.863960455645, 7384.6865927612, 7990.410538801461, 5428.227154440393, 7098.254207922145, 5445.304713834024, 6018.684440702732, 6494.8039043531335, 7004.770297777428, 6106.113495871246, 6155.59193270092, 6372.645703800388, 10525.535327632992, 7478.013342236086, 3345.0508978387734, 4425.946150304885, 5056.794130780639, 4579.083850404896, 5292.087845975471, 4594.80618505828, 5195.800749085315, 4143.17525032284, 2153.3852942276253, 5847.7110647742475, 6194.224640226058, 5407.685130082075, 3734.7487331705343, 8547.99807325275, 9151.575272698821, 9922.301151066476, 7290.969195440393, 972.7739694221166, 2942.713287338242, 8151.318695576693, 4432.074864215757, 3276.4556306770246, 4662.246424658858, 70.00831279551635, 19.57541524354363, 3954.6332580739927, 3945.412279601232, 3552.246791817096, 3951.304849388342, 5382.779664514828, 6140.956472614528, 6309.245549132261, 5835.74379015494, 2790.5227295520035, 5260.420539979568, 4305.139706937676, 4800.356867322718, 5934.2929669217865, 10978.380992195316, 7532.780682800483, 9636.15299507889, 9446.454339461503, 5076.1635781474915, 4306.60976301844, 3270.2104264819313, 9632.764480306048, 9706.287610316218, 4053.2537227957678, 6256.4302995651415, 5031.317755254315, 3570.175768327451, 9485.90457189527, 9666.729654307952, 5166.111557500089, 5759.659966834162, 2181.668002501492, 5636.454903540783, 9851.953651077201, 10213.623106739202, 4947.985825207513, 8070.434333740183, 321.242269507156, 465.21051283610564, 6580.484408842863, 7939.57122056992, 2748.192478098088, 2771.0434069060166, 4647.6137354917855, 4597.525733702401, 8060.901309687276, 7517.284107437309, 6033.893697749182, 6518.905939713893, 4295.795442397923, 3485.3131292196003, 7051.575723276644, 6642.236601159943, 5699.562397379882, 2045.6719773467266, 4781.507355501406, 4292.807711719995, 2626.5901730526825, 1619.9229674914095, 9365.730190673437, 5140.698096280752, 3516.4732705939427, 5650.731162032264, 6032.21454039455, 8046.452821940056, 7902.679678563987, 3939.3436745741014, 4845.463361926041, 4426.361836416198, 8417.488020138651, 9036.010624658495, 9671.466860640723, 8843.60167906998, 6487.696550524198, 2417.5011211836236, 9777.518022212227, 9636.45453733157, 7291.04534205824, 8840.1491335227, 5337.584193749365, 6245.390464411973, 4477.42261289699, 4742.242396847448, 7392.613705885464, 7925.987153002699, 4051.872885064491, 4559.52765469984, 7181.756967777816, 7953.069083564359, 5200.715795182286, 2823.9592301393154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032605885192025, "mean_inference_ms": 1.0036878509558962, "mean_action_processing_ms": 0.16954979595193842, "mean_env_wait_ms": 0.054992606125786915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038766860961914062, "StateBufferConnector_ms": 0.0027353763580322266, "ViewRequirementAgentConnector_ms": 0.0719611644744873}, "num_episodes": 18, "episode_return_max": 24631.668206502007, "episode_return_min": 90.28609336219839, "episode_return_mean": 18420.63428827525}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.74073821062024, "num_env_steps_trained_throughput_per_sec": 498.74073821062024, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 8215.457, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8215.419, "sample_time_ms": 821.037, "learn_time_ms": 7381.773, "learn_throughput": 541.875, "synch_weights_time_ms": 11.905}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 62, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-37-34", "timestamp": 1723235854, "time_this_iter_s": 8.025718927383423, "time_total_s": 482.0503053665161, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3222419d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 482.0503053665161, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 30.258333333333336, "ram_util_percent": 82.80833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5456293239322288, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999733385964046, "policy_loss": -0.0008088615546791405, "vf_loss": 9.999317620292542, "vf_explained_var": -2.435874686670051e-06, "kl": 0.010193776004706268, "entropy": 0.6519547566534981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.845723887377729, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004507392644882, "policy_loss": 1.8845234687129658e-05, "vf_loss": 10.0, "vf_explained_var": -0.0001748957981665929, "kl": 0.005910861468873918, "entropy": 1.4441714660574994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "env_runners": {"episode_reward_max": 24631.668206502007, "episode_reward_min": 90.28609336219839, "episode_reward_mean": 18930.175251681594, "episode_len_mean": 196.08, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19608, "policy_reward_min": {"agent_policy": 0.7023653231384079, "adversary_policy": 19.57541524354363}, "policy_reward_max": {"agent_policy": 11515.545450678257, "adversary_policy": 10978.380992195316}, "policy_reward_mean": {"agent_policy": 7216.382849168199, "adversary_policy": 5856.8962012567}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18394.31040911968, 20860.315302566258, 21361.72822996334, 17821.84857496445, 16746.811942976157, 22460.07676906373, 18324.873547843014, 16365.148853314282, 21076.571371649094, 18480.668971557745, 20035.32242719269, 17346.366630920857, 17858.79820753439, 20239.244351800673, 24631.668206502007, 21291.43804618569, 19404.298175512155, 19144.698694417424, 20630.119445395776, 20184.09366579467, 20506.390947022024, 17487.186521569714, 18475.640923828483, 18687.99449798235, 18180.386472928203, 16228.866778861358, 19954.1846618749, 17852.928853958434, 22555.44531457158, 21274.234600753454, 15114.909593153074, 18574.210487946726, 17418.591254407995, 90.28609336219839, 17869.98080477577, 17693.906803694426, 19472.861518364072, 19968.719402934938, 16932.65835328298, 18196.209045630938, 19924.651787690822, 21667.973664160734, 19218.29920187841, 17379.024698144192, 22689.57204735279, 18165.31146843049, 17705.532122707147, 23621.87135761923, 19304.393581025917, 16323.80362623242, 23885.66690537996, 19089.48754917898, 816.2170163377392, 20590.26682266403, 16752.284785409607, 18501.674484912768, 21566.93986642987, 20174.7991307941, 17615.939293914766, 20784.339886791768, 16187.80760107765, 18368.68472779786, 15762.058591222294, 19282.83372001168, 17658.608894324912, 20174.350164125488, 18081.479298305047, 18484.875420808556, 22191.413238045854, 22968.400087852537, 16559.636744914555, 23502.923656056624, 21433.18096578919, 19109.173073735856, 18380.948362496583, 20707.884268353686, 18150.623322477684, 21323.892591508793, 16966.094853870323, 17405.880725748862, 20333.628032951237, 18520.26802464088, 17956.95146076762, 21330.364578470675, 22462.035004061832, 19430.94504818387, 21066.511792994337, 19503.406136840265, 16822.602744582728, 17303.526445938103, 17604.55197681539, 18766.568393536065, 20586.8536722147, 18002.07389335503, 18089.949250101803, 24478.440904453233, 20805.633400421237, 19713.174463460033, 18007.356910682753, 18559.888672930443], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9234.753274836596, 5414.250614372375, 3196.092723584237, 8677.576104411053, 9755.13413420108, 5369.162302522629, 9082.091317579174, 8121.160258899091, 6423.661046616171, 6521.99367412607, 7639.055747860382, 9617.918731085674, 9466.292867378794, 7449.713100377192, 3311.784851360484, 5916.340914623033, 6877.816813149594, 7680.709539880686, 7130.545243265198, 7922.388237222517, 3608.2099155886685, 6664.122281494872, 8992.900642743003, 8816.822801602011, 8389.77953878462, 9932.30623431088, 7912.248956874581, 8710.494990705809, 4855.871968620046, 4060.9642542465403, 11199.422336392712, 5990.816928154252, 9479.889199072097, 0.7023653231384079, 9969.935267100547, 10190.355162488997, 7949.12538123472, 7823.730063647797, 8881.715083751391, 9090.712471370569, 3011.9778285737493, 4499.039986281336, 4695.6812842694535, 9802.204508643845, 3350.5199567306017, 7855.627446069575, 9104.038599125375, 4469.237131415971, 8378.622056691645, 8505.680720190165, 3820.090147563502, 6071.067390231262, 29.764233994477685, 6070.2111932512, 11233.04890040551, 9256.53501571859, 5988.754449305272, 7621.999493331019, 9834.830722297243, 7090.5275623551715, 8442.573226351065, 9294.369660576409, 11515.545450678257, 4776.405433057512, 8491.404461698687, 6095.682801790895, 6239.455945166966, 9213.050222466338, 4737.914593248739, 4453.331548141843, 7654.439073206733, 4088.9510965128006, 5301.9864902082645, 7526.198415574513, 9161.283352752122, 5389.283409465474, 9539.222782713332, 6189.066540166597, 8941.41982854867, 10573.021540077783, 7558.851621088095, 7448.643278416411, 8923.504704480525, 5522.449088646533, 4846.034592894781, 7172.2497346427535, 3658.91967910826, 4978.928800547678, 9191.68267392712, 9501.360734209813, 7946.502847898638, 8104.735022973353, 7386.444571638463, 8758.734323182347, 9446.509136515826, 3664.5213030836276, 4547.465153791152, 8398.234603952691, 9804.57261794049, 9135.308588174092], "policy_adversary_policy_reward": [4771.685800239433, 4387.871334043614, 8225.38362126615, 7220.6810669276965, 7663.1912217127865, 10502.444284666355, 5136.1535321051715, 4008.1189384482736, 2663.7425244199612, 4327.935284355083, 8722.870506607933, 8368.043959933206, 4834.985749121301, 4407.796481142533, 2223.0132295833396, 6020.975364831852, 7059.173286142733, 7593.7370388901845, 7614.075580100361, 4344.599717331355, 6497.928943624872, 5898.337735707391, 3204.2310071898823, 4524.216892645265, 4422.947933405813, 3969.5574067497755, 6171.920753483561, 6617.610497939918, 10801.019394685907, 10518.863960455645, 7384.6865927612, 7990.410538801461, 5428.227154440393, 7098.254207922145, 5445.304713834024, 6018.684440702732, 6494.8039043531335, 7004.770297777428, 6106.113495871246, 6155.59193270092, 6372.645703800388, 10525.535327632992, 7478.013342236086, 3345.0508978387734, 4425.946150304885, 5056.794130780639, 4579.083850404896, 5292.087845975471, 4594.80618505828, 5195.800749085315, 4143.17525032284, 2153.3852942276253, 5847.7110647742475, 6194.224640226058, 5407.685130082075, 3734.7487331705343, 8547.99807325275, 9151.575272698821, 9922.301151066476, 7290.969195440393, 972.7739694221166, 2942.713287338242, 8151.318695576693, 4432.074864215757, 3276.4556306770246, 4662.246424658858, 70.00831279551635, 19.57541524354363, 3954.6332580739927, 3945.412279601232, 3552.246791817096, 3951.304849388342, 5382.779664514828, 6140.956472614528, 6309.245549132261, 5835.74379015494, 2790.5227295520035, 5260.420539979568, 4305.139706937676, 4800.356867322718, 5934.2929669217865, 10978.380992195316, 7532.780682800483, 9636.15299507889, 9446.454339461503, 5076.1635781474915, 4306.60976301844, 3270.2104264819313, 9632.764480306048, 9706.287610316218, 4053.2537227957678, 6256.4302995651415, 5031.317755254315, 3570.175768327451, 9485.90457189527, 9666.729654307952, 5166.111557500089, 5759.659966834162, 2181.668002501492, 5636.454903540783, 9851.953651077201, 10213.623106739202, 4947.985825207513, 8070.434333740183, 321.242269507156, 465.21051283610564, 6580.484408842863, 7939.57122056992, 2748.192478098088, 2771.0434069060166, 4647.6137354917855, 4597.525733702401, 8060.901309687276, 7517.284107437309, 6033.893697749182, 6518.905939713893, 4295.795442397923, 3485.3131292196003, 7051.575723276644, 6642.236601159943, 5699.562397379882, 2045.6719773467266, 4781.507355501406, 4292.807711719995, 2626.5901730526825, 1619.9229674914095, 9365.730190673437, 5140.698096280752, 3516.4732705939427, 5650.731162032264, 6032.21454039455, 8046.452821940056, 7902.679678563987, 3939.3436745741014, 4845.463361926041, 4426.361836416198, 8417.488020138651, 9036.010624658495, 9671.466860640723, 8843.60167906998, 6487.696550524198, 2417.5011211836236, 9777.518022212227, 9636.45453733157, 7291.04534205824, 8840.1491335227, 5337.584193749365, 6245.390464411973, 4477.42261289699, 4742.242396847448, 7392.613705885464, 7925.987153002699, 4051.872885064491, 4559.52765469984, 7181.756967777816, 7953.069083564359, 5200.715795182286, 2823.9592301393154, 3293.662372143205, 3539.196813527848, 6212.743590097791, 6562.032821765356, 6693.492345314547, 4378.132400909896, 4500.424759610112, 4533.021996676963, 7188.2289547397095, 8619.686535084415, 8319.899380330951, 9296.101030836178, 5288.809424452873, 6969.885889088203, 10237.823092129653, 7169.769021756453, 5371.477126278091, 9153.000210014514, 4949.232316104258, 2681.6877545513507, 4640.774889521163, 3161.390822207143, 6195.632775832317, 3462.416353084427, 5183.397945000051, 5478.435425562609, 6448.025524865894, 6752.3835757102925, 4155.994125262072, 5087.345444910619, 3950.967042047689, 4692.473071538364, 10456.00445430218, 10357.915147067411, 9339.993573404525, 6918.174673225586, 5583.6982368044955, 5731.241622702839, 3953.8750226642856, 4248.909270078009, 4446.640150323746, 4977.93993443259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40370550001531064, "mean_inference_ms": 1.0051016087472622, "mean_action_processing_ms": 0.16970340469906883, "mean_env_wait_ms": 0.055122935748963486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038489103317260742, "StateBufferConnector_ms": 0.002903461456298828, "ViewRequirementAgentConnector_ms": 0.07051575183868408}, "num_episodes": 21, "episode_return_max": 24631.668206502007, "episode_return_min": 90.28609336219839, "episode_return_mean": 18930.175251681594}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.16821794510645, "num_env_steps_trained_throughput_per_sec": 509.16821794510645, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 8135.55, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8135.512, "sample_time_ms": 815.578, "learn_time_ms": 7307.492, "learn_throughput": 547.383, "synch_weights_time_ms": 11.686}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "training_iteration": 63, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-37-42", "timestamp": 1723235862, "time_this_iter_s": 7.8615429401397705, "time_total_s": 489.9118483066559, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322241c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 489.9118483066559, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 27.800000000000008, "ram_util_percent": 82.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5577934335700419, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990487321217854, "policy_loss": -0.001299759224131112, "vf_loss": 9.990491620321123, "vf_explained_var": -3.3638685468643434e-05, "kl": 0.010783286538546679, "entropy": 0.6509083889148853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8702419217210263, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999125797549883, "policy_loss": -0.005181307374247505, "vf_loss": 10.0, "vf_explained_var": -0.0002607321987549464, "kl": 0.005671936476331515, "entropy": 1.423115305726727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 24478.440904453233, "episode_reward_min": 90.28609336219839, "episode_reward_mean": 18714.607803756582, "episode_len_mean": 196.08, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19608, "policy_reward_min": {"agent_policy": 0.7023653231384079, "adversary_policy": 19.57541524354363}, "policy_reward_max": {"agent_policy": 11670.5279366751, "adversary_policy": 10978.380992195316}, "policy_reward_mean": {"agent_policy": 7375.3716986285, "adversary_policy": 5669.61805256404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20184.09366579467, 20506.390947022024, 17487.186521569714, 18475.640923828483, 18687.99449798235, 18180.386472928203, 16228.866778861358, 19954.1846618749, 17852.928853958434, 22555.44531457158, 21274.234600753454, 15114.909593153074, 18574.210487946726, 17418.591254407995, 90.28609336219839, 17869.98080477577, 17693.906803694426, 19472.861518364072, 19968.719402934938, 16932.65835328298, 18196.209045630938, 19924.651787690822, 21667.973664160734, 19218.29920187841, 17379.024698144192, 22689.57204735279, 18165.31146843049, 17705.532122707147, 23621.87135761923, 19304.393581025917, 16323.80362623242, 23885.66690537996, 19089.48754917898, 816.2170163377392, 20590.26682266403, 16752.284785409607, 18501.674484912768, 21566.93986642987, 20174.7991307941, 17615.939293914766, 20784.339886791768, 16187.80760107765, 18368.68472779786, 15762.058591222294, 19282.83372001168, 17658.608894324912, 20174.350164125488, 18081.479298305047, 18484.875420808556, 22191.413238045854, 22968.400087852537, 16559.636744914555, 23502.923656056624, 21433.18096578919, 19109.173073735856, 18380.948362496583, 20707.884268353686, 18150.623322477684, 21323.892591508793, 16966.094853870323, 17405.880725748862, 20333.628032951237, 18520.26802464088, 17956.95146076762, 21330.364578470675, 22462.035004061832, 19430.94504818387, 21066.511792994337, 19503.406136840265, 16822.602744582728, 17303.526445938103, 17604.55197681539, 18766.568393536065, 20586.8536722147, 18002.07389335503, 18089.949250101803, 24478.440904453233, 20805.633400421237, 19713.174463460033, 18007.356910682753, 18559.888672930443, 19141.168372774224, 17739.02704659894, 17057.622109838245, 17796.223556817164, 20223.435180467142, 17640.019239863188, 20265.595827876383, 20306.363874923536, 16688.34267513563, 17743.43850228808, 19499.797666998675, 15813.830314307303, 16910.59187683128, 19926.65272583843, 15723.305412305672, 21177.035599404833, 18520.46365039298, 18843.9356368647, 19900.714096451065], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7922.388237222517, 3608.2099155886685, 6664.122281494872, 8992.900642743003, 8816.822801602011, 8389.77953878462, 9932.30623431088, 7912.248956874581, 8710.494990705809, 4855.871968620046, 4060.9642542465403, 11199.422336392712, 5990.816928154252, 9479.889199072097, 0.7023653231384079, 9969.935267100547, 10190.355162488997, 7949.12538123472, 7823.730063647797, 8881.715083751391, 9090.712471370569, 3011.9778285737493, 4499.039986281336, 4695.6812842694535, 9802.204508643845, 3350.5199567306017, 7855.627446069575, 9104.038599125375, 4469.237131415971, 8378.622056691645, 8505.680720190165, 3820.090147563502, 6071.067390231262, 29.764233994477685, 6070.2111932512, 11233.04890040551, 9256.53501571859, 5988.754449305272, 7621.999493331019, 9834.830722297243, 7090.5275623551715, 8442.573226351065, 9294.369660576409, 11515.545450678257, 4776.405433057512, 8491.404461698687, 6095.682801790895, 6239.455945166966, 9213.050222466338, 4737.914593248739, 4453.331548141843, 7654.439073206733, 4088.9510965128006, 5301.9864902082645, 7526.198415574513, 9161.283352752122, 5389.283409465474, 9539.222782713332, 6189.066540166597, 8941.41982854867, 10573.021540077783, 7558.851621088095, 7448.643278416411, 8923.504704480525, 5522.449088646533, 4846.034592894781, 7172.2497346427535, 3658.91967910826, 4978.928800547678, 9191.68267392712, 9501.360734209813, 7946.502847898638, 8104.735022973353, 7386.444571638463, 8758.734323182347, 9446.509136515826, 3664.5213030836276, 4547.465153791152, 8398.234603952691, 9804.57261794049, 9135.308588174092, 7285.2375558627755, 8577.723612894993, 9306.580235410123, 6979.833052230799, 7295.256092584752, 7405.012247094518, 5182.572968718296, 7578.767948109794, 10798.953953394048, 10367.408241374007, 7092.4659347464885, 11670.5279366751, 10973.476629385172, 7681.513202625215, 10208.88484870307, 5117.894239269641, 6553.2379899117095, 5441.280285912489, 7268.311231256624], "policy_adversary_policy_reward": [6106.113495871246, 6155.59193270092, 6372.645703800388, 10525.535327632992, 7478.013342236086, 3345.0508978387734, 4425.946150304885, 5056.794130780639, 4579.083850404896, 5292.087845975471, 4594.80618505828, 5195.800749085315, 4143.17525032284, 2153.3852942276253, 5847.7110647742475, 6194.224640226058, 5407.685130082075, 3734.7487331705343, 8547.99807325275, 9151.575272698821, 9922.301151066476, 7290.969195440393, 972.7739694221166, 2942.713287338242, 8151.318695576693, 4432.074864215757, 3276.4556306770246, 4662.246424658858, 70.00831279551635, 19.57541524354363, 3954.6332580739927, 3945.412279601232, 3552.246791817096, 3951.304849388342, 5382.779664514828, 6140.956472614528, 6309.245549132261, 5835.74379015494, 2790.5227295520035, 5260.420539979568, 4305.139706937676, 4800.356867322718, 5934.2929669217865, 10978.380992195316, 7532.780682800483, 9636.15299507889, 9446.454339461503, 5076.1635781474915, 4306.60976301844, 3270.2104264819313, 9632.764480306048, 9706.287610316218, 4053.2537227957678, 6256.4302995651415, 5031.317755254315, 3570.175768327451, 9485.90457189527, 9666.729654307952, 5166.111557500089, 5759.659966834162, 2181.668002501492, 5636.454903540783, 9851.953651077201, 10213.623106739202, 4947.985825207513, 8070.434333740183, 321.242269507156, 465.21051283610564, 6580.484408842863, 7939.57122056992, 2748.192478098088, 2771.0434069060166, 4647.6137354917855, 4597.525733702401, 8060.901309687276, 7517.284107437309, 6033.893697749182, 6518.905939713893, 4295.795442397923, 3485.3131292196003, 7051.575723276644, 6642.236601159943, 5699.562397379882, 2045.6719773467266, 4781.507355501406, 4292.807711719995, 2626.5901730526825, 1619.9229674914095, 9365.730190673437, 5140.698096280752, 3516.4732705939427, 5650.731162032264, 6032.21454039455, 8046.452821940056, 7902.679678563987, 3939.3436745741014, 4845.463361926041, 4426.361836416198, 8417.488020138651, 9036.010624658495, 9671.466860640723, 8843.60167906998, 6487.696550524198, 2417.5011211836236, 9777.518022212227, 9636.45453733157, 7291.04534205824, 8840.1491335227, 5337.584193749365, 6245.390464411973, 4477.42261289699, 4742.242396847448, 7392.613705885464, 7925.987153002699, 4051.872885064491, 4559.52765469984, 7181.756967777816, 7953.069083564359, 5200.715795182286, 2823.9592301393154, 3293.662372143205, 3539.196813527848, 6212.743590097791, 6562.032821765356, 6693.492345314547, 4378.132400909896, 4500.424759610112, 4533.021996676963, 7188.2289547397095, 8619.686535084415, 8319.899380330951, 9296.101030836178, 5288.809424452873, 6969.885889088203, 10237.823092129653, 7169.769021756453, 5371.477126278091, 9153.000210014514, 4949.232316104258, 2681.6877545513507, 4640.774889521163, 3161.390822207143, 6195.632775832317, 3462.416353084427, 5183.397945000051, 5478.435425562609, 6448.025524865894, 6752.3835757102925, 4155.994125262072, 5087.345444910619, 3950.967042047689, 4692.473071538364, 10456.00445430218, 10357.915147067411, 9339.993573404525, 6918.174673225586, 5583.6982368044955, 5731.241622702839, 3953.8750226642856, 4248.909270078009, 4446.640150323746, 4977.93993443259, 5057.356923844391, 6798.573893067023, 3596.8914228679478, 5564.412010835961, 4693.757748097238, 3057.2841263308683, 7162.30257150016, 3654.0879330862617, 6755.100467614242, 6173.078620268162, 3497.8836161322656, 6737.123376636428, 6143.229994240872, 8939.792864917259, 6363.015000297963, 6364.580926515786, 3263.8477937226944, 2625.540928018895, 3644.3270398683726, 3731.703221045669, 7049.66968898446, 5357.6620432677, 1671.694690576446, 2471.607687055834, 2968.5230548471336, 2968.5921925990215, 6000.674963793893, 6244.464559419344, 3933.250775027898, 1581.1697885747478, 7141.56803242188, 8917.573327713326, 7588.897633819232, 4378.328026662039, 8700.855337818464, 4701.8000131337985, 5842.587523646594, 6789.815341547814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40428743777171533, "mean_inference_ms": 1.0063732005771047, "mean_action_processing_ms": 0.170007162847212, "mean_env_wait_ms": 0.0551696685988308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039528608322143555, "StateBufferConnector_ms": 0.002977728843688965, "ViewRequirementAgentConnector_ms": 0.0804896354675293}, "num_episodes": 19, "episode_return_max": 24478.440904453233, "episode_return_min": 90.28609336219839, "episode_return_mean": 18714.607803756582}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.9394018381, "num_env_steps_trained_throughput_per_sec": 459.9394018381, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 8209.476, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8209.437, "sample_time_ms": 818.537, "learn_time_ms": 7377.973, "learn_throughput": 542.154, "synch_weights_time_ms": 12.052}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 64, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-37-51", "timestamp": 1723235871, "time_this_iter_s": 8.757889986038208, "time_total_s": 498.6697382926941, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322241ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.6697382926941, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 31.346153846153847, "ram_util_percent": 82.87692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5346196845016151, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000701210990785, "policy_loss": 0.00020071768137828382, "vf_loss": 9.999083845955985, "vf_explained_var": -5.127544756288882e-06, "kl": 0.011792084789790568, "entropy": 0.6325080862436345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8524315676962336, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00246424973011, "policy_loss": -0.0021685716363814816, "vf_loss": 10.0, "vf_explained_var": -0.00021866293003161748, "kl": 0.006100837517199882, "entropy": 1.4115608309706051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": 24478.440904453233, "episode_reward_min": 816.2170163377392, "episode_reward_mean": 18886.89543554275, "episode_len_mean": 198.07, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19807, "policy_reward_min": {"agent_policy": 29.764233994477685, "adversary_policy": 321.242269507156}, "policy_reward_max": {"agent_policy": 11670.5279366751, "adversary_policy": 11096.87284836264}, "policy_reward_mean": {"agent_policy": 7390.408236932185, "adversary_policy": 5748.243599305281}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21667.973664160734, 19218.29920187841, 17379.024698144192, 22689.57204735279, 18165.31146843049, 17705.532122707147, 23621.87135761923, 19304.393581025917, 16323.80362623242, 23885.66690537996, 19089.48754917898, 816.2170163377392, 20590.26682266403, 16752.284785409607, 18501.674484912768, 21566.93986642987, 20174.7991307941, 17615.939293914766, 20784.339886791768, 16187.80760107765, 18368.68472779786, 15762.058591222294, 19282.83372001168, 17658.608894324912, 20174.350164125488, 18081.479298305047, 18484.875420808556, 22191.413238045854, 22968.400087852537, 16559.636744914555, 23502.923656056624, 21433.18096578919, 19109.173073735856, 18380.948362496583, 20707.884268353686, 18150.623322477684, 21323.892591508793, 16966.094853870323, 17405.880725748862, 20333.628032951237, 18520.26802464088, 17956.95146076762, 21330.364578470675, 22462.035004061832, 19430.94504818387, 21066.511792994337, 19503.406136840265, 16822.602744582728, 17303.526445938103, 17604.55197681539, 18766.568393536065, 20586.8536722147, 18002.07389335503, 18089.949250101803, 24478.440904453233, 20805.633400421237, 19713.174463460033, 18007.356910682753, 18559.888672930443, 19141.168372774224, 17739.02704659894, 17057.622109838245, 17796.223556817164, 20223.435180467142, 17640.019239863188, 20265.595827876383, 20306.363874923536, 16688.34267513563, 17743.43850228808, 19499.797666998675, 15813.830314307303, 16910.59187683128, 19926.65272583843, 15723.305412305672, 21177.035599404833, 18520.46365039298, 18843.9356368647, 19900.714096451065, 17434.425605510383, 20025.716816002736, 18228.97579261586, 17610.23494494069, 17882.007325187198, 19377.670508942276, 20917.60460855107, 17560.574561006473, 19401.849915269828, 17174.851136720765, 16809.231106764946, 19440.99889645396, 21043.297802460267, 19409.79356308148, 16340.163088587462, 18668.660384248415, 18557.155809288743, 24083.5095256119, 17229.365655492664, 17892.919123951313, 18394.466342872067, 16389.62904944562], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4499.039986281336, 4695.6812842694535, 9802.204508643845, 3350.5199567306017, 7855.627446069575, 9104.038599125375, 4469.237131415971, 8378.622056691645, 8505.680720190165, 3820.090147563502, 6071.067390231262, 29.764233994477685, 6070.2111932512, 11233.04890040551, 9256.53501571859, 5988.754449305272, 7621.999493331019, 9834.830722297243, 7090.5275623551715, 8442.573226351065, 9294.369660576409, 11515.545450678257, 4776.405433057512, 8491.404461698687, 6095.682801790895, 6239.455945166966, 9213.050222466338, 4737.914593248739, 4453.331548141843, 7654.439073206733, 4088.9510965128006, 5301.9864902082645, 7526.198415574513, 9161.283352752122, 5389.283409465474, 9539.222782713332, 6189.066540166597, 8941.41982854867, 10573.021540077783, 7558.851621088095, 7448.643278416411, 8923.504704480525, 5522.449088646533, 4846.034592894781, 7172.2497346427535, 3658.91967910826, 4978.928800547678, 9191.68267392712, 9501.360734209813, 7946.502847898638, 8104.735022973353, 7386.444571638463, 8758.734323182347, 9446.509136515826, 3664.5213030836276, 4547.465153791152, 8398.234603952691, 9804.57261794049, 9135.308588174092, 7285.2375558627755, 8577.723612894993, 9306.580235410123, 6979.833052230799, 7295.256092584752, 7405.012247094518, 5182.572968718296, 7578.767948109794, 10798.953953394048, 10367.408241374007, 7092.4659347464885, 11670.5279366751, 10973.476629385172, 7681.513202625215, 10208.88484870307, 5117.894239269641, 6553.2379899117095, 5441.280285912489, 7268.311231256624, 8427.63644854514, 5968.369483065914, 8780.130766146009, 9446.941916191274, 8337.554149430054, 8384.377778115548, 4794.988471034215, 7953.6402278546975, 8555.878603849955, 9382.707627995947, 7508.473555569097, 6691.0133453205835, 4276.130651576119, 7692.569279400849, 10321.514178242418, 7468.03167598637, 5969.153947872662, 2841.4840795006553, 8612.857871842876, 8836.582329383464, 5313.828484908206, 9394.28086784009], "policy_adversary_policy_reward": [7532.780682800483, 9636.15299507889, 9446.454339461503, 5076.1635781474915, 4306.60976301844, 3270.2104264819313, 9632.764480306048, 9706.287610316218, 4053.2537227957678, 6256.4302995651415, 5031.317755254315, 3570.175768327451, 9485.90457189527, 9666.729654307952, 5166.111557500089, 5759.659966834162, 2181.668002501492, 5636.454903540783, 9851.953651077201, 10213.623106739202, 4947.985825207513, 8070.434333740183, 321.242269507156, 465.21051283610564, 6580.484408842863, 7939.57122056992, 2748.192478098088, 2771.0434069060166, 4647.6137354917855, 4597.525733702401, 8060.901309687276, 7517.284107437309, 6033.893697749182, 6518.905939713893, 4295.795442397923, 3485.3131292196003, 7051.575723276644, 6642.236601159943, 5699.562397379882, 2045.6719773467266, 4781.507355501406, 4292.807711719995, 2626.5901730526825, 1619.9229674914095, 9365.730190673437, 5140.698096280752, 3516.4732705939427, 5650.731162032264, 6032.21454039455, 8046.452821940056, 7902.679678563987, 3939.3436745741014, 4845.463361926041, 4426.361836416198, 8417.488020138651, 9036.010624658495, 9671.466860640723, 8843.60167906998, 6487.696550524198, 2417.5011211836236, 9777.518022212227, 9636.45453733157, 7291.04534205824, 8840.1491335227, 5337.584193749365, 6245.390464411973, 4477.42261289699, 4742.242396847448, 7392.613705885464, 7925.987153002699, 4051.872885064491, 4559.52765469984, 7181.756967777816, 7953.069083564359, 5200.715795182286, 2823.9592301393154, 3293.662372143205, 3539.196813527848, 6212.743590097791, 6562.032821765356, 6693.492345314547, 4378.132400909896, 4500.424759610112, 4533.021996676963, 7188.2289547397095, 8619.686535084415, 8319.899380330951, 9296.101030836178, 5288.809424452873, 6969.885889088203, 10237.823092129653, 7169.769021756453, 5371.477126278091, 9153.000210014514, 4949.232316104258, 2681.6877545513507, 4640.774889521163, 3161.390822207143, 6195.632775832317, 3462.416353084427, 5183.397945000051, 5478.435425562609, 6448.025524865894, 6752.3835757102925, 4155.994125262072, 5087.345444910619, 3950.967042047689, 4692.473071538364, 10456.00445430218, 10357.915147067411, 9339.993573404525, 6918.174673225586, 5583.6982368044955, 5731.241622702839, 3953.8750226642856, 4248.909270078009, 4446.640150323746, 4977.93993443259, 5057.356923844391, 6798.573893067023, 3596.8914228679478, 5564.412010835961, 4693.757748097238, 3057.2841263308683, 7162.30257150016, 3654.0879330862617, 6755.100467614242, 6173.078620268162, 3497.8836161322656, 6737.123376636428, 6143.229994240872, 8939.792864917259, 6363.015000297963, 6364.580926515786, 3263.8477937226944, 2625.540928018895, 3644.3270398683726, 3731.703221045669, 7049.66968898446, 5357.6620432677, 1671.694690576446, 2471.607687055834, 2968.5230548471336, 2968.5921925990215, 6000.674963793893, 6244.464559419344, 3933.250775027898, 1581.1697885747478, 7141.56803242188, 8917.573327713326, 7588.897633819232, 4378.328026662039, 8700.855337818464, 4701.8000131337985, 5842.587523646594, 6789.815341547814, 3485.7291846075886, 5521.059972357666, 5883.5811922717685, 8173.76614066504, 4978.4073401413625, 4470.43768632852, 4694.588547220244, 3468.7044815291956, 3762.446271933242, 5782.006903823863, 5246.019648743017, 5747.273082083712, 7317.545212554343, 8805.070924962483, 6045.057125531883, 3561.877207619856, 5550.123128607951, 5295.848182811911, 3032.715512989763, 4759.427995735, 2667.095483033981, 6633.662068161864, 5352.087902413458, 7397.897648719937, 9866.004972154817, 6901.162178729358, 5912.6567511015055, 5804.567532579174, 3820.6214454885658, 2198.027464856455, 4838.68871404757, 6361.93999421449, 8172.981675858288, 4415.020185557791, 11096.87284836264, 10145.152597748647, 3505.9547240532347, 5110.553059596522, 4876.86830083161, 4179.468493736202, 4252.330719141058, 8828.30713882276, 3543.400793983, 3451.94738762248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40501718561760486, "mean_inference_ms": 1.0083763699255845, "mean_action_processing_ms": 0.1703199936543868, "mean_env_wait_ms": 0.05528879572975057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004044890403747559, "StateBufferConnector_ms": 0.0030640363693237305, "ViewRequirementAgentConnector_ms": 0.08430719375610352}, "num_episodes": 22, "episode_return_max": 24478.440904453233, "episode_return_min": 816.2170163377392, "episode_return_mean": 18886.89543554275}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.2220148473555, "num_env_steps_trained_throughput_per_sec": 497.2220148473555, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 8250.183, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8250.144, "sample_time_ms": 828.449, "learn_time_ms": 7408.653, "learn_throughput": 539.909, "synch_weights_time_ms": 12.119}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 65, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-37-59", "timestamp": 1723235879, "time_this_iter_s": 8.050846338272095, "time_total_s": 506.7205846309662, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322241ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.7205846309662, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.018181818181816, "ram_util_percent": 82.82727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5020654256618212, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998612316575631, "policy_loss": -0.003278237966840308, "vf_loss": 10.0, "vf_explained_var": -4.120998912387424e-05, "kl": 0.01573693046183695, "entropy": 0.5429905688321149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8110575569483142, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002811470627785, "policy_loss": -0.002175155970811223, "vf_loss": 10.0, "vf_explained_var": -0.00026730820536613464, "kl": 0.006566767502954462, "entropy": 1.4086427109936872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 24478.440904453233, "episode_reward_min": 15723.305412305672, "episode_reward_mean": 18862.497828970725, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 20000, "policy_reward_min": {"agent_policy": 2841.4840795006553, "adversary_policy": 1581.1697885747478}, "policy_reward_max": {"agent_policy": 11670.5279366751, "adversary_policy": 11096.87284836264}, "policy_reward_mean": {"agent_policy": 7688.946381204636, "adversary_policy": 5586.775723883044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16187.80760107765, 18368.68472779786, 15762.058591222294, 19282.83372001168, 17658.608894324912, 20174.350164125488, 18081.479298305047, 18484.875420808556, 22191.413238045854, 22968.400087852537, 16559.636744914555, 23502.923656056624, 21433.18096578919, 19109.173073735856, 18380.948362496583, 20707.884268353686, 18150.623322477684, 21323.892591508793, 16966.094853870323, 17405.880725748862, 20333.628032951237, 18520.26802464088, 17956.95146076762, 21330.364578470675, 22462.035004061832, 19430.94504818387, 21066.511792994337, 19503.406136840265, 16822.602744582728, 17303.526445938103, 17604.55197681539, 18766.568393536065, 20586.8536722147, 18002.07389335503, 18089.949250101803, 24478.440904453233, 20805.633400421237, 19713.174463460033, 18007.356910682753, 18559.888672930443, 19141.168372774224, 17739.02704659894, 17057.622109838245, 17796.223556817164, 20223.435180467142, 17640.019239863188, 20265.595827876383, 20306.363874923536, 16688.34267513563, 17743.43850228808, 19499.797666998675, 15813.830314307303, 16910.59187683128, 19926.65272583843, 15723.305412305672, 21177.035599404833, 18520.46365039298, 18843.9356368647, 19900.714096451065, 17434.425605510383, 20025.716816002736, 18228.97579261586, 17610.23494494069, 17882.007325187198, 19377.670508942276, 20917.60460855107, 17560.574561006473, 19401.849915269828, 17174.851136720765, 16809.231106764946, 19440.99889645396, 21043.297802460267, 19409.79356308148, 16340.163088587462, 18668.660384248415, 18557.155809288743, 24083.5095256119, 17229.365655492664, 17892.919123951313, 18394.466342872067, 16389.62904944562, 19052.710345269392, 17282.383539168713, 16433.76854425453, 17290.540182961347, 18030.726457495774, 21334.005439591296, 17266.59799853797, 18313.340046355108, 17902.204217868606, 18793.57539667139, 20733.360523515963, 18140.38103863728, 16666.22509714621, 18676.446085523643, 18009.443277414975, 17270.505497713013, 20860.17296577351, 23095.73542141732, 18261.51477684624], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8442.573226351065, 9294.369660576409, 11515.545450678257, 4776.405433057512, 8491.404461698687, 6095.682801790895, 6239.455945166966, 9213.050222466338, 4737.914593248739, 4453.331548141843, 7654.439073206733, 4088.9510965128006, 5301.9864902082645, 7526.198415574513, 9161.283352752122, 5389.283409465474, 9539.222782713332, 6189.066540166597, 8941.41982854867, 10573.021540077783, 7558.851621088095, 7448.643278416411, 8923.504704480525, 5522.449088646533, 4846.034592894781, 7172.2497346427535, 3658.91967910826, 4978.928800547678, 9191.68267392712, 9501.360734209813, 7946.502847898638, 8104.735022973353, 7386.444571638463, 8758.734323182347, 9446.509136515826, 3664.5213030836276, 4547.465153791152, 8398.234603952691, 9804.57261794049, 9135.308588174092, 7285.2375558627755, 8577.723612894993, 9306.580235410123, 6979.833052230799, 7295.256092584752, 7405.012247094518, 5182.572968718296, 7578.767948109794, 10798.953953394048, 10367.408241374007, 7092.4659347464885, 11670.5279366751, 10973.476629385172, 7681.513202625215, 10208.88484870307, 5117.894239269641, 6553.2379899117095, 5441.280285912489, 7268.311231256624, 8427.63644854514, 5968.369483065914, 8780.130766146009, 9446.941916191274, 8337.554149430054, 8384.377778115548, 4794.988471034215, 7953.6402278546975, 8555.878603849955, 9382.707627995947, 7508.473555569097, 6691.0133453205835, 4276.130651576119, 7692.569279400849, 10321.514178242418, 7468.03167598637, 5969.153947872662, 2841.4840795006553, 8612.857871842876, 8836.582329383464, 5313.828484908206, 9394.28086784009, 7185.720753393738, 8907.693996374399, 9497.560808627582, 9557.178586838265, 9725.042415997912, 6501.234592145567, 9068.919878582337, 8110.051368014797, 9975.457094628526, 7851.353199270592, 6835.306035239609, 8893.223783328463, 11370.958196850468, 7300.686564900775, 9943.31560688698, 8380.727885063154, 5435.182585951943, 4237.3970797746815, 8754.284793246283], "policy_adversary_policy_reward": [5699.562397379882, 2045.6719773467266, 4781.507355501406, 4292.807711719995, 2626.5901730526825, 1619.9229674914095, 9365.730190673437, 5140.698096280752, 3516.4732705939427, 5650.731162032264, 6032.21454039455, 8046.452821940056, 7902.679678563987, 3939.3436745741014, 4845.463361926041, 4426.361836416198, 8417.488020138651, 9036.010624658495, 9671.466860640723, 8843.60167906998, 6487.696550524198, 2417.5011211836236, 9777.518022212227, 9636.45453733157, 7291.04534205824, 8840.1491335227, 5337.584193749365, 6245.390464411973, 4477.42261289699, 4742.242396847448, 7392.613705885464, 7925.987153002699, 4051.872885064491, 4559.52765469984, 7181.756967777816, 7953.069083564359, 5200.715795182286, 2823.9592301393154, 3293.662372143205, 3539.196813527848, 6212.743590097791, 6562.032821765356, 6693.492345314547, 4378.132400909896, 4500.424759610112, 4533.021996676963, 7188.2289547397095, 8619.686535084415, 8319.899380330951, 9296.101030836178, 5288.809424452873, 6969.885889088203, 10237.823092129653, 7169.769021756453, 5371.477126278091, 9153.000210014514, 4949.232316104258, 2681.6877545513507, 4640.774889521163, 3161.390822207143, 6195.632775832317, 3462.416353084427, 5183.397945000051, 5478.435425562609, 6448.025524865894, 6752.3835757102925, 4155.994125262072, 5087.345444910619, 3950.967042047689, 4692.473071538364, 10456.00445430218, 10357.915147067411, 9339.993573404525, 6918.174673225586, 5583.6982368044955, 5731.241622702839, 3953.8750226642856, 4248.909270078009, 4446.640150323746, 4977.93993443259, 5057.356923844391, 6798.573893067023, 3596.8914228679478, 5564.412010835961, 4693.757748097238, 3057.2841263308683, 7162.30257150016, 3654.0879330862617, 6755.100467614242, 6173.078620268162, 3497.8836161322656, 6737.123376636428, 6143.229994240872, 8939.792864917259, 6363.015000297963, 6364.580926515786, 3263.8477937226944, 2625.540928018895, 3644.3270398683726, 3731.703221045669, 7049.66968898446, 5357.6620432677, 1671.694690576446, 2471.607687055834, 2968.5230548471336, 2968.5921925990215, 6000.674963793893, 6244.464559419344, 3933.250775027898, 1581.1697885747478, 7141.56803242188, 8917.573327713326, 7588.897633819232, 4378.328026662039, 8700.855337818464, 4701.8000131337985, 5842.587523646594, 6789.815341547814, 3485.7291846075886, 5521.059972357666, 5883.5811922717685, 8173.76614066504, 4978.4073401413625, 4470.43768632852, 4694.588547220244, 3468.7044815291956, 3762.446271933242, 5782.006903823863, 5246.019648743017, 5747.273082083712, 7317.545212554343, 8805.070924962483, 6045.057125531883, 3561.877207619856, 5550.123128607951, 5295.848182811911, 3032.715512989763, 4759.427995735, 2667.095483033981, 6633.662068161864, 5352.087902413458, 7397.897648719937, 9866.004972154817, 6901.162178729358, 5912.6567511015055, 5804.567532579174, 3820.6214454885658, 2198.027464856455, 4838.68871404757, 6361.93999421449, 8172.981675858288, 4415.020185557791, 11096.87284836264, 10145.152597748647, 3505.9547240532347, 5110.553059596522, 4876.86830083161, 4179.468493736202, 4252.330719141058, 8828.30713882276, 3543.400793983, 3451.94738762248, 6956.414870337216, 4910.574721538417, 3609.0137121081525, 4765.675830686153, 4229.027952370521, 2707.17978325643, 3365.6507151163028, 4367.710881006835, 4402.757152412823, 3902.9268890850185, 7372.6257635689635, 7460.145083876844, 3920.583386357523, 4277.094733598114, 4549.138714858161, 5654.149963482147, 3810.828964180938, 4115.91815905908, 4651.439772940478, 6290.782424460345, 7289.372432503691, 6608.682055772647, 3999.8428028648545, 5247.314452443975, 2700.6321304101266, 2594.634769885558, 6841.449058830176, 4534.310461792751, 3954.727418783266, 4111.400251744769, 5761.4077386678, 3128.369873982074, 8706.953037779023, 6718.037342042548, 9872.729530453262, 8985.608811189311, 5387.850830484654, 4119.379153115306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40536102755371844, "mean_inference_ms": 1.0096192966927235, "mean_action_processing_ms": 0.17047303291910576, "mean_env_wait_ms": 0.055359827847530775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821134567260742, "StateBufferConnector_ms": 0.0029183626174926758, "ViewRequirementAgentConnector_ms": 0.08141887187957764}, "num_episodes": 19, "episode_return_max": 24478.440904453233, "episode_return_min": 15723.305412305672, "episode_return_mean": 18862.497828970725}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.890533105297, "num_env_steps_trained_throughput_per_sec": 518.890533105297, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 8250.024, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8249.984, "sample_time_ms": 833.722, "learn_time_ms": 7403.166, "learn_throughput": 540.309, "synch_weights_time_ms": 12.103}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 66, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-38-07", "timestamp": 1723235887, "time_this_iter_s": 7.718909740447998, "time_total_s": 514.4394943714142, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32073e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 514.4394943714142, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 28.71666666666667, "ram_util_percent": 82.58333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5652231965036619, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000794931946608, "policy_loss": -0.0011937080972418978, "vf_loss": 10.0, "vf_explained_var": 6.16743766441547e-05, "kl": 0.016553266678577063, "entropy": 0.5513221906448799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7930558146908879, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994519525766373, "policy_loss": -0.0030873940767681537, "vf_loss": 9.989191955327987, "vf_explained_var": -0.00015459035833676656, "kl": 0.011081440101649302, "entropy": 1.3816962302972873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "env_runners": {"episode_reward_max": 24478.440904453233, "episode_reward_min": 2168.4564849091603, "episode_reward_mean": 18319.757160529283, "episode_len_mean": 196.42, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19642, "policy_reward_min": {"agent_policy": 232.23101499547244, "adversary_policy": 785.6956816114061}, "policy_reward_max": {"agent_policy": 11670.5279366751, "adversary_policy": 11096.87284836264}, "policy_reward_mean": {"agent_policy": 7763.432299506835, "adversary_policy": 5278.162430511226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18520.26802464088, 17956.95146076762, 21330.364578470675, 22462.035004061832, 19430.94504818387, 21066.511792994337, 19503.406136840265, 16822.602744582728, 17303.526445938103, 17604.55197681539, 18766.568393536065, 20586.8536722147, 18002.07389335503, 18089.949250101803, 24478.440904453233, 20805.633400421237, 19713.174463460033, 18007.356910682753, 18559.888672930443, 19141.168372774224, 17739.02704659894, 17057.622109838245, 17796.223556817164, 20223.435180467142, 17640.019239863188, 20265.595827876383, 20306.363874923536, 16688.34267513563, 17743.43850228808, 19499.797666998675, 15813.830314307303, 16910.59187683128, 19926.65272583843, 15723.305412305672, 21177.035599404833, 18520.46365039298, 18843.9356368647, 19900.714096451065, 17434.425605510383, 20025.716816002736, 18228.97579261586, 17610.23494494069, 17882.007325187198, 19377.670508942276, 20917.60460855107, 17560.574561006473, 19401.849915269828, 17174.851136720765, 16809.231106764946, 19440.99889645396, 21043.297802460267, 19409.79356308148, 16340.163088587462, 18668.660384248415, 18557.155809288743, 24083.5095256119, 17229.365655492664, 17892.919123951313, 18394.466342872067, 16389.62904944562, 19052.710345269392, 17282.383539168713, 16433.76854425453, 17290.540182961347, 18030.726457495774, 21334.005439591296, 17266.59799853797, 18313.340046355108, 17902.204217868606, 18793.57539667139, 20733.360523515963, 18140.38103863728, 16666.22509714621, 18676.446085523643, 18009.443277414975, 17270.505497713013, 20860.17296577351, 23095.73542141732, 18261.51477684624, 17960.61916911093, 17223.260618618035, 2168.4564849091603, 19534.316020558428, 2412.041278340466, 17264.992786959367, 15967.50556530595, 18668.922760389814, 18661.84009061365, 19235.76765300257, 17225.609653567102, 17618.10053116181, 17872.194584140343, 18082.24347691305, 17165.33113406004, 16005.493387376171, 16662.096973986903, 21227.55455945231, 17203.71849629548, 22075.949225967197, 18524.29704660267], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7448.643278416411, 8923.504704480525, 5522.449088646533, 4846.034592894781, 7172.2497346427535, 3658.91967910826, 4978.928800547678, 9191.68267392712, 9501.360734209813, 7946.502847898638, 8104.735022973353, 7386.444571638463, 8758.734323182347, 9446.509136515826, 3664.5213030836276, 4547.465153791152, 8398.234603952691, 9804.57261794049, 9135.308588174092, 7285.2375558627755, 8577.723612894993, 9306.580235410123, 6979.833052230799, 7295.256092584752, 7405.012247094518, 5182.572968718296, 7578.767948109794, 10798.953953394048, 10367.408241374007, 7092.4659347464885, 11670.5279366751, 10973.476629385172, 7681.513202625215, 10208.88484870307, 5117.894239269641, 6553.2379899117095, 5441.280285912489, 7268.311231256624, 8427.63644854514, 5968.369483065914, 8780.130766146009, 9446.941916191274, 8337.554149430054, 8384.377778115548, 4794.988471034215, 7953.6402278546975, 8555.878603849955, 9382.707627995947, 7508.473555569097, 6691.0133453205835, 4276.130651576119, 7692.569279400849, 10321.514178242418, 7468.03167598637, 5969.153947872662, 2841.4840795006553, 8612.857871842876, 8836.582329383464, 5313.828484908206, 9394.28086784009, 7185.720753393738, 8907.693996374399, 9497.560808627582, 9557.178586838265, 9725.042415997912, 6501.234592145567, 9068.919878582337, 8110.051368014797, 9975.457094628526, 7851.353199270592, 6835.306035239609, 8893.223783328463, 11370.958196850468, 7300.686564900775, 9943.31560688698, 8380.727885063154, 5435.182585951943, 4237.3970797746815, 8754.284793246283, 9302.696010149251, 8710.719180770084, 232.23101499547244, 6399.440982793891, 243.31126031837738, 9316.35896210686, 11665.995807568346, 6449.1759865556, 6919.5475538908095, 7310.392013257496, 8950.2388454709, 10431.1188865238, 7793.138391047189, 9964.868822163675, 9342.872641079695, 11248.52659335074, 9929.088570071428, 6714.455759097185, 9904.054103357357, 4833.936202453472, 6969.881736689453], "policy_adversary_policy_reward": [6693.492345314547, 4378.132400909896, 4500.424759610112, 4533.021996676963, 7188.2289547397095, 8619.686535084415, 8319.899380330951, 9296.101030836178, 5288.809424452873, 6969.885889088203, 10237.823092129653, 7169.769021756453, 5371.477126278091, 9153.000210014514, 4949.232316104258, 2681.6877545513507, 4640.774889521163, 3161.390822207143, 6195.632775832317, 3462.416353084427, 5183.397945000051, 5478.435425562609, 6448.025524865894, 6752.3835757102925, 4155.994125262072, 5087.345444910619, 3950.967042047689, 4692.473071538364, 10456.00445430218, 10357.915147067411, 9339.993573404525, 6918.174673225586, 5583.6982368044955, 5731.241622702839, 3953.8750226642856, 4248.909270078009, 4446.640150323746, 4977.93993443259, 5057.356923844391, 6798.573893067023, 3596.8914228679478, 5564.412010835961, 4693.757748097238, 3057.2841263308683, 7162.30257150016, 3654.0879330862617, 6755.100467614242, 6173.078620268162, 3497.8836161322656, 6737.123376636428, 6143.229994240872, 8939.792864917259, 6363.015000297963, 6364.580926515786, 3263.8477937226944, 2625.540928018895, 3644.3270398683726, 3731.703221045669, 7049.66968898446, 5357.6620432677, 1671.694690576446, 2471.607687055834, 2968.5230548471336, 2968.5921925990215, 6000.674963793893, 6244.464559419344, 3933.250775027898, 1581.1697885747478, 7141.56803242188, 8917.573327713326, 7588.897633819232, 4378.328026662039, 8700.855337818464, 4701.8000131337985, 5842.587523646594, 6789.815341547814, 3485.7291846075886, 5521.059972357666, 5883.5811922717685, 8173.76614066504, 4978.4073401413625, 4470.43768632852, 4694.588547220244, 3468.7044815291956, 3762.446271933242, 5782.006903823863, 5246.019648743017, 5747.273082083712, 7317.545212554343, 8805.070924962483, 6045.057125531883, 3561.877207619856, 5550.123128607951, 5295.848182811911, 3032.715512989763, 4759.427995735, 2667.095483033981, 6633.662068161864, 5352.087902413458, 7397.897648719937, 9866.004972154817, 6901.162178729358, 5912.6567511015055, 5804.567532579174, 3820.6214454885658, 2198.027464856455, 4838.68871404757, 6361.93999421449, 8172.981675858288, 4415.020185557791, 11096.87284836264, 10145.152597748647, 3505.9547240532347, 5110.553059596522, 4876.86830083161, 4179.468493736202, 4252.330719141058, 8828.30713882276, 3543.400793983, 3451.94738762248, 6956.414870337216, 4910.574721538417, 3609.0137121081525, 4765.675830686153, 4229.027952370521, 2707.17978325643, 3365.6507151163028, 4367.710881006835, 4402.757152412823, 3902.9268890850185, 7372.6257635689635, 7460.145083876844, 3920.583386357523, 4277.094733598114, 4549.138714858161, 5654.149963482147, 3810.828964180938, 4115.91815905908, 4651.439772940478, 6290.782424460345, 7289.372432503691, 6608.682055772647, 3999.8428028648545, 5247.314452443975, 2700.6321304101266, 2594.634769885558, 6841.449058830176, 4534.310461792751, 3954.727418783266, 4111.400251744769, 5761.4077386678, 3128.369873982074, 8706.953037779023, 6718.037342042548, 9872.729530453262, 8985.608811189311, 5387.850830484654, 4119.379153115306, 4808.770757470177, 3849.152401491523, 5391.580963305089, 3120.960474542843, 1111.2718692589679, 824.9536006547205, 5392.180396827468, 7742.69464093706, 785.6956816114061, 1383.0343364106818, 4802.467650020906, 3146.1661748315805, 1885.4470691069416, 2416.0626886306727, 7692.9596371753505, 4526.787136658857, 4519.704466882756, 7222.58806984014, 6831.743610473454, 5093.632029271612, 3083.474029836198, 5191.896778260039, 3685.7278659522726, 3501.2537786857397, 6348.997232683756, 3730.058960409412, 4114.478354001204, 4002.8963007482016, 3224.3161150578217, 4598.142377922449, 1965.1339223445807, 2791.8328716809287, 2907.2479831628157, 3825.760420752719, 7392.461947557385, 7120.636852797777, 4234.088026613061, 3065.576366325021, 8653.526843433696, 8588.486180080088, 7172.253887041497, 4382.161422871663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40561727700547784, "mean_inference_ms": 1.0097536119217005, "mean_action_processing_ms": 0.17050003876067962, "mean_env_wait_ms": 0.055346060647410836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035120248794555664, "StateBufferConnector_ms": 0.0028487443923950195, "ViewRequirementAgentConnector_ms": 0.07895839214324951}, "num_episodes": 21, "episode_return_max": 24478.440904453233, "episode_return_min": 2168.4564849091603, "episode_return_mean": 18319.757160529283}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 524.7781263707138, "num_env_steps_trained_throughput_per_sec": 524.7781263707138, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 8180.17, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8180.13, "sample_time_ms": 824.468, "learn_time_ms": 7342.573, "learn_throughput": 544.768, "synch_weights_time_ms": 12.089}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "training_iteration": 67, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-38-15", "timestamp": 1723235895, "time_this_iter_s": 7.626718997955322, "time_total_s": 522.0662133693695, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d21f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 522.0662133693695, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.163636363636364, "ram_util_percent": 82.53636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49380790885321046, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999511863062622, "policy_loss": -0.0027566733940075786, "vf_loss": 10.0, "vf_explained_var": 0.00012201354617164248, "kl": 0.018883239169895805, "entropy": 0.5037441309324648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7885335993953049, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001954627037048, "policy_loss": 0.0018442175596040519, "vf_loss": 9.991582248608271, "vf_explained_var": -6.747674196958542e-05, "kl": 0.011230464599793776, "entropy": 1.3672572212914627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 24083.5095256119, "episode_reward_min": 1719.1700322870197, "episode_reward_mean": 17737.70822680672, "episode_len_mean": 192.75, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19275, "policy_reward_min": {"agent_policy": 117.1491812756226, "adversary_policy": 517.0885042698884}, "policy_reward_max": {"agent_policy": 11670.5279366751, "adversary_policy": 11096.87284836264}, "policy_reward_mean": {"agent_policy": 7986.2078722384185, "adversary_policy": 4875.750177284153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20223.435180467142, 17640.019239863188, 20265.595827876383, 20306.363874923536, 16688.34267513563, 17743.43850228808, 19499.797666998675, 15813.830314307303, 16910.59187683128, 19926.65272583843, 15723.305412305672, 21177.035599404833, 18520.46365039298, 18843.9356368647, 19900.714096451065, 17434.425605510383, 20025.716816002736, 18228.97579261586, 17610.23494494069, 17882.007325187198, 19377.670508942276, 20917.60460855107, 17560.574561006473, 19401.849915269828, 17174.851136720765, 16809.231106764946, 19440.99889645396, 21043.297802460267, 19409.79356308148, 16340.163088587462, 18668.660384248415, 18557.155809288743, 24083.5095256119, 17229.365655492664, 17892.919123951313, 18394.466342872067, 16389.62904944562, 19052.710345269392, 17282.383539168713, 16433.76854425453, 17290.540182961347, 18030.726457495774, 21334.005439591296, 17266.59799853797, 18313.340046355108, 17902.204217868606, 18793.57539667139, 20733.360523515963, 18140.38103863728, 16666.22509714621, 18676.446085523643, 18009.443277414975, 17270.505497713013, 20860.17296577351, 23095.73542141732, 18261.51477684624, 17960.61916911093, 17223.260618618035, 2168.4564849091603, 19534.316020558428, 2412.041278340466, 17264.992786959367, 15967.50556530595, 18668.922760389814, 18661.84009061365, 19235.76765300257, 17225.609653567102, 17618.10053116181, 17872.194584140343, 18082.24347691305, 17165.33113406004, 16005.493387376171, 16662.096973986903, 21227.55455945231, 17203.71849629548, 22075.949225967197, 18524.29704660267, 17001.48057224105, 19014.30620188806, 17007.039814435557, 17672.615795847607, 16658.554453358112, 16361.760138387765, 18494.86495205994, 16587.379649990085, 19324.27740808613, 16476.112704174237, 19344.339531770333, 1719.1700322870197, 17060.407525297727, 17841.88064436921, 16266.554045570758, 17449.939237376322, 17930.141869049625, 20627.94830438628, 18472.098822192824, 1857.8504131119807, 20918.9461315049, 18212.806068085712, 20239.776172752277], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200], "policy_agent_policy_reward": [7295.256092584752, 7405.012247094518, 5182.572968718296, 7578.767948109794, 10798.953953394048, 10367.408241374007, 7092.4659347464885, 11670.5279366751, 10973.476629385172, 7681.513202625215, 10208.88484870307, 5117.894239269641, 6553.2379899117095, 5441.280285912489, 7268.311231256624, 8427.63644854514, 5968.369483065914, 8780.130766146009, 9446.941916191274, 8337.554149430054, 8384.377778115548, 4794.988471034215, 7953.6402278546975, 8555.878603849955, 9382.707627995947, 7508.473555569097, 6691.0133453205835, 4276.130651576119, 7692.569279400849, 10321.514178242418, 7468.03167598637, 5969.153947872662, 2841.4840795006553, 8612.857871842876, 8836.582329383464, 5313.828484908206, 9394.28086784009, 7185.720753393738, 8907.693996374399, 9497.560808627582, 9557.178586838265, 9725.042415997912, 6501.234592145567, 9068.919878582337, 8110.051368014797, 9975.457094628526, 7851.353199270592, 6835.306035239609, 8893.223783328463, 11370.958196850468, 7300.686564900775, 9943.31560688698, 8380.727885063154, 5435.182585951943, 4237.3970797746815, 8754.284793246283, 9302.696010149251, 8710.719180770084, 232.23101499547244, 6399.440982793891, 243.31126031837738, 9316.35896210686, 11665.995807568346, 6449.1759865556, 6919.5475538908095, 7310.392013257496, 8950.2388454709, 10431.1188865238, 7793.138391047189, 9964.868822163675, 9342.872641079695, 11248.52659335074, 9929.088570071428, 6714.455759097185, 9904.054103357357, 4833.936202453472, 6969.881736689453, 10969.262680104403, 7545.222596573693, 9780.255099798565, 9637.8846643421, 9701.076991756896, 10057.213433753717, 8780.25295284865, 11046.528085877075, 8265.603485129745, 9406.440129373039, 7486.402185924448, 228.13710073332092, 9630.508114581064, 9866.791122182296, 11076.435116862624, 9992.23303537939, 9573.945004178213, 7210.911677648897, 9382.885324204657, 117.1491812756226, 6146.949655905314, 9630.462074830793, 7331.183472317074], "policy_adversary_policy_reward": [6755.100467614242, 6173.078620268162, 3497.8836161322656, 6737.123376636428, 6143.229994240872, 8939.792864917259, 6363.015000297963, 6364.580926515786, 3263.8477937226944, 2625.540928018895, 3644.3270398683726, 3731.703221045669, 7049.66968898446, 5357.6620432677, 1671.694690576446, 2471.607687055834, 2968.5230548471336, 2968.5921925990215, 6000.674963793893, 6244.464559419344, 3933.250775027898, 1581.1697885747478, 7141.56803242188, 8917.573327713326, 7588.897633819232, 4378.328026662039, 8700.855337818464, 4701.8000131337985, 5842.587523646594, 6789.815341547814, 3485.7291846075886, 5521.059972357666, 5883.5811922717685, 8173.76614066504, 4978.4073401413625, 4470.43768632852, 4694.588547220244, 3468.7044815291956, 3762.446271933242, 5782.006903823863, 5246.019648743017, 5747.273082083712, 7317.545212554343, 8805.070924962483, 6045.057125531883, 3561.877207619856, 5550.123128607951, 5295.848182811911, 3032.715512989763, 4759.427995735, 2667.095483033981, 6633.662068161864, 5352.087902413458, 7397.897648719937, 9866.004972154817, 6901.162178729358, 5912.6567511015055, 5804.567532579174, 3820.6214454885658, 2198.027464856455, 4838.68871404757, 6361.93999421449, 8172.981675858288, 4415.020185557791, 11096.87284836264, 10145.152597748647, 3505.9547240532347, 5110.553059596522, 4876.86830083161, 4179.468493736202, 4252.330719141058, 8828.30713882276, 3543.400793983, 3451.94738762248, 6956.414870337216, 4910.574721538417, 3609.0137121081525, 4765.675830686153, 4229.027952370521, 2707.17978325643, 3365.6507151163028, 4367.710881006835, 4402.757152412823, 3902.9268890850185, 7372.6257635689635, 7460.145083876844, 3920.583386357523, 4277.094733598114, 4549.138714858161, 5654.149963482147, 3810.828964180938, 4115.91815905908, 4651.439772940478, 6290.782424460345, 7289.372432503691, 6608.682055772647, 3999.8428028648545, 5247.314452443975, 2700.6321304101266, 2594.634769885558, 6841.449058830176, 4534.310461792751, 3954.727418783266, 4111.400251744769, 5761.4077386678, 3128.369873982074, 8706.953037779023, 6718.037342042548, 9872.729530453262, 8985.608811189311, 5387.850830484654, 4119.379153115306, 4808.770757470177, 3849.152401491523, 5391.580963305089, 3120.960474542843, 1111.2718692589679, 824.9536006547205, 5392.180396827468, 7742.69464093706, 785.6956816114061, 1383.0343364106818, 4802.467650020906, 3146.1661748315805, 1885.4470691069416, 2416.0626886306727, 7692.9596371753505, 4526.787136658857, 4519.704466882756, 7222.58806984014, 6831.743610473454, 5093.632029271612, 3083.474029836198, 5191.896778260039, 3685.7278659522726, 3501.2537786857397, 6348.997232683756, 3730.058960409412, 4114.478354001204, 4002.8963007482016, 3224.3161150578217, 4598.142377922449, 1965.1339223445807, 2791.8328716809287, 2907.2479831628157, 3825.760420752719, 7392.461947557385, 7120.636852797777, 4234.088026613061, 3065.576366325021, 8653.526843433696, 8588.486180080088, 7172.253887041497, 4382.161422871663, 3008.189137765523, 3024.0287543710997, 6596.913027157245, 4872.170578157059, 4361.88052393238, 2864.9041907045876, 3539.7455473805076, 4494.985584125018, 4441.058631974036, 2516.418829627194, 4084.922189977262, 2219.6245146568554, 4352.729328329008, 5361.882670882314, 2642.191240818232, 2898.6603232948364, 5186.372249209836, 5872.301673746581, 2333.977080443261, 4735.695494357922, 6265.133440903196, 5592.8039049426725, 517.0885042698884, 973.9444272838099, 2949.9750329570197, 4479.924377759566, 3848.586898783438, 4126.502623403464, 3065.700506868333, 2124.4184218398086, 3307.8036136453866, 4149.902588351546, 4248.351956700226, 4107.844908171169, 6840.567640933216, 6576.468985804113, 4759.25029952629, 4329.963198461854, 726.4795632135053, 1014.2216686228535, 7413.863580367674, 7358.132895231909, 4209.042470652699, 4373.3015226022435, 6161.546380256113, 6747.046320179063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40559388199395663, "mean_inference_ms": 1.009664160263663, "mean_action_processing_ms": 0.1705264876450036, "mean_env_wait_ms": 0.05538911757799565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034346580505371094, "StateBufferConnector_ms": 0.0025788545608520508, "ViewRequirementAgentConnector_ms": 0.07811999320983887}, "num_episodes": 23, "episode_return_max": 24083.5095256119, "episode_return_min": 1719.1700322870197, "episode_return_mean": 17737.70822680672}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.4299021042378, "num_env_steps_trained_throughput_per_sec": 523.4299021042378, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 8159.56, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8159.521, "sample_time_ms": 823.525, "learn_time_ms": 7323.168, "learn_throughput": 546.212, "synch_weights_time_ms": 11.831}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 68, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-38-23", "timestamp": 1723235903, "time_this_iter_s": 7.646982192993164, "time_total_s": 529.7131955623627, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 529.7131955623627, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 26.06363636363636, "ram_util_percent": 81.98181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5184225739901344, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000731604439872, "policy_loss": -0.0026487805852272285, "vf_loss": 10.0, "vf_explained_var": 7.4906323952649636e-06, "kl": 0.02813820673064107, "entropy": 0.4506118815254282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7711365458865961, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.007474608222644, "policy_loss": 0.0025985204837828254, "vf_loss": 9.995320642987886, "vf_explained_var": -3.2360106706619264e-05, "kl": 0.012583302538647938, "entropy": 1.3458218336105348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "env_runners": {"episode_reward_max": 24083.5095256119, "episode_reward_min": 1719.1700322870197, "episode_reward_mean": 17492.843702837323, "episode_len_mean": 191.03, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19103, "policy_reward_min": {"agent_policy": 117.1491812756226, "adversary_policy": 517.0885042698884}, "policy_reward_max": {"agent_policy": 11665.995807568346, "adversary_policy": 11096.87284836264}, "policy_reward_mean": {"agent_policy": 8004.718383575274, "adversary_policy": 4744.062659631022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17882.007325187198, 19377.670508942276, 20917.60460855107, 17560.574561006473, 19401.849915269828, 17174.851136720765, 16809.231106764946, 19440.99889645396, 21043.297802460267, 19409.79356308148, 16340.163088587462, 18668.660384248415, 18557.155809288743, 24083.5095256119, 17229.365655492664, 17892.919123951313, 18394.466342872067, 16389.62904944562, 19052.710345269392, 17282.383539168713, 16433.76854425453, 17290.540182961347, 18030.726457495774, 21334.005439591296, 17266.59799853797, 18313.340046355108, 17902.204217868606, 18793.57539667139, 20733.360523515963, 18140.38103863728, 16666.22509714621, 18676.446085523643, 18009.443277414975, 17270.505497713013, 20860.17296577351, 23095.73542141732, 18261.51477684624, 17960.61916911093, 17223.260618618035, 2168.4564849091603, 19534.316020558428, 2412.041278340466, 17264.992786959367, 15967.50556530595, 18668.922760389814, 18661.84009061365, 19235.76765300257, 17225.609653567102, 17618.10053116181, 17872.194584140343, 18082.24347691305, 17165.33113406004, 16005.493387376171, 16662.096973986903, 21227.55455945231, 17203.71849629548, 22075.949225967197, 18524.29704660267, 17001.48057224105, 19014.30620188806, 17007.039814435557, 17672.615795847607, 16658.554453358112, 16361.760138387765, 18494.86495205994, 16587.379649990085, 19324.27740808613, 16476.112704174237, 19344.339531770333, 1719.1700322870197, 17060.407525297727, 17841.88064436921, 16266.554045570758, 17449.939237376322, 17930.141869049625, 20627.94830438628, 18472.098822192824, 1857.8504131119807, 20918.9461315049, 18212.806068085712, 20239.776172752277, 16547.09420488706, 18568.89572857134, 17697.484437859403, 19420.470821400017, 17205.24798697925, 16747.063335196755, 17557.909113127807, 16381.743816374736, 20115.196976528405, 18425.65159357643, 19136.41927307378, 19151.92148956402, 3309.9383190555463, 17116.763082171346, 18901.22570267904, 17640.74408839888, 18343.441601742063, 17187.20605666612, 18542.00541422621], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8337.554149430054, 8384.377778115548, 4794.988471034215, 7953.6402278546975, 8555.878603849955, 9382.707627995947, 7508.473555569097, 6691.0133453205835, 4276.130651576119, 7692.569279400849, 10321.514178242418, 7468.03167598637, 5969.153947872662, 2841.4840795006553, 8612.857871842876, 8836.582329383464, 5313.828484908206, 9394.28086784009, 7185.720753393738, 8907.693996374399, 9497.560808627582, 9557.178586838265, 9725.042415997912, 6501.234592145567, 9068.919878582337, 8110.051368014797, 9975.457094628526, 7851.353199270592, 6835.306035239609, 8893.223783328463, 11370.958196850468, 7300.686564900775, 9943.31560688698, 8380.727885063154, 5435.182585951943, 4237.3970797746815, 8754.284793246283, 9302.696010149251, 8710.719180770084, 232.23101499547244, 6399.440982793891, 243.31126031837738, 9316.35896210686, 11665.995807568346, 6449.1759865556, 6919.5475538908095, 7310.392013257496, 8950.2388454709, 10431.1188865238, 7793.138391047189, 9964.868822163675, 9342.872641079695, 11248.52659335074, 9929.088570071428, 6714.455759097185, 9904.054103357357, 4833.936202453472, 6969.881736689453, 10969.262680104403, 7545.222596573693, 9780.255099798565, 9637.8846643421, 9701.076991756896, 10057.213433753717, 8780.25295284865, 11046.528085877075, 8265.603485129745, 9406.440129373039, 7486.402185924448, 228.13710073332092, 9630.508114581064, 9866.791122182296, 11076.435116862624, 9992.23303537939, 9573.945004178213, 7210.911677648897, 9382.885324204657, 117.1491812756226, 6146.949655905314, 9630.462074830793, 7331.183472317074, 10192.278914335002, 8044.1823153171445, 10127.347717186578, 6330.919027986453, 8631.981037954833, 9587.361365172592, 8193.730040319755, 9501.255925952491, 7197.50607959592, 8244.488197878592, 6782.770261847164, 8922.28606778668, 280.6442478844797, 9917.37833832245, 9108.366724330052, 9642.298296467996, 8563.382623906582, 8361.285621728399, 7480.230693421802], "policy_adversary_policy_reward": [3762.446271933242, 5782.006903823863, 5246.019648743017, 5747.273082083712, 7317.545212554343, 8805.070924962483, 6045.057125531883, 3561.877207619856, 5550.123128607951, 5295.848182811911, 3032.715512989763, 4759.427995735, 2667.095483033981, 6633.662068161864, 5352.087902413458, 7397.897648719937, 9866.004972154817, 6901.162178729358, 5912.6567511015055, 5804.567532579174, 3820.6214454885658, 2198.027464856455, 4838.68871404757, 6361.93999421449, 8172.981675858288, 4415.020185557791, 11096.87284836264, 10145.152597748647, 3505.9547240532347, 5110.553059596522, 4876.86830083161, 4179.468493736202, 4252.330719141058, 8828.30713882276, 3543.400793983, 3451.94738762248, 6956.414870337216, 4910.574721538417, 3609.0137121081525, 4765.675830686153, 4229.027952370521, 2707.17978325643, 3365.6507151163028, 4367.710881006835, 4402.757152412823, 3902.9268890850185, 7372.6257635689635, 7460.145083876844, 3920.583386357523, 4277.094733598114, 4549.138714858161, 5654.149963482147, 3810.828964180938, 4115.91815905908, 4651.439772940478, 6290.782424460345, 7289.372432503691, 6608.682055772647, 3999.8428028648545, 5247.314452443975, 2700.6321304101266, 2594.634769885558, 6841.449058830176, 4534.310461792751, 3954.727418783266, 4111.400251744769, 5761.4077386678, 3128.369873982074, 8706.953037779023, 6718.037342042548, 9872.729530453262, 8985.608811189311, 5387.850830484654, 4119.379153115306, 4808.770757470177, 3849.152401491523, 5391.580963305089, 3120.960474542843, 1111.2718692589679, 824.9536006547205, 5392.180396827468, 7742.69464093706, 785.6956816114061, 1383.0343364106818, 4802.467650020906, 3146.1661748315805, 1885.4470691069416, 2416.0626886306727, 7692.9596371753505, 4526.787136658857, 4519.704466882756, 7222.58806984014, 6831.743610473454, 5093.632029271612, 3083.474029836198, 5191.896778260039, 3685.7278659522726, 3501.2537786857397, 6348.997232683756, 3730.058960409412, 4114.478354001204, 4002.8963007482016, 3224.3161150578217, 4598.142377922449, 1965.1339223445807, 2791.8328716809287, 2907.2479831628157, 3825.760420752719, 7392.461947557385, 7120.636852797777, 4234.088026613061, 3065.576366325021, 8653.526843433696, 8588.486180080088, 7172.253887041497, 4382.161422871663, 3008.189137765523, 3024.0287543710997, 6596.913027157245, 4872.170578157059, 4361.88052393238, 2864.9041907045876, 3539.7455473805076, 4494.985584125018, 4441.058631974036, 2516.418829627194, 4084.922189977262, 2219.6245146568554, 4352.729328329008, 5361.882670882314, 2642.191240818232, 2898.6603232948364, 5186.372249209836, 5872.301673746581, 2333.977080443261, 4735.695494357922, 6265.133440903196, 5592.8039049426725, 517.0885042698884, 973.9444272838099, 2949.9750329570197, 4479.924377759566, 3848.586898783438, 4126.502623403464, 3065.700506868333, 2124.4184218398086, 3307.8036136453866, 4149.902588351546, 4248.351956700226, 4107.844908171169, 6840.567640933216, 6576.468985804113, 4759.25029952629, 4329.963198461854, 726.4795632135053, 1014.2216686228535, 7413.863580367674, 7358.132895231909, 4209.042470652699, 4373.3015226022435, 6161.546380256113, 6747.046320179063, 2475.785479448986, 3879.0298111031025, 4694.252788547183, 5830.460624707011, 3555.348814128452, 4014.787906544358, 7352.143261327305, 5737.408532086217, 3063.112363248319, 5510.154585776117, 2849.375436569876, 4310.326533454317, 5948.405583411206, 3415.7734893968754, 2239.6081926437005, 4640.879697778479, 5973.06135279737, 6944.629544135031, 5897.647425852356, 4283.515969845548, 6492.00361932702, 5861.645391899695, 5165.350564872561, 5064.284856904741, 1498.321915270146, 1530.9721559009206, 4062.5070611853976, 3136.877682663578, 4855.040125394394, 4937.81885295458, 4079.026369046445, 3919.4194228844503, 4723.641090149769, 5056.417887685752, 3045.0704329352307, 5780.850002002549, 6649.705128545418, 4412.069592259028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4056358000127887, "mean_inference_ms": 1.009523407967845, "mean_action_processing_ms": 0.17049620090175985, "mean_env_wait_ms": 0.055397719513877085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003229975700378418, "StateBufferConnector_ms": 0.0024857521057128906, "ViewRequirementAgentConnector_ms": 0.06622195243835449}, "num_episodes": 19, "episode_return_max": 24083.5095256119, "episode_return_min": 1719.1700322870197, "episode_return_mean": 17492.843702837323}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.4948131700731, "num_env_steps_trained_throughput_per_sec": 534.4948131700731, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 8101.171, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8101.132, "sample_time_ms": 823.31, "learn_time_ms": 7265.095, "learn_throughput": 550.578, "synch_weights_time_ms": 11.734}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "training_iteration": 69, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-38-30", "timestamp": 1723235910, "time_this_iter_s": 7.487736701965332, "time_total_s": 537.200932264328, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d2670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 537.200932264328, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 26.4, "ram_util_percent": 81.19}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5139250021132212, "cur_kl_coeff": 0.1802032470703125, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.008740362540754, "policy_loss": 0.003406404930526617, "vf_loss": 9.998784998737316, "vf_explained_var": 0.0003786837297772604, "kl": 0.03634211772353088, "entropy": 0.4625322089781837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7881891302453975, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.007782101631165, "policy_loss": 0.0005849491358579447, "vf_loss": 9.991108319163322, "vf_explained_var": -9.672660380601882e-05, "kl": 0.021186958129207293, "entropy": 1.367135455707709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 23095.73542141732, "episode_reward_min": 1261.7663568166474, "episode_reward_mean": 17072.387007373116, "episode_len_mean": 187.3, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18730, "policy_reward_min": {"agent_policy": 87.47338532156701, "adversary_policy": 342.52754127413584}, "policy_reward_max": {"agent_policy": 11665.995807568346, "adversary_policy": 9872.729530453262}, "policy_reward_mean": {"agent_policy": 8108.8600932992085, "adversary_policy": 4481.7634570369555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17266.59799853797, 18313.340046355108, 17902.204217868606, 18793.57539667139, 20733.360523515963, 18140.38103863728, 16666.22509714621, 18676.446085523643, 18009.443277414975, 17270.505497713013, 20860.17296577351, 23095.73542141732, 18261.51477684624, 17960.61916911093, 17223.260618618035, 2168.4564849091603, 19534.316020558428, 2412.041278340466, 17264.992786959367, 15967.50556530595, 18668.922760389814, 18661.84009061365, 19235.76765300257, 17225.609653567102, 17618.10053116181, 17872.194584140343, 18082.24347691305, 17165.33113406004, 16005.493387376171, 16662.096973986903, 21227.55455945231, 17203.71849629548, 22075.949225967197, 18524.29704660267, 17001.48057224105, 19014.30620188806, 17007.039814435557, 17672.615795847607, 16658.554453358112, 16361.760138387765, 18494.86495205994, 16587.379649990085, 19324.27740808613, 16476.112704174237, 19344.339531770333, 1719.1700322870197, 17060.407525297727, 17841.88064436921, 16266.554045570758, 17449.939237376322, 17930.141869049625, 20627.94830438628, 18472.098822192824, 1857.8504131119807, 20918.9461315049, 18212.806068085712, 20239.776172752277, 16547.09420488706, 18568.89572857134, 17697.484437859403, 19420.470821400017, 17205.24798697925, 16747.063335196755, 17557.909113127807, 16381.743816374736, 20115.196976528405, 18425.65159357643, 19136.41927307378, 19151.92148956402, 3309.9383190555463, 17116.763082171346, 18901.22570267904, 17640.74408839888, 18343.441601742063, 17187.20605666612, 18542.00541422621, 17597.71362388602, 17765.87969220907, 18565.005452345868, 17228.98955209205, 1876.9668146742533, 19060.010354085913, 19056.707794531958, 17155.302987015504, 19498.145619523366, 18034.399412635605, 1261.7663568166474, 16495.4751751649, 20072.727531769524, 18164.62787351095, 17045.562917695683, 16656.058372922562, 16374.265623114727, 17487.587370129353, 20703.527721182447, 18287.627374576092, 18856.791059760944, 18682.11758762775, 18262.222890788347, 19762.734208197697], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 23, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9068.919878582337, 8110.051368014797, 9975.457094628526, 7851.353199270592, 6835.306035239609, 8893.223783328463, 11370.958196850468, 7300.686564900775, 9943.31560688698, 8380.727885063154, 5435.182585951943, 4237.3970797746815, 8754.284793246283, 9302.696010149251, 8710.719180770084, 232.23101499547244, 6399.440982793891, 243.31126031837738, 9316.35896210686, 11665.995807568346, 6449.1759865556, 6919.5475538908095, 7310.392013257496, 8950.2388454709, 10431.1188865238, 7793.138391047189, 9964.868822163675, 9342.872641079695, 11248.52659335074, 9929.088570071428, 6714.455759097185, 9904.054103357357, 4833.936202453472, 6969.881736689453, 10969.262680104403, 7545.222596573693, 9780.255099798565, 9637.8846643421, 9701.076991756896, 10057.213433753717, 8780.25295284865, 11046.528085877075, 8265.603485129745, 9406.440129373039, 7486.402185924448, 228.13710073332092, 9630.508114581064, 9866.791122182296, 11076.435116862624, 9992.23303537939, 9573.945004178213, 7210.911677648897, 9382.885324204657, 117.1491812756226, 6146.949655905314, 9630.462074830793, 7331.183472317074, 10192.278914335002, 8044.1823153171445, 10127.347717186578, 6330.919027986453, 8631.981037954833, 9587.361365172592, 8193.730040319755, 9501.255925952491, 7197.50607959592, 8244.488197878592, 6782.770261847164, 8922.28606778668, 280.6442478844797, 9917.37833832245, 9108.366724330052, 9642.298296467996, 8563.382623906582, 8361.285621728399, 7480.230693421802, 8902.059402892071, 8294.289391859906, 7228.5158955301995, 9976.74765448319, 87.47338532156701, 7918.488839972098, 8737.374100413232, 9736.487444417411, 7172.109415828469, 9197.541225145453, 103.9702573403303, 11440.487945027322, 6543.219687284127, 9535.698832469154, 8865.317652601201, 11063.633900893577, 11407.245009669034, 9850.04619849078, 5740.233424050089, 9276.164433096756, 8119.310271855778, 8857.276377599012, 7973.39369180688, 8096.584813446951], "policy_adversary_policy_reward": [3920.583386357523, 4277.094733598114, 4549.138714858161, 5654.149963482147, 3810.828964180938, 4115.91815905908, 4651.439772940478, 6290.782424460345, 7289.372432503691, 6608.682055772647, 3999.8428028648545, 5247.314452443975, 2700.6321304101266, 2594.634769885558, 6841.449058830176, 4534.310461792751, 3954.727418783266, 4111.400251744769, 5761.4077386678, 3128.369873982074, 8706.953037779023, 6718.037342042548, 9872.729530453262, 8985.608811189311, 5387.850830484654, 4119.379153115306, 4808.770757470177, 3849.152401491523, 5391.580963305089, 3120.960474542843, 1111.2718692589679, 824.9536006547205, 5392.180396827468, 7742.69464093706, 785.6956816114061, 1383.0343364106818, 4802.467650020906, 3146.1661748315805, 1885.4470691069416, 2416.0626886306727, 7692.9596371753505, 4526.787136658857, 4519.704466882756, 7222.58806984014, 6831.743610473454, 5093.632029271612, 3083.474029836198, 5191.896778260039, 3685.7278659522726, 3501.2537786857397, 6348.997232683756, 3730.058960409412, 4114.478354001204, 4002.8963007482016, 3224.3161150578217, 4598.142377922449, 1965.1339223445807, 2791.8328716809287, 2907.2479831628157, 3825.760420752719, 7392.461947557385, 7120.636852797777, 4234.088026613061, 3065.576366325021, 8653.526843433696, 8588.486180080088, 7172.253887041497, 4382.161422871663, 3008.189137765523, 3024.0287543710997, 6596.913027157245, 4872.170578157059, 4361.88052393238, 2864.9041907045876, 3539.7455473805076, 4494.985584125018, 4441.058631974036, 2516.418829627194, 4084.922189977262, 2219.6245146568554, 4352.729328329008, 5361.882670882314, 2642.191240818232, 2898.6603232948364, 5186.372249209836, 5872.301673746581, 2333.977080443261, 4735.695494357922, 6265.133440903196, 5592.8039049426725, 517.0885042698884, 973.9444272838099, 2949.9750329570197, 4479.924377759566, 3848.586898783438, 4126.502623403464, 3065.700506868333, 2124.4184218398086, 3307.8036136453866, 4149.902588351546, 4248.351956700226, 4107.844908171169, 6840.567640933216, 6576.468985804113, 4759.25029952629, 4329.963198461854, 726.4795632135053, 1014.2216686228535, 7413.863580367674, 7358.132895231909, 4209.042470652699, 4373.3015226022435, 6161.546380256113, 6747.046320179063, 2475.785479448986, 3879.0298111031025, 4694.252788547183, 5830.460624707011, 3555.348814128452, 4014.787906544358, 7352.143261327305, 5737.408532086217, 3063.112363248319, 5510.154585776117, 2849.375436569876, 4310.326533454317, 5948.405583411206, 3415.7734893968754, 2239.6081926437005, 4640.879697778479, 5973.06135279737, 6944.629544135031, 5897.647425852356, 4283.515969845548, 6492.00361932702, 5861.645391899695, 5165.350564872561, 5064.284856904741, 1498.321915270146, 1530.9721559009206, 4062.5070611853976, 3136.877682663578, 4855.040125394394, 4937.81885295458, 4079.026369046445, 3919.4194228844503, 4723.641090149769, 5056.417887685752, 3045.0704329352307, 5780.850002002549, 6649.705128545418, 4412.069592259028, 3455.5780001551516, 5240.076220838839, 5847.846231871011, 3623.744068478137, 4422.869828614897, 6913.6197282007615, 3414.2677101840873, 3837.9741874247543, 887.8338258380664, 901.6596035146198, 5260.468946320315, 5881.052567793596, 5158.7830463912605, 5160.550647727394, 4271.061845293538, 3147.753697304553, 5518.804446253398, 6807.231757441478, 4025.2062152625967, 4811.651972227547, 342.52754127413584, 815.2685582021816, 2421.973820333453, 2633.0134098040985, 6251.572060261116, 7277.93578422425, 4571.674702616537, 4057.254338425266, 2903.427293964638, 5276.817971129761, 3062.1251300414724, 2530.299341987455, 2602.6620341460443, 2364.3585792996987, 3387.2854176882897, 4250.255753950257, 7354.811103376805, 7608.483193755533, 4865.934804302236, 4145.528137177159, 5427.658800002271, 5309.821987903042, 5284.859246131956, 4539.981963896837, 4832.969026653859, 5455.860172327572, 5657.901789878614, 6008.247604872099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052871445678665, "mean_inference_ms": 1.0085286199040095, "mean_action_processing_ms": 0.17040792056275159, "mean_env_wait_ms": 0.055331017623586005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032345056533813477, "StateBufferConnector_ms": 0.0025177001953125, "ViewRequirementAgentConnector_ms": 0.06365036964416504}, "num_episodes": 24, "episode_return_max": 23095.73542141732, "episode_return_min": 1261.7663568166474, "episode_return_mean": 17072.387007373116}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.5096607541706, "num_env_steps_trained_throughput_per_sec": 543.5096607541706, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 7946.922, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7946.883, "sample_time_ms": 806.796, "learn_time_ms": 7127.402, "learn_throughput": 561.214, "synch_weights_time_ms": 11.668}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 70, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-38-38", "timestamp": 1723235918, "time_this_iter_s": 7.365437030792236, "time_total_s": 544.5663692951202, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.5663692951202, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 24.827272727272724, "ram_util_percent": 81.12727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5729307187533883, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005728524324125, "policy_loss": -5.45752863030112e-05, "vf_loss": 10.0, "vf_explained_var": 0.00017956403828171827, "kl": 0.02139473915119808, "entropy": 0.4558091822913084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8315374664651851, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002953261137009, "policy_loss": -0.002758062124970214, "vf_loss": 9.991176386674246, "vf_explained_var": -0.00011643593509991964, "kl": 0.012760427015018649, "entropy": 1.3774012903372446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "env_runners": {"episode_reward_max": 23087.716759627547, "episode_reward_min": 1261.7663568166474, "episode_reward_mean": 17069.954213133118, "episode_len_mean": 187.29, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18729, "policy_reward_min": {"agent_policy": 87.47338532156701, "adversary_policy": 342.52754127413584}, "policy_reward_max": {"agent_policy": 11440.487945027322, "adversary_policy": 9535.925406768441}, "policy_reward_mean": {"agent_policy": 8198.595505611944, "adversary_policy": 4435.67935376059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18661.84009061365, 19235.76765300257, 17225.609653567102, 17618.10053116181, 17872.194584140343, 18082.24347691305, 17165.33113406004, 16005.493387376171, 16662.096973986903, 21227.55455945231, 17203.71849629548, 22075.949225967197, 18524.29704660267, 17001.48057224105, 19014.30620188806, 17007.039814435557, 17672.615795847607, 16658.554453358112, 16361.760138387765, 18494.86495205994, 16587.379649990085, 19324.27740808613, 16476.112704174237, 19344.339531770333, 1719.1700322870197, 17060.407525297727, 17841.88064436921, 16266.554045570758, 17449.939237376322, 17930.141869049625, 20627.94830438628, 18472.098822192824, 1857.8504131119807, 20918.9461315049, 18212.806068085712, 20239.776172752277, 16547.09420488706, 18568.89572857134, 17697.484437859403, 19420.470821400017, 17205.24798697925, 16747.063335196755, 17557.909113127807, 16381.743816374736, 20115.196976528405, 18425.65159357643, 19136.41927307378, 19151.92148956402, 3309.9383190555463, 17116.763082171346, 18901.22570267904, 17640.74408839888, 18343.441601742063, 17187.20605666612, 18542.00541422621, 17597.71362388602, 17765.87969220907, 18565.005452345868, 17228.98955209205, 1876.9668146742533, 19060.010354085913, 19056.707794531958, 17155.302987015504, 19498.145619523366, 18034.399412635605, 1261.7663568166474, 16495.4751751649, 20072.727531769524, 18164.62787351095, 17045.562917695683, 16656.058372922562, 16374.265623114727, 17487.587370129353, 20703.527721182447, 18287.627374576092, 18856.791059760944, 18682.11758762775, 18262.222890788347, 19762.734208197697, 20722.523692318402, 18491.49257772452, 20215.915166394963, 18126.17767065353, 19973.39918524926, 17478.863949041475, 16900.357534254632, 17915.315209373533, 17889.70544830409, 18754.36667888096, 18354.062337989482, 19347.15989202172, 16575.79577817453, 17538.206181947775, 16915.379931098487, 17831.371003535078, 16853.401984271888, 1547.1105918158817, 23087.716759627547, 2962.3516620606283, 17465.66436887536], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 26, 200], "policy_agent_policy_reward": [6919.5475538908095, 7310.392013257496, 8950.2388454709, 10431.1188865238, 7793.138391047189, 9964.868822163675, 9342.872641079695, 11248.52659335074, 9929.088570071428, 6714.455759097185, 9904.054103357357, 4833.936202453472, 6969.881736689453, 10969.262680104403, 7545.222596573693, 9780.255099798565, 9637.8846643421, 9701.076991756896, 10057.213433753717, 8780.25295284865, 11046.528085877075, 8265.603485129745, 9406.440129373039, 7486.402185924448, 228.13710073332092, 9630.508114581064, 9866.791122182296, 11076.435116862624, 9992.23303537939, 9573.945004178213, 7210.911677648897, 9382.885324204657, 117.1491812756226, 6146.949655905314, 9630.462074830793, 7331.183472317074, 10192.278914335002, 8044.1823153171445, 10127.347717186578, 6330.919027986453, 8631.981037954833, 9587.361365172592, 8193.730040319755, 9501.255925952491, 7197.50607959592, 8244.488197878592, 6782.770261847164, 8922.28606778668, 280.6442478844797, 9917.37833832245, 9108.366724330052, 9642.298296467996, 8563.382623906582, 8361.285621728399, 7480.230693421802, 8902.059402892071, 8294.289391859906, 7228.5158955301995, 9976.74765448319, 87.47338532156701, 7918.488839972098, 8737.374100413232, 9736.487444417411, 7172.109415828469, 9197.541225145453, 103.9702573403303, 11440.487945027322, 6543.219687284127, 9535.698832469154, 8865.317652601201, 11063.633900893577, 11407.245009669034, 9850.04619849078, 5740.233424050089, 9276.164433096756, 8119.310271855778, 8857.276377599012, 7973.39369180688, 8096.584813446951, 6726.1096515342015, 9292.216397933653, 7574.504472547592, 9387.631142092116, 7644.90785838417, 9829.818510601068, 9263.269523241632, 9554.602662672502, 10123.3487811738, 6627.69496437345, 9305.456971226738, 8411.875386452446, 8853.314119171895, 9900.53757150934, 10976.81659024576, 9477.323232805531, 10513.760472835387, 153.6240534314956, 4213.251199063193, 350.7523783349594, 9269.518568639107], "policy_adversary_policy_reward": [4519.704466882756, 7222.58806984014, 6831.743610473454, 5093.632029271612, 3083.474029836198, 5191.896778260039, 3685.7278659522726, 3501.2537786857397, 6348.997232683756, 3730.058960409412, 4114.478354001204, 4002.8963007482016, 3224.3161150578217, 4598.142377922449, 1965.1339223445807, 2791.8328716809287, 2907.2479831628157, 3825.760420752719, 7392.461947557385, 7120.636852797777, 4234.088026613061, 3065.576366325021, 8653.526843433696, 8588.486180080088, 7172.253887041497, 4382.161422871663, 3008.189137765523, 3024.0287543710997, 6596.913027157245, 4872.170578157059, 4361.88052393238, 2864.9041907045876, 3539.7455473805076, 4494.985584125018, 4441.058631974036, 2516.418829627194, 4084.922189977262, 2219.6245146568554, 4352.729328329008, 5361.882670882314, 2642.191240818232, 2898.6603232948364, 5186.372249209836, 5872.301673746581, 2333.977080443261, 4735.695494357922, 6265.133440903196, 5592.8039049426725, 517.0885042698884, 973.9444272838099, 2949.9750329570197, 4479.924377759566, 3848.586898783438, 4126.502623403464, 3065.700506868333, 2124.4184218398086, 3307.8036136453866, 4149.902588351546, 4248.351956700226, 4107.844908171169, 6840.567640933216, 6576.468985804113, 4759.25029952629, 4329.963198461854, 726.4795632135053, 1014.2216686228535, 7413.863580367674, 7358.132895231909, 4209.042470652699, 4373.3015226022435, 6161.546380256113, 6747.046320179063, 2475.785479448986, 3879.0298111031025, 4694.252788547183, 5830.460624707011, 3555.348814128452, 4014.787906544358, 7352.143261327305, 5737.408532086217, 3063.112363248319, 5510.154585776117, 2849.375436569876, 4310.326533454317, 5948.405583411206, 3415.7734893968754, 2239.6081926437005, 4640.879697778479, 5973.06135279737, 6944.629544135031, 5897.647425852356, 4283.515969845548, 6492.00361932702, 5861.645391899695, 5165.350564872561, 5064.284856904741, 1498.321915270146, 1530.9721559009206, 4062.5070611853976, 3136.877682663578, 4855.040125394394, 4937.81885295458, 4079.026369046445, 3919.4194228844503, 4723.641090149769, 5056.417887685752, 3045.0704329352307, 5780.850002002549, 6649.705128545418, 4412.069592259028, 3455.5780001551516, 5240.076220838839, 5847.846231871011, 3623.744068478137, 4422.869828614897, 6913.6197282007615, 3414.2677101840873, 3837.9741874247543, 887.8338258380664, 901.6596035146198, 5260.468946320315, 5881.052567793596, 5158.7830463912605, 5160.550647727394, 4271.061845293538, 3147.753697304553, 5518.804446253398, 6807.231757441478, 4025.2062152625967, 4811.651972227547, 342.52754127413584, 815.2685582021816, 2421.973820333453, 2633.0134098040985, 6251.572060261116, 7277.93578422425, 4571.674702616537, 4057.254338425266, 2903.427293964638, 5276.817971129761, 3062.1251300414724, 2530.299341987455, 2602.6620341460443, 2364.3585792996987, 3387.2854176882897, 4250.255753950257, 7354.811103376805, 7608.483193755533, 4865.934804302236, 4145.528137177159, 5427.658800002271, 5309.821987903042, 5284.859246131956, 4539.981963896837, 4832.969026653859, 5455.860172327572, 5657.901789878614, 6008.247604872099, 7377.6406495357, 6618.773391248508, 4349.72626868236, 4849.5499111085, 6123.922553141486, 6517.488140705871, 3992.0352659034475, 4746.511262657951, 5926.681651573918, 6401.809675291134, 3336.7283253105693, 4312.317113129904, 3452.9921878280725, 4184.095823184875, 4384.926395518645, 3975.786151182399, 3945.1257289499713, 3821.2309381803766, 7514.440659357512, 4612.231055150041, 4833.93961419485, 4214.665752567849, 5514.6333051663005, 5420.651200402909, 2433.660154443552, 5288.821504559071, 4201.965208419458, 3435.7034020190395, 3125.700393920191, 2812.8629469324687, 4245.494607685564, 4108.553163044005, 2712.5693203448686, 3627.072191091649, 907.0361183483257, 486.45042003605965, 9535.925406768441, 9338.540153795964, 1487.7252527500643, 1123.874030975605, 4148.702113752295, 4047.4436864839336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40498024176068315, "mean_inference_ms": 1.0077362385179176, "mean_action_processing_ms": 0.17028728592673528, "mean_env_wait_ms": 0.05528397608685616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033437013626098633, "StateBufferConnector_ms": 0.002499818801879883, "ViewRequirementAgentConnector_ms": 0.06342732906341553}, "num_episodes": 21, "episode_return_max": 23087.716759627547, "episode_return_min": 1261.7663568166474, "episode_return_mean": 17069.954213133118}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.3550899204151, "num_env_steps_trained_throughput_per_sec": 549.3550899204151, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 7771.518, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7771.482, "sample_time_ms": 788.874, "learn_time_ms": 6970.405, "learn_throughput": 573.855, "synch_weights_time_ms": 11.397}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "training_iteration": 71, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-38-45", "timestamp": 1723235925, "time_this_iter_s": 7.286967754364014, "time_total_s": 551.8533370494843, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 551.8533370494843, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 24.518181818181823, "ram_util_percent": 80.96363636363638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.516908011956032, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.016237696390304, "policy_loss": 0.004388342611245298, "vf_loss": 9.999959043472533, "vf_explained_var": 7.68377352013159e-05, "kl": 0.029325697924350462, "entropy": 0.43417490312346707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8274932943594953, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999070873856544, "policy_loss": -0.0017923384802998044, "vf_loss": 9.98946242928505, "vf_explained_var": -0.00014634989202022552, "kl": 0.010008893146004994, "entropy": 1.395910414059957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 23087.716759627547, "episode_reward_min": 1017.1664007843897, "episode_reward_mean": 16851.95630083593, "episode_len_mean": 183.81, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18381, "policy_reward_min": {"agent_policy": 60.84438810922726, "adversary_policy": 310.05961959784224}, "policy_reward_max": {"agent_policy": 11440.487945027322, "adversary_policy": 9535.925406768441}, "policy_reward_mean": {"agent_policy": 7944.290348304336, "adversary_policy": 4453.832976265799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19324.27740808613, 16476.112704174237, 19344.339531770333, 1719.1700322870197, 17060.407525297727, 17841.88064436921, 16266.554045570758, 17449.939237376322, 17930.141869049625, 20627.94830438628, 18472.098822192824, 1857.8504131119807, 20918.9461315049, 18212.806068085712, 20239.776172752277, 16547.09420488706, 18568.89572857134, 17697.484437859403, 19420.470821400017, 17205.24798697925, 16747.063335196755, 17557.909113127807, 16381.743816374736, 20115.196976528405, 18425.65159357643, 19136.41927307378, 19151.92148956402, 3309.9383190555463, 17116.763082171346, 18901.22570267904, 17640.74408839888, 18343.441601742063, 17187.20605666612, 18542.00541422621, 17597.71362388602, 17765.87969220907, 18565.005452345868, 17228.98955209205, 1876.9668146742533, 19060.010354085913, 19056.707794531958, 17155.302987015504, 19498.145619523366, 18034.399412635605, 1261.7663568166474, 16495.4751751649, 20072.727531769524, 18164.62787351095, 17045.562917695683, 16656.058372922562, 16374.265623114727, 17487.587370129353, 20703.527721182447, 18287.627374576092, 18856.791059760944, 18682.11758762775, 18262.222890788347, 19762.734208197697, 20722.523692318402, 18491.49257772452, 20215.915166394963, 18126.17767065353, 19973.39918524926, 17478.863949041475, 16900.357534254632, 17915.315209373533, 17889.70544830409, 18754.36667888096, 18354.062337989482, 19347.15989202172, 16575.79577817453, 17538.206181947775, 16915.379931098487, 17831.371003535078, 16853.401984271888, 1547.1105918158817, 23087.716759627547, 2962.3516620606283, 17465.66436887536, 19670.605332091516, 17561.50871164247, 19783.16128394399, 1017.1664007843897, 17261.270062819498, 17262.99360125503, 18845.64433797032, 21116.80887922615, 4797.735126167799, 17746.479632457416, 17464.81405242744, 18167.57027572462, 17332.12833368032, 18610.317899244244, 17156.33082246675, 20196.202772629716, 20133.425485979824, 16964.439162498555, 18125.455223608096, 17574.240970377963, 17770.108794632313], "episode_lengths": [200, 200, 200, 17, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 26, 200, 200, 200, 200, 10, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8265.603485129745, 9406.440129373039, 7486.402185924448, 228.13710073332092, 9630.508114581064, 9866.791122182296, 11076.435116862624, 9992.23303537939, 9573.945004178213, 7210.911677648897, 9382.885324204657, 117.1491812756226, 6146.949655905314, 9630.462074830793, 7331.183472317074, 10192.278914335002, 8044.1823153171445, 10127.347717186578, 6330.919027986453, 8631.981037954833, 9587.361365172592, 8193.730040319755, 9501.255925952491, 7197.50607959592, 8244.488197878592, 6782.770261847164, 8922.28606778668, 280.6442478844797, 9917.37833832245, 9108.366724330052, 9642.298296467996, 8563.382623906582, 8361.285621728399, 7480.230693421802, 8902.059402892071, 8294.289391859906, 7228.5158955301995, 9976.74765448319, 87.47338532156701, 7918.488839972098, 8737.374100413232, 9736.487444417411, 7172.109415828469, 9197.541225145453, 103.9702573403303, 11440.487945027322, 6543.219687284127, 9535.698832469154, 8865.317652601201, 11063.633900893577, 11407.245009669034, 9850.04619849078, 5740.233424050089, 9276.164433096756, 8119.310271855778, 8857.276377599012, 7973.39369180688, 8096.584813446951, 6726.1096515342015, 9292.216397933653, 7574.504472547592, 9387.631142092116, 7644.90785838417, 9829.818510601068, 9263.269523241632, 9554.602662672502, 10123.3487811738, 6627.69496437345, 9305.456971226738, 8411.875386452446, 8853.314119171895, 9900.53757150934, 10976.81659024576, 9477.323232805531, 10513.760472835387, 153.6240534314956, 4213.251199063193, 350.7523783349594, 9269.518568639107, 5832.969587075193, 9530.413834283254, 6581.6869884909975, 60.84438810922726, 9254.373200189484, 9890.609901956657, 7096.281307011208, 5240.803440369532, 744.2606215053274, 9141.85369366623, 9063.346053617232, 9275.36414553152, 9159.126909149114, 9316.872157366048, 9415.885736945824, 7538.948839289035, 7937.395008576335, 9660.822085167076, 9812.197963251854, 8736.327807008289, 9108.917224187955], "policy_adversary_policy_reward": [5186.372249209836, 5872.301673746581, 2333.977080443261, 4735.695494357922, 6265.133440903196, 5592.8039049426725, 517.0885042698884, 973.9444272838099, 2949.9750329570197, 4479.924377759566, 3848.586898783438, 4126.502623403464, 3065.700506868333, 2124.4184218398086, 3307.8036136453866, 4149.902588351546, 4248.351956700226, 4107.844908171169, 6840.567640933216, 6576.468985804113, 4759.25029952629, 4329.963198461854, 726.4795632135053, 1014.2216686228535, 7413.863580367674, 7358.132895231909, 4209.042470652699, 4373.3015226022435, 6161.546380256113, 6747.046320179063, 2475.785479448986, 3879.0298111031025, 4694.252788547183, 5830.460624707011, 3555.348814128452, 4014.787906544358, 7352.143261327305, 5737.408532086217, 3063.112363248319, 5510.154585776117, 2849.375436569876, 4310.326533454317, 5948.405583411206, 3415.7734893968754, 2239.6081926437005, 4640.879697778479, 5973.06135279737, 6944.629544135031, 5897.647425852356, 4283.515969845548, 6492.00361932702, 5861.645391899695, 5165.350564872561, 5064.284856904741, 1498.321915270146, 1530.9721559009206, 4062.5070611853976, 3136.877682663578, 4855.040125394394, 4937.81885295458, 4079.026369046445, 3919.4194228844503, 4723.641090149769, 5056.417887685752, 3045.0704329352307, 5780.850002002549, 6649.705128545418, 4412.069592259028, 3455.5780001551516, 5240.076220838839, 5847.846231871011, 3623.744068478137, 4422.869828614897, 6913.6197282007615, 3414.2677101840873, 3837.9741874247543, 887.8338258380664, 901.6596035146198, 5260.468946320315, 5881.052567793596, 5158.7830463912605, 5160.550647727394, 4271.061845293538, 3147.753697304553, 5518.804446253398, 6807.231757441478, 4025.2062152625967, 4811.651972227547, 342.52754127413584, 815.2685582021816, 2421.973820333453, 2633.0134098040985, 6251.572060261116, 7277.93578422425, 4571.674702616537, 4057.254338425266, 2903.427293964638, 5276.817971129761, 3062.1251300414724, 2530.299341987455, 2602.6620341460443, 2364.3585792996987, 3387.2854176882897, 4250.255753950257, 7354.811103376805, 7608.483193755533, 4865.934804302236, 4145.528137177159, 5427.658800002271, 5309.821987903042, 5284.859246131956, 4539.981963896837, 4832.969026653859, 5455.860172327572, 5657.901789878614, 6008.247604872099, 7377.6406495357, 6618.773391248508, 4349.72626868236, 4849.5499111085, 6123.922553141486, 6517.488140705871, 3992.0352659034475, 4746.511262657951, 5926.681651573918, 6401.809675291134, 3336.7283253105693, 4312.317113129904, 3452.9921878280725, 4184.095823184875, 4384.926395518645, 3975.786151182399, 3945.1257289499713, 3821.2309381803766, 7514.440659357512, 4612.231055150041, 4833.93961419485, 4214.665752567849, 5514.6333051663005, 5420.651200402909, 2433.660154443552, 5288.821504559071, 4201.965208419458, 3435.7034020190395, 3125.700393920191, 2812.8629469324687, 4245.494607685564, 4108.553163044005, 2712.5693203448686, 3627.072191091649, 907.0361183483257, 486.45042003605965, 9535.925406768441, 9338.540153795964, 1487.7252527500643, 1123.874030975605, 4148.702113752295, 4047.4436864839336, 5557.460735860056, 8280.175009156263, 4056.1513948069114, 3974.943482552231, 7477.33531171415, 5724.138983738827, 646.2623930773204, 310.05961959784224, 3119.1344390885047, 4887.762423541476, 4184.066436050389, 3188.31726324797, 7045.854316719745, 4703.508714239449, 8901.332183361434, 6974.6732554952105, 1827.9937741658794, 2225.4807304965893, 4192.807039161032, 4411.818899630235, 5078.789570113716, 3322.678428696481, 4858.695686537367, 4033.5104436557644, 3189.9927099493507, 4983.008714581847, 4824.94957452771, 4468.496167350399, 3014.1951987358875, 4726.249886785083, 6519.850341656113, 6137.403591684593, 6081.025041945942, 6115.0054354576405, 2925.271652825219, 4378.345424506206, 4323.655476972486, 3989.6017833837896, 5405.8078167226695, 3432.1053466470116, 4081.0301530973225, 4580.161417347111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047659980039214, "mean_inference_ms": 1.0067889519126239, "mean_action_processing_ms": 0.1701868852498525, "mean_env_wait_ms": 0.055227598672856607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003890514373779297, "StateBufferConnector_ms": 0.0025254487991333008, "ViewRequirementAgentConnector_ms": 0.06392776966094971}, "num_episodes": 21, "episode_return_max": 23087.716759627547, "episode_return_min": 1017.1664007843897, "episode_return_mean": 16851.95630083593}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.5933006227017, "num_env_steps_trained_throughput_per_sec": 542.5933006227017, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 7706.699, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7706.662, "sample_time_ms": 766.518, "learn_time_ms": 6927.728, "learn_throughput": 577.39, "synch_weights_time_ms": 11.608}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 72, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-38-53", "timestamp": 1723235933, "time_this_iter_s": 7.377846002578735, "time_total_s": 559.231183052063, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 559.231183052063, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 26.080000000000002, "ram_util_percent": 80.39}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5552583122143039, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.024619810417216, "policy_loss": 0.010125747036987117, "vf_loss": 10.0, "vf_explained_var": -1.0150797152645374e-05, "kl": 0.02383164719496139, "entropy": 0.4592657355562089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7973622536907593, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004177843530973, "policy_loss": -0.004058107446568707, "vf_loss": 10.0, "vf_explained_var": -6.549259026845296e-05, "kl": 0.007230473241846388, "entropy": 1.4117981710781653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "env_runners": {"episode_reward_max": 23087.716759627547, "episode_reward_min": 1017.1664007843897, "episode_reward_mean": 17350.053487485748, "episode_len_mean": 187.48, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18748, "policy_reward_min": {"agent_policy": 60.84438810922726, "adversary_policy": 310.05961959784224}, "policy_reward_max": {"agent_policy": 11440.487945027322, "adversary_policy": 9535.925406768441}, "policy_reward_mean": {"agent_policy": 8044.554412077059, "adversary_policy": 4652.749537704346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16747.063335196755, 17557.909113127807, 16381.743816374736, 20115.196976528405, 18425.65159357643, 19136.41927307378, 19151.92148956402, 3309.9383190555463, 17116.763082171346, 18901.22570267904, 17640.74408839888, 18343.441601742063, 17187.20605666612, 18542.00541422621, 17597.71362388602, 17765.87969220907, 18565.005452345868, 17228.98955209205, 1876.9668146742533, 19060.010354085913, 19056.707794531958, 17155.302987015504, 19498.145619523366, 18034.399412635605, 1261.7663568166474, 16495.4751751649, 20072.727531769524, 18164.62787351095, 17045.562917695683, 16656.058372922562, 16374.265623114727, 17487.587370129353, 20703.527721182447, 18287.627374576092, 18856.791059760944, 18682.11758762775, 18262.222890788347, 19762.734208197697, 20722.523692318402, 18491.49257772452, 20215.915166394963, 18126.17767065353, 19973.39918524926, 17478.863949041475, 16900.357534254632, 17915.315209373533, 17889.70544830409, 18754.36667888096, 18354.062337989482, 19347.15989202172, 16575.79577817453, 17538.206181947775, 16915.379931098487, 17831.371003535078, 16853.401984271888, 1547.1105918158817, 23087.716759627547, 2962.3516620606283, 17465.66436887536, 19670.605332091516, 17561.50871164247, 19783.16128394399, 1017.1664007843897, 17261.270062819498, 17262.99360125503, 18845.64433797032, 21116.80887922615, 4797.735126167799, 17746.479632457416, 17464.81405242744, 18167.57027572462, 17332.12833368032, 18610.317899244244, 17156.33082246675, 20196.202772629716, 20133.425485979824, 16964.439162498555, 18125.455223608096, 17574.240970377963, 17770.108794632313, 20631.787362039173, 19416.906550608543, 19574.80106403101, 22212.268415340306, 18118.58900481298, 18036.46586125934, 19946.271615391095, 17385.42073101698, 20822.637874929376, 18242.472897136446, 17461.290860353827, 17403.116129050995, 20169.315489009223, 18225.156740206297, 17930.30305213983, 20572.926421444437, 19169.987908079172, 19294.78994605833, 18279.09713096192, 20097.555700825043], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 26, 200, 200, 200, 200, 10, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9587.361365172592, 8193.730040319755, 9501.255925952491, 7197.50607959592, 8244.488197878592, 6782.770261847164, 8922.28606778668, 280.6442478844797, 9917.37833832245, 9108.366724330052, 9642.298296467996, 8563.382623906582, 8361.285621728399, 7480.230693421802, 8902.059402892071, 8294.289391859906, 7228.5158955301995, 9976.74765448319, 87.47338532156701, 7918.488839972098, 8737.374100413232, 9736.487444417411, 7172.109415828469, 9197.541225145453, 103.9702573403303, 11440.487945027322, 6543.219687284127, 9535.698832469154, 8865.317652601201, 11063.633900893577, 11407.245009669034, 9850.04619849078, 5740.233424050089, 9276.164433096756, 8119.310271855778, 8857.276377599012, 7973.39369180688, 8096.584813446951, 6726.1096515342015, 9292.216397933653, 7574.504472547592, 9387.631142092116, 7644.90785838417, 9829.818510601068, 9263.269523241632, 9554.602662672502, 10123.3487811738, 6627.69496437345, 9305.456971226738, 8411.875386452446, 8853.314119171895, 9900.53757150934, 10976.81659024576, 9477.323232805531, 10513.760472835387, 153.6240534314956, 4213.251199063193, 350.7523783349594, 9269.518568639107, 5832.969587075193, 9530.413834283254, 6581.6869884909975, 60.84438810922726, 9254.373200189484, 9890.609901956657, 7096.281307011208, 5240.803440369532, 744.2606215053274, 9141.85369366623, 9063.346053617232, 9275.36414553152, 9159.126909149114, 9316.872157366048, 9415.885736945824, 7538.948839289035, 7937.395008576335, 9660.822085167076, 9812.197963251854, 8736.327807008289, 9108.917224187955, 7136.244299873986, 8010.280982558451, 8015.198889007761, 5030.387607400506, 10081.377060933402, 9612.659445611083, 7991.285709924284, 9738.477883391804, 6325.128567059695, 8750.422031692262, 10199.222999247233, 10411.359325808273, 7763.8959788477705, 9522.387501882891, 9255.886956124828, 7180.801504701828, 7611.458185032805, 8564.832002734456, 9578.105807366426, 7919.739331379273], "policy_adversary_policy_reward": [2849.375436569876, 4310.326533454317, 5948.405583411206, 3415.7734893968754, 2239.6081926437005, 4640.879697778479, 5973.06135279737, 6944.629544135031, 5897.647425852356, 4283.515969845548, 6492.00361932702, 5861.645391899695, 5165.350564872561, 5064.284856904741, 1498.321915270146, 1530.9721559009206, 4062.5070611853976, 3136.877682663578, 4855.040125394394, 4937.81885295458, 4079.026369046445, 3919.4194228844503, 4723.641090149769, 5056.417887685752, 3045.0704329352307, 5780.850002002549, 6649.705128545418, 4412.069592259028, 3455.5780001551516, 5240.076220838839, 5847.846231871011, 3623.744068478137, 4422.869828614897, 6913.6197282007615, 3414.2677101840873, 3837.9741874247543, 887.8338258380664, 901.6596035146198, 5260.468946320315, 5881.052567793596, 5158.7830463912605, 5160.550647727394, 4271.061845293538, 3147.753697304553, 5518.804446253398, 6807.231757441478, 4025.2062152625967, 4811.651972227547, 342.52754127413584, 815.2685582021816, 2421.973820333453, 2633.0134098040985, 6251.572060261116, 7277.93578422425, 4571.674702616537, 4057.254338425266, 2903.427293964638, 5276.817971129761, 3062.1251300414724, 2530.299341987455, 2602.6620341460443, 2364.3585792996987, 3387.2854176882897, 4250.255753950257, 7354.811103376805, 7608.483193755533, 4865.934804302236, 4145.528137177159, 5427.658800002271, 5309.821987903042, 5284.859246131956, 4539.981963896837, 4832.969026653859, 5455.860172327572, 5657.901789878614, 6008.247604872099, 7377.6406495357, 6618.773391248508, 4349.72626868236, 4849.5499111085, 6123.922553141486, 6517.488140705871, 3992.0352659034475, 4746.511262657951, 5926.681651573918, 6401.809675291134, 3336.7283253105693, 4312.317113129904, 3452.9921878280725, 4184.095823184875, 4384.926395518645, 3975.786151182399, 3945.1257289499713, 3821.2309381803766, 7514.440659357512, 4612.231055150041, 4833.93961419485, 4214.665752567849, 5514.6333051663005, 5420.651200402909, 2433.660154443552, 5288.821504559071, 4201.965208419458, 3435.7034020190395, 3125.700393920191, 2812.8629469324687, 4245.494607685564, 4108.553163044005, 2712.5693203448686, 3627.072191091649, 907.0361183483257, 486.45042003605965, 9535.925406768441, 9338.540153795964, 1487.7252527500643, 1123.874030975605, 4148.702113752295, 4047.4436864839336, 5557.460735860056, 8280.175009156263, 4056.1513948069114, 3974.943482552231, 7477.33531171415, 5724.138983738827, 646.2623930773204, 310.05961959784224, 3119.1344390885047, 4887.762423541476, 4184.066436050389, 3188.31726324797, 7045.854316719745, 4703.508714239449, 8901.332183361434, 6974.6732554952105, 1827.9937741658794, 2225.4807304965893, 4192.807039161032, 4411.818899630235, 5078.789570113716, 3322.678428696481, 4858.695686537367, 4033.5104436557644, 3189.9927099493507, 4983.008714581847, 4824.94957452771, 4468.496167350399, 3014.1951987358875, 4726.249886785083, 6519.850341656113, 6137.403591684593, 6081.025041945942, 6115.0054354576405, 2925.271652825219, 4378.345424506206, 4323.655476972486, 3989.6017833837896, 5405.8078167226695, 3432.1053466470116, 4081.0301530973225, 4580.161417347111, 6611.951957537141, 6883.591104628027, 6085.403284852879, 5321.222283197261, 5761.722499426267, 5797.879675596926, 8983.13467071641, 8198.746137223423, 4051.315496313562, 3985.896447565941, 4174.179450614723, 4249.626965033553, 6141.712739100616, 5813.2731663662125, 3715.342230515193, 3931.6006171100344, 7817.007056671263, 6680.502251198391, 5391.713592038693, 4100.337273405435, 3535.896908381406, 3726.170952725175, 3333.000576435, 3658.756226807745, 6157.229309403045, 6248.190200758439, 4102.436465536531, 4600.332772786878, 3788.167428408915, 4886.24866760611, 6549.62518355958, 6842.499733183009, 5133.840799477906, 6424.68892356844, 5561.61480389813, 5168.343139425674, 4399.690044934338, 4301.301278661153, 6034.534419367786, 6143.281950077993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40433637969986624, "mean_inference_ms": 1.0058718085609795, "mean_action_processing_ms": 0.17002896432737333, "mean_env_wait_ms": 0.05513435773582191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003963589668273926, "StateBufferConnector_ms": 0.0024863481521606445, "ViewRequirementAgentConnector_ms": 0.06420576572418213}, "num_episodes": 20, "episode_return_max": 23087.716759627547, "episode_return_min": 1017.1664007843897, "episode_return_mean": 17350.053487485748}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.7380346065949, "num_env_steps_trained_throughput_per_sec": 547.7380346065949, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 7651.38, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7651.343, "sample_time_ms": 763.677, "learn_time_ms": 6875.313, "learn_throughput": 581.792, "synch_weights_time_ms": 11.594}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "training_iteration": 73, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-00", "timestamp": 1723235940, "time_this_iter_s": 7.307003974914551, "time_total_s": 566.5381870269775, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d2e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 566.5381870269775, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.60909090909091, "ram_util_percent": 80.05454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48331064111971983, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.015553070754601, "policy_loss": 0.0018705257820704627, "vf_loss": 10.0, "vf_explained_var": 6.0103557727955005e-06, "kl": 0.014998220161303246, "entropy": 0.4327612398793458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8474028418151041, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000153636932373, "policy_loss": -0.001268652099921989, "vf_loss": 9.993416572610537, "vf_explained_var": -7.376540452241898e-05, "kl": 0.007028333462949376, "entropy": 1.4370357949286698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 23087.716759627547, "episode_reward_min": 1017.1664007843897, "episode_reward_mean": 17576.173919090408, "episode_len_mean": 189.17, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18917, "policy_reward_min": {"agent_policy": 42.13699114208298, "adversary_policy": 310.05961959784224}, "policy_reward_max": {"agent_policy": 11440.487945027322, "adversary_policy": 9535.925406768441}, "policy_reward_mean": {"agent_policy": 8174.9028514976435, "adversary_policy": 4700.635533796382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17155.302987015504, 19498.145619523366, 18034.399412635605, 1261.7663568166474, 16495.4751751649, 20072.727531769524, 18164.62787351095, 17045.562917695683, 16656.058372922562, 16374.265623114727, 17487.587370129353, 20703.527721182447, 18287.627374576092, 18856.791059760944, 18682.11758762775, 18262.222890788347, 19762.734208197697, 20722.523692318402, 18491.49257772452, 20215.915166394963, 18126.17767065353, 19973.39918524926, 17478.863949041475, 16900.357534254632, 17915.315209373533, 17889.70544830409, 18754.36667888096, 18354.062337989482, 19347.15989202172, 16575.79577817453, 17538.206181947775, 16915.379931098487, 17831.371003535078, 16853.401984271888, 1547.1105918158817, 23087.716759627547, 2962.3516620606283, 17465.66436887536, 19670.605332091516, 17561.50871164247, 19783.16128394399, 1017.1664007843897, 17261.270062819498, 17262.99360125503, 18845.64433797032, 21116.80887922615, 4797.735126167799, 17746.479632457416, 17464.81405242744, 18167.57027572462, 17332.12833368032, 18610.317899244244, 17156.33082246675, 20196.202772629716, 20133.425485979824, 16964.439162498555, 18125.455223608096, 17574.240970377963, 17770.108794632313, 20631.787362039173, 19416.906550608543, 19574.80106403101, 22212.268415340306, 18118.58900481298, 18036.46586125934, 19946.271615391095, 17385.42073101698, 20822.637874929376, 18242.472897136446, 17461.290860353827, 17403.116129050995, 20169.315489009223, 18225.156740206297, 17930.30305213983, 20572.926421444437, 19169.987908079172, 19294.78994605833, 18279.09713096192, 20097.555700825043, 18112.243094061545, 18313.44442413958, 19690.8991939994, 20204.03079045496, 18236.152619783625, 22176.73572693131, 17046.207245827925, 17985.949760264073, 17334.86911433187, 17746.037689184617, 17869.447011331013, 20677.653430242488, 18360.186214021265, 19405.143415589027, 17390.75783363351, 20017.24978103549, 17030.359013745197, 17870.879862626443, 1275.2606289853568, 18174.872002121458, 17402.167454362298], "episode_lengths": [200, 200, 200, 13, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 26, 200, 200, 200, 200, 10, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200], "policy_agent_policy_reward": [9736.487444417411, 7172.109415828469, 9197.541225145453, 103.9702573403303, 11440.487945027322, 6543.219687284127, 9535.698832469154, 8865.317652601201, 11063.633900893577, 11407.245009669034, 9850.04619849078, 5740.233424050089, 9276.164433096756, 8119.310271855778, 8857.276377599012, 7973.39369180688, 8096.584813446951, 6726.1096515342015, 9292.216397933653, 7574.504472547592, 9387.631142092116, 7644.90785838417, 9829.818510601068, 9263.269523241632, 9554.602662672502, 10123.3487811738, 6627.69496437345, 9305.456971226738, 8411.875386452446, 8853.314119171895, 9900.53757150934, 10976.81659024576, 9477.323232805531, 10513.760472835387, 153.6240534314956, 4213.251199063193, 350.7523783349594, 9269.518568639107, 5832.969587075193, 9530.413834283254, 6581.6869884909975, 60.84438810922726, 9254.373200189484, 9890.609901956657, 7096.281307011208, 5240.803440369532, 744.2606215053274, 9141.85369366623, 9063.346053617232, 9275.36414553152, 9159.126909149114, 9316.872157366048, 9415.885736945824, 7538.948839289035, 7937.395008576335, 9660.822085167076, 9812.197963251854, 8736.327807008289, 9108.917224187955, 7136.244299873986, 8010.280982558451, 8015.198889007761, 5030.387607400506, 10081.377060933402, 9612.659445611083, 7991.285709924284, 9738.477883391804, 6325.128567059695, 8750.422031692262, 10199.222999247233, 10411.359325808273, 7763.8959788477705, 9522.387501882891, 9255.886956124828, 7180.801504701828, 7611.458185032805, 8564.832002734456, 9578.105807366426, 7919.739331379273, 9100.54148332264, 9584.339187994665, 6652.991995114954, 7792.5149509017065, 8775.856486791356, 5872.794849333185, 10640.776161447266, 9135.70813084706, 9660.245108013063, 10119.582867264226, 9292.748236580668, 6309.530104018889, 9238.073615268684, 7305.153326898564, 10238.798135611662, 7760.697480117836, 9797.696538806536, 9715.719638197459, 42.13699114208298, 9222.321846073994, 9704.549963399237], "policy_adversary_policy_reward": [4271.061845293538, 3147.753697304553, 5518.804446253398, 6807.231757441478, 4025.2062152625967, 4811.651972227547, 342.52754127413584, 815.2685582021816, 2421.973820333453, 2633.0134098040985, 6251.572060261116, 7277.93578422425, 4571.674702616537, 4057.254338425266, 2903.427293964638, 5276.817971129761, 3062.1251300414724, 2530.299341987455, 2602.6620341460443, 2364.3585792996987, 3387.2854176882897, 4250.255753950257, 7354.811103376805, 7608.483193755533, 4865.934804302236, 4145.528137177159, 5427.658800002271, 5309.821987903042, 5284.859246131956, 4539.981963896837, 4832.969026653859, 5455.860172327572, 5657.901789878614, 6008.247604872099, 7377.6406495357, 6618.773391248508, 4349.72626868236, 4849.5499111085, 6123.922553141486, 6517.488140705871, 3992.0352659034475, 4746.511262657951, 5926.681651573918, 6401.809675291134, 3336.7283253105693, 4312.317113129904, 3452.9921878280725, 4184.095823184875, 4384.926395518645, 3975.786151182399, 3945.1257289499713, 3821.2309381803766, 7514.440659357512, 4612.231055150041, 4833.93961419485, 4214.665752567849, 5514.6333051663005, 5420.651200402909, 2433.660154443552, 5288.821504559071, 4201.965208419458, 3435.7034020190395, 3125.700393920191, 2812.8629469324687, 4245.494607685564, 4108.553163044005, 2712.5693203448686, 3627.072191091649, 907.0361183483257, 486.45042003605965, 9535.925406768441, 9338.540153795964, 1487.7252527500643, 1123.874030975605, 4148.702113752295, 4047.4436864839336, 5557.460735860056, 8280.175009156263, 4056.1513948069114, 3974.943482552231, 7477.33531171415, 5724.138983738827, 646.2623930773204, 310.05961959784224, 3119.1344390885047, 4887.762423541476, 4184.066436050389, 3188.31726324797, 7045.854316719745, 4703.508714239449, 8901.332183361434, 6974.6732554952105, 1827.9937741658794, 2225.4807304965893, 4192.807039161032, 4411.818899630235, 5078.789570113716, 3322.678428696481, 4858.695686537367, 4033.5104436557644, 3189.9927099493507, 4983.008714581847, 4824.94957452771, 4468.496167350399, 3014.1951987358875, 4726.249886785083, 6519.850341656113, 6137.403591684593, 6081.025041945942, 6115.0054354576405, 2925.271652825219, 4378.345424506206, 4323.655476972486, 3989.6017833837896, 5405.8078167226695, 3432.1053466470116, 4081.0301530973225, 4580.161417347111, 6611.951957537141, 6883.591104628027, 6085.403284852879, 5321.222283197261, 5761.722499426267, 5797.879675596926, 8983.13467071641, 8198.746137223423, 4051.315496313562, 3985.896447565941, 4174.179450614723, 4249.626965033553, 6141.712739100616, 5813.2731663662125, 3715.342230515193, 3931.6006171100344, 7817.007056671263, 6680.502251198391, 5391.713592038693, 4100.337273405435, 3535.896908381406, 3726.170952725175, 3333.000576435, 3658.756226807745, 6157.229309403045, 6248.190200758439, 4102.436465536531, 4600.332772786878, 3788.167428408915, 4886.24866760611, 6549.62518355958, 6842.499733183009, 5133.840799477906, 6424.68892356844, 5561.61480389813, 5168.343139425674, 4399.690044934338, 4301.301278661153, 6034.534419367786, 6143.281950077993, 5012.154086732428, 3999.547524006488, 4245.592022594884, 4483.513213550003, 5553.759060120024, 7484.148138764395, 6194.195723189235, 6217.320116363997, 4919.3805274642555, 4540.915605528011, 8234.127979034873, 8069.81289856322, 3094.6802858427727, 3310.7507985379057, 4361.902973602931, 4488.338655814119, 3420.1431491864755, 4254.4808571322355, 3603.902065453693, 4022.552756466698, 4663.490824745245, 3913.2079500050686, 7832.6055197120795, 6535.517806511547, 4576.770422516206, 4545.342176236379, 6836.982296832385, 5263.0077918580955, 3868.0209708897905, 3283.9387271319556, 6260.95957297064, 5995.592727947025, 2888.2233900143087, 4344.439084924427, 3795.954305797645, 4359.20591863129, 735.6804681631193, 497.44316968015397, 4032.736378390482, 4919.813777656979, 4307.157684215723, 3390.459806747342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037944371333891, "mean_inference_ms": 1.00441769129981, "mean_action_processing_ms": 0.16983113500648023, "mean_env_wait_ms": 0.05504206451688832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405573844909668, "StateBufferConnector_ms": 0.002499103546142578, "ViewRequirementAgentConnector_ms": 0.0654456615447998}, "num_episodes": 21, "episode_return_max": 23087.716759627547, "episode_return_min": 1017.1664007843897, "episode_return_mean": 17576.173919090408}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.4211604240153, "num_env_steps_trained_throughput_per_sec": 530.4211604240153, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 7535.818, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7535.782, "sample_time_ms": 753.747, "learn_time_ms": 6770.194, "learn_throughput": 590.825, "synch_weights_time_ms": 11.194}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 74, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-08", "timestamp": 1723235948, "time_this_iter_s": 7.546196937561035, "time_total_s": 574.0843839645386, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 574.0843839645386, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 24.672727272727272, "ram_util_percent": 80.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5357811056116901, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.020967289253518, "policy_loss": 0.0003667060336314891, "vf_loss": 10.0, "vf_explained_var": 6.725185762637507e-05, "kl": 0.022581455435741832, "entropy": 0.4567283252244273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8556904517424603, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005556978782018, "policy_loss": -0.0046148071885302976, "vf_loss": 9.993757347265879, "vf_explained_var": -0.0002351731061935425, "kl": 0.01441047024272848, "entropy": 1.4759447236855825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": 23834.800191081882, "episode_reward_min": 1017.1664007843897, "episode_reward_mean": 17882.563741607606, "episode_len_mean": 189.19, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18919, "policy_reward_min": {"agent_policy": 42.13699114208298, "adversary_policy": 310.05961959784224}, "policy_reward_max": {"agent_policy": 10976.81659024576, "adversary_policy": 10898.65621822644}, "policy_reward_mean": {"agent_policy": 7902.849318028485, "adversary_policy": 4989.857211789561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16900.357534254632, 17915.315209373533, 17889.70544830409, 18754.36667888096, 18354.062337989482, 19347.15989202172, 16575.79577817453, 17538.206181947775, 16915.379931098487, 17831.371003535078, 16853.401984271888, 1547.1105918158817, 23087.716759627547, 2962.3516620606283, 17465.66436887536, 19670.605332091516, 17561.50871164247, 19783.16128394399, 1017.1664007843897, 17261.270062819498, 17262.99360125503, 18845.64433797032, 21116.80887922615, 4797.735126167799, 17746.479632457416, 17464.81405242744, 18167.57027572462, 17332.12833368032, 18610.317899244244, 17156.33082246675, 20196.202772629716, 20133.425485979824, 16964.439162498555, 18125.455223608096, 17574.240970377963, 17770.108794632313, 20631.787362039173, 19416.906550608543, 19574.80106403101, 22212.268415340306, 18118.58900481298, 18036.46586125934, 19946.271615391095, 17385.42073101698, 20822.637874929376, 18242.472897136446, 17461.290860353827, 17403.116129050995, 20169.315489009223, 18225.156740206297, 17930.30305213983, 20572.926421444437, 19169.987908079172, 19294.78994605833, 18279.09713096192, 20097.555700825043, 18112.243094061545, 18313.44442413958, 19690.8991939994, 20204.03079045496, 18236.152619783625, 22176.73572693131, 17046.207245827925, 17985.949760264073, 17334.86911433187, 17746.037689184617, 17869.447011331013, 20677.653430242488, 18360.186214021265, 19405.143415589027, 17390.75783363351, 20017.24978103549, 17030.359013745197, 17870.879862626443, 1275.2606289853568, 18174.872002121458, 17402.167454362298, 17414.55353924414, 22075.66104982038, 18995.116594272888, 18161.79022031683, 19351.74265253889, 17808.50777900646, 23762.36616472534, 23834.800191081882, 1747.859296659702, 23177.770684694067, 18985.60882733894, 17715.944028325463, 22224.011414332654, 17495.115487449715, 21304.72346577025, 17662.640794258565, 17024.142253256756, 18955.461508169723, 18850.892633921572, 20725.60472270602, 22787.38181656127, 17206.44066281131, 21180.158788271034], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 26, 200, 200, 200, 200, 10, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9263.269523241632, 9554.602662672502, 10123.3487811738, 6627.69496437345, 9305.456971226738, 8411.875386452446, 8853.314119171895, 9900.53757150934, 10976.81659024576, 9477.323232805531, 10513.760472835387, 153.6240534314956, 4213.251199063193, 350.7523783349594, 9269.518568639107, 5832.969587075193, 9530.413834283254, 6581.6869884909975, 60.84438810922726, 9254.373200189484, 9890.609901956657, 7096.281307011208, 5240.803440369532, 744.2606215053274, 9141.85369366623, 9063.346053617232, 9275.36414553152, 9159.126909149114, 9316.872157366048, 9415.885736945824, 7538.948839289035, 7937.395008576335, 9660.822085167076, 9812.197963251854, 8736.327807008289, 9108.917224187955, 7136.244299873986, 8010.280982558451, 8015.198889007761, 5030.387607400506, 10081.377060933402, 9612.659445611083, 7991.285709924284, 9738.477883391804, 6325.128567059695, 8750.422031692262, 10199.222999247233, 10411.359325808273, 7763.8959788477705, 9522.387501882891, 9255.886956124828, 7180.801504701828, 7611.458185032805, 8564.832002734456, 9578.105807366426, 7919.739331379273, 9100.54148332264, 9584.339187994665, 6652.991995114954, 7792.5149509017065, 8775.856486791356, 5872.794849333185, 10640.776161447266, 9135.70813084706, 9660.245108013063, 10119.582867264226, 9292.748236580668, 6309.530104018889, 9238.073615268684, 7305.153326898564, 10238.798135611662, 7760.697480117836, 9797.696538806536, 9715.719638197459, 42.13699114208298, 9222.321846073994, 9704.549963399237, 10511.341791424948, 4004.781000721254, 8245.512924213788, 9781.506481446197, 8522.299545251186, 9896.291808870277, 2667.641957535821, 4131.556739568742, 110.51580100028758, 4178.24498687892, 8669.827704865518, 9622.771181374812, 5844.946909653934, 10048.263108133675, 5987.611264506883, 9503.783304414292, 9991.30449344812, 9072.74901251132, 9116.225873890497, 4931.532060016223, 4775.721586067939, 10394.65423823963, 6219.471493164905], "policy_adversary_policy_reward": [3452.9921878280725, 4184.095823184875, 4384.926395518645, 3975.786151182399, 3945.1257289499713, 3821.2309381803766, 7514.440659357512, 4612.231055150041, 4833.93961419485, 4214.665752567849, 5514.6333051663005, 5420.651200402909, 2433.660154443552, 5288.821504559071, 4201.965208419458, 3435.7034020190395, 3125.700393920191, 2812.8629469324687, 4245.494607685564, 4108.553163044005, 2712.5693203448686, 3627.072191091649, 907.0361183483257, 486.45042003605965, 9535.925406768441, 9338.540153795964, 1487.7252527500643, 1123.874030975605, 4148.702113752295, 4047.4436864839336, 5557.460735860056, 8280.175009156263, 4056.1513948069114, 3974.943482552231, 7477.33531171415, 5724.138983738827, 646.2623930773204, 310.05961959784224, 3119.1344390885047, 4887.762423541476, 4184.066436050389, 3188.31726324797, 7045.854316719745, 4703.508714239449, 8901.332183361434, 6974.6732554952105, 1827.9937741658794, 2225.4807304965893, 4192.807039161032, 4411.818899630235, 5078.789570113716, 3322.678428696481, 4858.695686537367, 4033.5104436557644, 3189.9927099493507, 4983.008714581847, 4824.94957452771, 4468.496167350399, 3014.1951987358875, 4726.249886785083, 6519.850341656113, 6137.403591684593, 6081.025041945942, 6115.0054354576405, 2925.271652825219, 4378.345424506206, 4323.655476972486, 3989.6017833837896, 5405.8078167226695, 3432.1053466470116, 4081.0301530973225, 4580.161417347111, 6611.951957537141, 6883.591104628027, 6085.403284852879, 5321.222283197261, 5761.722499426267, 5797.879675596926, 8983.13467071641, 8198.746137223423, 4051.315496313562, 3985.896447565941, 4174.179450614723, 4249.626965033553, 6141.712739100616, 5813.2731663662125, 3715.342230515193, 3931.6006171100344, 7817.007056671263, 6680.502251198391, 5391.713592038693, 4100.337273405435, 3535.896908381406, 3726.170952725175, 3333.000576435, 3658.756226807745, 6157.229309403045, 6248.190200758439, 4102.436465536531, 4600.332772786878, 3788.167428408915, 4886.24866760611, 6549.62518355958, 6842.499733183009, 5133.840799477906, 6424.68892356844, 5561.61480389813, 5168.343139425674, 4399.690044934338, 4301.301278661153, 6034.534419367786, 6143.281950077993, 5012.154086732428, 3999.547524006488, 4245.592022594884, 4483.513213550003, 5553.759060120024, 7484.148138764395, 6194.195723189235, 6217.320116363997, 4919.3805274642555, 4540.915605528011, 8234.127979034873, 8069.81289856322, 3094.6802858427727, 3310.7507985379057, 4361.902973602931, 4488.338655814119, 3420.1431491864755, 4254.4808571322355, 3603.902065453693, 4022.552756466698, 4663.490824745245, 3913.2079500050686, 7832.6055197120795, 6535.517806511547, 4576.770422516206, 4545.342176236379, 6836.982296832385, 5263.0077918580955, 3868.0209708897905, 3283.9387271319556, 6260.95957297064, 5995.592727947025, 2888.2233900143087, 4344.439084924427, 3795.954305797645, 4359.20591863129, 735.6804681631193, 497.44316968015397, 4032.736378390482, 4919.813777656979, 4307.157684215723, 3390.459806747342, 3488.6056243044536, 3414.6061235147486, 10137.35462300969, 7933.5254260894535, 5018.949482478813, 5730.654187580248, 4277.018076799544, 4103.265662071082, 5329.628059625445, 5499.815047662276, 3953.000132701356, 3959.215837434945, 10898.65621822644, 10196.067988963054, 9724.80211304204, 9978.44133847113, 687.1991248798806, 950.1443707795338, 9963.890636852026, 9035.635060963063, 4858.79811115942, 5456.983011314004, 4519.294322096605, 3573.878524854028, 8163.783850436852, 8215.280654241908, 3378.156541810671, 4068.695837505312, 7162.682708624601, 8154.429492638832, 4052.7093090838016, 4106.1481807604605, 2936.4828302099077, 4096.354929598726, 4909.628467503525, 4973.084028154862, 4727.689089944284, 5006.977670086862, 6583.469098975099, 9210.603563714729, 8845.600418717971, 9166.05981177541, 3746.2883343777457, 3065.498090193974, 7803.407823109515, 7157.279471996571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40350809044028746, "mean_inference_ms": 1.003123650360433, "mean_action_processing_ms": 0.16968710773576723, "mean_env_wait_ms": 0.05497037811931483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004113912582397461, "StateBufferConnector_ms": 0.002393960952758789, "ViewRequirementAgentConnector_ms": 0.06627058982849121}, "num_episodes": 23, "episode_return_max": 23834.800191081882, "episode_return_min": 1017.1664007843897, "episode_return_mean": 17882.563741607606}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.462414236904, "num_env_steps_trained_throughput_per_sec": 496.462414236904, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 7537.049, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7537.013, "sample_time_ms": 740.676, "learn_time_ms": 6784.477, "learn_throughput": 589.581, "synch_weights_time_ms": 11.265}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 75, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-16", "timestamp": 1723235956, "time_this_iter_s": 8.061734914779663, "time_total_s": 582.1461188793182, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d03a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 582.1461188793182, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 28.908333333333335, "ram_util_percent": 80.18333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.61681323243039, "cur_kl_coeff": 1.3684184074401853, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.058944424119575, "policy_loss": 0.008996229298984405, "vf_loss": 10.0, "vf_explained_var": 7.604070441432731e-06, "kl": 0.036500663840502656, "entropy": 0.45564239949145646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8778559780058761, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997501300772031, "policy_loss": -0.0007538740253949072, "vf_loss": 9.988255601127943, "vf_explained_var": -0.00022087786346673964, "kl": 0.008778754423353045, "entropy": 1.4742358952760697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 25075.597156903128, "episode_reward_min": 1275.2606289853568, "episode_reward_mean": 18577.401048597712, "episode_len_mean": 191.54, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19154, "policy_reward_min": {"agent_policy": 42.13699114208298, "adversary_policy": 497.44316968015397}, "policy_reward_max": {"agent_policy": 10640.776161447266, "adversary_policy": 11774.44574119452}, "policy_reward_mean": {"agent_policy": 7613.917643643208, "adversary_policy": 5481.741702477252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18845.64433797032, 21116.80887922615, 4797.735126167799, 17746.479632457416, 17464.81405242744, 18167.57027572462, 17332.12833368032, 18610.317899244244, 17156.33082246675, 20196.202772629716, 20133.425485979824, 16964.439162498555, 18125.455223608096, 17574.240970377963, 17770.108794632313, 20631.787362039173, 19416.906550608543, 19574.80106403101, 22212.268415340306, 18118.58900481298, 18036.46586125934, 19946.271615391095, 17385.42073101698, 20822.637874929376, 18242.472897136446, 17461.290860353827, 17403.116129050995, 20169.315489009223, 18225.156740206297, 17930.30305213983, 20572.926421444437, 19169.987908079172, 19294.78994605833, 18279.09713096192, 20097.555700825043, 18112.243094061545, 18313.44442413958, 19690.8991939994, 20204.03079045496, 18236.152619783625, 22176.73572693131, 17046.207245827925, 17985.949760264073, 17334.86911433187, 17746.037689184617, 17869.447011331013, 20677.653430242488, 18360.186214021265, 19405.143415589027, 17390.75783363351, 20017.24978103549, 17030.359013745197, 17870.879862626443, 1275.2606289853568, 18174.872002121458, 17402.167454362298, 17414.55353924414, 22075.66104982038, 18995.116594272888, 18161.79022031683, 19351.74265253889, 17808.50777900646, 23762.36616472534, 23834.800191081882, 1747.859296659702, 23177.770684694067, 18985.60882733894, 17715.944028325463, 22224.011414332654, 17495.115487449715, 21304.72346577025, 17662.640794258565, 17024.142253256756, 18955.461508169723, 18850.892633921572, 20725.60472270602, 22787.38181656127, 17206.44066281131, 21180.158788271034, 17415.56539513323, 21875.360076316505, 18038.887503364134, 17800.09623205614, 20249.747722774235, 17910.60247802838, 20329.94525415392, 21539.627600096876, 20542.82316241106, 21367.431477143706, 19445.23495743462, 22727.3375264452, 6523.738663543173, 18412.590199855236, 19426.295518847324, 23547.60473542014, 4399.31194083585, 21416.183743538317, 21096.735042770437, 22837.685066707432, 25075.597156903128], "episode_lengths": [200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 37, 200, 200, 200, 200], "policy_agent_policy_reward": [7096.281307011208, 5240.803440369532, 744.2606215053274, 9141.85369366623, 9063.346053617232, 9275.36414553152, 9159.126909149114, 9316.872157366048, 9415.885736945824, 7538.948839289035, 7937.395008576335, 9660.822085167076, 9812.197963251854, 8736.327807008289, 9108.917224187955, 7136.244299873986, 8010.280982558451, 8015.198889007761, 5030.387607400506, 10081.377060933402, 9612.659445611083, 7991.285709924284, 9738.477883391804, 6325.128567059695, 8750.422031692262, 10199.222999247233, 10411.359325808273, 7763.8959788477705, 9522.387501882891, 9255.886956124828, 7180.801504701828, 7611.458185032805, 8564.832002734456, 9578.105807366426, 7919.739331379273, 9100.54148332264, 9584.339187994665, 6652.991995114954, 7792.5149509017065, 8775.856486791356, 5872.794849333185, 10640.776161447266, 9135.70813084706, 9660.245108013063, 10119.582867264226, 9292.748236580668, 6309.530104018889, 9238.073615268684, 7305.153326898564, 10238.798135611662, 7760.697480117836, 9797.696538806536, 9715.719638197459, 42.13699114208298, 9222.321846073994, 9704.549963399237, 10511.341791424948, 4004.781000721254, 8245.512924213788, 9781.506481446197, 8522.299545251186, 9896.291808870277, 2667.641957535821, 4131.556739568742, 110.51580100028758, 4178.24498687892, 8669.827704865518, 9622.771181374812, 5844.946909653934, 10048.263108133675, 5987.611264506883, 9503.783304414292, 9991.30449344812, 9072.74901251132, 9116.225873890497, 4931.532060016223, 4775.721586067939, 10394.65423823963, 6219.471493164905, 10017.45506884536, 5745.464800093379, 9117.659844218455, 9322.303882242428, 7750.14178855629, 9428.017952938306, 6980.760355056279, 4528.261255945213, 7443.75030408861, 5879.870944143987, 7131.607503180285, 5150.281030541036, 233.13391007035756, 8763.519723070358, 8093.496995292503, 2367.5223613005405, 380.4296264303498, 5866.833171161081, 7112.863143680009, 5131.51354966442, 2807.989726235099], "policy_adversary_policy_reward": [7045.854316719745, 4703.508714239449, 8901.332183361434, 6974.6732554952105, 1827.9937741658794, 2225.4807304965893, 4192.807039161032, 4411.818899630235, 5078.789570113716, 3322.678428696481, 4858.695686537367, 4033.5104436557644, 3189.9927099493507, 4983.008714581847, 4824.94957452771, 4468.496167350399, 3014.1951987358875, 4726.249886785083, 6519.850341656113, 6137.403591684593, 6081.025041945942, 6115.0054354576405, 2925.271652825219, 4378.345424506206, 4323.655476972486, 3989.6017833837896, 5405.8078167226695, 3432.1053466470116, 4081.0301530973225, 4580.161417347111, 6611.951957537141, 6883.591104628027, 6085.403284852879, 5321.222283197261, 5761.722499426267, 5797.879675596926, 8983.13467071641, 8198.746137223423, 4051.315496313562, 3985.896447565941, 4174.179450614723, 4249.626965033553, 6141.712739100616, 5813.2731663662125, 3715.342230515193, 3931.6006171100344, 7817.007056671263, 6680.502251198391, 5391.713592038693, 4100.337273405435, 3535.896908381406, 3726.170952725175, 3333.000576435, 3658.756226807745, 6157.229309403045, 6248.190200758439, 4102.436465536531, 4600.332772786878, 3788.167428408915, 4886.24866760611, 6549.62518355958, 6842.499733183009, 5133.840799477906, 6424.68892356844, 5561.61480389813, 5168.343139425674, 4399.690044934338, 4301.301278661153, 6034.534419367786, 6143.281950077993, 5012.154086732428, 3999.547524006488, 4245.592022594884, 4483.513213550003, 5553.759060120024, 7484.148138764395, 6194.195723189235, 6217.320116363997, 4919.3805274642555, 4540.915605528011, 8234.127979034873, 8069.81289856322, 3094.6802858427727, 3310.7507985379057, 4361.902973602931, 4488.338655814119, 3420.1431491864755, 4254.4808571322355, 3603.902065453693, 4022.552756466698, 4663.490824745245, 3913.2079500050686, 7832.6055197120795, 6535.517806511547, 4576.770422516206, 4545.342176236379, 6836.982296832385, 5263.0077918580955, 3868.0209708897905, 3283.9387271319556, 6260.95957297064, 5995.592727947025, 2888.2233900143087, 4344.439084924427, 3795.954305797645, 4359.20591863129, 735.6804681631193, 497.44316968015397, 4032.736378390482, 4919.813777656979, 4307.157684215723, 3390.459806747342, 3488.6056243044536, 3414.6061235147486, 10137.35462300969, 7933.5254260894535, 5018.949482478813, 5730.654187580248, 4277.018076799544, 4103.265662071082, 5329.628059625445, 5499.815047662276, 3953.000132701356, 3959.215837434945, 10898.65621822644, 10196.067988963054, 9724.80211304204, 9978.44133847113, 687.1991248798806, 950.1443707795338, 9963.890636852026, 9035.635060963063, 4858.79811115942, 5456.983011314004, 4519.294322096605, 3573.878524854028, 8163.783850436852, 8215.280654241908, 3378.156541810671, 4068.695837505312, 7162.682708624601, 8154.429492638832, 4052.7093090838016, 4106.1481807604605, 2936.4828302099077, 4096.354929598726, 4909.628467503525, 4973.084028154862, 4727.689089944284, 5006.977670086862, 6583.469098975099, 9210.603563714729, 8845.600418717971, 9166.05981177541, 3746.2883343777457, 3065.498090193974, 7803.407823109515, 7157.279471996571, 3273.429771402284, 4124.680554885573, 7799.018068709639, 8330.87720751349, 4659.696876369823, 4261.53078277585, 3979.07908001892, 4498.713269794803, 6357.950570919076, 6141.655363298847, 4019.657665782094, 4462.926859308033, 7161.375268674673, 6187.809630422966, 7397.491976365944, 9613.874367785726, 6573.968160315895, 6525.104698006551, 7240.863764416703, 8246.696768582964, 5335.402637343211, 6978.224816911084, 8598.98022068319, 8978.076275220948, 3231.689317743725, 3058.915435729084, 4814.248981180152, 4834.821495604748, 5846.388888668753, 5486.40963488609, 9405.636632925092, 11774.44574119452, 2141.3892689513104, 1877.4930454541884, 8275.302452569875, 7274.0481198072885, 6979.882873104413, 7003.989025985975, 8732.949755087466, 8973.22176195556, 11286.655891368338, 10980.95153929962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40314914516020406, "mean_inference_ms": 1.0018591369346657, "mean_action_processing_ms": 0.16943947206973156, "mean_env_wait_ms": 0.05489812894559076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004007816314697266, "StateBufferConnector_ms": 0.002398371696472168, "ViewRequirementAgentConnector_ms": 0.06676018238067627}, "num_episodes": 21, "episode_return_max": 25075.597156903128, "episode_return_min": 1275.2606289853568, "episode_return_mean": 18577.401048597712}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.2352672782548, "num_env_steps_trained_throughput_per_sec": 535.2352672782548, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 7513.508, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7513.473, "sample_time_ms": 737.039, "learn_time_ms": 6764.533, "learn_throughput": 591.319, "synch_weights_time_ms": 11.369}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 76, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-24", "timestamp": 1723235964, "time_this_iter_s": 7.4786272048950195, "time_total_s": 589.6247460842133, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d05e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 589.6247460842133, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.799999999999994, "ram_util_percent": 80.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6316893400299171, "cur_kl_coeff": 2.0526276111602786, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.0633230189167, "policy_loss": 0.003596976075429844, "vf_loss": 10.0, "vf_explained_var": 4.524686349132074e-06, "kl": 0.029097359533367492, "entropy": 0.4914424483580564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8755079800263047, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996947767337163, "policy_loss": -0.004216933457549506, "vf_loss": 9.993993133306503, "vf_explained_var": -0.00015715882182121277, "kl": 0.006296024289622437, "entropy": 1.467701056599617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "env_runners": {"episode_reward_max": 25075.597156903128, "episode_reward_min": 1275.2606289853568, "episode_reward_mean": 18899.046901094065, "episode_len_mean": 192.61, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19261, "policy_reward_min": {"agent_policy": 42.13699114208298, "adversary_policy": 497.44316968015397}, "policy_reward_max": {"agent_policy": 10640.776161447266, "adversary_policy": 11774.44574119452}, "policy_reward_mean": {"agent_policy": 7462.621794468274, "adversary_policy": 5718.212553312895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18118.58900481298, 18036.46586125934, 19946.271615391095, 17385.42073101698, 20822.637874929376, 18242.472897136446, 17461.290860353827, 17403.116129050995, 20169.315489009223, 18225.156740206297, 17930.30305213983, 20572.926421444437, 19169.987908079172, 19294.78994605833, 18279.09713096192, 20097.555700825043, 18112.243094061545, 18313.44442413958, 19690.8991939994, 20204.03079045496, 18236.152619783625, 22176.73572693131, 17046.207245827925, 17985.949760264073, 17334.86911433187, 17746.037689184617, 17869.447011331013, 20677.653430242488, 18360.186214021265, 19405.143415589027, 17390.75783363351, 20017.24978103549, 17030.359013745197, 17870.879862626443, 1275.2606289853568, 18174.872002121458, 17402.167454362298, 17414.55353924414, 22075.66104982038, 18995.116594272888, 18161.79022031683, 19351.74265253889, 17808.50777900646, 23762.36616472534, 23834.800191081882, 1747.859296659702, 23177.770684694067, 18985.60882733894, 17715.944028325463, 22224.011414332654, 17495.115487449715, 21304.72346577025, 17662.640794258565, 17024.142253256756, 18955.461508169723, 18850.892633921572, 20725.60472270602, 22787.38181656127, 17206.44066281131, 21180.158788271034, 17415.56539513323, 21875.360076316505, 18038.887503364134, 17800.09623205614, 20249.747722774235, 17910.60247802838, 20329.94525415392, 21539.627600096876, 20542.82316241106, 21367.431477143706, 19445.23495743462, 22727.3375264452, 6523.738663543173, 18412.590199855236, 19426.295518847324, 23547.60473542014, 4399.31194083585, 21416.183743538317, 21096.735042770437, 22837.685066707432, 25075.597156903128, 19879.21903353472, 17926.823532047776, 17733.912564493436, 23450.850390378015, 19842.446047935435, 17589.744142470063, 20032.12380959643, 18153.163359769565, 22640.781278991915, 22436.958635125895, 17762.45181824314, 18411.111261223352, 18193.635432916406, 21697.497468269823, 18269.538280633435, 22528.36928401537, 23162.93812957329, 17999.345570271696, 18291.14037125607], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200], "policy_agent_policy_reward": [10081.377060933402, 9612.659445611083, 7991.285709924284, 9738.477883391804, 6325.128567059695, 8750.422031692262, 10199.222999247233, 10411.359325808273, 7763.8959788477705, 9522.387501882891, 9255.886956124828, 7180.801504701828, 7611.458185032805, 8564.832002734456, 9578.105807366426, 7919.739331379273, 9100.54148332264, 9584.339187994665, 6652.991995114954, 7792.5149509017065, 8775.856486791356, 5872.794849333185, 10640.776161447266, 9135.70813084706, 9660.245108013063, 10119.582867264226, 9292.748236580668, 6309.530104018889, 9238.073615268684, 7305.153326898564, 10238.798135611662, 7760.697480117836, 9797.696538806536, 9715.719638197459, 42.13699114208298, 9222.321846073994, 9704.549963399237, 10511.341791424948, 4004.781000721254, 8245.512924213788, 9781.506481446197, 8522.299545251186, 9896.291808870277, 2667.641957535821, 4131.556739568742, 110.51580100028758, 4178.24498687892, 8669.827704865518, 9622.771181374812, 5844.946909653934, 10048.263108133675, 5987.611264506883, 9503.783304414292, 9991.30449344812, 9072.74901251132, 9116.225873890497, 4931.532060016223, 4775.721586067939, 10394.65423823963, 6219.471493164905, 10017.45506884536, 5745.464800093379, 9117.659844218455, 9322.303882242428, 7750.14178855629, 9428.017952938306, 6980.760355056279, 4528.261255945213, 7443.75030408861, 5879.870944143987, 7131.607503180285, 5150.281030541036, 233.13391007035756, 8763.519723070358, 8093.496995292503, 2367.5223613005405, 380.4296264303498, 5866.833171161081, 7112.863143680009, 5131.51354966442, 2807.989726235099, 8025.172142899681, 9208.61860625827, 9973.70899053995, 4179.5108753167015, 7364.56792671104, 10430.345819723438, 7881.133087056489, 8654.869877670688, 3634.0774226901945, 5270.927725278047, 9371.526399793149, 9279.65178694984, 9034.942438777285, 3363.14217139593, 9222.079476912682, 4789.40988325169, 3166.696759570414, 1992.28409873074, 9468.264364463661], "policy_adversary_policy_reward": [4051.315496313562, 3985.896447565941, 4174.179450614723, 4249.626965033553, 6141.712739100616, 5813.2731663662125, 3715.342230515193, 3931.6006171100344, 7817.007056671263, 6680.502251198391, 5391.713592038693, 4100.337273405435, 3535.896908381406, 3726.170952725175, 3333.000576435, 3658.756226807745, 6157.229309403045, 6248.190200758439, 4102.436465536531, 4600.332772786878, 3788.167428408915, 4886.24866760611, 6549.62518355958, 6842.499733183009, 5133.840799477906, 6424.68892356844, 5561.61480389813, 5168.343139425674, 4399.690044934338, 4301.301278661153, 6034.534419367786, 6143.281950077993, 5012.154086732428, 3999.547524006488, 4245.592022594884, 4483.513213550003, 5553.759060120024, 7484.148138764395, 6194.195723189235, 6217.320116363997, 4919.3805274642555, 4540.915605528011, 8234.127979034873, 8069.81289856322, 3094.6802858427727, 3310.7507985379057, 4361.902973602931, 4488.338655814119, 3420.1431491864755, 4254.4808571322355, 3603.902065453693, 4022.552756466698, 4663.490824745245, 3913.2079500050686, 7832.6055197120795, 6535.517806511547, 4576.770422516206, 4545.342176236379, 6836.982296832385, 5263.0077918580955, 3868.0209708897905, 3283.9387271319556, 6260.95957297064, 5995.592727947025, 2888.2233900143087, 4344.439084924427, 3795.954305797645, 4359.20591863129, 735.6804681631193, 497.44316968015397, 4032.736378390482, 4919.813777656979, 4307.157684215723, 3390.459806747342, 3488.6056243044536, 3414.6061235147486, 10137.35462300969, 7933.5254260894535, 5018.949482478813, 5730.654187580248, 4277.018076799544, 4103.265662071082, 5329.628059625445, 5499.815047662276, 3953.000132701356, 3959.215837434945, 10898.65621822644, 10196.067988963054, 9724.80211304204, 9978.44133847113, 687.1991248798806, 950.1443707795338, 9963.890636852026, 9035.635060963063, 4858.79811115942, 5456.983011314004, 4519.294322096605, 3573.878524854028, 8163.783850436852, 8215.280654241908, 3378.156541810671, 4068.695837505312, 7162.682708624601, 8154.429492638832, 4052.7093090838016, 4106.1481807604605, 2936.4828302099077, 4096.354929598726, 4909.628467503525, 4973.084028154862, 4727.689089944284, 5006.977670086862, 6583.469098975099, 9210.603563714729, 8845.600418717971, 9166.05981177541, 3746.2883343777457, 3065.498090193974, 7803.407823109515, 7157.279471996571, 3273.429771402284, 4124.680554885573, 7799.018068709639, 8330.87720751349, 4659.696876369823, 4261.53078277585, 3979.07908001892, 4498.713269794803, 6357.950570919076, 6141.655363298847, 4019.657665782094, 4462.926859308033, 7161.375268674673, 6187.809630422966, 7397.491976365944, 9613.874367785726, 6573.968160315895, 6525.104698006551, 7240.863764416703, 8246.696768582964, 5335.402637343211, 6978.224816911084, 8598.98022068319, 8978.076275220948, 3231.689317743725, 3058.915435729084, 4814.248981180152, 4834.821495604748, 5846.388888668753, 5486.40963488609, 9405.636632925092, 11774.44574119452, 2141.3892689513104, 1877.4930454541884, 8275.302452569875, 7274.0481198072885, 6979.882873104413, 7003.989025985975, 8732.949755087466, 8973.22176195556, 11286.655891368338, 10980.95153929962, 5758.025698514752, 6096.021192120325, 4886.660748709398, 3831.5441770801613, 3605.740177395246, 4154.463396558246, 9900.390935700949, 9370.948579360347, 6526.252731771655, 5951.625389452726, 3636.4098635413607, 3522.9884592052335, 6239.075920795901, 5911.914801744003, 4022.307014026858, 5475.986468072086, 9805.558503002227, 9201.145353299517, 8391.613367219472, 8774.417542628351, 4481.492233168251, 3909.4331852818195, 4569.2248002668175, 4562.234674006645, 5035.504862983157, 4123.188131155937, 7555.369314809561, 10778.985982064372, 4865.195558739947, 4182.263244980847, 8866.162391338848, 8872.797009424841, 10975.438864160544, 9020.802505842312, 7473.2359982869975, 8533.825473253984, 4277.727107377628, 4545.1488994147785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40290681585641636, "mean_inference_ms": 1.0013143200240984, "mean_action_processing_ms": 0.16936598745495604, "mean_env_wait_ms": 0.05486390974603448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034655332565307617, "StateBufferConnector_ms": 0.002431631088256836, "ViewRequirementAgentConnector_ms": 0.06792247295379639}, "num_episodes": 19, "episode_return_max": 25075.597156903128, "episode_return_min": 1275.2606289853568, "episode_return_mean": 18899.046901094065}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.0069440065682, "num_env_steps_trained_throughput_per_sec": 540.0069440065682, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 7492.012, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7491.978, "sample_time_ms": 739.498, "learn_time_ms": 6740.701, "learn_throughput": 593.41, "synch_weights_time_ms": 11.249}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "training_iteration": 77, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-31", "timestamp": 1723235971, "time_this_iter_s": 7.412700176239014, "time_total_s": 597.0374462604523, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d0820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 597.0374462604523, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 24.85454545454546, "ram_util_percent": 80.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.855603489279747, "cur_kl_coeff": 3.0789414167404177, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.148496078814148, "policy_loss": 0.013065174586267738, "vf_loss": 9.998760324811178, "vf_explained_var": 5.267599903086506e-07, "kl": 0.04438881618340337, "entropy": 0.528497065343554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9038635361008346, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990171104669571, "policy_loss": -0.000853716509785348, "vf_loss": 9.987713385621706, "vf_explained_var": -0.0001942284405231476, "kl": 0.0029071450463864796, "entropy": 1.4711023863404988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 25075.597156903128, "episode_reward_min": 1275.2606289853568, "episode_reward_mean": 19056.466998964046, "episode_len_mean": 190.38, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19038, "policy_reward_min": {"agent_policy": 42.13699114208298, "adversary_policy": 497.44316968015397}, "policy_reward_max": {"agent_policy": 10640.776161447266, "adversary_policy": 11774.44574119452}, "policy_reward_mean": {"agent_policy": 6993.176416516188, "adversary_policy": 6031.645291223929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18236.152619783625, 22176.73572693131, 17046.207245827925, 17985.949760264073, 17334.86911433187, 17746.037689184617, 17869.447011331013, 20677.653430242488, 18360.186214021265, 19405.143415589027, 17390.75783363351, 20017.24978103549, 17030.359013745197, 17870.879862626443, 1275.2606289853568, 18174.872002121458, 17402.167454362298, 17414.55353924414, 22075.66104982038, 18995.116594272888, 18161.79022031683, 19351.74265253889, 17808.50777900646, 23762.36616472534, 23834.800191081882, 1747.859296659702, 23177.770684694067, 18985.60882733894, 17715.944028325463, 22224.011414332654, 17495.115487449715, 21304.72346577025, 17662.640794258565, 17024.142253256756, 18955.461508169723, 18850.892633921572, 20725.60472270602, 22787.38181656127, 17206.44066281131, 21180.158788271034, 17415.56539513323, 21875.360076316505, 18038.887503364134, 17800.09623205614, 20249.747722774235, 17910.60247802838, 20329.94525415392, 21539.627600096876, 20542.82316241106, 21367.431477143706, 19445.23495743462, 22727.3375264452, 6523.738663543173, 18412.590199855236, 19426.295518847324, 23547.60473542014, 4399.31194083585, 21416.183743538317, 21096.735042770437, 22837.685066707432, 25075.597156903128, 19879.21903353472, 17926.823532047776, 17733.912564493436, 23450.850390378015, 19842.446047935435, 17589.744142470063, 20032.12380959643, 18153.163359769565, 22640.781278991915, 22436.958635125895, 17762.45181824314, 18411.111261223352, 18193.635432916406, 21697.497468269823, 18269.538280633435, 22528.36928401537, 23162.93812957329, 17999.345570271696, 18291.14037125607, 23420.583971280616, 17739.72309929759, 23237.864412798874, 1800.0288846622334, 17616.313619342003, 22862.9423003252, 21606.321387524622, 18034.602975400234, 17825.80795389234, 23709.25387924434, 20976.80816128706, 20075.3315812818, 19013.9674502121, 23728.18935412351, 22503.6718146487, 20945.380943918553, 22506.8738053301, 18460.34183601847, 19884.650835459004, 17269.366386281505], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200], "policy_agent_policy_reward": [8775.856486791356, 5872.794849333185, 10640.776161447266, 9135.70813084706, 9660.245108013063, 10119.582867264226, 9292.748236580668, 6309.530104018889, 9238.073615268684, 7305.153326898564, 10238.798135611662, 7760.697480117836, 9797.696538806536, 9715.719638197459, 42.13699114208298, 9222.321846073994, 9704.549963399237, 10511.341791424948, 4004.781000721254, 8245.512924213788, 9781.506481446197, 8522.299545251186, 9896.291808870277, 2667.641957535821, 4131.556739568742, 110.51580100028758, 4178.24498687892, 8669.827704865518, 9622.771181374812, 5844.946909653934, 10048.263108133675, 5987.611264506883, 9503.783304414292, 9991.30449344812, 9072.74901251132, 9116.225873890497, 4931.532060016223, 4775.721586067939, 10394.65423823963, 6219.471493164905, 10017.45506884536, 5745.464800093379, 9117.659844218455, 9322.303882242428, 7750.14178855629, 9428.017952938306, 6980.760355056279, 4528.261255945213, 7443.75030408861, 5879.870944143987, 7131.607503180285, 5150.281030541036, 233.13391007035756, 8763.519723070358, 8093.496995292503, 2367.5223613005405, 380.4296264303498, 5866.833171161081, 7112.863143680009, 5131.51354966442, 2807.989726235099, 8025.172142899681, 9208.61860625827, 9973.70899053995, 4179.5108753167015, 7364.56792671104, 10430.345819723438, 7881.133087056489, 8654.869877670688, 3634.0774226901945, 5270.927725278047, 9371.526399793149, 9279.65178694984, 9034.942438777285, 3363.14217139593, 9222.079476912682, 4789.40988325169, 3166.696759570414, 1992.28409873074, 9468.264364463661, 4342.190357022765, 9313.244154656286, 4423.696395684118, 67.97221499212806, 9450.141546510049, 5184.466444548112, 6246.814466308443, 9367.387568924278, 10115.616424809234, 4125.918143893784, 5362.756087893887, 8010.886300744911, 8832.649892301222, 4234.374369363631, 4251.775338419428, 6605.873697352969, 5240.740115207921, 9139.86182713012, 2070.0970546496224, 10306.427713450707], "policy_adversary_policy_reward": [4919.3805274642555, 4540.915605528011, 8234.127979034873, 8069.81289856322, 3094.6802858427727, 3310.7507985379057, 4361.902973602931, 4488.338655814119, 3420.1431491864755, 4254.4808571322355, 3603.902065453693, 4022.552756466698, 4663.490824745245, 3913.2079500050686, 7832.6055197120795, 6535.517806511547, 4576.770422516206, 4545.342176236379, 6836.982296832385, 5263.0077918580955, 3868.0209708897905, 3283.9387271319556, 6260.95957297064, 5995.592727947025, 2888.2233900143087, 4344.439084924427, 3795.954305797645, 4359.20591863129, 735.6804681631193, 497.44316968015397, 4032.736378390482, 4919.813777656979, 4307.157684215723, 3390.459806747342, 3488.6056243044536, 3414.6061235147486, 10137.35462300969, 7933.5254260894535, 5018.949482478813, 5730.654187580248, 4277.018076799544, 4103.265662071082, 5329.628059625445, 5499.815047662276, 3953.000132701356, 3959.215837434945, 10898.65621822644, 10196.067988963054, 9724.80211304204, 9978.44133847113, 687.1991248798806, 950.1443707795338, 9963.890636852026, 9035.635060963063, 4858.79811115942, 5456.983011314004, 4519.294322096605, 3573.878524854028, 8163.783850436852, 8215.280654241908, 3378.156541810671, 4068.695837505312, 7162.682708624601, 8154.429492638832, 4052.7093090838016, 4106.1481807604605, 2936.4828302099077, 4096.354929598726, 4909.628467503525, 4973.084028154862, 4727.689089944284, 5006.977670086862, 6583.469098975099, 9210.603563714729, 8845.600418717971, 9166.05981177541, 3746.2883343777457, 3065.498090193974, 7803.407823109515, 7157.279471996571, 3273.429771402284, 4124.680554885573, 7799.018068709639, 8330.87720751349, 4659.696876369823, 4261.53078277585, 3979.07908001892, 4498.713269794803, 6357.950570919076, 6141.655363298847, 4019.657665782094, 4462.926859308033, 7161.375268674673, 6187.809630422966, 7397.491976365944, 9613.874367785726, 6573.968160315895, 6525.104698006551, 7240.863764416703, 8246.696768582964, 5335.402637343211, 6978.224816911084, 8598.98022068319, 8978.076275220948, 3231.689317743725, 3058.915435729084, 4814.248981180152, 4834.821495604748, 5846.388888668753, 5486.40963488609, 9405.636632925092, 11774.44574119452, 2141.3892689513104, 1877.4930454541884, 8275.302452569875, 7274.0481198072885, 6979.882873104413, 7003.989025985975, 8732.949755087466, 8973.22176195556, 11286.655891368338, 10980.95153929962, 5758.025698514752, 6096.021192120325, 4886.660748709398, 3831.5441770801613, 3605.740177395246, 4154.463396558246, 9900.390935700949, 9370.948579360347, 6526.252731771655, 5951.625389452726, 3636.4098635413607, 3522.9884592052335, 6239.075920795901, 5911.914801744003, 4022.307014026858, 5475.986468072086, 9805.558503002227, 9201.145353299517, 8391.613367219472, 8774.417542628351, 4481.492233168251, 3909.4331852818195, 4569.2248002668175, 4562.234674006645, 5035.504862983157, 4123.188131155937, 7555.369314809561, 10778.985982064372, 4865.195558739947, 4182.263244980847, 8866.162391338848, 8872.797009424841, 10975.438864160544, 9020.802505842312, 7473.2359982869975, 8533.825473253984, 4277.727107377628, 4545.1488994147785, 9606.460916610658, 9471.932697647146, 4778.656116007467, 3647.8228286338294, 9655.142223108696, 9159.025794006051, 810.0793910010661, 921.9772786690386, 4691.994077220889, 3474.177995611041, 8807.679176478556, 8870.796679298614, 7820.642119654745, 7538.864801561401, 4772.130771443954, 3895.084635031955, 3852.1510449765146, 3858.040484106564, 9677.993718063446, 9905.34201728719, 8779.379535837063, 6834.672537556126, 6112.111278208797, 5952.334002328105, 4921.9314861719595, 5259.386071738986, 9762.375248899794, 9731.439735860113, 8516.184560139678, 9735.71191608959, 6981.777107699359, 7357.730138866189, 8664.53167371339, 8601.60201640876, 4318.643521576762, 5001.836487311621, 9096.638211272057, 8717.915569537328, 3336.5179740560566, 3626.420698774678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40264256660954767, "mean_inference_ms": 1.0005797123248867, "mean_action_processing_ms": 0.16932718034342897, "mean_env_wait_ms": 0.05473937558781573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003403902053833008, "StateBufferConnector_ms": 0.0024962425231933594, "ViewRequirementAgentConnector_ms": 0.06951677799224854}, "num_episodes": 20, "episode_return_max": 25075.597156903128, "episode_return_min": 1275.2606289853568, "episode_return_mean": 19056.466998964046}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.7316235303173, "num_env_steps_trained_throughput_per_sec": 553.7316235303173, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 7450.193, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7450.159, "sample_time_ms": 739.315, "learn_time_ms": 6698.878, "learn_throughput": 597.115, "synch_weights_time_ms": 11.435}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 78, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-39", "timestamp": 1723235979, "time_this_iter_s": 7.228736877441406, "time_total_s": 604.2661831378937, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 604.2661831378937, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 24.14545454545454, "ram_util_percent": 80.10909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0109699822134441, "cur_kl_coeff": 4.618412125110625, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.175419733259414, "policy_loss": 0.010636188953661571, "vf_loss": 10.0, "vf_explained_var": 2.1529071545474745e-05, "kl": 0.03567970118648003, "entropy": 0.49064841622082644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8962782621073226, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98648102581501, "policy_loss": -0.005403236031270353, "vf_loss": 9.988495760162671, "vf_explained_var": -0.00026974851886431376, "kl": 0.005949614587977218, "entropy": 1.4511121660470963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "env_runners": {"episode_reward_max": 25075.597156903128, "episode_reward_min": 1747.859296659702, "episode_reward_mean": 19571.00740102163, "episode_len_mean": 189.87, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18987, "policy_reward_min": {"agent_policy": 67.97221499212806, "adversary_policy": 687.1991248798806}, "policy_reward_max": {"agent_policy": 10430.345819723438, "adversary_policy": 11915.881490154083}, "policy_reward_mean": {"agent_policy": 6375.178981772225, "adversary_policy": 6597.914209624706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17808.50777900646, 23762.36616472534, 23834.800191081882, 1747.859296659702, 23177.770684694067, 18985.60882733894, 17715.944028325463, 22224.011414332654, 17495.115487449715, 21304.72346577025, 17662.640794258565, 17024.142253256756, 18955.461508169723, 18850.892633921572, 20725.60472270602, 22787.38181656127, 17206.44066281131, 21180.158788271034, 17415.56539513323, 21875.360076316505, 18038.887503364134, 17800.09623205614, 20249.747722774235, 17910.60247802838, 20329.94525415392, 21539.627600096876, 20542.82316241106, 21367.431477143706, 19445.23495743462, 22727.3375264452, 6523.738663543173, 18412.590199855236, 19426.295518847324, 23547.60473542014, 4399.31194083585, 21416.183743538317, 21096.735042770437, 22837.685066707432, 25075.597156903128, 19879.21903353472, 17926.823532047776, 17733.912564493436, 23450.850390378015, 19842.446047935435, 17589.744142470063, 20032.12380959643, 18153.163359769565, 22640.781278991915, 22436.958635125895, 17762.45181824314, 18411.111261223352, 18193.635432916406, 21697.497468269823, 18269.538280633435, 22528.36928401537, 23162.93812957329, 17999.345570271696, 18291.14037125607, 23420.583971280616, 17739.72309929759, 23237.864412798874, 1800.0288846622334, 17616.313619342003, 22862.9423003252, 21606.321387524622, 18034.602975400234, 17825.80795389234, 23709.25387924434, 20976.80816128706, 20075.3315812818, 19013.9674502121, 23728.18935412351, 22503.6718146487, 20945.380943918553, 22506.8738053301, 18460.34183601847, 19884.650835459004, 17269.366386281505, 18918.94369255869, 14209.70617983945, 21838.28563065313, 22885.857105035422, 17911.240811195148, 20580.10764696271, 19159.265111453577, 23372.20644312558, 21770.327035686452, 23175.905342003276, 21957.586185926506, 23480.875151434033, 22240.53941532582, 24543.400606777504, 18543.164830624148, 18220.666381170337, 23498.787715096238, 22798.433620051597, 20924.273651098225, 19782.669745590803, 18753.290848210097, 4887.299916150073], "episode_lengths": [200, 200, 200, 15, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 116, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44], "policy_agent_policy_reward": [9896.291808870277, 2667.641957535821, 4131.556739568742, 110.51580100028758, 4178.24498687892, 8669.827704865518, 9622.771181374812, 5844.946909653934, 10048.263108133675, 5987.611264506883, 9503.783304414292, 9991.30449344812, 9072.74901251132, 9116.225873890497, 4931.532060016223, 4775.721586067939, 10394.65423823963, 6219.471493164905, 10017.45506884536, 5745.464800093379, 9117.659844218455, 9322.303882242428, 7750.14178855629, 9428.017952938306, 6980.760355056279, 4528.261255945213, 7443.75030408861, 5879.870944143987, 7131.607503180285, 5150.281030541036, 233.13391007035756, 8763.519723070358, 8093.496995292503, 2367.5223613005405, 380.4296264303498, 5866.833171161081, 7112.863143680009, 5131.51354966442, 2807.989726235099, 8025.172142899681, 9208.61860625827, 9973.70899053995, 4179.5108753167015, 7364.56792671104, 10430.345819723438, 7881.133087056489, 8654.869877670688, 3634.0774226901945, 5270.927725278047, 9371.526399793149, 9279.65178694984, 9034.942438777285, 3363.14217139593, 9222.079476912682, 4789.40988325169, 3166.696759570414, 1992.28409873074, 9468.264364463661, 4342.190357022765, 9313.244154656286, 4423.696395684118, 67.97221499212806, 9450.141546510049, 5184.466444548112, 6246.814466308443, 9367.387568924278, 10115.616424809234, 4125.918143893784, 5362.756087893887, 8010.886300744911, 8832.649892301222, 4234.374369363631, 4251.775338419428, 6605.873697352969, 5240.740115207921, 9139.86182713012, 2070.0970546496224, 10306.427713450707, 9162.436781604867, 654.1116614143074, 5343.42833536573, 2226.254133576889, 9670.395970908841, 5962.5203701452765, 7258.446778001374, 4614.409576974407, 5812.655104171896, 4491.315586925495, 5129.073216625536, 4098.7638158227255, 4073.562246446847, 3268.2956117907347, 9416.41987344183, 8381.442363105178, 4360.965376452288, 4691.7022271323485, 6058.30763779932, 8116.72104800023, 8719.488099092156, 587.3719336745252], "policy_adversary_policy_reward": [3953.000132701356, 3959.215837434945, 10898.65621822644, 10196.067988963054, 9724.80211304204, 9978.44133847113, 687.1991248798806, 950.1443707795338, 9963.890636852026, 9035.635060963063, 4858.79811115942, 5456.983011314004, 4519.294322096605, 3573.878524854028, 8163.783850436852, 8215.280654241908, 3378.156541810671, 4068.695837505312, 7162.682708624601, 8154.429492638832, 4052.7093090838016, 4106.1481807604605, 2936.4828302099077, 4096.354929598726, 4909.628467503525, 4973.084028154862, 4727.689089944284, 5006.977670086862, 6583.469098975099, 9210.603563714729, 8845.600418717971, 9166.05981177541, 3746.2883343777457, 3065.498090193974, 7803.407823109515, 7157.279471996571, 3273.429771402284, 4124.680554885573, 7799.018068709639, 8330.87720751349, 4659.696876369823, 4261.53078277585, 3979.07908001892, 4498.713269794803, 6357.950570919076, 6141.655363298847, 4019.657665782094, 4462.926859308033, 7161.375268674673, 6187.809630422966, 7397.491976365944, 9613.874367785726, 6573.968160315895, 6525.104698006551, 7240.863764416703, 8246.696768582964, 5335.402637343211, 6978.224816911084, 8598.98022068319, 8978.076275220948, 3231.689317743725, 3058.915435729084, 4814.248981180152, 4834.821495604748, 5846.388888668753, 5486.40963488609, 9405.636632925092, 11774.44574119452, 2141.3892689513104, 1877.4930454541884, 8275.302452569875, 7274.0481198072885, 6979.882873104413, 7003.989025985975, 8732.949755087466, 8973.22176195556, 11286.655891368338, 10980.95153929962, 5758.025698514752, 6096.021192120325, 4886.660748709398, 3831.5441770801613, 3605.740177395246, 4154.463396558246, 9900.390935700949, 9370.948579360347, 6526.252731771655, 5951.625389452726, 3636.4098635413607, 3522.9884592052335, 6239.075920795901, 5911.914801744003, 4022.307014026858, 5475.986468072086, 9805.558503002227, 9201.145353299517, 8391.613367219472, 8774.417542628351, 4481.492233168251, 3909.4331852818195, 4569.2248002668175, 4562.234674006645, 5035.504862983157, 4123.188131155937, 7555.369314809561, 10778.985982064372, 4865.195558739947, 4182.263244980847, 8866.162391338848, 8872.797009424841, 10975.438864160544, 9020.802505842312, 7473.2359982869975, 8533.825473253984, 4277.727107377628, 4545.1488994147785, 9606.460916610658, 9471.932697647146, 4778.656116007467, 3647.8228286338294, 9655.142223108696, 9159.025794006051, 810.0793910010661, 921.9772786690386, 4691.994077220889, 3474.177995611041, 8807.679176478556, 8870.796679298614, 7820.642119654745, 7538.864801561401, 4772.130771443954, 3895.084635031955, 3852.1510449765146, 3858.040484106564, 9677.993718063446, 9905.34201728719, 8779.379535837063, 6834.672537556126, 6112.111278208797, 5952.334002328105, 4921.9314861719595, 5259.386071738986, 9762.375248899794, 9731.439735860113, 8516.184560139678, 9735.71191608959, 6981.777107699359, 7357.730138866189, 8664.53167371339, 8601.60201640876, 4318.643521576762, 5001.836487311621, 9096.638211272057, 8717.915569537328, 3336.5179740560566, 3626.420698774678, 4880.796399422753, 4875.710511531058, 6007.267518075531, 7548.327000349642, 8795.352997688738, 7699.50429759862, 11915.881490154083, 8743.72148130447, 3769.6509274646946, 4471.193912821631, 7614.667963992528, 7002.919312824874, 5017.129487722694, 6883.688845729584, 9370.379115470017, 9387.417750681145, 7628.729689388596, 8328.942242125971, 9390.796218924426, 9293.793536153325, 7821.081378877824, 9007.431590423166, 9375.015391194607, 10007.095944416704, 10067.132368720433, 8099.844800158452, 10719.215071394688, 10555.889923592093, 4642.535918198087, 4484.20903898422, 5760.69326062577, 4078.5307574394383, 9532.140264655804, 9605.682073988077, 8982.043693714146, 9124.68769920509, 7334.462750182696, 7531.503263116228, 5650.352420659977, 6015.5962769306325, 4754.55917462401, 5279.243574493908, 1776.0300789292617, 2523.8979035462835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40238807844028945, "mean_inference_ms": 0.9999383149715472, "mean_action_processing_ms": 0.16914934928388117, "mean_env_wait_ms": 0.0547475070537248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003209233283996582, "StateBufferConnector_ms": 0.002453327178955078, "ViewRequirementAgentConnector_ms": 0.06768691539764404}, "num_episodes": 22, "episode_return_max": 25075.597156903128, "episode_return_min": 1747.859296659702, "episode_return_mean": 19571.00740102163}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.2282515458915, "num_env_steps_trained_throughput_per_sec": 553.2282515458915, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 7424.852, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7424.818, "sample_time_ms": 731.989, "learn_time_ms": 6680.79, "learn_throughput": 598.732, "synch_weights_time_ms": 11.507}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "training_iteration": 79, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-46", "timestamp": 1723235986, "time_this_iter_s": 7.234958171844482, "time_total_s": 611.5011413097382, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d08b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 611.5011413097382, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 25.459999999999997, "ram_util_percent": 79.86999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3481945125514236, "cur_kl_coeff": 6.927618187665941, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.299701003422813, "policy_loss": 0.008507046669169708, "vf_loss": 10.0, "vf_explained_var": 2.1827126306200785e-05, "kl": 0.04203378073378372, "entropy": 0.5149976850029022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.903310269334664, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994799839456876, "policy_loss": -0.0034557536579086444, "vf_loss": 9.994678288698196, "vf_explained_var": -0.00021146858731905618, "kl": 0.006281158055450457, "entropy": 1.4565857131034137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 25189.573359270915, "episode_reward_min": 1800.0288846622334, "episode_reward_mean": 20034.224792281915, "episode_len_mean": 191.08, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19108, "policy_reward_min": {"agent_policy": 67.97221499212806, "adversary_policy": 810.0793910010661}, "policy_reward_max": {"agent_policy": 10430.345819723438, "adversary_policy": 12225.149804256043}, "policy_reward_mean": {"agent_policy": 6079.620000810013, "adversary_policy": 6977.302395735952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20249.747722774235, 17910.60247802838, 20329.94525415392, 21539.627600096876, 20542.82316241106, 21367.431477143706, 19445.23495743462, 22727.3375264452, 6523.738663543173, 18412.590199855236, 19426.295518847324, 23547.60473542014, 4399.31194083585, 21416.183743538317, 21096.735042770437, 22837.685066707432, 25075.597156903128, 19879.21903353472, 17926.823532047776, 17733.912564493436, 23450.850390378015, 19842.446047935435, 17589.744142470063, 20032.12380959643, 18153.163359769565, 22640.781278991915, 22436.958635125895, 17762.45181824314, 18411.111261223352, 18193.635432916406, 21697.497468269823, 18269.538280633435, 22528.36928401537, 23162.93812957329, 17999.345570271696, 18291.14037125607, 23420.583971280616, 17739.72309929759, 23237.864412798874, 1800.0288846622334, 17616.313619342003, 22862.9423003252, 21606.321387524622, 18034.602975400234, 17825.80795389234, 23709.25387924434, 20976.80816128706, 20075.3315812818, 19013.9674502121, 23728.18935412351, 22503.6718146487, 20945.380943918553, 22506.8738053301, 18460.34183601847, 19884.650835459004, 17269.366386281505, 18918.94369255869, 14209.70617983945, 21838.28563065313, 22885.857105035422, 17911.240811195148, 20580.10764696271, 19159.265111453577, 23372.20644312558, 21770.327035686452, 23175.905342003276, 21957.586185926506, 23480.875151434033, 22240.53941532582, 24543.400606777504, 18543.164830624148, 18220.666381170337, 23498.787715096238, 22798.433620051597, 20924.273651098225, 19782.669745590803, 18753.290848210097, 4887.299916150073, 16328.118699185019, 18595.74042071477, 20250.195112992093, 21414.216682673272, 19398.895139855376, 21127.126474928707, 25189.573359270915, 20894.646552451206, 20220.447907899932, 19076.647112699633, 23354.728309195572, 19452.981384455936, 24351.659989624728, 17743.96449776786, 19142.79508468071, 23781.073151114546, 23601.77878949278, 18797.76835184642, 22683.39892947488, 24097.17248812946, 20519.64520930275, 23878.505204482415], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 37, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 116, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7750.14178855629, 9428.017952938306, 6980.760355056279, 4528.261255945213, 7443.75030408861, 5879.870944143987, 7131.607503180285, 5150.281030541036, 233.13391007035756, 8763.519723070358, 8093.496995292503, 2367.5223613005405, 380.4296264303498, 5866.833171161081, 7112.863143680009, 5131.51354966442, 2807.989726235099, 8025.172142899681, 9208.61860625827, 9973.70899053995, 4179.5108753167015, 7364.56792671104, 10430.345819723438, 7881.133087056489, 8654.869877670688, 3634.0774226901945, 5270.927725278047, 9371.526399793149, 9279.65178694984, 9034.942438777285, 3363.14217139593, 9222.079476912682, 4789.40988325169, 3166.696759570414, 1992.28409873074, 9468.264364463661, 4342.190357022765, 9313.244154656286, 4423.696395684118, 67.97221499212806, 9450.141546510049, 5184.466444548112, 6246.814466308443, 9367.387568924278, 10115.616424809234, 4125.918143893784, 5362.756087893887, 8010.886300744911, 8832.649892301222, 4234.374369363631, 4251.775338419428, 6605.873697352969, 5240.740115207921, 9139.86182713012, 2070.0970546496224, 10306.427713450707, 9162.436781604867, 654.1116614143074, 5343.42833536573, 2226.254133576889, 9670.395970908841, 5962.5203701452765, 7258.446778001374, 4614.409576974407, 5812.655104171896, 4491.315586925495, 5129.073216625536, 4098.7638158227255, 4073.562246446847, 3268.2956117907347, 9416.41987344183, 8381.442363105178, 4360.965376452288, 4691.7022271323485, 6058.30763779932, 8116.72104800023, 8719.488099092156, 587.3719336745252, 2236.8424999261715, 9063.899221818518, 7198.072983416254, 6071.948583762489, 7738.16999129091, 6384.300960622539, 1605.690729183604, 6034.461006528762, 7684.071998695923, 8742.8128423926, 3753.14138591853, 8302.359652934332, 2864.4195507662075, 9901.712766849445, 8617.649978627844, 3395.2661808636008, 4201.938918565001, 9095.533197893801, 3165.6451448233997, 3672.6751921353166, 6587.456856558381, 3492.029379746774], "policy_adversary_policy_reward": [6357.950570919076, 6141.655363298847, 4019.657665782094, 4462.926859308033, 7161.375268674673, 6187.809630422966, 7397.491976365944, 9613.874367785726, 6573.968160315895, 6525.104698006551, 7240.863764416703, 8246.696768582964, 5335.402637343211, 6978.224816911084, 8598.98022068319, 8978.076275220948, 3231.689317743725, 3058.915435729084, 4814.248981180152, 4834.821495604748, 5846.388888668753, 5486.40963488609, 9405.636632925092, 11774.44574119452, 2141.3892689513104, 1877.4930454541884, 8275.302452569875, 7274.0481198072885, 6979.882873104413, 7003.989025985975, 8732.949755087466, 8973.22176195556, 11286.655891368338, 10980.95153929962, 5758.025698514752, 6096.021192120325, 4886.660748709398, 3831.5441770801613, 3605.740177395246, 4154.463396558246, 9900.390935700949, 9370.948579360347, 6526.252731771655, 5951.625389452726, 3636.4098635413607, 3522.9884592052335, 6239.075920795901, 5911.914801744003, 4022.307014026858, 5475.986468072086, 9805.558503002227, 9201.145353299517, 8391.613367219472, 8774.417542628351, 4481.492233168251, 3909.4331852818195, 4569.2248002668175, 4562.234674006645, 5035.504862983157, 4123.188131155937, 7555.369314809561, 10778.985982064372, 4865.195558739947, 4182.263244980847, 8866.162391338848, 8872.797009424841, 10975.438864160544, 9020.802505842312, 7473.2359982869975, 8533.825473253984, 4277.727107377628, 4545.1488994147785, 9606.460916610658, 9471.932697647146, 4778.656116007467, 3647.8228286338294, 9655.142223108696, 9159.025794006051, 810.0793910010661, 921.9772786690386, 4691.994077220889, 3474.177995611041, 8807.679176478556, 8870.796679298614, 7820.642119654745, 7538.864801561401, 4772.130771443954, 3895.084635031955, 3852.1510449765146, 3858.040484106564, 9677.993718063446, 9905.34201728719, 8779.379535837063, 6834.672537556126, 6112.111278208797, 5952.334002328105, 4921.9314861719595, 5259.386071738986, 9762.375248899794, 9731.439735860113, 8516.184560139678, 9735.71191608959, 6981.777107699359, 7357.730138866189, 8664.53167371339, 8601.60201640876, 4318.643521576762, 5001.836487311621, 9096.638211272057, 8717.915569537328, 3336.5179740560566, 3626.420698774678, 4880.796399422753, 4875.710511531058, 6007.267518075531, 7548.327000349642, 8795.352997688738, 7699.50429759862, 11915.881490154083, 8743.72148130447, 3769.6509274646946, 4471.193912821631, 7614.667963992528, 7002.919312824874, 5017.129487722694, 6883.688845729584, 9370.379115470017, 9387.417750681145, 7628.729689388596, 8328.942242125971, 9390.796218924426, 9293.793536153325, 7821.081378877824, 9007.431590423166, 9375.015391194607, 10007.095944416704, 10067.132368720433, 8099.844800158452, 10719.215071394688, 10555.889923592093, 4642.535918198087, 4484.20903898422, 5760.69326062577, 4078.5307574394383, 9532.140264655804, 9605.682073988077, 8982.043693714146, 9124.68769920509, 7334.462750182696, 7531.503263116228, 5650.352420659977, 6015.5962769306325, 4754.55917462401, 5279.243574493908, 1776.0300789292617, 2523.8979035462835, 6827.3552227147575, 7263.9209765440755, 5036.293938537443, 4495.547260358788, 6751.276507220826, 6300.845622355102, 7529.4859860285915, 7812.782112882195, 6382.383413621385, 5278.341734943144, 7468.188869965022, 7274.636644341125, 11358.732825831328, 12225.149804256043, 6878.453287154237, 7981.732258768211, 6132.833655482308, 6403.542253721721, 5199.098016173539, 5134.736254133513, 9634.576903340992, 9967.01001993603, 5814.137379389156, 5336.484352132461, 10724.081165580212, 10763.159273278434, 3868.035276432061, 3974.2164544862976, 5000.792850164602, 5524.352255888277, 10734.011590144366, 9651.79538010663, 9742.135106206006, 9657.704764721779, 4972.884338399607, 4729.350815553037, 10962.169758991005, 8555.5840256605, 10333.666467869038, 10090.830828125096, 6377.509585571752, 7554.678767172576, 9736.369580751454, 10650.10624398421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021792113420948, "mean_inference_ms": 0.9991309640527299, "mean_action_processing_ms": 0.16907028644417096, "mean_env_wait_ms": 0.054671832778854686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003166794776916504, "StateBufferConnector_ms": 0.0024051666259765625, "ViewRequirementAgentConnector_ms": 0.065621018409729}, "num_episodes": 22, "episode_return_max": 25189.573359270915, "episode_return_min": 1800.0288846622334, "episode_return_mean": 20034.224792281915}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.4581320753982, "num_env_steps_trained_throughput_per_sec": 544.4581320753982, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 7423.57, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7423.536, "sample_time_ms": 734.141, "learn_time_ms": 6677.38, "learn_throughput": 599.037, "synch_weights_time_ms": 11.516}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 80, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-39-54", "timestamp": 1723235994, "time_this_iter_s": 7.35155725479126, "time_total_s": 618.8526985645294, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d0ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 618.8526985645294, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.89090909090909, "ram_util_percent": 79.9090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7490205997670139, "cur_kl_coeff": 10.39142728149891, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.376613442355362, "policy_loss": 0.0070393068798467835, "vf_loss": 10.0, "vf_explained_var": 4.0070720450588007e-07, "kl": 0.03556529655658379, "entropy": 0.5652382850331604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9054453208111226, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993582637111347, "policy_loss": -0.007694591917970684, "vf_loss": 9.996181081732114, "vf_explained_var": -0.000148904820283254, "kl": 0.008947978321521078, "entropy": 1.4603341213117043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "env_runners": {"episode_reward_max": 25505.613902624154, "episode_reward_min": 1800.0288846622334, "episode_reward_mean": 20411.865654281777, "episode_len_mean": 192.81, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19281, "policy_reward_min": {"agent_policy": 67.97221499212806, "adversary_policy": 810.0793910010661}, "policy_reward_max": {"agent_policy": 10430.345819723438, "adversary_policy": 12225.149804256043}, "policy_reward_mean": {"agent_policy": 5972.644280491926, "adversary_policy": 7219.610686894926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23450.850390378015, 19842.446047935435, 17589.744142470063, 20032.12380959643, 18153.163359769565, 22640.781278991915, 22436.958635125895, 17762.45181824314, 18411.111261223352, 18193.635432916406, 21697.497468269823, 18269.538280633435, 22528.36928401537, 23162.93812957329, 17999.345570271696, 18291.14037125607, 23420.583971280616, 17739.72309929759, 23237.864412798874, 1800.0288846622334, 17616.313619342003, 22862.9423003252, 21606.321387524622, 18034.602975400234, 17825.80795389234, 23709.25387924434, 20976.80816128706, 20075.3315812818, 19013.9674502121, 23728.18935412351, 22503.6718146487, 20945.380943918553, 22506.8738053301, 18460.34183601847, 19884.650835459004, 17269.366386281505, 18918.94369255869, 14209.70617983945, 21838.28563065313, 22885.857105035422, 17911.240811195148, 20580.10764696271, 19159.265111453577, 23372.20644312558, 21770.327035686452, 23175.905342003276, 21957.586185926506, 23480.875151434033, 22240.53941532582, 24543.400606777504, 18543.164830624148, 18220.666381170337, 23498.787715096238, 22798.433620051597, 20924.273651098225, 19782.669745590803, 18753.290848210097, 4887.299916150073, 16328.118699185019, 18595.74042071477, 20250.195112992093, 21414.216682673272, 19398.895139855376, 21127.126474928707, 25189.573359270915, 20894.646552451206, 20220.447907899932, 19076.647112699633, 23354.728309195572, 19452.981384455936, 24351.659989624728, 17743.96449776786, 19142.79508468071, 23781.073151114546, 23601.77878949278, 18797.76835184642, 22683.39892947488, 24097.17248812946, 20519.64520930275, 23878.505204482415, 19328.953748439344, 17999.320785173764, 19394.20311299726, 22381.242693014512, 20414.689302953346, 21151.59739636265, 24162.310312198777, 18401.409121119203, 23034.17549443365, 21604.41802056595, 25505.613902624154, 24015.934935656773, 24934.070907044563, 18398.1558873774, 6437.872930537314, 24869.477833204626, 21223.28637652915, 21828.05872292445, 20120.638354030507, 24947.103739783808], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 149, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 116, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4179.5108753167015, 7364.56792671104, 10430.345819723438, 7881.133087056489, 8654.869877670688, 3634.0774226901945, 5270.927725278047, 9371.526399793149, 9279.65178694984, 9034.942438777285, 3363.14217139593, 9222.079476912682, 4789.40988325169, 3166.696759570414, 1992.28409873074, 9468.264364463661, 4342.190357022765, 9313.244154656286, 4423.696395684118, 67.97221499212806, 9450.141546510049, 5184.466444548112, 6246.814466308443, 9367.387568924278, 10115.616424809234, 4125.918143893784, 5362.756087893887, 8010.886300744911, 8832.649892301222, 4234.374369363631, 4251.775338419428, 6605.873697352969, 5240.740115207921, 9139.86182713012, 2070.0970546496224, 10306.427713450707, 9162.436781604867, 654.1116614143074, 5343.42833536573, 2226.254133576889, 9670.395970908841, 5962.5203701452765, 7258.446778001374, 4614.409576974407, 5812.655104171896, 4491.315586925495, 5129.073216625536, 4098.7638158227255, 4073.562246446847, 3268.2956117907347, 9416.41987344183, 8381.442363105178, 4360.965376452288, 4691.7022271323485, 6058.30763779932, 8116.72104800023, 8719.488099092156, 587.3719336745252, 2236.8424999261715, 9063.899221818518, 7198.072983416254, 6071.948583762489, 7738.16999129091, 6384.300960622539, 1605.690729183604, 6034.461006528762, 7684.071998695923, 8742.8128423926, 3753.14138591853, 8302.359652934332, 2864.4195507662075, 9901.712766849445, 8617.649978627844, 3395.2661808636008, 4201.938918565001, 9095.533197893801, 3165.6451448233997, 3672.6751921353166, 6587.456856558381, 3492.029379746774, 7402.798082486111, 9697.202713818884, 8821.2970924547, 4962.770388490406, 7771.210297634991, 6895.793531756342, 2064.1662592455714, 9517.826097381314, 4991.358717484054, 5912.930681770173, 2420.9847486054373, 3301.813485022366, 3100.1222830091388, 9008.983602194085, 1141.9912725528116, 2927.8370866229684, 6493.5315417877655, 4651.136427090983, 7704.7510262700225, 2771.4157135657706], "policy_adversary_policy_reward": [9900.390935700949, 9370.948579360347, 6526.252731771655, 5951.625389452726, 3636.4098635413607, 3522.9884592052335, 6239.075920795901, 5911.914801744003, 4022.307014026858, 5475.986468072086, 9805.558503002227, 9201.145353299517, 8391.613367219472, 8774.417542628351, 4481.492233168251, 3909.4331852818195, 4569.2248002668175, 4562.234674006645, 5035.504862983157, 4123.188131155937, 7555.369314809561, 10778.985982064372, 4865.195558739947, 4182.263244980847, 8866.162391338848, 8872.797009424841, 10975.438864160544, 9020.802505842312, 7473.2359982869975, 8533.825473253984, 4277.727107377628, 4545.1488994147785, 9606.460916610658, 9471.932697647146, 4778.656116007467, 3647.8228286338294, 9655.142223108696, 9159.025794006051, 810.0793910010661, 921.9772786690386, 4691.994077220889, 3474.177995611041, 8807.679176478556, 8870.796679298614, 7820.642119654745, 7538.864801561401, 4772.130771443954, 3895.084635031955, 3852.1510449765146, 3858.040484106564, 9677.993718063446, 9905.34201728719, 8779.379535837063, 6834.672537556126, 6112.111278208797, 5952.334002328105, 4921.9314861719595, 5259.386071738986, 9762.375248899794, 9731.439735860113, 8516.184560139678, 9735.71191608959, 6981.777107699359, 7357.730138866189, 8664.53167371339, 8601.60201640876, 4318.643521576762, 5001.836487311621, 9096.638211272057, 8717.915569537328, 3336.5179740560566, 3626.420698774678, 4880.796399422753, 4875.710511531058, 6007.267518075531, 7548.327000349642, 8795.352997688738, 7699.50429759862, 11915.881490154083, 8743.72148130447, 3769.6509274646946, 4471.193912821631, 7614.667963992528, 7002.919312824874, 5017.129487722694, 6883.688845729584, 9370.379115470017, 9387.417750681145, 7628.729689388596, 8328.942242125971, 9390.796218924426, 9293.793536153325, 7821.081378877824, 9007.431590423166, 9375.015391194607, 10007.095944416704, 10067.132368720433, 8099.844800158452, 10719.215071394688, 10555.889923592093, 4642.535918198087, 4484.20903898422, 5760.69326062577, 4078.5307574394383, 9532.140264655804, 9605.682073988077, 8982.043693714146, 9124.68769920509, 7334.462750182696, 7531.503263116228, 5650.352420659977, 6015.5962769306325, 4754.55917462401, 5279.243574493908, 1776.0300789292617, 2523.8979035462835, 6827.3552227147575, 7263.9209765440755, 5036.293938537443, 4495.547260358788, 6751.276507220826, 6300.845622355102, 7529.4859860285915, 7812.782112882195, 6382.383413621385, 5278.341734943144, 7468.188869965022, 7274.636644341125, 11358.732825831328, 12225.149804256043, 6878.453287154237, 7981.732258768211, 6132.833655482308, 6403.542253721721, 5199.098016173539, 5134.736254133513, 9634.576903340992, 9967.01001993603, 5814.137379389156, 5336.484352132461, 10724.081165580212, 10763.159273278434, 3868.035276432061, 3974.2164544862976, 5000.792850164602, 5524.352255888277, 10734.011590144366, 9651.79538010663, 9742.135106206006, 9657.704764721779, 4972.884338399607, 4729.350815553037, 10962.169758991005, 8555.5840256605, 10333.666467869038, 10090.830828125096, 6377.509585571752, 7554.678767172576, 9736.369580751454, 10650.10624398421, 6739.337541244844, 5186.8181247084, 4053.491452241393, 4248.626619113412, 5272.069453727445, 5300.836566815121, 8368.834885086626, 9049.637419437478, 6278.933127873765, 6364.545877444553, 7160.993571651386, 7094.810292954956, 11884.325337841661, 10213.818715111507, 4394.341359136948, 4489.241664600969, 8958.89867422568, 9083.918102723974, 8152.828629950578, 7538.658708845271, 11485.017138490231, 11599.612015528415, 10126.496594052236, 10587.62485658211, 10820.367945579444, 11013.580678455985, 5132.645162663119, 4256.527122520205, 3029.9387364478193, 2265.9429215366877, 11117.26190658371, 10824.378839997935, 7641.875997155028, 7087.878837586408, 9490.99919663998, 7685.923099193477, 6385.795158112716, 6030.092169647812, 11077.803223438099, 11097.884802780025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4020225529888249, "mean_inference_ms": 0.998978551291636, "mean_action_processing_ms": 0.16905483719606715, "mean_env_wait_ms": 0.05460657320868135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00325775146484375, "StateBufferConnector_ms": 0.0025445222854614258, "ViewRequirementAgentConnector_ms": 0.06594514846801758}, "num_episodes": 20, "episode_return_max": 25505.613902624154, "episode_return_min": 1800.0288846622334, "episode_return_mean": 20411.865654281777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.0783371496759, "num_env_steps_trained_throughput_per_sec": 541.0783371496759, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 7434.708, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7434.674, "sample_time_ms": 743.243, "learn_time_ms": 6679.528, "learn_throughput": 598.845, "synch_weights_time_ms": 11.474}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "training_iteration": 81, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-01", "timestamp": 1723236001, "time_this_iter_s": 7.398546934127808, "time_total_s": 626.2512454986572, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 626.2512454986572, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.190000000000005, "ram_util_percent": 79.33}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1370843882283204, "cur_kl_coeff": 15.58714092224836, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.803736183126137, "policy_loss": 0.016977444415783912, "vf_loss": 10.0, "vf_explained_var": 6.621413760715061e-06, "kl": 0.05047485879252828, "entropy": 0.5967788010993332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8425269334887465, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997653996944427, "policy_loss": -0.0067462234117556365, "vf_loss": 10.0, "vf_explained_var": -0.00018758848309516907, "kl": 0.007726066481457868, "entropy": 1.4554251547902823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 25505.613902624154, "episode_reward_min": 4887.299916150073, "episode_reward_mean": 20984.590229724523, "episode_len_mean": 195.18, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19518, "policy_reward_min": {"agent_policy": 587.3719336745252, "adversary_policy": 1776.0300789292617}, "policy_reward_max": {"agent_policy": 10306.427713450707, "adversary_policy": 12225.149804256043}, "policy_reward_mean": {"agent_policy": 5822.501767595084, "adversary_policy": 7581.044231064725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17616.313619342003, 22862.9423003252, 21606.321387524622, 18034.602975400234, 17825.80795389234, 23709.25387924434, 20976.80816128706, 20075.3315812818, 19013.9674502121, 23728.18935412351, 22503.6718146487, 20945.380943918553, 22506.8738053301, 18460.34183601847, 19884.650835459004, 17269.366386281505, 18918.94369255869, 14209.70617983945, 21838.28563065313, 22885.857105035422, 17911.240811195148, 20580.10764696271, 19159.265111453577, 23372.20644312558, 21770.327035686452, 23175.905342003276, 21957.586185926506, 23480.875151434033, 22240.53941532582, 24543.400606777504, 18543.164830624148, 18220.666381170337, 23498.787715096238, 22798.433620051597, 20924.273651098225, 19782.669745590803, 18753.290848210097, 4887.299916150073, 16328.118699185019, 18595.74042071477, 20250.195112992093, 21414.216682673272, 19398.895139855376, 21127.126474928707, 25189.573359270915, 20894.646552451206, 20220.447907899932, 19076.647112699633, 23354.728309195572, 19452.981384455936, 24351.659989624728, 17743.96449776786, 19142.79508468071, 23781.073151114546, 23601.77878949278, 18797.76835184642, 22683.39892947488, 24097.17248812946, 20519.64520930275, 23878.505204482415, 19328.953748439344, 17999.320785173764, 19394.20311299726, 22381.242693014512, 20414.689302953346, 21151.59739636265, 24162.310312198777, 18401.409121119203, 23034.17549443365, 21604.41802056595, 25505.613902624154, 24015.934935656773, 24934.070907044563, 18398.1558873774, 6437.872930537314, 24869.477833204626, 21223.28637652915, 21828.05872292445, 20120.638354030507, 24947.103739783808, 24968.76335303245, 23858.591596245133, 22760.07370064196, 21676.168775035327, 19569.573411505487, 22352.93649966867, 22843.085208290104, 24847.545284076034, 22933.20382919277, 22534.277525494894, 21029.418379609793, 23275.030932094127, 19695.805736413848, 22014.73755599075, 24568.231076378273, 22377.264221979196, 22702.287931425235, 18879.73637155281, 22541.690215305724, 18504.331589051715], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 163, 200, 200, 116, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9450.141546510049, 5184.466444548112, 6246.814466308443, 9367.387568924278, 10115.616424809234, 4125.918143893784, 5362.756087893887, 8010.886300744911, 8832.649892301222, 4234.374369363631, 4251.775338419428, 6605.873697352969, 5240.740115207921, 9139.86182713012, 2070.0970546496224, 10306.427713450707, 9162.436781604867, 654.1116614143074, 5343.42833536573, 2226.254133576889, 9670.395970908841, 5962.5203701452765, 7258.446778001374, 4614.409576974407, 5812.655104171896, 4491.315586925495, 5129.073216625536, 4098.7638158227255, 4073.562246446847, 3268.2956117907347, 9416.41987344183, 8381.442363105178, 4360.965376452288, 4691.7022271323485, 6058.30763779932, 8116.72104800023, 8719.488099092156, 587.3719336745252, 2236.8424999261715, 9063.899221818518, 7198.072983416254, 6071.948583762489, 7738.16999129091, 6384.300960622539, 1605.690729183604, 6034.461006528762, 7684.071998695923, 8742.8128423926, 3753.14138591853, 8302.359652934332, 2864.4195507662075, 9901.712766849445, 8617.649978627844, 3395.2661808636008, 4201.938918565001, 9095.533197893801, 3165.6451448233997, 3672.6751921353166, 6587.456856558381, 3492.029379746774, 7402.798082486111, 9697.202713818884, 8821.2970924547, 4962.770388490406, 7771.210297634991, 6895.793531756342, 2064.1662592455714, 9517.826097381314, 4991.358717484054, 5912.930681770173, 2420.9847486054373, 3301.813485022366, 3100.1222830091388, 9008.983602194085, 1141.9912725528116, 2927.8370866229684, 6493.5315417877655, 4651.136427090983, 7704.7510262700225, 2771.4157135657706, 3164.730423326622, 3716.218416262496, 5019.41459610206, 6236.9984098052855, 8425.030969235655, 5317.733154408507, 4357.272320035369, 3156.6038537558834, 4954.226474895888, 2504.6850535001613, 6922.379406240191, 4443.070259297784, 8196.46177300207, 5470.440953982811, 3586.896358417753, 5702.105101368156, 5391.2930865069775, 9284.05011577824, 5010.987385595113, 9375.683835446078], "policy_adversary_policy_reward": [4691.994077220889, 3474.177995611041, 8807.679176478556, 8870.796679298614, 7820.642119654745, 7538.864801561401, 4772.130771443954, 3895.084635031955, 3852.1510449765146, 3858.040484106564, 9677.993718063446, 9905.34201728719, 8779.379535837063, 6834.672537556126, 6112.111278208797, 5952.334002328105, 4921.9314861719595, 5259.386071738986, 9762.375248899794, 9731.439735860113, 8516.184560139678, 9735.71191608959, 6981.777107699359, 7357.730138866189, 8664.53167371339, 8601.60201640876, 4318.643521576762, 5001.836487311621, 9096.638211272057, 8717.915569537328, 3336.5179740560566, 3626.420698774678, 4880.796399422753, 4875.710511531058, 6007.267518075531, 7548.327000349642, 8795.352997688738, 7699.50429759862, 11915.881490154083, 8743.72148130447, 3769.6509274646946, 4471.193912821631, 7614.667963992528, 7002.919312824874, 5017.129487722694, 6883.688845729584, 9370.379115470017, 9387.417750681145, 7628.729689388596, 8328.942242125971, 9390.796218924426, 9293.793536153325, 7821.081378877824, 9007.431590423166, 9375.015391194607, 10007.095944416704, 10067.132368720433, 8099.844800158452, 10719.215071394688, 10555.889923592093, 4642.535918198087, 4484.20903898422, 5760.69326062577, 4078.5307574394383, 9532.140264655804, 9605.682073988077, 8982.043693714146, 9124.68769920509, 7334.462750182696, 7531.503263116228, 5650.352420659977, 6015.5962769306325, 4754.55917462401, 5279.243574493908, 1776.0300789292617, 2523.8979035462835, 6827.3552227147575, 7263.9209765440755, 5036.293938537443, 4495.547260358788, 6751.276507220826, 6300.845622355102, 7529.4859860285915, 7812.782112882195, 6382.383413621385, 5278.341734943144, 7468.188869965022, 7274.636644341125, 11358.732825831328, 12225.149804256043, 6878.453287154237, 7981.732258768211, 6132.833655482308, 6403.542253721721, 5199.098016173539, 5134.736254133513, 9634.576903340992, 9967.01001993603, 5814.137379389156, 5336.484352132461, 10724.081165580212, 10763.159273278434, 3868.035276432061, 3974.2164544862976, 5000.792850164602, 5524.352255888277, 10734.011590144366, 9651.79538010663, 9742.135106206006, 9657.704764721779, 4972.884338399607, 4729.350815553037, 10962.169758991005, 8555.5840256605, 10333.666467869038, 10090.830828125096, 6377.509585571752, 7554.678767172576, 9736.369580751454, 10650.10624398421, 6739.337541244844, 5186.8181247084, 4053.491452241393, 4248.626619113412, 5272.069453727445, 5300.836566815121, 8368.834885086626, 9049.637419437478, 6278.933127873765, 6364.545877444553, 7160.993571651386, 7094.810292954956, 11884.325337841661, 10213.818715111507, 4394.341359136948, 4489.241664600969, 8958.89867422568, 9083.918102723974, 8152.828629950578, 7538.658708845271, 11485.017138490231, 11599.612015528415, 10126.496594052236, 10587.62485658211, 10820.367945579444, 11013.580678455985, 5132.645162663119, 4256.527122520205, 3029.9387364478193, 2265.9429215366877, 11117.26190658371, 10824.378839997935, 7641.875997155028, 7087.878837586408, 9490.99919663998, 7685.923099193477, 6385.795158112716, 6030.092169647812, 11077.803223438099, 11097.884802780025, 10900.459009217599, 10903.573920488237, 9716.455972514132, 10425.917207468445, 8689.089277998162, 9051.569826541725, 7538.717785137729, 7900.452580092278, 5428.775498174098, 5715.766944095711, 8525.144804549776, 8510.058540710406, 9784.8633036956, 8700.949584559263, 10753.229059334866, 10937.712370985311, 9047.604790111369, 8931.372564185598, 8392.141901763927, 11637.450570230802, 7166.736013101865, 6940.30296026775, 9506.403299021662, 9325.557373774716, 5941.864318008124, 5557.479645403617, 7872.60193225983, 8671.694669748136, 10477.633240892534, 10503.701477068002, 8330.491781797899, 8344.667338813124, 8673.185391287874, 8637.809453630409, 4744.738511708859, 4850.947744065762, 9122.36359212459, 8408.33923758605, 4584.977957314208, 4543.669796291375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40187530357362833, "mean_inference_ms": 0.9996377623082836, "mean_action_processing_ms": 0.16897337549589175, "mean_env_wait_ms": 0.05457624871776309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003361344337463379, "StateBufferConnector_ms": 0.00258028507232666, "ViewRequirementAgentConnector_ms": 0.06669723987579346}, "num_episodes": 20, "episode_return_max": 25505.613902624154, "episode_return_min": 4887.299916150073, "episode_return_mean": 20984.590229724523}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 520.785344245483, "num_env_steps_trained_throughput_per_sec": 520.785344245483, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 7465.579, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7465.544, "sample_time_ms": 777.687, "learn_time_ms": 6676.251, "learn_throughput": 599.139, "synch_weights_time_ms": 11.179}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 82, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-09", "timestamp": 1723236009, "time_this_iter_s": 7.684680938720703, "time_total_s": 633.9359264373779, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 633.9359264373779, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 27.650000000000002, "ram_util_percent": 78.26666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.508453659153489, "cur_kl_coeff": 23.380711383372553, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.9568829390107, "policy_loss": 0.009553467184576211, "vf_loss": 10.0, "vf_explained_var": 2.5160855086392196e-05, "kl": 0.04051756562083644, "entropy": 0.6269716926668056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.873859315784648, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003832849860192, "policy_loss": -0.0037463334723724984, "vf_loss": 10.0, "vf_explained_var": -0.00010601958880821864, "kl": 0.013307784515200182, "entropy": 1.4403915837407113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "env_runners": {"episode_reward_max": 25505.613902624154, "episode_reward_min": 4887.299916150073, "episode_reward_mean": 21224.28660482622, "episode_len_mean": 196.39, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19639, "policy_reward_min": {"agent_policy": 587.3719336745252, "adversary_policy": 1776.0300789292617}, "policy_reward_max": {"agent_policy": 9901.712766849445, "adversary_policy": 12225.149804256043}, "policy_reward_mean": {"agent_policy": 5766.191289168251, "adversary_policy": 7729.047657828987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22885.857105035422, 17911.240811195148, 20580.10764696271, 19159.265111453577, 23372.20644312558, 21770.327035686452, 23175.905342003276, 21957.586185926506, 23480.875151434033, 22240.53941532582, 24543.400606777504, 18543.164830624148, 18220.666381170337, 23498.787715096238, 22798.433620051597, 20924.273651098225, 19782.669745590803, 18753.290848210097, 4887.299916150073, 16328.118699185019, 18595.74042071477, 20250.195112992093, 21414.216682673272, 19398.895139855376, 21127.126474928707, 25189.573359270915, 20894.646552451206, 20220.447907899932, 19076.647112699633, 23354.728309195572, 19452.981384455936, 24351.659989624728, 17743.96449776786, 19142.79508468071, 23781.073151114546, 23601.77878949278, 18797.76835184642, 22683.39892947488, 24097.17248812946, 20519.64520930275, 23878.505204482415, 19328.953748439344, 17999.320785173764, 19394.20311299726, 22381.242693014512, 20414.689302953346, 21151.59739636265, 24162.310312198777, 18401.409121119203, 23034.17549443365, 21604.41802056595, 25505.613902624154, 24015.934935656773, 24934.070907044563, 18398.1558873774, 6437.872930537314, 24869.477833204626, 21223.28637652915, 21828.05872292445, 20120.638354030507, 24947.103739783808, 24968.76335303245, 23858.591596245133, 22760.07370064196, 21676.168775035327, 19569.573411505487, 22352.93649966867, 22843.085208290104, 24847.545284076034, 22933.20382919277, 22534.277525494894, 21029.418379609793, 23275.030932094127, 19695.805736413848, 22014.73755599075, 24568.231076378273, 22377.264221979196, 22702.287931425235, 18879.73637155281, 22541.690215305724, 18504.331589051715, 21387.325370179195, 23031.55088608844, 18079.690154345008, 21317.19415027856, 18976.189510977354, 21045.040146251216, 24459.279788091266, 22016.019475215628, 22703.487786959293, 19254.50472387856, 18559.56578398918, 18287.48890522122, 21855.329415211887, 21952.544996062174, 22421.52790331324, 24453.2300182823, 20175.333995835863, 21708.506987209432, 24272.587300120056], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 44, 136, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2226.254133576889, 9670.395970908841, 5962.5203701452765, 7258.446778001374, 4614.409576974407, 5812.655104171896, 4491.315586925495, 5129.073216625536, 4098.7638158227255, 4073.562246446847, 3268.2956117907347, 9416.41987344183, 8381.442363105178, 4360.965376452288, 4691.7022271323485, 6058.30763779932, 8116.72104800023, 8719.488099092156, 587.3719336745252, 2236.8424999261715, 9063.899221818518, 7198.072983416254, 6071.948583762489, 7738.16999129091, 6384.300960622539, 1605.690729183604, 6034.461006528762, 7684.071998695923, 8742.8128423926, 3753.14138591853, 8302.359652934332, 2864.4195507662075, 9901.712766849445, 8617.649978627844, 3395.2661808636008, 4201.938918565001, 9095.533197893801, 3165.6451448233997, 3672.6751921353166, 6587.456856558381, 3492.029379746774, 7402.798082486111, 9697.202713818884, 8821.2970924547, 4962.770388490406, 7771.210297634991, 6895.793531756342, 2064.1662592455714, 9517.826097381314, 4991.358717484054, 5912.930681770173, 2420.9847486054373, 3301.813485022366, 3100.1222830091388, 9008.983602194085, 1141.9912725528116, 2927.8370866229684, 6493.5315417877655, 4651.136427090983, 7704.7510262700225, 2771.4157135657706, 3164.730423326622, 3716.218416262496, 5019.41459610206, 6236.9984098052855, 8425.030969235655, 5317.733154408507, 4357.272320035369, 3156.6038537558834, 4954.226474895888, 2504.6850535001613, 6922.379406240191, 4443.070259297784, 8196.46177300207, 5470.440953982811, 3586.896358417753, 5702.105101368156, 5391.2930865069775, 9284.05011577824, 5010.987385595113, 9375.683835446078, 5876.804879690648, 4741.148155847981, 9247.503750237229, 6881.549356283908, 8944.267029827948, 6761.388657328882, 3330.041113873026, 6073.177544740099, 4971.348336132205, 8811.32172803968, 9070.737913028754, 9776.962871864851, 5514.0712927170325, 6108.982443105068, 3758.598193724944, 3115.499327733984, 6236.666832192597, 5440.2193426926115, 3414.4271581484263], "policy_adversary_policy_reward": [11915.881490154083, 8743.72148130447, 3769.6509274646946, 4471.193912821631, 7614.667963992528, 7002.919312824874, 5017.129487722694, 6883.688845729584, 9370.379115470017, 9387.417750681145, 7628.729689388596, 8328.942242125971, 9390.796218924426, 9293.793536153325, 7821.081378877824, 9007.431590423166, 9375.015391194607, 10007.095944416704, 10067.132368720433, 8099.844800158452, 10719.215071394688, 10555.889923592093, 4642.535918198087, 4484.20903898422, 5760.69326062577, 4078.5307574394383, 9532.140264655804, 9605.682073988077, 8982.043693714146, 9124.68769920509, 7334.462750182696, 7531.503263116228, 5650.352420659977, 6015.5962769306325, 4754.55917462401, 5279.243574493908, 1776.0300789292617, 2523.8979035462835, 6827.3552227147575, 7263.9209765440755, 5036.293938537443, 4495.547260358788, 6751.276507220826, 6300.845622355102, 7529.4859860285915, 7812.782112882195, 6382.383413621385, 5278.341734943144, 7468.188869965022, 7274.636644341125, 11358.732825831328, 12225.149804256043, 6878.453287154237, 7981.732258768211, 6132.833655482308, 6403.542253721721, 5199.098016173539, 5134.736254133513, 9634.576903340992, 9967.01001993603, 5814.137379389156, 5336.484352132461, 10724.081165580212, 10763.159273278434, 3868.035276432061, 3974.2164544862976, 5000.792850164602, 5524.352255888277, 10734.011590144366, 9651.79538010663, 9742.135106206006, 9657.704764721779, 4972.884338399607, 4729.350815553037, 10962.169758991005, 8555.5840256605, 10333.666467869038, 10090.830828125096, 6377.509585571752, 7554.678767172576, 9736.369580751454, 10650.10624398421, 6739.337541244844, 5186.8181247084, 4053.491452241393, 4248.626619113412, 5272.069453727445, 5300.836566815121, 8368.834885086626, 9049.637419437478, 6278.933127873765, 6364.545877444553, 7160.993571651386, 7094.810292954956, 11884.325337841661, 10213.818715111507, 4394.341359136948, 4489.241664600969, 8958.89867422568, 9083.918102723974, 8152.828629950578, 7538.658708845271, 11485.017138490231, 11599.612015528415, 10126.496594052236, 10587.62485658211, 10820.367945579444, 11013.580678455985, 5132.645162663119, 4256.527122520205, 3029.9387364478193, 2265.9429215366877, 11117.26190658371, 10824.378839997935, 7641.875997155028, 7087.878837586408, 9490.99919663998, 7685.923099193477, 6385.795158112716, 6030.092169647812, 11077.803223438099, 11097.884802780025, 10900.459009217599, 10903.573920488237, 9716.455972514132, 10425.917207468445, 8689.089277998162, 9051.569826541725, 7538.717785137729, 7900.452580092278, 5428.775498174098, 5715.766944095711, 8525.144804549776, 8510.058540710406, 9784.8633036956, 8700.949584559263, 10753.229059334866, 10937.712370985311, 9047.604790111369, 8931.372564185598, 8392.141901763927, 11637.450570230802, 7166.736013101865, 6940.30296026775, 9506.403299021662, 9325.557373774716, 5941.864318008124, 5557.479645403617, 7872.60193225983, 8671.694669748136, 10477.633240892534, 10503.701477068002, 8330.491781797899, 8344.667338813124, 8673.185391287874, 8637.809453630409, 4744.738511708859, 4850.947744065762, 9122.36359212459, 8408.33923758605, 4584.977957314208, 4543.669796291375, 7650.6913327846605, 7859.829157703903, 9294.576394024556, 8995.826336215863, 4558.15925723753, 4274.027146870238, 7245.2242116196085, 7190.420582375031, 4834.053887246399, 5197.868593902986, 7363.7174778906165, 6919.934011031756, 10667.804681126669, 10461.43399309158, 7981.112182646779, 7961.729747828719, 8564.85686200998, 9167.282588817108, 5114.594494381983, 5328.588501456841, 4938.096259640247, 4550.731611320155, 4252.361240065883, 4258.164793290515, 8628.06433101393, 7713.193791480949, 8003.121113407992, 7840.441439549101, 10383.537430006007, 8279.392279582282, 10985.958889467403, 10351.771801080946, 6048.783275984264, 7889.883887659052, 8489.106454192814, 7779.181190323992, 10221.304201709507, 10636.855940262145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40202184413262393, "mean_inference_ms": 1.0007587312762574, "mean_action_processing_ms": 0.16895397303323492, "mean_env_wait_ms": 0.054593701919634564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003366708755493164, "StateBufferConnector_ms": 0.0025633573532104492, "ViewRequirementAgentConnector_ms": 0.06549060344696045}, "num_episodes": 19, "episode_return_max": 25505.613902624154, "episode_return_min": 4887.299916150073, "episode_return_mean": 21224.28660482622}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.16849217311045, "num_env_steps_trained_throughput_per_sec": 494.16849217311045, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 7544.743, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7544.708, "sample_time_ms": 791.797, "learn_time_ms": 6741.412, "learn_throughput": 593.348, "synch_weights_time_ms": 11.073}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "training_iteration": 83, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-17", "timestamp": 1723236017, "time_this_iter_s": 8.099598169326782, "time_total_s": 642.0355246067047, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38d0f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 642.0355246067047, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 31.37272727272727, "ram_util_percent": 78.8090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.79345276869794, "cur_kl_coeff": 35.0710670750588, "cur_lr": 5.0000000000000016e-05, "total_loss": 11.790294503913355, "policy_loss": 0.013804313868885396, "vf_loss": 10.0, "vf_explained_var": 0.00011116966368660095, "kl": 0.050654008880099924, "entropy": 0.6400047469864447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8536718613778551, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994778902331989, "policy_loss": -0.003813761973772974, "vf_loss": 9.991477985183398, "vf_explained_var": -0.0008950008700291316, "kl": 0.01249213317447963, "entropy": 1.4179675000409284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 25505.613902624154, "episode_reward_min": 98.44348295214617, "episode_reward_mean": 20995.78296620619, "episode_len_mean": 194.82, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19482, "policy_reward_min": {"agent_policy": 0.8589080191558982, "adversary_policy": 27.73280483349142}, "policy_reward_max": {"agent_policy": 9901.712766849445, "adversary_policy": 12225.149804256043}, "policy_reward_mean": {"agent_policy": 5852.11930512765, "adversary_policy": 7571.831830539274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21414.216682673272, 19398.895139855376, 21127.126474928707, 25189.573359270915, 20894.646552451206, 20220.447907899932, 19076.647112699633, 23354.728309195572, 19452.981384455936, 24351.659989624728, 17743.96449776786, 19142.79508468071, 23781.073151114546, 23601.77878949278, 18797.76835184642, 22683.39892947488, 24097.17248812946, 20519.64520930275, 23878.505204482415, 19328.953748439344, 17999.320785173764, 19394.20311299726, 22381.242693014512, 20414.689302953346, 21151.59739636265, 24162.310312198777, 18401.409121119203, 23034.17549443365, 21604.41802056595, 25505.613902624154, 24015.934935656773, 24934.070907044563, 18398.1558873774, 6437.872930537314, 24869.477833204626, 21223.28637652915, 21828.05872292445, 20120.638354030507, 24947.103739783808, 24968.76335303245, 23858.591596245133, 22760.07370064196, 21676.168775035327, 19569.573411505487, 22352.93649966867, 22843.085208290104, 24847.545284076034, 22933.20382919277, 22534.277525494894, 21029.418379609793, 23275.030932094127, 19695.805736413848, 22014.73755599075, 24568.231076378273, 22377.264221979196, 22702.287931425235, 18879.73637155281, 22541.690215305724, 18504.331589051715, 21387.325370179195, 23031.55088608844, 18079.690154345008, 21317.19415027856, 18976.189510977354, 21045.040146251216, 24459.279788091266, 22016.019475215628, 22703.487786959293, 19254.50472387856, 18559.56578398918, 18287.48890522122, 21855.329415211887, 21952.544996062174, 22421.52790331324, 24453.2300182823, 20175.333995835863, 21708.506987209432, 24272.587300120056, 22113.905456620152, 98.44348295214617, 2696.4362129499677, 20133.206980301322, 19672.096125631066, 19135.916363558208, 18109.318062616574, 23542.583784829185, 22593.606351977145, 24475.116934255464, 22052.49021330008, 22338.822234795563, 21846.95068475617, 18015.54652686601, 22292.993130496747, 18775.163470410702, 23301.200215136192, 23278.511201474852, 21570.348434898668, 18883.81697052503, 18042.92091950142, 17840.19417595386], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6071.948583762489, 7738.16999129091, 6384.300960622539, 1605.690729183604, 6034.461006528762, 7684.071998695923, 8742.8128423926, 3753.14138591853, 8302.359652934332, 2864.4195507662075, 9901.712766849445, 8617.649978627844, 3395.2661808636008, 4201.938918565001, 9095.533197893801, 3165.6451448233997, 3672.6751921353166, 6587.456856558381, 3492.029379746774, 7402.798082486111, 9697.202713818884, 8821.2970924547, 4962.770388490406, 7771.210297634991, 6895.793531756342, 2064.1662592455714, 9517.826097381314, 4991.358717484054, 5912.930681770173, 2420.9847486054373, 3301.813485022366, 3100.1222830091388, 9008.983602194085, 1141.9912725528116, 2927.8370866229684, 6493.5315417877655, 4651.136427090983, 7704.7510262700225, 2771.4157135657706, 3164.730423326622, 3716.218416262496, 5019.41459610206, 6236.9984098052855, 8425.030969235655, 5317.733154408507, 4357.272320035369, 3156.6038537558834, 4954.226474895888, 2504.6850535001613, 6922.379406240191, 4443.070259297784, 8196.46177300207, 5470.440953982811, 3586.896358417753, 5702.105101368156, 5391.2930865069775, 9284.05011577824, 5010.987385595113, 9375.683835446078, 5876.804879690648, 4741.148155847981, 9247.503750237229, 6881.549356283908, 8944.267029827948, 6761.388657328882, 3330.041113873026, 6073.177544740099, 4971.348336132205, 8811.32172803968, 9070.737913028754, 9776.962871864851, 5514.0712927170325, 6108.982443105068, 3758.598193724944, 3115.499327733984, 6236.666832192597, 5440.2193426926115, 3414.4271581484263, 5796.969791070161, 0.8589080191558982, 197.72785580486058, 8031.652220407989, 8175.807072815371, 8366.931288205316, 8758.327827004066, 3823.8212304804906, 4853.769396977955, 3503.3555345513273, 5906.958905186416, 5165.907524584549, 6074.745088310407, 9042.760743887555, 5021.090423890352, 9067.805544275378, 4241.0548687511155, 4402.580784082489, 6394.371361960559, 9144.002354221047, 8288.508667639475, 9770.719879062612], "policy_adversary_policy_reward": [7529.4859860285915, 7812.782112882195, 6382.383413621385, 5278.341734943144, 7468.188869965022, 7274.636644341125, 11358.732825831328, 12225.149804256043, 6878.453287154237, 7981.732258768211, 6132.833655482308, 6403.542253721721, 5199.098016173539, 5134.736254133513, 9634.576903340992, 9967.01001993603, 5814.137379389156, 5336.484352132461, 10724.081165580212, 10763.159273278434, 3868.035276432061, 3974.2164544862976, 5000.792850164602, 5524.352255888277, 10734.011590144366, 9651.79538010663, 9742.135106206006, 9657.704764721779, 4972.884338399607, 4729.350815553037, 10962.169758991005, 8555.5840256605, 10333.666467869038, 10090.830828125096, 6377.509585571752, 7554.678767172576, 9736.369580751454, 10650.10624398421, 6739.337541244844, 5186.8181247084, 4053.491452241393, 4248.626619113412, 5272.069453727445, 5300.836566815121, 8368.834885086626, 9049.637419437478, 6278.933127873765, 6364.545877444553, 7160.993571651386, 7094.810292954956, 11884.325337841661, 10213.818715111507, 4394.341359136948, 4489.241664600969, 8958.89867422568, 9083.918102723974, 8152.828629950578, 7538.658708845271, 11485.017138490231, 11599.612015528415, 10126.496594052236, 10587.62485658211, 10820.367945579444, 11013.580678455985, 5132.645162663119, 4256.527122520205, 3029.9387364478193, 2265.9429215366877, 11117.26190658371, 10824.378839997935, 7641.875997155028, 7087.878837586408, 9490.99919663998, 7685.923099193477, 6385.795158112716, 6030.092169647812, 11077.803223438099, 11097.884802780025, 10900.459009217599, 10903.573920488237, 9716.455972514132, 10425.917207468445, 8689.089277998162, 9051.569826541725, 7538.717785137729, 7900.452580092278, 5428.775498174098, 5715.766944095711, 8525.144804549776, 8510.058540710406, 9784.8633036956, 8700.949584559263, 10753.229059334866, 10937.712370985311, 9047.604790111369, 8931.372564185598, 8392.141901763927, 11637.450570230802, 7166.736013101865, 6940.30296026775, 9506.403299021662, 9325.557373774716, 5941.864318008124, 5557.479645403617, 7872.60193225983, 8671.694669748136, 10477.633240892534, 10503.701477068002, 8330.491781797899, 8344.667338813124, 8673.185391287874, 8637.809453630409, 4744.738511708859, 4850.947744065762, 9122.36359212459, 8408.33923758605, 4584.977957314208, 4543.669796291375, 7650.6913327846605, 7859.829157703903, 9294.576394024556, 8995.826336215863, 4558.15925723753, 4274.027146870238, 7245.2242116196085, 7190.420582375031, 4834.053887246399, 5197.868593902986, 7363.7174778906165, 6919.934011031756, 10667.804681126669, 10461.43399309158, 7981.112182646779, 7961.729747828719, 8564.85686200998, 9167.282588817108, 5114.594494381983, 5328.588501456841, 4938.096259640247, 4550.731611320155, 4252.361240065883, 4258.164793290515, 8628.06433101393, 7713.193791480949, 8003.121113407992, 7840.441439549101, 10383.537430006007, 8279.392279582282, 10985.958889467403, 10351.771801080946, 6048.783275984264, 7889.883887659052, 8489.106454192814, 7779.181190323992, 10221.304201709507, 10636.855940262145, 8339.283192455508, 7977.6524730945075, 27.73280483349142, 69.85177009949885, 1208.2945094953907, 1290.4138476497187, 6023.090386846626, 6078.464373046755, 5702.583490591958, 5793.705562223735, 5034.952381638659, 5734.032693714229, 4140.060218798491, 5210.930016813993, 9656.612718185499, 10062.149836163197, 8459.888495519444, 9279.94845947969, 10438.472617435145, 10533.288782268963, 8184.880026524071, 7960.651281589541, 8933.544931446806, 8239.369778764176, 7956.828677519626, 7815.376918926076, 3873.4109031350654, 5099.3748798434035, 8156.909864855472, 9114.992841750918, 5031.259883727584, 4676.09804240776, 9163.27796755649, 9896.867378828621, 9369.753283333337, 9506.177134058993, 7620.06799073909, 7555.909082199067, 4785.151803511026, 4954.662812792975, 5853.6269560914825, 3900.7852957705168, 4362.119541407026, 3707.3547554842316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4020257729346888, "mean_inference_ms": 1.0017911529172117, "mean_action_processing_ms": 0.16901145502346238, "mean_env_wait_ms": 0.05456778937808085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033358335494995117, "StateBufferConnector_ms": 0.0026258230209350586, "ViewRequirementAgentConnector_ms": 0.06595039367675781}, "num_episodes": 22, "episode_return_max": 25505.613902624154, "episode_return_min": 98.44348295214617, "episode_return_mean": 20995.78296620619}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.1076844989685, "num_env_steps_trained_throughput_per_sec": 549.1076844989685, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 7519.08, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7519.045, "sample_time_ms": 786.488, "learn_time_ms": 6721.041, "learn_throughput": 595.146, "synch_weights_time_ms": 11.086}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 84, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-25", "timestamp": 1723236025, "time_this_iter_s": 7.28894305229187, "time_total_s": 649.3244676589966, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38c63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 649.3244676589966, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 24.49090909090909, "ram_util_percent": 79.29090909090911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.13811224453033, "cur_kl_coeff": 52.60660061258821, "cur_lr": 5.0000000000000016e-05, "total_loss": 12.076438196373996, "policy_loss": 0.011678647972204815, "vf_loss": 10.0, "vf_explained_var": 8.932796735612173e-05, "kl": 0.03924905778692355, "entropy": 0.6538868947003884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8374953420832754, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.987139789263408, "policy_loss": -0.0048466230800841, "vf_loss": 9.984377853075664, "vf_explained_var": -0.0005781053255001704, "kl": 0.013359363172397328, "entropy": 1.4159167653570572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": 25505.613902624154, "episode_reward_min": 98.44348295214617, "episode_reward_mean": 20357.917338490428, "episode_len_mean": 189.75, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18975, "policy_reward_min": {"agent_policy": 0.8589080191558982, "adversary_policy": 27.73280483349142}, "policy_reward_max": {"agent_policy": 10001.538856502348, "adversary_policy": 11884.325337841661}, "policy_reward_mean": {"agent_policy": 5820.298343753741, "adversary_policy": 7268.809497368345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21151.59739636265, 24162.310312198777, 18401.409121119203, 23034.17549443365, 21604.41802056595, 25505.613902624154, 24015.934935656773, 24934.070907044563, 18398.1558873774, 6437.872930537314, 24869.477833204626, 21223.28637652915, 21828.05872292445, 20120.638354030507, 24947.103739783808, 24968.76335303245, 23858.591596245133, 22760.07370064196, 21676.168775035327, 19569.573411505487, 22352.93649966867, 22843.085208290104, 24847.545284076034, 22933.20382919277, 22534.277525494894, 21029.418379609793, 23275.030932094127, 19695.805736413848, 22014.73755599075, 24568.231076378273, 22377.264221979196, 22702.287931425235, 18879.73637155281, 22541.690215305724, 18504.331589051715, 21387.325370179195, 23031.55088608844, 18079.690154345008, 21317.19415027856, 18976.189510977354, 21045.040146251216, 24459.279788091266, 22016.019475215628, 22703.487786959293, 19254.50472387856, 18559.56578398918, 18287.48890522122, 21855.329415211887, 21952.544996062174, 22421.52790331324, 24453.2300182823, 20175.333995835863, 21708.506987209432, 24272.587300120056, 22113.905456620152, 98.44348295214617, 2696.4362129499677, 20133.206980301322, 19672.096125631066, 19135.916363558208, 18109.318062616574, 23542.583784829185, 22593.606351977145, 24475.116934255464, 22052.49021330008, 22338.822234795563, 21846.95068475617, 18015.54652686601, 22292.993130496747, 18775.163470410702, 23301.200215136192, 23278.511201474852, 21570.348434898668, 18883.81697052503, 18042.92091950142, 17840.19417595386, 24032.5085194688, 21754.676522897367, 1405.4950235377241, 22143.999732027438, 2494.1141679278167, 20346.06059021442, 22272.63027301903, 19267.465594746263, 21862.543582281265, 18465.20630608635, 17704.148127302615, 18646.665319730233, 17830.59296275442, 20016.665000048146, 6850.369214545168, 18651.639626546134, 21951.732980218, 22866.218473476983, 19869.097880387708, 22568.793408829264, 19427.92964839949, 21611.810191831813, 22177.931836774907, 20240.57650729792], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6895.793531756342, 2064.1662592455714, 9517.826097381314, 4991.358717484054, 5912.930681770173, 2420.9847486054373, 3301.813485022366, 3100.1222830091388, 9008.983602194085, 1141.9912725528116, 2927.8370866229684, 6493.5315417877655, 4651.136427090983, 7704.7510262700225, 2771.4157135657706, 3164.730423326622, 3716.218416262496, 5019.41459610206, 6236.9984098052855, 8425.030969235655, 5317.733154408507, 4357.272320035369, 3156.6038537558834, 4954.226474895888, 2504.6850535001613, 6922.379406240191, 4443.070259297784, 8196.46177300207, 5470.440953982811, 3586.896358417753, 5702.105101368156, 5391.2930865069775, 9284.05011577824, 5010.987385595113, 9375.683835446078, 5876.804879690648, 4741.148155847981, 9247.503750237229, 6881.549356283908, 8944.267029827948, 6761.388657328882, 3330.041113873026, 6073.177544740099, 4971.348336132205, 8811.32172803968, 9070.737913028754, 9776.962871864851, 5514.0712927170325, 6108.982443105068, 3758.598193724944, 3115.499327733984, 6236.666832192597, 5440.2193426926115, 3414.4271581484263, 5796.969791070161, 0.8589080191558982, 197.72785580486058, 8031.652220407989, 8175.807072815371, 8366.931288205316, 8758.327827004066, 3823.8212304804906, 4853.769396977955, 3503.3555345513273, 5906.958905186416, 5165.907524584549, 6074.745088310407, 9042.760743887555, 5021.090423890352, 9067.805544275378, 4241.0548687511155, 4402.580784082489, 6394.371361960559, 9144.002354221047, 8288.508667639475, 9770.719879062612, 3899.225379416199, 5248.453398252591, 57.45214069312997, 5020.527317306644, 252.48026497606259, 7581.8586208916695, 4770.478667982743, 8946.143367995059, 5727.792634932323, 8788.762064716127, 8497.522081169775, 9133.948787361262, 10001.538856502348, 7918.085811546788, 1195.913685542438, 9039.260824258603, 5698.570298502378, 4872.596060698889, 7473.841206892646, 5273.151601839994, 8580.372894654549, 6218.4504046419825, 5302.742313706776, 7285.298071172728], "policy_adversary_policy_reward": [7160.993571651386, 7094.810292954956, 11884.325337841661, 10213.818715111507, 4394.341359136948, 4489.241664600969, 8958.89867422568, 9083.918102723974, 8152.828629950578, 7538.658708845271, 11485.017138490231, 11599.612015528415, 10126.496594052236, 10587.62485658211, 10820.367945579444, 11013.580678455985, 5132.645162663119, 4256.527122520205, 3029.9387364478193, 2265.9429215366877, 11117.26190658371, 10824.378839997935, 7641.875997155028, 7087.878837586408, 9490.99919663998, 7685.923099193477, 6385.795158112716, 6030.092169647812, 11077.803223438099, 11097.884802780025, 10900.459009217599, 10903.573920488237, 9716.455972514132, 10425.917207468445, 8689.089277998162, 9051.569826541725, 7538.717785137729, 7900.452580092278, 5428.775498174098, 5715.766944095711, 8525.144804549776, 8510.058540710406, 9784.8633036956, 8700.949584559263, 10753.229059334866, 10937.712370985311, 9047.604790111369, 8931.372564185598, 8392.141901763927, 11637.450570230802, 7166.736013101865, 6940.30296026775, 9506.403299021662, 9325.557373774716, 5941.864318008124, 5557.479645403617, 7872.60193225983, 8671.694669748136, 10477.633240892534, 10503.701477068002, 8330.491781797899, 8344.667338813124, 8673.185391287874, 8637.809453630409, 4744.738511708859, 4850.947744065762, 9122.36359212459, 8408.33923758605, 4584.977957314208, 4543.669796291375, 7650.6913327846605, 7859.829157703903, 9294.576394024556, 8995.826336215863, 4558.15925723753, 4274.027146870238, 7245.2242116196085, 7190.420582375031, 4834.053887246399, 5197.868593902986, 7363.7174778906165, 6919.934011031756, 10667.804681126669, 10461.43399309158, 7981.112182646779, 7961.729747828719, 8564.85686200998, 9167.282588817108, 5114.594494381983, 5328.588501456841, 4938.096259640247, 4550.731611320155, 4252.361240065883, 4258.164793290515, 8628.06433101393, 7713.193791480949, 8003.121113407992, 7840.441439549101, 10383.537430006007, 8279.392279582282, 10985.958889467403, 10351.771801080946, 6048.783275984264, 7889.883887659052, 8489.106454192814, 7779.181190323992, 10221.304201709507, 10636.855940262145, 8339.283192455508, 7977.6524730945075, 27.73280483349142, 69.85177009949885, 1208.2945094953907, 1290.4138476497187, 6023.090386846626, 6078.464373046755, 5702.583490591958, 5793.705562223735, 5034.952381638659, 5734.032693714229, 4140.060218798491, 5210.930016813993, 9656.612718185499, 10062.149836163197, 8459.888495519444, 9279.94845947969, 10438.472617435145, 10533.288782268963, 8184.880026524071, 7960.651281589541, 8933.544931446806, 8239.369778764176, 7956.828677519626, 7815.376918926076, 3873.4109031350654, 5099.3748798434035, 8156.909864855472, 9114.992841750918, 5031.259883727584, 4676.09804240776, 9163.27796755649, 9896.867378828621, 9369.753283333337, 9506.177134058993, 7620.06799073909, 7555.909082199067, 4785.151803511026, 4954.662812792975, 5853.6269560914825, 3900.7852957705168, 4362.119541407026, 3707.3547554842316, 9919.606877161483, 10213.676262891046, 8887.760243277806, 7618.462881366973, 791.0759967307272, 556.9668861138671, 8001.864108296485, 9121.608306424294, 938.4792493174126, 1303.1546536343417, 6557.090753974023, 6207.111215348745, 8131.3473372357375, 9370.804267800522, 5138.31968329745, 5183.002543453812, 7723.558627929568, 8411.192319419346, 4329.8034600030005, 5346.640781367243, 3593.559589562428, 5613.066456570438, 4999.668509067105, 4513.048023301875, 3727.192746721675, 4101.861359530382, 5874.5293763172185, 6224.049812184164, 2694.3003248275086, 2960.1552041752225, 4786.450250970053, 4825.928551317528, 7812.385878300176, 8440.77680341543, 9121.597290607058, 8872.025122171048, 5747.160367650103, 6648.096305845016, 8656.158320130015, 8639.483486859272, 5522.807360195603, 5324.7493935493185, 7641.387302868909, 7751.972484320877, 8216.919974339133, 8658.269548728984, 6767.770301894153, 6187.508134231001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40203294350558755, "mean_inference_ms": 1.0028159739386904, "mean_action_processing_ms": 0.16894146641031738, "mean_env_wait_ms": 0.05461099029676467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003194451332092285, "StateBufferConnector_ms": 0.0026502609252929688, "ViewRequirementAgentConnector_ms": 0.06602251529693604}, "num_episodes": 24, "episode_return_max": 25505.613902624154, "episode_return_min": 98.44348295214617, "episode_return_mean": 20357.917338490428}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.6510326501837, "num_env_steps_trained_throughput_per_sec": 547.6510326501837, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 7443.771, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7443.736, "sample_time_ms": 786.128, "learn_time_ms": 6646.404, "learn_throughput": 601.829, "synch_weights_time_ms": 10.771}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 85, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-32", "timestamp": 1723236032, "time_this_iter_s": 7.308269023895264, "time_total_s": 656.6327366828918, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38c6430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 656.6327366828918, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 25.11, "ram_util_percent": 79.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.47844354053023, "cur_kl_coeff": 78.90990091888236, "cur_lr": 5.0000000000000016e-05, "total_loss": 12.144245175962094, "policy_loss": 0.012717842811068136, "vf_loss": 9.999975384101665, "vf_explained_var": -1.489138477063053e-06, "kl": 0.027012476592112786, "entropy": 0.692252811395302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8222161123839518, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00537041326364, "policy_loss": 0.0026412412844365463, "vf_loss": 9.996021163463592, "vf_explained_var": -0.0004004587729771932, "kl": 0.011778071144362912, "entropy": 1.4042452798535427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 24847.545284076034, "episode_reward_min": 98.44348295214617, "episode_reward_mean": 19800.249726817787, "episode_len_mean": 189.34, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18934, "policy_reward_min": {"agent_policy": 0.8589080191558982, "adversary_policy": 27.73280483349142}, "policy_reward_max": {"agent_policy": 10080.870768624509, "adversary_policy": 11637.450570230802}, "policy_reward_mean": {"agent_policy": 6313.786723652638, "adversary_policy": 6743.231501582582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22352.93649966867, 22843.085208290104, 24847.545284076034, 22933.20382919277, 22534.277525494894, 21029.418379609793, 23275.030932094127, 19695.805736413848, 22014.73755599075, 24568.231076378273, 22377.264221979196, 22702.287931425235, 18879.73637155281, 22541.690215305724, 18504.331589051715, 21387.325370179195, 23031.55088608844, 18079.690154345008, 21317.19415027856, 18976.189510977354, 21045.040146251216, 24459.279788091266, 22016.019475215628, 22703.487786959293, 19254.50472387856, 18559.56578398918, 18287.48890522122, 21855.329415211887, 21952.544996062174, 22421.52790331324, 24453.2300182823, 20175.333995835863, 21708.506987209432, 24272.587300120056, 22113.905456620152, 98.44348295214617, 2696.4362129499677, 20133.206980301322, 19672.096125631066, 19135.916363558208, 18109.318062616574, 23542.583784829185, 22593.606351977145, 24475.116934255464, 22052.49021330008, 22338.822234795563, 21846.95068475617, 18015.54652686601, 22292.993130496747, 18775.163470410702, 23301.200215136192, 23278.511201474852, 21570.348434898668, 18883.81697052503, 18042.92091950142, 17840.19417595386, 24032.5085194688, 21754.676522897367, 1405.4950235377241, 22143.999732027438, 2494.1141679278167, 20346.06059021442, 22272.63027301903, 19267.465594746263, 21862.543582281265, 18465.20630608635, 17704.148127302615, 18646.665319730233, 17830.59296275442, 20016.665000048146, 6850.369214545168, 18651.639626546134, 21951.732980218, 22866.218473476983, 19869.097880387708, 22568.793408829264, 19427.92964839949, 21611.810191831813, 22177.931836774907, 20240.57650729792, 19280.950457356714, 23898.508927758437, 21245.07274815073, 18269.512782571044, 19863.33035924629, 20179.149167568718, 22274.257455778134, 18899.586653726783, 18336.49638050996, 21323.339196968034, 18597.474274783566, 17911.7102093198, 18327.608928132133, 18899.641618430134, 22515.95136341176, 19005.263994698074, 1915.1188977572278, 20016.21898570825, 18209.131392946474, 18732.209808767133], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200], "policy_agent_policy_reward": [5317.733154408507, 4357.272320035369, 3156.6038537558834, 4954.226474895888, 2504.6850535001613, 6922.379406240191, 4443.070259297784, 8196.46177300207, 5470.440953982811, 3586.896358417753, 5702.105101368156, 5391.2930865069775, 9284.05011577824, 5010.987385595113, 9375.683835446078, 5876.804879690648, 4741.148155847981, 9247.503750237229, 6881.549356283908, 8944.267029827948, 6761.388657328882, 3330.041113873026, 6073.177544740099, 4971.348336132205, 8811.32172803968, 9070.737913028754, 9776.962871864851, 5514.0712927170325, 6108.982443105068, 3758.598193724944, 3115.499327733984, 6236.666832192597, 5440.2193426926115, 3414.4271581484263, 5796.969791070161, 0.8589080191558982, 197.72785580486058, 8031.652220407989, 8175.807072815371, 8366.931288205316, 8758.327827004066, 3823.8212304804906, 4853.769396977955, 3503.3555345513273, 5906.958905186416, 5165.907524584549, 6074.745088310407, 9042.760743887555, 5021.090423890352, 9067.805544275378, 4241.0548687511155, 4402.580784082489, 6394.371361960559, 9144.002354221047, 8288.508667639475, 9770.719879062612, 3899.225379416199, 5248.453398252591, 57.45214069312997, 5020.527317306644, 252.48026497606259, 7581.8586208916695, 4770.478667982743, 8946.143367995059, 5727.792634932323, 8788.762064716127, 8497.522081169775, 9133.948787361262, 10001.538856502348, 7918.085811546788, 1195.913685542438, 9039.260824258603, 5698.570298502378, 4872.596060698889, 7473.841206892646, 5273.151601839994, 8580.372894654549, 6218.4504046419825, 5302.742313706776, 7285.298071172728, 8307.692416327609, 3700.6048275083767, 5528.034909100751, 9218.480685133887, 7486.745289044887, 7750.091333169325, 5467.084908070757, 8349.550587360312, 9478.54573126012, 6470.773276686369, 9551.289696098384, 10080.870768624509, 9351.176586876509, 8857.299934955254, 5111.96779818635, 8884.27423325603, 130.55237860193984, 7255.238780990339, 8697.710794230246, 9137.888343498616], "policy_adversary_policy_reward": [8525.144804549776, 8510.058540710406, 9784.8633036956, 8700.949584559263, 10753.229059334866, 10937.712370985311, 9047.604790111369, 8931.372564185598, 8392.141901763927, 11637.450570230802, 7166.736013101865, 6940.30296026775, 9506.403299021662, 9325.557373774716, 5941.864318008124, 5557.479645403617, 7872.60193225983, 8671.694669748136, 10477.633240892534, 10503.701477068002, 8330.491781797899, 8344.667338813124, 8673.185391287874, 8637.809453630409, 4744.738511708859, 4850.947744065762, 9122.36359212459, 8408.33923758605, 4584.977957314208, 4543.669796291375, 7650.6913327846605, 7859.829157703903, 9294.576394024556, 8995.826336215863, 4558.15925723753, 4274.027146870238, 7245.2242116196085, 7190.420582375031, 4834.053887246399, 5197.868593902986, 7363.7174778906165, 6919.934011031756, 10667.804681126669, 10461.43399309158, 7981.112182646779, 7961.729747828719, 8564.85686200998, 9167.282588817108, 5114.594494381983, 5328.588501456841, 4938.096259640247, 4550.731611320155, 4252.361240065883, 4258.164793290515, 8628.06433101393, 7713.193791480949, 8003.121113407992, 7840.441439549101, 10383.537430006007, 8279.392279582282, 10985.958889467403, 10351.771801080946, 6048.783275984264, 7889.883887659052, 8489.106454192814, 7779.181190323992, 10221.304201709507, 10636.855940262145, 8339.283192455508, 7977.6524730945075, 27.73280483349142, 69.85177009949885, 1208.2945094953907, 1290.4138476497187, 6023.090386846626, 6078.464373046755, 5702.583490591958, 5793.705562223735, 5034.952381638659, 5734.032693714229, 4140.060218798491, 5210.930016813993, 9656.612718185499, 10062.149836163197, 8459.888495519444, 9279.94845947969, 10438.472617435145, 10533.288782268963, 8184.880026524071, 7960.651281589541, 8933.544931446806, 8239.369778764176, 7956.828677519626, 7815.376918926076, 3873.4109031350654, 5099.3748798434035, 8156.909864855472, 9114.992841750918, 5031.259883727584, 4676.09804240776, 9163.27796755649, 9896.867378828621, 9369.753283333337, 9506.177134058993, 7620.06799073909, 7555.909082199067, 4785.151803511026, 4954.662812792975, 5853.6269560914825, 3900.7852957705168, 4362.119541407026, 3707.3547554842316, 9919.606877161483, 10213.676262891046, 8887.760243277806, 7618.462881366973, 791.0759967307272, 556.9668861138671, 8001.864108296485, 9121.608306424294, 938.4792493174126, 1303.1546536343417, 6557.090753974023, 6207.111215348745, 8131.3473372357375, 9370.804267800522, 5138.31968329745, 5183.002543453812, 7723.558627929568, 8411.192319419346, 4329.8034600030005, 5346.640781367243, 3593.559589562428, 5613.066456570438, 4999.668509067105, 4513.048023301875, 3727.192746721675, 4101.861359530382, 5874.5293763172185, 6224.049812184164, 2694.3003248275086, 2960.1552041752225, 4786.450250970053, 4825.928551317528, 7812.385878300176, 8440.77680341543, 9121.597290607058, 8872.025122171048, 5747.160367650103, 6648.096305845016, 8656.158320130015, 8639.483486859272, 5522.807360195603, 5324.7493935493185, 7641.387302868909, 7751.972484320877, 8216.919974339133, 8658.269548728984, 6767.770301894153, 6187.508134231001, 5828.868346784139, 5144.389694244965, 10421.0890074172, 9776.815092833105, 7102.93712441973, 8614.100714630156, 4165.461423827166, 4885.570673610015, 6287.355204022764, 6089.229866178654, 6359.219799622611, 6069.838034776695, 8435.76867807459, 8371.403869632826, 5792.585036370642, 4757.4510299958065, 4659.422597094633, 4198.528052155218, 7663.651039190538, 7188.914881091193, 4540.026269466331, 4506.158309218915, 3796.0441933862476, 4034.7952473090627, 4232.688653748872, 4743.743687506826, 5284.6832230966875, 4757.65846037816, 8701.64362517245, 8702.339940053127, 5086.585826954313, 5034.403934487745, 1142.2398275338455, 642.3266916214423, 5875.2147924148385, 6885.765412303008, 4868.689682667936, 4642.730916048402, 4590.410586216428, 5003.910879052132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019232691782826, "mean_inference_ms": 1.0031003800037195, "mean_action_processing_ms": 0.1689044186305549, "mean_env_wait_ms": 0.054591196799535745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003103971481323242, "StateBufferConnector_ms": 0.0024536848068237305, "ViewRequirementAgentConnector_ms": 0.06316936016082764}, "num_episodes": 20, "episode_return_max": 24847.545284076034, "episode_return_min": 98.44348295214617, "episode_return_mean": 19800.249726817787}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 570.2053735922078, "num_env_steps_trained_throughput_per_sec": 570.2053735922078, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 7397.938, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7397.903, "sample_time_ms": 784.969, "learn_time_ms": 6602.062, "learn_throughput": 605.871, "synch_weights_time_ms": 10.445}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 86, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-39", "timestamp": 1723236039, "time_this_iter_s": 7.019205093383789, "time_total_s": 663.6519417762756, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 663.6519417762756, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.145454545454548, "ram_util_percent": 79.28181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.388351321031177, "cur_kl_coeff": 118.36485137832348, "cur_lr": 5.0000000000000016e-05, "total_loss": 14.128194999694824, "policy_loss": 0.018907818771041338, "vf_loss": 10.0, "vf_explained_var": -8.842617115646443e-07, "kl": 0.034717123080833405, "entropy": 0.7511229511291262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8132152652057508, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003834429383279, "policy_loss": -0.002364701602588563, "vf_loss": 10.0, "vf_explained_var": -0.0003722309445341428, "kl": 0.010884634492686018, "entropy": 1.3956310423711935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "env_runners": {"episode_reward_max": 24475.116934255464, "episode_reward_min": 98.44348295214617, "episode_reward_mean": 19350.821073877436, "episode_len_mean": 189.34, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18934, "policy_reward_min": {"agent_policy": 0.8589080191558982, "adversary_policy": 27.73280483349142}, "policy_reward_max": {"agent_policy": 10080.870768624509, "adversary_policy": 10985.958889467403}, "policy_reward_mean": {"agent_policy": 6793.255605809806, "adversary_policy": 6278.782734033814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21045.040146251216, 24459.279788091266, 22016.019475215628, 22703.487786959293, 19254.50472387856, 18559.56578398918, 18287.48890522122, 21855.329415211887, 21952.544996062174, 22421.52790331324, 24453.2300182823, 20175.333995835863, 21708.506987209432, 24272.587300120056, 22113.905456620152, 98.44348295214617, 2696.4362129499677, 20133.206980301322, 19672.096125631066, 19135.916363558208, 18109.318062616574, 23542.583784829185, 22593.606351977145, 24475.116934255464, 22052.49021330008, 22338.822234795563, 21846.95068475617, 18015.54652686601, 22292.993130496747, 18775.163470410702, 23301.200215136192, 23278.511201474852, 21570.348434898668, 18883.81697052503, 18042.92091950142, 17840.19417595386, 24032.5085194688, 21754.676522897367, 1405.4950235377241, 22143.999732027438, 2494.1141679278167, 20346.06059021442, 22272.63027301903, 19267.465594746263, 21862.543582281265, 18465.20630608635, 17704.148127302615, 18646.665319730233, 17830.59296275442, 20016.665000048146, 6850.369214545168, 18651.639626546134, 21951.732980218, 22866.218473476983, 19869.097880387708, 22568.793408829264, 19427.92964839949, 21611.810191831813, 22177.931836774907, 20240.57650729792, 19280.950457356714, 23898.508927758437, 21245.07274815073, 18269.512782571044, 19863.33035924629, 20179.149167568718, 22274.257455778134, 18899.586653726783, 18336.49638050996, 21323.339196968034, 18597.474274783566, 17911.7102093198, 18327.608928132133, 18899.641618430134, 22515.95136341176, 19005.263994698074, 1915.1188977572278, 20016.21898570825, 18209.131392946474, 18732.209808767133, 18254.62918896281, 18518.97616623583, 18188.888173169227, 19649.777468965327, 19551.79599990953, 18792.993245836013, 20274.374935024854, 20236.571085538006, 18396.638185807402, 18520.6001390848, 21274.08825609737, 22517.33485600622, 18617.508161289436, 22622.327869954734, 18104.666427447177, 20500.69473172535, 19048.450349970644, 18046.158270382755, 19616.107491121536, 18216.08613182749], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6761.388657328882, 3330.041113873026, 6073.177544740099, 4971.348336132205, 8811.32172803968, 9070.737913028754, 9776.962871864851, 5514.0712927170325, 6108.982443105068, 3758.598193724944, 3115.499327733984, 6236.666832192597, 5440.2193426926115, 3414.4271581484263, 5796.969791070161, 0.8589080191558982, 197.72785580486058, 8031.652220407989, 8175.807072815371, 8366.931288205316, 8758.327827004066, 3823.8212304804906, 4853.769396977955, 3503.3555345513273, 5906.958905186416, 5165.907524584549, 6074.745088310407, 9042.760743887555, 5021.090423890352, 9067.805544275378, 4241.0548687511155, 4402.580784082489, 6394.371361960559, 9144.002354221047, 8288.508667639475, 9770.719879062612, 3899.225379416199, 5248.453398252591, 57.45214069312997, 5020.527317306644, 252.48026497606259, 7581.8586208916695, 4770.478667982743, 8946.143367995059, 5727.792634932323, 8788.762064716127, 8497.522081169775, 9133.948787361262, 10001.538856502348, 7918.085811546788, 1195.913685542438, 9039.260824258603, 5698.570298502378, 4872.596060698889, 7473.841206892646, 5273.151601839994, 8580.372894654549, 6218.4504046419825, 5302.742313706776, 7285.298071172728, 8307.692416327609, 3700.6048275083767, 5528.034909100751, 9218.480685133887, 7486.745289044887, 7750.091333169325, 5467.084908070757, 8349.550587360312, 9478.54573126012, 6470.773276686369, 9551.289696098384, 10080.870768624509, 9351.176586876509, 8857.299934955254, 5111.96779818635, 8884.27423325603, 130.55237860193984, 7255.238780990339, 8697.710794230246, 9137.888343498616, 9706.309963160122, 8673.302831549507, 9558.251880192094, 8507.489331114364, 8417.91831401316, 9250.236906975739, 7779.423256538002, 7956.690020541115, 9489.747067498298, 9050.211233802282, 6198.489209688612, 4844.637311326623, 9551.547842789372, 5523.373997432503, 9668.452128240704, 7481.920501086713, 8736.240198031355, 9244.590296499693, 8279.473915946055, 9393.744313409356], "policy_adversary_policy_reward": [7363.7174778906165, 6919.934011031756, 10667.804681126669, 10461.43399309158, 7981.112182646779, 7961.729747828719, 8564.85686200998, 9167.282588817108, 5114.594494381983, 5328.588501456841, 4938.096259640247, 4550.731611320155, 4252.361240065883, 4258.164793290515, 8628.06433101393, 7713.193791480949, 8003.121113407992, 7840.441439549101, 10383.537430006007, 8279.392279582282, 10985.958889467403, 10351.771801080946, 6048.783275984264, 7889.883887659052, 8489.106454192814, 7779.181190323992, 10221.304201709507, 10636.855940262145, 8339.283192455508, 7977.6524730945075, 27.73280483349142, 69.85177009949885, 1208.2945094953907, 1290.4138476497187, 6023.090386846626, 6078.464373046755, 5702.583490591958, 5793.705562223735, 5034.952381638659, 5734.032693714229, 4140.060218798491, 5210.930016813993, 9656.612718185499, 10062.149836163197, 8459.888495519444, 9279.94845947969, 10438.472617435145, 10533.288782268963, 8184.880026524071, 7960.651281589541, 8933.544931446806, 8239.369778764176, 7956.828677519626, 7815.376918926076, 3873.4109031350654, 5099.3748798434035, 8156.909864855472, 9114.992841750918, 5031.259883727584, 4676.09804240776, 9163.27796755649, 9896.867378828621, 9369.753283333337, 9506.177134058993, 7620.06799073909, 7555.909082199067, 4785.151803511026, 4954.662812792975, 5853.6269560914825, 3900.7852957705168, 4362.119541407026, 3707.3547554842316, 9919.606877161483, 10213.676262891046, 8887.760243277806, 7618.462881366973, 791.0759967307272, 556.9668861138671, 8001.864108296485, 9121.608306424294, 938.4792493174126, 1303.1546536343417, 6557.090753974023, 6207.111215348745, 8131.3473372357375, 9370.804267800522, 5138.31968329745, 5183.002543453812, 7723.558627929568, 8411.192319419346, 4329.8034600030005, 5346.640781367243, 3593.559589562428, 5613.066456570438, 4999.668509067105, 4513.048023301875, 3727.192746721675, 4101.861359530382, 5874.5293763172185, 6224.049812184164, 2694.3003248275086, 2960.1552041752225, 4786.450250970053, 4825.928551317528, 7812.385878300176, 8440.77680341543, 9121.597290607058, 8872.025122171048, 5747.160367650103, 6648.096305845016, 8656.158320130015, 8639.483486859272, 5522.807360195603, 5324.7493935493185, 7641.387302868909, 7751.972484320877, 8216.919974339133, 8658.269548728984, 6767.770301894153, 6187.508134231001, 5828.868346784139, 5144.389694244965, 10421.0890074172, 9776.815092833105, 7102.93712441973, 8614.100714630156, 4165.461423827166, 4885.570673610015, 6287.355204022764, 6089.229866178654, 6359.219799622611, 6069.838034776695, 8435.76867807459, 8371.403869632826, 5792.585036370642, 4757.4510299958065, 4659.422597094633, 4198.528052155218, 7663.651039190538, 7188.914881091193, 4540.026269466331, 4506.158309218915, 3796.0441933862476, 4034.7952473090627, 4232.688653748872, 4743.743687506826, 5284.6832230966875, 4757.65846037816, 8701.64362517245, 8702.339940053127, 5086.585826954313, 5034.403934487745, 1142.2398275338455, 642.3266916214423, 5875.2147924148385, 6885.765412303008, 4868.689682667936, 4642.730916048402, 4590.410586216428, 5003.910879052132, 4435.8247181669, 4112.4945076358645, 4391.2202046822495, 5454.453130004108, 4056.08057817057, 4574.555714806521, 5577.625137060612, 5564.663000790332, 5410.625540440536, 5723.252145455872, 4652.014603044425, 4890.741735815897, 6299.7881574445255, 6195.163521042193, 6134.493238627433, 6145.387826369486, 4590.351307694627, 4316.539810614471, 4568.194308922443, 4902.194596360106, 7895.04207753306, 7180.556968875626, 9296.473033009486, 8376.224511669956, 4498.804714019306, 4567.155604480871, 8509.82990403928, 8589.123968482992, 3964.8548236544593, 4471.359475552014, 6360.702420890071, 6658.071809748558, 5131.874933339752, 5180.335218599543, 3905.350721406073, 4896.217252477041, 5828.671173366539, 5507.962401808919, 4748.170324209359, 4074.171494208863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40173139615237546, "mean_inference_ms": 1.0022883793908641, "mean_action_processing_ms": 0.1688046952866179, "mean_env_wait_ms": 0.05455218433304041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003073453903198242, "StateBufferConnector_ms": 0.0023986101150512695, "ViewRequirementAgentConnector_ms": 0.06206953525543213}, "num_episodes": 20, "episode_return_max": 24475.116934255464, "episode_return_min": 98.44348295214617, "episode_return_mean": 19350.821073877436}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.2184140215486, "num_env_steps_trained_throughput_per_sec": 549.2184140215486, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 7385.514, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7385.48, "sample_time_ms": 777.685, "learn_time_ms": 6596.772, "learn_throughput": 606.357, "synch_weights_time_ms": 10.607}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "training_iteration": 87, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-47", "timestamp": 1723236047, "time_this_iter_s": 7.287853956222534, "time_total_s": 670.9397957324982, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38c6820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 670.9397957324982, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 25.71, "ram_util_percent": 79.27000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.80151691714292, "cur_kl_coeff": 177.54727706748525, "cur_lr": 5.0000000000000016e-05, "total_loss": 13.994850833327682, "policy_loss": 0.012989141808504918, "vf_loss": 9.997727146855107, "vf_explained_var": -1.6273771013532365e-05, "kl": 0.022439852275604768, "entropy": 0.7988333306615315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8438009005816033, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994823257128397, "policy_loss": -0.0020352005718450527, "vf_loss": 9.984345133105913, "vf_explained_var": -0.00023296500245730082, "kl": 0.02197129536361899, "entropy": 1.3753137078136206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 24475.116934255464, "episode_reward_min": 362.9962446997893, "episode_reward_mean": 18956.56669072223, "episode_len_mean": 187.59, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18759, "policy_reward_min": {"agent_policy": 4.77740187415835, "adversary_policy": 150.86421034382508}, "policy_reward_max": {"agent_policy": 10080.870768624509, "adversary_policy": 10533.288782268963}, "policy_reward_mean": {"agent_policy": 6970.736828146796, "adversary_policy": 5992.914931287722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23542.583784829185, 22593.606351977145, 24475.116934255464, 22052.49021330008, 22338.822234795563, 21846.95068475617, 18015.54652686601, 22292.993130496747, 18775.163470410702, 23301.200215136192, 23278.511201474852, 21570.348434898668, 18883.81697052503, 18042.92091950142, 17840.19417595386, 24032.5085194688, 21754.676522897367, 1405.4950235377241, 22143.999732027438, 2494.1141679278167, 20346.06059021442, 22272.63027301903, 19267.465594746263, 21862.543582281265, 18465.20630608635, 17704.148127302615, 18646.665319730233, 17830.59296275442, 20016.665000048146, 6850.369214545168, 18651.639626546134, 21951.732980218, 22866.218473476983, 19869.097880387708, 22568.793408829264, 19427.92964839949, 21611.810191831813, 22177.931836774907, 20240.57650729792, 19280.950457356714, 23898.508927758437, 21245.07274815073, 18269.512782571044, 19863.33035924629, 20179.149167568718, 22274.257455778134, 18899.586653726783, 18336.49638050996, 21323.339196968034, 18597.474274783566, 17911.7102093198, 18327.608928132133, 18899.641618430134, 22515.95136341176, 19005.263994698074, 1915.1188977572278, 20016.21898570825, 18209.131392946474, 18732.209808767133, 18254.62918896281, 18518.97616623583, 18188.888173169227, 19649.777468965327, 19551.79599990953, 18792.993245836013, 20274.374935024854, 20236.571085538006, 18396.638185807402, 18520.6001390848, 21274.08825609737, 22517.33485600622, 18617.508161289436, 22622.327869954734, 18104.666427447177, 20500.69473172535, 19048.450349970644, 18046.158270382755, 19616.107491121536, 18216.08613182749, 22395.73292095647, 19963.914992282917, 18209.021920859777, 668.0294100160263, 19126.40187180864, 18733.945360282556, 4653.218679696891, 18431.233588731226, 22044.176714626028, 20514.66484616861, 17794.68705264832, 21457.326208600552, 20140.34307390659, 20308.804521196296, 18949.744172800827, 20163.636186927033, 21807.001305482918, 19293.65575517911, 21935.36263087224, 362.9962446997893, 18744.434137007836], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 22, 200, 200, 200, 200, 200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200], "policy_agent_policy_reward": [3823.8212304804906, 4853.769396977955, 3503.3555345513273, 5906.958905186416, 5165.907524584549, 6074.745088310407, 9042.760743887555, 5021.090423890352, 9067.805544275378, 4241.0548687511155, 4402.580784082489, 6394.371361960559, 9144.002354221047, 8288.508667639475, 9770.719879062612, 3899.225379416199, 5248.453398252591, 57.45214069312997, 5020.527317306644, 252.48026497606259, 7581.8586208916695, 4770.478667982743, 8946.143367995059, 5727.792634932323, 8788.762064716127, 8497.522081169775, 9133.948787361262, 10001.538856502348, 7918.085811546788, 1195.913685542438, 9039.260824258603, 5698.570298502378, 4872.596060698889, 7473.841206892646, 5273.151601839994, 8580.372894654549, 6218.4504046419825, 5302.742313706776, 7285.298071172728, 8307.692416327609, 3700.6048275083767, 5528.034909100751, 9218.480685133887, 7486.745289044887, 7750.091333169325, 5467.084908070757, 8349.550587360312, 9478.54573126012, 6470.773276686369, 9551.289696098384, 10080.870768624509, 9351.176586876509, 8857.299934955254, 5111.96779818635, 8884.27423325603, 130.55237860193984, 7255.238780990339, 8697.710794230246, 9137.888343498616, 9706.309963160122, 8673.302831549507, 9558.251880192094, 8507.489331114364, 8417.91831401316, 9250.236906975739, 7779.423256538002, 7956.690020541115, 9489.747067498298, 9050.211233802282, 6198.489209688612, 4844.637311326623, 9551.547842789372, 5523.373997432503, 9668.452128240704, 7481.920501086713, 8736.240198031355, 9244.590296499693, 8279.473915946055, 9393.744313409356, 5537.754956161502, 7805.381656387254, 9948.92109722692, 12.534446589282258, 9087.645163467218, 8906.687358713065, 573.5060359550799, 9533.158515428491, 5273.412681594342, 7566.214768158461, 9898.231260744047, 5900.918482652146, 8015.083761090498, 7536.661757169791, 8594.483387751163, 6990.819425950333, 5546.265582816401, 8727.984277119824, 5315.237279362834, 4.77740187415835, 8684.16065613509], "policy_adversary_policy_reward": [9656.612718185499, 10062.149836163197, 8459.888495519444, 9279.94845947969, 10438.472617435145, 10533.288782268963, 8184.880026524071, 7960.651281589541, 8933.544931446806, 8239.369778764176, 7956.828677519626, 7815.376918926076, 3873.4109031350654, 5099.3748798434035, 8156.909864855472, 9114.992841750918, 5031.259883727584, 4676.09804240776, 9163.27796755649, 9896.867378828621, 9369.753283333337, 9506.177134058993, 7620.06799073909, 7555.909082199067, 4785.151803511026, 4954.662812792975, 5853.6269560914825, 3900.7852957705168, 4362.119541407026, 3707.3547554842316, 9919.606877161483, 10213.676262891046, 8887.760243277806, 7618.462881366973, 791.0759967307272, 556.9668861138671, 8001.864108296485, 9121.608306424294, 938.4792493174126, 1303.1546536343417, 6557.090753974023, 6207.111215348745, 8131.3473372357375, 9370.804267800522, 5138.31968329745, 5183.002543453812, 7723.558627929568, 8411.192319419346, 4329.8034600030005, 5346.640781367243, 3593.559589562428, 5613.066456570438, 4999.668509067105, 4513.048023301875, 3727.192746721675, 4101.861359530382, 5874.5293763172185, 6224.049812184164, 2694.3003248275086, 2960.1552041752225, 4786.450250970053, 4825.928551317528, 7812.385878300176, 8440.77680341543, 9121.597290607058, 8872.025122171048, 5747.160367650103, 6648.096305845016, 8656.158320130015, 8639.483486859272, 5522.807360195603, 5324.7493935493185, 7641.387302868909, 7751.972484320877, 8216.919974339133, 8658.269548728984, 6767.770301894153, 6187.508134231001, 5828.868346784139, 5144.389694244965, 10421.0890074172, 9776.815092833105, 7102.93712441973, 8614.100714630156, 4165.461423827166, 4885.570673610015, 6287.355204022764, 6089.229866178654, 6359.219799622611, 6069.838034776695, 8435.76867807459, 8371.403869632826, 5792.585036370642, 4757.4510299958065, 4659.422597094633, 4198.528052155218, 7663.651039190538, 7188.914881091193, 4540.026269466331, 4506.158309218915, 3796.0441933862476, 4034.7952473090627, 4232.688653748872, 4743.743687506826, 5284.6832230966875, 4757.65846037816, 8701.64362517245, 8702.339940053127, 5086.585826954313, 5034.403934487745, 1142.2398275338455, 642.3266916214423, 5875.2147924148385, 6885.765412303008, 4868.689682667936, 4642.730916048402, 4590.410586216428, 5003.910879052132, 4435.8247181669, 4112.4945076358645, 4391.2202046822495, 5454.453130004108, 4056.08057817057, 4574.555714806521, 5577.625137060612, 5564.663000790332, 5410.625540440536, 5723.252145455872, 4652.014603044425, 4890.741735815897, 6299.7881574445255, 6195.163521042193, 6134.493238627433, 6145.387826369486, 4590.351307694627, 4316.539810614471, 4568.194308922443, 4902.194596360106, 7895.04207753306, 7180.556968875626, 9296.473033009486, 8376.224511669956, 4498.804714019306, 4567.155604480871, 8509.82990403928, 8589.123968482992, 3964.8548236544593, 4471.359475552014, 6360.702420890071, 6658.071809748558, 5131.874933339752, 5180.335218599543, 3905.350721406073, 4896.217252477041, 5828.671173366539, 5507.962401808919, 4748.170324209359, 4074.171494208863, 8326.137224295946, 8531.840740499096, 6185.273271915884, 5973.260063979754, 4170.29256515913, 4089.808258473715, 314.4760194227525, 341.01894400399146, 4984.39127662564, 5054.365431715884, 4984.8708124658315, 4842.387189103684, 1917.347492661019, 2162.3651510807936, 4299.688226106271, 4598.38684719657, 8868.58389966467, 7902.180133367105, 6384.850977966838, 6563.599100043205, 3653.7704716657354, 4242.685320238475, 7332.574741232593, 8223.832984715802, 6050.1302096077225, 6075.1291032084055, 6341.035383783283, 6431.107380243242, 4826.93850795447, 5528.322277095244, 6022.50539006756, 7150.311370909142, 8338.45947079206, 7922.276251874403, 5279.432918839937, 5286.238559219308, 7830.030542724299, 8790.094808785288, 150.86421034382508, 207.3546324818059, 4604.699530681846, 5455.573950190929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4014353015208912, "mean_inference_ms": 1.001640561024877, "mean_action_processing_ms": 0.1686885732954086, "mean_env_wait_ms": 0.05449161051817098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003275632858276367, "StateBufferConnector_ms": 0.002445816993713379, "ViewRequirementAgentConnector_ms": 0.06393945217132568}, "num_episodes": 21, "episode_return_max": 24475.116934255464, "episode_return_min": 362.9962446997893, "episode_return_mean": 18956.56669072223}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 555.7603251267016, "num_env_steps_trained_throughput_per_sec": 555.7603251267016, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 7382.877, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7382.843, "sample_time_ms": 783.391, "learn_time_ms": 6588.59, "learn_throughput": 607.11, "synch_weights_time_ms": 10.45}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 88, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-40-54", "timestamp": 1723236054, "time_this_iter_s": 7.20248007774353, "time_total_s": 678.1422758102417, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38c68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 678.1422758102417, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 24.963636363636365, "ram_util_percent": 79.3181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.87803990285863, "cur_kl_coeff": 266.32091560122797, "cur_lr": 5.0000000000000016e-05, "total_loss": 15.647156721448141, "policy_loss": 0.015443054042391912, "vf_loss": 10.0, "vf_explained_var": 3.6133975578994346e-06, "kl": 0.021146343332079667, "entropy": 0.8217587179923184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8850327677714328, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993485861023267, "policy_loss": -0.0006359335777233355, "vf_loss": 9.98602686325709, "vf_explained_var": -0.0007600915928681691, "kl": 0.009475549082708312, "entropy": 1.3891097266227006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "env_runners": {"episode_reward_max": 26288.1360729277, "episode_reward_min": 362.9962446997893, "episode_reward_mean": 18803.213222776027, "episode_len_mean": 188.75, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18875, "policy_reward_min": {"agent_policy": 4.77740187415835, "adversary_policy": 150.86421034382508}, "policy_reward_max": {"agent_policy": 10080.870768624509, "adversary_policy": 12750.414554172983}, "policy_reward_mean": {"agent_policy": 7318.645066212131, "adversary_policy": 5742.284078281959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18465.20630608635, 17704.148127302615, 18646.665319730233, 17830.59296275442, 20016.665000048146, 6850.369214545168, 18651.639626546134, 21951.732980218, 22866.218473476983, 19869.097880387708, 22568.793408829264, 19427.92964839949, 21611.810191831813, 22177.931836774907, 20240.57650729792, 19280.950457356714, 23898.508927758437, 21245.07274815073, 18269.512782571044, 19863.33035924629, 20179.149167568718, 22274.257455778134, 18899.586653726783, 18336.49638050996, 21323.339196968034, 18597.474274783566, 17911.7102093198, 18327.608928132133, 18899.641618430134, 22515.95136341176, 19005.263994698074, 1915.1188977572278, 20016.21898570825, 18209.131392946474, 18732.209808767133, 18254.62918896281, 18518.97616623583, 18188.888173169227, 19649.777468965327, 19551.79599990953, 18792.993245836013, 20274.374935024854, 20236.571085538006, 18396.638185807402, 18520.6001390848, 21274.08825609737, 22517.33485600622, 18617.508161289436, 22622.327869954734, 18104.666427447177, 20500.69473172535, 19048.450349970644, 18046.158270382755, 19616.107491121536, 18216.08613182749, 22395.73292095647, 19963.914992282917, 18209.021920859777, 668.0294100160263, 19126.40187180864, 18733.945360282556, 4653.218679696891, 18431.233588731226, 22044.176714626028, 20514.66484616861, 17794.68705264832, 21457.326208600552, 20140.34307390659, 20308.804521196296, 18949.744172800827, 20163.636186927033, 21807.001305482918, 19293.65575517911, 21935.36263087224, 362.9962446997893, 18744.434137007836, 19102.299024534816, 19137.079311193545, 5366.833919411386, 17867.95461363265, 21078.948160992655, 24251.502026250397, 22154.234702236026, 20734.923574784312, 18686.704099324827, 18534.985032398235, 18177.568199341455, 20661.96037327569, 18784.810329398933, 18420.99379888561, 19874.131093432, 18457.411591077755, 26288.1360729277, 20842.089199124584, 19899.22352340113, 12757.516194526681, 19571.232556679588, 21518.605721430406, 18156.33591617235, 18768.933426244905], "episode_lengths": [200, 200, 200, 200, 200, 59, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200], "policy_agent_policy_reward": [8788.762064716127, 8497.522081169775, 9133.948787361262, 10001.538856502348, 7918.085811546788, 1195.913685542438, 9039.260824258603, 5698.570298502378, 4872.596060698889, 7473.841206892646, 5273.151601839994, 8580.372894654549, 6218.4504046419825, 5302.742313706776, 7285.298071172728, 8307.692416327609, 3700.6048275083767, 5528.034909100751, 9218.480685133887, 7486.745289044887, 7750.091333169325, 5467.084908070757, 8349.550587360312, 9478.54573126012, 6470.773276686369, 9551.289696098384, 10080.870768624509, 9351.176586876509, 8857.299934955254, 5111.96779818635, 8884.27423325603, 130.55237860193984, 7255.238780990339, 8697.710794230246, 9137.888343498616, 9706.309963160122, 8673.302831549507, 9558.251880192094, 8507.489331114364, 8417.91831401316, 9250.236906975739, 7779.423256538002, 7956.690020541115, 9489.747067498298, 9050.211233802282, 6198.489209688612, 4844.637311326623, 9551.547842789372, 5523.373997432503, 9668.452128240704, 7481.920501086713, 8736.240198031355, 9244.590296499693, 8279.473915946055, 9393.744313409356, 5537.754956161502, 7805.381656387254, 9948.92109722692, 12.534446589282258, 9087.645163467218, 8906.687358713065, 573.5060359550799, 9533.158515428491, 5273.412681594342, 7566.214768158461, 9898.231260744047, 5900.918482652146, 8015.083761090498, 7536.661757169791, 8594.483387751163, 6990.819425950333, 5546.265582816401, 8727.984277119824, 5315.237279362834, 4.77740187415835, 8684.16065613509, 9119.969680474907, 8738.359185499696, 320.4632353508158, 9270.019212174693, 6787.6934128178555, 3785.770840424998, 5760.866816093207, 7158.6949162050005, 9387.97321969117, 8996.305751449454, 9352.101987831307, 6576.701776048763, 8811.884533461482, 9504.166669244196, 7723.992621630876, 9446.070885465384, 1388.607741743128, 7040.004489275556, 8230.739962735524, 1348.4892557328672, 7966.2257538695485, 6317.626535409969, 8843.377659469174, 9120.581764742205], "policy_adversary_policy_reward": [4329.8034600030005, 5346.640781367243, 3593.559589562428, 5613.066456570438, 4999.668509067105, 4513.048023301875, 3727.192746721675, 4101.861359530382, 5874.5293763172185, 6224.049812184164, 2694.3003248275086, 2960.1552041752225, 4786.450250970053, 4825.928551317528, 7812.385878300176, 8440.77680341543, 9121.597290607058, 8872.025122171048, 5747.160367650103, 6648.096305845016, 8656.158320130015, 8639.483486859272, 5522.807360195603, 5324.7493935493185, 7641.387302868909, 7751.972484320877, 8216.919974339133, 8658.269548728984, 6767.770301894153, 6187.508134231001, 5828.868346784139, 5144.389694244965, 10421.0890074172, 9776.815092833105, 7102.93712441973, 8614.100714630156, 4165.461423827166, 4885.570673610015, 6287.355204022764, 6089.229866178654, 6359.219799622611, 6069.838034776695, 8435.76867807459, 8371.403869632826, 5792.585036370642, 4757.4510299958065, 4659.422597094633, 4198.528052155218, 7663.651039190538, 7188.914881091193, 4540.026269466331, 4506.158309218915, 3796.0441933862476, 4034.7952473090627, 4232.688653748872, 4743.743687506826, 5284.6832230966875, 4757.65846037816, 8701.64362517245, 8702.339940053127, 5086.585826954313, 5034.403934487745, 1142.2398275338455, 642.3266916214423, 5875.2147924148385, 6885.765412303008, 4868.689682667936, 4642.730916048402, 4590.410586216428, 5003.910879052132, 4435.8247181669, 4112.4945076358645, 4391.2202046822495, 5454.453130004108, 4056.08057817057, 4574.555714806521, 5577.625137060612, 5564.663000790332, 5410.625540440536, 5723.252145455872, 4652.014603044425, 4890.741735815897, 6299.7881574445255, 6195.163521042193, 6134.493238627433, 6145.387826369486, 4590.351307694627, 4316.539810614471, 4568.194308922443, 4902.194596360106, 7895.04207753306, 7180.556968875626, 9296.473033009486, 8376.224511669956, 4498.804714019306, 4567.155604480871, 8509.82990403928, 8589.123968482992, 3964.8548236544593, 4471.359475552014, 6360.702420890071, 6658.071809748558, 5131.874933339752, 5180.335218599543, 3905.350721406073, 4896.217252477041, 5828.671173366539, 5507.962401808919, 4748.170324209359, 4074.171494208863, 8326.137224295946, 8531.840740499096, 6185.273271915884, 5973.260063979754, 4170.29256515913, 4089.808258473715, 314.4760194227525, 341.01894400399146, 4984.39127662564, 5054.365431715884, 4984.8708124658315, 4842.387189103684, 1917.347492661019, 2162.3651510807936, 4299.688226106271, 4598.38684719657, 8868.58389966467, 7902.180133367105, 6384.850977966838, 6563.599100043205, 3653.7704716657354, 4242.685320238475, 7332.574741232593, 8223.832984715802, 6050.1302096077225, 6075.1291032084055, 6341.035383783283, 6431.107380243242, 4826.93850795447, 5528.322277095244, 6022.50539006756, 7150.311370909142, 8338.45947079206, 7922.276251874403, 5279.432918839937, 5286.238559219308, 7830.030542724299, 8790.094808785288, 150.86421034382508, 207.3546324818059, 4604.699530681846, 5455.573950190929, 4961.854089572071, 5020.475254487904, 5126.915044290242, 5271.805081403667, 2375.9951032282383, 2670.375580832329, 3727.233360979165, 4870.702040478823, 6943.0253855243745, 7348.229362650313, 10125.642262842719, 10340.088922982599, 8068.026653726989, 8325.341232415947, 6598.211431948691, 6978.017226630577, 4745.2557925857245, 4553.475087047975, 4394.849131270796, 5143.830149678047, 4161.063512440589, 4664.402699069564, 7565.128855651982, 6520.129741575078, 5298.743747726315, 4674.18204821119, 4279.759184961161, 4637.067944680317, 5736.521195170019, 6413.617276631145, 4683.05840744102, 4328.282298171465, 12750.414554172983, 12149.113777011398, 6706.337046308185, 7095.74766354083, 5822.245058630659, 5846.238502035022, 6115.749831576211, 5293.277107217604, 6056.4047427475525, 5548.602060062511, 7824.285335638061, 7376.693850382564, 4035.117089604364, 5277.8411670988435, 4641.2158638169385, 5007.1357976857635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40131732482996924, "mean_inference_ms": 1.0007598296559335, "mean_action_processing_ms": 0.16853436654575782, "mean_env_wait_ms": 0.05447362583367758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034143924713134766, "StateBufferConnector_ms": 0.002411961555480957, "ViewRequirementAgentConnector_ms": 0.06329667568206787}, "num_episodes": 24, "episode_return_max": 26288.1360729277, "episode_return_min": 362.9962446997893, "episode_return_mean": 18803.213222776027}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.3475671044106, "num_env_steps_trained_throughput_per_sec": 552.3475671044106, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 7384.03, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7383.995, "sample_time_ms": 782.515, "learn_time_ms": 6590.553, "learn_throughput": 606.929, "synch_weights_time_ms": 10.468}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "training_iteration": 89, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-01", "timestamp": 1723236061, "time_this_iter_s": 7.247144937515259, "time_total_s": 685.389420747757, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38c6af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 685.389420747757, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 25.929999999999996, "ram_util_percent": 79.24000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.10382628743611, "cur_kl_coeff": 399.4813734018418, "cur_lr": 5.0000000000000016e-05, "total_loss": 18.998916533636667, "policy_loss": 0.007411393518288615, "vf_loss": 10.0, "vf_explained_var": -1.3076060663455379e-05, "kl": 0.022507945246866376, "entropy": 0.8285983076802006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8550968122202903, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985639436046283, "policy_loss": -0.006161893314371506, "vf_loss": 9.982416236400605, "vf_explained_var": -0.000813006858030955, "kl": 0.010985786237870342, "entropy": 1.4105451188981533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 26288.1360729277, "episode_reward_min": 362.9962446997893, "episode_reward_mean": 18916.910455523197, "episode_len_mean": 186.76, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18676, "policy_reward_min": {"agent_policy": 4.77740187415835, "adversary_policy": 150.86421034382508}, "policy_reward_max": {"agent_policy": 10080.870768624509, "adversary_policy": 12750.414554172983}, "policy_reward_mean": {"agent_policy": 6971.736361204411, "adversary_policy": 5972.587047159401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18899.586653726783, 18336.49638050996, 21323.339196968034, 18597.474274783566, 17911.7102093198, 18327.608928132133, 18899.641618430134, 22515.95136341176, 19005.263994698074, 1915.1188977572278, 20016.21898570825, 18209.131392946474, 18732.209808767133, 18254.62918896281, 18518.97616623583, 18188.888173169227, 19649.777468965327, 19551.79599990953, 18792.993245836013, 20274.374935024854, 20236.571085538006, 18396.638185807402, 18520.6001390848, 21274.08825609737, 22517.33485600622, 18617.508161289436, 22622.327869954734, 18104.666427447177, 20500.69473172535, 19048.450349970644, 18046.158270382755, 19616.107491121536, 18216.08613182749, 22395.73292095647, 19963.914992282917, 18209.021920859777, 668.0294100160263, 19126.40187180864, 18733.945360282556, 4653.218679696891, 18431.233588731226, 22044.176714626028, 20514.66484616861, 17794.68705264832, 21457.326208600552, 20140.34307390659, 20308.804521196296, 18949.744172800827, 20163.636186927033, 21807.001305482918, 19293.65575517911, 21935.36263087224, 362.9962446997893, 18744.434137007836, 19102.299024534816, 19137.079311193545, 5366.833919411386, 17867.95461363265, 21078.948160992655, 24251.502026250397, 22154.234702236026, 20734.923574784312, 18686.704099324827, 18534.985032398235, 18177.568199341455, 20661.96037327569, 18784.810329398933, 18420.99379888561, 19874.131093432, 18457.411591077755, 26288.1360729277, 20842.089199124584, 19899.22352340113, 12757.516194526681, 19571.232556679588, 21518.605721430406, 18156.33591617235, 18768.933426244905, 18110.548596910005, 5900.574721477576, 23609.248475554105, 25368.685152631704, 18603.666764068552, 24654.65602138065, 19245.631729200748, 24450.690056868458, 22148.33367023057, 18924.465149047566, 21287.45023021664, 2872.232879214682, 23472.1530832975, 21736.26199508308, 23010.932197720922, 23953.034021606538, 24819.217176577255, 23361.879895284423, 22476.732847846404, 19726.9020067136, 18544.66554055935, 18981.920445885287], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 18, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 189, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8349.550587360312, 9478.54573126012, 6470.773276686369, 9551.289696098384, 10080.870768624509, 9351.176586876509, 8857.299934955254, 5111.96779818635, 8884.27423325603, 130.55237860193984, 7255.238780990339, 8697.710794230246, 9137.888343498616, 9706.309963160122, 8673.302831549507, 9558.251880192094, 8507.489331114364, 8417.91831401316, 9250.236906975739, 7779.423256538002, 7956.690020541115, 9489.747067498298, 9050.211233802282, 6198.489209688612, 4844.637311326623, 9551.547842789372, 5523.373997432503, 9668.452128240704, 7481.920501086713, 8736.240198031355, 9244.590296499693, 8279.473915946055, 9393.744313409356, 5537.754956161502, 7805.381656387254, 9948.92109722692, 12.534446589282258, 9087.645163467218, 8906.687358713065, 573.5060359550799, 9533.158515428491, 5273.412681594342, 7566.214768158461, 9898.231260744047, 5900.918482652146, 8015.083761090498, 7536.661757169791, 8594.483387751163, 6990.819425950333, 5546.265582816401, 8727.984277119824, 5315.237279362834, 4.77740187415835, 8684.16065613509, 9119.969680474907, 8738.359185499696, 320.4632353508158, 9270.019212174693, 6787.6934128178555, 3785.770840424998, 5760.866816093207, 7158.6949162050005, 9387.97321969117, 8996.305751449454, 9352.101987831307, 6576.701776048763, 8811.884533461482, 9504.166669244196, 7723.992621630876, 9446.070885465384, 1388.607741743128, 7040.004489275556, 8230.739962735524, 1348.4892557328672, 7966.2257538695485, 6317.626535409969, 8843.377659469174, 9120.581764742205, 9343.512668744152, 786.9016282541699, 3484.5398543153947, 2603.523013148781, 9221.320889666587, 3034.1628202747734, 8788.624476745854, 3329.5719864585403, 5802.774781559386, 8795.480717954673, 6455.526877848191, 252.68182708960447, 4117.995417939719, 6111.372656074568, 5168.05921360492, 2109.361766959589, 3001.5662872012176, 4655.242078374057, 5314.106475811225, 7967.850934143097, 9189.470339367324, 8514.272119255027], "policy_adversary_policy_reward": [5792.585036370642, 4757.4510299958065, 4659.422597094633, 4198.528052155218, 7663.651039190538, 7188.914881091193, 4540.026269466331, 4506.158309218915, 3796.0441933862476, 4034.7952473090627, 4232.688653748872, 4743.743687506826, 5284.6832230966875, 4757.65846037816, 8701.64362517245, 8702.339940053127, 5086.585826954313, 5034.403934487745, 1142.2398275338455, 642.3266916214423, 5875.2147924148385, 6885.765412303008, 4868.689682667936, 4642.730916048402, 4590.410586216428, 5003.910879052132, 4435.8247181669, 4112.4945076358645, 4391.2202046822495, 5454.453130004108, 4056.08057817057, 4574.555714806521, 5577.625137060612, 5564.663000790332, 5410.625540440536, 5723.252145455872, 4652.014603044425, 4890.741735815897, 6299.7881574445255, 6195.163521042193, 6134.493238627433, 6145.387826369486, 4590.351307694627, 4316.539810614471, 4568.194308922443, 4902.194596360106, 7895.04207753306, 7180.556968875626, 9296.473033009486, 8376.224511669956, 4498.804714019306, 4567.155604480871, 8509.82990403928, 8589.123968482992, 3964.8548236544593, 4471.359475552014, 6360.702420890071, 6658.071809748558, 5131.874933339752, 5180.335218599543, 3905.350721406073, 4896.217252477041, 5828.671173366539, 5507.962401808919, 4748.170324209359, 4074.171494208863, 8326.137224295946, 8531.840740499096, 6185.273271915884, 5973.260063979754, 4170.29256515913, 4089.808258473715, 314.4760194227525, 341.01894400399146, 4984.39127662564, 5054.365431715884, 4984.8708124658315, 4842.387189103684, 1917.347492661019, 2162.3651510807936, 4299.688226106271, 4598.38684719657, 8868.58389966467, 7902.180133367105, 6384.850977966838, 6563.599100043205, 3653.7704716657354, 4242.685320238475, 7332.574741232593, 8223.832984715802, 6050.1302096077225, 6075.1291032084055, 6341.035383783283, 6431.107380243242, 4826.93850795447, 5528.322277095244, 6022.50539006756, 7150.311370909142, 8338.45947079206, 7922.276251874403, 5279.432918839937, 5286.238559219308, 7830.030542724299, 8790.094808785288, 150.86421034382508, 207.3546324818059, 4604.699530681846, 5455.573950190929, 4961.854089572071, 5020.475254487904, 5126.915044290242, 5271.805081403667, 2375.9951032282383, 2670.375580832329, 3727.233360979165, 4870.702040478823, 6943.0253855243745, 7348.229362650313, 10125.642262842719, 10340.088922982599, 8068.026653726989, 8325.341232415947, 6598.211431948691, 6978.017226630577, 4745.2557925857245, 4553.475087047975, 4394.849131270796, 5143.830149678047, 4161.063512440589, 4664.402699069564, 7565.128855651982, 6520.129741575078, 5298.743747726315, 4674.18204821119, 4279.759184961161, 4637.067944680317, 5736.521195170019, 6413.617276631145, 4683.05840744102, 4328.282298171465, 12750.414554172983, 12149.113777011398, 6706.337046308185, 7095.74766354083, 5822.245058630659, 5846.238502035022, 6115.749831576211, 5293.277107217604, 6056.4047427475525, 5548.602060062511, 7824.285335638061, 7376.693850382564, 4035.117089604364, 5277.8411670988435, 4641.2158638169385, 5007.1357976857635, 4798.622954986811, 3968.4129731791186, 2575.057006137012, 2538.616087086393, 10657.595769415526, 9467.112851823144, 11307.792253600423, 11457.369885882408, 4909.202787380087, 4473.143087021931, 11078.796062028714, 10541.697139076989, 5352.121071421142, 5104.88618103383, 10712.224757343378, 10408.89331306656, 8338.63685084544, 8006.922037825712, 5346.653007393313, 4782.331423699678, 7433.564716087128, 7398.3586362813, 1265.755300050553, 1353.7957520745247, 10020.027938700012, 9334.129726657684, 7693.163727101249, 7931.725611907269, 8973.994929451868, 8868.87805466409, 11059.277145797128, 10784.395108849762, 10678.551066818867, 11139.099822557397, 9366.85703640156, 9339.780780508761, 8750.35022090351, 8412.276151131578, 5584.869720633149, 6174.181351937386, 4950.349199568541, 4404.846001623603, 5565.988004968198, 4901.660321662057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4011753257768681, "mean_inference_ms": 1.0003613333757897, "mean_action_processing_ms": 0.16847987269765316, "mean_env_wait_ms": 0.05445671288696035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003623366355895996, "StateBufferConnector_ms": 0.0024639368057250977, "ViewRequirementAgentConnector_ms": 0.06709814071655273}, "num_episodes": 22, "episode_return_max": 26288.1360729277, "episode_return_min": 362.9962446997893, "episode_return_mean": 18916.910455523197}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.2736055262172, "num_env_steps_trained_throughput_per_sec": 541.2736055262172, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 7388.352, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7388.318, "sample_time_ms": 790.489, "learn_time_ms": 6587.013, "learn_throughput": 607.256, "synch_weights_time_ms": 10.356}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 90, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-09", "timestamp": 1723236069, "time_this_iter_s": 7.393763780593872, "time_total_s": 692.7831845283508, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 692.7831845283508, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.654545454545453, "ram_util_percent": 78.7909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.20096466680053, "cur_kl_coeff": 599.2220601027627, "cur_lr": 5.0000000000000016e-05, "total_loss": 25.96498196011498, "policy_loss": 0.01928876612542404, "vf_loss": 10.0, "vf_explained_var": -1.2821715975564624e-05, "kl": 0.026610658444444497, "entropy": 0.8005954790052283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7824186655382316, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003504134217899, "policy_loss": -0.0014092237208387815, "vf_loss": 10.0, "vf_explained_var": -0.0003546393165985743, "kl": 0.0057513243586678675, "entropy": 1.409867408623298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "env_runners": {"episode_reward_max": 26288.1360729277, "episode_reward_min": 362.9962446997893, "episode_reward_mean": 19202.164387397246, "episode_len_mean": 188.58, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 18858, "policy_reward_min": {"agent_policy": 4.77740187415835, "adversary_policy": 150.86421034382508}, "policy_reward_max": {"agent_policy": 9948.92109722692, "adversary_policy": 12750.414554172983}, "policy_reward_mean": {"agent_policy": 6947.487875933692, "adversary_policy": 6127.338255731785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20274.374935024854, 20236.571085538006, 18396.638185807402, 18520.6001390848, 21274.08825609737, 22517.33485600622, 18617.508161289436, 22622.327869954734, 18104.666427447177, 20500.69473172535, 19048.450349970644, 18046.158270382755, 19616.107491121536, 18216.08613182749, 22395.73292095647, 19963.914992282917, 18209.021920859777, 668.0294100160263, 19126.40187180864, 18733.945360282556, 4653.218679696891, 18431.233588731226, 22044.176714626028, 20514.66484616861, 17794.68705264832, 21457.326208600552, 20140.34307390659, 20308.804521196296, 18949.744172800827, 20163.636186927033, 21807.001305482918, 19293.65575517911, 21935.36263087224, 362.9962446997893, 18744.434137007836, 19102.299024534816, 19137.079311193545, 5366.833919411386, 17867.95461363265, 21078.948160992655, 24251.502026250397, 22154.234702236026, 20734.923574784312, 18686.704099324827, 18534.985032398235, 18177.568199341455, 20661.96037327569, 18784.810329398933, 18420.99379888561, 19874.131093432, 18457.411591077755, 26288.1360729277, 20842.089199124584, 19899.22352340113, 12757.516194526681, 19571.232556679588, 21518.605721430406, 18156.33591617235, 18768.933426244905, 18110.548596910005, 5900.574721477576, 23609.248475554105, 25368.685152631704, 18603.666764068552, 24654.65602138065, 19245.631729200748, 24450.690056868458, 22148.33367023057, 18924.465149047566, 21287.45023021664, 2872.232879214682, 23472.1530832975, 21736.26199508308, 23010.932197720922, 23953.034021606538, 24819.217176577255, 23361.879895284423, 22476.732847846404, 19726.9020067136, 18544.66554055935, 18981.920445885287, 19944.35876048875, 21613.33168139142, 18958.460422909935, 22149.069207161076, 23582.109308401778, 18219.03862825325, 19038.76110200263, 18621.853785961754, 18679.622307936846, 18095.976018152956, 18875.25441596193, 18520.900682682382, 19166.50696918051, 20125.5041399178, 19407.172540361826, 18988.84772454554, 18477.393931370738, 22741.33075543781, 18966.712753523843], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 189, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7779.423256538002, 7956.690020541115, 9489.747067498298, 9050.211233802282, 6198.489209688612, 4844.637311326623, 9551.547842789372, 5523.373997432503, 9668.452128240704, 7481.920501086713, 8736.240198031355, 9244.590296499693, 8279.473915946055, 9393.744313409356, 5537.754956161502, 7805.381656387254, 9948.92109722692, 12.534446589282258, 9087.645163467218, 8906.687358713065, 573.5060359550799, 9533.158515428491, 5273.412681594342, 7566.214768158461, 9898.231260744047, 5900.918482652146, 8015.083761090498, 7536.661757169791, 8594.483387751163, 6990.819425950333, 5546.265582816401, 8727.984277119824, 5315.237279362834, 4.77740187415835, 8684.16065613509, 9119.969680474907, 8738.359185499696, 320.4632353508158, 9270.019212174693, 6787.6934128178555, 3785.770840424998, 5760.866816093207, 7158.6949162050005, 9387.97321969117, 8996.305751449454, 9352.101987831307, 6576.701776048763, 8811.884533461482, 9504.166669244196, 7723.992621630876, 9446.070885465384, 1388.607741743128, 7040.004489275556, 8230.739962735524, 1348.4892557328672, 7966.2257538695485, 6317.626535409969, 8843.377659469174, 9120.581764742205, 9343.512668744152, 786.9016282541699, 3484.5398543153947, 2603.523013148781, 9221.320889666587, 3034.1628202747734, 8788.624476745854, 3329.5719864585403, 5802.774781559386, 8795.480717954673, 6455.526877848191, 252.68182708960447, 4117.995417939719, 6111.372656074568, 5168.05921360492, 2109.361766959589, 3001.5662872012176, 4655.242078374057, 5314.106475811225, 7967.850934143097, 9189.470339367324, 8514.272119255027, 8163.597729321948, 6409.784269687646, 9040.210538895633, 5808.2218787845, 3671.4305346808783, 9845.471446244406, 8342.608404405786, 8703.30774336911, 9136.460780719255, 9924.5597757778, 8638.868326356487, 8959.007142628532, 8841.77815456142, 7671.90188398078, 7857.118383082809, 8465.429993131058, 9573.490469203209, 5050.17713771513, 8942.375018011413], "policy_adversary_policy_reward": [6299.7881574445255, 6195.163521042193, 6134.493238627433, 6145.387826369486, 4590.351307694627, 4316.539810614471, 4568.194308922443, 4902.194596360106, 7895.04207753306, 7180.556968875626, 9296.473033009486, 8376.224511669956, 4498.804714019306, 4567.155604480871, 8509.82990403928, 8589.123968482992, 3964.8548236544593, 4471.359475552014, 6360.702420890071, 6658.071809748558, 5131.874933339752, 5180.335218599543, 3905.350721406073, 4896.217252477041, 5828.671173366539, 5507.962401808919, 4748.170324209359, 4074.171494208863, 8326.137224295946, 8531.840740499096, 6185.273271915884, 5973.260063979754, 4170.29256515913, 4089.808258473715, 314.4760194227525, 341.01894400399146, 4984.39127662564, 5054.365431715884, 4984.8708124658315, 4842.387189103684, 1917.347492661019, 2162.3651510807936, 4299.688226106271, 4598.38684719657, 8868.58389966467, 7902.180133367105, 6384.850977966838, 6563.599100043205, 3653.7704716657354, 4242.685320238475, 7332.574741232593, 8223.832984715802, 6050.1302096077225, 6075.1291032084055, 6341.035383783283, 6431.107380243242, 4826.93850795447, 5528.322277095244, 6022.50539006756, 7150.311370909142, 8338.45947079206, 7922.276251874403, 5279.432918839937, 5286.238559219308, 7830.030542724299, 8790.094808785288, 150.86421034382508, 207.3546324818059, 4604.699530681846, 5455.573950190929, 4961.854089572071, 5020.475254487904, 5126.915044290242, 5271.805081403667, 2375.9951032282383, 2670.375580832329, 3727.233360979165, 4870.702040478823, 6943.0253855243745, 7348.229362650313, 10125.642262842719, 10340.088922982599, 8068.026653726989, 8325.341232415947, 6598.211431948691, 6978.017226630577, 4745.2557925857245, 4553.475087047975, 4394.849131270796, 5143.830149678047, 4161.063512440589, 4664.402699069564, 7565.128855651982, 6520.129741575078, 5298.743747726315, 4674.18204821119, 4279.759184961161, 4637.067944680317, 5736.521195170019, 6413.617276631145, 4683.05840744102, 4328.282298171465, 12750.414554172983, 12149.113777011398, 6706.337046308185, 7095.74766354083, 5822.245058630659, 5846.238502035022, 6115.749831576211, 5293.277107217604, 6056.4047427475525, 5548.602060062511, 7824.285335638061, 7376.693850382564, 4035.117089604364, 5277.8411670988435, 4641.2158638169385, 5007.1357976857635, 4798.622954986811, 3968.4129731791186, 2575.057006137012, 2538.616087086393, 10657.595769415526, 9467.112851823144, 11307.792253600423, 11457.369885882408, 4909.202787380087, 4473.143087021931, 11078.796062028714, 10541.697139076989, 5352.121071421142, 5104.88618103383, 10712.224757343378, 10408.89331306656, 8338.63685084544, 8006.922037825712, 5346.653007393313, 4782.331423699678, 7433.564716087128, 7398.3586362813, 1265.755300050553, 1353.7957520745247, 10020.027938700012, 9334.129726657684, 7693.163727101249, 7931.725611907269, 8973.994929451868, 8868.87805466409, 11059.277145797128, 10784.395108849762, 10678.551066818867, 11139.099822557397, 9366.85703640156, 9339.780780508761, 8750.35022090351, 8412.276151131578, 5584.869720633149, 6174.181351937386, 4950.349199568541, 4404.846001623603, 5565.988004968198, 4901.660321662057, 5813.648398116344, 5967.112633050432, 7712.846032449102, 7490.7013792546595, 4946.9154412913085, 4971.334442723082, 8066.66038913217, 8274.186939244351, 10392.233598243685, 9518.445175477164, 4222.360106332886, 4151.207075676011, 5788.190258088341, 4907.9624395086, 4480.07180254991, 5438.474240042741, 4862.884475867998, 4680.2770513496325, 4189.582384794069, 3981.833857581157, 5500.195939890971, 4736.190149714526, 5118.190278667083, 4443.703261386829, 5108.890929628713, 5215.837884990378, 6069.985535966579, 6383.61671997037, 6250.557583339393, 5299.496573939638, 5587.122264263909, 4936.295467150597, 4563.968079947457, 4339.935382220109, 8697.671866449873, 8993.481751272771, 5150.470938165714, 4873.866797346718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40095498850810457, "mean_inference_ms": 0.9997192232533822, "mean_action_processing_ms": 0.16841749150856578, "mean_env_wait_ms": 0.054421188140699274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037839412689208984, "StateBufferConnector_ms": 0.002527952194213867, "ViewRequirementAgentConnector_ms": 0.06831705570220947}, "num_episodes": 19, "episode_return_max": 26288.1360729277, "episode_return_min": 362.9962446997893, "episode_return_mean": 19202.164387397246}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.6167905729872, "num_env_steps_trained_throughput_per_sec": 514.6167905729872, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 7426.365, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7426.332, "sample_time_ms": 778.767, "learn_time_ms": 6636.703, "learn_throughput": 602.709, "synch_weights_time_ms": 10.4}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "training_iteration": 91, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-17", "timestamp": 1723236077, "time_this_iter_s": 7.775850057601929, "time_total_s": 700.5590345859528, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b38c6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 700.5590345859528, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 29.390909090909087, "ram_util_percent": 79.15454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.10425487043997, "cur_kl_coeff": 898.8330901541444, "cur_lr": 5.0000000000000016e-05, "total_loss": 34.65568597934864, "policy_loss": 0.020541610433190333, "vf_loss": 10.0, "vf_explained_var": 4.162668551086749e-05, "kl": 0.02740791942628603, "entropy": 0.8250809206849052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8128620610572398, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997239509224892, "policy_loss": -0.002869687253163041, "vf_loss": 9.99597973326842, "vf_explained_var": -0.00042802430689334867, "kl": 0.004833751414359237, "entropy": 1.3846988514065743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 26288.1360729277, "episode_reward_min": 362.9962446997893, "episode_reward_mean": 19232.389359066474, "episode_len_mean": 188.56, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18856, "policy_reward_min": {"agent_policy": 4.77740187415835, "adversary_policy": 150.86421034382508}, "policy_reward_max": {"agent_policy": 9924.5597757778, "adversary_policy": 12750.414554172983}, "policy_reward_mean": {"agent_policy": 6888.306138148158, "adversary_policy": 6172.041610459166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4653.218679696891, 18431.233588731226, 22044.176714626028, 20514.66484616861, 17794.68705264832, 21457.326208600552, 20140.34307390659, 20308.804521196296, 18949.744172800827, 20163.636186927033, 21807.001305482918, 19293.65575517911, 21935.36263087224, 362.9962446997893, 18744.434137007836, 19102.299024534816, 19137.079311193545, 5366.833919411386, 17867.95461363265, 21078.948160992655, 24251.502026250397, 22154.234702236026, 20734.923574784312, 18686.704099324827, 18534.985032398235, 18177.568199341455, 20661.96037327569, 18784.810329398933, 18420.99379888561, 19874.131093432, 18457.411591077755, 26288.1360729277, 20842.089199124584, 19899.22352340113, 12757.516194526681, 19571.232556679588, 21518.605721430406, 18156.33591617235, 18768.933426244905, 18110.548596910005, 5900.574721477576, 23609.248475554105, 25368.685152631704, 18603.666764068552, 24654.65602138065, 19245.631729200748, 24450.690056868458, 22148.33367023057, 18924.465149047566, 21287.45023021664, 2872.232879214682, 23472.1530832975, 21736.26199508308, 23010.932197720922, 23953.034021606538, 24819.217176577255, 23361.879895284423, 22476.732847846404, 19726.9020067136, 18544.66554055935, 18981.920445885287, 19944.35876048875, 21613.33168139142, 18958.460422909935, 22149.069207161076, 23582.109308401778, 18219.03862825325, 19038.76110200263, 18621.853785961754, 18679.622307936846, 18095.976018152956, 18875.25441596193, 18520.900682682382, 19166.50696918051, 20125.5041399178, 19407.172540361826, 18988.84772454554, 18477.393931370738, 22741.33075543781, 18966.712753523843, 20356.315750965245, 22676.48416784363, 18279.8311648069, 22559.466562076817, 19790.682862997273, 18021.4029483833, 18043.68587592224, 19042.916302162972, 396.8977856279654, 18713.9210444146, 21168.756977210614, 17940.691138715058, 22340.42865449195, 20745.77848739615, 18090.270587349027, 18720.58222831066, 20088.267264894035, 19086.312538966307, 18735.963992674064, 23312.49419919854], "episode_lengths": [40, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 189, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [573.5060359550799, 9533.158515428491, 5273.412681594342, 7566.214768158461, 9898.231260744047, 5900.918482652146, 8015.083761090498, 7536.661757169791, 8594.483387751163, 6990.819425950333, 5546.265582816401, 8727.984277119824, 5315.237279362834, 4.77740187415835, 8684.16065613509, 9119.969680474907, 8738.359185499696, 320.4632353508158, 9270.019212174693, 6787.6934128178555, 3785.770840424998, 5760.866816093207, 7158.6949162050005, 9387.97321969117, 8996.305751449454, 9352.101987831307, 6576.701776048763, 8811.884533461482, 9504.166669244196, 7723.992621630876, 9446.070885465384, 1388.607741743128, 7040.004489275556, 8230.739962735524, 1348.4892557328672, 7966.2257538695485, 6317.626535409969, 8843.377659469174, 9120.581764742205, 9343.512668744152, 786.9016282541699, 3484.5398543153947, 2603.523013148781, 9221.320889666587, 3034.1628202747734, 8788.624476745854, 3329.5719864585403, 5802.774781559386, 8795.480717954673, 6455.526877848191, 252.68182708960447, 4117.995417939719, 6111.372656074568, 5168.05921360492, 2109.361766959589, 3001.5662872012176, 4655.242078374057, 5314.106475811225, 7967.850934143097, 9189.470339367324, 8514.272119255027, 8163.597729321948, 6409.784269687646, 9040.210538895633, 5808.2218787845, 3671.4305346808783, 9845.471446244406, 8342.608404405786, 8703.30774336911, 9136.460780719255, 9924.5597757778, 8638.868326356487, 8959.007142628532, 8841.77815456142, 7671.90188398078, 7857.118383082809, 8465.429993131058, 9573.490469203209, 5050.17713771513, 8942.375018011413, 7513.392614784057, 4775.177381680991, 9743.715293861313, 5046.999971888275, 7941.193016885276, 9167.74073182213, 9811.030404713301, 8678.96084938824, 8.481720695057875, 9206.559468783955, 6772.18954049133, 9776.395668168963, 4347.278117801339, 6792.98382249702, 9510.566636022602, 9340.489624469836, 7921.514113569366, 9130.345400637314, 8548.842483874645, 4545.435330787757], "policy_adversary_policy_reward": [1917.347492661019, 2162.3651510807936, 4299.688226106271, 4598.38684719657, 8868.58389966467, 7902.180133367105, 6384.850977966838, 6563.599100043205, 3653.7704716657354, 4242.685320238475, 7332.574741232593, 8223.832984715802, 6050.1302096077225, 6075.1291032084055, 6341.035383783283, 6431.107380243242, 4826.93850795447, 5528.322277095244, 6022.50539006756, 7150.311370909142, 8338.45947079206, 7922.276251874403, 5279.432918839937, 5286.238559219308, 7830.030542724299, 8790.094808785288, 150.86421034382508, 207.3546324818059, 4604.699530681846, 5455.573950190929, 4961.854089572071, 5020.475254487904, 5126.915044290242, 5271.805081403667, 2375.9951032282383, 2670.375580832329, 3727.233360979165, 4870.702040478823, 6943.0253855243745, 7348.229362650313, 10125.642262842719, 10340.088922982599, 8068.026653726989, 8325.341232415947, 6598.211431948691, 6978.017226630577, 4745.2557925857245, 4553.475087047975, 4394.849131270796, 5143.830149678047, 4161.063512440589, 4664.402699069564, 7565.128855651982, 6520.129741575078, 5298.743747726315, 4674.18204821119, 4279.759184961161, 4637.067944680317, 5736.521195170019, 6413.617276631145, 4683.05840744102, 4328.282298171465, 12750.414554172983, 12149.113777011398, 6706.337046308185, 7095.74766354083, 5822.245058630659, 5846.238502035022, 6115.749831576211, 5293.277107217604, 6056.4047427475525, 5548.602060062511, 7824.285335638061, 7376.693850382564, 4035.117089604364, 5277.8411670988435, 4641.2158638169385, 5007.1357976857635, 4798.622954986811, 3968.4129731791186, 2575.057006137012, 2538.616087086393, 10657.595769415526, 9467.112851823144, 11307.792253600423, 11457.369885882408, 4909.202787380087, 4473.143087021931, 11078.796062028714, 10541.697139076989, 5352.121071421142, 5104.88618103383, 10712.224757343378, 10408.89331306656, 8338.63685084544, 8006.922037825712, 5346.653007393313, 4782.331423699678, 7433.564716087128, 7398.3586362813, 1265.755300050553, 1353.7957520745247, 10020.027938700012, 9334.129726657684, 7693.163727101249, 7931.725611907269, 8973.994929451868, 8868.87805466409, 11059.277145797128, 10784.395108849762, 10678.551066818867, 11139.099822557397, 9366.85703640156, 9339.780780508761, 8750.35022090351, 8412.276151131578, 5584.869720633149, 6174.181351937386, 4950.349199568541, 4404.846001623603, 5565.988004968198, 4901.660321662057, 5813.648398116344, 5967.112633050432, 7712.846032449102, 7490.7013792546595, 4946.9154412913085, 4971.334442723082, 8066.66038913217, 8274.186939244351, 10392.233598243685, 9518.445175477164, 4222.360106332886, 4151.207075676011, 5788.190258088341, 4907.9624395086, 4480.07180254991, 5438.474240042741, 4862.884475867998, 4680.2770513496325, 4189.582384794069, 3981.833857581157, 5500.195939890971, 4736.190149714526, 5118.190278667083, 4443.703261386829, 5108.890929628713, 5215.837884990378, 6069.985535966579, 6383.61671997037, 6250.557583339393, 5299.496573939638, 5587.122264263909, 4936.295467150597, 4563.968079947457, 4339.935382220109, 8697.671866449873, 8993.481751272771, 5150.470938165714, 4873.866797346718, 6627.6928099267325, 6215.230326254447, 8550.4741125585, 9350.832673604065, 4216.627315330708, 4319.488555614944, 8618.730221120313, 8893.736369068096, 5649.641796140407, 6199.848049971593, 3880.1810129308633, 4973.481203630353, 3907.2719276082735, 4325.383543600747, 5009.304410804137, 5354.651041970565, 184.76575127200113, 203.65031366090642, 4575.006477587738, 4932.355098042965, 7061.296062476206, 7335.271374243089, 3798.7209163060124, 4365.574554240124, 8198.422697670518, 9794.727839020174, 6988.198002309543, 6964.5966625895335, 4627.410742159502, 3952.293209166925, 4795.992530228341, 4584.100073612545, 6085.899654359627, 6080.853496965039, 4973.641164312985, 4982.325974016072, 5593.261893246413, 4593.859615553026, 9395.602213086044, 9371.456655324871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4007792562823373, "mean_inference_ms": 0.9991725124962962, "mean_action_processing_ms": 0.1683540994731901, "mean_env_wait_ms": 0.05443251957805832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003871321678161621, "StateBufferConnector_ms": 0.002785801887512207, "ViewRequirementAgentConnector_ms": 0.06951451301574707}, "num_episodes": 20, "episode_return_max": 26288.1360729277, "episode_return_min": 362.9962446997893, "episode_return_mean": 19232.389359066474}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.1204951945081, "num_env_steps_trained_throughput_per_sec": 545.1204951945081, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 7392.077, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7392.044, "sample_time_ms": 747.499, "learn_time_ms": 6633.441, "learn_throughput": 603.005, "synch_weights_time_ms": 10.644}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 92, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-24", "timestamp": 1723236084, "time_this_iter_s": 7.342804908752441, "time_total_s": 707.9018394947052, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e5280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 707.9018394947052, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 29.599999999999998, "ram_util_percent": 79.97272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.51216692949728, "cur_kl_coeff": 1348.249635231216, "cur_lr": 5.0000000000000016e-05, "total_loss": 44.426769114297535, "policy_loss": 0.019768534904276883, "vf_loss": 10.0, "vf_explained_var": 5.832456407092867e-06, "kl": 0.02551975514710186, "entropy": 0.8542304902480393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7924865967283646, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001963939269384, "policy_loss": -0.0011008723018070062, "vf_loss": 10.0, "vf_explained_var": -0.0002720830341180166, "kl": 0.007175034405372571, "entropy": 1.369197962184747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "env_runners": {"episode_reward_max": 26288.1360729277, "episode_reward_min": 396.8977856279654, "episode_reward_mean": 19810.462020778024, "episode_len_mean": 193.7, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19370, "policy_reward_min": {"agent_policy": 8.481720695057875, "adversary_policy": 184.76575127200113}, "policy_reward_max": {"agent_policy": 10066.120661479372, "adversary_policy": 12750.414554172983}, "policy_reward_mean": {"agent_policy": 7046.943400705852, "adversary_policy": 6381.7593100360955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21078.948160992655, 24251.502026250397, 22154.234702236026, 20734.923574784312, 18686.704099324827, 18534.985032398235, 18177.568199341455, 20661.96037327569, 18784.810329398933, 18420.99379888561, 19874.131093432, 18457.411591077755, 26288.1360729277, 20842.089199124584, 19899.22352340113, 12757.516194526681, 19571.232556679588, 21518.605721430406, 18156.33591617235, 18768.933426244905, 18110.548596910005, 5900.574721477576, 23609.248475554105, 25368.685152631704, 18603.666764068552, 24654.65602138065, 19245.631729200748, 24450.690056868458, 22148.33367023057, 18924.465149047566, 21287.45023021664, 2872.232879214682, 23472.1530832975, 21736.26199508308, 23010.932197720922, 23953.034021606538, 24819.217176577255, 23361.879895284423, 22476.732847846404, 19726.9020067136, 18544.66554055935, 18981.920445885287, 19944.35876048875, 21613.33168139142, 18958.460422909935, 22149.069207161076, 23582.109308401778, 18219.03862825325, 19038.76110200263, 18621.853785961754, 18679.622307936846, 18095.976018152956, 18875.25441596193, 18520.900682682382, 19166.50696918051, 20125.5041399178, 19407.172540361826, 18988.84772454554, 18477.393931370738, 22741.33075543781, 18966.712753523843, 20356.315750965245, 22676.48416784363, 18279.8311648069, 22559.466562076817, 19790.682862997273, 18021.4029483833, 18043.68587592224, 19042.916302162972, 396.8977856279654, 18713.9210444146, 21168.756977210614, 17940.691138715058, 22340.42865449195, 20745.77848739615, 18090.270587349027, 18720.58222831066, 20088.267264894035, 19086.312538966307, 18735.963992674064, 23312.49419919854, 22788.436390710012, 18810.023784328223, 18557.711782047958, 21390.869638317505, 23404.462115602015, 18866.983324670946, 20747.301302205906, 19171.276111711068, 22549.969065676585, 18039.675080792487, 18784.19661881512, 22081.08308553567, 20498.05524018238, 22319.91817706191, 18469.033156536683, 21400.05956361104, 19818.399626567385, 17757.03345044017, 20428.230643658248], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 107, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 189, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6787.6934128178555, 3785.770840424998, 5760.866816093207, 7158.6949162050005, 9387.97321969117, 8996.305751449454, 9352.101987831307, 6576.701776048763, 8811.884533461482, 9504.166669244196, 7723.992621630876, 9446.070885465384, 1388.607741743128, 7040.004489275556, 8230.739962735524, 1348.4892557328672, 7966.2257538695485, 6317.626535409969, 8843.377659469174, 9120.581764742205, 9343.512668744152, 786.9016282541699, 3484.5398543153947, 2603.523013148781, 9221.320889666587, 3034.1628202747734, 8788.624476745854, 3329.5719864585403, 5802.774781559386, 8795.480717954673, 6455.526877848191, 252.68182708960447, 4117.995417939719, 6111.372656074568, 5168.05921360492, 2109.361766959589, 3001.5662872012176, 4655.242078374057, 5314.106475811225, 7967.850934143097, 9189.470339367324, 8514.272119255027, 8163.597729321948, 6409.784269687646, 9040.210538895633, 5808.2218787845, 3671.4305346808783, 9845.471446244406, 8342.608404405786, 8703.30774336911, 9136.460780719255, 9924.5597757778, 8638.868326356487, 8959.007142628532, 8841.77815456142, 7671.90188398078, 7857.118383082809, 8465.429993131058, 9573.490469203209, 5050.17713771513, 8942.375018011413, 7513.392614784057, 4775.177381680991, 9743.715293861313, 5046.999971888275, 7941.193016885276, 9167.74073182213, 9811.030404713301, 8678.96084938824, 8.481720695057875, 9206.559468783955, 6772.18954049133, 9776.395668168963, 4347.278117801339, 6792.98382249702, 9510.566636022602, 9340.489624469836, 7921.514113569366, 9130.345400637314, 8548.842483874645, 4545.435330787757, 4272.132567694516, 9310.682271811715, 9162.943390863207, 6325.090250129968, 4223.115182164091, 8922.566981069873, 7053.172184469409, 8472.23586162027, 5473.011522571941, 10066.120661479372, 8843.19333191449, 6180.6307083032225, 7168.130248069712, 5605.679439691157, 8878.38999662775, 6459.23115345018, 7975.560341134278, 10037.709619949956, 7043.8571300568765], "policy_adversary_policy_reward": [6943.0253855243745, 7348.229362650313, 10125.642262842719, 10340.088922982599, 8068.026653726989, 8325.341232415947, 6598.211431948691, 6978.017226630577, 4745.2557925857245, 4553.475087047975, 4394.849131270796, 5143.830149678047, 4161.063512440589, 4664.402699069564, 7565.128855651982, 6520.129741575078, 5298.743747726315, 4674.18204821119, 4279.759184961161, 4637.067944680317, 5736.521195170019, 6413.617276631145, 4683.05840744102, 4328.282298171465, 12750.414554172983, 12149.113777011398, 6706.337046308185, 7095.74766354083, 5822.245058630659, 5846.238502035022, 6115.749831576211, 5293.277107217604, 6056.4047427475525, 5548.602060062511, 7824.285335638061, 7376.693850382564, 4035.117089604364, 5277.8411670988435, 4641.2158638169385, 5007.1357976857635, 4798.622954986811, 3968.4129731791186, 2575.057006137012, 2538.616087086393, 10657.595769415526, 9467.112851823144, 11307.792253600423, 11457.369885882408, 4909.202787380087, 4473.143087021931, 11078.796062028714, 10541.697139076989, 5352.121071421142, 5104.88618103383, 10712.224757343378, 10408.89331306656, 8338.63685084544, 8006.922037825712, 5346.653007393313, 4782.331423699678, 7433.564716087128, 7398.3586362813, 1265.755300050553, 1353.7957520745247, 10020.027938700012, 9334.129726657684, 7693.163727101249, 7931.725611907269, 8973.994929451868, 8868.87805466409, 11059.277145797128, 10784.395108849762, 10678.551066818867, 11139.099822557397, 9366.85703640156, 9339.780780508761, 8750.35022090351, 8412.276151131578, 5584.869720633149, 6174.181351937386, 4950.349199568541, 4404.846001623603, 5565.988004968198, 4901.660321662057, 5813.648398116344, 5967.112633050432, 7712.846032449102, 7490.7013792546595, 4946.9154412913085, 4971.334442723082, 8066.66038913217, 8274.186939244351, 10392.233598243685, 9518.445175477164, 4222.360106332886, 4151.207075676011, 5788.190258088341, 4907.9624395086, 4480.07180254991, 5438.474240042741, 4862.884475867998, 4680.2770513496325, 4189.582384794069, 3981.833857581157, 5500.195939890971, 4736.190149714526, 5118.190278667083, 4443.703261386829, 5108.890929628713, 5215.837884990378, 6069.985535966579, 6383.61671997037, 6250.557583339393, 5299.496573939638, 5587.122264263909, 4936.295467150597, 4563.968079947457, 4339.935382220109, 8697.671866449873, 8993.481751272771, 5150.470938165714, 4873.866797346718, 6627.6928099267325, 6215.230326254447, 8550.4741125585, 9350.832673604065, 4216.627315330708, 4319.488555614944, 8618.730221120313, 8893.736369068096, 5649.641796140407, 6199.848049971593, 3880.1810129308633, 4973.481203630353, 3907.2719276082735, 4325.383543600747, 5009.304410804137, 5354.651041970565, 184.76575127200113, 203.65031366090642, 4575.006477587738, 4932.355098042965, 7061.296062476206, 7335.271374243089, 3798.7209163060124, 4365.574554240124, 8198.422697670518, 9794.727839020174, 6988.198002309543, 6964.5966625895335, 4627.410742159502, 3952.293209166925, 4795.992530228341, 4584.100073612545, 6085.899654359627, 6080.853496965039, 4973.641164312985, 4982.325974016072, 5593.261893246413, 4593.859615553026, 9395.602213086044, 9371.456655324871, 9867.754817812825, 8648.549005202587, 4827.344630998679, 4671.996881517942, 4418.860035143089, 4975.908356041639, 7817.041410972724, 7248.737977214965, 9341.452585435432, 9839.894348002728, 4727.060407296971, 5217.355936304188, 6605.187531243315, 7088.941586493146, 5649.169127879007, 5049.871122211917, 8666.905106306187, 8410.052436798727, 3898.523826619203, 4075.0305926939527, 4848.594241923328, 5092.409044977328, 7947.441673097148, 7953.010704135074, 6419.771172012364, 6910.153820100218, 8524.578994285228, 8189.659743085522, 4328.408018966454, 5262.235140942616, 7257.923939879989, 7682.904470280771, 5682.551658931636, 6160.287626501462, 3618.805721817093, 4100.51810867317, 7076.281764179575, 6308.091749421819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40074524025506447, "mean_inference_ms": 0.9986765958172856, "mean_action_processing_ms": 0.1682838350178583, "mean_env_wait_ms": 0.05440204681265191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037854909896850586, "StateBufferConnector_ms": 0.002726316452026367, "ViewRequirementAgentConnector_ms": 0.06766223907470703}, "num_episodes": 19, "episode_return_max": 26288.1360729277, "episode_return_min": 396.8977856279654, "episode_return_mean": 19810.462020778024}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.8430016394136, "num_env_steps_trained_throughput_per_sec": 549.8430016394136, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 7310.117, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7310.083, "sample_time_ms": 732.358, "learn_time_ms": 6566.901, "learn_throughput": 609.115, "synch_weights_time_ms": 10.374}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "training_iteration": 93, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-32", "timestamp": 1723236092, "time_this_iter_s": 7.278919219970703, "time_total_s": 715.1807587146759, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e54c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 715.1807587146759, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 25.509999999999998, "ram_util_percent": 79.92999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 347.29298983301436, "cur_kl_coeff": 2022.3744528468242, "cur_lr": 5.0000000000000016e-05, "total_loss": 74.09395072775543, "policy_loss": 0.027810288111250553, "vf_loss": 10.0, "vf_explained_var": 0.00015566468869567549, "kl": 0.03167867279123692, "entropy": 0.8667021558713661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7947438637881229, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994910008708636, "policy_loss": -0.005228499070411393, "vf_loss": 9.995715750257174, "vf_explained_var": -0.00012559294700622558, "kl": 0.010354148402499656, "entropy": 1.3257932404677073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 24819.217176577255, "episode_reward_min": 396.8977856279654, "episode_reward_mean": 19755.33170373419, "episode_len_mean": 194.34, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 19434, "policy_reward_min": {"agent_policy": 8.481720695057875, "adversary_policy": 184.76575127200113}, "policy_reward_max": {"agent_policy": 10066.120661479372, "adversary_policy": 11139.099822557397}, "policy_reward_mean": {"agent_policy": 7223.335430724075, "adversary_policy": 6265.998136505065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18603.666764068552, 24654.65602138065, 19245.631729200748, 24450.690056868458, 22148.33367023057, 18924.465149047566, 21287.45023021664, 2872.232879214682, 23472.1530832975, 21736.26199508308, 23010.932197720922, 23953.034021606538, 24819.217176577255, 23361.879895284423, 22476.732847846404, 19726.9020067136, 18544.66554055935, 18981.920445885287, 19944.35876048875, 21613.33168139142, 18958.460422909935, 22149.069207161076, 23582.109308401778, 18219.03862825325, 19038.76110200263, 18621.853785961754, 18679.622307936846, 18095.976018152956, 18875.25441596193, 18520.900682682382, 19166.50696918051, 20125.5041399178, 19407.172540361826, 18988.84772454554, 18477.393931370738, 22741.33075543781, 18966.712753523843, 20356.315750965245, 22676.48416784363, 18279.8311648069, 22559.466562076817, 19790.682862997273, 18021.4029483833, 18043.68587592224, 19042.916302162972, 396.8977856279654, 18713.9210444146, 21168.756977210614, 17940.691138715058, 22340.42865449195, 20745.77848739615, 18090.270587349027, 18720.58222831066, 20088.267264894035, 19086.312538966307, 18735.963992674064, 23312.49419919854, 22788.436390710012, 18810.023784328223, 18557.711782047958, 21390.869638317505, 23404.462115602015, 18866.983324670946, 20747.301302205906, 19171.276111711068, 22549.969065676585, 18039.675080792487, 18784.19661881512, 22081.08308553567, 20498.05524018238, 22319.91817706191, 18469.033156536683, 21400.05956361104, 19818.399626567385, 17757.03345044017, 20428.230643658248, 19150.188114254324, 20277.3979446694, 21871.870116626455, 2230.1874314712104, 19496.490332309317, 21609.309329430278, 24002.96973416078, 20619.601720427618, 21532.57958085156, 20903.897276994496, 20760.378103557974, 19419.384419044793, 20371.780239555672, 19671.891224304345, 19902.404579147904, 18340.99435637417, 19498.168769254204, 19244.208846202706, 18896.245863954602, 19258.52189198181, 18578.589084374784, 20416.13167567368, 19881.476516095132, 19161.60368337797], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 23, 200, 200, 200, 189, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9221.320889666587, 3034.1628202747734, 8788.624476745854, 3329.5719864585403, 5802.774781559386, 8795.480717954673, 6455.526877848191, 252.68182708960447, 4117.995417939719, 6111.372656074568, 5168.05921360492, 2109.361766959589, 3001.5662872012176, 4655.242078374057, 5314.106475811225, 7967.850934143097, 9189.470339367324, 8514.272119255027, 8163.597729321948, 6409.784269687646, 9040.210538895633, 5808.2218787845, 3671.4305346808783, 9845.471446244406, 8342.608404405786, 8703.30774336911, 9136.460780719255, 9924.5597757778, 8638.868326356487, 8959.007142628532, 8841.77815456142, 7671.90188398078, 7857.118383082809, 8465.429993131058, 9573.490469203209, 5050.17713771513, 8942.375018011413, 7513.392614784057, 4775.177381680991, 9743.715293861313, 5046.999971888275, 7941.193016885276, 9167.74073182213, 9811.030404713301, 8678.96084938824, 8.481720695057875, 9206.559468783955, 6772.18954049133, 9776.395668168963, 4347.278117801339, 6792.98382249702, 9510.566636022602, 9340.489624469836, 7921.514113569366, 9130.345400637314, 8548.842483874645, 4545.435330787757, 4272.132567694516, 9310.682271811715, 9162.943390863207, 6325.090250129968, 4223.115182164091, 8922.566981069873, 7053.172184469409, 8472.23586162027, 5473.011522571941, 10066.120661479372, 8843.19333191449, 6180.6307083032225, 7168.130248069712, 5605.679439691157, 8878.38999662775, 6459.23115345018, 7975.560341134278, 10037.709619949956, 7043.8571300568765, 8661.914231800714, 7685.099311453426, 5900.024689991763, 232.20453080022156, 8651.121517760233, 5790.031939354704, 3913.0474182819853, 6968.455570007259, 6451.798055191618, 6901.240501360503, 7172.802157209364, 8412.802176536772, 7658.739731168578, 8422.250507665127, 8002.273329214116, 9490.43085082492, 8254.494663427553, 8768.560411093658, 8676.161085287018, 8634.956674320809, 9155.279134514627, 7217.830340069114, 7793.362887915497, 8590.675044376974], "policy_adversary_policy_reward": [4909.202787380087, 4473.143087021931, 11078.796062028714, 10541.697139076989, 5352.121071421142, 5104.88618103383, 10712.224757343378, 10408.89331306656, 8338.63685084544, 8006.922037825712, 5346.653007393313, 4782.331423699678, 7433.564716087128, 7398.3586362813, 1265.755300050553, 1353.7957520745247, 10020.027938700012, 9334.129726657684, 7693.163727101249, 7931.725611907269, 8973.994929451868, 8868.87805466409, 11059.277145797128, 10784.395108849762, 10678.551066818867, 11139.099822557397, 9366.85703640156, 9339.780780508761, 8750.35022090351, 8412.276151131578, 5584.869720633149, 6174.181351937386, 4950.349199568541, 4404.846001623603, 5565.988004968198, 4901.660321662057, 5813.648398116344, 5967.112633050432, 7712.846032449102, 7490.7013792546595, 4946.9154412913085, 4971.334442723082, 8066.66038913217, 8274.186939244351, 10392.233598243685, 9518.445175477164, 4222.360106332886, 4151.207075676011, 5788.190258088341, 4907.9624395086, 4480.07180254991, 5438.474240042741, 4862.884475867998, 4680.2770513496325, 4189.582384794069, 3981.833857581157, 5500.195939890971, 4736.190149714526, 5118.190278667083, 4443.703261386829, 5108.890929628713, 5215.837884990378, 6069.985535966579, 6383.61671997037, 6250.557583339393, 5299.496573939638, 5587.122264263909, 4936.295467150597, 4563.968079947457, 4339.935382220109, 8697.671866449873, 8993.481751272771, 5150.470938165714, 4873.866797346718, 6627.6928099267325, 6215.230326254447, 8550.4741125585, 9350.832673604065, 4216.627315330708, 4319.488555614944, 8618.730221120313, 8893.736369068096, 5649.641796140407, 6199.848049971593, 3880.1810129308633, 4973.481203630353, 3907.2719276082735, 4325.383543600747, 5009.304410804137, 5354.651041970565, 184.76575127200113, 203.65031366090642, 4575.006477587738, 4932.355098042965, 7061.296062476206, 7335.271374243089, 3798.7209163060124, 4365.574554240124, 8198.422697670518, 9794.727839020174, 6988.198002309543, 6964.5966625895335, 4627.410742159502, 3952.293209166925, 4795.992530228341, 4584.100073612545, 6085.899654359627, 6080.853496965039, 4973.641164312985, 4982.325974016072, 5593.261893246413, 4593.859615553026, 9395.602213086044, 9371.456655324871, 9867.754817812825, 8648.549005202587, 4827.344630998679, 4671.996881517942, 4418.860035143089, 4975.908356041639, 7817.041410972724, 7248.737977214965, 9341.452585435432, 9839.894348002728, 4727.060407296971, 5217.355936304188, 6605.187531243315, 7088.941586493146, 5649.169127879007, 5049.871122211917, 8666.905106306187, 8410.052436798727, 3898.523826619203, 4075.0305926939527, 4848.594241923328, 5092.409044977328, 7947.441673097148, 7953.010704135074, 6419.771172012364, 6910.153820100218, 8524.578994285228, 8189.659743085522, 4328.408018966454, 5262.235140942616, 7257.923939879989, 7682.904470280771, 5682.551658931636, 6160.287626501462, 3618.805721817093, 4100.51810867317, 7076.281764179575, 6308.091749421819, 5008.129354831026, 5480.14452762263, 6148.695603625959, 6443.603029590022, 8182.0455252959055, 7789.799901338785, 1103.6925095845415, 894.290391086447, 5483.28012710375, 5362.088687445383, 8101.90093820315, 7717.376451872507, 10228.056376006369, 9861.865939872272, 6478.493839539864, 7172.652310880511, 7489.495964881584, 7591.285560778189, 7098.407512743776, 6904.249262890076, 6886.39526088356, 6701.180685465094, 5718.651619392494, 5287.930623115518, 6274.422931466434, 6438.617576920711, 5686.108703287105, 5563.532013352141, 5760.298952417584, 6139.832297516249, 4239.463947191829, 4611.099558357416, 5440.290595761252, 5803.383510065527, 5368.461819863625, 5107.186615245481, 5452.748766965009, 4767.336011702664, 5117.627841864491, 5505.937375796479, 4973.995345597746, 4449.314604262523, 6920.242059984188, 6278.0592756204, 6338.788930261319, 5749.324697918223, 5310.704990388956, 5260.223648612138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4006022961519027, "mean_inference_ms": 0.998001570713262, "mean_action_processing_ms": 0.16823011153567918, "mean_env_wait_ms": 0.05436502159453564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038393735885620117, "StateBufferConnector_ms": 0.0027707815170288086, "ViewRequirementAgentConnector_ms": 0.06849205493927002}, "num_episodes": 24, "episode_return_max": 24819.217176577255, "episode_return_min": 396.8977856279654, "episode_return_mean": 19755.33170373419}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 569.0430587442819, "num_env_steps_trained_throughput_per_sec": 569.0430587442819, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 7284.597, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7284.564, "sample_time_ms": 732.788, "learn_time_ms": 6541.117, "learn_throughput": 611.516, "synch_weights_time_ms": 10.214}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 94, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-39", "timestamp": 1723236099, "time_this_iter_s": 7.033374786376953, "time_total_s": 722.2141335010529, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32225cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 722.2141335010529, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 24.281818181818185, "ram_util_percent": 79.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 606.4052004476073, "cur_kl_coeff": 3033.561679270236, "cur_lr": 5.0000000000000016e-05, "total_loss": 119.11858152964759, "policy_loss": 0.03738531636532455, "vf_loss": 10.0, "vf_explained_var": 5.625700824475162e-06, "kl": 0.03595812602865475, "entropy": 0.8813400626497925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7851010142359882, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00191537340482, "policy_loss": -0.0007714946540848662, "vf_loss": 9.997637876868248, "vf_explained_var": -0.0001973649486899376, "kl": 0.011820298001597014, "entropy": 1.336351280659437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": 24002.96973416078, "episode_reward_min": 111.09919472149204, "episode_reward_mean": 19441.398428789726, "episode_len_mean": 194.23, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19423, "policy_reward_min": {"agent_policy": 0.9108308686319138, "adversary_policy": 40.3885166028373}, "policy_reward_max": {"agent_policy": 10066.120661479372, "adversary_policy": 10392.233598243685}, "policy_reward_mean": {"agent_policy": 7507.308914989994, "adversary_policy": 5967.044756899874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18958.460422909935, 22149.069207161076, 23582.109308401778, 18219.03862825325, 19038.76110200263, 18621.853785961754, 18679.622307936846, 18095.976018152956, 18875.25441596193, 18520.900682682382, 19166.50696918051, 20125.5041399178, 19407.172540361826, 18988.84772454554, 18477.393931370738, 22741.33075543781, 18966.712753523843, 20356.315750965245, 22676.48416784363, 18279.8311648069, 22559.466562076817, 19790.682862997273, 18021.4029483833, 18043.68587592224, 19042.916302162972, 396.8977856279654, 18713.9210444146, 21168.756977210614, 17940.691138715058, 22340.42865449195, 20745.77848739615, 18090.270587349027, 18720.58222831066, 20088.267264894035, 19086.312538966307, 18735.963992674064, 23312.49419919854, 22788.436390710012, 18810.023784328223, 18557.711782047958, 21390.869638317505, 23404.462115602015, 18866.983324670946, 20747.301302205906, 19171.276111711068, 22549.969065676585, 18039.675080792487, 18784.19661881512, 22081.08308553567, 20498.05524018238, 22319.91817706191, 18469.033156536683, 21400.05956361104, 19818.399626567385, 17757.03345044017, 20428.230643658248, 19150.188114254324, 20277.3979446694, 21871.870116626455, 2230.1874314712104, 19496.490332309317, 21609.309329430278, 24002.96973416078, 20619.601720427618, 21532.57958085156, 20903.897276994496, 20760.378103557974, 19419.384419044793, 20371.780239555672, 19671.891224304345, 19902.404579147904, 18340.99435637417, 19498.168769254204, 19244.208846202706, 18896.245863954602, 19258.52189198181, 18578.589084374784, 20416.13167567368, 19881.476516095132, 19161.60368337797, 19659.730349541653, 18910.02209530759, 21577.68763693006, 20297.990389627565, 20726.671442487026, 22427.94033257275, 18636.37707433239, 18769.63847900033, 20465.21272738525, 21412.6615727368, 21261.16558547213, 21802.3248390139, 19012.632025488507, 18863.268106357158, 20216.72126540971, 21878.44606571128, 111.09919472149204, 18765.51322932645, 18583.428622492673, 19056.6576243212], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200], "policy_agent_policy_reward": [9040.210538895633, 5808.2218787845, 3671.4305346808783, 9845.471446244406, 8342.608404405786, 8703.30774336911, 9136.460780719255, 9924.5597757778, 8638.868326356487, 8959.007142628532, 8841.77815456142, 7671.90188398078, 7857.118383082809, 8465.429993131058, 9573.490469203209, 5050.17713771513, 8942.375018011413, 7513.392614784057, 4775.177381680991, 9743.715293861313, 5046.999971888275, 7941.193016885276, 9167.74073182213, 9811.030404713301, 8678.96084938824, 8.481720695057875, 9206.559468783955, 6772.18954049133, 9776.395668168963, 4347.278117801339, 6792.98382249702, 9510.566636022602, 9340.489624469836, 7921.514113569366, 9130.345400637314, 8548.842483874645, 4545.435330787757, 4272.132567694516, 9310.682271811715, 9162.943390863207, 6325.090250129968, 4223.115182164091, 8922.566981069873, 7053.172184469409, 8472.23586162027, 5473.011522571941, 10066.120661479372, 8843.19333191449, 6180.6307083032225, 7168.130248069712, 5605.679439691157, 8878.38999662775, 6459.23115345018, 7975.560341134278, 10037.709619949956, 7043.8571300568765, 8661.914231800714, 7685.099311453426, 5900.024689991763, 232.20453080022156, 8651.121517760233, 5790.031939354704, 3913.0474182819853, 6968.455570007259, 6451.798055191618, 6901.240501360503, 7172.802157209364, 8412.802176536772, 7658.739731168578, 8422.250507665127, 8002.273329214116, 9490.43085082492, 8254.494663427553, 8768.560411093658, 8676.161085287018, 8634.956674320809, 9155.279134514627, 7217.830340069114, 7793.362887915497, 8590.675044376974, 8368.745497273769, 8994.98312464057, 6352.680425090759, 7703.004427737564, 7186.897927574089, 5220.34339328816, 8834.55280245758, 8670.349595349335, 7524.419272575535, 5319.164386404154, 6581.975014986971, 5873.495252247815, 8782.706275786752, 9271.183212925895, 7874.530016699259, 5757.753282751713, 0.9108308686319138, 8966.817583476444, 8828.775745341462, 8686.884024453626], "policy_adversary_policy_reward": [4946.9154412913085, 4971.334442723082, 8066.66038913217, 8274.186939244351, 10392.233598243685, 9518.445175477164, 4222.360106332886, 4151.207075676011, 5788.190258088341, 4907.9624395086, 4480.07180254991, 5438.474240042741, 4862.884475867998, 4680.2770513496325, 4189.582384794069, 3981.833857581157, 5500.195939890971, 4736.190149714526, 5118.190278667083, 4443.703261386829, 5108.890929628713, 5215.837884990378, 6069.985535966579, 6383.61671997037, 6250.557583339393, 5299.496573939638, 5587.122264263909, 4936.295467150597, 4563.968079947457, 4339.935382220109, 8697.671866449873, 8993.481751272771, 5150.470938165714, 4873.866797346718, 6627.6928099267325, 6215.230326254447, 8550.4741125585, 9350.832673604065, 4216.627315330708, 4319.488555614944, 8618.730221120313, 8893.736369068096, 5649.641796140407, 6199.848049971593, 3880.1810129308633, 4973.481203630353, 3907.2719276082735, 4325.383543600747, 5009.304410804137, 5354.651041970565, 184.76575127200113, 203.65031366090642, 4575.006477587738, 4932.355098042965, 7061.296062476206, 7335.271374243089, 3798.7209163060124, 4365.574554240124, 8198.422697670518, 9794.727839020174, 6988.198002309543, 6964.5966625895335, 4627.410742159502, 3952.293209166925, 4795.992530228341, 4584.100073612545, 6085.899654359627, 6080.853496965039, 4973.641164312985, 4982.325974016072, 5593.261893246413, 4593.859615553026, 9395.602213086044, 9371.456655324871, 9867.754817812825, 8648.549005202587, 4827.344630998679, 4671.996881517942, 4418.860035143089, 4975.908356041639, 7817.041410972724, 7248.737977214965, 9341.452585435432, 9839.894348002728, 4727.060407296971, 5217.355936304188, 6605.187531243315, 7088.941586493146, 5649.169127879007, 5049.871122211917, 8666.905106306187, 8410.052436798727, 3898.523826619203, 4075.0305926939527, 4848.594241923328, 5092.409044977328, 7947.441673097148, 7953.010704135074, 6419.771172012364, 6910.153820100218, 8524.578994285228, 8189.659743085522, 4328.408018966454, 5262.235140942616, 7257.923939879989, 7682.904470280771, 5682.551658931636, 6160.287626501462, 3618.805721817093, 4100.51810867317, 7076.281764179575, 6308.091749421819, 5008.129354831026, 5480.14452762263, 6148.695603625959, 6443.603029590022, 8182.0455252959055, 7789.799901338785, 1103.6925095845415, 894.290391086447, 5483.28012710375, 5362.088687445383, 8101.90093820315, 7717.376451872507, 10228.056376006369, 9861.865939872272, 6478.493839539864, 7172.652310880511, 7489.495964881584, 7591.285560778189, 7098.407512743776, 6904.249262890076, 6886.39526088356, 6701.180685465094, 5718.651619392494, 5287.930623115518, 6274.422931466434, 6438.617576920711, 5686.108703287105, 5563.532013352141, 5760.298952417584, 6139.832297516249, 4239.463947191829, 4611.099558357416, 5440.290595761252, 5803.383510065527, 5368.461819863625, 5107.186615245481, 5452.748766965009, 4767.336011702664, 5117.627841864491, 5505.937375796479, 4973.995345597746, 4449.314604262523, 6920.242059984188, 6278.0592756204, 6338.788930261319, 5749.324697918223, 5310.704990388956, 5260.223648612138, 5607.507821531106, 5683.477030736849, 5143.26842205773, 4771.770548609413, 7464.8144566813, 7760.192755157933, 6352.406316427097, 6242.579645462816, 6585.197945256093, 6954.575569656741, 8377.728323095496, 8829.868616189071, 5299.96238445365, 4501.86188742126, 5468.109740922529, 4631.179142728567, 6326.45148476734, 6614.341970042295, 7272.47101749028, 8821.026168842372, 7375.18339897233, 7304.007171512892, 8231.954040428564, 7696.8755463374255, 5352.630870328233, 4877.294879373626, 4775.775224302931, 4816.3096691283445, 6082.688209969632, 6259.5030387408515, 7964.380343459535, 8156.312439500005, 40.3885166028373, 69.79984725002284, 5154.844397217465, 4643.851248632675, 5204.400611407345, 4550.252265743936, 4941.333715787097, 5428.439884080564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4003921785771488, "mean_inference_ms": 0.997275881307858, "mean_action_processing_ms": 0.16817860986196265, "mean_env_wait_ms": 0.05429077549971919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004207015037536621, "StateBufferConnector_ms": 0.003304123878479004, "ViewRequirementAgentConnector_ms": 0.06787574291229248}, "num_episodes": 20, "episode_return_max": 24002.96973416078, "episode_return_min": 111.09919472149204, "episode_return_mean": 19441.398428789726}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.1310491627466, "num_env_steps_trained_throughput_per_sec": 543.1310491627466, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 7290.676, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7290.642, "sample_time_ms": 731.906, "learn_time_ms": 6547.719, "learn_throughput": 610.9, "synch_weights_time_ms": 10.576}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 95, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-47", "timestamp": 1723236107, "time_this_iter_s": 7.370000123977661, "time_total_s": 729.5841336250305, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 729.5841336250305, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 26.46, "ram_util_percent": 79.73999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 845.5750887613448, "cur_kl_coeff": 4550.342518905355, "cur_lr": 5.0000000000000016e-05, "total_loss": 139.0307776637809, "policy_loss": 0.026015821202145642, "vf_loss": 10.0, "vf_explained_var": 1.0470233897052745e-05, "kl": 0.02835056217850516, "entropy": 0.9032874334426153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8016306614348044, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999401504794756, "policy_loss": 0.000370198130258359, "vf_loss": 9.995496607820193, "vf_explained_var": -0.00045403180023034415, "kl": 0.00827510351324842, "entropy": 1.3209928457935651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 24002.96973416078, "episode_reward_min": 111.09919472149204, "episode_reward_mean": 19287.42137245465, "episode_len_mean": 192.76, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19276, "policy_reward_min": {"agent_policy": 0.9108308686319138, "adversary_policy": 40.3885166028373}, "policy_reward_max": {"agent_policy": 10066.120661479372, "adversary_policy": 10228.056376006369}, "policy_reward_mean": {"agent_policy": 7472.033112956928, "adversary_policy": 5907.694129748874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19790.682862997273, 18021.4029483833, 18043.68587592224, 19042.916302162972, 396.8977856279654, 18713.9210444146, 21168.756977210614, 17940.691138715058, 22340.42865449195, 20745.77848739615, 18090.270587349027, 18720.58222831066, 20088.267264894035, 19086.312538966307, 18735.963992674064, 23312.49419919854, 22788.436390710012, 18810.023784328223, 18557.711782047958, 21390.869638317505, 23404.462115602015, 18866.983324670946, 20747.301302205906, 19171.276111711068, 22549.969065676585, 18039.675080792487, 18784.19661881512, 22081.08308553567, 20498.05524018238, 22319.91817706191, 18469.033156536683, 21400.05956361104, 19818.399626567385, 17757.03345044017, 20428.230643658248, 19150.188114254324, 20277.3979446694, 21871.870116626455, 2230.1874314712104, 19496.490332309317, 21609.309329430278, 24002.96973416078, 20619.601720427618, 21532.57958085156, 20903.897276994496, 20760.378103557974, 19419.384419044793, 20371.780239555672, 19671.891224304345, 19902.404579147904, 18340.99435637417, 19498.168769254204, 19244.208846202706, 18896.245863954602, 19258.52189198181, 18578.589084374784, 20416.13167567368, 19881.476516095132, 19161.60368337797, 19659.730349541653, 18910.02209530759, 21577.68763693006, 20297.990389627565, 20726.671442487026, 22427.94033257275, 18636.37707433239, 18769.63847900033, 20465.21272738525, 21412.6615727368, 21261.16558547213, 21802.3248390139, 19012.632025488507, 18863.268106357158, 20216.72126540971, 21878.44606571128, 111.09919472149204, 18765.51322932645, 18583.428622492673, 19056.6576243212, 18863.459507846528, 18496.2578985778, 20392.22099522543, 18786.217329372274, 22799.310731565663, 5863.029314432721, 22421.946064048876, 19182.690131230527, 18665.250308129107, 19970.75945554655, 19843.374792474562, 19347.15517019897, 21598.75141846926, 19102.65322325493, 21809.140028057358, 19679.437759199354, 18792.216696630214, 20078.114193221987, 18493.889268242663, 18060.58754040856, 18842.44487981428], "episode_lengths": [200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7941.193016885276, 9167.74073182213, 9811.030404713301, 8678.96084938824, 8.481720695057875, 9206.559468783955, 6772.18954049133, 9776.395668168963, 4347.278117801339, 6792.98382249702, 9510.566636022602, 9340.489624469836, 7921.514113569366, 9130.345400637314, 8548.842483874645, 4545.435330787757, 4272.132567694516, 9310.682271811715, 9162.943390863207, 6325.090250129968, 4223.115182164091, 8922.566981069873, 7053.172184469409, 8472.23586162027, 5473.011522571941, 10066.120661479372, 8843.19333191449, 6180.6307083032225, 7168.130248069712, 5605.679439691157, 8878.38999662775, 6459.23115345018, 7975.560341134278, 10037.709619949956, 7043.8571300568765, 8661.914231800714, 7685.099311453426, 5900.024689991763, 232.20453080022156, 8651.121517760233, 5790.031939354704, 3913.0474182819853, 6968.455570007259, 6451.798055191618, 6901.240501360503, 7172.802157209364, 8412.802176536772, 7658.739731168578, 8422.250507665127, 8002.273329214116, 9490.43085082492, 8254.494663427553, 8768.560411093658, 8676.161085287018, 8634.956674320809, 9155.279134514627, 7217.830340069114, 7793.362887915497, 8590.675044376974, 8368.745497273769, 8994.98312464057, 6352.680425090759, 7703.004427737564, 7186.897927574089, 5220.34339328816, 8834.55280245758, 8670.349595349335, 7524.419272575535, 5319.164386404154, 6581.975014986971, 5873.495252247815, 8782.706275786752, 9271.183212925895, 7874.530016699259, 5757.753282751713, 0.9108308686319138, 8966.817583476444, 8828.775745341462, 8686.884024453626, 9258.067827035009, 9338.640644376686, 7388.729674234115, 8400.475016383716, 5277.972606216004, 967.4957928220067, 5318.35298677947, 8829.561674149467, 9258.909294425888, 8060.004868643689, 8085.247343555435, 8853.810055434036, 5485.272047098477, 8782.132165010253, 6362.690970455721, 8326.90525128646, 9296.082085032374, 8016.090897052208, 8324.138000166706, 9608.759902818649, 8784.783567479724], "policy_adversary_policy_reward": [5649.641796140407, 6199.848049971593, 3880.1810129308633, 4973.481203630353, 3907.2719276082735, 4325.383543600747, 5009.304410804137, 5354.651041970565, 184.76575127200113, 203.65031366090642, 4575.006477587738, 4932.355098042965, 7061.296062476206, 7335.271374243089, 3798.7209163060124, 4365.574554240124, 8198.422697670518, 9794.727839020174, 6988.198002309543, 6964.5966625895335, 4627.410742159502, 3952.293209166925, 4795.992530228341, 4584.100073612545, 6085.899654359627, 6080.853496965039, 4973.641164312985, 4982.325974016072, 5593.261893246413, 4593.859615553026, 9395.602213086044, 9371.456655324871, 9867.754817812825, 8648.549005202587, 4827.344630998679, 4671.996881517942, 4418.860035143089, 4975.908356041639, 7817.041410972724, 7248.737977214965, 9341.452585435432, 9839.894348002728, 4727.060407296971, 5217.355936304188, 6605.187531243315, 7088.941586493146, 5649.169127879007, 5049.871122211917, 8666.905106306187, 8410.052436798727, 3898.523826619203, 4075.0305926939527, 4848.594241923328, 5092.409044977328, 7947.441673097148, 7953.010704135074, 6419.771172012364, 6910.153820100218, 8524.578994285228, 8189.659743085522, 4328.408018966454, 5262.235140942616, 7257.923939879989, 7682.904470280771, 5682.551658931636, 6160.287626501462, 3618.805721817093, 4100.51810867317, 7076.281764179575, 6308.091749421819, 5008.129354831026, 5480.14452762263, 6148.695603625959, 6443.603029590022, 8182.0455252959055, 7789.799901338785, 1103.6925095845415, 894.290391086447, 5483.28012710375, 5362.088687445383, 8101.90093820315, 7717.376451872507, 10228.056376006369, 9861.865939872272, 6478.493839539864, 7172.652310880511, 7489.495964881584, 7591.285560778189, 7098.407512743776, 6904.249262890076, 6886.39526088356, 6701.180685465094, 5718.651619392494, 5287.930623115518, 6274.422931466434, 6438.617576920711, 5686.108703287105, 5563.532013352141, 5760.298952417584, 6139.832297516249, 4239.463947191829, 4611.099558357416, 5440.290595761252, 5803.383510065527, 5368.461819863625, 5107.186615245481, 5452.748766965009, 4767.336011702664, 5117.627841864491, 5505.937375796479, 4973.995345597746, 4449.314604262523, 6920.242059984188, 6278.0592756204, 6338.788930261319, 5749.324697918223, 5310.704990388956, 5260.223648612138, 5607.507821531106, 5683.477030736849, 5143.26842205773, 4771.770548609413, 7464.8144566813, 7760.192755157933, 6352.406316427097, 6242.579645462816, 6585.197945256093, 6954.575569656741, 8377.728323095496, 8829.868616189071, 5299.96238445365, 4501.86188742126, 5468.109740922529, 4631.179142728567, 6326.45148476734, 6614.341970042295, 7272.47101749028, 8821.026168842372, 7375.18339897233, 7304.007171512892, 8231.954040428564, 7696.8755463374255, 5352.630870328233, 4877.294879373626, 4775.775224302931, 4816.3096691283445, 6082.688209969632, 6259.5030387408515, 7964.380343459535, 8156.312439500005, 40.3885166028373, 69.79984725002284, 5154.844397217465, 4643.851248632675, 5204.400611407345, 4550.252265743936, 4941.333715787097, 5428.439884080564, 4764.700691919796, 4840.690988891775, 4784.9191407816825, 4372.69811341953, 6253.5290068928825, 6749.962314098433, 4646.423431622448, 5739.318881366139, 8662.17418825043, 8859.163937099089, 2216.297413022102, 2679.2361085886096, 8304.711087879257, 8798.881989390324, 5087.317124088067, 5265.8113329930475, 4672.1366623971035, 4734.204351306186, 5831.754420666497, 6079.000166236407, 5853.5039864227765, 5904.623462496355, 5282.281420883293, 5211.063693881726, 7485.021288863846, 8628.458082506962, 4960.945890460162, 5359.575167784578, 7751.842847534637, 7694.606210066979, 5537.418937233835, 5815.113570679069, 4830.070901169252, 4666.063710428694, 5980.030953688251, 6081.992342481589, 5817.665520027415, 4352.085748048567, 4533.32253544145, 3918.5051021485942, 5348.189748086307, 4709.47156424834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40025220799597716, "mean_inference_ms": 0.9967254099401395, "mean_action_processing_ms": 0.16812378468688308, "mean_env_wait_ms": 0.054249541662616446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004181981086730957, "StateBufferConnector_ms": 0.0032885074615478516, "ViewRequirementAgentConnector_ms": 0.06914985179901123}, "num_episodes": 21, "episode_return_max": 24002.96973416078, "episode_return_min": 111.09919472149204, "episode_return_mean": 19287.42137245465}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.0088565765633, "num_env_steps_trained_throughput_per_sec": 549.0088565765633, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 7317.76, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7317.726, "sample_time_ms": 739.521, "learn_time_ms": 6567.12, "learn_throughput": 609.095, "synch_weights_time_ms": 10.643}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 96, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-41-54", "timestamp": 1723236114, "time_this_iter_s": 7.290519952774048, "time_total_s": 736.8746535778046, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 736.8746535778046, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 25.581818181818186, "ram_util_percent": 79.72727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1134.7942762687724, "cur_kl_coeff": 6825.513778358029, "cur_lr": 5.0000000000000016e-05, "total_loss": 199.5696392402447, "policy_loss": 0.026710927900833584, "vf_loss": 10.0, "vf_explained_var": -1.0208635733871864e-05, "kl": 0.0277697676400994, "entropy": 0.9103151878982625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7885604854517927, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003887563943863, "policy_loss": -0.0015323120285756886, "vf_loss": 10.0, "vf_explained_var": -0.00015761616329352062, "kl": 0.012688450751981387, "entropy": 1.3168666909138362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "env_runners": {"episode_reward_max": 24002.96973416078, "episode_reward_min": 111.09919472149204, "episode_reward_mean": 19581.3836096805, "episode_len_mean": 194.73, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 19473, "policy_reward_min": {"agent_policy": 0.9108308686319138, "adversary_policy": 40.3885166028373}, "policy_reward_max": {"agent_policy": 10066.120661479372, "adversary_policy": 10228.056376006369}, "policy_reward_mean": {"agent_policy": 7434.174402064713, "adversary_policy": 6073.604603807907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18557.711782047958, 21390.869638317505, 23404.462115602015, 18866.983324670946, 20747.301302205906, 19171.276111711068, 22549.969065676585, 18039.675080792487, 18784.19661881512, 22081.08308553567, 20498.05524018238, 22319.91817706191, 18469.033156536683, 21400.05956361104, 19818.399626567385, 17757.03345044017, 20428.230643658248, 19150.188114254324, 20277.3979446694, 21871.870116626455, 2230.1874314712104, 19496.490332309317, 21609.309329430278, 24002.96973416078, 20619.601720427618, 21532.57958085156, 20903.897276994496, 20760.378103557974, 19419.384419044793, 20371.780239555672, 19671.891224304345, 19902.404579147904, 18340.99435637417, 19498.168769254204, 19244.208846202706, 18896.245863954602, 19258.52189198181, 18578.589084374784, 20416.13167567368, 19881.476516095132, 19161.60368337797, 19659.730349541653, 18910.02209530759, 21577.68763693006, 20297.990389627565, 20726.671442487026, 22427.94033257275, 18636.37707433239, 18769.63847900033, 20465.21272738525, 21412.6615727368, 21261.16558547213, 21802.3248390139, 19012.632025488507, 18863.268106357158, 20216.72126540971, 21878.44606571128, 111.09919472149204, 18765.51322932645, 18583.428622492673, 19056.6576243212, 18863.459507846528, 18496.2578985778, 20392.22099522543, 18786.217329372274, 22799.310731565663, 5863.029314432721, 22421.946064048876, 19182.690131230527, 18665.250308129107, 19970.75945554655, 19843.374792474562, 19347.15517019897, 21598.75141846926, 19102.65322325493, 21809.140028057358, 19679.437759199354, 18792.216696630214, 20078.114193221987, 18493.889268242663, 18060.58754040856, 18842.44487981428, 19785.90485808598, 19840.64214547557, 18298.982627894435, 18134.180579865664, 18311.288307104754, 21297.235869603293, 18957.516135551243, 22833.015156905305, 19889.903099373405, 22254.154645264818, 21883.216380754322, 18102.094515682245, 23128.317400257583, 19866.89062563998, 22726.266801058566, 23199.68212148382, 18128.221790713673, 18596.223725623287], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 19, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9162.943390863207, 6325.090250129968, 4223.115182164091, 8922.566981069873, 7053.172184469409, 8472.23586162027, 5473.011522571941, 10066.120661479372, 8843.19333191449, 6180.6307083032225, 7168.130248069712, 5605.679439691157, 8878.38999662775, 6459.23115345018, 7975.560341134278, 10037.709619949956, 7043.8571300568765, 8661.914231800714, 7685.099311453426, 5900.024689991763, 232.20453080022156, 8651.121517760233, 5790.031939354704, 3913.0474182819853, 6968.455570007259, 6451.798055191618, 6901.240501360503, 7172.802157209364, 8412.802176536772, 7658.739731168578, 8422.250507665127, 8002.273329214116, 9490.43085082492, 8254.494663427553, 8768.560411093658, 8676.161085287018, 8634.956674320809, 9155.279134514627, 7217.830340069114, 7793.362887915497, 8590.675044376974, 8368.745497273769, 8994.98312464057, 6352.680425090759, 7703.004427737564, 7186.897927574089, 5220.34339328816, 8834.55280245758, 8670.349595349335, 7524.419272575535, 5319.164386404154, 6581.975014986971, 5873.495252247815, 8782.706275786752, 9271.183212925895, 7874.530016699259, 5757.753282751713, 0.9108308686319138, 8966.817583476444, 8828.775745341462, 8686.884024453626, 9258.067827035009, 9338.640644376686, 7388.729674234115, 8400.475016383716, 5277.972606216004, 967.4957928220067, 5318.35298677947, 8829.561674149467, 9258.909294425888, 8060.004868643689, 8085.247343555435, 8853.810055434036, 5485.272047098477, 8782.132165010253, 6362.690970455721, 8326.90525128646, 9296.082085032374, 8016.090897052208, 8324.138000166706, 9608.759902818649, 8784.783567479724, 8088.557069498678, 8079.671272884836, 8714.39284665087, 8393.686671854783, 9561.765300360763, 6235.645075318979, 8586.346077008695, 5338.949530870106, 7809.88711403547, 5653.245110645265, 5989.978979554519, 9397.851085807846, 5019.151428883186, 7468.3345671194165, 4531.458233252727, 4859.585202409826, 8854.124517918282, 8714.320596818416], "policy_adversary_policy_reward": [4418.860035143089, 4975.908356041639, 7817.041410972724, 7248.737977214965, 9341.452585435432, 9839.894348002728, 4727.060407296971, 5217.355936304188, 6605.187531243315, 7088.941586493146, 5649.169127879007, 5049.871122211917, 8666.905106306187, 8410.052436798727, 3898.523826619203, 4075.0305926939527, 4848.594241923328, 5092.409044977328, 7947.441673097148, 7953.010704135074, 6419.771172012364, 6910.153820100218, 8524.578994285228, 8189.659743085522, 4328.408018966454, 5262.235140942616, 7257.923939879989, 7682.904470280771, 5682.551658931636, 6160.287626501462, 3618.805721817093, 4100.51810867317, 7076.281764179575, 6308.091749421819, 5008.129354831026, 5480.14452762263, 6148.695603625959, 6443.603029590022, 8182.0455252959055, 7789.799901338785, 1103.6925095845415, 894.290391086447, 5483.28012710375, 5362.088687445383, 8101.90093820315, 7717.376451872507, 10228.056376006369, 9861.865939872272, 6478.493839539864, 7172.652310880511, 7489.495964881584, 7591.285560778189, 7098.407512743776, 6904.249262890076, 6886.39526088356, 6701.180685465094, 5718.651619392494, 5287.930623115518, 6274.422931466434, 6438.617576920711, 5686.108703287105, 5563.532013352141, 5760.298952417584, 6139.832297516249, 4239.463947191829, 4611.099558357416, 5440.290595761252, 5803.383510065527, 5368.461819863625, 5107.186615245481, 5452.748766965009, 4767.336011702664, 5117.627841864491, 5505.937375796479, 4973.995345597746, 4449.314604262523, 6920.242059984188, 6278.0592756204, 6338.788930261319, 5749.324697918223, 5310.704990388956, 5260.223648612138, 5607.507821531106, 5683.477030736849, 5143.26842205773, 4771.770548609413, 7464.8144566813, 7760.192755157933, 6352.406316427097, 6242.579645462816, 6585.197945256093, 6954.575569656741, 8377.728323095496, 8829.868616189071, 5299.96238445365, 4501.86188742126, 5468.109740922529, 4631.179142728567, 6326.45148476734, 6614.341970042295, 7272.47101749028, 8821.026168842372, 7375.18339897233, 7304.007171512892, 8231.954040428564, 7696.8755463374255, 5352.630870328233, 4877.294879373626, 4775.775224302931, 4816.3096691283445, 6082.688209969632, 6259.5030387408515, 7964.380343459535, 8156.312439500005, 40.3885166028373, 69.79984725002284, 5154.844397217465, 4643.851248632675, 5204.400611407345, 4550.252265743936, 4941.333715787097, 5428.439884080564, 4764.700691919796, 4840.690988891775, 4784.9191407816825, 4372.69811341953, 6253.5290068928825, 6749.962314098433, 4646.423431622448, 5739.318881366139, 8662.17418825043, 8859.163937099089, 2216.297413022102, 2679.2361085886096, 8304.711087879257, 8798.881989390324, 5087.317124088067, 5265.8113329930475, 4672.1366623971035, 4734.204351306186, 5831.754420666497, 6079.000166236407, 5853.5039864227765, 5904.623462496355, 5282.281420883293, 5211.063693881726, 7485.021288863846, 8628.458082506962, 4960.945890460162, 5359.575167784578, 7751.842847534637, 7694.606210066979, 5537.418937233835, 5815.113570679069, 4830.070901169252, 4666.063710428694, 5980.030953688251, 6081.992342481589, 5817.665520027415, 4352.085748048567, 4533.32253544145, 3918.5051021485942, 5348.189748086307, 4709.47156424834, 6047.488436138913, 5649.8593524484295, 6022.159197460733, 5738.811675130017, 5425.623600032086, 4158.966181211642, 5746.379557191649, 3994.1143508192617, 4170.498623410561, 4579.024383333469, 7731.545976559626, 7330.044817724612, 5550.737779453893, 4820.432279088752, 8766.422901862064, 8727.6427241731, 5806.653124660803, 6273.36286067716, 8120.141094727905, 8480.76843989161, 7997.84751187309, 7895.3898893267915, 3963.718718533915, 4740.524711340595, 9030.791073824541, 9078.37489754977, 6624.429614444981, 5774.126444075553, 8590.314865392986, 9604.493702412738, 9280.82615232713, 9059.270766746995, 3990.1861449967723, 5283.9111277986885, 5425.712216558364, 4456.190912246597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001186253293019, "mean_inference_ms": 0.9961630370281347, "mean_action_processing_ms": 0.1680709583184843, "mean_env_wait_ms": 0.05421216483336135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983855247497559, "StateBufferConnector_ms": 0.003022909164428711, "ViewRequirementAgentConnector_ms": 0.06754088401794434}, "num_episodes": 18, "episode_return_max": 24002.96973416078, "episode_return_min": 111.09919472149204, "episode_return_mean": 19581.3836096805}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.7659124981212, "num_env_steps_trained_throughput_per_sec": 552.7659124981212, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 7313.086, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7313.052, "sample_time_ms": 745.198, "learn_time_ms": 6556.687, "learn_throughput": 610.064, "synch_weights_time_ms": 10.727}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "training_iteration": 97, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-01", "timestamp": 1723236121, "time_this_iter_s": 7.240373849868774, "time_total_s": 744.1150274276733, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 744.1150274276733, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.689999999999998, "ram_util_percent": 79.77}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1964.4989394717745, "cur_kl_coeff": 10238.27066753705, "cur_lr": 5.0000000000000016e-05, "total_loss": 372.78043048192586, "policy_loss": 0.037431701779040316, "vf_loss": 10.0, "vf_explained_var": 1.4550124526654602e-05, "kl": 0.03543010491227347, "entropy": 0.9298542465167071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8430844386108219, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990234575668971, "policy_loss": -0.0034552339478977957, "vf_loss": 9.990905573964119, "vf_explained_var": -0.0002474408596754074, "kl": 0.006518181369271284, "entropy": 1.3171193244556585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 24002.96973416078, "episode_reward_min": 111.09919472149204, "episode_reward_mean": 19264.313679072373, "episode_len_mean": 192.86, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19286, "policy_reward_min": {"agent_policy": 0.9108308686319138, "adversary_policy": 40.3885166028373}, "policy_reward_max": {"agent_policy": 9608.759902818649, "adversary_policy": 10228.056376006369}, "policy_reward_mean": {"agent_policy": 7505.5418187449395, "adversary_policy": 5879.385930163732}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24002.96973416078, 20619.601720427618, 21532.57958085156, 20903.897276994496, 20760.378103557974, 19419.384419044793, 20371.780239555672, 19671.891224304345, 19902.404579147904, 18340.99435637417, 19498.168769254204, 19244.208846202706, 18896.245863954602, 19258.52189198181, 18578.589084374784, 20416.13167567368, 19881.476516095132, 19161.60368337797, 19659.730349541653, 18910.02209530759, 21577.68763693006, 20297.990389627565, 20726.671442487026, 22427.94033257275, 18636.37707433239, 18769.63847900033, 20465.21272738525, 21412.6615727368, 21261.16558547213, 21802.3248390139, 19012.632025488507, 18863.268106357158, 20216.72126540971, 21878.44606571128, 111.09919472149204, 18765.51322932645, 18583.428622492673, 19056.6576243212, 18863.459507846528, 18496.2578985778, 20392.22099522543, 18786.217329372274, 22799.310731565663, 5863.029314432721, 22421.946064048876, 19182.690131230527, 18665.250308129107, 19970.75945554655, 19843.374792474562, 19347.15517019897, 21598.75141846926, 19102.65322325493, 21809.140028057358, 19679.437759199354, 18792.216696630214, 20078.114193221987, 18493.889268242663, 18060.58754040856, 18842.44487981428, 19785.90485808598, 19840.64214547557, 18298.982627894435, 18134.180579865664, 18311.288307104754, 21297.235869603293, 18957.516135551243, 22833.015156905305, 19889.903099373405, 22254.154645264818, 21883.216380754322, 18102.094515682245, 23128.317400257583, 19866.89062563998, 22726.266801058566, 23199.68212148382, 18128.221790713673, 18596.223725623287, 18943.172287520923, 19641.224781650628, 3613.050934119357, 18885.7066641782, 18696.005171158235, 18857.135762877282, 18461.89346846055, 18889.345880212244, 18865.676667237494, 23645.699319312585, 20024.565243692825, 20619.883852503895, 19472.316227113282, 23082.102413051238, 19590.33862672166, 19175.485323027024, 19786.22073465578, 19367.56066159848, 19730.382029684588, 19860.675136393707, 245.72383597189219, 19439.60545922751, 18318.93771101234], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200], "policy_agent_policy_reward": [3913.0474182819853, 6968.455570007259, 6451.798055191618, 6901.240501360503, 7172.802157209364, 8412.802176536772, 7658.739731168578, 8422.250507665127, 8002.273329214116, 9490.43085082492, 8254.494663427553, 8768.560411093658, 8676.161085287018, 8634.956674320809, 9155.279134514627, 7217.830340069114, 7793.362887915497, 8590.675044376974, 8368.745497273769, 8994.98312464057, 6352.680425090759, 7703.004427737564, 7186.897927574089, 5220.34339328816, 8834.55280245758, 8670.349595349335, 7524.419272575535, 5319.164386404154, 6581.975014986971, 5873.495252247815, 8782.706275786752, 9271.183212925895, 7874.530016699259, 5757.753282751713, 0.9108308686319138, 8966.817583476444, 8828.775745341462, 8686.884024453626, 9258.067827035009, 9338.640644376686, 7388.729674234115, 8400.475016383716, 5277.972606216004, 967.4957928220067, 5318.35298677947, 8829.561674149467, 9258.909294425888, 8060.004868643689, 8085.247343555435, 8853.810055434036, 5485.272047098477, 8782.132165010253, 6362.690970455721, 8326.90525128646, 9296.082085032374, 8016.090897052208, 8324.138000166706, 9608.759902818649, 8784.783567479724, 8088.557069498678, 8079.671272884836, 8714.39284665087, 8393.686671854783, 9561.765300360763, 6235.645075318979, 8586.346077008695, 5338.949530870106, 7809.88711403547, 5653.245110645265, 5989.978979554519, 9397.851085807846, 5019.151428883186, 7468.3345671194165, 4531.458233252727, 4859.585202409826, 8854.124517918282, 8714.320596818416, 8540.799177000452, 7982.616264746424, 232.55573971149894, 9063.416496814525, 9119.511550917816, 9176.870500602496, 9133.34903371847, 8796.739756368966, 9053.094396862212, 4338.197051112641, 7861.62348132784, 7407.289424566403, 8605.560139328762, 4701.324079460797, 8199.716589715716, 8557.850727505496, 8323.37662850246, 8847.630693128578, 8010.760823679772, 8151.071429766251, 2.287515677807381, 8562.190573581294, 9279.943818652962], "policy_adversary_policy_reward": [10228.056376006369, 9861.865939872272, 6478.493839539864, 7172.652310880511, 7489.495964881584, 7591.285560778189, 7098.407512743776, 6904.249262890076, 6886.39526088356, 6701.180685465094, 5718.651619392494, 5287.930623115518, 6274.422931466434, 6438.617576920711, 5686.108703287105, 5563.532013352141, 5760.298952417584, 6139.832297516249, 4239.463947191829, 4611.099558357416, 5440.290595761252, 5803.383510065527, 5368.461819863625, 5107.186615245481, 5452.748766965009, 4767.336011702664, 5117.627841864491, 5505.937375796479, 4973.995345597746, 4449.314604262523, 6920.242059984188, 6278.0592756204, 6338.788930261319, 5749.324697918223, 5310.704990388956, 5260.223648612138, 5607.507821531106, 5683.477030736849, 5143.26842205773, 4771.770548609413, 7464.8144566813, 7760.192755157933, 6352.406316427097, 6242.579645462816, 6585.197945256093, 6954.575569656741, 8377.728323095496, 8829.868616189071, 5299.96238445365, 4501.86188742126, 5468.109740922529, 4631.179142728567, 6326.45148476734, 6614.341970042295, 7272.47101749028, 8821.026168842372, 7375.18339897233, 7304.007171512892, 8231.954040428564, 7696.8755463374255, 5352.630870328233, 4877.294879373626, 4775.775224302931, 4816.3096691283445, 6082.688209969632, 6259.5030387408515, 7964.380343459535, 8156.312439500005, 40.3885166028373, 69.79984725002284, 5154.844397217465, 4643.851248632675, 5204.400611407345, 4550.252265743936, 4941.333715787097, 5428.439884080564, 4764.700691919796, 4840.690988891775, 4784.9191407816825, 4372.69811341953, 6253.5290068928825, 6749.962314098433, 4646.423431622448, 5739.318881366139, 8662.17418825043, 8859.163937099089, 2216.297413022102, 2679.2361085886096, 8304.711087879257, 8798.881989390324, 5087.317124088067, 5265.8113329930475, 4672.1366623971035, 4734.204351306186, 5831.754420666497, 6079.000166236407, 5853.5039864227765, 5904.623462496355, 5282.281420883293, 5211.063693881726, 7485.021288863846, 8628.458082506962, 4960.945890460162, 5359.575167784578, 7751.842847534637, 7694.606210066979, 5537.418937233835, 5815.113570679069, 4830.070901169252, 4666.063710428694, 5980.030953688251, 6081.992342481589, 5817.665520027415, 4352.085748048567, 4533.32253544145, 3918.5051021485942, 5348.189748086307, 4709.47156424834, 6047.488436138913, 5649.8593524484295, 6022.159197460733, 5738.811675130017, 5425.623600032086, 4158.966181211642, 5746.379557191649, 3994.1143508192617, 4170.498623410561, 4579.024383333469, 7731.545976559626, 7330.044817724612, 5550.737779453893, 4820.432279088752, 8766.422901862064, 8727.6427241731, 5806.653124660803, 6273.36286067716, 8120.141094727905, 8480.76843989161, 7997.84751187309, 7895.3898893267915, 3963.718718533915, 4740.524711340595, 9030.791073824541, 9078.37489754977, 6624.429614444981, 5774.126444075553, 8590.314865392986, 9604.493702412738, 9280.82615232713, 9059.270766746995, 3990.1861449967723, 5283.9111277986885, 5425.712216558364, 4456.190912246597, 4803.236366314433, 5599.136744206139, 5516.642569997031, 6141.965946907271, 1834.6682916805162, 1545.8269027273413, 5052.871641118077, 4769.418526245685, 4557.257213033975, 5019.23640720656, 4925.845005274785, 4754.420257000127, 4327.923217130109, 5000.6212176120725, 4749.483622460187, 5343.122501383202, 4727.19059532902, 5085.391675046337, 9620.522659815839, 9686.979608384061, 5963.150838767363, 6199.790923597671, 6619.870723333165, 6592.723704604207, 5475.480744079467, 5391.27534370515, 9227.437128005886, 9153.341205584518, 5940.318431955735, 5450.303605050186, 5317.252464078606, 5300.382131443011, 5694.684859426109, 5768.159246727234, 5285.819484836592, 5234.11048363332, 5588.246405953658, 6131.374800051192, 5977.855032388298, 5731.748674239199, 104.30247973458269, 139.13384055950212, 5298.620024518795, 5578.794861127495, 4177.956034239297, 4861.037858120202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998916672594619, "mean_inference_ms": 0.9952962747001318, "mean_action_processing_ms": 0.16792546410572728, "mean_env_wait_ms": 0.05425442917764395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038634538650512695, "StateBufferConnector_ms": 0.0030748844146728516, "ViewRequirementAgentConnector_ms": 0.06806385517120361}, "num_episodes": 23, "episode_return_max": 24002.96973416078, "episode_return_min": 111.09919472149204, "episode_return_mean": 19264.313679072373}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.3736474769939, "num_env_steps_trained_throughput_per_sec": 553.3736474769939, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 7316.19, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7316.156, "sample_time_ms": 745.958, "learn_time_ms": 6559.188, "learn_throughput": 609.832, "synch_weights_time_ms": 10.571}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 98, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-09", "timestamp": 1723236129, "time_this_iter_s": 7.234731912612915, "time_total_s": 751.3497593402863, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320701dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 751.3497593402863, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 25.16363636363636, "ram_util_percent": 79.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3191.9949661820024, "cur_kl_coeff": 15357.406001305564, "cur_lr": 5.0000000000000016e-05, "total_loss": 540.5926743603258, "policy_loss": 0.026811136658150683, "vf_loss": 10.0, "vf_explained_var": 4.353031279548766e-07, "kl": 0.03454788230192015, "entropy": 0.9418970597484124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8553999609934787, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997374761104584, "policy_loss": -0.0036581816273004125, "vf_loss": 9.99590570529302, "vf_explained_var": -0.0005557543287674586, "kl": 0.01200340260596325, "entropy": 1.3446241479367018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "env_runners": {"episode_reward_max": 24389.22882032328, "episode_reward_min": 111.09919472149204, "episode_reward_mean": 19078.176593819746, "episode_len_mean": 190.91, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19091, "policy_reward_min": {"agent_policy": 0.9108308686319138, "adversary_policy": 40.3885166028373}, "policy_reward_max": {"agent_policy": 10259.981696145975, "adversary_policy": 10651.960367955513}, "policy_reward_mean": {"agent_policy": 7414.824008830365, "adversary_policy": 5831.676292494712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20726.671442487026, 22427.94033257275, 18636.37707433239, 18769.63847900033, 20465.21272738525, 21412.6615727368, 21261.16558547213, 21802.3248390139, 19012.632025488507, 18863.268106357158, 20216.72126540971, 21878.44606571128, 111.09919472149204, 18765.51322932645, 18583.428622492673, 19056.6576243212, 18863.459507846528, 18496.2578985778, 20392.22099522543, 18786.217329372274, 22799.310731565663, 5863.029314432721, 22421.946064048876, 19182.690131230527, 18665.250308129107, 19970.75945554655, 19843.374792474562, 19347.15517019897, 21598.75141846926, 19102.65322325493, 21809.140028057358, 19679.437759199354, 18792.216696630214, 20078.114193221987, 18493.889268242663, 18060.58754040856, 18842.44487981428, 19785.90485808598, 19840.64214547557, 18298.982627894435, 18134.180579865664, 18311.288307104754, 21297.235869603293, 18957.516135551243, 22833.015156905305, 19889.903099373405, 22254.154645264818, 21883.216380754322, 18102.094515682245, 23128.317400257583, 19866.89062563998, 22726.266801058566, 23199.68212148382, 18128.221790713673, 18596.223725623287, 18943.172287520923, 19641.224781650628, 3613.050934119357, 18885.7066641782, 18696.005171158235, 18857.135762877282, 18461.89346846055, 18889.345880212244, 18865.676667237494, 23645.699319312585, 20024.565243692825, 20619.883852503895, 19472.316227113282, 23082.102413051238, 19590.33862672166, 19175.485323027024, 19786.22073465578, 19367.56066159848, 19730.382029684588, 19860.675136393707, 245.72383597189219, 19439.60545922751, 18318.93771101234, 23986.044271851657, 18421.75112243051, 18724.35431161391, 18309.448010603544, 17613.64827268519, 19675.288092521332, 19023.05687041924, 18524.02154794746, 18562.245280325376, 19279.854884507346, 19348.39680263892, 24154.549610550814, 19761.123481908937, 620.7791123369336, 23524.634550076637, 24389.22882032328, 22318.351966060556, 19175.68193828508, 18286.13519114287, 20042.55237956146, 19439.471845168013, 19111.931148519307], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7186.897927574089, 5220.34339328816, 8834.55280245758, 8670.349595349335, 7524.419272575535, 5319.164386404154, 6581.975014986971, 5873.495252247815, 8782.706275786752, 9271.183212925895, 7874.530016699259, 5757.753282751713, 0.9108308686319138, 8966.817583476444, 8828.775745341462, 8686.884024453626, 9258.067827035009, 9338.640644376686, 7388.729674234115, 8400.475016383716, 5277.972606216004, 967.4957928220067, 5318.35298677947, 8829.561674149467, 9258.909294425888, 8060.004868643689, 8085.247343555435, 8853.810055434036, 5485.272047098477, 8782.132165010253, 6362.690970455721, 8326.90525128646, 9296.082085032374, 8016.090897052208, 8324.138000166706, 9608.759902818649, 8784.783567479724, 8088.557069498678, 8079.671272884836, 8714.39284665087, 8393.686671854783, 9561.765300360763, 6235.645075318979, 8586.346077008695, 5338.949530870106, 7809.88711403547, 5653.245110645265, 5989.978979554519, 9397.851085807846, 5019.151428883186, 7468.3345671194165, 4531.458233252727, 4859.585202409826, 8854.124517918282, 8714.320596818416, 8540.799177000452, 7982.616264746424, 232.55573971149894, 9063.416496814525, 9119.511550917816, 9176.870500602496, 9133.34903371847, 8796.739756368966, 9053.094396862212, 4338.197051112641, 7861.62348132784, 7407.289424566403, 8605.560139328762, 4701.324079460797, 8199.716589715716, 8557.850727505496, 8323.37662850246, 8847.630693128578, 8010.760823679772, 8151.071429766251, 2.287515677807381, 8562.190573581294, 9279.943818652962, 3935.4257440078, 9653.282902715155, 9292.838882962333, 9513.555530547994, 10259.981696145975, 7896.541869951938, 8964.235449052221, 9551.217687747758, 9486.336555588645, 8768.426503290193, 8043.827326116832, 3864.102296725034, 7905.294836558743, 16.574333451115887, 4090.325092921025, 3385.9275135773287, 5438.602188224498, 8662.235571457495, 9916.61910119688, 7346.392001987835, 8115.6001519052, 8725.449785618737], "policy_adversary_policy_reward": [6585.197945256093, 6954.575569656741, 8377.728323095496, 8829.868616189071, 5299.96238445365, 4501.86188742126, 5468.109740922529, 4631.179142728567, 6326.45148476734, 6614.341970042295, 7272.47101749028, 8821.026168842372, 7375.18339897233, 7304.007171512892, 8231.954040428564, 7696.8755463374255, 5352.630870328233, 4877.294879373626, 4775.775224302931, 4816.3096691283445, 6082.688209969632, 6259.5030387408515, 7964.380343459535, 8156.312439500005, 40.3885166028373, 69.79984725002284, 5154.844397217465, 4643.851248632675, 5204.400611407345, 4550.252265743936, 4941.333715787097, 5428.439884080564, 4764.700691919796, 4840.690988891775, 4784.9191407816825, 4372.69811341953, 6253.5290068928825, 6749.962314098433, 4646.423431622448, 5739.318881366139, 8662.17418825043, 8859.163937099089, 2216.297413022102, 2679.2361085886096, 8304.711087879257, 8798.881989390324, 5087.317124088067, 5265.8113329930475, 4672.1366623971035, 4734.204351306186, 5831.754420666497, 6079.000166236407, 5853.5039864227765, 5904.623462496355, 5282.281420883293, 5211.063693881726, 7485.021288863846, 8628.458082506962, 4960.945890460162, 5359.575167784578, 7751.842847534637, 7694.606210066979, 5537.418937233835, 5815.113570679069, 4830.070901169252, 4666.063710428694, 5980.030953688251, 6081.992342481589, 5817.665520027415, 4352.085748048567, 4533.32253544145, 3918.5051021485942, 5348.189748086307, 4709.47156424834, 6047.488436138913, 5649.8593524484295, 6022.159197460733, 5738.811675130017, 5425.623600032086, 4158.966181211642, 5746.379557191649, 3994.1143508192617, 4170.498623410561, 4579.024383333469, 7731.545976559626, 7330.044817724612, 5550.737779453893, 4820.432279088752, 8766.422901862064, 8727.6427241731, 5806.653124660803, 6273.36286067716, 8120.141094727905, 8480.76843989161, 7997.84751187309, 7895.3898893267915, 3963.718718533915, 4740.524711340595, 9030.791073824541, 9078.37489754977, 6624.429614444981, 5774.126444075553, 8590.314865392986, 9604.493702412738, 9280.82615232713, 9059.270766746995, 3990.1861449967723, 5283.9111277986885, 5425.712216558364, 4456.190912246597, 4803.236366314433, 5599.136744206139, 5516.642569997031, 6141.965946907271, 1834.6682916805162, 1545.8269027273413, 5052.871641118077, 4769.418526245685, 4557.257213033975, 5019.23640720656, 4925.845005274785, 4754.420257000127, 4327.923217130109, 5000.6212176120725, 4749.483622460187, 5343.122501383202, 4727.19059532902, 5085.391675046337, 9620.522659815839, 9686.979608384061, 5963.150838767363, 6199.790923597671, 6619.870723333165, 6592.723704604207, 5475.480744079467, 5391.27534370515, 9227.437128005886, 9153.341205584518, 5940.318431955735, 5450.303605050186, 5317.252464078606, 5300.382131443011, 5694.684859426109, 5768.159246727234, 5285.819484836592, 5234.11048363332, 5588.246405953658, 6131.374800051192, 5977.855032388298, 5731.748674239199, 104.30247973458269, 139.13384055950212, 5298.620024518795, 5578.794861127495, 4177.956034239297, 4861.037858120202, 10200.487329643747, 9850.131198200044, 4281.962301982567, 4486.505917732922, 4634.961785499124, 4796.553643152568, 4607.731756603801, 4188.160723451911, 3473.5173138352957, 3880.14926270397, 6230.0428884410685, 5548.703334128376, 4898.468179650304, 5160.353241716776, 4573.776460253096, 4399.027399946716, 4432.442979391345, 4643.465745345496, 5157.813010145078, 5353.61537107219, 6098.30829761413, 5206.261178907984, 10269.025105563722, 10021.422208261905, 5619.679313214655, 6236.149332135565, 336.9790571421579, 267.2257217436599, 9492.010179824027, 9942.299277331591, 10651.960367955513, 10351.340938790448, 8205.539707169668, 8674.210070666333, 5040.37073307503, 5473.075633752632, 4221.228007646104, 4148.288082300012, 5908.566113075428, 6787.594264498289, 5814.132310984298, 5509.7393822785625, 5278.382457973687, 5108.098904926945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39988337237031246, "mean_inference_ms": 0.9951455704671018, "mean_action_processing_ms": 0.16786290447838334, "mean_env_wait_ms": 0.05424323335565775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00373077392578125, "StateBufferConnector_ms": 0.003255605697631836, "ViewRequirementAgentConnector_ms": 0.07255399227142334}, "num_episodes": 22, "episode_return_max": 24389.22882032328, "episode_return_min": 111.09919472149204, "episode_return_mean": 19078.176593819746}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.92558223302507, "num_env_steps_trained_throughput_per_sec": 500.92558223302507, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 7390.53, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7390.496, "sample_time_ms": 754.828, "learn_time_ms": 6624.818, "learn_throughput": 603.79, "synch_weights_time_ms": 10.453}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "training_iteration": 99, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-17", "timestamp": 1723236137, "time_this_iter_s": 7.991332769393921, "time_total_s": 759.3410921096802, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 759.3410921096802, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 30.527272727272724, "ram_util_percent": 79.86363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5070.548254620588, "cur_kl_coeff": 23036.109001958353, "cur_lr": 5.0000000000000016e-05, "total_loss": 984.8160105064433, "policy_loss": 0.03808801388675988, "vf_loss": 10.0, "vf_explained_var": 1.1967288123236763e-06, "kl": 0.04231521505566817, "entropy": 0.9546408118394317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8278927063879867, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.012440866231918, "policy_loss": 0.005596182806281528, "vf_loss": 10.0, "vf_explained_var": -0.0008998550474643707, "kl": 0.016024196705257055, "entropy": 1.3419746714333693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 25911.48622658405, "episode_reward_min": 245.72383597189219, "episode_reward_mean": 19457.20828336001, "episode_len_mean": 192.9, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19290, "policy_reward_min": {"agent_policy": 2.287515677807381, "adversary_policy": 104.30247973458269}, "policy_reward_max": {"agent_policy": 10259.981696145975, "adversary_policy": 11989.640908229798}, "policy_reward_mean": {"agent_policy": 7287.487637795528, "adversary_policy": 6084.860322782263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22799.310731565663, 5863.029314432721, 22421.946064048876, 19182.690131230527, 18665.250308129107, 19970.75945554655, 19843.374792474562, 19347.15517019897, 21598.75141846926, 19102.65322325493, 21809.140028057358, 19679.437759199354, 18792.216696630214, 20078.114193221987, 18493.889268242663, 18060.58754040856, 18842.44487981428, 19785.90485808598, 19840.64214547557, 18298.982627894435, 18134.180579865664, 18311.288307104754, 21297.235869603293, 18957.516135551243, 22833.015156905305, 19889.903099373405, 22254.154645264818, 21883.216380754322, 18102.094515682245, 23128.317400257583, 19866.89062563998, 22726.266801058566, 23199.68212148382, 18128.221790713673, 18596.223725623287, 18943.172287520923, 19641.224781650628, 3613.050934119357, 18885.7066641782, 18696.005171158235, 18857.135762877282, 18461.89346846055, 18889.345880212244, 18865.676667237494, 23645.699319312585, 20024.565243692825, 20619.883852503895, 19472.316227113282, 23082.102413051238, 19590.33862672166, 19175.485323027024, 19786.22073465578, 19367.56066159848, 19730.382029684588, 19860.675136393707, 245.72383597189219, 19439.60545922751, 18318.93771101234, 23986.044271851657, 18421.75112243051, 18724.35431161391, 18309.448010603544, 17613.64827268519, 19675.288092521332, 19023.05687041924, 18524.02154794746, 18562.245280325376, 19279.854884507346, 19348.39680263892, 24154.549610550814, 19761.123481908937, 620.7791123369336, 23524.634550076637, 24389.22882032328, 22318.351966060556, 19175.68193828508, 18286.13519114287, 20042.55237956146, 19439.471845168013, 19111.931148519307, 20818.591264657774, 18698.183025022518, 21340.890496702952, 19441.74207699972, 18702.263846060905, 19400.93313249772, 25105.261214150993, 19611.6758438386, 23913.16570149732, 25911.48622658405, 18338.95663763189, 21239.347694665106, 24052.815482100956, 18439.52486154583, 18330.80552179795, 22447.603769045934, 20666.93898948844, 18529.022741901594, 18581.414606602306, 22860.459739084854], "episode_lengths": [200, 53, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5277.972606216004, 967.4957928220067, 5318.35298677947, 8829.561674149467, 9258.909294425888, 8060.004868643689, 8085.247343555435, 8853.810055434036, 5485.272047098477, 8782.132165010253, 6362.690970455721, 8326.90525128646, 9296.082085032374, 8016.090897052208, 8324.138000166706, 9608.759902818649, 8784.783567479724, 8088.557069498678, 8079.671272884836, 8714.39284665087, 8393.686671854783, 9561.765300360763, 6235.645075318979, 8586.346077008695, 5338.949530870106, 7809.88711403547, 5653.245110645265, 5989.978979554519, 9397.851085807846, 5019.151428883186, 7468.3345671194165, 4531.458233252727, 4859.585202409826, 8854.124517918282, 8714.320596818416, 8540.799177000452, 7982.616264746424, 232.55573971149894, 9063.416496814525, 9119.511550917816, 9176.870500602496, 9133.34903371847, 8796.739756368966, 9053.094396862212, 4338.197051112641, 7861.62348132784, 7407.289424566403, 8605.560139328762, 4701.324079460797, 8199.716589715716, 8557.850727505496, 8323.37662850246, 8847.630693128578, 8010.760823679772, 8151.071429766251, 2.287515677807381, 8562.190573581294, 9279.943818652962, 3935.4257440078, 9653.282902715155, 9292.838882962333, 9513.555530547994, 10259.981696145975, 7896.541869951938, 8964.235449052221, 9551.217687747758, 9486.336555588645, 8768.426503290193, 8043.827326116832, 3864.102296725034, 7905.294836558743, 16.574333451115887, 4090.325092921025, 3385.9275135773287, 5438.602188224498, 8662.235571457495, 9916.61910119688, 7346.392001987835, 8115.6001519052, 8725.449785618737, 6121.7208259719555, 9387.545517435668, 6514.0068712060265, 6928.113924826238, 9039.812102089374, 8694.230035408053, 2833.5348588733054, 7682.46380351966, 3743.7248990509693, 2025.520942470253, 8716.926294580906, 6849.757371527797, 3489.2327803233693, 9273.174207672631, 9227.747480024356, 4802.286816637508, 7410.081182715247, 9350.355810961917, 8259.572767974521, 4683.22618246336], "policy_adversary_policy_reward": [8662.17418825043, 8859.163937099089, 2216.297413022102, 2679.2361085886096, 8304.711087879257, 8798.881989390324, 5087.317124088067, 5265.8113329930475, 4672.1366623971035, 4734.204351306186, 5831.754420666497, 6079.000166236407, 5853.5039864227765, 5904.623462496355, 5282.281420883293, 5211.063693881726, 7485.021288863846, 8628.458082506962, 4960.945890460162, 5359.575167784578, 7751.842847534637, 7694.606210066979, 5537.418937233835, 5815.113570679069, 4830.070901169252, 4666.063710428694, 5980.030953688251, 6081.992342481589, 5817.665520027415, 4352.085748048567, 4533.32253544145, 3918.5051021485942, 5348.189748086307, 4709.47156424834, 6047.488436138913, 5649.8593524484295, 6022.159197460733, 5738.811675130017, 5425.623600032086, 4158.966181211642, 5746.379557191649, 3994.1143508192617, 4170.498623410561, 4579.024383333469, 7731.545976559626, 7330.044817724612, 5550.737779453893, 4820.432279088752, 8766.422901862064, 8727.6427241731, 5806.653124660803, 6273.36286067716, 8120.141094727905, 8480.76843989161, 7997.84751187309, 7895.3898893267915, 3963.718718533915, 4740.524711340595, 9030.791073824541, 9078.37489754977, 6624.429614444981, 5774.126444075553, 8590.314865392986, 9604.493702412738, 9280.82615232713, 9059.270766746995, 3990.1861449967723, 5283.9111277986885, 5425.712216558364, 4456.190912246597, 4803.236366314433, 5599.136744206139, 5516.642569997031, 6141.965946907271, 1834.6682916805162, 1545.8269027273413, 5052.871641118077, 4769.418526245685, 4557.257213033975, 5019.23640720656, 4925.845005274785, 4754.420257000127, 4327.923217130109, 5000.6212176120725, 4749.483622460187, 5343.122501383202, 4727.19059532902, 5085.391675046337, 9620.522659815839, 9686.979608384061, 5963.150838767363, 6199.790923597671, 6619.870723333165, 6592.723704604207, 5475.480744079467, 5391.27534370515, 9227.437128005886, 9153.341205584518, 5940.318431955735, 5450.303605050186, 5317.252464078606, 5300.382131443011, 5694.684859426109, 5768.159246727234, 5285.819484836592, 5234.11048363332, 5588.246405953658, 6131.374800051192, 5977.855032388298, 5731.748674239199, 104.30247973458269, 139.13384055950212, 5298.620024518795, 5578.794861127495, 4177.956034239297, 4861.037858120202, 10200.487329643747, 9850.131198200044, 4281.962301982567, 4486.505917732922, 4634.961785499124, 4796.553643152568, 4607.731756603801, 4188.160723451911, 3473.5173138352957, 3880.14926270397, 6230.0428884410685, 5548.703334128376, 4898.468179650304, 5160.353241716776, 4573.776460253096, 4399.027399946716, 4432.442979391345, 4643.465745345496, 5157.813010145078, 5353.61537107219, 6098.30829761413, 5206.261178907984, 10269.025105563722, 10021.422208261905, 5619.679313214655, 6236.149332135565, 336.9790571421579, 267.2257217436599, 9492.010179824027, 9942.299277331591, 10651.960367955513, 10351.340938790448, 8205.539707169668, 8674.210070666333, 5040.37073307503, 5473.075633752632, 4221.228007646104, 4148.288082300012, 5908.566113075428, 6787.594264498289, 5814.132310984298, 5509.7393822785625, 5278.382457973687, 5108.098904926945, 7868.759974278439, 6828.110464407366, 4744.939729509091, 4565.6977780778625, 7204.344621098144, 7622.539004398911, 7213.925911287733, 5299.702240885711, 4572.089894642038, 5090.361849329587, 5342.489222670658, 5364.213874419088, 11029.089867654346, 11242.63648762347, 5469.8869284544835, 6459.325111864513, 10185.194554890828, 9984.246247555495, 11896.324375883925, 11989.640908229798, 4214.147785223973, 5407.882557827056, 7233.956454280704, 7155.633868856426, 10649.20988689374, 9914.372814883805, 4849.873143618758, 4316.477510254537, 4891.572469355326, 4211.485572418374, 8909.66000881923, 8735.656943589196, 6608.102019624746, 6648.7557871484405, 4405.476684022648, 4773.190246917129, 5869.894851947233, 4451.946986680625, 9442.055898003024, 8735.177658618657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39983837816049983, "mean_inference_ms": 0.9948888338307741, "mean_action_processing_ms": 0.16782924965062507, "mean_env_wait_ms": 0.05418971498645751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032820701599121094, "StateBufferConnector_ms": 0.0026799440383911133, "ViewRequirementAgentConnector_ms": 0.0706101655960083}, "num_episodes": 20, "episode_return_max": 25911.48622658405, "episode_return_min": 245.72383597189219, "episode_return_mean": 19457.20828336001}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.4706867271923, "num_env_steps_trained_throughput_per_sec": 525.4706867271923, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 7412.755, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7412.72, "sample_time_ms": 745.138, "learn_time_ms": 6656.619, "learn_throughput": 600.906, "synch_weights_time_ms": 10.568}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 100, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-25", "timestamp": 1723236145, "time_this_iter_s": 7.615796804428101, "time_total_s": 766.9568889141083, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 766.9568889141083, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 27.272727272727273, "ram_util_percent": 79.83636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7696.877665718523, "cur_kl_coeff": 34554.16350293753, "cur_lr": 5.0000000000000016e-05, "total_loss": 1342.8389495203735, "policy_loss": 0.026888328278683638, "vf_loss": 10.0, "vf_explained_var": 1.213058592781188e-05, "kl": 0.038571677190404406, "entropy": 0.9657852704878207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8522306880913675, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990290118257205, "policy_loss": -0.009468933835887584, "vf_loss": 9.991741594672202, "vf_explained_var": -0.0007688231766223907, "kl": 0.018769760968280026, "entropy": 1.352683287486434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "env_runners": {"episode_reward_max": 25911.48622658405, "episode_reward_min": 245.72383597189219, "episode_reward_mean": 19755.818951227164, "episode_len_mean": 192.87, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19287, "policy_reward_min": {"agent_policy": 2.287515677807381, "adversary_policy": 104.30247973458269}, "policy_reward_max": {"agent_policy": 11178.877768618197, "adversary_policy": 11989.640908229798}, "policy_reward_mean": {"agent_policy": 6954.95698895619, "adversary_policy": 6400.430981135506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18134.180579865664, 18311.288307104754, 21297.235869603293, 18957.516135551243, 22833.015156905305, 19889.903099373405, 22254.154645264818, 21883.216380754322, 18102.094515682245, 23128.317400257583, 19866.89062563998, 22726.266801058566, 23199.68212148382, 18128.221790713673, 18596.223725623287, 18943.172287520923, 19641.224781650628, 3613.050934119357, 18885.7066641782, 18696.005171158235, 18857.135762877282, 18461.89346846055, 18889.345880212244, 18865.676667237494, 23645.699319312585, 20024.565243692825, 20619.883852503895, 19472.316227113282, 23082.102413051238, 19590.33862672166, 19175.485323027024, 19786.22073465578, 19367.56066159848, 19730.382029684588, 19860.675136393707, 245.72383597189219, 19439.60545922751, 18318.93771101234, 23986.044271851657, 18421.75112243051, 18724.35431161391, 18309.448010603544, 17613.64827268519, 19675.288092521332, 19023.05687041924, 18524.02154794746, 18562.245280325376, 19279.854884507346, 19348.39680263892, 24154.549610550814, 19761.123481908937, 620.7791123369336, 23524.634550076637, 24389.22882032328, 22318.351966060556, 19175.68193828508, 18286.13519114287, 20042.55237956146, 19439.471845168013, 19111.931148519307, 20818.591264657774, 18698.183025022518, 21340.890496702952, 19441.74207699972, 18702.263846060905, 19400.93313249772, 25105.261214150993, 19611.6758438386, 23913.16570149732, 25911.48622658405, 18338.95663763189, 21239.347694665106, 24052.815482100956, 18439.52486154583, 18330.80552179795, 22447.603769045934, 20666.93898948844, 18529.022741901594, 18581.414606602306, 22860.459739084854, 22112.97578027501, 23923.865315183215, 21172.14765581358, 6197.200494680586, 18509.191929424556, 25391.971288189863, 18717.664452607507, 21316.73421698464, 25193.01668954071, 20401.993124412784, 20172.76999968541, 20338.990958720635, 17798.53295289676, 16948.433105613807, 24859.701460274395, 23173.08515255461, 23064.95872340249, 20480.62370909627, 24253.75577221588, 18309.73461152408], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8393.686671854783, 9561.765300360763, 6235.645075318979, 8586.346077008695, 5338.949530870106, 7809.88711403547, 5653.245110645265, 5989.978979554519, 9397.851085807846, 5019.151428883186, 7468.3345671194165, 4531.458233252727, 4859.585202409826, 8854.124517918282, 8714.320596818416, 8540.799177000452, 7982.616264746424, 232.55573971149894, 9063.416496814525, 9119.511550917816, 9176.870500602496, 9133.34903371847, 8796.739756368966, 9053.094396862212, 4338.197051112641, 7861.62348132784, 7407.289424566403, 8605.560139328762, 4701.324079460797, 8199.716589715716, 8557.850727505496, 8323.37662850246, 8847.630693128578, 8010.760823679772, 8151.071429766251, 2.287515677807381, 8562.190573581294, 9279.943818652962, 3935.4257440078, 9653.282902715155, 9292.838882962333, 9513.555530547994, 10259.981696145975, 7896.541869951938, 8964.235449052221, 9551.217687747758, 9486.336555588645, 8768.426503290193, 8043.827326116832, 3864.102296725034, 7905.294836558743, 16.574333451115887, 4090.325092921025, 3385.9275135773287, 5438.602188224498, 8662.235571457495, 9916.61910119688, 7346.392001987835, 8115.6001519052, 8725.449785618737, 6121.7208259719555, 9387.545517435668, 6514.0068712060265, 6928.113924826238, 9039.812102089374, 8694.230035408053, 2833.5348588733054, 7682.46380351966, 3743.7248990509693, 2025.520942470253, 8716.926294580906, 6849.757371527797, 3489.2327803233693, 9273.174207672631, 9227.747480024356, 4802.286816637508, 7410.081182715247, 9350.355810961917, 8259.572767974521, 4683.22618246336, 6008.857963895944, 3175.234201952952, 6451.719356210087, 415.01012212220644, 8931.979345146683, 2799.3753065724877, 8970.247793817387, 6258.409765278633, 2341.7778881881386, 7237.607765631033, 7501.706549635072, 7230.584131450646, 10233.834213012786, 11178.877768618197, 2808.5660324866117, 4798.205566006475, 4441.6837396092815, 7663.924877988691, 3414.689886429554, 7405.473539474342], "policy_adversary_policy_reward": [5746.379557191649, 3994.1143508192617, 4170.498623410561, 4579.024383333469, 7731.545976559626, 7330.044817724612, 5550.737779453893, 4820.432279088752, 8766.422901862064, 8727.6427241731, 5806.653124660803, 6273.36286067716, 8120.141094727905, 8480.76843989161, 7997.84751187309, 7895.3898893267915, 3963.718718533915, 4740.524711340595, 9030.791073824541, 9078.37489754977, 6624.429614444981, 5774.126444075553, 8590.314865392986, 9604.493702412738, 9280.82615232713, 9059.270766746995, 3990.1861449967723, 5283.9111277986885, 5425.712216558364, 4456.190912246597, 4803.236366314433, 5599.136744206139, 5516.642569997031, 6141.965946907271, 1834.6682916805162, 1545.8269027273413, 5052.871641118077, 4769.418526245685, 4557.257213033975, 5019.23640720656, 4925.845005274785, 4754.420257000127, 4327.923217130109, 5000.6212176120725, 4749.483622460187, 5343.122501383202, 4727.19059532902, 5085.391675046337, 9620.522659815839, 9686.979608384061, 5963.150838767363, 6199.790923597671, 6619.870723333165, 6592.723704604207, 5475.480744079467, 5391.27534370515, 9227.437128005886, 9153.341205584518, 5940.318431955735, 5450.303605050186, 5317.252464078606, 5300.382131443011, 5694.684859426109, 5768.159246727234, 5285.819484836592, 5234.11048363332, 5588.246405953658, 6131.374800051192, 5977.855032388298, 5731.748674239199, 104.30247973458269, 139.13384055950212, 5298.620024518795, 5578.794861127495, 4177.956034239297, 4861.037858120202, 10200.487329643747, 9850.131198200044, 4281.962301982567, 4486.505917732922, 4634.961785499124, 4796.553643152568, 4607.731756603801, 4188.160723451911, 3473.5173138352957, 3880.14926270397, 6230.0428884410685, 5548.703334128376, 4898.468179650304, 5160.353241716776, 4573.776460253096, 4399.027399946716, 4432.442979391345, 4643.465745345496, 5157.813010145078, 5353.61537107219, 6098.30829761413, 5206.261178907984, 10269.025105563722, 10021.422208261905, 5619.679313214655, 6236.149332135565, 336.9790571421579, 267.2257217436599, 9492.010179824027, 9942.299277331591, 10651.960367955513, 10351.340938790448, 8205.539707169668, 8674.210070666333, 5040.37073307503, 5473.075633752632, 4221.228007646104, 4148.288082300012, 5908.566113075428, 6787.594264498289, 5814.132310984298, 5509.7393822785625, 5278.382457973687, 5108.098904926945, 7868.759974278439, 6828.110464407366, 4744.939729509091, 4565.6977780778625, 7204.344621098144, 7622.539004398911, 7213.925911287733, 5299.702240885711, 4572.089894642038, 5090.361849329587, 5342.489222670658, 5364.213874419088, 11029.089867654346, 11242.63648762347, 5469.8869284544835, 6459.325111864513, 10185.194554890828, 9984.246247555495, 11896.324375883925, 11989.640908229798, 4214.147785223973, 5407.882557827056, 7233.956454280704, 7155.633868856426, 10649.20988689374, 9914.372814883805, 4849.873143618758, 4316.477510254537, 4891.572469355326, 4211.485572418374, 8909.66000881923, 8735.656943589196, 6608.102019624746, 6648.7557871484405, 4405.476684022648, 4773.190246917129, 5869.894851947233, 4451.946986680625, 9442.055898003024, 8735.177658618657, 8131.015158199285, 7973.102658179789, 10963.731523094166, 9784.899590136325, 7685.504229983758, 7034.924069619761, 3068.07557848865, 2714.114794069731, 4373.18342984858, 5204.029154429393, 11295.890618616693, 11296.705363000603, 5169.076865430695, 4578.339793359497, 7459.25655968105, 7599.067892024978, 11774.528964340261, 11076.70983701223, 6895.400338899901, 6268.985019881905, 6556.253817745087, 6114.809632305213, 6196.96006436642, 6911.446762903473, 3659.5085855865314, 3905.1901542975515, 2944.856650899395, 2824.698686096189, 11329.354393304873, 10721.78103448288, 9289.708716919882, 9085.170869628344, 8929.03772433302, 9694.237259460187, 6346.3489960775, 6470.349835029948, 10176.74364663724, 10662.322239149353, 4171.9342001970335, 6732.326871852727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39978920801705514, "mean_inference_ms": 0.9946223442449268, "mean_action_processing_ms": 0.16780502742708323, "mean_env_wait_ms": 0.05420339562391366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033060312271118164, "StateBufferConnector_ms": 0.0027403831481933594, "ViewRequirementAgentConnector_ms": 0.07180905342102051}, "num_episodes": 20, "episode_return_max": 25911.48622658405, "episode_return_min": 245.72383597189219, "episode_return_mean": 19755.818951227164}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.05901127715407, "num_env_steps_trained_throughput_per_sec": 510.05901127715407, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 7419.7, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7419.665, "sample_time_ms": 754.041, "learn_time_ms": 6654.671, "learn_throughput": 601.082, "synch_weights_time_ms": 10.559}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "training_iteration": 101, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-33", "timestamp": 1723236153, "time_this_iter_s": 7.846691131591797, "time_total_s": 774.8035800457001, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aa30d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 774.8035800457001, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 27.600000000000005, "ram_util_percent": 79.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11705.046094105232, "cur_kl_coeff": 51831.24525440628, "cur_lr": 5.0000000000000016e-05, "total_loss": 2037.3642471232743, "policy_loss": 0.038764438003168575, "vf_loss": 10.0, "vf_explained_var": 3.1042382830665225e-05, "kl": 0.039113963759509186, "entropy": 0.9691183398955714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8510377376961211, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.986832676331202, "policy_loss": -0.00668777670362033, "vf_loss": 9.986344161629678, "vf_explained_var": -0.0006882427881161372, "kl": 0.01680041215828775, "entropy": 1.337625076373418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 25911.48622658405, "episode_reward_min": 245.72383597189219, "episode_reward_mean": 19735.161432360946, "episode_len_mean": 191.44, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19144, "policy_reward_min": {"agent_policy": 2.287515677807381, "adversary_policy": 104.30247973458269}, "policy_reward_max": {"agent_policy": 11178.877768618197, "adversary_policy": 11989.640908229798}, "policy_reward_mean": {"agent_policy": 6771.147996704863, "adversary_policy": 6482.006717828057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18461.89346846055, 18889.345880212244, 18865.676667237494, 23645.699319312585, 20024.565243692825, 20619.883852503895, 19472.316227113282, 23082.102413051238, 19590.33862672166, 19175.485323027024, 19786.22073465578, 19367.56066159848, 19730.382029684588, 19860.675136393707, 245.72383597189219, 19439.60545922751, 18318.93771101234, 23986.044271851657, 18421.75112243051, 18724.35431161391, 18309.448010603544, 17613.64827268519, 19675.288092521332, 19023.05687041924, 18524.02154794746, 18562.245280325376, 19279.854884507346, 19348.39680263892, 24154.549610550814, 19761.123481908937, 620.7791123369336, 23524.634550076637, 24389.22882032328, 22318.351966060556, 19175.68193828508, 18286.13519114287, 20042.55237956146, 19439.471845168013, 19111.931148519307, 20818.591264657774, 18698.183025022518, 21340.890496702952, 19441.74207699972, 18702.263846060905, 19400.93313249772, 25105.261214150993, 19611.6758438386, 23913.16570149732, 25911.48622658405, 18338.95663763189, 21239.347694665106, 24052.815482100956, 18439.52486154583, 18330.80552179795, 22447.603769045934, 20666.93898948844, 18529.022741901594, 18581.414606602306, 22860.459739084854, 22112.97578027501, 23923.865315183215, 21172.14765581358, 6197.200494680586, 18509.191929424556, 25391.971288189863, 18717.664452607507, 21316.73421698464, 25193.01668954071, 20401.993124412784, 20172.76999968541, 20338.990958720635, 17798.53295289676, 16948.433105613807, 24859.701460274395, 23173.08515255461, 23064.95872340249, 20480.62370909627, 24253.75577221588, 18309.73461152408, 18332.951066447436, 19409.388012443833, 19261.27212654285, 21186.10041794192, 7034.7975184503, 19694.499647588447, 18582.144617508195, 21488.198248640696, 20266.626287505343, 19163.653943496272, 21747.438224327347, 21190.005639268617, 19898.356063206465, 3542.3320021401623, 18677.40752985254, 23816.756135288022, 21381.34881225342, 19240.525323931095, 24339.462282353452, 21742.430558686097, 23883.05641189229], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9133.34903371847, 8796.739756368966, 9053.094396862212, 4338.197051112641, 7861.62348132784, 7407.289424566403, 8605.560139328762, 4701.324079460797, 8199.716589715716, 8557.850727505496, 8323.37662850246, 8847.630693128578, 8010.760823679772, 8151.071429766251, 2.287515677807381, 8562.190573581294, 9279.943818652962, 3935.4257440078, 9653.282902715155, 9292.838882962333, 9513.555530547994, 10259.981696145975, 7896.541869951938, 8964.235449052221, 9551.217687747758, 9486.336555588645, 8768.426503290193, 8043.827326116832, 3864.102296725034, 7905.294836558743, 16.574333451115887, 4090.325092921025, 3385.9275135773287, 5438.602188224498, 8662.235571457495, 9916.61910119688, 7346.392001987835, 8115.6001519052, 8725.449785618737, 6121.7208259719555, 9387.545517435668, 6514.0068712060265, 6928.113924826238, 9039.812102089374, 8694.230035408053, 2833.5348588733054, 7682.46380351966, 3743.7248990509693, 2025.520942470253, 8716.926294580906, 6849.757371527797, 3489.2327803233693, 9273.174207672631, 9227.747480024356, 4802.286816637508, 7410.081182715247, 9350.355810961917, 8259.572767974521, 4683.22618246336, 6008.857963895944, 3175.234201952952, 6451.719356210087, 415.01012212220644, 8931.979345146683, 2799.3753065724877, 8970.247793817387, 6258.409765278633, 2341.7778881881386, 7237.607765631033, 7501.706549635072, 7230.584131450646, 10233.834213012786, 11178.877768618197, 2808.5660324866117, 4798.205566006475, 4441.6837396092815, 7663.924877988691, 3414.689886429554, 7405.473539474342, 8746.688147175073, 8696.878279261655, 8469.133543367016, 6640.218060968261, 527.8150410644462, 8209.571408485179, 9198.921166976666, 6063.964938134017, 7737.11353248733, 7947.718177392203, 6175.417564759266, 6889.154305209559, 7654.058780023644, 387.13835090407684, 8160.821467051018, 3905.0139561108513, 5532.520783972592, 8430.96649377414, 2724.0208503670256, 6049.981705780275, 4002.083443254585], "policy_adversary_policy_reward": [4327.923217130109, 5000.6212176120725, 4749.483622460187, 5343.122501383202, 4727.19059532902, 5085.391675046337, 9620.522659815839, 9686.979608384061, 5963.150838767363, 6199.790923597671, 6619.870723333165, 6592.723704604207, 5475.480744079467, 5391.27534370515, 9227.437128005886, 9153.341205584518, 5940.318431955735, 5450.303605050186, 5317.252464078606, 5300.382131443011, 5694.684859426109, 5768.159246727234, 5285.819484836592, 5234.11048363332, 5588.246405953658, 6131.374800051192, 5977.855032388298, 5731.748674239199, 104.30247973458269, 139.13384055950212, 5298.620024518795, 5578.794861127495, 4177.956034239297, 4861.037858120202, 10200.487329643747, 9850.131198200044, 4281.962301982567, 4486.505917732922, 4634.961785499124, 4796.553643152568, 4607.731756603801, 4188.160723451911, 3473.5173138352957, 3880.14926270397, 6230.0428884410685, 5548.703334128376, 4898.468179650304, 5160.353241716776, 4573.776460253096, 4399.027399946716, 4432.442979391345, 4643.465745345496, 5157.813010145078, 5353.61537107219, 6098.30829761413, 5206.261178907984, 10269.025105563722, 10021.422208261905, 5619.679313214655, 6236.149332135565, 336.9790571421579, 267.2257217436599, 9492.010179824027, 9942.299277331591, 10651.960367955513, 10351.340938790448, 8205.539707169668, 8674.210070666333, 5040.37073307503, 5473.075633752632, 4221.228007646104, 4148.288082300012, 5908.566113075428, 6787.594264498289, 5814.132310984298, 5509.7393822785625, 5278.382457973687, 5108.098904926945, 7868.759974278439, 6828.110464407366, 4744.939729509091, 4565.6977780778625, 7204.344621098144, 7622.539004398911, 7213.925911287733, 5299.702240885711, 4572.089894642038, 5090.361849329587, 5342.489222670658, 5364.213874419088, 11029.089867654346, 11242.63648762347, 5469.8869284544835, 6459.325111864513, 10185.194554890828, 9984.246247555495, 11896.324375883925, 11989.640908229798, 4214.147785223973, 5407.882557827056, 7233.956454280704, 7155.633868856426, 10649.20988689374, 9914.372814883805, 4849.873143618758, 4316.477510254537, 4891.572469355326, 4211.485572418374, 8909.66000881923, 8735.656943589196, 6608.102019624746, 6648.7557871484405, 4405.476684022648, 4773.190246917129, 5869.894851947233, 4451.946986680625, 9442.055898003024, 8735.177658618657, 8131.015158199285, 7973.102658179789, 10963.731523094166, 9784.899590136325, 7685.504229983758, 7034.924069619761, 3068.07557848865, 2714.114794069731, 4373.18342984858, 5204.029154429393, 11295.890618616693, 11296.705363000603, 5169.076865430695, 4578.339793359497, 7459.25655968105, 7599.067892024978, 11774.528964340261, 11076.70983701223, 6895.400338899901, 6268.985019881905, 6556.253817745087, 6114.809632305213, 6196.96006436642, 6911.446762903473, 3659.5085855865314, 3905.1901542975515, 2944.856650899395, 2824.698686096189, 11329.354393304873, 10721.78103448288, 9289.708716919882, 9085.170869628344, 8929.03772433302, 9694.237259460187, 6346.3489960775, 6470.349835029948, 10176.74364663724, 10662.322239149353, 4171.9342001970335, 6732.326871852727, 4192.591112640927, 5393.671806631427, 5314.1458353233575, 5398.363897858873, 5209.291597335222, 5582.846985840722, 7489.999949495191, 7055.882407478376, 3156.287489619344, 3350.6949877665147, 5926.374393855689, 5558.55384524764, 4441.930178913262, 4941.293271618354, 7745.756413739321, 7678.47689676737, 6200.808288015299, 6328.70446700265, 5033.141329167489, 6182.794436936594, 7928.277163963968, 7643.74349560412, 7066.5444848402885, 7234.306849218716, 6481.406274674399, 5762.89100850839, 1541.1927965936065, 1614.0008546424813, 5978.883510926752, 4537.702551874791, 10225.447429136486, 9686.29475004075, 7243.539538813384, 8605.288489467475, 5710.307331860803, 5099.2514982961375, 10635.166140175976, 10980.275291810382, 8090.032336429964, 7602.41651647588, 10001.69412203784, 9879.278846599851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997538958881698, "mean_inference_ms": 0.9944539513343266, "mean_action_processing_ms": 0.16771657041742444, "mean_env_wait_ms": 0.05421849459875288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032542943954467773, "StateBufferConnector_ms": 0.0027028322219848633, "ViewRequirementAgentConnector_ms": 0.07137572765350342}, "num_episodes": 21, "episode_return_max": 25911.48622658405, "episode_return_min": 245.72383597189219, "episode_return_mean": 19735.161432360946}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.7550176697957, "num_env_steps_trained_throughput_per_sec": 553.7550176697957, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 7408.259, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7408.223, "sample_time_ms": 749.295, "learn_time_ms": 6648.201, "learn_throughput": 601.667, "synch_weights_time_ms": 10.325}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 102, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-40", "timestamp": 1723236160, "time_this_iter_s": 7.2270190715789795, "time_total_s": 782.030599117279, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e9b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 782.030599117279, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 24.830000000000002, "ram_util_percent": 80.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15444.823552901657, "cur_kl_coeff": 77746.86788160945, "cur_lr": 5.0000000000000016e-05, "total_loss": 2497.7896751444177, "policy_loss": 0.03280098243756959, "vf_loss": 10.0, "vf_explained_var": -7.879418670815766e-06, "kl": 0.031998162217950696, "entropy": 0.9849489511005463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8100036605882148, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005793128410975, "policy_loss": -0.0017678660301802059, "vf_loss": 10.0, "vf_explained_var": -0.0006380518277486166, "kl": 0.01770114960090723, "entropy": 1.315878584732612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "env_runners": {"episode_reward_max": 25911.48622658405, "episode_reward_min": 620.7791123369336, "episode_reward_mean": 20094.10324321647, "episode_len_mean": 193.42, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19342, "policy_reward_min": {"agent_policy": 16.574333451115887, "adversary_policy": 267.2257217436599}, "policy_reward_max": {"agent_policy": 11178.877768618197, "adversary_policy": 11989.640908229798}, "policy_reward_mean": {"agent_policy": 6644.346586912279, "adversary_policy": 6724.878328152113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18309.448010603544, 17613.64827268519, 19675.288092521332, 19023.05687041924, 18524.02154794746, 18562.245280325376, 19279.854884507346, 19348.39680263892, 24154.549610550814, 19761.123481908937, 620.7791123369336, 23524.634550076637, 24389.22882032328, 22318.351966060556, 19175.68193828508, 18286.13519114287, 20042.55237956146, 19439.471845168013, 19111.931148519307, 20818.591264657774, 18698.183025022518, 21340.890496702952, 19441.74207699972, 18702.263846060905, 19400.93313249772, 25105.261214150993, 19611.6758438386, 23913.16570149732, 25911.48622658405, 18338.95663763189, 21239.347694665106, 24052.815482100956, 18439.52486154583, 18330.80552179795, 22447.603769045934, 20666.93898948844, 18529.022741901594, 18581.414606602306, 22860.459739084854, 22112.97578027501, 23923.865315183215, 21172.14765581358, 6197.200494680586, 18509.191929424556, 25391.971288189863, 18717.664452607507, 21316.73421698464, 25193.01668954071, 20401.993124412784, 20172.76999968541, 20338.990958720635, 17798.53295289676, 16948.433105613807, 24859.701460274395, 23173.08515255461, 23064.95872340249, 20480.62370909627, 24253.75577221588, 18309.73461152408, 18332.951066447436, 19409.388012443833, 19261.27212654285, 21186.10041794192, 7034.7975184503, 19694.499647588447, 18582.144617508195, 21488.198248640696, 20266.626287505343, 19163.653943496272, 21747.438224327347, 21190.005639268617, 19898.356063206465, 3542.3320021401623, 18677.40752985254, 23816.756135288022, 21381.34881225342, 19240.525323931095, 24339.462282353452, 21742.430558686097, 23883.05641189229, 25147.750494694188, 20850.610499167535, 19668.29989159241, 18689.671737636854, 20089.229524917955, 21439.84693979054, 20992.412996413193, 21409.31808268659, 18445.76400599198, 18754.65964628287, 23538.63050856559, 21189.47950647531, 20087.623027314916, 23167.716183415465, 18403.23388012904, 21436.552254029557, 18475.250205577348, 19720.23075678959, 20233.837486305325, 23862.625753549422], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9513.555530547994, 10259.981696145975, 7896.541869951938, 8964.235449052221, 9551.217687747758, 9486.336555588645, 8768.426503290193, 8043.827326116832, 3864.102296725034, 7905.294836558743, 16.574333451115887, 4090.325092921025, 3385.9275135773287, 5438.602188224498, 8662.235571457495, 9916.61910119688, 7346.392001987835, 8115.6001519052, 8725.449785618737, 6121.7208259719555, 9387.545517435668, 6514.0068712060265, 6928.113924826238, 9039.812102089374, 8694.230035408053, 2833.5348588733054, 7682.46380351966, 3743.7248990509693, 2025.520942470253, 8716.926294580906, 6849.757371527797, 3489.2327803233693, 9273.174207672631, 9227.747480024356, 4802.286816637508, 7410.081182715247, 9350.355810961917, 8259.572767974521, 4683.22618246336, 6008.857963895944, 3175.234201952952, 6451.719356210087, 415.01012212220644, 8931.979345146683, 2799.3753065724877, 8970.247793817387, 6258.409765278633, 2341.7778881881386, 7237.607765631033, 7501.706549635072, 7230.584131450646, 10233.834213012786, 11178.877768618197, 2808.5660324866117, 4798.205566006475, 4441.6837396092815, 7663.924877988691, 3414.689886429554, 7405.473539474342, 8746.688147175073, 8696.878279261655, 8469.133543367016, 6640.218060968261, 527.8150410644462, 8209.571408485179, 9198.921166976666, 6063.964938134017, 7737.11353248733, 7947.718177392203, 6175.417564759266, 6889.154305209559, 7654.058780023644, 387.13835090407684, 8160.821467051018, 3905.0139561108513, 5532.520783972592, 8430.96649377414, 2724.0208503670256, 6049.981705780275, 4002.083443254585, 2910.4499819084544, 7045.045665273547, 8279.864355526313, 8779.80161395887, 7948.026210036616, 5512.088200899445, 6719.089710932389, 6432.930142193065, 9294.240638647669, 9112.962844745332, 4149.81297968315, 6616.358347623832, 6975.248852185692, 4612.4745850146455, 9256.223845898408, 6346.746219647973, 9078.567234215803, 7674.433003657196, 7615.642088751898, 3673.4061925830265], "policy_adversary_policy_reward": [4607.731756603801, 4188.160723451911, 3473.5173138352957, 3880.14926270397, 6230.0428884410685, 5548.703334128376, 4898.468179650304, 5160.353241716776, 4573.776460253096, 4399.027399946716, 4432.442979391345, 4643.465745345496, 5157.813010145078, 5353.61537107219, 6098.30829761413, 5206.261178907984, 10269.025105563722, 10021.422208261905, 5619.679313214655, 6236.149332135565, 336.9790571421579, 267.2257217436599, 9492.010179824027, 9942.299277331591, 10651.960367955513, 10351.340938790448, 8205.539707169668, 8674.210070666333, 5040.37073307503, 5473.075633752632, 4221.228007646104, 4148.288082300012, 5908.566113075428, 6787.594264498289, 5814.132310984298, 5509.7393822785625, 5278.382457973687, 5108.098904926945, 7868.759974278439, 6828.110464407366, 4744.939729509091, 4565.6977780778625, 7204.344621098144, 7622.539004398911, 7213.925911287733, 5299.702240885711, 4572.089894642038, 5090.361849329587, 5342.489222670658, 5364.213874419088, 11029.089867654346, 11242.63648762347, 5469.8869284544835, 6459.325111864513, 10185.194554890828, 9984.246247555495, 11896.324375883925, 11989.640908229798, 4214.147785223973, 5407.882557827056, 7233.956454280704, 7155.633868856426, 10649.20988689374, 9914.372814883805, 4849.873143618758, 4316.477510254537, 4891.572469355326, 4211.485572418374, 8909.66000881923, 8735.656943589196, 6608.102019624746, 6648.7557871484405, 4405.476684022648, 4773.190246917129, 5869.894851947233, 4451.946986680625, 9442.055898003024, 8735.177658618657, 8131.015158199285, 7973.102658179789, 10963.731523094166, 9784.899590136325, 7685.504229983758, 7034.924069619761, 3068.07557848865, 2714.114794069731, 4373.18342984858, 5204.029154429393, 11295.890618616693, 11296.705363000603, 5169.076865430695, 4578.339793359497, 7459.25655968105, 7599.067892024978, 11774.528964340261, 11076.70983701223, 6895.400338899901, 6268.985019881905, 6556.253817745087, 6114.809632305213, 6196.96006436642, 6911.446762903473, 3659.5085855865314, 3905.1901542975515, 2944.856650899395, 2824.698686096189, 11329.354393304873, 10721.78103448288, 9289.708716919882, 9085.170869628344, 8929.03772433302, 9694.237259460187, 6346.3489960775, 6470.349835029948, 10176.74364663724, 10662.322239149353, 4171.9342001970335, 6732.326871852727, 4192.591112640927, 5393.671806631427, 5314.1458353233575, 5398.363897858873, 5209.291597335222, 5582.846985840722, 7489.999949495191, 7055.882407478376, 3156.287489619344, 3350.6949877665147, 5926.374393855689, 5558.55384524764, 4441.930178913262, 4941.293271618354, 7745.756413739321, 7678.47689676737, 6200.808288015299, 6328.70446700265, 5033.141329167489, 6182.794436936594, 7928.277163963968, 7643.74349560412, 7066.5444848402885, 7234.306849218716, 6481.406274674399, 5762.89100850839, 1541.1927965936065, 1614.0008546424813, 5978.883510926752, 4537.702551874791, 10225.447429136486, 9686.29475004075, 7243.539538813384, 8605.288489467475, 5710.307331860803, 5099.2514982961375, 10635.166140175976, 10980.275291810382, 8090.032336429964, 7602.41651647588, 10001.69412203784, 9879.278846599851, 11026.428361903818, 11210.872150882053, 6965.064860744638, 6840.499973149469, 5548.733665860417, 5839.7018702056985, 4552.549900832654, 5357.320222845427, 6187.228126316286, 5953.975188565044, 7408.202434785144, 8519.556304105927, 6927.302216962528, 7346.021068518286, 7366.618121974265, 7609.76981851926, 4390.377389479451, 4761.145977864981, 4698.640078612739, 4943.056722924899, 9555.027001207629, 9833.790527674855, 7516.475360250257, 7056.645798601281, 7126.698000875449, 5985.676174253881, 9062.330442812838, 9492.911155588037, 4265.095413819694, 4881.91462041099, 7790.288300912611, 7299.517733468975, 5059.283191552472, 4337.399779809178, 5580.297005556465, 6465.500747575986, 6376.141309141491, 6242.054088411969, 9981.40021810547, 10207.819342860841]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997505747337199, "mean_inference_ms": 0.9943833730541334, "mean_action_processing_ms": 0.16772707486820426, "mean_env_wait_ms": 0.054197983858436716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531813621520996, "StateBufferConnector_ms": 0.0026913881301879883, "ViewRequirementAgentConnector_ms": 0.0749887228012085}, "num_episodes": 20, "episode_return_max": 25911.48622658405, "episode_return_min": 620.7791123369336, "episode_return_mean": 20094.10324321647}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.3160270488087, "num_env_steps_trained_throughput_per_sec": 525.3160270488087, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 7442.225, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7442.189, "sample_time_ms": 760.562, "learn_time_ms": 6670.632, "learn_throughput": 599.643, "synch_weights_time_ms": 10.551}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "training_iteration": 103, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-48", "timestamp": 1723236168, "time_this_iter_s": 7.619189023971558, "time_total_s": 789.6497881412506, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aa3310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 789.6497881412506, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 26.44545454545455, "ram_util_percent": 80.05454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26996.374566230574, "cur_kl_coeff": 116620.30182241417, "cur_lr": 5.0000000000000016e-05, "total_loss": 5645.227936340009, "policy_loss": 0.03759359774603533, "vf_loss": 10.0, "vf_explained_var": 2.5725869274643992e-06, "kl": 0.04832083363105696, "entropy": 0.992593992418713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7761959420206647, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002934682369233, "policy_loss": -0.003073912461695727, "vf_loss": 10.0, "vf_explained_var": -0.0007419504225254058, "kl": 0.014066901320863206, "entropy": 1.2480341958502927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 25911.48622658405, "episode_reward_min": 3542.3320021401623, "episode_reward_mean": 20423.804564907474, "episode_len_mean": 195.37, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19537, "policy_reward_min": {"agent_policy": 387.13835090407684, "adversary_policy": 1541.1927965936065}, "policy_reward_max": {"agent_policy": 11178.877768618197, "adversary_policy": 11989.640908229798}, "policy_reward_mean": {"agent_policy": 6548.616072732381, "adversary_policy": 6937.594246087562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21340.890496702952, 19441.74207699972, 18702.263846060905, 19400.93313249772, 25105.261214150993, 19611.6758438386, 23913.16570149732, 25911.48622658405, 18338.95663763189, 21239.347694665106, 24052.815482100956, 18439.52486154583, 18330.80552179795, 22447.603769045934, 20666.93898948844, 18529.022741901594, 18581.414606602306, 22860.459739084854, 22112.97578027501, 23923.865315183215, 21172.14765581358, 6197.200494680586, 18509.191929424556, 25391.971288189863, 18717.664452607507, 21316.73421698464, 25193.01668954071, 20401.993124412784, 20172.76999968541, 20338.990958720635, 17798.53295289676, 16948.433105613807, 24859.701460274395, 23173.08515255461, 23064.95872340249, 20480.62370909627, 24253.75577221588, 18309.73461152408, 18332.951066447436, 19409.388012443833, 19261.27212654285, 21186.10041794192, 7034.7975184503, 19694.499647588447, 18582.144617508195, 21488.198248640696, 20266.626287505343, 19163.653943496272, 21747.438224327347, 21190.005639268617, 19898.356063206465, 3542.3320021401623, 18677.40752985254, 23816.756135288022, 21381.34881225342, 19240.525323931095, 24339.462282353452, 21742.430558686097, 23883.05641189229, 25147.750494694188, 20850.610499167535, 19668.29989159241, 18689.671737636854, 20089.229524917955, 21439.84693979054, 20992.412996413193, 21409.31808268659, 18445.76400599198, 18754.65964628287, 23538.63050856559, 21189.47950647531, 20087.623027314916, 23167.716183415465, 18403.23388012904, 21436.552254029557, 18475.250205577348, 19720.23075678959, 20233.837486305325, 23862.625753549422, 18630.59578174491, 22640.56412167677, 20546.495585803696, 19963.71198600272, 18889.848825066685, 19569.35573990171, 20773.81460346455, 23069.472536110774, 19556.238201279433, 23250.106619261467, 19203.27251106609, 22998.540596391926, 19273.808600767785, 20562.582580481914, 22029.117871991162, 22712.809785639798, 18616.57186935662, 18652.041243986034, 17956.338858135143, 23749.956894251674, 21002.061451982197], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6514.0068712060265, 6928.113924826238, 9039.812102089374, 8694.230035408053, 2833.5348588733054, 7682.46380351966, 3743.7248990509693, 2025.520942470253, 8716.926294580906, 6849.757371527797, 3489.2327803233693, 9273.174207672631, 9227.747480024356, 4802.286816637508, 7410.081182715247, 9350.355810961917, 8259.572767974521, 4683.22618246336, 6008.857963895944, 3175.234201952952, 6451.719356210087, 415.01012212220644, 8931.979345146683, 2799.3753065724877, 8970.247793817387, 6258.409765278633, 2341.7778881881386, 7237.607765631033, 7501.706549635072, 7230.584131450646, 10233.834213012786, 11178.877768618197, 2808.5660324866117, 4798.205566006475, 4441.6837396092815, 7663.924877988691, 3414.689886429554, 7405.473539474342, 8746.688147175073, 8696.878279261655, 8469.133543367016, 6640.218060968261, 527.8150410644462, 8209.571408485179, 9198.921166976666, 6063.964938134017, 7737.11353248733, 7947.718177392203, 6175.417564759266, 6889.154305209559, 7654.058780023644, 387.13835090407684, 8160.821467051018, 3905.0139561108513, 5532.520783972592, 8430.96649377414, 2724.0208503670256, 6049.981705780275, 4002.083443254585, 2910.4499819084544, 7045.045665273547, 8279.864355526313, 8779.80161395887, 7948.026210036616, 5512.088200899445, 6719.089710932389, 6432.930142193065, 9294.240638647669, 9112.962844745332, 4149.81297968315, 6616.358347623832, 6975.248852185692, 4612.4745850146455, 9256.223845898408, 6346.746219647973, 9078.567234215803, 7674.433003657196, 7615.642088751898, 3673.4061925830265, 9253.411886446747, 5437.469012023678, 7190.027010564362, 7859.153826046853, 9071.119083241188, 7715.544021303268, 6869.272654694965, 4923.57125949685, 8275.517229769031, 3675.140421544338, 8729.466911453696, 4291.400875747114, 8920.2013914205, 7271.814047636039, 5905.822080991176, 4208.927209427917, 8556.562379884801, 9480.31174248597, 7986.243217665, 3857.4866230836105, 6408.997532556104], "policy_adversary_policy_reward": [7204.344621098144, 7622.539004398911, 7213.925911287733, 5299.702240885711, 4572.089894642038, 5090.361849329587, 5342.489222670658, 5364.213874419088, 11029.089867654346, 11242.63648762347, 5469.8869284544835, 6459.325111864513, 10185.194554890828, 9984.246247555495, 11896.324375883925, 11989.640908229798, 4214.147785223973, 5407.882557827056, 7233.956454280704, 7155.633868856426, 10649.20988689374, 9914.372814883805, 4849.873143618758, 4316.477510254537, 4891.572469355326, 4211.485572418374, 8909.66000881923, 8735.656943589196, 6608.102019624746, 6648.7557871484405, 4405.476684022648, 4773.190246917129, 5869.894851947233, 4451.946986680625, 9442.055898003024, 8735.177658618657, 8131.015158199285, 7973.102658179789, 10963.731523094166, 9784.899590136325, 7685.504229983758, 7034.924069619761, 3068.07557848865, 2714.114794069731, 4373.18342984858, 5204.029154429393, 11295.890618616693, 11296.705363000603, 5169.076865430695, 4578.339793359497, 7459.25655968105, 7599.067892024978, 11774.528964340261, 11076.70983701223, 6895.400338899901, 6268.985019881905, 6556.253817745087, 6114.809632305213, 6196.96006436642, 6911.446762903473, 3659.5085855865314, 3905.1901542975515, 2944.856650899395, 2824.698686096189, 11329.354393304873, 10721.78103448288, 9289.708716919882, 9085.170869628344, 8929.03772433302, 9694.237259460187, 6346.3489960775, 6470.349835029948, 10176.74364663724, 10662.322239149353, 4171.9342001970335, 6732.326871852727, 4192.591112640927, 5393.671806631427, 5314.1458353233575, 5398.363897858873, 5209.291597335222, 5582.846985840722, 7489.999949495191, 7055.882407478376, 3156.287489619344, 3350.6949877665147, 5926.374393855689, 5558.55384524764, 4441.930178913262, 4941.293271618354, 7745.756413739321, 7678.47689676737, 6200.808288015299, 6328.70446700265, 5033.141329167489, 6182.794436936594, 7928.277163963968, 7643.74349560412, 7066.5444848402885, 7234.306849218716, 6481.406274674399, 5762.89100850839, 1541.1927965936065, 1614.0008546424813, 5978.883510926752, 4537.702551874791, 10225.447429136486, 9686.29475004075, 7243.539538813384, 8605.288489467475, 5710.307331860803, 5099.2514982961375, 10635.166140175976, 10980.275291810382, 8090.032336429964, 7602.41651647588, 10001.69412203784, 9879.278846599851, 11026.428361903818, 11210.872150882053, 6965.064860744638, 6840.499973149469, 5548.733665860417, 5839.7018702056985, 4552.549900832654, 5357.320222845427, 6187.228126316286, 5953.975188565044, 7408.202434785144, 8519.556304105927, 6927.302216962528, 7346.021068518286, 7366.618121974265, 7609.76981851926, 4390.377389479451, 4761.145977864981, 4698.640078612739, 4943.056722924899, 9555.027001207629, 9833.790527674855, 7516.475360250257, 7056.645798601281, 7126.698000875449, 5985.676174253881, 9062.330442812838, 9492.911155588037, 4265.095413819694, 4881.91462041099, 7790.288300912611, 7299.517733468975, 5059.283191552472, 4337.399779809178, 5580.297005556465, 6465.500747575986, 6376.141309141491, 6242.054088411969, 9981.40021810547, 10207.819342860841, 4496.541188008499, 4880.642707289647, 8534.80112290225, 8668.293986750945, 6939.900564275175, 6416.5680109640325, 5951.32693208562, 6153.231227870304, 4758.5953488687255, 5060.134392956875, 5431.854000608808, 6421.957717989622, 6640.75426052539, 7263.787688244199, 8973.484278733911, 9172.416997880044, 5864.061157224167, 5416.659814286156, 9117.647472999743, 10457.318724717417, 5119.814226675746, 5353.991372936718, 9843.232256810099, 8863.907463834697, 5166.540404190948, 5187.0668051564535, 6862.0343573306245, 6428.734175515403, 8113.990593448959, 8009.305197551042, 9439.511205995515, 9064.3713702163, 5581.7253002763955, 4478.2841891954795, 4654.24442510227, 4517.485076397901, 6155.707744638183, 3814.3878958319974, 9872.23054593618, 10020.239725232057, 6872.663768005922, 7720.40015142017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996686805589112, "mean_inference_ms": 0.9940763599745169, "mean_action_processing_ms": 0.16774838379607027, "mean_env_wait_ms": 0.05414807682791763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037442445755004883, "StateBufferConnector_ms": 0.0025478601455688477, "ViewRequirementAgentConnector_ms": 0.07140696048736572}, "num_episodes": 21, "episode_return_max": 25911.48622658405, "episode_return_min": 3542.3320021401623, "episode_return_mean": 20423.804564907474}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.5722504131946, "num_env_steps_trained_throughput_per_sec": 550.5722504131946, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 7465.807, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7465.771, "sample_time_ms": 761.964, "learn_time_ms": 6692.568, "learn_throughput": 597.678, "synch_weights_time_ms": 10.799}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 104, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-42-55", "timestamp": 1723236175, "time_this_iter_s": 7.269734859466553, "time_total_s": 796.9195230007172, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aa3550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 796.9195230007172, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 24.436363636363637, "ram_util_percent": 80.15454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38434.623412763, "cur_kl_coeff": 174930.45273362132, "cur_lr": 5.0000000000000016e-05, "total_loss": 7325.710091727121, "policy_loss": 0.032110474684285545, "vf_loss": 10.0, "vf_explained_var": 5.305759490482391e-06, "kl": 0.0418204941501023, "entropy": 1.001983184095413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8000816159105549, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999755891164144, "policy_loss": -0.00405614634170585, "vf_loss": 10.0, "vf_explained_var": -0.0006417606025934219, "kl": 0.00892435856415735, "entropy": 1.1754587651540835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": 25391.971288189863, "episode_reward_min": 3542.3320021401623, "episode_reward_mean": 20445.049337070388, "episode_len_mean": 195.37, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19537, "policy_reward_min": {"agent_policy": 387.13835090407684, "adversary_policy": 1541.1927965936065}, "policy_reward_max": {"agent_policy": 11178.877768618197, "adversary_policy": 11774.528964340261}, "policy_reward_mean": {"agent_policy": 6545.049381161286, "adversary_policy": 6949.999977954563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23923.865315183215, 21172.14765581358, 6197.200494680586, 18509.191929424556, 25391.971288189863, 18717.664452607507, 21316.73421698464, 25193.01668954071, 20401.993124412784, 20172.76999968541, 20338.990958720635, 17798.53295289676, 16948.433105613807, 24859.701460274395, 23173.08515255461, 23064.95872340249, 20480.62370909627, 24253.75577221588, 18309.73461152408, 18332.951066447436, 19409.388012443833, 19261.27212654285, 21186.10041794192, 7034.7975184503, 19694.499647588447, 18582.144617508195, 21488.198248640696, 20266.626287505343, 19163.653943496272, 21747.438224327347, 21190.005639268617, 19898.356063206465, 3542.3320021401623, 18677.40752985254, 23816.756135288022, 21381.34881225342, 19240.525323931095, 24339.462282353452, 21742.430558686097, 23883.05641189229, 25147.750494694188, 20850.610499167535, 19668.29989159241, 18689.671737636854, 20089.229524917955, 21439.84693979054, 20992.412996413193, 21409.31808268659, 18445.76400599198, 18754.65964628287, 23538.63050856559, 21189.47950647531, 20087.623027314916, 23167.716183415465, 18403.23388012904, 21436.552254029557, 18475.250205577348, 19720.23075678959, 20233.837486305325, 23862.625753549422, 18630.59578174491, 22640.56412167677, 20546.495585803696, 19963.71198600272, 18889.848825066685, 19569.35573990171, 20773.81460346455, 23069.472536110774, 19556.238201279433, 23250.106619261467, 19203.27251106609, 22998.540596391926, 19273.808600767785, 20562.582580481914, 22029.117871991162, 22712.809785639798, 18616.57186935662, 18652.041243986034, 17956.338858135143, 23749.956894251674, 21002.061451982197, 18399.50048215961, 19336.462951458685, 22156.06066268635, 21485.37093375839, 22158.439926318428, 19782.047119398812, 18905.967639724535, 23978.006456483086, 24713.344273118262, 21253.68265094492, 25313.45186741547, 24554.32700661364, 23437.207113212986, 18530.84885882972, 20260.48293546034, 16930.551494187537, 22234.46243675461, 17082.997844817797, 20638.54892542016], "episode_lengths": [200, 200, 50, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3175.234201952952, 6451.719356210087, 415.01012212220644, 8931.979345146683, 2799.3753065724877, 8970.247793817387, 6258.409765278633, 2341.7778881881386, 7237.607765631033, 7501.706549635072, 7230.584131450646, 10233.834213012786, 11178.877768618197, 2808.5660324866117, 4798.205566006475, 4441.6837396092815, 7663.924877988691, 3414.689886429554, 7405.473539474342, 8746.688147175073, 8696.878279261655, 8469.133543367016, 6640.218060968261, 527.8150410644462, 8209.571408485179, 9198.921166976666, 6063.964938134017, 7737.11353248733, 7947.718177392203, 6175.417564759266, 6889.154305209559, 7654.058780023644, 387.13835090407684, 8160.821467051018, 3905.0139561108513, 5532.520783972592, 8430.96649377414, 2724.0208503670256, 6049.981705780275, 4002.083443254585, 2910.4499819084544, 7045.045665273547, 8279.864355526313, 8779.80161395887, 7948.026210036616, 5512.088200899445, 6719.089710932389, 6432.930142193065, 9294.240638647669, 9112.962844745332, 4149.81297968315, 6616.358347623832, 6975.248852185692, 4612.4745850146455, 9256.223845898408, 6346.746219647973, 9078.567234215803, 7674.433003657196, 7615.642088751898, 3673.4061925830265, 9253.411886446747, 5437.469012023678, 7190.027010564362, 7859.153826046853, 9071.119083241188, 7715.544021303268, 6869.272654694965, 4923.57125949685, 8275.517229769031, 3675.140421544338, 8729.466911453696, 4291.400875747114, 8920.2013914205, 7271.814047636039, 5905.822080991176, 4208.927209427917, 8556.562379884801, 9480.31174248597, 7986.243217665, 3857.4866230836105, 6408.997532556104, 7813.496103080212, 8613.715148570165, 5717.03196283074, 6103.952734040225, 5702.537985334114, 8292.117925928364, 8848.496323976346, 4092.44669592261, 3092.0442517331594, 6657.77153943113, 2709.350085309585, 3242.7621643156335, 4595.27308904745, 8836.813545029117, 7950.169701660388, 10294.124094898421, 5584.827067541675, 9487.780840580015, 7541.245879882424], "policy_adversary_policy_reward": [10963.731523094166, 9784.899590136325, 7685.504229983758, 7034.924069619761, 3068.07557848865, 2714.114794069731, 4373.18342984858, 5204.029154429393, 11295.890618616693, 11296.705363000603, 5169.076865430695, 4578.339793359497, 7459.25655968105, 7599.067892024978, 11774.528964340261, 11076.70983701223, 6895.400338899901, 6268.985019881905, 6556.253817745087, 6114.809632305213, 6196.96006436642, 6911.446762903473, 3659.5085855865314, 3905.1901542975515, 2944.856650899395, 2824.698686096189, 11329.354393304873, 10721.78103448288, 9289.708716919882, 9085.170869628344, 8929.03772433302, 9694.237259460187, 6346.3489960775, 6470.349835029948, 10176.74364663724, 10662.322239149353, 4171.9342001970335, 6732.326871852727, 4192.591112640927, 5393.671806631427, 5314.1458353233575, 5398.363897858873, 5209.291597335222, 5582.846985840722, 7489.999949495191, 7055.882407478376, 3156.287489619344, 3350.6949877665147, 5926.374393855689, 5558.55384524764, 4441.930178913262, 4941.293271618354, 7745.756413739321, 7678.47689676737, 6200.808288015299, 6328.70446700265, 5033.141329167489, 6182.794436936594, 7928.277163963968, 7643.74349560412, 7066.5444848402885, 7234.306849218716, 6481.406274674399, 5762.89100850839, 1541.1927965936065, 1614.0008546424813, 5978.883510926752, 4537.702551874791, 10225.447429136486, 9686.29475004075, 7243.539538813384, 8605.288489467475, 5710.307331860803, 5099.2514982961375, 10635.166140175976, 10980.275291810382, 8090.032336429964, 7602.41651647588, 10001.69412203784, 9879.278846599851, 11026.428361903818, 11210.872150882053, 6965.064860744638, 6840.499973149469, 5548.733665860417, 5839.7018702056985, 4552.549900832654, 5357.320222845427, 6187.228126316286, 5953.975188565044, 7408.202434785144, 8519.556304105927, 6927.302216962528, 7346.021068518286, 7366.618121974265, 7609.76981851926, 4390.377389479451, 4761.145977864981, 4698.640078612739, 4943.056722924899, 9555.027001207629, 9833.790527674855, 7516.475360250257, 7056.645798601281, 7126.698000875449, 5985.676174253881, 9062.330442812838, 9492.911155588037, 4265.095413819694, 4881.91462041099, 7790.288300912611, 7299.517733468975, 5059.283191552472, 4337.399779809178, 5580.297005556465, 6465.500747575986, 6376.141309141491, 6242.054088411969, 9981.40021810547, 10207.819342860841, 4496.541188008499, 4880.642707289647, 8534.80112290225, 8668.293986750945, 6939.900564275175, 6416.5680109640325, 5951.32693208562, 6153.231227870304, 4758.5953488687255, 5060.134392956875, 5431.854000608808, 6421.957717989622, 6640.75426052539, 7263.787688244199, 8973.484278733911, 9172.416997880044, 5864.061157224167, 5416.659814286156, 9117.647472999743, 10457.318724717417, 5119.814226675746, 5353.991372936718, 9843.232256810099, 8863.907463834697, 5166.540404190948, 5187.0668051564535, 6862.0343573306245, 6428.734175515403, 8113.990593448959, 8009.305197551042, 9439.511205995515, 9064.3713702163, 5581.7253002763955, 4478.2841891954795, 4654.24442510227, 4517.485076397901, 6155.707744638183, 3814.3878958319974, 9872.23054593618, 10020.239725232057, 6872.663768005922, 7720.40015142017, 4260.3961637776065, 6325.608215301752, 5199.606724230102, 5523.141078658417, 8361.360234090767, 8077.668465765128, 7374.48153105572, 8006.936668662508, 8437.640112782063, 8018.261828202361, 5835.694921327466, 5654.234272143014, 5291.867618881997, 4765.603696866298, 9959.338972663907, 9926.22078789655, 10700.22804400677, 10921.071977378222, 7121.014062711583, 7474.897048802115, 11193.776569928723, 11410.325212177082, 10860.294796885048, 10451.270045412806, 9537.638746768374, 9304.295277397108, 4391.484308133668, 5302.551005666882, 6128.2751725260605, 6182.03806127395, 3843.375497557504, 2793.051901731549, 8554.19186178959, 8095.44350742345, 2944.592000162259, 4650.625004075503, 6590.452949577896, 6506.850095959793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995558129314146, "mean_inference_ms": 0.9936533036719678, "mean_action_processing_ms": 0.16771362594718453, "mean_env_wait_ms": 0.05414552654492641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003700852394104004, "StateBufferConnector_ms": 0.0025249719619750977, "ViewRequirementAgentConnector_ms": 0.07150042057037354}, "num_episodes": 19, "episode_return_max": 25391.971288189863, "episode_return_min": 3542.3320021401623, "episode_return_mean": 20445.049337070388}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.6762699852337, "num_env_steps_trained_throughput_per_sec": 557.6762699852337, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 7446.599, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7446.563, "sample_time_ms": 760.512, "learn_time_ms": 6674.928, "learn_throughput": 599.257, "synch_weights_time_ms": 10.68}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 105, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-03", "timestamp": 1723236183, "time_this_iter_s": 7.17645788192749, "time_total_s": 804.0959808826447, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aa3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 804.0959808826447, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 24.42, "ram_util_percent": 80.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50116.35181154927, "cur_kl_coeff": 262395.6791004319, "cur_lr": 5.0000000000000016e-05, "total_loss": 9193.835262044271, "policy_loss": 0.03507392474489592, "vf_loss": 10.0, "vf_explained_var": 5.1703150310213606e-05, "kl": 0.03499981376524798, "entropy": 1.0053369547324207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7918035185430199, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988962151606877, "policy_loss": 0.0004095334297744557, "vf_loss": 9.985926345984142, "vf_explained_var": -0.0007892688115437826, "kl": 0.006148413290308478, "entropy": 1.142149209479491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 25313.45186741547, "episode_reward_min": 1484.3706683578534, "episode_reward_mean": 19916.278875494314, "episode_len_mean": 191.42, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19142, "policy_reward_min": {"agent_policy": 89.5733796680661, "adversary_policy": 565.1318528153415}, "policy_reward_max": {"agent_policy": 10294.124094898421, "adversary_policy": 11410.325212177082}, "policy_reward_mean": {"agent_policy": 6489.077698971307, "adversary_policy": 6713.600588261511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21186.10041794192, 7034.7975184503, 19694.499647588447, 18582.144617508195, 21488.198248640696, 20266.626287505343, 19163.653943496272, 21747.438224327347, 21190.005639268617, 19898.356063206465, 3542.3320021401623, 18677.40752985254, 23816.756135288022, 21381.34881225342, 19240.525323931095, 24339.462282353452, 21742.430558686097, 23883.05641189229, 25147.750494694188, 20850.610499167535, 19668.29989159241, 18689.671737636854, 20089.229524917955, 21439.84693979054, 20992.412996413193, 21409.31808268659, 18445.76400599198, 18754.65964628287, 23538.63050856559, 21189.47950647531, 20087.623027314916, 23167.716183415465, 18403.23388012904, 21436.552254029557, 18475.250205577348, 19720.23075678959, 20233.837486305325, 23862.625753549422, 18630.59578174491, 22640.56412167677, 20546.495585803696, 19963.71198600272, 18889.848825066685, 19569.35573990171, 20773.81460346455, 23069.472536110774, 19556.238201279433, 23250.106619261467, 19203.27251106609, 22998.540596391926, 19273.808600767785, 20562.582580481914, 22029.117871991162, 22712.809785639798, 18616.57186935662, 18652.041243986034, 17956.338858135143, 23749.956894251674, 21002.061451982197, 18399.50048215961, 19336.462951458685, 22156.06066268635, 21485.37093375839, 22158.439926318428, 19782.047119398812, 18905.967639724535, 23978.006456483086, 24713.344273118262, 21253.68265094492, 25313.45186741547, 24554.32700661364, 23437.207113212986, 18530.84885882972, 20260.48293546034, 16930.551494187537, 22234.46243675461, 17082.997844817797, 20638.54892542016, 18765.398255926026, 23914.228507846423, 19765.853464120923, 18232.187339434695, 21347.506177876996, 1852.7317414499742, 21857.888265680234, 17883.13302212668, 21470.62011667349, 24019.36373171049, 1484.3706683578534, 3311.5039719675597, 18396.345503697215, 21069.979928014916, 22186.467693052466, 20137.78595720948, 18328.93949516213, 23518.61657051199, 17532.398958938687, 20329.277875124742, 20278.893777743433, 18667.445638022422], "episode_lengths": [200, 58, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 13, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6640.218060968261, 527.8150410644462, 8209.571408485179, 9198.921166976666, 6063.964938134017, 7737.11353248733, 7947.718177392203, 6175.417564759266, 6889.154305209559, 7654.058780023644, 387.13835090407684, 8160.821467051018, 3905.0139561108513, 5532.520783972592, 8430.96649377414, 2724.0208503670256, 6049.981705780275, 4002.083443254585, 2910.4499819084544, 7045.045665273547, 8279.864355526313, 8779.80161395887, 7948.026210036616, 5512.088200899445, 6719.089710932389, 6432.930142193065, 9294.240638647669, 9112.962844745332, 4149.81297968315, 6616.358347623832, 6975.248852185692, 4612.4745850146455, 9256.223845898408, 6346.746219647973, 9078.567234215803, 7674.433003657196, 7615.642088751898, 3673.4061925830265, 9253.411886446747, 5437.469012023678, 7190.027010564362, 7859.153826046853, 9071.119083241188, 7715.544021303268, 6869.272654694965, 4923.57125949685, 8275.517229769031, 3675.140421544338, 8729.466911453696, 4291.400875747114, 8920.2013914205, 7271.814047636039, 5905.822080991176, 4208.927209427917, 8556.562379884801, 9480.31174248597, 7986.243217665, 3857.4866230836105, 6408.997532556104, 7813.496103080212, 8613.715148570165, 5717.03196283074, 6103.952734040225, 5702.537985334114, 8292.117925928364, 8848.496323976346, 4092.44669592261, 3092.0442517331594, 6657.77153943113, 2709.350085309585, 3242.7621643156335, 4595.27308904745, 8836.813545029117, 7950.169701660388, 10294.124094898421, 5584.827067541675, 9487.780840580015, 7541.245879882424, 7756.928120881978, 3916.3437872873883, 7869.715667914571, 8678.520162241366, 6396.661041761251, 119.5859669457634, 5256.395845724577, 10130.407321776413, 6548.66520081902, 3641.3113632660547, 89.5733796680661, 370.9780677351848, 8755.084765421876, 6355.770214592381, 5833.828593558032, 6466.041447952945, 8936.558086335515, 3810.065815272972, 8657.839593721375, 7599.207419134077, 7684.412559834826, 8700.545178591592], "policy_adversary_policy_reward": [7489.999949495191, 7055.882407478376, 3156.287489619344, 3350.6949877665147, 5926.374393855689, 5558.55384524764, 4441.930178913262, 4941.293271618354, 7745.756413739321, 7678.47689676737, 6200.808288015299, 6328.70446700265, 5033.141329167489, 6182.794436936594, 7928.277163963968, 7643.74349560412, 7066.5444848402885, 7234.306849218716, 6481.406274674399, 5762.89100850839, 1541.1927965936065, 1614.0008546424813, 5978.883510926752, 4537.702551874791, 10225.447429136486, 9686.29475004075, 7243.539538813384, 8605.288489467475, 5710.307331860803, 5099.2514982961375, 10635.166140175976, 10980.275291810382, 8090.032336429964, 7602.41651647588, 10001.69412203784, 9879.278846599851, 11026.428361903818, 11210.872150882053, 6965.064860744638, 6840.499973149469, 5548.733665860417, 5839.7018702056985, 4552.549900832654, 5357.320222845427, 6187.228126316286, 5953.975188565044, 7408.202434785144, 8519.556304105927, 6927.302216962528, 7346.021068518286, 7366.618121974265, 7609.76981851926, 4390.377389479451, 4761.145977864981, 4698.640078612739, 4943.056722924899, 9555.027001207629, 9833.790527674855, 7516.475360250257, 7056.645798601281, 7126.698000875449, 5985.676174253881, 9062.330442812838, 9492.911155588037, 4265.095413819694, 4881.91462041099, 7790.288300912611, 7299.517733468975, 5059.283191552472, 4337.399779809178, 5580.297005556465, 6465.500747575986, 6376.141309141491, 6242.054088411969, 9981.40021810547, 10207.819342860841, 4496.541188008499, 4880.642707289647, 8534.80112290225, 8668.293986750945, 6939.900564275175, 6416.5680109640325, 5951.32693208562, 6153.231227870304, 4758.5953488687255, 5060.134392956875, 5431.854000608808, 6421.957717989622, 6640.75426052539, 7263.787688244199, 8973.484278733911, 9172.416997880044, 5864.061157224167, 5416.659814286156, 9117.647472999743, 10457.318724717417, 5119.814226675746, 5353.991372936718, 9843.232256810099, 8863.907463834697, 5166.540404190948, 5187.0668051564535, 6862.0343573306245, 6428.734175515403, 8113.990593448959, 8009.305197551042, 9439.511205995515, 9064.3713702163, 5581.7253002763955, 4478.2841891954795, 4654.24442510227, 4517.485076397901, 6155.707744638183, 3814.3878958319974, 9872.23054593618, 10020.239725232057, 6872.663768005922, 7720.40015142017, 4260.3961637776065, 6325.608215301752, 5199.606724230102, 5523.141078658417, 8361.360234090767, 8077.668465765128, 7374.48153105572, 8006.936668662508, 8437.640112782063, 8018.261828202361, 5835.694921327466, 5654.234272143014, 5291.867618881997, 4765.603696866298, 9959.338972663907, 9926.22078789655, 10700.22804400677, 10921.071977378222, 7121.014062711583, 7474.897048802115, 11193.776569928723, 11410.325212177082, 10860.294796885048, 10451.270045412806, 9537.638746768374, 9304.295277397108, 4391.484308133668, 5302.551005666882, 6128.2751725260605, 6182.03806127395, 3843.375497557504, 2793.051901731549, 8554.19186178959, 8095.44350742345, 2944.592000162259, 4650.625004075503, 6590.452949577896, 6506.850095959793, 6375.93514088879, 4632.534994155268, 10185.635429196675, 9812.249291362303, 6268.905992309846, 5627.2318038964595, 4102.447630149428, 5451.219547043958, 7326.158953474774, 7624.686182640974, 940.7422568811326, 792.4035176230775, 7926.586573335353, 8674.905846620322, 3994.4684107747344, 3758.2572895755175, 7332.18003680149, 7589.774879052972, 10358.705298194862, 10019.347070249432, 829.6654358744457, 565.1318528153415, 1405.3849813044058, 1535.140922927969, 4269.150378493192, 5372.110359782163, 7595.115607857055, 7119.094105565404, 8270.637689796029, 8082.001409698366, 7673.35642682768, 5998.38808242878, 4192.047206231537, 5200.334202595102, 10317.939515668828, 9390.61123957013, 3400.0759531646877, 5474.483412052653, 6199.869664543933, 6530.20079144673, 6145.759268154139, 6448.721949754338, 5430.480576493909, 4536.41988293692]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39935784602544755, "mean_inference_ms": 0.9932817829035544, "mean_action_processing_ms": 0.1676392666863027, "mean_env_wait_ms": 0.05412462559710767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003578782081604004, "StateBufferConnector_ms": 0.0024476051330566406, "ViewRequirementAgentConnector_ms": 0.06861591339111328}, "num_episodes": 22, "episode_return_max": 25313.45186741547, "episode_return_min": 1484.3706683578534, "episode_return_mean": 19916.278875494314}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.486722038313, "num_env_steps_trained_throughput_per_sec": 545.486722038313, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 7451.303, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7451.268, "sample_time_ms": 760.321, "learn_time_ms": 6679.611, "learn_throughput": 598.837, "synch_weights_time_ms": 10.891}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 106, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-10", "timestamp": 1723236190, "time_this_iter_s": 7.338341236114502, "time_total_s": 811.4343221187592, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 811.4343221187592, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.15454545454546, "ram_util_percent": 80.20909090909093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72213.93039473276, "cur_kl_coeff": 393593.5186506479, "cur_lr": 5.0000000000000016e-05, "total_loss": 12206.606620344535, "policy_loss": 0.02693666740291057, "vf_loss": 9.998762199361488, "vf_explained_var": 1.637317516185619e-05, "kl": 0.030987757532339958, "entropy": 1.0093675794109465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7442651307055106, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992693680524827, "policy_loss": -0.0038720873722922987, "vf_loss": 9.993715180953343, "vf_explained_var": -0.0008985709398984909, "kl": 0.00667359526414657, "entropy": 1.0563308785359065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "env_runners": {"episode_reward_max": 25313.45186741547, "episode_reward_min": 1484.3706683578534, "episode_reward_mean": 20199.371212888753, "episode_len_mean": 193.02, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19302, "policy_reward_min": {"agent_policy": 89.5733796680661, "adversary_policy": 565.1318528153415}, "policy_reward_max": {"agent_policy": 11125.33304589627, "adversary_policy": 11572.126208416883}, "policy_reward_mean": {"agent_policy": 6459.661166809578, "adversary_policy": 6869.855023039593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20089.229524917955, 21439.84693979054, 20992.412996413193, 21409.31808268659, 18445.76400599198, 18754.65964628287, 23538.63050856559, 21189.47950647531, 20087.623027314916, 23167.716183415465, 18403.23388012904, 21436.552254029557, 18475.250205577348, 19720.23075678959, 20233.837486305325, 23862.625753549422, 18630.59578174491, 22640.56412167677, 20546.495585803696, 19963.71198600272, 18889.848825066685, 19569.35573990171, 20773.81460346455, 23069.472536110774, 19556.238201279433, 23250.106619261467, 19203.27251106609, 22998.540596391926, 19273.808600767785, 20562.582580481914, 22029.117871991162, 22712.809785639798, 18616.57186935662, 18652.041243986034, 17956.338858135143, 23749.956894251674, 21002.061451982197, 18399.50048215961, 19336.462951458685, 22156.06066268635, 21485.37093375839, 22158.439926318428, 19782.047119398812, 18905.967639724535, 23978.006456483086, 24713.344273118262, 21253.68265094492, 25313.45186741547, 24554.32700661364, 23437.207113212986, 18530.84885882972, 20260.48293546034, 16930.551494187537, 22234.46243675461, 17082.997844817797, 20638.54892542016, 18765.398255926026, 23914.228507846423, 19765.853464120923, 18232.187339434695, 21347.506177876996, 1852.7317414499742, 21857.888265680234, 17883.13302212668, 21470.62011667349, 24019.36373171049, 1484.3706683578534, 3311.5039719675597, 18396.345503697215, 21069.979928014916, 22186.467693052466, 20137.78595720948, 18328.93949516213, 23518.61657051199, 17532.398958938687, 20329.277875124742, 20278.893777743433, 18667.445638022422, 23917.570628713143, 24050.937361718414, 17544.24078746048, 23015.49261552421, 24643.70108723565, 19644.17275292861, 20977.57898947371, 23417.320244403607, 20249.118830050116, 23364.37382538013, 20893.01838403641, 18273.731511876893, 18185.463144864003, 20661.415494430228, 23534.1469934787, 22858.602038006837, 5924.391684097161, 25185.057032494984, 23397.574162558347, 18270.398705525142, 17054.049954181657, 24478.34979842702], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 13, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7948.026210036616, 5512.088200899445, 6719.089710932389, 6432.930142193065, 9294.240638647669, 9112.962844745332, 4149.81297968315, 6616.358347623832, 6975.248852185692, 4612.4745850146455, 9256.223845898408, 6346.746219647973, 9078.567234215803, 7674.433003657196, 7615.642088751898, 3673.4061925830265, 9253.411886446747, 5437.469012023678, 7190.027010564362, 7859.153826046853, 9071.119083241188, 7715.544021303268, 6869.272654694965, 4923.57125949685, 8275.517229769031, 3675.140421544338, 8729.466911453696, 4291.400875747114, 8920.2013914205, 7271.814047636039, 5905.822080991176, 4208.927209427917, 8556.562379884801, 9480.31174248597, 7986.243217665, 3857.4866230836105, 6408.997532556104, 7813.496103080212, 8613.715148570165, 5717.03196283074, 6103.952734040225, 5702.537985334114, 8292.117925928364, 8848.496323976346, 4092.44669592261, 3092.0442517331594, 6657.77153943113, 2709.350085309585, 3242.7621643156335, 4595.27308904745, 8836.813545029117, 7950.169701660388, 10294.124094898421, 5584.827067541675, 9487.780840580015, 7541.245879882424, 7756.928120881978, 3916.3437872873883, 7869.715667914571, 8678.520162241366, 6396.661041761251, 119.5859669457634, 5256.395845724577, 10130.407321776413, 6548.66520081902, 3641.3113632660547, 89.5733796680661, 370.9780677351848, 8755.084765421876, 6355.770214592381, 5833.828593558032, 6466.041447952945, 8936.558086335515, 3810.065815272972, 8657.839593721375, 7599.207419134077, 7684.412559834826, 8700.545178591592, 4157.167123889475, 4112.325273065685, 10303.09281245698, 4942.820919706819, 3453.4150219022445, 8300.742652530294, 6624.698022000861, 4139.463754670931, 7294.488992378124, 4009.1585312627944, 7196.872895177108, 9096.320779564665, 9061.759068096522, 7089.884710124167, 4279.482567740657, 4919.420975157142, 587.6801386472432, 2519.536962645215, 4292.420605210363, 9154.94707207797, 11125.33304589627, 3648.9765030079243], "policy_adversary_policy_reward": [6187.228126316286, 5953.975188565044, 7408.202434785144, 8519.556304105927, 6927.302216962528, 7346.021068518286, 7366.618121974265, 7609.76981851926, 4390.377389479451, 4761.145977864981, 4698.640078612739, 4943.056722924899, 9555.027001207629, 9833.790527674855, 7516.475360250257, 7056.645798601281, 7126.698000875449, 5985.676174253881, 9062.330442812838, 9492.911155588037, 4265.095413819694, 4881.91462041099, 7790.288300912611, 7299.517733468975, 5059.283191552472, 4337.399779809178, 5580.297005556465, 6465.500747575986, 6376.141309141491, 6242.054088411969, 9981.40021810547, 10207.819342860841, 4496.541188008499, 4880.642707289647, 8534.80112290225, 8668.293986750945, 6939.900564275175, 6416.5680109640325, 5951.32693208562, 6153.231227870304, 4758.5953488687255, 5060.134392956875, 5431.854000608808, 6421.957717989622, 6640.75426052539, 7263.787688244199, 8973.484278733911, 9172.416997880044, 5864.061157224167, 5416.659814286156, 9117.647472999743, 10457.318724717417, 5119.814226675746, 5353.991372936718, 9843.232256810099, 8863.907463834697, 5166.540404190948, 5187.0668051564535, 6862.0343573306245, 6428.734175515403, 8113.990593448959, 8009.305197551042, 9439.511205995515, 9064.3713702163, 5581.7253002763955, 4478.2841891954795, 4654.24442510227, 4517.485076397901, 6155.707744638183, 3814.3878958319974, 9872.23054593618, 10020.239725232057, 6872.663768005922, 7720.40015142017, 4260.3961637776065, 6325.608215301752, 5199.606724230102, 5523.141078658417, 8361.360234090767, 8077.668465765128, 7374.48153105572, 8006.936668662508, 8437.640112782063, 8018.261828202361, 5835.694921327466, 5654.234272143014, 5291.867618881997, 4765.603696866298, 9959.338972663907, 9926.22078789655, 10700.22804400677, 10921.071977378222, 7121.014062711583, 7474.897048802115, 11193.776569928723, 11410.325212177082, 10860.294796885048, 10451.270045412806, 9537.638746768374, 9304.295277397108, 4391.484308133668, 5302.551005666882, 6128.2751725260605, 6182.03806127395, 3843.375497557504, 2793.051901731549, 8554.19186178959, 8095.44350742345, 2944.592000162259, 4650.625004075503, 6590.452949577896, 6506.850095959793, 6375.93514088879, 4632.534994155268, 10185.635429196675, 9812.249291362303, 6268.905992309846, 5627.2318038964595, 4102.447630149428, 5451.219547043958, 7326.158953474774, 7624.686182640974, 940.7422568811326, 792.4035176230775, 7926.586573335353, 8674.905846620322, 3994.4684107747344, 3758.2572895755175, 7332.18003680149, 7589.774879052972, 10358.705298194862, 10019.347070249432, 829.6654358744457, 565.1318528153415, 1405.3849813044058, 1535.140922927969, 4269.150378493192, 5372.110359782163, 7595.115607857055, 7119.094105565404, 8270.637689796029, 8082.001409698366, 7673.35642682768, 5998.38808242878, 4192.047206231537, 5200.334202595102, 10317.939515668828, 9390.61123957013, 3400.0759531646877, 5474.483412052653, 6199.869664543933, 6530.20079144673, 6145.759268154139, 6448.721949754338, 5430.480576493909, 4536.41988293692, 9968.300740417932, 9792.102764405661, 10020.805109321145, 9917.806979331534, 3830.1916172189217, 3410.956357784531, 8892.742614308316, 9179.929081509203, 10668.363644416146, 10521.922420917417, 5503.512492117841, 5839.917608280542, 7160.176355553559, 7192.704611919061, 9820.342817968525, 9457.513671764114, 6836.183896779861, 6118.445940892126, 9236.597464089, 10118.61783002832, 6936.372062105764, 6759.773426753383, 4138.671991166718, 5038.738741145634, 4057.199984660239, 5066.504092107252, 6525.585871087012, 7045.944913219093, 9838.40582083502, 9416.25860490326, 8771.710508816617, 9167.470554033074, 2735.7217329295295, 2600.9898125203827, 11093.393861433075, 11572.126208416883, 9257.263294190983, 9847.890263156845, 4137.469354121424, 4977.982279325745, 3011.2847469970566, 2917.432161288338, 10438.962918286115, 10390.41037713288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992032191908392, "mean_inference_ms": 0.9928551133142497, "mean_action_processing_ms": 0.16760424813984443, "mean_env_wait_ms": 0.054131807475522466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036287307739257812, "StateBufferConnector_ms": 0.0024813413619995117, "ViewRequirementAgentConnector_ms": 0.06844663619995117}, "num_episodes": 22, "episode_return_max": 25313.45186741547, "episode_return_min": 1484.3706683578534, "episode_return_mean": 20199.371212888753}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.51551843200986, "num_env_steps_trained_throughput_per_sec": 493.51551843200986, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 7538.181, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7538.145, "sample_time_ms": 756.682, "learn_time_ms": 6770.37, "learn_throughput": 590.81, "synch_weights_time_ms": 10.634}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "training_iteration": 107, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-18", "timestamp": 1723236198, "time_this_iter_s": 8.165231943130493, "time_total_s": 819.5995540618896, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aa3e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 819.5995540618896, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 40.44166666666667, "ram_util_percent": 80.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115812.37040072648, "cur_kl_coeff": 590390.2779759717, "cur_lr": 5.0000000000000016e-05, "total_loss": 21404.41755823206, "policy_loss": 0.03302157110184747, "vf_loss": 10.0, "vf_explained_var": 0.00013012832434719832, "kl": 0.03623769959809367, "entropy": 1.0167045627952254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8098190973202387, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.980918078621228, "policy_loss": -0.004113592027958172, "vf_loss": 9.981666847070057, "vf_explained_var": -0.0011523847778638205, "kl": 0.007877397587193021, "entropy": 1.0346866404016812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 26607.8600416222, "episode_reward_min": 1484.3706683578534, "episode_reward_mean": 20110.23974355398, "episode_len_mean": 188.33, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18833, "policy_reward_min": {"agent_policy": 89.5733796680661, "adversary_policy": 565.1318528153415}, "policy_reward_max": {"agent_policy": 11125.33304589627, "adversary_policy": 12653.792529877912}, "policy_reward_mean": {"agent_policy": 5908.114541421573, "adversary_policy": 7101.062601066204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23069.472536110774, 19556.238201279433, 23250.106619261467, 19203.27251106609, 22998.540596391926, 19273.808600767785, 20562.582580481914, 22029.117871991162, 22712.809785639798, 18616.57186935662, 18652.041243986034, 17956.338858135143, 23749.956894251674, 21002.061451982197, 18399.50048215961, 19336.462951458685, 22156.06066268635, 21485.37093375839, 22158.439926318428, 19782.047119398812, 18905.967639724535, 23978.006456483086, 24713.344273118262, 21253.68265094492, 25313.45186741547, 24554.32700661364, 23437.207113212986, 18530.84885882972, 20260.48293546034, 16930.551494187537, 22234.46243675461, 17082.997844817797, 20638.54892542016, 18765.398255926026, 23914.228507846423, 19765.853464120923, 18232.187339434695, 21347.506177876996, 1852.7317414499742, 21857.888265680234, 17883.13302212668, 21470.62011667349, 24019.36373171049, 1484.3706683578534, 3311.5039719675597, 18396.345503697215, 21069.979928014916, 22186.467693052466, 20137.78595720948, 18328.93949516213, 23518.61657051199, 17532.398958938687, 20329.277875124742, 20278.893777743433, 18667.445638022422, 23917.570628713143, 24050.937361718414, 17544.24078746048, 23015.49261552421, 24643.70108723565, 19644.17275292861, 20977.57898947371, 23417.320244403607, 20249.118830050116, 23364.37382538013, 20893.01838403641, 18273.731511876893, 18185.463144864003, 20661.415494430228, 23534.1469934787, 22858.602038006837, 5924.391684097161, 25185.057032494984, 23397.574162558347, 18270.398705525142, 17054.049954181657, 24478.34979842702, 24346.461422147375, 20838.729877917784, 25769.665635265916, 20717.719203902485, 18827.782845072597, 24255.251991483656, 18639.58600044555, 24084.152070389195, 8103.657266470898, 22995.8622334615, 25590.476940910554, 2521.2505933211523, 23938.2662563024, 21970.82448602002, 19223.636083969814, 23750.014876721743, 22928.95384286298, 19449.640374684313, 19419.82643277328, 5140.167962428099, 25115.653710463535, 26607.8600416222, 19112.21031978088], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 13, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 65, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200], "policy_agent_policy_reward": [4923.57125949685, 8275.517229769031, 3675.140421544338, 8729.466911453696, 4291.400875747114, 8920.2013914205, 7271.814047636039, 5905.822080991176, 4208.927209427917, 8556.562379884801, 9480.31174248597, 7986.243217665, 3857.4866230836105, 6408.997532556104, 7813.496103080212, 8613.715148570165, 5717.03196283074, 6103.952734040225, 5702.537985334114, 8292.117925928364, 8848.496323976346, 4092.44669592261, 3092.0442517331594, 6657.77153943113, 2709.350085309585, 3242.7621643156335, 4595.27308904745, 8836.813545029117, 7950.169701660388, 10294.124094898421, 5584.827067541675, 9487.780840580015, 7541.245879882424, 7756.928120881978, 3916.3437872873883, 7869.715667914571, 8678.520162241366, 6396.661041761251, 119.5859669457634, 5256.395845724577, 10130.407321776413, 6548.66520081902, 3641.3113632660547, 89.5733796680661, 370.9780677351848, 8755.084765421876, 6355.770214592381, 5833.828593558032, 6466.041447952945, 8936.558086335515, 3810.065815272972, 8657.839593721375, 7599.207419134077, 7684.412559834826, 8700.545178591592, 4157.167123889475, 4112.325273065685, 10303.09281245698, 4942.820919706819, 3453.4150219022445, 8300.742652530294, 6624.698022000861, 4139.463754670931, 7294.488992378124, 4009.1585312627944, 7196.872895177108, 9096.320779564665, 9061.759068096522, 7089.884710124167, 4279.482567740657, 4919.420975157142, 587.6801386472432, 2519.536962645215, 4292.420605210363, 9154.94707207797, 11125.33304589627, 3648.9765030079243, 3439.5578958992483, 6733.363668549213, 2132.4759930636233, 7530.401962999441, 9137.613145111281, 3615.8033152148346, 8989.80012973999, 3544.29360516629, 993.7765518021168, 4927.547001482494, 1742.4407463344478, 163.42803914171307, 3210.8699589117027, 6212.527476847812, 8284.810354604793, 3339.396891591987, 5223.186350292086, 8554.747632348293, 8468.47123108666, 647.4112442137554, 2144.034970235708, 1469.9394499415773, 8753.68843765769], "policy_adversary_policy_reward": [8973.484278733911, 9172.416997880044, 5864.061157224167, 5416.659814286156, 9117.647472999743, 10457.318724717417, 5119.814226675746, 5353.991372936718, 9843.232256810099, 8863.907463834697, 5166.540404190948, 5187.0668051564535, 6862.0343573306245, 6428.734175515403, 8113.990593448959, 8009.305197551042, 9439.511205995515, 9064.3713702163, 5581.7253002763955, 4478.2841891954795, 4654.24442510227, 4517.485076397901, 6155.707744638183, 3814.3878958319974, 9872.23054593618, 10020.239725232057, 6872.663768005922, 7720.40015142017, 4260.3961637776065, 6325.608215301752, 5199.606724230102, 5523.141078658417, 8361.360234090767, 8077.668465765128, 7374.48153105572, 8006.936668662508, 8437.640112782063, 8018.261828202361, 5835.694921327466, 5654.234272143014, 5291.867618881997, 4765.603696866298, 9959.338972663907, 9926.22078789655, 10700.22804400677, 10921.071977378222, 7121.014062711583, 7474.897048802115, 11193.776569928723, 11410.325212177082, 10860.294796885048, 10451.270045412806, 9537.638746768374, 9304.295277397108, 4391.484308133668, 5302.551005666882, 6128.2751725260605, 6182.03806127395, 3843.375497557504, 2793.051901731549, 8554.19186178959, 8095.44350742345, 2944.592000162259, 4650.625004075503, 6590.452949577896, 6506.850095959793, 6375.93514088879, 4632.534994155268, 10185.635429196675, 9812.249291362303, 6268.905992309846, 5627.2318038964595, 4102.447630149428, 5451.219547043958, 7326.158953474774, 7624.686182640974, 940.7422568811326, 792.4035176230775, 7926.586573335353, 8674.905846620322, 3994.4684107747344, 3758.2572895755175, 7332.18003680149, 7589.774879052972, 10358.705298194862, 10019.347070249432, 829.6654358744457, 565.1318528153415, 1405.3849813044058, 1535.140922927969, 4269.150378493192, 5372.110359782163, 7595.115607857055, 7119.094105565404, 8270.637689796029, 8082.001409698366, 7673.35642682768, 5998.38808242878, 4192.047206231537, 5200.334202595102, 10317.939515668828, 9390.61123957013, 3400.0759531646877, 5474.483412052653, 6199.869664543933, 6530.20079144673, 6145.759268154139, 6448.721949754338, 5430.480576493909, 4536.41988293692, 9968.300740417932, 9792.102764405661, 10020.805109321145, 9917.806979331534, 3830.1916172189217, 3410.956357784531, 8892.742614308316, 9179.929081509203, 10668.363644416146, 10521.922420917417, 5503.512492117841, 5839.917608280542, 7160.176355553559, 7192.704611919061, 9820.342817968525, 9457.513671764114, 6836.183896779861, 6118.445940892126, 9236.597464089, 10118.61783002832, 6936.372062105764, 6759.773426753383, 4138.671991166718, 5038.738741145634, 4057.199984660239, 5066.504092107252, 6525.585871087012, 7045.944913219093, 9838.40582083502, 9416.25860490326, 8771.710508816617, 9167.470554033074, 2735.7217329295295, 2600.9898125203827, 11093.393861433075, 11572.126208416883, 9257.263294190983, 9847.890263156845, 4137.469354121424, 4977.982279325745, 3011.2847469970566, 2917.432161288338, 10438.962918286115, 10390.41037713288, 10700.791210289291, 10206.112315958664, 7008.32282764196, 7097.043381726561, 11999.113974584448, 11638.075667618063, 6606.901300283598, 6580.415940619467, 4987.239231161219, 4702.930468800243, 10123.448554543744, 10516.000121724921, 4497.623436984781, 5152.162433720889, 10426.599888031053, 10113.25857719186, 3532.4866729536197, 3577.394041715161, 8900.321481051416, 9167.993750927571, 12397.290729659326, 11450.745464917141, 1250.7855232313818, 1107.0370309480568, 10921.498140709073, 9805.89815668177, 7909.680861066007, 7848.616148106152, 5857.243816950933, 5081.581912414194, 10801.718114236974, 9608.899870892721, 8795.959644453873, 8909.807848116872, 5309.801020426312, 5585.091721909707, 5286.03562362451, 5665.319578062126, 2605.279949244363, 1887.4767689699772, 11988.700098217765, 10982.918642009936, 12653.792529877912, 12484.128061802543, 4983.18252336485, 5375.339358758434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992154221280069, "mean_inference_ms": 0.9928628847631255, "mean_action_processing_ms": 0.1676219278782869, "mean_env_wait_ms": 0.05413867503147833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004853367805480957, "StateBufferConnector_ms": 0.0024595260620117188, "ViewRequirementAgentConnector_ms": 0.06690025329589844}, "num_episodes": 23, "episode_return_max": 26607.8600416222, "episode_return_min": 1484.3706683578534, "episode_return_mean": 20110.23974355398}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.8695989905411, "num_env_steps_trained_throughput_per_sec": 513.8695989905411, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 7593.75, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7593.713, "sample_time_ms": 769.596, "learn_time_ms": 6812.547, "learn_throughput": 587.152, "synch_weights_time_ms": 11.106}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 108, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-26", "timestamp": 1723236206, "time_this_iter_s": 7.789207935333252, "time_total_s": 827.3887619972229, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aa3ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 827.3887619972229, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 42.400000000000006, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 208295.46195901537, "cur_kl_coeff": 885585.4169639574, "cur_lr": 5.0000000000000016e-05, "total_loss": 44451.77163628472, "policy_loss": 0.04467120432546214, "vf_loss": 10.0, "vf_explained_var": -2.3682407601169808e-05, "kl": 0.05018344369948541, "entropy": 1.0169440710986102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7485518353215108, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988367714484532, "policy_loss": -0.0028934503066314694, "vf_loss": 9.98920186161995, "vf_explained_var": -0.0008634738624095917, "kl": 0.004821045379746162, "entropy": 1.0142130093649029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "env_runners": {"episode_reward_max": 26607.8600416222, "episode_reward_min": 218.57429145514953, "episode_reward_mean": 19741.4936620999, "episode_len_mean": 184.65, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18465, "policy_reward_min": {"agent_policy": 2.163511703441266, "adversary_policy": 77.15293521784002}, "policy_reward_max": {"agent_policy": 11125.33304589627, "adversary_policy": 12653.792529877912}, "policy_reward_mean": {"agent_policy": 5762.964030691252, "adversary_policy": 6989.264815704322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24713.344273118262, 21253.68265094492, 25313.45186741547, 24554.32700661364, 23437.207113212986, 18530.84885882972, 20260.48293546034, 16930.551494187537, 22234.46243675461, 17082.997844817797, 20638.54892542016, 18765.398255926026, 23914.228507846423, 19765.853464120923, 18232.187339434695, 21347.506177876996, 1852.7317414499742, 21857.888265680234, 17883.13302212668, 21470.62011667349, 24019.36373171049, 1484.3706683578534, 3311.5039719675597, 18396.345503697215, 21069.979928014916, 22186.467693052466, 20137.78595720948, 18328.93949516213, 23518.61657051199, 17532.398958938687, 20329.277875124742, 20278.893777743433, 18667.445638022422, 23917.570628713143, 24050.937361718414, 17544.24078746048, 23015.49261552421, 24643.70108723565, 19644.17275292861, 20977.57898947371, 23417.320244403607, 20249.118830050116, 23364.37382538013, 20893.01838403641, 18273.731511876893, 18185.463144864003, 20661.415494430228, 23534.1469934787, 22858.602038006837, 5924.391684097161, 25185.057032494984, 23397.574162558347, 18270.398705525142, 17054.049954181657, 24478.34979842702, 24346.461422147375, 20838.729877917784, 25769.665635265916, 20717.719203902485, 18827.782845072597, 24255.251991483656, 18639.58600044555, 24084.152070389195, 8103.657266470898, 22995.8622334615, 25590.476940910554, 2521.2505933211523, 23938.2662563024, 21970.82448602002, 19223.636083969814, 23750.014876721743, 22928.95384286298, 19449.640374684313, 19419.82643277328, 5140.167962428099, 25115.653710463535, 26607.8600416222, 19112.21031978088, 18787.97653117282, 20893.35885371464, 24214.932807339832, 23429.27850933629, 17983.598861848823, 24800.388964157544, 21576.877429458564, 3906.909397614561, 19795.20227490049, 18963.277113067714, 18776.36448198697, 22168.161145216465, 17887.903492620997, 21009.139418596198, 19130.876888736846, 19263.920020102716, 25228.54143830899, 19453.553253974595, 22807.79902078367, 19531.246018803307, 22132.287434085025, 218.57429145514953], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 15, 200, 200, 200, 200, 13, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 65, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2], "policy_agent_policy_reward": [3092.0442517331594, 6657.77153943113, 2709.350085309585, 3242.7621643156335, 4595.27308904745, 8836.813545029117, 7950.169701660388, 10294.124094898421, 5584.827067541675, 9487.780840580015, 7541.245879882424, 7756.928120881978, 3916.3437872873883, 7869.715667914571, 8678.520162241366, 6396.661041761251, 119.5859669457634, 5256.395845724577, 10130.407321776413, 6548.66520081902, 3641.3113632660547, 89.5733796680661, 370.9780677351848, 8755.084765421876, 6355.770214592381, 5833.828593558032, 6466.041447952945, 8936.558086335515, 3810.065815272972, 8657.839593721375, 7599.207419134077, 7684.412559834826, 8700.545178591592, 4157.167123889475, 4112.325273065685, 10303.09281245698, 4942.820919706819, 3453.4150219022445, 8300.742652530294, 6624.698022000861, 4139.463754670931, 7294.488992378124, 4009.1585312627944, 7196.872895177108, 9096.320779564665, 9061.759068096522, 7089.884710124167, 4279.482567740657, 4919.420975157142, 587.6801386472432, 2519.536962645215, 4292.420605210363, 9154.94707207797, 11125.33304589627, 3648.9765030079243, 3439.5578958992483, 6733.363668549213, 2132.4759930636233, 7530.401962999441, 9137.613145111281, 3615.8033152148346, 8989.80012973999, 3544.29360516629, 993.7765518021168, 4927.547001482494, 1742.4407463344478, 163.42803914171307, 3210.8699589117027, 6212.527476847812, 8284.810354604793, 3339.396891591987, 5223.186350292086, 8554.747632348293, 8468.47123108666, 647.4112442137554, 2144.034970235708, 1469.9394499415773, 8753.68843765769, 8680.01401475927, 6446.677048721919, 2983.6141093184615, 4574.55570305839, 10098.511529277857, 2888.6264810978028, 5362.188679497567, 120.90549862633327, 8292.795589464327, 8108.807557707388, 7928.25132136811, 5310.936308297029, 9110.537181658163, 7126.94194694933, 9008.58896221684, 7850.494575819146, 2126.8119949178313, 8269.630447210338, 5235.495771539754, 7625.26755671076, 6008.390939892708, 2.163511703441266], "policy_adversary_policy_reward": [10700.22804400677, 10921.071977378222, 7121.014062711583, 7474.897048802115, 11193.776569928723, 11410.325212177082, 10860.294796885048, 10451.270045412806, 9537.638746768374, 9304.295277397108, 4391.484308133668, 5302.551005666882, 6128.2751725260605, 6182.03806127395, 3843.375497557504, 2793.051901731549, 8554.19186178959, 8095.44350742345, 2944.592000162259, 4650.625004075503, 6590.452949577896, 6506.850095959793, 6375.93514088879, 4632.534994155268, 10185.635429196675, 9812.249291362303, 6268.905992309846, 5627.2318038964595, 4102.447630149428, 5451.219547043958, 7326.158953474774, 7624.686182640974, 940.7422568811326, 792.4035176230775, 7926.586573335353, 8674.905846620322, 3994.4684107747344, 3758.2572895755175, 7332.18003680149, 7589.774879052972, 10358.705298194862, 10019.347070249432, 829.6654358744457, 565.1318528153415, 1405.3849813044058, 1535.140922927969, 4269.150378493192, 5372.110359782163, 7595.115607857055, 7119.094105565404, 8270.637689796029, 8082.001409698366, 7673.35642682768, 5998.38808242878, 4192.047206231537, 5200.334202595102, 10317.939515668828, 9390.61123957013, 3400.0759531646877, 5474.483412052653, 6199.869664543933, 6530.20079144673, 6145.759268154139, 6448.721949754338, 5430.480576493909, 4536.41988293692, 9968.300740417932, 9792.102764405661, 10020.805109321145, 9917.806979331534, 3830.1916172189217, 3410.956357784531, 8892.742614308316, 9179.929081509203, 10668.363644416146, 10521.922420917417, 5503.512492117841, 5839.917608280542, 7160.176355553559, 7192.704611919061, 9820.342817968525, 9457.513671764114, 6836.183896779861, 6118.445940892126, 9236.597464089, 10118.61783002832, 6936.372062105764, 6759.773426753383, 4138.671991166718, 5038.738741145634, 4057.199984660239, 5066.504092107252, 6525.585871087012, 7045.944913219093, 9838.40582083502, 9416.25860490326, 8771.710508816617, 9167.470554033074, 2735.7217329295295, 2600.9898125203827, 11093.393861433075, 11572.126208416883, 9257.263294190983, 9847.890263156845, 4137.469354121424, 4977.982279325745, 3011.2847469970566, 2917.432161288338, 10438.962918286115, 10390.41037713288, 10700.791210289291, 10206.112315958664, 7008.32282764196, 7097.043381726561, 11999.113974584448, 11638.075667618063, 6606.901300283598, 6580.415940619467, 4987.239231161219, 4702.930468800243, 10123.448554543744, 10516.000121724921, 4497.623436984781, 5152.162433720889, 10426.599888031053, 10113.25857719186, 3532.4866729536197, 3577.394041715161, 8900.321481051416, 9167.993750927571, 12397.290729659326, 11450.745464917141, 1250.7855232313818, 1107.0370309480568, 10921.498140709073, 9805.89815668177, 7909.680861066007, 7848.616148106152, 5857.243816950933, 5081.581912414194, 10801.718114236974, 9608.899870892721, 8795.959644453873, 8909.807848116872, 5309.801020426312, 5585.091721909707, 5286.03562362451, 5665.319578062126, 2605.279949244363, 1887.4767689699772, 11988.700098217765, 10982.918642009936, 12653.792529877912, 12484.128061802543, 4983.18252336485, 5375.339358758434, 5449.494560705013, 4658.467955708548, 6764.989046728914, 7681.692758263773, 11157.535106129213, 10073.783591892423, 9291.688776040994, 9563.03403023684, 4038.643503412904, 3846.4438291580464, 11043.008941957598, 10868.753541102144, 8777.54816112328, 7437.140588837867, 2000.414844933309, 1785.5890540549158, 5661.596634270753, 5840.810051165484, 4828.4260186851225, 6026.043536675252, 6213.307339254759, 4634.805821364135, 8827.031413280665, 8030.19342363882, 3750.6582774217177, 5026.708033541111, 6990.654983998639, 6891.542487648147, 4996.832445975942, 5125.455480544047, 5125.0235003599355, 6288.401943923646, 11244.440919918847, 11857.288523472274, 5313.909084021958, 5870.013722742383, 8736.971969687054, 8835.331279557045, 5392.549181237104, 6513.429280855253, 8110.982320425387, 8012.914173766856, 139.25784453386825, 77.15293521784002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39924064119061065, "mean_inference_ms": 0.9929553583565125, "mean_action_processing_ms": 0.16763085563288427, "mean_env_wait_ms": 0.054159992235685836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004940032958984375, "StateBufferConnector_ms": 0.003642439842224121, "ViewRequirementAgentConnector_ms": 0.0672147274017334}, "num_episodes": 22, "episode_return_max": 26607.8600416222, "episode_return_min": 218.57429145514953, "episode_return_mean": 19741.4936620999}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.9688673210225, "num_env_steps_trained_throughput_per_sec": 545.9688673210225, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 7527.871, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7527.833, "sample_time_ms": 768.024, "learn_time_ms": 6748.23, "learn_throughput": 592.748, "synch_weights_time_ms": 11.118}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "training_iteration": 109, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-34", "timestamp": 1723236214, "time_this_iter_s": 7.339083909988403, "time_total_s": 834.7278459072113, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aea310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 834.7278459072113, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 30.10909090909091, "ram_util_percent": 82.85454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 298676.36279296875, "cur_kl_coeff": 1328378.125445936, "cur_lr": 5.0000000000000016e-05, "total_loss": 59823.084661251654, "policy_loss": 0.040126543167224596, "vf_loss": 10.0, "vf_explained_var": -2.19775570763482e-05, "kl": 0.04502712245537806, "entropy": 1.0191033562655172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.777016448477904, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985468473037084, "policy_loss": -0.003518917038066623, "vf_loss": 9.987840721011162, "vf_explained_var": -0.0011174004524946214, "kl": 0.0053689614311830764, "entropy": 0.9961674605806669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 26607.8600416222, "episode_reward_min": 218.57429145514953, "episode_reward_mean": 19619.594850492773, "episode_len_mean": 182.91, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18291, "policy_reward_min": {"agent_policy": 2.163511703441266, "adversary_policy": 77.15293521784002}, "policy_reward_max": {"agent_policy": 11125.33304589627, "adversary_policy": 12653.792529877912}, "policy_reward_mean": {"agent_policy": 5660.670871298743, "adversary_policy": 6979.4619895970145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1484.3706683578534, 3311.5039719675597, 18396.345503697215, 21069.979928014916, 22186.467693052466, 20137.78595720948, 18328.93949516213, 23518.61657051199, 17532.398958938687, 20329.277875124742, 20278.893777743433, 18667.445638022422, 23917.570628713143, 24050.937361718414, 17544.24078746048, 23015.49261552421, 24643.70108723565, 19644.17275292861, 20977.57898947371, 23417.320244403607, 20249.118830050116, 23364.37382538013, 20893.01838403641, 18273.731511876893, 18185.463144864003, 20661.415494430228, 23534.1469934787, 22858.602038006837, 5924.391684097161, 25185.057032494984, 23397.574162558347, 18270.398705525142, 17054.049954181657, 24478.34979842702, 24346.461422147375, 20838.729877917784, 25769.665635265916, 20717.719203902485, 18827.782845072597, 24255.251991483656, 18639.58600044555, 24084.152070389195, 8103.657266470898, 22995.8622334615, 25590.476940910554, 2521.2505933211523, 23938.2662563024, 21970.82448602002, 19223.636083969814, 23750.014876721743, 22928.95384286298, 19449.640374684313, 19419.82643277328, 5140.167962428099, 25115.653710463535, 26607.8600416222, 19112.21031978088, 18787.97653117282, 20893.35885371464, 24214.932807339832, 23429.27850933629, 17983.598861848823, 24800.388964157544, 21576.877429458564, 3906.909397614561, 19795.20227490049, 18963.277113067714, 18776.36448198697, 22168.161145216465, 17887.903492620997, 21009.139418596198, 19130.876888736846, 19263.920020102716, 25228.54143830899, 19453.553253974595, 22807.79902078367, 19531.246018803307, 22132.287434085025, 218.57429145514953, 22698.14390776236, 24617.545688548587, 22327.33027830001, 18797.783330849234, 19209.47316922437, 21860.594024668546, 23118.576052221943, 20224.249887588783, 19416.000745738038, 24146.122045884258, 19616.781067767286, 19668.338897745503, 19723.774016629315, 18515.15376076888, 18974.974114831035, 25642.60469478379, 23475.53994597724, 25266.311610103927, 1434.884841787232, 19577.385184117265, 3557.3676036112206], "episode_lengths": [13, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 65, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 29], "policy_agent_policy_reward": [89.5733796680661, 370.9780677351848, 8755.084765421876, 6355.770214592381, 5833.828593558032, 6466.041447952945, 8936.558086335515, 3810.065815272972, 8657.839593721375, 7599.207419134077, 7684.412559834826, 8700.545178591592, 4157.167123889475, 4112.325273065685, 10303.09281245698, 4942.820919706819, 3453.4150219022445, 8300.742652530294, 6624.698022000861, 4139.463754670931, 7294.488992378124, 4009.1585312627944, 7196.872895177108, 9096.320779564665, 9061.759068096522, 7089.884710124167, 4279.482567740657, 4919.420975157142, 587.6801386472432, 2519.536962645215, 4292.420605210363, 9154.94707207797, 11125.33304589627, 3648.9765030079243, 3439.5578958992483, 6733.363668549213, 2132.4759930636233, 7530.401962999441, 9137.613145111281, 3615.8033152148346, 8989.80012973999, 3544.29360516629, 993.7765518021168, 4927.547001482494, 1742.4407463344478, 163.42803914171307, 3210.8699589117027, 6212.527476847812, 8284.810354604793, 3339.396891591987, 5223.186350292086, 8554.747632348293, 8468.47123108666, 647.4112442137554, 2144.034970235708, 1469.9394499415773, 8753.68843765769, 8680.01401475927, 6446.677048721919, 2983.6141093184615, 4574.55570305839, 10098.511529277857, 2888.6264810978028, 5362.188679497567, 120.90549862633327, 8292.795589464327, 8108.807557707388, 7928.25132136811, 5310.936308297029, 9110.537181658163, 7126.94194694933, 9008.58896221684, 7850.494575819146, 2126.8119949178313, 8269.630447210338, 5235.495771539754, 7625.26755671076, 6008.390939892708, 2.163511703441266, 5274.557392666771, 3132.6653749711686, 5516.3023576876285, 7486.78600743056, 8486.872927876035, 5796.223870135081, 4659.000442588068, 7412.164457611948, 8349.428248188413, 3355.087969716712, 8288.11193653816, 8480.704268868441, 8075.93870868845, 9125.94808618783, 8939.737154537394, 2524.2612001674934, 4527.0422298630965, 2285.4971194222067, 57.279993246292285, 8091.093015915544, 212.67803648900355], "policy_adversary_policy_reward": [829.6654358744457, 565.1318528153415, 1405.3849813044058, 1535.140922927969, 4269.150378493192, 5372.110359782163, 7595.115607857055, 7119.094105565404, 8270.637689796029, 8082.001409698366, 7673.35642682768, 5998.38808242878, 4192.047206231537, 5200.334202595102, 10317.939515668828, 9390.61123957013, 3400.0759531646877, 5474.483412052653, 6199.869664543933, 6530.20079144673, 6145.759268154139, 6448.721949754338, 5430.480576493909, 4536.41988293692, 9968.300740417932, 9792.102764405661, 10020.805109321145, 9917.806979331534, 3830.1916172189217, 3410.956357784531, 8892.742614308316, 9179.929081509203, 10668.363644416146, 10521.922420917417, 5503.512492117841, 5839.917608280542, 7160.176355553559, 7192.704611919061, 9820.342817968525, 9457.513671764114, 6836.183896779861, 6118.445940892126, 9236.597464089, 10118.61783002832, 6936.372062105764, 6759.773426753383, 4138.671991166718, 5038.738741145634, 4057.199984660239, 5066.504092107252, 6525.585871087012, 7045.944913219093, 9838.40582083502, 9416.25860490326, 8771.710508816617, 9167.470554033074, 2735.7217329295295, 2600.9898125203827, 11093.393861433075, 11572.126208416883, 9257.263294190983, 9847.890263156845, 4137.469354121424, 4977.982279325745, 3011.2847469970566, 2917.432161288338, 10438.962918286115, 10390.41037713288, 10700.791210289291, 10206.112315958664, 7008.32282764196, 7097.043381726561, 11999.113974584448, 11638.075667618063, 6606.901300283598, 6580.415940619467, 4987.239231161219, 4702.930468800243, 10123.448554543744, 10516.000121724921, 4497.623436984781, 5152.162433720889, 10426.599888031053, 10113.25857719186, 3532.4866729536197, 3577.394041715161, 8900.321481051416, 9167.993750927571, 12397.290729659326, 11450.745464917141, 1250.7855232313818, 1107.0370309480568, 10921.498140709073, 9805.89815668177, 7909.680861066007, 7848.616148106152, 5857.243816950933, 5081.581912414194, 10801.718114236974, 9608.899870892721, 8795.959644453873, 8909.807848116872, 5309.801020426312, 5585.091721909707, 5286.03562362451, 5665.319578062126, 2605.279949244363, 1887.4767689699772, 11988.700098217765, 10982.918642009936, 12653.792529877912, 12484.128061802543, 4983.18252336485, 5375.339358758434, 5449.494560705013, 4658.467955708548, 6764.989046728914, 7681.692758263773, 11157.535106129213, 10073.783591892423, 9291.688776040994, 9563.03403023684, 4038.643503412904, 3846.4438291580464, 11043.008941957598, 10868.753541102144, 8777.54816112328, 7437.140588837867, 2000.414844933309, 1785.5890540549158, 5661.596634270753, 5840.810051165484, 4828.4260186851225, 6026.043536675252, 6213.307339254759, 4634.805821364135, 8827.031413280665, 8030.19342363882, 3750.6582774217177, 5026.708033541111, 6990.654983998639, 6891.542487648147, 4996.832445975942, 5125.455480544047, 5125.0235003599355, 6288.401943923646, 11244.440919918847, 11857.288523472274, 5313.909084021958, 5870.013722742383, 8736.971969687054, 8835.331279557045, 5392.549181237104, 6513.429280855253, 8110.982320425387, 8012.914173766856, 139.25784453386825, 77.15293521784002, 8557.458385979178, 8866.128129116392, 10997.079065251692, 10487.80124832557, 8483.403530209664, 8327.62439040259, 4662.941519319298, 6648.055804099394, 5595.948986909591, 5126.651254438852, 7728.583826590912, 8335.786327942607, 8981.544121457795, 9478.031488175942, 6085.196475259087, 6726.888954717712, 5787.321398584809, 5279.251098964834, 10600.657700208483, 10190.376375959013, 5837.76545586677, 5490.903675362304, 5595.171149768859, 5592.463479108206, 5655.53215702397, 5992.303150916922, 5013.609419999771, 4375.5962545811835, 4932.52547890415, 5102.711481389427, 11583.337818414826, 11535.005676201463, 9587.707487323785, 9360.790228790253, 11125.344661421028, 11855.469829260555, 791.2481441775649, 586.356704363375, 5435.309962425881, 6050.982205775872, 1763.7101660598146, 1580.9794010623998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39929005036159865, "mean_inference_ms": 0.9933043180206647, "mean_action_processing_ms": 0.16762030486015728, "mean_env_wait_ms": 0.054205565683024516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004927992820739746, "StateBufferConnector_ms": 0.0036164522171020508, "ViewRequirementAgentConnector_ms": 0.06660854816436768}, "num_episodes": 21, "episode_return_max": 26607.8600416222, "episode_return_min": 218.57429145514953, "episode_return_mean": 19619.594850492773}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.7177454044913, "num_env_steps_trained_throughput_per_sec": 552.7177454044913, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 7490.346, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7490.307, "sample_time_ms": 770.57, "learn_time_ms": 6708.403, "learn_throughput": 596.267, "synch_weights_time_ms": 10.872}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 110, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-41", "timestamp": 1723236221, "time_this_iter_s": 7.242659091949463, "time_total_s": 841.9705049991608, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aea940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 841.9705049991608, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 25.52, "ram_util_percent": 82.67000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 418730.0247840195, "cur_kl_coeff": 1992567.1881689057, "cur_lr": 5.0000000000000016e-05, "total_loss": 81291.2566468254, "policy_loss": 0.0424877269235415, "vf_loss": 10.0, "vf_explained_var": -1.5155064365851185e-05, "kl": 0.04079220615568812, "entropy": 1.0218543678995162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7562828593421728, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988555698593457, "policy_loss": -0.00836656347043269, "vf_loss": 9.994497980674108, "vf_explained_var": -0.0011332953969637554, "kl": 0.011351091679292344, "entropy": 0.995143702129523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "env_runners": {"episode_reward_max": 26607.8600416222, "episode_reward_min": 218.57429145514953, "episode_reward_mean": 20185.61406113595, "episode_len_mean": 184.85, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18485, "policy_reward_min": {"agent_policy": 2.163511703441266, "adversary_policy": 77.15293521784002}, "policy_reward_max": {"agent_policy": 11125.33304589627, "adversary_policy": 12653.792529877912}, "policy_reward_mean": {"agent_policy": 5393.044007297409, "adversary_policy": 7396.285026919276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23364.37382538013, 20893.01838403641, 18273.731511876893, 18185.463144864003, 20661.415494430228, 23534.1469934787, 22858.602038006837, 5924.391684097161, 25185.057032494984, 23397.574162558347, 18270.398705525142, 17054.049954181657, 24478.34979842702, 24346.461422147375, 20838.729877917784, 25769.665635265916, 20717.719203902485, 18827.782845072597, 24255.251991483656, 18639.58600044555, 24084.152070389195, 8103.657266470898, 22995.8622334615, 25590.476940910554, 2521.2505933211523, 23938.2662563024, 21970.82448602002, 19223.636083969814, 23750.014876721743, 22928.95384286298, 19449.640374684313, 19419.82643277328, 5140.167962428099, 25115.653710463535, 26607.8600416222, 19112.21031978088, 18787.97653117282, 20893.35885371464, 24214.932807339832, 23429.27850933629, 17983.598861848823, 24800.388964157544, 21576.877429458564, 3906.909397614561, 19795.20227490049, 18963.277113067714, 18776.36448198697, 22168.161145216465, 17887.903492620997, 21009.139418596198, 19130.876888736846, 19263.920020102716, 25228.54143830899, 19453.553253974595, 22807.79902078367, 19531.246018803307, 22132.287434085025, 218.57429145514953, 22698.14390776236, 24617.545688548587, 22327.33027830001, 18797.783330849234, 19209.47316922437, 21860.594024668546, 23118.576052221943, 20224.249887588783, 19416.000745738038, 24146.122045884258, 19616.781067767286, 19668.338897745503, 19723.774016629315, 18515.15376076888, 18974.974114831035, 25642.60469478379, 23475.53994597724, 25266.311610103927, 1434.884841787232, 19577.385184117265, 3557.3676036112206, 25251.072036885216, 18980.885712736694, 22525.71095551887, 22020.951376580375, 24477.844473030265, 25104.847263924923, 25650.367336571817, 23101.178420566142, 20776.89879385875, 21937.62676148582, 23778.17552975342, 21875.239668817194, 25075.725233201876, 4436.572669212579, 21584.774019755965, 25953.242760304853, 22669.228096889434, 18987.163040819207, 23862.13840004807, 24907.1120133908, 16347.325836276543], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 47, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 65, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4009.1585312627944, 7196.872895177108, 9096.320779564665, 9061.759068096522, 7089.884710124167, 4279.482567740657, 4919.420975157142, 587.6801386472432, 2519.536962645215, 4292.420605210363, 9154.94707207797, 11125.33304589627, 3648.9765030079243, 3439.5578958992483, 6733.363668549213, 2132.4759930636233, 7530.401962999441, 9137.613145111281, 3615.8033152148346, 8989.80012973999, 3544.29360516629, 993.7765518021168, 4927.547001482494, 1742.4407463344478, 163.42803914171307, 3210.8699589117027, 6212.527476847812, 8284.810354604793, 3339.396891591987, 5223.186350292086, 8554.747632348293, 8468.47123108666, 647.4112442137554, 2144.034970235708, 1469.9394499415773, 8753.68843765769, 8680.01401475927, 6446.677048721919, 2983.6141093184615, 4574.55570305839, 10098.511529277857, 2888.6264810978028, 5362.188679497567, 120.90549862633327, 8292.795589464327, 8108.807557707388, 7928.25132136811, 5310.936308297029, 9110.537181658163, 7126.94194694933, 9008.58896221684, 7850.494575819146, 2126.8119949178313, 8269.630447210338, 5235.495771539754, 7625.26755671076, 6008.390939892708, 2.163511703441266, 5274.557392666771, 3132.6653749711686, 5516.3023576876285, 7486.78600743056, 8486.872927876035, 5796.223870135081, 4659.000442588068, 7412.164457611948, 8349.428248188413, 3355.087969716712, 8288.11193653816, 8480.704268868441, 8075.93870868845, 9125.94808618783, 8939.737154537394, 2524.2612001674934, 4527.0422298630965, 2285.4971194222067, 57.279993246292285, 8091.093015915544, 212.67803648900355, 2419.959279362689, 8332.342980604899, 5114.546410360883, 5955.449139007744, 3130.086292872366, 2818.7961295873365, 2015.2139526782555, 4860.399030322182, 7192.066189466466, 5521.617354124121, 4356.986179145114, 6255.697218897154, 3043.9573262750832, 146.77066240867282, 6583.722976345602, 2172.991883471578, 4591.69712747125, 6911.6312154786965, 4255.778756952651, 3187.215544602491, 10958.507644851768], "policy_adversary_policy_reward": [9236.597464089, 10118.61783002832, 6936.372062105764, 6759.773426753383, 4138.671991166718, 5038.738741145634, 4057.199984660239, 5066.504092107252, 6525.585871087012, 7045.944913219093, 9838.40582083502, 9416.25860490326, 8771.710508816617, 9167.470554033074, 2735.7217329295295, 2600.9898125203827, 11093.393861433075, 11572.126208416883, 9257.263294190983, 9847.890263156845, 4137.469354121424, 4977.982279325745, 3011.2847469970566, 2917.432161288338, 10438.962918286115, 10390.41037713288, 10700.791210289291, 10206.112315958664, 7008.32282764196, 7097.043381726561, 11999.113974584448, 11638.075667618063, 6606.901300283598, 6580.415940619467, 4987.239231161219, 4702.930468800243, 10123.448554543744, 10516.000121724921, 4497.623436984781, 5152.162433720889, 10426.599888031053, 10113.25857719186, 3532.4866729536197, 3577.394041715161, 8900.321481051416, 9167.993750927571, 12397.290729659326, 11450.745464917141, 1250.7855232313818, 1107.0370309480568, 10921.498140709073, 9805.89815668177, 7909.680861066007, 7848.616148106152, 5857.243816950933, 5081.581912414194, 10801.718114236974, 9608.899870892721, 8795.959644453873, 8909.807848116872, 5309.801020426312, 5585.091721909707, 5286.03562362451, 5665.319578062126, 2605.279949244363, 1887.4767689699772, 11988.700098217765, 10982.918642009936, 12653.792529877912, 12484.128061802543, 4983.18252336485, 5375.339358758434, 5449.494560705013, 4658.467955708548, 6764.989046728914, 7681.692758263773, 11157.535106129213, 10073.783591892423, 9291.688776040994, 9563.03403023684, 4038.643503412904, 3846.4438291580464, 11043.008941957598, 10868.753541102144, 8777.54816112328, 7437.140588837867, 2000.414844933309, 1785.5890540549158, 5661.596634270753, 5840.810051165484, 4828.4260186851225, 6026.043536675252, 6213.307339254759, 4634.805821364135, 8827.031413280665, 8030.19342363882, 3750.6582774217177, 5026.708033541111, 6990.654983998639, 6891.542487648147, 4996.832445975942, 5125.455480544047, 5125.0235003599355, 6288.401943923646, 11244.440919918847, 11857.288523472274, 5313.909084021958, 5870.013722742383, 8736.971969687054, 8835.331279557045, 5392.549181237104, 6513.429280855253, 8110.982320425387, 8012.914173766856, 139.25784453386825, 77.15293521784002, 8557.458385979178, 8866.128129116392, 10997.079065251692, 10487.80124832557, 8483.403530209664, 8327.62439040259, 4662.941519319298, 6648.055804099394, 5595.948986909591, 5126.651254438852, 7728.583826590912, 8335.786327942607, 8981.544121457795, 9478.031488175942, 6085.196475259087, 6726.888954717712, 5787.321398584809, 5279.251098964834, 10600.657700208483, 10190.376375959013, 5837.76545586677, 5490.903675362304, 5595.171149768859, 5592.463479108206, 5655.53215702397, 5992.303150916922, 5013.609419999771, 4375.5962545811835, 4932.52547890415, 5102.711481389427, 11583.337818414826, 11535.005676201463, 9587.707487323785, 9360.790228790253, 11125.344661421028, 11855.469829260555, 791.2481441775649, 586.356704363375, 5435.309962425881, 6050.982205775872, 1763.7101660598146, 1580.9794010623998, 11713.44204010323, 11117.670717419489, 5803.681875633073, 4844.860856498586, 8571.71107915159, 8839.453466006355, 8011.502190403917, 8054.000047168711, 10685.977416675469, 10661.780763482753, 11137.181823354551, 11148.869310982847, 12124.925254412963, 11510.228129480796, 8979.72204527124, 9261.057344973004, 6808.453179723176, 6776.379424668916, 7814.471674455305, 8601.537732906383, 9765.525008523346, 9655.66434208492, 7767.892159023283, 7851.650290896694, 10975.569729452665, 11056.198177474049, 2176.028578324164, 2113.7734284797425, 7511.939650465551, 7489.111392944777, 11937.538362969555, 11842.712513864055, 9383.52306189289, 8694.00790752545, 7221.362409962065, 4854.169415378487, 9844.673765641397, 9761.685877453903, 10826.203101863508, 10893.693366924761, 2212.21537270738, 3176.602818717373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993607978609098, "mean_inference_ms": 0.9933033363905507, "mean_action_processing_ms": 0.16758298491361898, "mean_env_wait_ms": 0.054244794335183075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004940390586853027, "StateBufferConnector_ms": 0.0036927461624145508, "ViewRequirementAgentConnector_ms": 0.06696510314941406}, "num_episodes": 21, "episode_return_max": 26607.8600416222, "episode_return_min": 218.57429145514953, "episode_return_mean": 20185.61406113595}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.5135155277286, "num_env_steps_trained_throughput_per_sec": 552.5135155277286, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 7430.088, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7430.049, "sample_time_ms": 763.94, "learn_time_ms": 6654.798, "learn_throughput": 601.07, "synch_weights_time_ms": 10.849}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "training_iteration": 111, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-49", "timestamp": 1723236229, "time_this_iter_s": 7.244470119476318, "time_total_s": 849.2149751186371, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aa3ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 849.2149751186371, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 32.53636363636363, "ram_util_percent": 82.75454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 814902.8685371197, "cur_kl_coeff": 2988850.782253357, "cur_lr": 5.0000000000000016e-05, "total_loss": 171801.13608217592, "policy_loss": 0.07161587850873176, "vf_loss": 10.0, "vf_explained_var": 2.730012570739423e-05, "kl": 0.0574772978033969, "entropy": 1.0260214027904329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8263998193666339, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993970586856205, "policy_loss": -0.009463738325090768, "vf_loss": 10.0, "vf_explained_var": -0.0008160959929227829, "kl": 0.01608014139540804, "entropy": 1.0573785911624631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 26607.8600416222, "episode_reward_min": 218.57429145514953, "episode_reward_mean": 20263.16546080335, "episode_len_mean": 186.38, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18638, "policy_reward_min": {"agent_policy": 2.163511703441266, "adversary_policy": 77.15293521784002}, "policy_reward_max": {"agent_policy": 10958.507644851768, "adversary_policy": 12653.792529877912}, "policy_reward_mean": {"agent_policy": 5453.700259844138, "adversary_policy": 7404.732600479607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24084.152070389195, 8103.657266470898, 22995.8622334615, 25590.476940910554, 2521.2505933211523, 23938.2662563024, 21970.82448602002, 19223.636083969814, 23750.014876721743, 22928.95384286298, 19449.640374684313, 19419.82643277328, 5140.167962428099, 25115.653710463535, 26607.8600416222, 19112.21031978088, 18787.97653117282, 20893.35885371464, 24214.932807339832, 23429.27850933629, 17983.598861848823, 24800.388964157544, 21576.877429458564, 3906.909397614561, 19795.20227490049, 18963.277113067714, 18776.36448198697, 22168.161145216465, 17887.903492620997, 21009.139418596198, 19130.876888736846, 19263.920020102716, 25228.54143830899, 19453.553253974595, 22807.79902078367, 19531.246018803307, 22132.287434085025, 218.57429145514953, 22698.14390776236, 24617.545688548587, 22327.33027830001, 18797.783330849234, 19209.47316922437, 21860.594024668546, 23118.576052221943, 20224.249887588783, 19416.000745738038, 24146.122045884258, 19616.781067767286, 19668.338897745503, 19723.774016629315, 18515.15376076888, 18974.974114831035, 25642.60469478379, 23475.53994597724, 25266.311610103927, 1434.884841787232, 19577.385184117265, 3557.3676036112206, 25251.072036885216, 18980.885712736694, 22525.71095551887, 22020.951376580375, 24477.844473030265, 25104.847263924923, 25650.367336571817, 23101.178420566142, 20776.89879385875, 21937.62676148582, 23778.17552975342, 21875.239668817194, 25075.725233201876, 4436.572669212579, 21584.774019755965, 25953.242760304853, 22669.228096889434, 18987.163040819207, 23862.13840004807, 24907.1120133908, 16347.325836276543, 25079.657704170168, 17909.318251303554, 18958.49678752986, 19542.984079246446, 20776.584304384716, 21065.208645667768, 20971.964886210488, 22885.96637041229, 18368.917629849504, 25135.779893626885, 24092.393418525928, 19990.55210165987, 19065.39879040821, 21972.495260868665, 19212.6154862299, 23627.27570516108, 19025.049127640395, 22591.433987431566, 23462.90571019259, 19495.91153181275], "episode_lengths": [200, 65, 200, 200, 20, 200, 200, 200, 200, 200, 200, 200, 46, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3544.29360516629, 993.7765518021168, 4927.547001482494, 1742.4407463344478, 163.42803914171307, 3210.8699589117027, 6212.527476847812, 8284.810354604793, 3339.396891591987, 5223.186350292086, 8554.747632348293, 8468.47123108666, 647.4112442137554, 2144.034970235708, 1469.9394499415773, 8753.68843765769, 8680.01401475927, 6446.677048721919, 2983.6141093184615, 4574.55570305839, 10098.511529277857, 2888.6264810978028, 5362.188679497567, 120.90549862633327, 8292.795589464327, 8108.807557707388, 7928.25132136811, 5310.936308297029, 9110.537181658163, 7126.94194694933, 9008.58896221684, 7850.494575819146, 2126.8119949178313, 8269.630447210338, 5235.495771539754, 7625.26755671076, 6008.390939892708, 2.163511703441266, 5274.557392666771, 3132.6653749711686, 5516.3023576876285, 7486.78600743056, 8486.872927876035, 5796.223870135081, 4659.000442588068, 7412.164457611948, 8349.428248188413, 3355.087969716712, 8288.11193653816, 8480.704268868441, 8075.93870868845, 9125.94808618783, 8939.737154537394, 2524.2612001674934, 4527.0422298630965, 2285.4971194222067, 57.279993246292285, 8091.093015915544, 212.67803648900355, 2419.959279362689, 8332.342980604899, 5114.546410360883, 5955.449139007744, 3130.086292872366, 2818.7961295873365, 2015.2139526782555, 4860.399030322182, 7192.066189466466, 5521.617354124121, 4356.986179145114, 6255.697218897154, 3043.9573262750832, 146.77066240867282, 6583.722976345602, 2172.991883471578, 4591.69712747125, 6911.6312154786965, 4255.778756952651, 3187.215544602491, 10958.507644851768, 2637.7866756370886, 10176.416615550133, 9000.208864099734, 7763.618124219494, 5183.546632575025, 6301.074872612486, 6286.819402350507, 4935.229223327522, 7323.969939925439, 2924.721654033766, 3567.412342382593, 7474.745517454925, 8378.997769148747, 5344.19062006662, 8522.106043429465, 3895.5217288647373, 8357.959398590861, 4086.0344263422467, 4098.372509447702, 8367.70285979953], "policy_adversary_policy_reward": [10426.599888031053, 10113.25857719186, 3532.4866729536197, 3577.394041715161, 8900.321481051416, 9167.993750927571, 12397.290729659326, 11450.745464917141, 1250.7855232313818, 1107.0370309480568, 10921.498140709073, 9805.89815668177, 7909.680861066007, 7848.616148106152, 5857.243816950933, 5081.581912414194, 10801.718114236974, 9608.899870892721, 8795.959644453873, 8909.807848116872, 5309.801020426312, 5585.091721909707, 5286.03562362451, 5665.319578062126, 2605.279949244363, 1887.4767689699772, 11988.700098217765, 10982.918642009936, 12653.792529877912, 12484.128061802543, 4983.18252336485, 5375.339358758434, 5449.494560705013, 4658.467955708548, 6764.989046728914, 7681.692758263773, 11157.535106129213, 10073.783591892423, 9291.688776040994, 9563.03403023684, 4038.643503412904, 3846.4438291580464, 11043.008941957598, 10868.753541102144, 8777.54816112328, 7437.140588837867, 2000.414844933309, 1785.5890540549158, 5661.596634270753, 5840.810051165484, 4828.4260186851225, 6026.043536675252, 6213.307339254759, 4634.805821364135, 8827.031413280665, 8030.19342363882, 3750.6582774217177, 5026.708033541111, 6990.654983998639, 6891.542487648147, 4996.832445975942, 5125.455480544047, 5125.0235003599355, 6288.401943923646, 11244.440919918847, 11857.288523472274, 5313.909084021958, 5870.013722742383, 8736.971969687054, 8835.331279557045, 5392.549181237104, 6513.429280855253, 8110.982320425387, 8012.914173766856, 139.25784453386825, 77.15293521784002, 8557.458385979178, 8866.128129116392, 10997.079065251692, 10487.80124832557, 8483.403530209664, 8327.62439040259, 4662.941519319298, 6648.055804099394, 5595.948986909591, 5126.651254438852, 7728.583826590912, 8335.786327942607, 8981.544121457795, 9478.031488175942, 6085.196475259087, 6726.888954717712, 5787.321398584809, 5279.251098964834, 10600.657700208483, 10190.376375959013, 5837.76545586677, 5490.903675362304, 5595.171149768859, 5592.463479108206, 5655.53215702397, 5992.303150916922, 5013.609419999771, 4375.5962545811835, 4932.52547890415, 5102.711481389427, 11583.337818414826, 11535.005676201463, 9587.707487323785, 9360.790228790253, 11125.344661421028, 11855.469829260555, 791.2481441775649, 586.356704363375, 5435.309962425881, 6050.982205775872, 1763.7101660598146, 1580.9794010623998, 11713.44204010323, 11117.670717419489, 5803.681875633073, 4844.860856498586, 8571.71107915159, 8839.453466006355, 8011.502190403917, 8054.000047168711, 10685.977416675469, 10661.780763482753, 11137.181823354551, 11148.869310982847, 12124.925254412963, 11510.228129480796, 8979.72204527124, 9261.057344973004, 6808.453179723176, 6776.379424668916, 7814.471674455305, 8601.537732906383, 9765.525008523346, 9655.66434208492, 7767.892159023283, 7851.650290896694, 10975.569729452665, 11056.198177474049, 2176.028578324164, 2113.7734284797425, 7511.939650465551, 7489.111392944777, 11937.538362969555, 11842.712513864055, 9383.52306189289, 8694.00790752545, 7221.362409962065, 4854.169415378487, 9844.673765641397, 9761.685877453903, 10826.203101863508, 10893.693366924761, 2212.21537270738, 3176.602818717373, 11489.571861157421, 10952.299167375591, 3939.5128956209464, 3793.388740132444, 4819.537857229269, 5138.750066201094, 5404.061150501516, 6375.304804525455, 8949.418810533545, 6643.61886127619, 6927.24958324418, 7836.88418981115, 7583.634594666271, 7101.510889193825, 8790.993974872403, 9159.74317221222, 6806.51430055357, 4238.433389370519, 11146.109526632918, 11064.948712960144, 10111.703512188144, 10413.277563955036, 6667.261058210501, 5848.545525994353, 5754.452015570468, 4931.949005688978, 8767.944726436597, 7860.35991436549, 5615.774791515082, 5074.7346512852855, 10240.852825103548, 9490.901151192757, 4887.601183667031, 5779.488545382474, 8524.512581396411, 9980.88697969289, 9342.729348811734, 10021.80385193298, 5678.6929775772405, 5449.51569443605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992720377355217, "mean_inference_ms": 0.9930583578463037, "mean_action_processing_ms": 0.16757946359239256, "mean_env_wait_ms": 0.054228338363508204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005017995834350586, "StateBufferConnector_ms": 0.0036885738372802734, "ViewRequirementAgentConnector_ms": 0.06759560108184814}, "num_episodes": 20, "episode_return_max": 26607.8600416222, "episode_return_min": 218.57429145514953, "episode_return_mean": 20263.16546080335}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.8604408824106, "num_env_steps_trained_throughput_per_sec": 516.8604408824106, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 7481.651, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7481.61, "sample_time_ms": 763.521, "learn_time_ms": 6706.317, "learn_throughput": 596.453, "synch_weights_time_ms": 11.306}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 112, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-43-57", "timestamp": 1723236237, "time_this_iter_s": 7.743130207061768, "time_total_s": 856.9581053256989, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aeaca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 856.9581053256989, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 36.972727272727276, "ram_util_percent": 82.47272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1252369.7036334325, "cur_kl_coeff": 4483276.173380034, "cur_lr": 5.0000000000000016e-05, "total_loss": 276174.48087797617, "policy_loss": 0.0432351786544714, "vf_loss": 9.998940803891136, "vf_explained_var": -2.9936353996317225e-06, "kl": 0.06159880380663607, "entropy": 1.0527922055708667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9421989004593343, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.935417806108793, "policy_loss": -0.00454118596680928, "vf_loss": 9.937351564566294, "vf_explained_var": -0.0015627854814132054, "kl": 0.012208509799287033, "entropy": 1.1681540285547574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "env_runners": {"episode_reward_max": 25953.242760304853, "episode_reward_min": 218.57429145514953, "episode_reward_mean": 19818.51448217382, "episode_len_mean": 182.15, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 18215, "policy_reward_min": {"agent_policy": 2.163511703441266, "adversary_policy": 77.15293521784002}, "policy_reward_max": {"agent_policy": 10958.507644851768, "adversary_policy": 12124.925254412963}, "policy_reward_mean": {"agent_policy": 5294.894231135419, "adversary_policy": 7261.810125519201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3906.909397614561, 19795.20227490049, 18963.277113067714, 18776.36448198697, 22168.161145216465, 17887.903492620997, 21009.139418596198, 19130.876888736846, 19263.920020102716, 25228.54143830899, 19453.553253974595, 22807.79902078367, 19531.246018803307, 22132.287434085025, 218.57429145514953, 22698.14390776236, 24617.545688548587, 22327.33027830001, 18797.783330849234, 19209.47316922437, 21860.594024668546, 23118.576052221943, 20224.249887588783, 19416.000745738038, 24146.122045884258, 19616.781067767286, 19668.338897745503, 19723.774016629315, 18515.15376076888, 18974.974114831035, 25642.60469478379, 23475.53994597724, 25266.311610103927, 1434.884841787232, 19577.385184117265, 3557.3676036112206, 25251.072036885216, 18980.885712736694, 22525.71095551887, 22020.951376580375, 24477.844473030265, 25104.847263924923, 25650.367336571817, 23101.178420566142, 20776.89879385875, 21937.62676148582, 23778.17552975342, 21875.239668817194, 25075.725233201876, 4436.572669212579, 21584.774019755965, 25953.242760304853, 22669.228096889434, 18987.163040819207, 23862.13840004807, 24907.1120133908, 16347.325836276543, 25079.657704170168, 17909.318251303554, 18958.49678752986, 19542.984079246446, 20776.584304384716, 21065.208645667768, 20971.964886210488, 22885.96637041229, 18368.917629849504, 25135.779893626885, 24092.393418525928, 19990.55210165987, 19065.39879040821, 21972.495260868665, 19212.6154862299, 23627.27570516108, 19025.049127640395, 22591.433987431566, 23462.90571019259, 19495.91153181275, 21137.85034137732, 19129.949843972845, 19592.28578200732, 17850.26504715395, 19296.25651402953, 19143.36263348311, 15886.153449743788, 919.1575560354448, 19028.76262907992, 23357.04557275989, 4649.16074174625, 21415.867873297146, 20496.4256217543, 23067.350499778644, 22316.34847143762, 11053.671622169075, 24248.86693523629, 20503.47726578258, 23778.76009259372, 10311.46164308532, 23102.311914304533, 23567.51821600537, 13321.457319424484], "episode_lengths": [30, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 12, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 124, 7, 149, 200, 36, 176, 200, 186, 200, 99, 200, 200, 200, 91, 200, 200, 104], "policy_agent_policy_reward": [120.90549862633327, 8292.795589464327, 8108.807557707388, 7928.25132136811, 5310.936308297029, 9110.537181658163, 7126.94194694933, 9008.58896221684, 7850.494575819146, 2126.8119949178313, 8269.630447210338, 5235.495771539754, 7625.26755671076, 6008.390939892708, 2.163511703441266, 5274.557392666771, 3132.6653749711686, 5516.3023576876285, 7486.78600743056, 8486.872927876035, 5796.223870135081, 4659.000442588068, 7412.164457611948, 8349.428248188413, 3355.087969716712, 8288.11193653816, 8480.704268868441, 8075.93870868845, 9125.94808618783, 8939.737154537394, 2524.2612001674934, 4527.0422298630965, 2285.4971194222067, 57.279993246292285, 8091.093015915544, 212.67803648900355, 2419.959279362689, 8332.342980604899, 5114.546410360883, 5955.449139007744, 3130.086292872366, 2818.7961295873365, 2015.2139526782555, 4860.399030322182, 7192.066189466466, 5521.617354124121, 4356.986179145114, 6255.697218897154, 3043.9573262750832, 146.77066240867282, 6583.722976345602, 2172.991883471578, 4591.69712747125, 6911.6312154786965, 4255.778756952651, 3187.215544602491, 10958.507644851768, 2637.7866756370886, 10176.416615550133, 9000.208864099734, 7763.618124219494, 5183.546632575025, 6301.074872612486, 6286.819402350507, 4935.229223327522, 7323.969939925439, 2924.721654033766, 3567.412342382593, 7474.745517454925, 8378.997769148747, 5344.19062006662, 8522.106043429465, 3895.5217288647373, 8357.959398590861, 4086.0344263422467, 4098.372509447702, 8367.70285979953, 6863.447190932363, 8250.651798485762, 7659.425900229898, 854.5368070415855, 8465.341848603568, 8978.821949372099, 1396.8478034282239, 16.064958581142342, 1651.682295685295, 4429.2989221089765, 307.6325268706777, 2604.770869169644, 7468.631945478962, 2842.874945669524, 5118.547183091178, 1890.4102058480778, 3612.9069929339876, 6647.724442341887, 3883.7219535100317, 1050.337472755438, 4207.567726878255, 3902.447611870086, 730.461285631738], "policy_adversary_policy_reward": [2000.414844933309, 1785.5890540549158, 5661.596634270753, 5840.810051165484, 4828.4260186851225, 6026.043536675252, 6213.307339254759, 4634.805821364135, 8827.031413280665, 8030.19342363882, 3750.6582774217177, 5026.708033541111, 6990.654983998639, 6891.542487648147, 4996.832445975942, 5125.455480544047, 5125.0235003599355, 6288.401943923646, 11244.440919918847, 11857.288523472274, 5313.909084021958, 5870.013722742383, 8736.971969687054, 8835.331279557045, 5392.549181237104, 6513.429280855253, 8110.982320425387, 8012.914173766856, 139.25784453386825, 77.15293521784002, 8557.458385979178, 8866.128129116392, 10997.079065251692, 10487.80124832557, 8483.403530209664, 8327.62439040259, 4662.941519319298, 6648.055804099394, 5595.948986909591, 5126.651254438852, 7728.583826590912, 8335.786327942607, 8981.544121457795, 9478.031488175942, 6085.196475259087, 6726.888954717712, 5787.321398584809, 5279.251098964834, 10600.657700208483, 10190.376375959013, 5837.76545586677, 5490.903675362304, 5595.171149768859, 5592.463479108206, 5655.53215702397, 5992.303150916922, 5013.609419999771, 4375.5962545811835, 4932.52547890415, 5102.711481389427, 11583.337818414826, 11535.005676201463, 9587.707487323785, 9360.790228790253, 11125.344661421028, 11855.469829260555, 791.2481441775649, 586.356704363375, 5435.309962425881, 6050.982205775872, 1763.7101660598146, 1580.9794010623998, 11713.44204010323, 11117.670717419489, 5803.681875633073, 4844.860856498586, 8571.71107915159, 8839.453466006355, 8011.502190403917, 8054.000047168711, 10685.977416675469, 10661.780763482753, 11137.181823354551, 11148.869310982847, 12124.925254412963, 11510.228129480796, 8979.72204527124, 9261.057344973004, 6808.453179723176, 6776.379424668916, 7814.471674455305, 8601.537732906383, 9765.525008523346, 9655.66434208492, 7767.892159023283, 7851.650290896694, 10975.569729452665, 11056.198177474049, 2176.028578324164, 2113.7734284797425, 7511.939650465551, 7489.111392944777, 11937.538362969555, 11842.712513864055, 9383.52306189289, 8694.00790752545, 7221.362409962065, 4854.169415378487, 9844.673765641397, 9761.685877453903, 10826.203101863508, 10893.693366924761, 2212.21537270738, 3176.602818717373, 11489.571861157421, 10952.299167375591, 3939.5128956209464, 3793.388740132444, 4819.537857229269, 5138.750066201094, 5404.061150501516, 6375.304804525455, 8949.418810533545, 6643.61886127619, 6927.24958324418, 7836.88418981115, 7583.634594666271, 7101.510889193825, 8790.993974872403, 9159.74317221222, 6806.51430055357, 4238.433389370519, 11146.109526632918, 11064.948712960144, 10111.703512188144, 10413.277563955036, 6667.261058210501, 5848.545525994353, 5754.452015570468, 4931.949005688978, 8767.944726436597, 7860.35991436549, 5615.774791515082, 5074.7346512852855, 10240.852825103548, 9490.901151192757, 4887.601183667031, 5779.488545382474, 8524.512581396411, 9980.88697969289, 9342.729348811734, 10021.80385193298, 5678.6929775772405, 5449.51569443605, 7260.834938372932, 7013.56821207203, 5881.513590848895, 4997.784454638224, 5952.86546258763, 5979.994419189679, 8582.264722375943, 8413.463517736507, 5671.728892950347, 5159.185772475572, 5035.893869875893, 5128.646814235248, 7365.0060302322245, 7124.2996160833145, 424.18280920486166, 478.9097882494409, 8874.720939548646, 8502.359393845976, 9239.199650424525, 9688.547000226283, 2236.2351694828176, 2105.2930453927534, 9484.01832040941, 9327.078683718191, 6357.337961228616, 6670.455715046751, 10035.488293734496, 10188.987260374639, 9018.229668851258, 8179.571619495106, 5104.76390899597, 4058.49750732504, 10518.972693495045, 10116.987248807161, 6372.41266643132, 7483.340157009397, 10252.494354954857, 9642.543784128893, 5384.334236042142, 3876.789934287748, 9932.62974674467, 8962.114440681566, 10235.643024726109, 9429.42757940915, 5983.240376044946, 6607.755657747865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39915344156072713, "mean_inference_ms": 0.9927146383927125, "mean_action_processing_ms": 0.16753076113411386, "mean_env_wait_ms": 0.05421642563767338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003351926803588867, "StateBufferConnector_ms": 0.0039490461349487305, "ViewRequirementAgentConnector_ms": 0.06751716136932373}, "num_episodes": 23, "episode_return_max": 25953.242760304853, "episode_return_min": 218.57429145514953, "episode_return_mean": 19818.51448217382}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.9039949183064, "num_env_steps_trained_throughput_per_sec": 541.9039949183064, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 7458.343, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7458.302, "sample_time_ms": 764.002, "learn_time_ms": 6682.577, "learn_throughput": 598.571, "synch_weights_time_ms": 11.284}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "training_iteration": 113, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-04", "timestamp": 1723236244, "time_this_iter_s": 7.387264013290405, "time_total_s": 864.3453693389893, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aead30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 864.3453693389893, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 34.559999999999995, "ram_util_percent": 82.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1758235.8578621033, "cur_kl_coeff": 6724914.260070055, "cur_lr": 5.0000000000000016e-05, "total_loss": 362997.82861276454, "policy_loss": 0.03488375888065627, "vf_loss": 9.998721916461117, "vf_explained_var": -3.2433441707066125e-06, "kl": 0.05397656658004043, "entropy": 1.0676011768598406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9089510548238953, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.922593789299329, "policy_loss": -0.00759667502376639, "vf_loss": 9.924823005994162, "vf_explained_var": -0.0014147854099671045, "kl": 0.025131574673287103, "entropy": 1.1539205631862084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 26156.45815859055, "episode_reward_min": 919.1575560354448, "episode_reward_mean": 19867.96001585382, "episode_len_mean": 178.69, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 17869, "policy_reward_min": {"agent_policy": 16.064958581142342, "adversary_policy": 424.18280920486166}, "policy_reward_max": {"agent_policy": 10958.507644851768, "adversary_policy": 12703.581261825537}, "policy_reward_mean": {"agent_policy": 4799.165897532218, "adversary_policy": 7534.3970591607995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19668.338897745503, 19723.774016629315, 18515.15376076888, 18974.974114831035, 25642.60469478379, 23475.53994597724, 25266.311610103927, 1434.884841787232, 19577.385184117265, 3557.3676036112206, 25251.072036885216, 18980.885712736694, 22525.71095551887, 22020.951376580375, 24477.844473030265, 25104.847263924923, 25650.367336571817, 23101.178420566142, 20776.89879385875, 21937.62676148582, 23778.17552975342, 21875.239668817194, 25075.725233201876, 4436.572669212579, 21584.774019755965, 25953.242760304853, 22669.228096889434, 18987.163040819207, 23862.13840004807, 24907.1120133908, 16347.325836276543, 25079.657704170168, 17909.318251303554, 18958.49678752986, 19542.984079246446, 20776.584304384716, 21065.208645667768, 20971.964886210488, 22885.96637041229, 18368.917629849504, 25135.779893626885, 24092.393418525928, 19990.55210165987, 19065.39879040821, 21972.495260868665, 19212.6154862299, 23627.27570516108, 19025.049127640395, 22591.433987431566, 23462.90571019259, 19495.91153181275, 21137.85034137732, 19129.949843972845, 19592.28578200732, 17850.26504715395, 19296.25651402953, 19143.36263348311, 15886.153449743788, 919.1575560354448, 19028.76262907992, 23357.04557275989, 4649.16074174625, 21415.867873297146, 20496.4256217543, 23067.350499778644, 22316.34847143762, 11053.671622169075, 24248.86693523629, 20503.47726578258, 23778.76009259372, 10311.46164308532, 23102.311914304533, 23567.51821600537, 13321.457319424484, 25848.520547525786, 21674.721156995838, 20739.635099395495, 24343.280249570653, 14805.881756966515, 23650.059340302192, 17938.866577707187, 9412.631434715091, 25845.65898345451, 18100.276059972304, 21253.98469834557, 14828.6206363533, 25520.762009208425, 22201.31324889995, 26156.45815859055, 20119.210095491017, 19060.571631616036, 17988.64823570375, 10167.204896643767, 25502.12820937174, 24668.536767222075, 19276.37383379909, 14449.897984969482, 18743.2269324761, 10301.929630393784, 18652.511081116343], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 12, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 124, 7, 149, 200, 36, 176, 200, 186, 200, 99, 200, 200, 200, 91, 200, 200, 104, 200, 176, 200, 200, 122, 182, 200, 74, 200, 200, 173, 115, 200, 200, 200, 200, 200, 150, 77, 200, 200, 200, 127, 200, 90, 200], "policy_agent_policy_reward": [8480.704268868441, 8075.93870868845, 9125.94808618783, 8939.737154537394, 2524.2612001674934, 4527.0422298630965, 2285.4971194222067, 57.279993246292285, 8091.093015915544, 212.67803648900355, 2419.959279362689, 8332.342980604899, 5114.546410360883, 5955.449139007744, 3130.086292872366, 2818.7961295873365, 2015.2139526782555, 4860.399030322182, 7192.066189466466, 5521.617354124121, 4356.986179145114, 6255.697218897154, 3043.9573262750832, 146.77066240867282, 6583.722976345602, 2172.991883471578, 4591.69712747125, 6911.6312154786965, 4255.778756952651, 3187.215544602491, 10958.507644851768, 2637.7866756370886, 10176.416615550133, 9000.208864099734, 7763.618124219494, 5183.546632575025, 6301.074872612486, 6286.819402350507, 4935.229223327522, 7323.969939925439, 2924.721654033766, 3567.412342382593, 7474.745517454925, 8378.997769148747, 5344.19062006662, 8522.106043429465, 3895.5217288647373, 8357.959398590861, 4086.0344263422467, 4098.372509447702, 8367.70285979953, 6863.447190932363, 8250.651798485762, 7659.425900229898, 854.5368070415855, 8465.341848603568, 8978.821949372099, 1396.8478034282239, 16.064958581142342, 1651.682295685295, 4429.2989221089765, 307.6325268706777, 2604.770869169644, 7468.631945478962, 2842.874945669524, 5118.547183091178, 1890.4102058480778, 3612.9069929339876, 6647.724442341887, 3883.7219535100317, 1050.337472755438, 4207.567726878255, 3902.447611870086, 730.461285631738, 1879.5138131813687, 2896.0476197940598, 7128.726352062572, 2579.784833732156, 1941.7032969985771, 1623.129940578536, 9905.107729474552, 769.4821308884988, 1734.7119225258332, 9960.496189745647, 2835.910915992665, 1087.567756387174, 2195.180056805568, 5749.767793050358, 1433.739468481605, 7953.488137048398, 8056.577979636171, 2846.6416147883847, 438.22518211055996, 2477.8623899977124, 3458.0466976278003, 8683.454421136303, 2712.6524904001235, 8689.008860600867, 1850.2586052657036, 9423.30059086076], "policy_adversary_policy_reward": [5595.171149768859, 5592.463479108206, 5655.53215702397, 5992.303150916922, 5013.609419999771, 4375.5962545811835, 4932.52547890415, 5102.711481389427, 11583.337818414826, 11535.005676201463, 9587.707487323785, 9360.790228790253, 11125.344661421028, 11855.469829260555, 791.2481441775649, 586.356704363375, 5435.309962425881, 6050.982205775872, 1763.7101660598146, 1580.9794010623998, 11713.44204010323, 11117.670717419489, 5803.681875633073, 4844.860856498586, 8571.71107915159, 8839.453466006355, 8011.502190403917, 8054.000047168711, 10685.977416675469, 10661.780763482753, 11137.181823354551, 11148.869310982847, 12124.925254412963, 11510.228129480796, 8979.72204527124, 9261.057344973004, 6808.453179723176, 6776.379424668916, 7814.471674455305, 8601.537732906383, 9765.525008523346, 9655.66434208492, 7767.892159023283, 7851.650290896694, 10975.569729452665, 11056.198177474049, 2176.028578324164, 2113.7734284797425, 7511.939650465551, 7489.111392944777, 11937.538362969555, 11842.712513864055, 9383.52306189289, 8694.00790752545, 7221.362409962065, 4854.169415378487, 9844.673765641397, 9761.685877453903, 10826.203101863508, 10893.693366924761, 2212.21537270738, 3176.602818717373, 11489.571861157421, 10952.299167375591, 3939.5128956209464, 3793.388740132444, 4819.537857229269, 5138.750066201094, 5404.061150501516, 6375.304804525455, 8949.418810533545, 6643.61886127619, 6927.24958324418, 7836.88418981115, 7583.634594666271, 7101.510889193825, 8790.993974872403, 9159.74317221222, 6806.51430055357, 4238.433389370519, 11146.109526632918, 11064.948712960144, 10111.703512188144, 10413.277563955036, 6667.261058210501, 5848.545525994353, 5754.452015570468, 4931.949005688978, 8767.944726436597, 7860.35991436549, 5615.774791515082, 5074.7346512852855, 10240.852825103548, 9490.901151192757, 4887.601183667031, 5779.488545382474, 8524.512581396411, 9980.88697969289, 9342.729348811734, 10021.80385193298, 5678.6929775772405, 5449.51569443605, 7260.834938372932, 7013.56821207203, 5881.513590848895, 4997.784454638224, 5952.86546258763, 5979.994419189679, 8582.264722375943, 8413.463517736507, 5671.728892950347, 5159.185772475572, 5035.893869875893, 5128.646814235248, 7365.0060302322245, 7124.2996160833145, 424.18280920486166, 478.9097882494409, 8874.720939548646, 8502.359393845976, 9239.199650424525, 9688.547000226283, 2236.2351694828176, 2105.2930453927534, 9484.01832040941, 9327.078683718191, 6357.337961228616, 6670.455715046751, 10035.488293734496, 10188.987260374639, 9018.229668851258, 8179.571619495106, 5104.76390899597, 4058.49750732504, 10518.972693495045, 10116.987248807161, 6372.41266643132, 7483.340157009397, 10252.494354954857, 9642.543784128893, 5384.334236042142, 3876.789934287748, 9932.62974674467, 8962.114440681566, 10235.643024726109, 9429.42757940915, 5983.240376044946, 6607.755657747865, 11717.166304139591, 12251.84043020472, 9252.636884007901, 9526.03665319371, 6646.0641749352435, 6964.844572397692, 11558.576728336859, 10204.91868750156, 6181.889610543318, 6682.2888494245935, 10788.991314857245, 11237.93808486627, 4213.2804781755685, 3820.478370057073, 4305.462796553779, 4337.686507272804, 12180.372934650366, 11930.574126278221, 4080.157190904167, 4059.622679322509, 9356.960658873862, 9061.113123479043, 7042.160227258117, 6698.8926527079075, 11940.273341701082, 11385.308610701615, 8277.233394040148, 8174.312061809503, 12019.13742828323, 12703.581261825537, 6166.263333979835, 5999.4586244628845, 6080.007201825836, 4923.986450154004, 7752.322746324529, 7389.683874590878, 4878.341659014021, 4850.638055519192, 11448.182694083762, 11576.083125290545, 10567.962832556685, 10642.527237037635, 5408.340112140122, 5184.579300522726, 6251.884110550178, 5485.361384019215, 5447.74528626765, 4606.472785607577, 3940.3927264534063, 4511.278298674671, 4708.751914158298, 4520.458576097396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3989508447368897, "mean_inference_ms": 0.9923798649738346, "mean_action_processing_ms": 0.16744956848494755, "mean_env_wait_ms": 0.05416126510155643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031801462173461914, "StateBufferConnector_ms": 0.0026895999908447266, "ViewRequirementAgentConnector_ms": 0.06569528579711914}, "num_episodes": 26, "episode_return_max": 26156.45815859055, "episode_return_min": 919.1575560354448, "episode_return_mean": 19867.96001585382}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.2456347234962, "num_env_steps_trained_throughput_per_sec": 554.2456347234962, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 7453.528, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7453.487, "sample_time_ms": 762.434, "learn_time_ms": 6679.56, "learn_throughput": 598.842, "synch_weights_time_ms": 11.048}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 114, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-12", "timestamp": 1723236252, "time_this_iter_s": 7.222057104110718, "time_total_s": 871.5674264431, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aff0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 871.5674264431, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 32.39090909090908, "ram_util_percent": 82.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2505956.0497189155, "cur_kl_coeff": 10087371.390105082, "cur_lr": 5.0000000000000016e-05, "total_loss": 462476.87818080356, "policy_loss": 0.020571320143986552, "vf_loss": 9.99914818466025, "vf_explained_var": 2.94746545256761e-06, "kl": 0.04584612362949109, "entropy": 1.0715897579041738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9953535550273955, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.842293128371239, "policy_loss": -0.0003304090025873544, "vf_loss": 9.836534329255421, "vf_explained_var": -0.0014619175344705582, "kl": 0.019007264431760026, "entropy": 1.25959652873377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": 26156.45815859055, "episode_reward_min": 463.8728512710288, "episode_reward_mean": 17482.622290250118, "episode_len_mean": 154.51, "episode_media": {}, "episodes_this_iter": 34, "episodes_timesteps_total": 15451, "policy_reward_min": {"agent_policy": 6.153439527171123, "adversary_policy": 181.0301387964098}, "policy_reward_max": {"agent_policy": 9960.496189745647, "adversary_policy": 12703.581261825537}, "policy_reward_mean": {"agent_policy": 3712.1929727817205, "adversary_policy": 6885.214658734198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19542.984079246446, 20776.584304384716, 21065.208645667768, 20971.964886210488, 22885.96637041229, 18368.917629849504, 25135.779893626885, 24092.393418525928, 19990.55210165987, 19065.39879040821, 21972.495260868665, 19212.6154862299, 23627.27570516108, 19025.049127640395, 22591.433987431566, 23462.90571019259, 19495.91153181275, 21137.85034137732, 19129.949843972845, 19592.28578200732, 17850.26504715395, 19296.25651402953, 19143.36263348311, 15886.153449743788, 919.1575560354448, 19028.76262907992, 23357.04557275989, 4649.16074174625, 21415.867873297146, 20496.4256217543, 23067.350499778644, 22316.34847143762, 11053.671622169075, 24248.86693523629, 20503.47726578258, 23778.76009259372, 10311.46164308532, 23102.311914304533, 23567.51821600537, 13321.457319424484, 25848.520547525786, 21674.721156995838, 20739.635099395495, 24343.280249570653, 14805.881756966515, 23650.059340302192, 17938.866577707187, 9412.631434715091, 25845.65898345451, 18100.276059972304, 21253.98469834557, 14828.6206363533, 25520.762009208425, 22201.31324889995, 26156.45815859055, 20119.210095491017, 19060.571631616036, 17988.64823570375, 10167.204896643767, 25502.12820937174, 24668.536767222075, 19276.37383379909, 14449.897984969482, 18743.2269324761, 10301.929630393784, 18652.511081116343, 11794.681841037536, 25674.516077269614, 9471.075639062272, 1009.115456566701, 6038.137247945964, 23675.096369489864, 5470.965259385538, 19497.063031525664, 463.8728512710288, 757.7677096165261, 19588.85652432206, 20945.073160473396, 5707.257633074869, 23421.76406284365, 17122.568921132504, 9863.253915438007, 7549.681492396333, 11354.739418480302, 15282.672353551208, 19633.36952815883, 24565.222922572917, 23485.917013742448, 13864.328666670124, 20206.949442055295, 8828.836431859534, 24036.439016979493, 10953.483435385104, 18647.059755634116, 24139.0812833945, 9094.87413126593, 8336.764543919451, 3144.4289185668345, 2679.7929940628383, 12249.4082034676], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 136, 200, 200, 124, 7, 149, 200, 36, 176, 200, 186, 200, 99, 200, 200, 200, 91, 200, 200, 104, 200, 176, 200, 200, 122, 182, 200, 74, 200, 200, 173, 115, 200, 200, 200, 200, 200, 150, 77, 200, 200, 200, 127, 200, 90, 200, 105, 200, 86, 9, 52, 200, 47, 158, 4, 6, 200, 173, 48, 177, 140, 84, 62, 99, 118, 200, 200, 196, 113, 173, 72, 200, 90, 149, 200, 78, 67, 24, 21, 106], "policy_agent_policy_reward": [7763.618124219494, 5183.546632575025, 6301.074872612486, 6286.819402350507, 4935.229223327522, 7323.969939925439, 2924.721654033766, 3567.412342382593, 7474.745517454925, 8378.997769148747, 5344.19062006662, 8522.106043429465, 3895.5217288647373, 8357.959398590861, 4086.0344263422467, 4098.372509447702, 8367.70285979953, 6863.447190932363, 8250.651798485762, 7659.425900229898, 854.5368070415855, 8465.341848603568, 8978.821949372099, 1396.8478034282239, 16.064958581142342, 1651.682295685295, 4429.2989221089765, 307.6325268706777, 2604.770869169644, 7468.631945478962, 2842.874945669524, 5118.547183091178, 1890.4102058480778, 3612.9069929339876, 6647.724442341887, 3883.7219535100317, 1050.337472755438, 4207.567726878255, 3902.447611870086, 730.461285631738, 1879.5138131813687, 2896.0476197940598, 7128.726352062572, 2579.784833732156, 1941.7032969985771, 1623.129940578536, 9905.107729474552, 769.4821308884988, 1734.7119225258332, 9960.496189745647, 2835.910915992665, 1087.567756387174, 2195.180056805568, 5749.767793050358, 1433.739468481605, 7953.488137048398, 8056.577979636171, 2846.6416147883847, 438.22518211055996, 2477.8623899977124, 3458.0466976278003, 8683.454421136303, 2712.6524904001235, 8689.008860600867, 1850.2586052657036, 9423.30059086076, 1366.9748699046338, 1859.326414533506, 1842.4942505047838, 26.38566886367434, 468.1725883656641, 4357.2531506082205, 368.3783091268396, 1968.126257559518, 6.153439527171123, 9.989099165414213, 8189.294910804945, 3015.8712226525085, 218.5810222753442, 1092.50697481122, 1923.2754625572693, 1491.9823059843804, 740.1476086372176, 1599.4649779267181, 953.5056177505315, 8115.339708145636, 3226.8402092199785, 3500.4307581946327, 1503.398005068838, 2539.6635937955566, 692.3280784025127, 4113.850811315502, 1199.200107280234, 1832.874988042935, 3876.072761814427, 1323.127162512608, 514.5032628460419, 144.8246445860888, 154.3525397962495, 1028.042005329202], "policy_adversary_policy_reward": [5404.061150501516, 6375.304804525455, 8949.418810533545, 6643.61886127619, 6927.24958324418, 7836.88418981115, 7583.634594666271, 7101.510889193825, 8790.993974872403, 9159.74317221222, 6806.51430055357, 4238.433389370519, 11146.109526632918, 11064.948712960144, 10111.703512188144, 10413.277563955036, 6667.261058210501, 5848.545525994353, 5754.452015570468, 4931.949005688978, 8767.944726436597, 7860.35991436549, 5615.774791515082, 5074.7346512852855, 10240.852825103548, 9490.901151192757, 4887.601183667031, 5779.488545382474, 8524.512581396411, 9980.88697969289, 9342.729348811734, 10021.80385193298, 5678.6929775772405, 5449.51569443605, 7260.834938372932, 7013.56821207203, 5881.513590848895, 4997.784454638224, 5952.86546258763, 5979.994419189679, 8582.264722375943, 8413.463517736507, 5671.728892950347, 5159.185772475572, 5035.893869875893, 5128.646814235248, 7365.0060302322245, 7124.2996160833145, 424.18280920486166, 478.9097882494409, 8874.720939548646, 8502.359393845976, 9239.199650424525, 9688.547000226283, 2236.2351694828176, 2105.2930453927534, 9484.01832040941, 9327.078683718191, 6357.337961228616, 6670.455715046751, 10035.488293734496, 10188.987260374639, 9018.229668851258, 8179.571619495106, 5104.76390899597, 4058.49750732504, 10518.972693495045, 10116.987248807161, 6372.41266643132, 7483.340157009397, 10252.494354954857, 9642.543784128893, 5384.334236042142, 3876.789934287748, 9932.62974674467, 8962.114440681566, 10235.643024726109, 9429.42757940915, 5983.240376044946, 6607.755657747865, 11717.166304139591, 12251.84043020472, 9252.636884007901, 9526.03665319371, 6646.0641749352435, 6964.844572397692, 11558.576728336859, 10204.91868750156, 6181.889610543318, 6682.2888494245935, 10788.991314857245, 11237.93808486627, 4213.2804781755685, 3820.478370057073, 4305.462796553779, 4337.686507272804, 12180.372934650366, 11930.574126278221, 4080.157190904167, 4059.622679322509, 9356.960658873862, 9061.113123479043, 7042.160227258117, 6698.8926527079075, 11940.273341701082, 11385.308610701615, 8277.233394040148, 8174.312061809503, 12019.13742828323, 12703.581261825537, 6166.263333979835, 5999.4586244628845, 6080.007201825836, 4923.986450154004, 7752.322746324529, 7389.683874590878, 4878.341659014021, 4850.638055519192, 11448.182694083762, 11576.083125290545, 10567.962832556685, 10642.527237037635, 5408.340112140122, 5184.579300522726, 6251.884110550178, 5485.361384019215, 5447.74528626765, 4606.472785607577, 3940.3927264534063, 4511.278298674671, 4708.751914158298, 4520.458576097396, 4370.0606385787805, 6057.646332554112, 12242.706903895081, 11572.482758841044, 3391.018907619118, 4237.562480938384, 610.0104342042185, 372.7193534988082, 3208.7826738043836, 2361.1819857759187, 9709.865702146366, 9607.97751673526, 2955.023562449933, 2147.5633878087624, 9195.203720608792, 8333.733053357288, 181.0301387964098, 276.6892729474479, 414.2749695465143, 333.50364090459755, 5461.647699642364, 5937.913913874659, 8713.605354160087, 9215.596583660783, 3175.5315274200834, 2313.1450833794393, 11042.470303409193, 11286.786784623371, 7860.5114500133795, 7338.782008561933, 3931.7060288111284, 4439.565580642497, 3165.619449039734, 3643.9144347193746, 5400.892155820108, 4354.382284733481, 7359.039837254656, 6970.126898545948, 5503.832431003995, 6014.1973890091695, 10867.627455008902, 10470.755258344008, 10349.862153061697, 9635.624102486085, 6069.319429978673, 6291.6112316226145, 9687.64734309825, 7979.638505161531, 4398.8407461406305, 3737.667607316397, 9960.944783957319, 9961.643421706694, 5164.760923398692, 4589.522404706174, 8631.1911482108, 8182.993619380352, 10033.330050559103, 10229.678471020996, 3845.2622910289483, 3926.484677724368, 4222.863220746883, 3599.398060326523, 1447.3726437191208, 1552.231630261626, 1330.5717006955, 1194.8687535710874, 6467.289875248209, 4754.076322890168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988377292344137, "mean_inference_ms": 0.9924858093365804, "mean_action_processing_ms": 0.16762665316450487, "mean_env_wait_ms": 0.05408894013726218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038042068481445312, "StateBufferConnector_ms": 0.0028209686279296875, "ViewRequirementAgentConnector_ms": 0.06941342353820801}, "num_episodes": 34, "episode_return_max": 26156.45815859055, "episode_return_min": 463.8728512710288, "episode_return_mean": 17482.622290250118}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 522.9146626849572, "num_env_steps_trained_throughput_per_sec": 522.9146626849572, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 7501.209, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7501.168, "sample_time_ms": 781.325, "learn_time_ms": 6708.247, "learn_throughput": 596.281, "synch_weights_time_ms": 11.153}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 115, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-19", "timestamp": 1723236259, "time_this_iter_s": 7.655026912689209, "time_total_s": 879.2224533557892, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 879.2224533557892, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 35.74545454545454, "ram_util_percent": 82.67272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3718987.1015707674, "cur_kl_coeff": 15131057.085157625, "cur_lr": 5.0000000000000016e-05, "total_loss": 592200.4976686508, "policy_loss": 0.018973131399483433, "vf_loss": 9.996387749121933, "vf_explained_var": 1.0517539170684008e-07, "kl": 0.039137416595110185, "entropy": 1.0799107957769323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0120901178102941, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.873630377650262, "policy_loss": -0.0067321928962580085, "vf_loss": 9.876441287000974, "vf_explained_var": -0.0015355678896109262, "kl": 0.012240065388323274, "entropy": 1.2147522655626137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 26156.45815859055, "episode_reward_min": 463.8728512710288, "episode_reward_mean": 16875.678758023518, "episode_len_mean": 147.14, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 14714, "policy_reward_min": {"agent_policy": 6.153439527171123, "adversary_policy": 181.0301387964098}, "policy_reward_max": {"agent_policy": 9960.496189745647, "adversary_policy": 12703.581261825537}, "policy_reward_mean": {"agent_policy": 3270.9952193318227, "adversary_policy": 6802.341769345848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21415.867873297146, 20496.4256217543, 23067.350499778644, 22316.34847143762, 11053.671622169075, 24248.86693523629, 20503.47726578258, 23778.76009259372, 10311.46164308532, 23102.311914304533, 23567.51821600537, 13321.457319424484, 25848.520547525786, 21674.721156995838, 20739.635099395495, 24343.280249570653, 14805.881756966515, 23650.059340302192, 17938.866577707187, 9412.631434715091, 25845.65898345451, 18100.276059972304, 21253.98469834557, 14828.6206363533, 25520.762009208425, 22201.31324889995, 26156.45815859055, 20119.210095491017, 19060.571631616036, 17988.64823570375, 10167.204896643767, 25502.12820937174, 24668.536767222075, 19276.37383379909, 14449.897984969482, 18743.2269324761, 10301.929630393784, 18652.511081116343, 11794.681841037536, 25674.516077269614, 9471.075639062272, 1009.115456566701, 6038.137247945964, 23675.096369489864, 5470.965259385538, 19497.063031525664, 463.8728512710288, 757.7677096165261, 19588.85652432206, 20945.073160473396, 5707.257633074869, 23421.76406284365, 17122.568921132504, 9863.253915438007, 7549.681492396333, 11354.739418480302, 15282.672353551208, 19633.36952815883, 24565.222922572917, 23485.917013742448, 13864.328666670124, 20206.949442055295, 8828.836431859534, 24036.439016979493, 10953.483435385104, 18647.059755634116, 24139.0812833945, 9094.87413126593, 8336.764543919451, 3144.4289185668345, 2679.7929940628383, 12249.4082034676, 18689.270865356528, 15498.87174097736, 7731.16198448967, 17957.525576167962, 22268.271887046914, 12424.938986641355, 17287.631553121704, 16104.238646624004, 19167.278939212065, 20872.388077755128, 15364.854758062313, 10155.05028745118, 22557.349325991683, 15862.424818988653, 19242.07491324081, 10831.106081671456, 23613.35775478119, 13921.513586371106, 21057.851398775874, 20262.297130160354, 17969.956148601574, 10253.580778632298, 23607.224406940473, 18358.041757964747, 13438.979465944913, 16539.993939454187, 18367.548610384314, 21174.550397248204], "episode_lengths": [176, 200, 186, 200, 99, 200, 200, 200, 91, 200, 200, 104, 200, 176, 200, 200, 122, 182, 200, 74, 200, 200, 173, 115, 200, 200, 200, 200, 200, 150, 77, 200, 200, 200, 127, 200, 90, 200, 105, 200, 86, 9, 52, 200, 47, 158, 4, 6, 200, 173, 48, 177, 140, 84, 62, 99, 118, 200, 200, 196, 113, 173, 72, 200, 90, 149, 200, 78, 67, 24, 21, 106, 200, 128, 66, 152, 174, 107, 139, 124, 200, 200, 125, 77, 200, 125, 164, 85, 190, 125, 168, 200, 200, 83, 200, 200, 105, 200, 200, 178], "policy_agent_policy_reward": [2604.770869169644, 7468.631945478962, 2842.874945669524, 5118.547183091178, 1890.4102058480778, 3612.9069929339876, 6647.724442341887, 3883.7219535100317, 1050.337472755438, 4207.567726878255, 3902.447611870086, 730.461285631738, 1879.5138131813687, 2896.0476197940598, 7128.726352062572, 2579.784833732156, 1941.7032969985771, 1623.129940578536, 9905.107729474552, 769.4821308884988, 1734.7119225258332, 9960.496189745647, 2835.910915992665, 1087.567756387174, 2195.180056805568, 5749.767793050358, 1433.739468481605, 7953.488137048398, 8056.577979636171, 2846.6416147883847, 438.22518211055996, 2477.8623899977124, 3458.0466976278003, 8683.454421136303, 2712.6524904001235, 8689.008860600867, 1850.2586052657036, 9423.30059086076, 1366.9748699046338, 1859.326414533506, 1842.4942505047838, 26.38566886367434, 468.1725883656641, 4357.2531506082205, 368.3783091268396, 1968.126257559518, 6.153439527171123, 9.989099165414213, 8189.294910804945, 3015.8712226525085, 218.5810222753442, 1092.50697481122, 1923.2754625572693, 1491.9823059843804, 740.1476086372176, 1599.4649779267181, 953.5056177505315, 8115.339708145636, 3226.8402092199785, 3500.4307581946327, 1503.398005068838, 2539.6635937955566, 692.3280784025127, 4113.850811315502, 1199.200107280234, 1832.874988042935, 3876.072761814427, 1323.127162512608, 514.5032628460419, 144.8246445860888, 154.3525397962495, 1028.042005329202, 8916.440717091702, 2147.7939899803214, 807.5138533248966, 2433.4715532872888, 2025.84148543549, 1100.4392728774646, 2184.669329467036, 955.2123728862094, 8151.46495081834, 7270.170607137838, 1755.760281887133, 416.5526357907986, 5472.161985339548, 1301.3735025467813, 2773.750658081825, 872.3180228448957, 2741.3540661636325, 2012.9711402957917, 2461.1109832181905, 6777.415081220408, 9844.167837014564, 954.4775233012318, 3017.3245242670155, 9056.387578572241, 770.800514787464, 9416.168460775341, 8765.420958795012, 3163.465833713045], "policy_adversary_policy_reward": [9484.01832040941, 9327.078683718191, 6357.337961228616, 6670.455715046751, 10035.488293734496, 10188.987260374639, 9018.229668851258, 8179.571619495106, 5104.76390899597, 4058.49750732504, 10518.972693495045, 10116.987248807161, 6372.41266643132, 7483.340157009397, 10252.494354954857, 9642.543784128893, 5384.334236042142, 3876.789934287748, 9932.62974674467, 8962.114440681566, 10235.643024726109, 9429.42757940915, 5983.240376044946, 6607.755657747865, 11717.166304139591, 12251.84043020472, 9252.636884007901, 9526.03665319371, 6646.0641749352435, 6964.844572397692, 11558.576728336859, 10204.91868750156, 6181.889610543318, 6682.2888494245935, 10788.991314857245, 11237.93808486627, 4213.2804781755685, 3820.478370057073, 4305.462796553779, 4337.686507272804, 12180.372934650366, 11930.574126278221, 4080.157190904167, 4059.622679322509, 9356.960658873862, 9061.113123479043, 7042.160227258117, 6698.8926527079075, 11940.273341701082, 11385.308610701615, 8277.233394040148, 8174.312061809503, 12019.13742828323, 12703.581261825537, 6166.263333979835, 5999.4586244628845, 6080.007201825836, 4923.986450154004, 7752.322746324529, 7389.683874590878, 4878.341659014021, 4850.638055519192, 11448.182694083762, 11576.083125290545, 10567.962832556685, 10642.527237037635, 5408.340112140122, 5184.579300522726, 6251.884110550178, 5485.361384019215, 5447.74528626765, 4606.472785607577, 3940.3927264534063, 4511.278298674671, 4708.751914158298, 4520.458576097396, 4370.0606385787805, 6057.646332554112, 12242.706903895081, 11572.482758841044, 3391.018907619118, 4237.562480938384, 610.0104342042185, 372.7193534988082, 3208.7826738043836, 2361.1819857759187, 9709.865702146366, 9607.97751673526, 2955.023562449933, 2147.5633878087624, 9195.203720608792, 8333.733053357288, 181.0301387964098, 276.6892729474479, 414.2749695465143, 333.50364090459755, 5461.647699642364, 5937.913913874659, 8713.605354160087, 9215.596583660783, 3175.5315274200834, 2313.1450833794393, 11042.470303409193, 11286.786784623371, 7860.5114500133795, 7338.782008561933, 3931.7060288111284, 4439.565580642497, 3165.619449039734, 3643.9144347193746, 5400.892155820108, 4354.382284733481, 7359.039837254656, 6970.126898545948, 5503.832431003995, 6014.1973890091695, 10867.627455008902, 10470.755258344008, 10349.862153061697, 9635.624102486085, 6069.319429978673, 6291.6112316226145, 9687.64734309825, 7979.638505161531, 4398.8407461406305, 3737.667607316397, 9960.944783957319, 9961.643421706694, 5164.760923398692, 4589.522404706174, 8631.1911482108, 8182.993619380352, 10033.330050559103, 10229.678471020996, 3845.2622910289483, 3926.484677724368, 4222.863220746883, 3599.398060326523, 1447.3726437191208, 1552.231630261626, 1330.5717006955, 1194.8687535710874, 6467.289875248209, 4754.076322890168, 4568.77646194497, 5204.053686319983, 6902.675958604316, 6448.401792392754, 3539.6165375441947, 3384.031593620578, 7226.983189711577, 8297.070833169148, 10093.845483715393, 10148.584917895992, 4858.896427945334, 6465.603285818594, 7588.79637337559, 7514.16585027904, 7355.73339048686, 7793.292883250964, 5096.295684055974, 5919.5183043377865, 6739.632201068884, 6862.585269548468, 6623.657875346513, 6985.436600828677, 4750.138477901116, 4988.359173759272, 8435.021503448314, 8650.165837203835, 7431.082260827092, 7129.969055614749, 8800.951981497581, 7667.372273661385, 4881.387111003203, 5077.400947823353, 10313.387013431122, 10558.616675186455, 5082.678821539254, 6825.863624536049, 9192.495876638532, 9404.244538919067, 6120.26482738899, 7364.617221550991, 3832.155912829322, 4293.632398757807, 4914.508760547107, 4384.594494783942, 9467.971470689654, 11121.928411983892, 4266.501899672445, 5035.152279720008, 6014.358263486163, 6653.82068767129, 2410.244035519752, 4713.581443159053, 5333.416101289855, 4268.711550299515, 8589.903466599986, 9421.181096935192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3989468073334153, "mean_inference_ms": 0.9929686422390429, "mean_action_processing_ms": 0.16766246040687005, "mean_env_wait_ms": 0.05410435948196131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038205385208129883, "StateBufferConnector_ms": 0.0026242733001708984, "ViewRequirementAgentConnector_ms": 0.06853711605072021}, "num_episodes": 28, "episode_return_max": 26156.45815859055, "episode_return_min": 463.8728512710288, "episode_return_mean": 16875.678758023518}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 529.3675963994632, "num_env_steps_trained_throughput_per_sec": 529.3675963994632, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 7523.538, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7523.496, "sample_time_ms": 781.794, "learn_time_ms": 6730.36, "learn_throughput": 594.322, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 116, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-27", "timestamp": 1723236267, "time_this_iter_s": 7.560316801071167, "time_total_s": 886.7827701568604, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aff700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 886.7827701568604, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 33.92727272727273, "ram_util_percent": 82.44545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5063538.0363095235, "cur_kl_coeff": 22696585.62773643, "cur_lr": 5.0000000000000016e-05, "total_loss": 989297.96807209, "policy_loss": 0.023098442928493515, "vf_loss": 10.0, "vf_explained_var": 1.4489605313255674e-06, "kl": 0.04358752223776367, "entropy": 1.086471619807854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0113516238207618, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.918899601697921, "policy_loss": -0.008875231988107165, "vf_loss": 9.921902772784232, "vf_explained_var": -0.0012776654213666916, "kl": 0.01832954068183123, "entropy": 1.3100699488073588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "env_runners": {"episode_reward_max": 26156.45815859055, "episode_reward_min": 463.8728512710288, "episode_reward_mean": 16534.80129473187, "episode_len_mean": 143.6, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 14360, "policy_reward_min": {"agent_policy": 6.153439527171123, "adversary_policy": 181.0301387964098}, "policy_reward_max": {"agent_policy": 9844.167837014564, "adversary_policy": 12703.581261825537}, "policy_reward_mean": {"agent_policy": 3123.678622928302, "adversary_policy": 6705.561335901785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14828.6206363533, 25520.762009208425, 22201.31324889995, 26156.45815859055, 20119.210095491017, 19060.571631616036, 17988.64823570375, 10167.204896643767, 25502.12820937174, 24668.536767222075, 19276.37383379909, 14449.897984969482, 18743.2269324761, 10301.929630393784, 18652.511081116343, 11794.681841037536, 25674.516077269614, 9471.075639062272, 1009.115456566701, 6038.137247945964, 23675.096369489864, 5470.965259385538, 19497.063031525664, 463.8728512710288, 757.7677096165261, 19588.85652432206, 20945.073160473396, 5707.257633074869, 23421.76406284365, 17122.568921132504, 9863.253915438007, 7549.681492396333, 11354.739418480302, 15282.672353551208, 19633.36952815883, 24565.222922572917, 23485.917013742448, 13864.328666670124, 20206.949442055295, 8828.836431859534, 24036.439016979493, 10953.483435385104, 18647.059755634116, 24139.0812833945, 9094.87413126593, 8336.764543919451, 3144.4289185668345, 2679.7929940628383, 12249.4082034676, 18689.270865356528, 15498.87174097736, 7731.16198448967, 17957.525576167962, 22268.271887046914, 12424.938986641355, 17287.631553121704, 16104.238646624004, 19167.278939212065, 20872.388077755128, 15364.854758062313, 10155.05028745118, 22557.349325991683, 15862.424818988653, 19242.07491324081, 10831.106081671456, 23613.35775478119, 13921.513586371106, 21057.851398775874, 20262.297130160354, 17969.956148601574, 10253.580778632298, 23607.224406940473, 18358.041757964747, 13438.979465944913, 16539.993939454187, 18367.548610384314, 21174.550397248204, 13743.601661394212, 23094.826380089344, 22404.598785176455, 23952.50288544953, 20386.360836198997, 4569.87040354334, 16038.018027722448, 24335.689671004235, 23666.10834104048, 14986.735159457789, 14891.7366520364, 17964.638938963784, 19340.93444651826, 22995.69744304991, 2573.166129668059, 18668.36447231519, 22331.513683749003, 24245.182944281794, 18743.042377069636, 17698.978384114547, 17074.741309578985, 17873.281582860636, 25129.696535372357], "episode_lengths": [115, 200, 200, 200, 200, 200, 150, 77, 200, 200, 200, 127, 200, 90, 200, 105, 200, 86, 9, 52, 200, 47, 158, 4, 6, 200, 173, 48, 177, 140, 84, 62, 99, 118, 200, 200, 196, 113, 173, 72, 200, 90, 149, 200, 78, 67, 24, 21, 106, 200, 128, 66, 152, 174, 107, 139, 124, 200, 200, 125, 77, 200, 125, 164, 85, 190, 125, 168, 200, 200, 83, 200, 200, 105, 200, 200, 178, 110, 200, 200, 200, 167, 39, 122, 200, 193, 121, 114, 137, 200, 195, 20, 200, 200, 200, 200, 139, 136, 136, 200], "policy_agent_policy_reward": [1087.567756387174, 2195.180056805568, 5749.767793050358, 1433.739468481605, 7953.488137048398, 8056.577979636171, 2846.6416147883847, 438.22518211055996, 2477.8623899977124, 3458.0466976278003, 8683.454421136303, 2712.6524904001235, 8689.008860600867, 1850.2586052657036, 9423.30059086076, 1366.9748699046338, 1859.326414533506, 1842.4942505047838, 26.38566886367434, 468.1725883656641, 4357.2531506082205, 368.3783091268396, 1968.126257559518, 6.153439527171123, 9.989099165414213, 8189.294910804945, 3015.8712226525085, 218.5810222753442, 1092.50697481122, 1923.2754625572693, 1491.9823059843804, 740.1476086372176, 1599.4649779267181, 953.5056177505315, 8115.339708145636, 3226.8402092199785, 3500.4307581946327, 1503.398005068838, 2539.6635937955566, 692.3280784025127, 4113.850811315502, 1199.200107280234, 1832.874988042935, 3876.072761814427, 1323.127162512608, 514.5032628460419, 144.8246445860888, 154.3525397962495, 1028.042005329202, 8916.440717091702, 2147.7939899803214, 807.5138533248966, 2433.4715532872888, 2025.84148543549, 1100.4392728774646, 2184.669329467036, 955.2123728862094, 8151.46495081834, 7270.170607137838, 1755.760281887133, 416.5526357907986, 5472.161985339548, 1301.3735025467813, 2773.750658081825, 872.3180228448957, 2741.3540661636325, 2012.9711402957917, 2461.1109832181905, 6777.415081220408, 9844.167837014564, 954.4775233012318, 3017.3245242670155, 9056.387578572241, 770.800514787464, 9416.168460775341, 8765.420958795012, 3163.465833713045, 1272.9498681175253, 3920.0817415968895, 5367.804374698776, 3719.0020983929844, 2051.077703682661, 443.79858616954965, 1073.1951399019963, 3362.731183391598, 3236.6954836499817, 1179.2074601158417, 892.3802518455509, 1139.7434993721936, 8149.058770422225, 3673.4086196907606, 162.91540526396105, 8963.48159371085, 3889.576011058548, 3699.6659589530473, 9054.267849605798, 1635.116036160614, 1758.0835337226492, 985.1886271053054, 2853.9279431718587], "policy_adversary_policy_reward": [7042.160227258117, 6698.8926527079075, 11940.273341701082, 11385.308610701615, 8277.233394040148, 8174.312061809503, 12019.13742828323, 12703.581261825537, 6166.263333979835, 5999.4586244628845, 6080.007201825836, 4923.986450154004, 7752.322746324529, 7389.683874590878, 4878.341659014021, 4850.638055519192, 11448.182694083762, 11576.083125290545, 10567.962832556685, 10642.527237037635, 5408.340112140122, 5184.579300522726, 6251.884110550178, 5485.361384019215, 5447.74528626765, 4606.472785607577, 3940.3927264534063, 4511.278298674671, 4708.751914158298, 4520.458576097396, 4370.0606385787805, 6057.646332554112, 12242.706903895081, 11572.482758841044, 3391.018907619118, 4237.562480938384, 610.0104342042185, 372.7193534988082, 3208.7826738043836, 2361.1819857759187, 9709.865702146366, 9607.97751673526, 2955.023562449933, 2147.5633878087624, 9195.203720608792, 8333.733053357288, 181.0301387964098, 276.6892729474479, 414.2749695465143, 333.50364090459755, 5461.647699642364, 5937.913913874659, 8713.605354160087, 9215.596583660783, 3175.5315274200834, 2313.1450833794393, 11042.470303409193, 11286.786784623371, 7860.5114500133795, 7338.782008561933, 3931.7060288111284, 4439.565580642497, 3165.619449039734, 3643.9144347193746, 5400.892155820108, 4354.382284733481, 7359.039837254656, 6970.126898545948, 5503.832431003995, 6014.1973890091695, 10867.627455008902, 10470.755258344008, 10349.862153061697, 9635.624102486085, 6069.319429978673, 6291.6112316226145, 9687.64734309825, 7979.638505161531, 4398.8407461406305, 3737.667607316397, 9960.944783957319, 9961.643421706694, 5164.760923398692, 4589.522404706174, 8631.1911482108, 8182.993619380352, 10033.330050559103, 10229.678471020996, 3845.2622910289483, 3926.484677724368, 4222.863220746883, 3599.398060326523, 1447.3726437191208, 1552.231630261626, 1330.5717006955, 1194.8687535710874, 6467.289875248209, 4754.076322890168, 4568.77646194497, 5204.053686319983, 6902.675958604316, 6448.401792392754, 3539.6165375441947, 3384.031593620578, 7226.983189711577, 8297.070833169148, 10093.845483715393, 10148.584917895992, 4858.896427945334, 6465.603285818594, 7588.79637337559, 7514.16585027904, 7355.73339048686, 7793.292883250964, 5096.295684055974, 5919.5183043377865, 6739.632201068884, 6862.585269548468, 6623.657875346513, 6985.436600828677, 4750.138477901116, 4988.359173759272, 8435.021503448314, 8650.165837203835, 7431.082260827092, 7129.969055614749, 8800.951981497581, 7667.372273661385, 4881.387111003203, 5077.400947823353, 10313.387013431122, 10558.616675186455, 5082.678821539254, 6825.863624536049, 9192.495876638532, 9404.244538919067, 6120.26482738899, 7364.617221550991, 3832.155912829322, 4293.632398757807, 4914.508760547107, 4384.594494783942, 9467.971470689654, 11121.928411983892, 4266.501899672445, 5035.152279720008, 6014.358263486163, 6653.82068767129, 2410.244035519752, 4713.581443159053, 5333.416101289855, 4268.711550299515, 8589.903466599986, 9421.181096935192, 5972.204433781733, 6498.447359494961, 10221.512744010532, 8953.231894481845, 8413.07668815205, 8623.717722325606, 10391.743600808206, 9841.757186248347, 8728.431965915317, 9606.85116660099, 1812.1539569158049, 2313.9178604579856, 7539.235917111047, 7425.586970709375, 10225.579798984472, 10747.378688628118, 10027.496369007058, 10401.91648838338, 7376.409306227904, 6431.118393114023, 7149.156437367349, 6850.199962823516, 8357.113825688206, 8467.78161390343, 5201.955818810588, 5989.919857285396, 9227.801549919946, 10094.487273439345, 1251.298157109134, 1158.952567294964, 4531.380534663888, 5173.502343940469, 8190.279774301016, 10251.657898389374, 10144.740086018368, 10400.776899310433, 5086.844307916963, 4601.930219546914, 8141.9930657122095, 7921.869282241716, 7742.476573025559, 7574.181202830765, 8275.100527425036, 8612.992428330326, 11040.368437060264, 11235.40015514017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39888243529371736, "mean_inference_ms": 0.992911047686114, "mean_action_processing_ms": 0.16766470453417157, "mean_env_wait_ms": 0.05414026265102616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003760099411010742, "StateBufferConnector_ms": 0.0026253461837768555, "ViewRequirementAgentConnector_ms": 0.06723380088806152}, "num_episodes": 23, "episode_return_max": 26156.45815859055, "episode_return_min": 463.8728512710288, "episode_return_mean": 16534.80129473187}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.5569406746457, "num_env_steps_trained_throughput_per_sec": 551.5569406746457, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 7438.246, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7438.205, "sample_time_ms": 782.676, "learn_time_ms": 6644.272, "learn_throughput": 602.022, "synch_weights_time_ms": 10.814}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "training_iteration": 117, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-34", "timestamp": 1723236274, "time_this_iter_s": 7.257957935333252, "time_total_s": 894.0407280921936, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aff790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 894.0407280921936, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 31.409999999999997, "ram_util_percent": 82.53}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6374469.924107143, "cur_kl_coeff": 34044878.44160463, "cur_lr": 5.0000000000000016e-05, "total_loss": 1128562.8808366403, "policy_loss": 0.021224509052212827, "vf_loss": 9.997493865502575, "vf_explained_var": -1.895679998650122e-07, "kl": 0.03314897457689599, "entropy": 1.0937962217305703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0124495673924685, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.912476179997126, "policy_loss": -0.0025339922237132364, "vf_loss": 9.909798552592596, "vf_explained_var": -0.0012040996303160985, "kl": 0.016267931182907584, "entropy": 1.3374024418493111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 25280.434469630793, "episode_reward_min": 2573.166129668059, "episode_reward_mean": 17294.293507838476, "episode_len_mean": 150.08, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 15008, "policy_reward_min": {"agent_policy": 144.8246445860888, "adversary_policy": 1158.952567294964}, "policy_reward_max": {"agent_policy": 9844.167837014564, "adversary_policy": 11627.218469801712}, "policy_reward_mean": {"agent_policy": 3274.363381462852, "adversary_policy": 7009.965063187815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5707.257633074869, 23421.76406284365, 17122.568921132504, 9863.253915438007, 7549.681492396333, 11354.739418480302, 15282.672353551208, 19633.36952815883, 24565.222922572917, 23485.917013742448, 13864.328666670124, 20206.949442055295, 8828.836431859534, 24036.439016979493, 10953.483435385104, 18647.059755634116, 24139.0812833945, 9094.87413126593, 8336.764543919451, 3144.4289185668345, 2679.7929940628383, 12249.4082034676, 18689.270865356528, 15498.87174097736, 7731.16198448967, 17957.525576167962, 22268.271887046914, 12424.938986641355, 17287.631553121704, 16104.238646624004, 19167.278939212065, 20872.388077755128, 15364.854758062313, 10155.05028745118, 22557.349325991683, 15862.424818988653, 19242.07491324081, 10831.106081671456, 23613.35775478119, 13921.513586371106, 21057.851398775874, 20262.297130160354, 17969.956148601574, 10253.580778632298, 23607.224406940473, 18358.041757964747, 13438.979465944913, 16539.993939454187, 18367.548610384314, 21174.550397248204, 13743.601661394212, 23094.826380089344, 22404.598785176455, 23952.50288544953, 20386.360836198997, 4569.87040354334, 16038.018027722448, 24335.689671004235, 23666.10834104048, 14986.735159457789, 14891.7366520364, 17964.638938963784, 19340.93444651826, 22995.69744304991, 2573.166129668059, 18668.36447231519, 22331.513683749003, 24245.182944281794, 18743.042377069636, 17698.978384114547, 17074.741309578985, 17873.281582860636, 25129.696535372357, 10297.118892257356, 12464.376870796801, 18548.177952144324, 23734.58056110137, 11060.583930689942, 24725.282322941384, 24355.25044940689, 20957.053350869264, 19064.223062733337, 19389.661371538805, 13966.05530349585, 18420.58033613537, 20962.299170214945, 17278.502764871937, 22100.994041506696, 9123.118841555304, 25280.434469630793, 3118.570844544032, 18983.755031414647, 21096.123049767582, 16683.049429608647, 24710.256513891956, 24524.625428972595, 25066.106441032174, 21885.596359267693, 20222.970719529734, 19953.488320562945], "episode_lengths": [48, 177, 140, 84, 62, 99, 118, 200, 200, 196, 113, 173, 72, 200, 90, 149, 200, 78, 67, 24, 21, 106, 200, 128, 66, 152, 174, 107, 139, 124, 200, 200, 125, 77, 200, 125, 164, 85, 190, 125, 168, 200, 200, 83, 200, 200, 105, 200, 200, 178, 110, 200, 200, 200, 167, 39, 122, 200, 193, 121, 114, 137, 200, 195, 20, 200, 200, 200, 200, 139, 136, 136, 200, 85, 103, 200, 198, 84, 200, 200, 200, 143, 200, 113, 200, 200, 140, 200, 71, 200, 24, 200, 164, 136, 200, 200, 195, 191, 200, 200], "policy_agent_policy_reward": [218.5810222753442, 1092.50697481122, 1923.2754625572693, 1491.9823059843804, 740.1476086372176, 1599.4649779267181, 953.5056177505315, 8115.339708145636, 3226.8402092199785, 3500.4307581946327, 1503.398005068838, 2539.6635937955566, 692.3280784025127, 4113.850811315502, 1199.200107280234, 1832.874988042935, 3876.072761814427, 1323.127162512608, 514.5032628460419, 144.8246445860888, 154.3525397962495, 1028.042005329202, 8916.440717091702, 2147.7939899803214, 807.5138533248966, 2433.4715532872888, 2025.84148543549, 1100.4392728774646, 2184.669329467036, 955.2123728862094, 8151.46495081834, 7270.170607137838, 1755.760281887133, 416.5526357907986, 5472.161985339548, 1301.3735025467813, 2773.750658081825, 872.3180228448957, 2741.3540661636325, 2012.9711402957917, 2461.1109832181905, 6777.415081220408, 9844.167837014564, 954.4775233012318, 3017.3245242670155, 9056.387578572241, 770.800514787464, 9416.168460775341, 8765.420958795012, 3163.465833713045, 1272.9498681175253, 3920.0817415968895, 5367.804374698776, 3719.0020983929844, 2051.077703682661, 443.79858616954965, 1073.1951399019963, 3362.731183391598, 3236.6954836499817, 1179.2074601158417, 892.3802518455509, 1139.7434993721936, 8149.058770422225, 3673.4086196907606, 162.91540526396105, 8963.48159371085, 3889.576011058548, 3699.6659589530473, 9054.267849605798, 1635.116036160614, 1758.0835337226492, 985.1886271053054, 2853.9279431718587, 501.7782020213458, 1236.0629073721348, 9546.940333510847, 3802.307462357118, 535.7385071075219, 2575.0673836311685, 3492.742220145724, 6454.659434432617, 1029.8710024343359, 8388.467193872844, 1195.8568214196964, 9521.663062207905, 6976.527689427521, 1320.726597635558, 6043.188250786229, 751.2993982715806, 2721.5376253144564, 151.89137303706576, 8140.8069415581795, 1245.7598088882883, 1959.0835448457156, 3001.0940199035786, 2931.006831147309, 2143.4905528882523, 3981.674785183368, 7831.114831905099, 8122.311297963894], "policy_adversary_policy_reward": [3175.5315274200834, 2313.1450833794393, 11042.470303409193, 11286.786784623371, 7860.5114500133795, 7338.782008561933, 3931.7060288111284, 4439.565580642497, 3165.619449039734, 3643.9144347193746, 5400.892155820108, 4354.382284733481, 7359.039837254656, 6970.126898545948, 5503.832431003995, 6014.1973890091695, 10867.627455008902, 10470.755258344008, 10349.862153061697, 9635.624102486085, 6069.319429978673, 6291.6112316226145, 9687.64734309825, 7979.638505161531, 4398.8407461406305, 3737.667607316397, 9960.944783957319, 9961.643421706694, 5164.760923398692, 4589.522404706174, 8631.1911482108, 8182.993619380352, 10033.330050559103, 10229.678471020996, 3845.2622910289483, 3926.484677724368, 4222.863220746883, 3599.398060326523, 1447.3726437191208, 1552.231630261626, 1330.5717006955, 1194.8687535710874, 6467.289875248209, 4754.076322890168, 4568.77646194497, 5204.053686319983, 6902.675958604316, 6448.401792392754, 3539.6165375441947, 3384.031593620578, 7226.983189711577, 8297.070833169148, 10093.845483715393, 10148.584917895992, 4858.896427945334, 6465.603285818594, 7588.79637337559, 7514.16585027904, 7355.73339048686, 7793.292883250964, 5096.295684055974, 5919.5183043377865, 6739.632201068884, 6862.585269548468, 6623.657875346513, 6985.436600828677, 4750.138477901116, 4988.359173759272, 8435.021503448314, 8650.165837203835, 7431.082260827092, 7129.969055614749, 8800.951981497581, 7667.372273661385, 4881.387111003203, 5077.400947823353, 10313.387013431122, 10558.616675186455, 5082.678821539254, 6825.863624536049, 9192.495876638532, 9404.244538919067, 6120.26482738899, 7364.617221550991, 3832.155912829322, 4293.632398757807, 4914.508760547107, 4384.594494783942, 9467.971470689654, 11121.928411983892, 4266.501899672445, 5035.152279720008, 6014.358263486163, 6653.82068767129, 2410.244035519752, 4713.581443159053, 5333.416101289855, 4268.711550299515, 8589.903466599986, 9421.181096935192, 5972.204433781733, 6498.447359494961, 10221.512744010532, 8953.231894481845, 8413.07668815205, 8623.717722325606, 10391.743600808206, 9841.757186248347, 8728.431965915317, 9606.85116660099, 1812.1539569158049, 2313.9178604579856, 7539.235917111047, 7425.586970709375, 10225.579798984472, 10747.378688628118, 10027.496369007058, 10401.91648838338, 7376.409306227904, 6431.118393114023, 7149.156437367349, 6850.199962823516, 8357.113825688206, 8467.78161390343, 5201.955818810588, 5989.919857285396, 9227.801549919946, 10094.487273439345, 1251.298157109134, 1158.952567294964, 4531.380534663888, 5173.502343940469, 8190.279774301016, 10251.657898389374, 10144.740086018368, 10400.776899310433, 5086.844307916963, 4601.930219546914, 8141.9930657122095, 7921.869282241716, 7742.476573025559, 7574.181202830765, 8275.100527425036, 8612.992428330326, 11040.368437060264, 11235.40015514017, 5502.701324874839, 4292.63936536117, 6047.136938849302, 5181.177024575376, 4416.084838280807, 4585.15278035271, 10101.00289844179, 9831.270200302422, 5399.702849309701, 5125.1425742727115, 11555.89861755199, 10594.316321758182, 10643.481653949908, 10219.02657531123, 6817.720882554448, 7684.673033882339, 9039.246967186542, 8995.105093112425, 5258.514905354502, 5742.679272311489, 6792.234776463298, 5977.963705612857, 4284.879335703274, 4614.0379382243045, 6828.332771029477, 7157.4387097577455, 8578.104572589491, 7379.67159464692, 8095.026702954459, 7962.779087766098, 4122.847286153825, 4248.972157129897, 11367.295039761137, 11191.601804555417, 1545.1649018106482, 1421.5145696963168, 4866.752457160166, 5976.1956326963, 9503.890925808815, 10346.472315070498, 7648.026411128141, 7075.939473634795, 10951.776363600806, 10757.386130387444, 10384.863259128573, 11208.755338696692, 11627.218469801712, 11295.397418342094, 9508.758996722912, 8395.162577361405, 6291.2922217244495, 6100.563665900337, 5966.015208655922, 5865.161813943093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987276672948514, "mean_inference_ms": 0.9928809870157633, "mean_action_processing_ms": 0.16761979113125436, "mean_env_wait_ms": 0.05419213604429581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003869295120239258, "StateBufferConnector_ms": 0.0025597810745239258, "ViewRequirementAgentConnector_ms": 0.067230224609375}, "num_episodes": 27, "episode_return_max": 25280.434469630793, "episode_return_min": 2573.166129668059, "episode_return_mean": 17294.293507838476}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.4866831073983, "num_env_steps_trained_throughput_per_sec": 541.4866831073983, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 7398.545, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7398.505, "sample_time_ms": 763.841, "learn_time_ms": 6623.555, "learn_throughput": 603.905, "synch_weights_time_ms": 10.662}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 118, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-42", "timestamp": 1723236282, "time_this_iter_s": 7.393455743789673, "time_total_s": 901.4341838359833, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3affdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 901.4341838359833, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 27.972727272727276, "ram_util_percent": 82.6909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9316986.34566799, "cur_kl_coeff": 51067317.66240696, "cur_lr": 5.0000000000000016e-05, "total_loss": 1538859.1692791006, "policy_loss": 0.01439210272926305, "vf_loss": 10.0, "vf_explained_var": -1.243497959520451e-07, "kl": 0.03013373868263982, "entropy": 1.10201782808102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9968360387409727, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.96007034778595, "policy_loss": -0.005950822919839993, "vf_loss": 9.957828483978908, "vf_explained_var": -0.001056451847155889, "kl": 0.02557324731120995, "entropy": 1.3622249926129977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "env_runners": {"episode_reward_max": 25280.434469630793, "episode_reward_min": 2573.166129668059, "episode_reward_mean": 18225.627790863648, "episode_len_mean": 160.71, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 16071, "policy_reward_min": {"agent_policy": 151.89137303706576, "adversary_policy": 1158.952567294964}, "policy_reward_max": {"agent_policy": 9844.167837014564, "adversary_policy": 12222.48245016724}, "policy_reward_mean": {"agent_policy": 3837.252533994182, "adversary_policy": 7194.187628434735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2679.7929940628383, 12249.4082034676, 18689.270865356528, 15498.87174097736, 7731.16198448967, 17957.525576167962, 22268.271887046914, 12424.938986641355, 17287.631553121704, 16104.238646624004, 19167.278939212065, 20872.388077755128, 15364.854758062313, 10155.05028745118, 22557.349325991683, 15862.424818988653, 19242.07491324081, 10831.106081671456, 23613.35775478119, 13921.513586371106, 21057.851398775874, 20262.297130160354, 17969.956148601574, 10253.580778632298, 23607.224406940473, 18358.041757964747, 13438.979465944913, 16539.993939454187, 18367.548610384314, 21174.550397248204, 13743.601661394212, 23094.826380089344, 22404.598785176455, 23952.50288544953, 20386.360836198997, 4569.87040354334, 16038.018027722448, 24335.689671004235, 23666.10834104048, 14986.735159457789, 14891.7366520364, 17964.638938963784, 19340.93444651826, 22995.69744304991, 2573.166129668059, 18668.36447231519, 22331.513683749003, 24245.182944281794, 18743.042377069636, 17698.978384114547, 17074.741309578985, 17873.281582860636, 25129.696535372357, 10297.118892257356, 12464.376870796801, 18548.177952144324, 23734.58056110137, 11060.583930689942, 24725.282322941384, 24355.25044940689, 20957.053350869264, 19064.223062733337, 19389.661371538805, 13966.05530349585, 18420.58033613537, 20962.299170214945, 17278.502764871937, 22100.994041506696, 9123.118841555304, 25280.434469630793, 3118.570844544032, 18983.755031414647, 21096.123049767582, 16683.049429608647, 24710.256513891956, 24524.625428972595, 25066.106441032174, 21885.596359267693, 20222.970719529734, 19953.488320562945, 18869.389349894354, 24370.820003903038, 20752.378427946027, 20546.49162336102, 20616.168626498762, 18230.207535988055, 19758.84590699966, 20960.618554459412, 10034.543381161899, 24560.967230056314, 19566.360876957035, 17830.178072427858, 21309.43526193205, 12215.20290876767, 18243.196845564155, 11069.536325694678, 25082.41685658124, 21064.588551758552, 24739.19580912445, 22551.579040562283], "episode_lengths": [21, 106, 200, 128, 66, 152, 174, 107, 139, 124, 200, 200, 125, 77, 200, 125, 164, 85, 190, 125, 168, 200, 200, 83, 200, 200, 105, 200, 200, 178, 110, 200, 200, 200, 167, 39, 122, 200, 193, 121, 114, 137, 200, 195, 20, 200, 200, 200, 200, 139, 136, 136, 200, 85, 103, 200, 198, 84, 200, 200, 200, 143, 200, 113, 200, 200, 140, 200, 71, 200, 24, 200, 164, 136, 200, 200, 195, 191, 200, 200, 151, 200, 200, 200, 200, 200, 200, 200, 82, 200, 200, 147, 200, 98, 200, 85, 190, 200, 200, 200], "policy_agent_policy_reward": [154.3525397962495, 1028.042005329202, 8916.440717091702, 2147.7939899803214, 807.5138533248966, 2433.4715532872888, 2025.84148543549, 1100.4392728774646, 2184.669329467036, 955.2123728862094, 8151.46495081834, 7270.170607137838, 1755.760281887133, 416.5526357907986, 5472.161985339548, 1301.3735025467813, 2773.750658081825, 872.3180228448957, 2741.3540661636325, 2012.9711402957917, 2461.1109832181905, 6777.415081220408, 9844.167837014564, 954.4775233012318, 3017.3245242670155, 9056.387578572241, 770.800514787464, 9416.168460775341, 8765.420958795012, 3163.465833713045, 1272.9498681175253, 3920.0817415968895, 5367.804374698776, 3719.0020983929844, 2051.077703682661, 443.79858616954965, 1073.1951399019963, 3362.731183391598, 3236.6954836499817, 1179.2074601158417, 892.3802518455509, 1139.7434993721936, 8149.058770422225, 3673.4086196907606, 162.91540526396105, 8963.48159371085, 3889.576011058548, 3699.6659589530473, 9054.267849605798, 1635.116036160614, 1758.0835337226492, 985.1886271053054, 2853.9279431718587, 501.7782020213458, 1236.0629073721348, 9546.940333510847, 3802.307462357118, 535.7385071075219, 2575.0673836311685, 3492.742220145724, 6454.659434432617, 1029.8710024343359, 8388.467193872844, 1195.8568214196964, 9521.663062207905, 6976.527689427521, 1320.726597635558, 6043.188250786229, 751.2993982715806, 2721.5376253144564, 151.89137303706576, 8140.8069415581795, 1245.7598088882883, 1959.0835448457156, 3001.0940199035786, 2931.006831147309, 2143.4905528882523, 3981.674785183368, 7831.114831905099, 8122.311297963894, 1550.2311401216568, 1919.225899482676, 7022.499489008013, 7456.9484640626215, 7440.9184715530855, 9819.89048241026, 8055.608139881162, 7076.213700829708, 1046.331304046561, 3623.608263479784, 8236.572227804352, 1642.3074628229206, 5294.479161220778, 1109.9021703332849, 9477.316861141791, 534.0014363019397, 1555.430050906209, 6633.397254443105, 2794.4000686970166, 4601.551265753836], "policy_adversary_policy_reward": [1330.5717006955, 1194.8687535710874, 6467.289875248209, 4754.076322890168, 4568.77646194497, 5204.053686319983, 6902.675958604316, 6448.401792392754, 3539.6165375441947, 3384.031593620578, 7226.983189711577, 8297.070833169148, 10093.845483715393, 10148.584917895992, 4858.896427945334, 6465.603285818594, 7588.79637337559, 7514.16585027904, 7355.73339048686, 7793.292883250964, 5096.295684055974, 5919.5183043377865, 6739.632201068884, 6862.585269548468, 6623.657875346513, 6985.436600828677, 4750.138477901116, 4988.359173759272, 8435.021503448314, 8650.165837203835, 7431.082260827092, 7129.969055614749, 8800.951981497581, 7667.372273661385, 4881.387111003203, 5077.400947823353, 10313.387013431122, 10558.616675186455, 5082.678821539254, 6825.863624536049, 9192.495876638532, 9404.244538919067, 6120.26482738899, 7364.617221550991, 3832.155912829322, 4293.632398757807, 4914.508760547107, 4384.594494783942, 9467.971470689654, 11121.928411983892, 4266.501899672445, 5035.152279720008, 6014.358263486163, 6653.82068767129, 2410.244035519752, 4713.581443159053, 5333.416101289855, 4268.711550299515, 8589.903466599986, 9421.181096935192, 5972.204433781733, 6498.447359494961, 10221.512744010532, 8953.231894481845, 8413.07668815205, 8623.717722325606, 10391.743600808206, 9841.757186248347, 8728.431965915317, 9606.85116660099, 1812.1539569158049, 2313.9178604579856, 7539.235917111047, 7425.586970709375, 10225.579798984472, 10747.378688628118, 10027.496369007058, 10401.91648838338, 7376.409306227904, 6431.118393114023, 7149.156437367349, 6850.199962823516, 8357.113825688206, 8467.78161390343, 5201.955818810588, 5989.919857285396, 9227.801549919946, 10094.487273439345, 1251.298157109134, 1158.952567294964, 4531.380534663888, 5173.502343940469, 8190.279774301016, 10251.657898389374, 10144.740086018368, 10400.776899310433, 5086.844307916963, 4601.930219546914, 8141.9930657122095, 7921.869282241716, 7742.476573025559, 7574.181202830765, 8275.100527425036, 8612.992428330326, 11040.368437060264, 11235.40015514017, 5502.701324874839, 4292.63936536117, 6047.136938849302, 5181.177024575376, 4416.084838280807, 4585.15278035271, 10101.00289844179, 9831.270200302422, 5399.702849309701, 5125.1425742727115, 11555.89861755199, 10594.316321758182, 10643.481653949908, 10219.02657531123, 6817.720882554448, 7684.673033882339, 9039.246967186542, 8995.105093112425, 5258.514905354502, 5742.679272311489, 6792.234776463298, 5977.963705612857, 4284.879335703274, 4614.0379382243045, 6828.332771029477, 7157.4387097577455, 8578.104572589491, 7379.67159464692, 8095.026702954459, 7962.779087766098, 4122.847286153825, 4248.972157129897, 11367.295039761137, 11191.601804555417, 1545.1649018106482, 1421.5145696963168, 4866.752457160166, 5976.1956326963, 9503.890925808815, 10346.472315070498, 7648.026411128141, 7075.939473634795, 10951.776363600806, 10757.386130387444, 10384.863259128573, 11208.755338696692, 11627.218469801712, 11295.397418342094, 9508.758996722912, 8395.162577361405, 6291.2922217244495, 6100.563665900337, 5966.015208655922, 5865.161813943093, 9127.08125579521, 8192.07695397745, 12222.48245016724, 10229.111654253016, 6635.755190983669, 7094.123747954434, 6472.366305578473, 6617.176853719934, 6491.2789531854905, 6683.971201760395, 4102.7880144659575, 4307.52903911187, 6057.485946386129, 5645.751820732383, 7059.696008339953, 6824.708845289763, 4583.641849125512, 4404.570227989827, 10447.570492480887, 10489.78847409549, 5895.182101189928, 5434.606547962743, 7440.516963699851, 8747.353645905092, 8841.357412934442, 7173.598687776773, 5533.979594415758, 5571.321144018633, 4661.96060011674, 4103.919384305681, 5145.898781933366, 5389.636107459394, 11707.25861321258, 11819.728192462642, 7497.578057450063, 6933.613239865463, 11346.024146094334, 10598.771594332951, 9534.840842248363, 8415.186932560011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39864083585088067, "mean_inference_ms": 0.9922878175092253, "mean_action_processing_ms": 0.1676071574973054, "mean_env_wait_ms": 0.05415995615946167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033162832260131836, "StateBufferConnector_ms": 0.0025033950805664062, "ViewRequirementAgentConnector_ms": 0.06616508960723877}, "num_episodes": 20, "episode_return_max": 25280.434469630793, "episode_return_min": 2573.166129668059, "episode_return_mean": 18225.627790863648}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.4667052330481, "num_env_steps_trained_throughput_per_sec": 513.4667052330481, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 7444.92, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7444.882, "sample_time_ms": 759.291, "learn_time_ms": 6674.574, "learn_throughput": 599.289, "synch_weights_time_ms": 10.569}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "training_iteration": 119, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-50", "timestamp": 1723236290, "time_this_iter_s": 7.795830011367798, "time_total_s": 909.2300138473511, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 909.2300138473511, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 28.472727272727273, "ram_util_percent": 82.31818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14905587.14239418, "cur_kl_coeff": 76600976.49361041, "cur_lr": 5.0000000000000016e-05, "total_loss": 2545574.1914021163, "policy_loss": 0.029608097826943746, "vf_loss": 9.998132103208512, "vf_explained_var": 1.594667081479673e-05, "kl": 0.03323148475003936, "entropy": 1.1076956554695412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9966071709369619, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.98150754570961, "policy_loss": -0.00670060983732886, "vf_loss": 9.974588784575463, "vf_explained_var": -0.0009618108471234639, "kl": 0.028341712950107952, "entropy": 1.3766664708654086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 26556.59018322323, "episode_reward_min": 460.0400942487862, "episode_reward_mean": 19135.41483030376, "episode_len_mean": 169.46, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 16946, "policy_reward_min": {"agent_policy": 9.478272934920742, "adversary_policy": 177.19738177416718}, "policy_reward_max": {"agent_policy": 9819.89048241026, "adversary_policy": 12569.551435587859}, "policy_reward_mean": {"agent_policy": 4182.161284601821, "adversary_policy": 7476.626772850971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10253.580778632298, 23607.224406940473, 18358.041757964747, 13438.979465944913, 16539.993939454187, 18367.548610384314, 21174.550397248204, 13743.601661394212, 23094.826380089344, 22404.598785176455, 23952.50288544953, 20386.360836198997, 4569.87040354334, 16038.018027722448, 24335.689671004235, 23666.10834104048, 14986.735159457789, 14891.7366520364, 17964.638938963784, 19340.93444651826, 22995.69744304991, 2573.166129668059, 18668.36447231519, 22331.513683749003, 24245.182944281794, 18743.042377069636, 17698.978384114547, 17074.741309578985, 17873.281582860636, 25129.696535372357, 10297.118892257356, 12464.376870796801, 18548.177952144324, 23734.58056110137, 11060.583930689942, 24725.282322941384, 24355.25044940689, 20957.053350869264, 19064.223062733337, 19389.661371538805, 13966.05530349585, 18420.58033613537, 20962.299170214945, 17278.502764871937, 22100.994041506696, 9123.118841555304, 25280.434469630793, 3118.570844544032, 18983.755031414647, 21096.123049767582, 16683.049429608647, 24710.256513891956, 24524.625428972595, 25066.106441032174, 21885.596359267693, 20222.970719529734, 19953.488320562945, 18869.389349894354, 24370.820003903038, 20752.378427946027, 20546.49162336102, 20616.168626498762, 18230.207535988055, 19758.84590699966, 20960.618554459412, 10034.543381161899, 24560.967230056314, 19566.360876957035, 17830.178072427858, 21309.43526193205, 12215.20290876767, 18243.196845564155, 11069.536325694678, 25082.41685658124, 21064.588551758552, 24739.19580912445, 22551.579040562283, 24296.836582573524, 19652.267196486675, 25038.201182393193, 18493.701332615383, 24701.684557378685, 13665.531744778904, 25241.161308403876, 19370.310791152526, 9949.573575148532, 18841.661602669563, 18296.92300329478, 25590.738168501266, 25119.371782416496, 18848.203484636048, 460.0400942487862, 19857.765972583977, 21579.723639448668, 23546.020718422646, 19267.612686092685, 19618.82819006488, 26556.59018322323, 25344.754656431272, 21409.817150064795], "episode_lengths": [83, 200, 200, 105, 200, 200, 178, 110, 200, 200, 200, 167, 39, 122, 200, 193, 121, 114, 137, 200, 195, 20, 200, 200, 200, 200, 139, 136, 136, 200, 85, 103, 200, 198, 84, 200, 200, 200, 143, 200, 113, 200, 200, 140, 200, 71, 200, 24, 200, 164, 136, 200, 200, 195, 191, 200, 200, 151, 200, 200, 200, 200, 200, 200, 200, 82, 200, 200, 147, 200, 98, 200, 85, 190, 200, 200, 200, 200, 200, 200, 200, 200, 119, 200, 200, 80, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 148, 200, 200, 200], "policy_agent_policy_reward": [954.4775233012318, 3017.3245242670155, 9056.387578572241, 770.800514787464, 9416.168460775341, 8765.420958795012, 3163.465833713045, 1272.9498681175253, 3920.0817415968895, 5367.804374698776, 3719.0020983929844, 2051.077703682661, 443.79858616954965, 1073.1951399019963, 3362.731183391598, 3236.6954836499817, 1179.2074601158417, 892.3802518455509, 1139.7434993721936, 8149.058770422225, 3673.4086196907606, 162.91540526396105, 8963.48159371085, 3889.576011058548, 3699.6659589530473, 9054.267849605798, 1635.116036160614, 1758.0835337226492, 985.1886271053054, 2853.9279431718587, 501.7782020213458, 1236.0629073721348, 9546.940333510847, 3802.307462357118, 535.7385071075219, 2575.0673836311685, 3492.742220145724, 6454.659434432617, 1029.8710024343359, 8388.467193872844, 1195.8568214196964, 9521.663062207905, 6976.527689427521, 1320.726597635558, 6043.188250786229, 751.2993982715806, 2721.5376253144564, 151.89137303706576, 8140.8069415581795, 1245.7598088882883, 1959.0835448457156, 3001.0940199035786, 2931.006831147309, 2143.4905528882523, 3981.674785183368, 7831.114831905099, 8122.311297963894, 1550.2311401216568, 1919.225899482676, 7022.499489008013, 7456.9484640626215, 7440.9184715530855, 9819.89048241026, 8055.608139881162, 7076.213700829708, 1046.331304046561, 3623.608263479784, 8236.572227804352, 1642.3074628229206, 5294.479161220778, 1109.9021703332849, 9477.316861141791, 534.0014363019397, 1555.430050906209, 6633.397254443105, 2794.4000686970166, 4601.551265753836, 3681.941073921208, 8298.883835182078, 2333.0774491798757, 8780.048912343756, 2324.769574222372, 2004.5760568156502, 2472.678396817874, 8574.628659557764, 976.2151731473786, 8864.728229072829, 8709.26899973821, 2482.051599770116, 2563.0993976774134, 8369.551652258622, 9.478272934920742, 8057.910167761178, 5899.084646668589, 4548.225487847473, 8362.639807632233, 978.578379781535, 1423.7247494011485, 1768.862850225877, 6611.200560641298], "policy_adversary_policy_reward": [4914.508760547107, 4384.594494783942, 9467.971470689654, 11121.928411983892, 4266.501899672445, 5035.152279720008, 6014.358263486163, 6653.82068767129, 2410.244035519752, 4713.581443159053, 5333.416101289855, 4268.711550299515, 8589.903466599986, 9421.181096935192, 5972.204433781733, 6498.447359494961, 10221.512744010532, 8953.231894481845, 8413.07668815205, 8623.717722325606, 10391.743600808206, 9841.757186248347, 8728.431965915317, 9606.85116660099, 1812.1539569158049, 2313.9178604579856, 7539.235917111047, 7425.586970709375, 10225.579798984472, 10747.378688628118, 10027.496369007058, 10401.91648838338, 7376.409306227904, 6431.118393114023, 7149.156437367349, 6850.199962823516, 8357.113825688206, 8467.78161390343, 5201.955818810588, 5989.919857285396, 9227.801549919946, 10094.487273439345, 1251.298157109134, 1158.952567294964, 4531.380534663888, 5173.502343940469, 8190.279774301016, 10251.657898389374, 10144.740086018368, 10400.776899310433, 5086.844307916963, 4601.930219546914, 8141.9930657122095, 7921.869282241716, 7742.476573025559, 7574.181202830765, 8275.100527425036, 8612.992428330326, 11040.368437060264, 11235.40015514017, 5502.701324874839, 4292.63936536117, 6047.136938849302, 5181.177024575376, 4416.084838280807, 4585.15278035271, 10101.00289844179, 9831.270200302422, 5399.702849309701, 5125.1425742727115, 11555.89861755199, 10594.316321758182, 10643.481653949908, 10219.02657531123, 6817.720882554448, 7684.673033882339, 9039.246967186542, 8995.105093112425, 5258.514905354502, 5742.679272311489, 6792.234776463298, 5977.963705612857, 4284.879335703274, 4614.0379382243045, 6828.332771029477, 7157.4387097577455, 8578.104572589491, 7379.67159464692, 8095.026702954459, 7962.779087766098, 4122.847286153825, 4248.972157129897, 11367.295039761137, 11191.601804555417, 1545.1649018106482, 1421.5145696963168, 4866.752457160166, 5976.1956326963, 9503.890925808815, 10346.472315070498, 7648.026411128141, 7075.939473634795, 10951.776363600806, 10757.386130387444, 10384.863259128573, 11208.755338696692, 11627.218469801712, 11295.397418342094, 9508.758996722912, 8395.162577361405, 6291.2922217244495, 6100.563665900337, 5966.015208655922, 5865.161813943093, 9127.08125579521, 8192.07695397745, 12222.48245016724, 10229.111654253016, 6635.755190983669, 7094.123747954434, 6472.366305578473, 6617.176853719934, 6491.2789531854905, 6683.971201760395, 4102.7880144659575, 4307.52903911187, 6057.485946386129, 5645.751820732383, 7059.696008339953, 6824.708845289763, 4583.641849125512, 4404.570227989827, 10447.570492480887, 10489.78847409549, 5895.182101189928, 5434.606547962743, 7440.516963699851, 8747.353645905092, 8841.357412934442, 7173.598687776773, 5533.979594415758, 5571.321144018633, 4661.96060011674, 4103.919384305681, 5145.898781933366, 5389.636107459394, 11707.25861321258, 11819.728192462642, 7497.578057450063, 6933.613239865463, 11346.024146094334, 10598.771594332951, 9534.840842248363, 8415.186932560011, 10376.625285700175, 10238.270222952066, 5520.444749730673, 5832.938611573976, 11793.162336981082, 10911.961396232142, 4387.228318481756, 5326.424101789928, 11810.94223760201, 10565.972745554514, 5250.961048658993, 6409.994639304267, 11171.310503907369, 11597.172407678578, 5556.113069727457, 5239.569061867288, 4673.344086648416, 4300.014315352733, 4931.731227191052, 5045.202146405702, 4160.282561033408, 5427.3714425232765, 11527.043670407467, 11581.642898323576, 11419.139289324887, 11137.13309541441, 5763.330602158863, 4715.321230218601, 177.19738177416718, 273.3644395396983, 6080.22710687137, 5719.628697951566, 8236.461849654635, 7444.177143125339, 9411.498652531787, 9586.296578043486, 5763.782080224493, 5141.190798236026, 9242.292802218784, 9397.957008064488, 12569.551435587859, 12563.313998234084, 11798.275429503588, 11777.616376701633, 7272.393652178678, 7526.222937244809]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3984885061918053, "mean_inference_ms": 0.9915296519179408, "mean_action_processing_ms": 0.1675251491211054, "mean_env_wait_ms": 0.054149888944837986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003427863121032715, "StateBufferConnector_ms": 0.0024650096893310547, "ViewRequirementAgentConnector_ms": 0.06489920616149902}, "num_episodes": 23, "episode_return_max": 26556.59018322323, "episode_return_min": 460.0400942487862, "episode_return_mean": 19135.41483030376}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.5997670062675, "num_env_steps_trained_throughput_per_sec": 547.5997670062675, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 7451.684, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7451.646, "sample_time_ms": 758.582, "learn_time_ms": 6682.032, "learn_throughput": 598.62, "synch_weights_time_ms": 10.588}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 120, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-44-57", "timestamp": 1723236297, "time_this_iter_s": 7.308673858642578, "time_total_s": 916.5386877059937, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3affe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 916.5386877059937, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 24.436363636363634, "ram_util_percent": 82.4090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21765195.5833664, "cur_kl_coeff": 114901464.74041563, "cur_lr": 5.0000000000000016e-05, "total_loss": 4316593.505266204, "policy_loss": 0.03498600529889926, "vf_loss": 10.0, "vf_explained_var": 6.571364781213185e-06, "kl": 0.037567697817868693, "entropy": 1.1126309500169502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9728262834561368, "cur_kl_coeff": 0.7208129882812498, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993900848428408, "policy_loss": -0.004762936477588179, "vf_loss": 9.989420687158903, "vf_explained_var": -0.0007389827320973078, "kl": 0.012823144332893813, "entropy": 1.3792715530842543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "env_runners": {"episode_reward_max": 26556.59018322323, "episode_reward_min": 227.46508384711632, "episode_reward_mean": 19533.53918176043, "episode_len_mean": 176.02, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 17602, "policy_reward_min": {"agent_policy": 3.0070526302644174, "adversary_policy": 86.04372760980684}, "policy_reward_max": {"agent_policy": 9819.89048241026, "adversary_policy": 12569.551435587859}, "policy_reward_mean": {"agent_policy": 4721.29551566832, "adversary_policy": 7406.121833046058}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18668.36447231519, 22331.513683749003, 24245.182944281794, 18743.042377069636, 17698.978384114547, 17074.741309578985, 17873.281582860636, 25129.696535372357, 10297.118892257356, 12464.376870796801, 18548.177952144324, 23734.58056110137, 11060.583930689942, 24725.282322941384, 24355.25044940689, 20957.053350869264, 19064.223062733337, 19389.661371538805, 13966.05530349585, 18420.58033613537, 20962.299170214945, 17278.502764871937, 22100.994041506696, 9123.118841555304, 25280.434469630793, 3118.570844544032, 18983.755031414647, 21096.123049767582, 16683.049429608647, 24710.256513891956, 24524.625428972595, 25066.106441032174, 21885.596359267693, 20222.970719529734, 19953.488320562945, 18869.389349894354, 24370.820003903038, 20752.378427946027, 20546.49162336102, 20616.168626498762, 18230.207535988055, 19758.84590699966, 20960.618554459412, 10034.543381161899, 24560.967230056314, 19566.360876957035, 17830.178072427858, 21309.43526193205, 12215.20290876767, 18243.196845564155, 11069.536325694678, 25082.41685658124, 21064.588551758552, 24739.19580912445, 22551.579040562283, 24296.836582573524, 19652.267196486675, 25038.201182393193, 18493.701332615383, 24701.684557378685, 13665.531744778904, 25241.161308403876, 19370.310791152526, 9949.573575148532, 18841.661602669563, 18296.92300329478, 25590.738168501266, 25119.371782416496, 18848.203484636048, 460.0400942487862, 19857.765972583977, 21579.723639448668, 23546.020718422646, 19267.612686092685, 19618.82819006488, 26556.59018322323, 25344.754656431272, 21409.817150064795, 22613.664142643647, 18351.146198721955, 4465.611696671284, 25041.166700389713, 22076.284907112873, 22485.40158299639, 21409.234022028508, 23335.517943456387, 24723.92247844339, 18960.93303631602, 20644.151364656485, 23220.776044321807, 19419.40452459926, 227.46508384711632, 19954.279463082785, 18924.528710173934, 20979.272857999058, 18804.845722819, 18594.709241904035, 23372.896344589488, 18096.7209889399, 20794.90720783626], "episode_lengths": [200, 200, 200, 200, 139, 136, 136, 200, 85, 103, 200, 198, 84, 200, 200, 200, 143, 200, 113, 200, 200, 140, 200, 71, 200, 24, 200, 164, 136, 200, 200, 195, 191, 200, 200, 151, 200, 200, 200, 200, 200, 200, 200, 82, 200, 200, 147, 200, 98, 200, 85, 190, 200, 200, 200, 200, 200, 200, 200, 200, 119, 200, 200, 80, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8963.48159371085, 3889.576011058548, 3699.6659589530473, 9054.267849605798, 1635.116036160614, 1758.0835337226492, 985.1886271053054, 2853.9279431718587, 501.7782020213458, 1236.0629073721348, 9546.940333510847, 3802.307462357118, 535.7385071075219, 2575.0673836311685, 3492.742220145724, 6454.659434432617, 1029.8710024343359, 8388.467193872844, 1195.8568214196964, 9521.663062207905, 6976.527689427521, 1320.726597635558, 6043.188250786229, 751.2993982715806, 2721.5376253144564, 151.89137303706576, 8140.8069415581795, 1245.7598088882883, 1959.0835448457156, 3001.0940199035786, 2931.006831147309, 2143.4905528882523, 3981.674785183368, 7831.114831905099, 8122.311297963894, 1550.2311401216568, 1919.225899482676, 7022.499489008013, 7456.9484640626215, 7440.9184715530855, 9819.89048241026, 8055.608139881162, 7076.213700829708, 1046.331304046561, 3623.608263479784, 8236.572227804352, 1642.3074628229206, 5294.479161220778, 1109.9021703332849, 9477.316861141791, 534.0014363019397, 1555.430050906209, 6633.397254443105, 2794.4000686970166, 4601.551265753836, 3681.941073921208, 8298.883835182078, 2333.0774491798757, 8780.048912343756, 2324.769574222372, 2004.5760568156502, 2472.678396817874, 8574.628659557764, 976.2151731473786, 8864.728229072829, 8709.26899973821, 2482.051599770116, 2563.0993976774134, 8369.551652258622, 9.478272934920742, 8057.910167761178, 5899.084646668589, 4548.225487847473, 8362.639807632233, 978.578379781535, 1423.7247494011485, 1768.862850225877, 6611.200560641298, 5319.970158001808, 9321.830455685236, 311.09177613017846, 2505.598403959701, 5432.820741638814, 5502.697803889656, 5196.709840307766, 4384.261503532355, 3160.228231617607, 7739.186071871865, 7209.264119011056, 4686.017786725992, 8323.277837568281, 3.0070526302644174, 7558.9783069601535, 8719.496015020672, 7048.997393131192, 8454.788562380614, 9069.861029532847, 4555.569375481035, 8248.249542396556, 5949.6166797000915], "policy_adversary_policy_reward": [4531.380534663888, 5173.502343940469, 8190.279774301016, 10251.657898389374, 10144.740086018368, 10400.776899310433, 5086.844307916963, 4601.930219546914, 8141.9930657122095, 7921.869282241716, 7742.476573025559, 7574.181202830765, 8275.100527425036, 8612.992428330326, 11040.368437060264, 11235.40015514017, 5502.701324874839, 4292.63936536117, 6047.136938849302, 5181.177024575376, 4416.084838280807, 4585.15278035271, 10101.00289844179, 9831.270200302422, 5399.702849309701, 5125.1425742727115, 11555.89861755199, 10594.316321758182, 10643.481653949908, 10219.02657531123, 6817.720882554448, 7684.673033882339, 9039.246967186542, 8995.105093112425, 5258.514905354502, 5742.679272311489, 6792.234776463298, 5977.963705612857, 4284.879335703274, 4614.0379382243045, 6828.332771029477, 7157.4387097577455, 8578.104572589491, 7379.67159464692, 8095.026702954459, 7962.779087766098, 4122.847286153825, 4248.972157129897, 11367.295039761137, 11191.601804555417, 1545.1649018106482, 1421.5145696963168, 4866.752457160166, 5976.1956326963, 9503.890925808815, 10346.472315070498, 7648.026411128141, 7075.939473634795, 10951.776363600806, 10757.386130387444, 10384.863259128573, 11208.755338696692, 11627.218469801712, 11295.397418342094, 9508.758996722912, 8395.162577361405, 6291.2922217244495, 6100.563665900337, 5966.015208655922, 5865.161813943093, 9127.08125579521, 8192.07695397745, 12222.48245016724, 10229.111654253016, 6635.755190983669, 7094.123747954434, 6472.366305578473, 6617.176853719934, 6491.2789531854905, 6683.971201760395, 4102.7880144659575, 4307.52903911187, 6057.485946386129, 5645.751820732383, 7059.696008339953, 6824.708845289763, 4583.641849125512, 4404.570227989827, 10447.570492480887, 10489.78847409549, 5895.182101189928, 5434.606547962743, 7440.516963699851, 8747.353645905092, 8841.357412934442, 7173.598687776773, 5533.979594415758, 5571.321144018633, 4661.96060011674, 4103.919384305681, 5145.898781933366, 5389.636107459394, 11707.25861321258, 11819.728192462642, 7497.578057450063, 6933.613239865463, 11346.024146094334, 10598.771594332951, 9534.840842248363, 8415.186932560011, 10376.625285700175, 10238.270222952066, 5520.444749730673, 5832.938611573976, 11793.162336981082, 10911.961396232142, 4387.228318481756, 5326.424101789928, 11810.94223760201, 10565.972745554514, 5250.961048658993, 6409.994639304267, 11171.310503907369, 11597.172407678578, 5556.113069727457, 5239.569061867288, 4673.344086648416, 4300.014315352733, 4931.731227191052, 5045.202146405702, 4160.282561033408, 5427.3714425232765, 11527.043670407467, 11581.642898323576, 11419.139289324887, 11137.13309541441, 5763.330602158863, 4715.321230218601, 177.19738177416718, 273.3644395396983, 6080.22710687137, 5719.628697951566, 8236.461849654635, 7444.177143125339, 9411.498652531787, 9586.296578043486, 5763.782080224493, 5141.190798236026, 9242.292802218784, 9397.957008064488, 12569.551435587859, 12563.313998234084, 11798.275429503588, 11777.616376701633, 7272.393652178678, 7526.222937244809, 8567.961034628024, 8725.732950013838, 4778.203309099559, 4251.112433937238, 2375.9139923787025, 1778.605928162402, 11635.246229954859, 10900.32206647514, 8539.04613062687, 8104.41803484731, 8346.091796439034, 8636.611982667597, 8929.122235881767, 7283.401945839046, 9744.990967320146, 9206.26547260383, 10584.899385838338, 10978.794860987253, 6386.786476353945, 4834.9604880902825, 6917.449936853308, 6517.437308792135, 9448.062999032945, 9086.69525856292, 5653.63876329797, 5442.487923733013, 86.04372760980684, 138.4143036070451, 5812.757877495285, 6582.543278627326, 4785.860021262899, 5419.172673890416, 7074.481895773283, 6855.793569094525, 5649.155277295672, 4700.901883142821, 4458.512174137902, 5066.336038233341, 9279.611016953924, 9537.715952154413, 5884.865140585475, 3963.606305957981, 8189.396945052362, 6655.8935830837045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39835109184268874, "mean_inference_ms": 0.9908363970762979, "mean_action_processing_ms": 0.16735653510091603, "mean_env_wait_ms": 0.054158472163860674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470301628112793, "StateBufferConnector_ms": 0.0024635791778564453, "ViewRequirementAgentConnector_ms": 0.06432604789733887}, "num_episodes": 22, "episode_return_max": 26556.59018322323, "episode_return_min": 227.46508384711632, "episode_return_mean": 19533.53918176043}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.1843882656038, "num_env_steps_trained_throughput_per_sec": 550.1843882656038, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 7454.747, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7454.711, "sample_time_ms": 757.654, "learn_time_ms": 6685.841, "learn_throughput": 598.279, "synch_weights_time_ms": 10.774}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "training_iteration": 121, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-05", "timestamp": 1723236305, "time_this_iter_s": 7.275252103805542, "time_total_s": 923.8139398097992, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aad4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 923.8139398097992, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 26.51, "ram_util_percent": 82.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41579380.224867724, "cur_kl_coeff": 172352197.11062345, "cur_lr": 5.0000000000000016e-05, "total_loss": 8371474.265806878, "policy_loss": 0.0421236529936472, "vf_loss": 10.0, "vf_explained_var": 2.5229479270006612e-09, "kl": 0.04857184672186141, "entropy": 1.1193338444623997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9449756933065753, "cur_kl_coeff": 0.7208129882812498, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.006215665737788, "policy_loss": -0.002843553989562982, "vf_loss": 9.997717419266701, "vf_explained_var": -0.0005258210003376007, "kl": 0.015734704365604556, "entropy": 1.3961011586089929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 26556.59018322323, "episode_reward_min": 116.5305662889467, "episode_reward_mean": 19866.647028296968, "episode_len_mean": 180.66, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18066, "policy_reward_min": {"agent_policy": 0.5926891428762955, "adversary_policy": 45.81988817029195}, "policy_reward_max": {"agent_policy": 9819.89048241026, "adversary_policy": 12569.551435587859}, "policy_reward_mean": {"agent_policy": 5022.357856087315, "adversary_policy": 7422.144586104828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20962.299170214945, 17278.502764871937, 22100.994041506696, 9123.118841555304, 25280.434469630793, 3118.570844544032, 18983.755031414647, 21096.123049767582, 16683.049429608647, 24710.256513891956, 24524.625428972595, 25066.106441032174, 21885.596359267693, 20222.970719529734, 19953.488320562945, 18869.389349894354, 24370.820003903038, 20752.378427946027, 20546.49162336102, 20616.168626498762, 18230.207535988055, 19758.84590699966, 20960.618554459412, 10034.543381161899, 24560.967230056314, 19566.360876957035, 17830.178072427858, 21309.43526193205, 12215.20290876767, 18243.196845564155, 11069.536325694678, 25082.41685658124, 21064.588551758552, 24739.19580912445, 22551.579040562283, 24296.836582573524, 19652.267196486675, 25038.201182393193, 18493.701332615383, 24701.684557378685, 13665.531744778904, 25241.161308403876, 19370.310791152526, 9949.573575148532, 18841.661602669563, 18296.92300329478, 25590.738168501266, 25119.371782416496, 18848.203484636048, 460.0400942487862, 19857.765972583977, 21579.723639448668, 23546.020718422646, 19267.612686092685, 19618.82819006488, 26556.59018322323, 25344.754656431272, 21409.817150064795, 22613.664142643647, 18351.146198721955, 4465.611696671284, 25041.166700389713, 22076.284907112873, 22485.40158299639, 21409.234022028508, 23335.517943456387, 24723.92247844339, 18960.93303631602, 20644.151364656485, 23220.776044321807, 19419.40452459926, 227.46508384711632, 19954.279463082785, 18924.528710173934, 20979.272857999058, 18804.845722819, 18594.709241904035, 23372.896344589488, 18096.7209889399, 20794.90720783626, 21037.950773350673, 18004.782634393592, 25124.725180867947, 21030.33727513774, 22730.096687837548, 23493.23839092683, 23044.750847076422, 19914.08062872914, 24214.81135064487, 22487.280091912064, 116.5305662889467, 19869.193077265187, 18827.988107949055, 24550.659196303222, 22118.410088565746, 21395.796945702856, 23083.352264280384, 19214.660773137774, 18586.816366069514, 23213.06910066756], "episode_lengths": [200, 140, 200, 71, 200, 24, 200, 164, 136, 200, 200, 195, 191, 200, 200, 151, 200, 200, 200, 200, 200, 200, 200, 82, 200, 200, 147, 200, 98, 200, 85, 190, 200, 200, 200, 200, 200, 200, 200, 200, 119, 200, 200, 80, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6976.527689427521, 1320.726597635558, 6043.188250786229, 751.2993982715806, 2721.5376253144564, 151.89137303706576, 8140.8069415581795, 1245.7598088882883, 1959.0835448457156, 3001.0940199035786, 2931.006831147309, 2143.4905528882523, 3981.674785183368, 7831.114831905099, 8122.311297963894, 1550.2311401216568, 1919.225899482676, 7022.499489008013, 7456.9484640626215, 7440.9184715530855, 9819.89048241026, 8055.608139881162, 7076.213700829708, 1046.331304046561, 3623.608263479784, 8236.572227804352, 1642.3074628229206, 5294.479161220778, 1109.9021703332849, 9477.316861141791, 534.0014363019397, 1555.430050906209, 6633.397254443105, 2794.4000686970166, 4601.551265753836, 3681.941073921208, 8298.883835182078, 2333.0774491798757, 8780.048912343756, 2324.769574222372, 2004.5760568156502, 2472.678396817874, 8574.628659557764, 976.2151731473786, 8864.728229072829, 8709.26899973821, 2482.051599770116, 2563.0993976774134, 8369.551652258622, 9.478272934920742, 8057.910167761178, 5899.084646668589, 4548.225487847473, 8362.639807632233, 978.578379781535, 1423.7247494011485, 1768.862850225877, 6611.200560641298, 5319.970158001808, 9321.830455685236, 311.09177613017846, 2505.598403959701, 5432.820741638814, 5502.697803889656, 5196.709840307766, 4384.261503532355, 3160.228231617607, 7739.186071871865, 7209.264119011056, 4686.017786725992, 8323.277837568281, 3.0070526302644174, 7558.9783069601535, 8719.496015020672, 7048.997393131192, 8454.788562380614, 9069.861029532847, 4555.569375481035, 8248.249542396556, 5949.6166797000915, 6503.119574347859, 7582.349111685153, 2628.979101295544, 7213.1764829495505, 4800.690346025959, 4512.722639221318, 4824.385081684864, 7538.967824322595, 3562.3881157845262, 5574.341015538815, 0.5926891428762955, 7677.234091175065, 9273.098518109593, 3495.5242681653585, 4033.752204632085, 6666.558326764503, 3756.945342542302, 9015.36309425487, 8421.050079836372, 4145.4582184222645], "policy_adversary_policy_reward": [6828.332771029477, 7157.4387097577455, 8578.104572589491, 7379.67159464692, 8095.026702954459, 7962.779087766098, 4122.847286153825, 4248.972157129897, 11367.295039761137, 11191.601804555417, 1545.1649018106482, 1421.5145696963168, 4866.752457160166, 5976.1956326963, 9503.890925808815, 10346.472315070498, 7648.026411128141, 7075.939473634795, 10951.776363600806, 10757.386130387444, 10384.863259128573, 11208.755338696692, 11627.218469801712, 11295.397418342094, 9508.758996722912, 8395.162577361405, 6291.2922217244495, 6100.563665900337, 5966.015208655922, 5865.161813943093, 9127.08125579521, 8192.07695397745, 12222.48245016724, 10229.111654253016, 6635.755190983669, 7094.123747954434, 6472.366305578473, 6617.176853719934, 6491.2789531854905, 6683.971201760395, 4102.7880144659575, 4307.52903911187, 6057.485946386129, 5645.751820732383, 7059.696008339953, 6824.708845289763, 4583.641849125512, 4404.570227989827, 10447.570492480887, 10489.78847409549, 5895.182101189928, 5434.606547962743, 7440.516963699851, 8747.353645905092, 8841.357412934442, 7173.598687776773, 5533.979594415758, 5571.321144018633, 4661.96060011674, 4103.919384305681, 5145.898781933366, 5389.636107459394, 11707.25861321258, 11819.728192462642, 7497.578057450063, 6933.613239865463, 11346.024146094334, 10598.771594332951, 9534.840842248363, 8415.186932560011, 10376.625285700175, 10238.270222952066, 5520.444749730673, 5832.938611573976, 11793.162336981082, 10911.961396232142, 4387.228318481756, 5326.424101789928, 11810.94223760201, 10565.972745554514, 5250.961048658993, 6409.994639304267, 11171.310503907369, 11597.172407678578, 5556.113069727457, 5239.569061867288, 4673.344086648416, 4300.014315352733, 4931.731227191052, 5045.202146405702, 4160.282561033408, 5427.3714425232765, 11527.043670407467, 11581.642898323576, 11419.139289324887, 11137.13309541441, 5763.330602158863, 4715.321230218601, 177.19738177416718, 273.3644395396983, 6080.22710687137, 5719.628697951566, 8236.461849654635, 7444.177143125339, 9411.498652531787, 9586.296578043486, 5763.782080224493, 5141.190798236026, 9242.292802218784, 9397.957008064488, 12569.551435587859, 12563.313998234084, 11798.275429503588, 11777.616376701633, 7272.393652178678, 7526.222937244809, 8567.961034628024, 8725.732950013838, 4778.203309099559, 4251.112433937238, 2375.9139923787025, 1778.605928162402, 11635.246229954859, 10900.32206647514, 8539.04613062687, 8104.41803484731, 8346.091796439034, 8636.611982667597, 8929.122235881767, 7283.401945839046, 9744.990967320146, 9206.26547260383, 10584.899385838338, 10978.794860987253, 6386.786476353945, 4834.9604880902825, 6917.449936853308, 6517.437308792135, 9448.062999032945, 9086.69525856292, 5653.63876329797, 5442.487923733013, 86.04372760980684, 138.4143036070451, 5812.757877495285, 6582.543278627326, 4785.860021262899, 5419.172673890416, 7074.481895773283, 6855.793569094525, 5649.155277295672, 4700.901883142821, 4458.512174137902, 5066.336038233341, 9279.611016953924, 9537.715952154413, 5884.865140585475, 3963.606305957981, 8189.396945052362, 6655.8935830837045, 6923.290937806325, 7611.540261196448, 6550.146740218796, 3872.2867824897203, 10986.952772580637, 11508.793306991707, 6895.785053672923, 6921.375738515075, 9189.023257088284, 8740.383084723251, 9527.53601094843, 9452.979740756982, 8905.891733404107, 9314.474031987364, 5790.289934137686, 6584.822870268875, 10352.81079229708, 10299.61244256325, 8390.346158375223, 8522.592917998056, 45.81988817029195, 70.11798897577846, 6402.446276039188, 5789.512710050963, 4852.471213368253, 4702.418376471276, 10569.384350696402, 10485.75057744133, 7976.423677248769, 10108.234206684834, 7353.453018878845, 7375.785600059541, 8944.474849869905, 10381.93207186811, 5090.694959558993, 5108.602719323957, 5711.880462767256, 4453.885823466012, 9084.939921134515, 9982.670961110753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39831656660386744, "mean_inference_ms": 0.9901501250349238, "mean_action_processing_ms": 0.1672305273884392, "mean_env_wait_ms": 0.05419408015828484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033761262893676758, "StateBufferConnector_ms": 0.0024470090866088867, "ViewRequirementAgentConnector_ms": 0.06338393688201904}, "num_episodes": 20, "episode_return_max": 26556.59018322323, "episode_return_min": 116.5305662889467, "episode_return_mean": 19866.647028296968}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.8334118246631, "num_env_steps_trained_throughput_per_sec": 546.8334118246631, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 7412.328, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7412.293, "sample_time_ms": 758.968, "learn_time_ms": 6642.339, "learn_throughput": 602.197, "synch_weights_time_ms": 10.504}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 122, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-12", "timestamp": 1723236312, "time_this_iter_s": 7.319210052490234, "time_total_s": 931.1331498622894, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aad550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 931.1331498622894, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 26.254545454545454, "ram_util_percent": 82.45454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52531982.06613757, "cur_kl_coeff": 258528295.6659352, "cur_lr": 5.0000000000000016e-05, "total_loss": 12183610.587830687, "policy_loss": 0.03727419566345849, "vf_loss": 10.0, "vf_explained_var": -1.117665931661293e-07, "kl": 0.04712676004403167, "entropy": 1.125453627235675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9642964240008344, "cur_kl_coeff": 0.7208129882812498, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.007691492636999, "policy_loss": -0.0026579662720905618, "vf_loss": 10.0, "vf_explained_var": -0.0005437682072321574, "kl": 0.01435802869964391, "entropy": 1.3962091176460187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "env_runners": {"episode_reward_max": 26556.59018322323, "episode_reward_min": 116.5305662889467, "episode_reward_mean": 20077.998659893536, "episode_len_mean": 185.94, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18594, "policy_reward_min": {"agent_policy": 0.5926891428762955, "adversary_policy": 45.81988817029195}, "policy_reward_max": {"agent_policy": 9819.89048241026, "adversary_policy": 12569.551435587859}, "policy_reward_mean": {"agent_policy": 5510.198773784002, "adversary_policy": 7283.899943054767}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18230.207535988055, 19758.84590699966, 20960.618554459412, 10034.543381161899, 24560.967230056314, 19566.360876957035, 17830.178072427858, 21309.43526193205, 12215.20290876767, 18243.196845564155, 11069.536325694678, 25082.41685658124, 21064.588551758552, 24739.19580912445, 22551.579040562283, 24296.836582573524, 19652.267196486675, 25038.201182393193, 18493.701332615383, 24701.684557378685, 13665.531744778904, 25241.161308403876, 19370.310791152526, 9949.573575148532, 18841.661602669563, 18296.92300329478, 25590.738168501266, 25119.371782416496, 18848.203484636048, 460.0400942487862, 19857.765972583977, 21579.723639448668, 23546.020718422646, 19267.612686092685, 19618.82819006488, 26556.59018322323, 25344.754656431272, 21409.817150064795, 22613.664142643647, 18351.146198721955, 4465.611696671284, 25041.166700389713, 22076.284907112873, 22485.40158299639, 21409.234022028508, 23335.517943456387, 24723.92247844339, 18960.93303631602, 20644.151364656485, 23220.776044321807, 19419.40452459926, 227.46508384711632, 19954.279463082785, 18924.528710173934, 20979.272857999058, 18804.845722819, 18594.709241904035, 23372.896344589488, 18096.7209889399, 20794.90720783626, 21037.950773350673, 18004.782634393592, 25124.725180867947, 21030.33727513774, 22730.096687837548, 23493.23839092683, 23044.750847076422, 19914.08062872914, 24214.81135064487, 22487.280091912064, 116.5305662889467, 19869.193077265187, 18827.988107949055, 24550.659196303222, 22118.410088565746, 21395.796945702856, 23083.352264280384, 19214.660773137774, 18586.816366069514, 23213.06910066756, 19480.38627935777, 23979.16397694053, 25123.174902201987, 22790.455136945202, 19228.57181631706, 23128.36327356005, 20403.262313551328, 24311.163925210425, 20190.740863806644, 18628.426144182595, 17924.756126702247, 18960.81520873772, 23181.157658244683, 18684.34084291157, 24115.171231799293, 20655.494115309284, 19210.08787818294, 18458.247560090058, 19406.99647925822, 19419.526884321916], "episode_lengths": [200, 200, 200, 82, 200, 200, 147, 200, 98, 200, 85, 190, 200, 200, 200, 200, 200, 200, 200, 200, 119, 200, 200, 80, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9819.89048241026, 8055.608139881162, 7076.213700829708, 1046.331304046561, 3623.608263479784, 8236.572227804352, 1642.3074628229206, 5294.479161220778, 1109.9021703332849, 9477.316861141791, 534.0014363019397, 1555.430050906209, 6633.397254443105, 2794.4000686970166, 4601.551265753836, 3681.941073921208, 8298.883835182078, 2333.0774491798757, 8780.048912343756, 2324.769574222372, 2004.5760568156502, 2472.678396817874, 8574.628659557764, 976.2151731473786, 8864.728229072829, 8709.26899973821, 2482.051599770116, 2563.0993976774134, 8369.551652258622, 9.478272934920742, 8057.910167761178, 5899.084646668589, 4548.225487847473, 8362.639807632233, 978.578379781535, 1423.7247494011485, 1768.862850225877, 6611.200560641298, 5319.970158001808, 9321.830455685236, 311.09177613017846, 2505.598403959701, 5432.820741638814, 5502.697803889656, 5196.709840307766, 4384.261503532355, 3160.228231617607, 7739.186071871865, 7209.264119011056, 4686.017786725992, 8323.277837568281, 3.0070526302644174, 7558.9783069601535, 8719.496015020672, 7048.997393131192, 8454.788562380614, 9069.861029532847, 4555.569375481035, 8248.249542396556, 5949.6166797000915, 6503.119574347859, 7582.349111685153, 2628.979101295544, 7213.1764829495505, 4800.690346025959, 4512.722639221318, 4824.385081684864, 7538.967824322595, 3562.3881157845262, 5574.341015538815, 0.5926891428762955, 7677.234091175065, 9273.098518109593, 3495.5242681653585, 4033.752204632085, 6666.558326764503, 3756.945342542302, 9015.36309425487, 8421.050079836372, 4145.4582184222645, 8294.385074951932, 3929.9347713011107, 2977.2191164657743, 4787.03974776949, 7402.873712237685, 3682.1443812456982, 7676.402065792305, 3443.9583426003, 6342.211089155987, 8346.530626537518, 9302.252370829436, 8756.68015288651, 4439.019430869201, 8525.768908202397, 2973.8316887273704, 7140.37491301828, 8325.434415846477, 9197.354347279403, 8523.419825455048, 7428.593801480951], "policy_adversary_policy_reward": [4102.7880144659575, 4307.52903911187, 6057.485946386129, 5645.751820732383, 7059.696008339953, 6824.708845289763, 4583.641849125512, 4404.570227989827, 10447.570492480887, 10489.78847409549, 5895.182101189928, 5434.606547962743, 7440.516963699851, 8747.353645905092, 8841.357412934442, 7173.598687776773, 5533.979594415758, 5571.321144018633, 4661.96060011674, 4103.919384305681, 5145.898781933366, 5389.636107459394, 11707.25861321258, 11819.728192462642, 7497.578057450063, 6933.613239865463, 11346.024146094334, 10598.771594332951, 9534.840842248363, 8415.186932560011, 10376.625285700175, 10238.270222952066, 5520.444749730673, 5832.938611573976, 11793.162336981082, 10911.961396232142, 4387.228318481756, 5326.424101789928, 11810.94223760201, 10565.972745554514, 5250.961048658993, 6409.994639304267, 11171.310503907369, 11597.172407678578, 5556.113069727457, 5239.569061867288, 4673.344086648416, 4300.014315352733, 4931.731227191052, 5045.202146405702, 4160.282561033408, 5427.3714425232765, 11527.043670407467, 11581.642898323576, 11419.139289324887, 11137.13309541441, 5763.330602158863, 4715.321230218601, 177.19738177416718, 273.3644395396983, 6080.22710687137, 5719.628697951566, 8236.461849654635, 7444.177143125339, 9411.498652531787, 9586.296578043486, 5763.782080224493, 5141.190798236026, 9242.292802218784, 9397.957008064488, 12569.551435587859, 12563.313998234084, 11798.275429503588, 11777.616376701633, 7272.393652178678, 7526.222937244809, 8567.961034628024, 8725.732950013838, 4778.203309099559, 4251.112433937238, 2375.9139923787025, 1778.605928162402, 11635.246229954859, 10900.32206647514, 8539.04613062687, 8104.41803484731, 8346.091796439034, 8636.611982667597, 8929.122235881767, 7283.401945839046, 9744.990967320146, 9206.26547260383, 10584.899385838338, 10978.794860987253, 6386.786476353945, 4834.9604880902825, 6917.449936853308, 6517.437308792135, 9448.062999032945, 9086.69525856292, 5653.63876329797, 5442.487923733013, 86.04372760980684, 138.4143036070451, 5812.757877495285, 6582.543278627326, 4785.860021262899, 5419.172673890416, 7074.481895773283, 6855.793569094525, 5649.155277295672, 4700.901883142821, 4458.512174137902, 5066.336038233341, 9279.611016953924, 9537.715952154413, 5884.865140585475, 3963.606305957981, 8189.396945052362, 6655.8935830837045, 6923.290937806325, 7611.540261196448, 6550.146740218796, 3872.2867824897203, 10986.952772580637, 11508.793306991707, 6895.785053672923, 6921.375738515075, 9189.023257088284, 8740.383084723251, 9527.53601094843, 9452.979740756982, 8905.891733404107, 9314.474031987364, 5790.289934137686, 6584.822870268875, 10352.81079229708, 10299.61244256325, 8390.346158375223, 8522.592917998056, 45.81988817029195, 70.11798897577846, 6402.446276039188, 5789.512710050963, 4852.471213368253, 4702.418376471276, 10569.384350696402, 10485.75057744133, 7976.423677248769, 10108.234206684834, 7353.453018878845, 7375.785600059541, 8944.474849869905, 10381.93207186811, 5090.694959558993, 5108.602719323957, 5711.880462767256, 4453.885823466012, 9084.939921134515, 9982.670961110753, 5838.196303859507, 5347.804900546308, 9984.63949015295, 10064.58971548663, 11088.565944294294, 11057.389841441816, 8655.835752305611, 9347.579636870201, 6734.550005362402, 5091.148098716888, 10435.710099110202, 9010.50879320416, 6441.785597161982, 6285.0746505970765, 10612.641324558677, 10254.564258051365, 6052.752815951089, 7795.7769586995655, 4493.249580916999, 5788.645936728168, 4823.850935120756, 3798.652820752, 5103.927867674629, 5100.207188176696, 9574.230062270057, 9167.908165105358, 4548.602913847761, 5609.969020861502, 10420.716026973512, 10720.62351609837, 6654.490057333743, 6860.629144957306, 5773.194424484888, 5111.459037851573, 4474.776270493267, 4786.116942317472, 5569.869326059013, 5313.707327744235, 6708.273159673837, 5282.659923167044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39806586888387685, "mean_inference_ms": 0.989823396064255, "mean_action_processing_ms": 0.167226677913767, "mean_env_wait_ms": 0.05409078759952726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033189058303833008, "StateBufferConnector_ms": 0.0025169849395751953, "ViewRequirementAgentConnector_ms": 0.06528103351593018}, "num_episodes": 20, "episode_return_max": 26556.59018322323, "episode_return_min": 116.5305662889467, "episode_return_mean": 20077.998659893536}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.3230162553081, "num_env_steps_trained_throughput_per_sec": 543.3230162553081, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 7410.4, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7410.365, "sample_time_ms": 753.056, "learn_time_ms": 6646.503, "learn_throughput": 601.82, "synch_weights_time_ms": 10.335}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "training_iteration": 123, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-20", "timestamp": 1723236320, "time_this_iter_s": 7.365660190582275, "time_total_s": 938.4988100528717, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aea040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 938.4988100528717, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 28.118181818181824, "ram_util_percent": 82.49090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68862615.08267196, "cur_kl_coeff": 387792443.4989029, "cur_lr": 5.0000000000000016e-05, "total_loss": 10961406.955291005, "policy_loss": 0.019078850997833623, "vf_loss": 10.0, "vf_explained_var": 4.0772509953332324e-05, "kl": 0.028266143420385935, "entropy": 1.127119434132147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9429872679989785, "cur_kl_coeff": 0.7208129882812498, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002702124913533, "policy_loss": -0.00533520092528003, "vf_loss": 9.995612103740374, "vf_explained_var": -0.0002841221789518992, "kl": 0.017237783537711947, "entropy": 1.418859073643883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 26556.59018322323, "episode_reward_min": 116.5305662889467, "episode_reward_mean": 20078.473267442896, "episode_len_mean": 188.01, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18801, "policy_reward_min": {"agent_policy": 0.5926891428762955, "adversary_policy": 45.81988817029195}, "policy_reward_max": {"agent_policy": 10531.209778346927, "adversary_policy": 12569.551435587859}, "policy_reward_mean": {"agent_policy": 5799.135948491581, "adversary_policy": 7139.668659475656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13665.531744778904, 25241.161308403876, 19370.310791152526, 9949.573575148532, 18841.661602669563, 18296.92300329478, 25590.738168501266, 25119.371782416496, 18848.203484636048, 460.0400942487862, 19857.765972583977, 21579.723639448668, 23546.020718422646, 19267.612686092685, 19618.82819006488, 26556.59018322323, 25344.754656431272, 21409.817150064795, 22613.664142643647, 18351.146198721955, 4465.611696671284, 25041.166700389713, 22076.284907112873, 22485.40158299639, 21409.234022028508, 23335.517943456387, 24723.92247844339, 18960.93303631602, 20644.151364656485, 23220.776044321807, 19419.40452459926, 227.46508384711632, 19954.279463082785, 18924.528710173934, 20979.272857999058, 18804.845722819, 18594.709241904035, 23372.896344589488, 18096.7209889399, 20794.90720783626, 21037.950773350673, 18004.782634393592, 25124.725180867947, 21030.33727513774, 22730.096687837548, 23493.23839092683, 23044.750847076422, 19914.08062872914, 24214.81135064487, 22487.280091912064, 116.5305662889467, 19869.193077265187, 18827.988107949055, 24550.659196303222, 22118.410088565746, 21395.796945702856, 23083.352264280384, 19214.660773137774, 18586.816366069514, 23213.06910066756, 19480.38627935777, 23979.16397694053, 25123.174902201987, 22790.455136945202, 19228.57181631706, 23128.36327356005, 20403.262313551328, 24311.163925210425, 20190.740863806644, 18628.426144182595, 17924.756126702247, 18960.81520873772, 23181.157658244683, 18684.34084291157, 24115.171231799293, 20655.494115309284, 19210.08787818294, 18458.247560090058, 19406.99647925822, 19419.526884321916, 23014.775176016272, 17433.396047330352, 22690.542961639618, 22657.399986532986, 18351.22124524277, 17565.915061285752, 22108.676962207646, 22917.61664243064, 20226.358250762813, 22295.742433431817, 1074.699553018808, 18312.03208158659, 20161.042188811396, 22761.20147499149, 19396.984430809585, 23113.518118327036, 20481.034014268986, 22817.48937331689, 19187.967380802434, 22879.41138160486], "episode_lengths": [119, 200, 200, 80, 200, 200, 200, 200, 200, 4, 200, 200, 200, 200, 148, 200, 200, 200, 200, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2004.5760568156502, 2472.678396817874, 8574.628659557764, 976.2151731473786, 8864.728229072829, 8709.26899973821, 2482.051599770116, 2563.0993976774134, 8369.551652258622, 9.478272934920742, 8057.910167761178, 5899.084646668589, 4548.225487847473, 8362.639807632233, 978.578379781535, 1423.7247494011485, 1768.862850225877, 6611.200560641298, 5319.970158001808, 9321.830455685236, 311.09177613017846, 2505.598403959701, 5432.820741638814, 5502.697803889656, 5196.709840307766, 4384.261503532355, 3160.228231617607, 7739.186071871865, 7209.264119011056, 4686.017786725992, 8323.277837568281, 3.0070526302644174, 7558.9783069601535, 8719.496015020672, 7048.997393131192, 8454.788562380614, 9069.861029532847, 4555.569375481035, 8248.249542396556, 5949.6166797000915, 6503.119574347859, 7582.349111685153, 2628.979101295544, 7213.1764829495505, 4800.690346025959, 4512.722639221318, 4824.385081684864, 7538.967824322595, 3562.3881157845262, 5574.341015538815, 0.5926891428762955, 7677.234091175065, 9273.098518109593, 3495.5242681653585, 4033.752204632085, 6666.558326764503, 3756.945342542302, 9015.36309425487, 8421.050079836372, 4145.4582184222645, 8294.385074951932, 3929.9347713011107, 2977.2191164657743, 4787.03974776949, 7402.873712237685, 3682.1443812456982, 7676.402065792305, 3443.9583426003, 6342.211089155987, 8346.530626537518, 9302.252370829436, 8756.68015288651, 4439.019430869201, 8525.768908202397, 2973.8316887273704, 7140.37491301828, 8325.434415846477, 9197.354347279403, 8523.419825455048, 7428.593801480951, 4656.43111708155, 10531.209778346927, 4988.0210848569295, 4855.309326228509, 9448.0027917338, 8761.025528384134, 5640.778645621469, 5144.672169953808, 7203.24167574203, 5625.676052895619, 48.22315965981629, 8725.458023378693, 7199.443135981478, 5140.081304754596, 8627.54882208377, 4626.9851376448505, 7244.251234579464, 5078.87184028195, 8055.704560148945, 4212.512776321479], "policy_adversary_policy_reward": [5250.961048658993, 6409.994639304267, 11171.310503907369, 11597.172407678578, 5556.113069727457, 5239.569061867288, 4673.344086648416, 4300.014315352733, 4931.731227191052, 5045.202146405702, 4160.282561033408, 5427.3714425232765, 11527.043670407467, 11581.642898323576, 11419.139289324887, 11137.13309541441, 5763.330602158863, 4715.321230218601, 177.19738177416718, 273.3644395396983, 6080.22710687137, 5719.628697951566, 8236.461849654635, 7444.177143125339, 9411.498652531787, 9586.296578043486, 5763.782080224493, 5141.190798236026, 9242.292802218784, 9397.957008064488, 12569.551435587859, 12563.313998234084, 11798.275429503588, 11777.616376701633, 7272.393652178678, 7526.222937244809, 8567.961034628024, 8725.732950013838, 4778.203309099559, 4251.112433937238, 2375.9139923787025, 1778.605928162402, 11635.246229954859, 10900.32206647514, 8539.04613062687, 8104.41803484731, 8346.091796439034, 8636.611982667597, 8929.122235881767, 7283.401945839046, 9744.990967320146, 9206.26547260383, 10584.899385838338, 10978.794860987253, 6386.786476353945, 4834.9604880902825, 6917.449936853308, 6517.437308792135, 9448.062999032945, 9086.69525856292, 5653.63876329797, 5442.487923733013, 86.04372760980684, 138.4143036070451, 5812.757877495285, 6582.543278627326, 4785.860021262899, 5419.172673890416, 7074.481895773283, 6855.793569094525, 5649.155277295672, 4700.901883142821, 4458.512174137902, 5066.336038233341, 9279.611016953924, 9537.715952154413, 5884.865140585475, 3963.606305957981, 8189.396945052362, 6655.8935830837045, 6923.290937806325, 7611.540261196448, 6550.146740218796, 3872.2867824897203, 10986.952772580637, 11508.793306991707, 6895.785053672923, 6921.375738515075, 9189.023257088284, 8740.383084723251, 9527.53601094843, 9452.979740756982, 8905.891733404107, 9314.474031987364, 5790.289934137686, 6584.822870268875, 10352.81079229708, 10299.61244256325, 8390.346158375223, 8522.592917998056, 45.81988817029195, 70.11798897577846, 6402.446276039188, 5789.512710050963, 4852.471213368253, 4702.418376471276, 10569.384350696402, 10485.75057744133, 7976.423677248769, 10108.234206684834, 7353.453018878845, 7375.785600059541, 8944.474849869905, 10381.93207186811, 5090.694959558993, 5108.602719323957, 5711.880462767256, 4453.885823466012, 9084.939921134515, 9982.670961110753, 5838.196303859507, 5347.804900546308, 9984.63949015295, 10064.58971548663, 11088.565944294294, 11057.389841441816, 8655.835752305611, 9347.579636870201, 6734.550005362402, 5091.148098716888, 10435.710099110202, 9010.50879320416, 6441.785597161982, 6285.0746505970765, 10612.641324558677, 10254.564258051365, 6052.752815951089, 7795.7769586995655, 4493.249580916999, 5788.645936728168, 4823.850935120756, 3798.652820752, 5103.927867674629, 5100.207188176696, 9574.230062270057, 9167.908165105358, 4548.602913847761, 5609.969020861502, 10420.716026973512, 10720.62351609837, 6654.490057333743, 6860.629144957306, 5773.194424484888, 5111.459037851573, 4474.776270493267, 4786.116942317472, 5569.869326059013, 5313.707327744235, 6708.273159673837, 5282.659923167044, 9394.127530504084, 8964.216528430525, 3589.890378848249, 3312.2958901351576, 9101.854121866776, 8600.667754915792, 8564.348972307916, 9237.741687996588, 4688.92406883893, 4214.294384670007, 3430.3607491666767, 5374.528783734976, 8472.751548479671, 7995.146768106419, 8782.997157353351, 8989.947315123418, 6093.232345313812, 6929.884229706989, 8495.811005628793, 8174.255374907231, 438.303449950915, 588.1729434080764, 5407.999811097715, 4178.574247110255, 6941.634804024702, 6019.9642488053705, 8645.16001915143, 8975.960151085597, 5374.345842068384, 5395.089766657503, 9490.212907983627, 8996.32007269843, 6350.5241496082845, 6886.2586300812345, 8795.898381021909, 8942.7191520129, 5051.082947834068, 6081.179872819411, 9910.797319734447, 8756.10128554904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3979021419028571, "mean_inference_ms": 0.9893423091846089, "mean_action_processing_ms": 0.16715798996995804, "mean_env_wait_ms": 0.054062227761625475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034558773040771484, "StateBufferConnector_ms": 0.0026721954345703125, "ViewRequirementAgentConnector_ms": 0.06498610973358154}, "num_episodes": 20, "episode_return_max": 26556.59018322323, "episode_return_min": 116.5305662889467, "episode_return_mean": 20078.473267442896}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.9590459308451, "num_env_steps_trained_throughput_per_sec": 544.9590459308451, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 7422.698, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7422.664, "sample_time_ms": 759.663, "learn_time_ms": 6652.236, "learn_throughput": 601.302, "synch_weights_time_ms": 10.295}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 124, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-27", "timestamp": 1723236327, "time_this_iter_s": 7.344334125518799, "time_total_s": 945.8431441783905, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aad940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 945.8431441783905, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 82.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108407881.63544974, "cur_kl_coeff": 581688665.2483541, "cur_lr": 5.0000000000000016e-05, "total_loss": 21460498.724867724, "policy_loss": 0.04495549221417162, "vf_loss": 10.0, "vf_explained_var": -1.5172378096000227e-07, "kl": 0.03689342931445156, "entropy": 1.1254450079625247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9274225754042467, "cur_kl_coeff": 0.7208129882812498, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.0114201515913, "policy_loss": 0.001200915542964746, "vf_loss": 10.0, "vf_explained_var": -0.00022426185508569083, "kl": 0.014177379357473303, "entropy": 1.4167417938510576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": 25124.725180867947, "episode_reward_min": 116.5305662889467, "episode_reward_mean": 20129.97095055414, "episode_len_mean": 192.5, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19250, "policy_reward_min": {"agent_policy": 0.5926891428762955, "adversary_policy": 45.81988817029195}, "policy_reward_max": {"agent_policy": 10531.209778346927, "adversary_policy": 11635.246229954859}, "policy_reward_mean": {"agent_policy": 6375.464223265476, "adversary_policy": 6877.253363644334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4465.611696671284, 25041.166700389713, 22076.284907112873, 22485.40158299639, 21409.234022028508, 23335.517943456387, 24723.92247844339, 18960.93303631602, 20644.151364656485, 23220.776044321807, 19419.40452459926, 227.46508384711632, 19954.279463082785, 18924.528710173934, 20979.272857999058, 18804.845722819, 18594.709241904035, 23372.896344589488, 18096.7209889399, 20794.90720783626, 21037.950773350673, 18004.782634393592, 25124.725180867947, 21030.33727513774, 22730.096687837548, 23493.23839092683, 23044.750847076422, 19914.08062872914, 24214.81135064487, 22487.280091912064, 116.5305662889467, 19869.193077265187, 18827.988107949055, 24550.659196303222, 22118.410088565746, 21395.796945702856, 23083.352264280384, 19214.660773137774, 18586.816366069514, 23213.06910066756, 19480.38627935777, 23979.16397694053, 25123.174902201987, 22790.455136945202, 19228.57181631706, 23128.36327356005, 20403.262313551328, 24311.163925210425, 20190.740863806644, 18628.426144182595, 17924.756126702247, 18960.81520873772, 23181.157658244683, 18684.34084291157, 24115.171231799293, 20655.494115309284, 19210.08787818294, 18458.247560090058, 19406.99647925822, 19419.526884321916, 23014.775176016272, 17433.396047330352, 22690.542961639618, 22657.399986532986, 18351.22124524277, 17565.915061285752, 22108.676962207646, 22917.61664243064, 20226.358250762813, 22295.742433431817, 1074.699553018808, 18312.03208158659, 20161.042188811396, 22761.20147499149, 19396.984430809585, 23113.518118327036, 20481.034014268986, 22817.48937331689, 19187.967380802434, 22879.41138160486, 18433.566298915317, 21015.08176269455, 18582.396653732936, 23492.74024026596, 19900.108942490835, 19443.35304563911, 19560.57758302751, 22212.088857321083, 19056.875251337544, 18266.481310727544, 19247.595800657837, 20961.993796511037, 18344.530123252214, 18345.478234626462, 21189.208223187597, 21085.512489060173, 20050.490552402982, 18932.069254392867, 20248.521832895905, 20310.53715093337], "episode_lengths": [38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [311.09177613017846, 2505.598403959701, 5432.820741638814, 5502.697803889656, 5196.709840307766, 4384.261503532355, 3160.228231617607, 7739.186071871865, 7209.264119011056, 4686.017786725992, 8323.277837568281, 3.0070526302644174, 7558.9783069601535, 8719.496015020672, 7048.997393131192, 8454.788562380614, 9069.861029532847, 4555.569375481035, 8248.249542396556, 5949.6166797000915, 6503.119574347859, 7582.349111685153, 2628.979101295544, 7213.1764829495505, 4800.690346025959, 4512.722639221318, 4824.385081684864, 7538.967824322595, 3562.3881157845262, 5574.341015538815, 0.5926891428762955, 7677.234091175065, 9273.098518109593, 3495.5242681653585, 4033.752204632085, 6666.558326764503, 3756.945342542302, 9015.36309425487, 8421.050079836372, 4145.4582184222645, 8294.385074951932, 3929.9347713011107, 2977.2191164657743, 4787.03974776949, 7402.873712237685, 3682.1443812456982, 7676.402065792305, 3443.9583426003, 6342.211089155987, 8346.530626537518, 9302.252370829436, 8756.68015288651, 4439.019430869201, 8525.768908202397, 2973.8316887273704, 7140.37491301828, 8325.434415846477, 9197.354347279403, 8523.419825455048, 7428.593801480951, 4656.43111708155, 10531.209778346927, 4988.0210848569295, 4855.309326228509, 9448.0027917338, 8761.025528384134, 5640.778645621469, 5144.672169953808, 7203.24167574203, 5625.676052895619, 48.22315965981629, 8725.458023378693, 7199.443135981478, 5140.081304754596, 8627.54882208377, 4626.9851376448505, 7244.251234579464, 5078.87184028195, 8055.704560148945, 4212.512776321479, 9035.906662385874, 6497.679297214803, 9396.310669318596, 4582.796297881964, 8042.924686610667, 8587.847259706949, 7280.489250859255, 5844.889494686504, 7638.470513817832, 9473.830932484578, 8551.256686983448, 6886.756885420614, 9633.692871153793, 9411.569446355974, 5785.191192672775, 6595.347978211204, 7846.393560989579, 8592.423104264912, 7772.199418305253, 7495.154969502108], "policy_adversary_policy_reward": [2375.9139923787025, 1778.605928162402, 11635.246229954859, 10900.32206647514, 8539.04613062687, 8104.41803484731, 8346.091796439034, 8636.611982667597, 8929.122235881767, 7283.401945839046, 9744.990967320146, 9206.26547260383, 10584.899385838338, 10978.794860987253, 6386.786476353945, 4834.9604880902825, 6917.449936853308, 6517.437308792135, 9448.062999032945, 9086.69525856292, 5653.63876329797, 5442.487923733013, 86.04372760980684, 138.4143036070451, 5812.757877495285, 6582.543278627326, 4785.860021262899, 5419.172673890416, 7074.481895773283, 6855.793569094525, 5649.155277295672, 4700.901883142821, 4458.512174137902, 5066.336038233341, 9279.611016953924, 9537.715952154413, 5884.865140585475, 3963.606305957981, 8189.396945052362, 6655.8935830837045, 6923.290937806325, 7611.540261196448, 6550.146740218796, 3872.2867824897203, 10986.952772580637, 11508.793306991707, 6895.785053672923, 6921.375738515075, 9189.023257088284, 8740.383084723251, 9527.53601094843, 9452.979740756982, 8905.891733404107, 9314.474031987364, 5790.289934137686, 6584.822870268875, 10352.81079229708, 10299.61244256325, 8390.346158375223, 8522.592917998056, 45.81988817029195, 70.11798897577846, 6402.446276039188, 5789.512710050963, 4852.471213368253, 4702.418376471276, 10569.384350696402, 10485.75057744133, 7976.423677248769, 10108.234206684834, 7353.453018878845, 7375.785600059541, 8944.474849869905, 10381.93207186811, 5090.694959558993, 5108.602719323957, 5711.880462767256, 4453.885823466012, 9084.939921134515, 9982.670961110753, 5838.196303859507, 5347.804900546308, 9984.63949015295, 10064.58971548663, 11088.565944294294, 11057.389841441816, 8655.835752305611, 9347.579636870201, 6734.550005362402, 5091.148098716888, 10435.710099110202, 9010.50879320416, 6441.785597161982, 6285.0746505970765, 10612.641324558677, 10254.564258051365, 6052.752815951089, 7795.7769586995655, 4493.249580916999, 5788.645936728168, 4823.850935120756, 3798.652820752, 5103.927867674629, 5100.207188176696, 9574.230062270057, 9167.908165105358, 4548.602913847761, 5609.969020861502, 10420.716026973512, 10720.62351609837, 6654.490057333743, 6860.629144957306, 5773.194424484888, 5111.459037851573, 4474.776270493267, 4786.116942317472, 5569.869326059013, 5313.707327744235, 6708.273159673837, 5282.659923167044, 9394.127530504084, 8964.216528430525, 3589.890378848249, 3312.2958901351576, 9101.854121866776, 8600.667754915792, 8564.348972307916, 9237.741687996588, 4688.92406883893, 4214.294384670007, 3430.3607491666767, 5374.528783734976, 8472.751548479671, 7995.146768106419, 8782.997157353351, 8989.947315123418, 6093.232345313812, 6929.884229706989, 8495.811005628793, 8174.255374907231, 438.303449950915, 588.1729434080764, 5407.999811097715, 4178.574247110255, 6941.634804024702, 6019.9642488053705, 8645.16001915143, 8975.960151085597, 5374.345842068384, 5395.089766657503, 9490.212907983627, 8996.32007269843, 6350.5241496082845, 6886.2586300812345, 8795.898381021909, 8942.7191520129, 5051.082947834068, 6081.179872819411, 9910.797319734447, 8756.10128554904, 5091.615328398948, 4306.044308130524, 6927.836372836821, 7589.566092643005, 4655.254338227797, 4530.831646186652, 9414.161584300227, 9495.7823580836, 5776.509211590798, 6080.675044289411, 5548.852852657884, 5306.652933274313, 5430.132712278532, 6849.9556198897635, 8221.983343708913, 8145.216018925769, 4920.65846917484, 6497.746268344858, 4661.114671645439, 4131.535706597568, 5110.84540239236, 5585.4937112820835, 6833.293136181262, 7241.943774909191, 4443.241255572806, 4267.595996525692, 4213.621580941181, 4720.2872073293975, 8349.159604911156, 7054.857425603806, 7098.856594458306, 7391.307916390681, 6200.633317362553, 6003.463674050844, 5542.674540094747, 4796.971610033209, 6310.08209691685, 6166.240317673817, 6643.758637077747, 6171.623544353706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39788557215521436, "mean_inference_ms": 0.9890212571582724, "mean_action_processing_ms": 0.1671856805413881, "mean_env_wait_ms": 0.05400579957171935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033720731735229492, "StateBufferConnector_ms": 0.0027091503143310547, "ViewRequirementAgentConnector_ms": 0.06566774845123291}, "num_episodes": 20, "episode_return_max": 25124.725180867947, "episode_return_min": 116.5305662889467, "episode_return_mean": 20129.97095055414}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.7130719083126, "num_env_steps_trained_throughput_per_sec": 547.7130719083126, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 7388.064, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7388.03, "sample_time_ms": 743.481, "learn_time_ms": 6633.91, "learn_throughput": 602.963, "synch_weights_time_ms": 10.17}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 125, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-35", "timestamp": 1723236335, "time_this_iter_s": 7.307109117507935, "time_total_s": 953.1502532958984, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aadf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 953.1502532958984, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 32.00909090909091, "ram_util_percent": 82.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148557058.84338623, "cur_kl_coeff": 872532997.8725314, "cur_lr": 5.0000000000000016e-05, "total_loss": 24392091.436772488, "policy_loss": 0.032813137545984576, "vf_loss": 10.0, "vf_explained_var": 1.5597053305812614e-05, "kl": 0.027955483299034533, "entropy": 1.1241792036112024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8933169387746602, "cur_kl_coeff": 0.7208129882812498, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.019024234016737, "policy_loss": 0.004955547807427744, "vf_loss": 9.99552896519502, "vf_explained_var": -0.0001974470913410187, "kl": 0.02572061523872738, "entropy": 1.4160117932905754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 25123.174902201987, "episode_reward_min": 116.5305662889467, "episode_reward_mean": 20001.35249859565, "episode_len_mean": 194.34, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19434, "policy_reward_min": {"agent_policy": 0.5926891428762955, "adversary_policy": 45.81988817029195}, "policy_reward_max": {"agent_policy": 10531.209778346927, "adversary_policy": 11088.565944294294}, "policy_reward_mean": {"agent_policy": 6800.84331739584, "adversary_policy": 6600.25459059991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21030.33727513774, 22730.096687837548, 23493.23839092683, 23044.750847076422, 19914.08062872914, 24214.81135064487, 22487.280091912064, 116.5305662889467, 19869.193077265187, 18827.988107949055, 24550.659196303222, 22118.410088565746, 21395.796945702856, 23083.352264280384, 19214.660773137774, 18586.816366069514, 23213.06910066756, 19480.38627935777, 23979.16397694053, 25123.174902201987, 22790.455136945202, 19228.57181631706, 23128.36327356005, 20403.262313551328, 24311.163925210425, 20190.740863806644, 18628.426144182595, 17924.756126702247, 18960.81520873772, 23181.157658244683, 18684.34084291157, 24115.171231799293, 20655.494115309284, 19210.08787818294, 18458.247560090058, 19406.99647925822, 19419.526884321916, 23014.775176016272, 17433.396047330352, 22690.542961639618, 22657.399986532986, 18351.22124524277, 17565.915061285752, 22108.676962207646, 22917.61664243064, 20226.358250762813, 22295.742433431817, 1074.699553018808, 18312.03208158659, 20161.042188811396, 22761.20147499149, 19396.984430809585, 23113.518118327036, 20481.034014268986, 22817.48937331689, 19187.967380802434, 22879.41138160486, 18433.566298915317, 21015.08176269455, 18582.396653732936, 23492.74024026596, 19900.108942490835, 19443.35304563911, 19560.57758302751, 22212.088857321083, 19056.875251337544, 18266.481310727544, 19247.595800657837, 20961.993796511037, 18344.530123252214, 18345.478234626462, 21189.208223187597, 21085.512489060173, 20050.490552402982, 18932.069254392867, 20248.521832895905, 20310.53715093337, 19622.708325864023, 2790.505592113834, 18684.85391989241, 21069.10306949116, 20404.221310389654, 18856.126360792718, 18650.20282700789, 19191.64801140808, 19574.974024265626, 18542.495403384666, 21579.631921531407, 18894.896504651533, 18951.923749029527, 19267.78278439179, 22436.86683873443, 20797.00118629676, 18696.186340057564, 18827.085115653434, 19246.124400953297, 20527.770666440345, 21493.421791113044, 18465.27779780401, 20266.83537368006], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7213.1764829495505, 4800.690346025959, 4512.722639221318, 4824.385081684864, 7538.967824322595, 3562.3881157845262, 5574.341015538815, 0.5926891428762955, 7677.234091175065, 9273.098518109593, 3495.5242681653585, 4033.752204632085, 6666.558326764503, 3756.945342542302, 9015.36309425487, 8421.050079836372, 4145.4582184222645, 8294.385074951932, 3929.9347713011107, 2977.2191164657743, 4787.03974776949, 7402.873712237685, 3682.1443812456982, 7676.402065792305, 3443.9583426003, 6342.211089155987, 8346.530626537518, 9302.252370829436, 8756.68015288651, 4439.019430869201, 8525.768908202397, 2973.8316887273704, 7140.37491301828, 8325.434415846477, 9197.354347279403, 8523.419825455048, 7428.593801480951, 4656.43111708155, 10531.209778346927, 4988.0210848569295, 4855.309326228509, 9448.0027917338, 8761.025528384134, 5640.778645621469, 5144.672169953808, 7203.24167574203, 5625.676052895619, 48.22315965981629, 8725.458023378693, 7199.443135981478, 5140.081304754596, 8627.54882208377, 4626.9851376448505, 7244.251234579464, 5078.87184028195, 8055.704560148945, 4212.512776321479, 9035.906662385874, 6497.679297214803, 9396.310669318596, 4582.796297881964, 8042.924686610667, 8587.847259706949, 7280.489250859255, 5844.889494686504, 7638.470513817832, 9473.830932484578, 8551.256686983448, 6886.756885420614, 9633.692871153793, 9411.569446355974, 5785.191192672775, 6595.347978211204, 7846.393560989579, 8592.423104264912, 7772.199418305253, 7495.154969502108, 8049.033248022902, 239.87301843261446, 8028.781089541324, 6433.631414023671, 6217.998886641324, 9224.468154693026, 8042.341104355308, 8611.065934605285, 8595.393197980466, 8692.711638264136, 6533.496361648762, 9192.312613282915, 8029.556125830105, 8205.85361771563, 4925.206046926051, 6966.2274979326385, 9441.458883892521, 8897.872566031168, 8784.004560031533, 6823.105580056546, 6387.130915772442, 9163.176037393783, 7827.376780777675], "policy_adversary_policy_reward": [6895.785053672923, 6921.375738515075, 9189.023257088284, 8740.383084723251, 9527.53601094843, 9452.979740756982, 8905.891733404107, 9314.474031987364, 5790.289934137686, 6584.822870268875, 10352.81079229708, 10299.61244256325, 8390.346158375223, 8522.592917998056, 45.81988817029195, 70.11798897577846, 6402.446276039188, 5789.512710050963, 4852.471213368253, 4702.418376471276, 10569.384350696402, 10485.75057744133, 7976.423677248769, 10108.234206684834, 7353.453018878845, 7375.785600059541, 8944.474849869905, 10381.93207186811, 5090.694959558993, 5108.602719323957, 5711.880462767256, 4453.885823466012, 9084.939921134515, 9982.670961110753, 5838.196303859507, 5347.804900546308, 9984.63949015295, 10064.58971548663, 11088.565944294294, 11057.389841441816, 8655.835752305611, 9347.579636870201, 6734.550005362402, 5091.148098716888, 10435.710099110202, 9010.50879320416, 6441.785597161982, 6285.0746505970765, 10612.641324558677, 10254.564258051365, 6052.752815951089, 7795.7769586995655, 4493.249580916999, 5788.645936728168, 4823.850935120756, 3798.652820752, 5103.927867674629, 5100.207188176696, 9574.230062270057, 9167.908165105358, 4548.602913847761, 5609.969020861502, 10420.716026973512, 10720.62351609837, 6654.490057333743, 6860.629144957306, 5773.194424484888, 5111.459037851573, 4474.776270493267, 4786.116942317472, 5569.869326059013, 5313.707327744235, 6708.273159673837, 5282.659923167044, 9394.127530504084, 8964.216528430525, 3589.890378848249, 3312.2958901351576, 9101.854121866776, 8600.667754915792, 8564.348972307916, 9237.741687996588, 4688.92406883893, 4214.294384670007, 3430.3607491666767, 5374.528783734976, 8472.751548479671, 7995.146768106419, 8782.997157353351, 8989.947315123418, 6093.232345313812, 6929.884229706989, 8495.811005628793, 8174.255374907231, 438.303449950915, 588.1729434080764, 5407.999811097715, 4178.574247110255, 6941.634804024702, 6019.9642488053705, 8645.16001915143, 8975.960151085597, 5374.345842068384, 5395.089766657503, 9490.212907983627, 8996.32007269843, 6350.5241496082845, 6886.2586300812345, 8795.898381021909, 8942.7191520129, 5051.082947834068, 6081.179872819411, 9910.797319734447, 8756.10128554904, 5091.615328398948, 4306.044308130524, 6927.836372836821, 7589.566092643005, 4655.254338227797, 4530.831646186652, 9414.161584300227, 9495.7823580836, 5776.509211590798, 6080.675044289411, 5548.852852657884, 5306.652933274313, 5430.132712278532, 6849.9556198897635, 8221.983343708913, 8145.216018925769, 4920.65846917484, 6497.746268344858, 4661.114671645439, 4131.535706597568, 5110.84540239236, 5585.4937112820835, 6833.293136181262, 7241.943774909191, 4443.241255572806, 4267.595996525692, 4213.621580941181, 4720.2872073293975, 8349.159604911156, 7054.857425603806, 7098.856594458306, 7391.307916390681, 6200.633317362553, 6003.463674050844, 5542.674540094747, 4796.971610033209, 6310.08209691685, 6166.240317673817, 6643.758637077747, 6171.623544353706, 5484.288700458723, 6089.386377382445, 1457.1832564150995, 1093.4493172661205, 4551.139098858587, 6104.9337314925215, 7052.062600512094, 7583.409054955514, 6262.132964983122, 7924.089458765188, 4718.3504697185235, 4913.3077363812445, 4521.101425941139, 6086.760296711457, 5518.40294525111, 5062.179131551644, 5517.804543202398, 5461.776283082774, 5448.0708682751365, 4401.71289684542, 7450.080099432771, 7596.0554604498, 4938.806433121137, 4763.777458247501, 6069.430767007906, 4852.936856191574, 5141.152870963341, 5920.7762957128725, 9189.267025159837, 8322.39376664849, 6688.410401375568, 7142.363286988573, 4667.39761697363, 4587.329839191485, 5241.034966239693, 4688.17758338261, 5126.8705049131895, 5335.249336008566, 6401.738046388915, 7302.927039994885, 7684.324243263904, 7421.966632076706, 4325.599252752708, 4976.502507657566, 6271.245760282472, 6168.212832619921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39778028959018363, "mean_inference_ms": 0.9886582207506934, "mean_action_processing_ms": 0.1672089791244832, "mean_env_wait_ms": 0.05396944771522044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003324270248413086, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06647562980651855}, "num_episodes": 23, "episode_return_max": 25123.174902201987, "episode_return_min": 116.5305662889467, "episode_return_mean": 20001.35249859565}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.2699995481189, "num_env_steps_trained_throughput_per_sec": 558.2699995481189, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 7348.945, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7348.911, "sample_time_ms": 735.188, "learn_time_ms": 6602.815, "learn_throughput": 605.802, "synch_weights_time_ms": 10.445}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 126, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-42", "timestamp": 1723236342, "time_this_iter_s": 7.170424222946167, "time_total_s": 960.3206775188446, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b25310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 960.3206775188446, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 24.42, "ram_util_percent": 82.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233621220.05291006, "cur_kl_coeff": 1308799496.8087966, "cur_lr": 5.0000000000000016e-05, "total_loss": 40370664.83121693, "policy_loss": 0.031014953554169368, "vf_loss": 10.0, "vf_explained_var": 6.088504084834346e-07, "kl": 0.030845561157172872, "entropy": 1.127986069835683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8668091665487736, "cur_kl_coeff": 1.0812194824218753, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.036614952484767, "policy_loss": 0.006141752225812524, "vf_loss": 10.0, "vf_explained_var": -0.00011701236168543498, "kl": 0.028184110325916358, "entropy": 1.3919624471416077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "env_runners": {"episode_reward_max": 25123.174902201987, "episode_reward_min": 1074.699553018808, "episode_reward_mean": 19808.011040460864, "episode_len_mean": 196.33, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19633, "policy_reward_min": {"agent_policy": 48.22315965981629, "adversary_policy": 438.303449950915}, "policy_reward_max": {"agent_policy": 10802.213238417467, "adversary_policy": 11088.565944294294}, "policy_reward_mean": {"agent_policy": 7278.35838192397, "adversary_policy": 6264.826329268457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25123.174902201987, 22790.455136945202, 19228.57181631706, 23128.36327356005, 20403.262313551328, 24311.163925210425, 20190.740863806644, 18628.426144182595, 17924.756126702247, 18960.81520873772, 23181.157658244683, 18684.34084291157, 24115.171231799293, 20655.494115309284, 19210.08787818294, 18458.247560090058, 19406.99647925822, 19419.526884321916, 23014.775176016272, 17433.396047330352, 22690.542961639618, 22657.399986532986, 18351.22124524277, 17565.915061285752, 22108.676962207646, 22917.61664243064, 20226.358250762813, 22295.742433431817, 1074.699553018808, 18312.03208158659, 20161.042188811396, 22761.20147499149, 19396.984430809585, 23113.518118327036, 20481.034014268986, 22817.48937331689, 19187.967380802434, 22879.41138160486, 18433.566298915317, 21015.08176269455, 18582.396653732936, 23492.74024026596, 19900.108942490835, 19443.35304563911, 19560.57758302751, 22212.088857321083, 19056.875251337544, 18266.481310727544, 19247.595800657837, 20961.993796511037, 18344.530123252214, 18345.478234626462, 21189.208223187597, 21085.512489060173, 20050.490552402982, 18932.069254392867, 20248.521832895905, 20310.53715093337, 19622.708325864023, 2790.505592113834, 18684.85391989241, 21069.10306949116, 20404.221310389654, 18856.126360792718, 18650.20282700789, 19191.64801140808, 19574.974024265626, 18542.495403384666, 21579.631921531407, 18894.896504651533, 18951.923749029527, 19267.78278439179, 22436.86683873443, 20797.00118629676, 18696.186340057564, 18827.085115653434, 19246.124400953297, 20527.770666440345, 21493.421791113044, 18465.27779780401, 20266.83537368006, 17440.03153022408, 19144.315430426643, 20094.005268716755, 18574.83381249927, 19038.30705822233, 18747.588730507036, 20142.75215462005, 19216.803299553918, 18620.63522520528, 18922.343184816822, 20914.523645378376, 21737.261377481533, 19395.61810459685, 21299.312168867367, 20724.846398906488, 19521.740579854308, 19334.892785895667, 18329.174413187862, 20817.491032353868], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2977.2191164657743, 4787.03974776949, 7402.873712237685, 3682.1443812456982, 7676.402065792305, 3443.9583426003, 6342.211089155987, 8346.530626537518, 9302.252370829436, 8756.68015288651, 4439.019430869201, 8525.768908202397, 2973.8316887273704, 7140.37491301828, 8325.434415846477, 9197.354347279403, 8523.419825455048, 7428.593801480951, 4656.43111708155, 10531.209778346927, 4988.0210848569295, 4855.309326228509, 9448.0027917338, 8761.025528384134, 5640.778645621469, 5144.672169953808, 7203.24167574203, 5625.676052895619, 48.22315965981629, 8725.458023378693, 7199.443135981478, 5140.081304754596, 8627.54882208377, 4626.9851376448505, 7244.251234579464, 5078.87184028195, 8055.704560148945, 4212.512776321479, 9035.906662385874, 6497.679297214803, 9396.310669318596, 4582.796297881964, 8042.924686610667, 8587.847259706949, 7280.489250859255, 5844.889494686504, 7638.470513817832, 9473.830932484578, 8551.256686983448, 6886.756885420614, 9633.692871153793, 9411.569446355974, 5785.191192672775, 6595.347978211204, 7846.393560989579, 8592.423104264912, 7772.199418305253, 7495.154969502108, 8049.033248022902, 239.87301843261446, 8028.781089541324, 6433.631414023671, 6217.998886641324, 9224.468154693026, 8042.341104355308, 8611.065934605285, 8595.393197980466, 8692.711638264136, 6533.496361648762, 9192.312613282915, 8029.556125830105, 8205.85361771563, 4925.206046926051, 6966.2274979326385, 9441.458883892521, 8897.872566031168, 8784.004560031533, 6823.105580056546, 6387.130915772442, 9163.176037393783, 7827.376780777675, 10802.213238417467, 8722.625479537131, 8021.7474536805585, 8875.563888612165, 8942.516237240763, 8633.317872022084, 7741.084392713813, 8669.291681489147, 8460.637940596074, 8720.458965408141, 6638.735378980562, 6048.919595883407, 8241.609996736366, 6300.1133457586575, 6422.912828574972, 8222.748962565276, 8841.873223809434, 9344.37379977265, 6837.3303558401085], "policy_adversary_policy_reward": [11088.565944294294, 11057.389841441816, 8655.835752305611, 9347.579636870201, 6734.550005362402, 5091.148098716888, 10435.710099110202, 9010.50879320416, 6441.785597161982, 6285.0746505970765, 10612.641324558677, 10254.564258051365, 6052.752815951089, 7795.7769586995655, 4493.249580916999, 5788.645936728168, 4823.850935120756, 3798.652820752, 5103.927867674629, 5100.207188176696, 9574.230062270057, 9167.908165105358, 4548.602913847761, 5609.969020861502, 10420.716026973512, 10720.62351609837, 6654.490057333743, 6860.629144957306, 5773.194424484888, 5111.459037851573, 4474.776270493267, 4786.116942317472, 5569.869326059013, 5313.707327744235, 6708.273159673837, 5282.659923167044, 9394.127530504084, 8964.216528430525, 3589.890378848249, 3312.2958901351576, 9101.854121866776, 8600.667754915792, 8564.348972307916, 9237.741687996588, 4688.92406883893, 4214.294384670007, 3430.3607491666767, 5374.528783734976, 8472.751548479671, 7995.146768106419, 8782.997157353351, 8989.947315123418, 6093.232345313812, 6929.884229706989, 8495.811005628793, 8174.255374907231, 438.303449950915, 588.1729434080764, 5407.999811097715, 4178.574247110255, 6941.634804024702, 6019.9642488053705, 8645.16001915143, 8975.960151085597, 5374.345842068384, 5395.089766657503, 9490.212907983627, 8996.32007269843, 6350.5241496082845, 6886.2586300812345, 8795.898381021909, 8942.7191520129, 5051.082947834068, 6081.179872819411, 9910.797319734447, 8756.10128554904, 5091.615328398948, 4306.044308130524, 6927.836372836821, 7589.566092643005, 4655.254338227797, 4530.831646186652, 9414.161584300227, 9495.7823580836, 5776.509211590798, 6080.675044289411, 5548.852852657884, 5306.652933274313, 5430.132712278532, 6849.9556198897635, 8221.983343708913, 8145.216018925769, 4920.65846917484, 6497.746268344858, 4661.114671645439, 4131.535706597568, 5110.84540239236, 5585.4937112820835, 6833.293136181262, 7241.943774909191, 4443.241255572806, 4267.595996525692, 4213.621580941181, 4720.2872073293975, 8349.159604911156, 7054.857425603806, 7098.856594458306, 7391.307916390681, 6200.633317362553, 6003.463674050844, 5542.674540094747, 4796.971610033209, 6310.08209691685, 6166.240317673817, 6643.758637077747, 6171.623544353706, 5484.288700458723, 6089.386377382445, 1457.1832564150995, 1093.4493172661205, 4551.139098858587, 6104.9337314925215, 7052.062600512094, 7583.409054955514, 6262.132964983122, 7924.089458765188, 4718.3504697185235, 4913.3077363812445, 4521.101425941139, 6086.760296711457, 5518.40294525111, 5062.179131551644, 5517.804543202398, 5461.776283082774, 5448.0708682751365, 4401.71289684542, 7450.080099432771, 7596.0554604498, 4938.806433121137, 4763.777458247501, 6069.430767007906, 4852.936856191574, 5141.152870963341, 5920.7762957128725, 9189.267025159837, 8322.39376664849, 6688.410401375568, 7142.363286988573, 4667.39761697363, 4587.329839191485, 5241.034966239693, 4688.17758338261, 5126.8705049131895, 5335.249336008566, 6401.738046388915, 7302.927039994885, 7684.324243263904, 7421.966632076706, 4325.599252752708, 4976.502507657566, 6271.245760282472, 6168.212832619921, 3326.2396207054308, 3311.57867110121, 5141.5843628881, 5280.105588001459, 5969.11298455561, 6103.144830480597, 5259.150789865459, 4440.119134021726, 5187.925514579233, 4907.865306402314, 4647.08163517002, 5467.189223315001, 6008.160773702428, 6393.506988203866, 5080.267562824652, 5467.244055240181, 4481.19142384981, 5678.80586075943, 5048.657588976238, 5153.226630432531, 6775.719084455444, 7500.0691819423155, 7601.2462267579685, 8087.095554840151, 5377.797552966582, 5776.210554893969, 7362.749388859256, 7636.449434249429, 7715.232495894395, 6586.70107443713, 5872.586324627913, 5426.405292661152, 5269.51946131929, 5223.500100767061, 4194.095237778564, 4790.705375636658, 6978.023224736347, 7002.1374517773975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39769653611841016, "mean_inference_ms": 0.9886186749174583, "mean_action_processing_ms": 0.16718975780670725, "mean_env_wait_ms": 0.05394322935900429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033947229385375977, "StateBufferConnector_ms": 0.002739429473876953, "ViewRequirementAgentConnector_ms": 0.06904792785644531}, "num_episodes": 19, "episode_return_max": 25123.174902201987, "episode_return_min": 1074.699553018808, "episode_return_mean": 19808.011040460864}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.2921471050296, "num_env_steps_trained_throughput_per_sec": 557.2921471050296, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1524000, "timers": {"training_iteration_time_ms": 7341.482, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7341.447, "sample_time_ms": 734.075, "learn_time_ms": 6596.205, "learn_throughput": 606.409, "synch_weights_time_ms": 10.706}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "done": false, "training_iteration": 127, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-50", "timestamp": 1723236350, "time_this_iter_s": 7.1827051639556885, "time_total_s": 967.5033826828003, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3206e9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 967.5033826828003, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 24.770000000000003, "ram_util_percent": 82.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 378255886.821164, "cur_kl_coeff": 1963199245.2131956, "cur_lr": 5.0000000000000016e-05, "total_loss": 68064311.72910053, "policy_loss": 0.037513217200874964, "vf_loss": 10.0, "vf_explained_var": 7.108405784324364e-08, "kl": 0.03467009414908866, "entropy": 1.13330701703117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8888438877960047, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.022000806530317, "policy_loss": 0.006547366347513161, "vf_loss": 9.989098131656647, "vf_explained_var": -0.00011120140552520752, "kl": 0.01625037787113494, "entropy": 1.3423636523385842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 23492.74024026596, "episode_reward_min": 299.19981057406505, "episode_reward_mean": 19264.292276953256, "episode_len_mean": 192.5, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19250, "policy_reward_min": {"agent_policy": 4.498734790888472, "adversary_policy": 87.0677762181008}, "policy_reward_max": {"agent_policy": 10802.213238417467, "adversary_policy": 9910.797319734447}, "policy_reward_mean": {"agent_policy": 7346.053444287573, "adversary_policy": 5959.119416332854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22657.399986532986, 18351.22124524277, 17565.915061285752, 22108.676962207646, 22917.61664243064, 20226.358250762813, 22295.742433431817, 1074.699553018808, 18312.03208158659, 20161.042188811396, 22761.20147499149, 19396.984430809585, 23113.518118327036, 20481.034014268986, 22817.48937331689, 19187.967380802434, 22879.41138160486, 18433.566298915317, 21015.08176269455, 18582.396653732936, 23492.74024026596, 19900.108942490835, 19443.35304563911, 19560.57758302751, 22212.088857321083, 19056.875251337544, 18266.481310727544, 19247.595800657837, 20961.993796511037, 18344.530123252214, 18345.478234626462, 21189.208223187597, 21085.512489060173, 20050.490552402982, 18932.069254392867, 20248.521832895905, 20310.53715093337, 19622.708325864023, 2790.505592113834, 18684.85391989241, 21069.10306949116, 20404.221310389654, 18856.126360792718, 18650.20282700789, 19191.64801140808, 19574.974024265626, 18542.495403384666, 21579.631921531407, 18894.896504651533, 18951.923749029527, 19267.78278439179, 22436.86683873443, 20797.00118629676, 18696.186340057564, 18827.085115653434, 19246.124400953297, 20527.770666440345, 21493.421791113044, 18465.27779780401, 20266.83537368006, 17440.03153022408, 19144.315430426643, 20094.005268716755, 18574.83381249927, 19038.30705822233, 18747.588730507036, 20142.75215462005, 19216.803299553918, 18620.63522520528, 18922.343184816822, 20914.523645378376, 21737.261377481533, 19395.61810459685, 21299.312168867367, 20724.846398906488, 19521.740579854308, 19334.892785895667, 18329.174413187862, 20817.491032353868, 19243.30062919839, 299.19981057406505, 19704.352170585804, 20622.30649759085, 18881.745113188692, 19264.849676313344, 21677.9174092886, 19016.147061999178, 18924.503723067137, 1745.619139918953, 19691.046019586596, 20128.028274604665, 20501.571883973185, 18933.902358613876, 21932.331597350378, 20110.013025510576, 19744.425947121315, 19878.028260451334, 19182.43532069206, 20968.77944222173, 22137.086833707894], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4855.309326228509, 9448.0027917338, 8761.025528384134, 5640.778645621469, 5144.672169953808, 7203.24167574203, 5625.676052895619, 48.22315965981629, 8725.458023378693, 7199.443135981478, 5140.081304754596, 8627.54882208377, 4626.9851376448505, 7244.251234579464, 5078.87184028195, 8055.704560148945, 4212.512776321479, 9035.906662385874, 6497.679297214803, 9396.310669318596, 4582.796297881964, 8042.924686610667, 8587.847259706949, 7280.489250859255, 5844.889494686504, 7638.470513817832, 9473.830932484578, 8551.256686983448, 6886.756885420614, 9633.692871153793, 9411.569446355974, 5785.191192672775, 6595.347978211204, 7846.393560989579, 8592.423104264912, 7772.199418305253, 7495.154969502108, 8049.033248022902, 239.87301843261446, 8028.781089541324, 6433.631414023671, 6217.998886641324, 9224.468154693026, 8042.341104355308, 8611.065934605285, 8595.393197980466, 8692.711638264136, 6533.496361648762, 9192.312613282915, 8029.556125830105, 8205.85361771563, 4925.206046926051, 6966.2274979326385, 9441.458883892521, 8897.872566031168, 8784.004560031533, 6823.105580056546, 6387.130915772442, 9163.176037393783, 7827.376780777675, 10802.213238417467, 8722.625479537131, 8021.7474536805585, 8875.563888612165, 8942.516237240763, 8633.317872022084, 7741.084392713813, 8669.291681489147, 8460.637940596074, 8720.458965408141, 6638.735378980562, 6048.919595883407, 8241.609996736366, 6300.1133457586575, 6422.912828574972, 8222.748962565276, 8841.873223809434, 9344.37379977265, 6837.3303558401085, 8979.23464695795, 4.498734790888472, 8437.700053461333, 7307.567885065563, 9055.819278850848, 8471.746593764876, 6118.859459675993, 8744.640218071734, 8327.751203599551, 89.10617345642484, 7917.359716287988, 7802.6829728448165, 7244.700949556038, 8848.449417054178, 5456.747309649267, 8035.830744435632, 7911.5495835450765, 6944.128606519893, 7901.843927849633, 6791.959515952861, 5824.100161655036], "policy_adversary_policy_reward": [8564.348972307916, 9237.741687996588, 4688.92406883893, 4214.294384670007, 3430.3607491666767, 5374.528783734976, 8472.751548479671, 7995.146768106419, 8782.997157353351, 8989.947315123418, 6093.232345313812, 6929.884229706989, 8495.811005628793, 8174.255374907231, 438.303449950915, 588.1729434080764, 5407.999811097715, 4178.574247110255, 6941.634804024702, 6019.9642488053705, 8645.16001915143, 8975.960151085597, 5374.345842068384, 5395.089766657503, 9490.212907983627, 8996.32007269843, 6350.5241496082845, 6886.2586300812345, 8795.898381021909, 8942.7191520129, 5051.082947834068, 6081.179872819411, 9910.797319734447, 8756.10128554904, 5091.615328398948, 4306.044308130524, 6927.836372836821, 7589.566092643005, 4655.254338227797, 4530.831646186652, 9414.161584300227, 9495.7823580836, 5776.509211590798, 6080.675044289411, 5548.852852657884, 5306.652933274313, 5430.132712278532, 6849.9556198897635, 8221.983343708913, 8145.216018925769, 4920.65846917484, 6497.746268344858, 4661.114671645439, 4131.535706597568, 5110.84540239236, 5585.4937112820835, 6833.293136181262, 7241.943774909191, 4443.241255572806, 4267.595996525692, 4213.621580941181, 4720.2872073293975, 8349.159604911156, 7054.857425603806, 7098.856594458306, 7391.307916390681, 6200.633317362553, 6003.463674050844, 5542.674540094747, 4796.971610033209, 6310.08209691685, 6166.240317673817, 6643.758637077747, 6171.623544353706, 5484.288700458723, 6089.386377382445, 1457.1832564150995, 1093.4493172661205, 4551.139098858587, 6104.9337314925215, 7052.062600512094, 7583.409054955514, 6262.132964983122, 7924.089458765188, 4718.3504697185235, 4913.3077363812445, 4521.101425941139, 6086.760296711457, 5518.40294525111, 5062.179131551644, 5517.804543202398, 5461.776283082774, 5448.0708682751365, 4401.71289684542, 7450.080099432771, 7596.0554604498, 4938.806433121137, 4763.777458247501, 6069.430767007906, 4852.936856191574, 5141.152870963341, 5920.7762957128725, 9189.267025159837, 8322.39376664849, 6688.410401375568, 7142.363286988573, 4667.39761697363, 4587.329839191485, 5241.034966239693, 4688.17758338261, 5126.8705049131895, 5335.249336008566, 6401.738046388915, 7302.927039994885, 7684.324243263904, 7421.966632076706, 4325.599252752708, 4976.502507657566, 6271.245760282472, 6168.212832619921, 3326.2396207054308, 3311.57867110121, 5141.5843628881, 5280.105588001459, 5969.11298455561, 6103.144830480597, 5259.150789865459, 4440.119134021726, 5187.925514579233, 4907.865306402314, 4647.08163517002, 5467.189223315001, 6008.160773702428, 6393.506988203866, 5080.267562824652, 5467.244055240181, 4481.19142384981, 5678.80586075943, 5048.657588976238, 5153.226630432531, 6775.719084455444, 7500.0691819423155, 7601.2462267579685, 8087.095554840151, 5377.797552966582, 5776.210554893969, 7362.749388859256, 7636.449434249429, 7715.232495894395, 6586.70107443713, 5872.586324627913, 5426.405292661152, 5269.51946131929, 5223.500100767061, 4194.095237778564, 4790.705375636658, 6978.023224736347, 7002.1374517773975, 5111.845582178958, 5152.220400061541, 207.6332995650758, 87.0677762181008, 5686.0216161758935, 5580.630500948655, 6781.281716557636, 6533.456895967633, 4960.483938690106, 4865.441895647774, 5293.593210739008, 5499.5098718094905, 8011.0539789509385, 7548.003970661568, 5365.964114716513, 4905.5427292110135, 5807.594894028457, 4789.1576254392085, 755.6696462577867, 900.8433202047418, 5558.585686318793, 6215.100616979779, 5996.320905077595, 6329.024396682355, 6666.89567433134, 6589.975260085742, 5137.444944891943, 4948.007996667824, 7891.459108908958, 8584.125178792097, 6014.5749505003705, 6059.607330574631, 6088.591444760293, 5744.284918816011, 5749.196929264382, 7184.702724667069, 6182.908529460917, 5097.682863381635, 7135.265539388728, 7041.554386880169, 8005.9638660465625, 8307.022806006207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39761519976734294, "mean_inference_ms": 0.9881909337618475, "mean_action_processing_ms": 0.16716743882114707, "mean_env_wait_ms": 0.05392900078590454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012396693229675293, "StateBufferConnector_ms": 0.0027076005935668945, "ViewRequirementAgentConnector_ms": 0.06953036785125732}, "num_episodes": 21, "episode_return_max": 23492.74024026596, "episode_return_min": 299.19981057406505, "episode_return_mean": 19264.292276953256}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.3084905409273, "num_env_steps_trained_throughput_per_sec": 551.3084905409273, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 7328.321, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7328.287, "sample_time_ms": 744.062, "learn_time_ms": 6573.399, "learn_throughput": 608.513, "synch_weights_time_ms": 10.371}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 128, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-45-57", "timestamp": 1723236357, "time_this_iter_s": 7.260343074798584, "time_total_s": 974.7637257575989, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b25700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 974.7637257575989, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 24.5, "ram_util_percent": 82.60909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 606617028.8232805, "cur_kl_coeff": 2944798867.819793, "cur_lr": 5.0000000000000016e-05, "total_loss": 118423901.83174603, "policy_loss": 0.046351077932637756, "vf_loss": 9.99882110161756, "vf_explained_var": 5.719112971472362e-06, "kl": 0.040214592720524814, "entropy": 1.1372889228598781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8587902282830328, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.019816894332568, "policy_loss": -0.0008326802625864123, "vf_loss": 9.995719181497892, "vf_explained_var": -0.00017371432234843573, "kl": 0.015371782457805239, "entropy": 1.287822941566507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "env_runners": {"episode_reward_max": 22436.86683873443, "episode_reward_min": 299.19981057406505, "episode_reward_mean": 18975.32899569229, "episode_len_mean": 192.7, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19270, "policy_reward_min": {"agent_policy": 4.498734790888472, "adversary_policy": 87.0677762181008}, "policy_reward_max": {"agent_policy": 10802.213238417467, "adversary_policy": 9189.267025159837}, "policy_reward_mean": {"agent_policy": 7665.823725237711, "adversary_policy": 5654.752635227304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19443.35304563911, 19560.57758302751, 22212.088857321083, 19056.875251337544, 18266.481310727544, 19247.595800657837, 20961.993796511037, 18344.530123252214, 18345.478234626462, 21189.208223187597, 21085.512489060173, 20050.490552402982, 18932.069254392867, 20248.521832895905, 20310.53715093337, 19622.708325864023, 2790.505592113834, 18684.85391989241, 21069.10306949116, 20404.221310389654, 18856.126360792718, 18650.20282700789, 19191.64801140808, 19574.974024265626, 18542.495403384666, 21579.631921531407, 18894.896504651533, 18951.923749029527, 19267.78278439179, 22436.86683873443, 20797.00118629676, 18696.186340057564, 18827.085115653434, 19246.124400953297, 20527.770666440345, 21493.421791113044, 18465.27779780401, 20266.83537368006, 17440.03153022408, 19144.315430426643, 20094.005268716755, 18574.83381249927, 19038.30705822233, 18747.588730507036, 20142.75215462005, 19216.803299553918, 18620.63522520528, 18922.343184816822, 20914.523645378376, 21737.261377481533, 19395.61810459685, 21299.312168867367, 20724.846398906488, 19521.740579854308, 19334.892785895667, 18329.174413187862, 20817.491032353868, 19243.30062919839, 299.19981057406505, 19704.352170585804, 20622.30649759085, 18881.745113188692, 19264.849676313344, 21677.9174092886, 19016.147061999178, 18924.503723067137, 1745.619139918953, 19691.046019586596, 20128.028274604665, 20501.571883973185, 18933.902358613876, 21932.331597350378, 20110.013025510576, 19744.425947121315, 19878.028260451334, 19182.43532069206, 20968.77944222173, 22137.086833707894, 18983.15143762514, 20266.431536867465, 20141.850855640565, 18278.10723671777, 18553.530408167575, 19903.95755368747, 3800.4495956388496, 18847.505059711424, 20332.108570990134, 19760.739513145818, 18579.4514628688, 18432.17550056726, 20015.906963693502, 19109.153345583996, 18274.632485847946, 18768.491349064618, 19253.53960638454, 19084.428949649388, 20255.810073387758, 18016.601897633554, 20204.73660077059, 19973.116347790583], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8587.847259706949, 7280.489250859255, 5844.889494686504, 7638.470513817832, 9473.830932484578, 8551.256686983448, 6886.756885420614, 9633.692871153793, 9411.569446355974, 5785.191192672775, 6595.347978211204, 7846.393560989579, 8592.423104264912, 7772.199418305253, 7495.154969502108, 8049.033248022902, 239.87301843261446, 8028.781089541324, 6433.631414023671, 6217.998886641324, 9224.468154693026, 8042.341104355308, 8611.065934605285, 8595.393197980466, 8692.711638264136, 6533.496361648762, 9192.312613282915, 8029.556125830105, 8205.85361771563, 4925.206046926051, 6966.2274979326385, 9441.458883892521, 8897.872566031168, 8784.004560031533, 6823.105580056546, 6387.130915772442, 9163.176037393783, 7827.376780777675, 10802.213238417467, 8722.625479537131, 8021.7474536805585, 8875.563888612165, 8942.516237240763, 8633.317872022084, 7741.084392713813, 8669.291681489147, 8460.637940596074, 8720.458965408141, 6638.735378980562, 6048.919595883407, 8241.609996736366, 6300.1133457586575, 6422.912828574972, 8222.748962565276, 8841.873223809434, 9344.37379977265, 6837.3303558401085, 8979.23464695795, 4.498734790888472, 8437.700053461333, 7307.567885065563, 9055.819278850848, 8471.746593764876, 6118.859459675993, 8744.640218071734, 8327.751203599551, 89.10617345642484, 7917.359716287988, 7802.6829728448165, 7244.700949556038, 8848.449417054178, 5456.747309649267, 8035.830744435632, 7911.5495835450765, 6944.128606519893, 7901.843927849633, 6791.959515952861, 5824.100161655036, 7978.312976869656, 7596.8932931382105, 7331.027796865826, 9391.657266106959, 9089.768954417383, 7751.788472141283, 148.692062549653, 8966.89396921668, 7178.633189394184, 7427.183734373816, 9157.890431098433, 9079.59437895124, 7819.978679787412, 8084.770201054667, 9395.112756380408, 9334.553995369906, 8386.513236985174, 8792.262307122994, 7694.868913837005, 9794.325729208991, 6792.234560445988, 7977.474988504345], "policy_adversary_policy_reward": [5548.852852657884, 5306.652933274313, 5430.132712278532, 6849.9556198897635, 8221.983343708913, 8145.216018925769, 4920.65846917484, 6497.746268344858, 4661.114671645439, 4131.535706597568, 5110.84540239236, 5585.4937112820835, 6833.293136181262, 7241.943774909191, 4443.241255572806, 4267.595996525692, 4213.621580941181, 4720.2872073293975, 8349.159604911156, 7054.857425603806, 7098.856594458306, 7391.307916390681, 6200.633317362553, 6003.463674050844, 5542.674540094747, 4796.971610033209, 6310.08209691685, 6166.240317673817, 6643.758637077747, 6171.623544353706, 5484.288700458723, 6089.386377382445, 1457.1832564150995, 1093.4493172661205, 4551.139098858587, 6104.9337314925215, 7052.062600512094, 7583.409054955514, 6262.132964983122, 7924.089458765188, 4718.3504697185235, 4913.3077363812445, 4521.101425941139, 6086.760296711457, 5518.40294525111, 5062.179131551644, 5517.804543202398, 5461.776283082774, 5448.0708682751365, 4401.71289684542, 7450.080099432771, 7596.0554604498, 4938.806433121137, 4763.777458247501, 6069.430767007906, 4852.936856191574, 5141.152870963341, 5920.7762957128725, 9189.267025159837, 8322.39376664849, 6688.410401375568, 7142.363286988573, 4667.39761697363, 4587.329839191485, 5241.034966239693, 4688.17758338261, 5126.8705049131895, 5335.249336008566, 6401.738046388915, 7302.927039994885, 7684.324243263904, 7421.966632076706, 4325.599252752708, 4976.502507657566, 6271.245760282472, 6168.212832619921, 3326.2396207054308, 3311.57867110121, 5141.5843628881, 5280.105588001459, 5969.11298455561, 6103.144830480597, 5259.150789865459, 4440.119134021726, 5187.925514579233, 4907.865306402314, 4647.08163517002, 5467.189223315001, 6008.160773702428, 6393.506988203866, 5080.267562824652, 5467.244055240181, 4481.19142384981, 5678.80586075943, 5048.657588976238, 5153.226630432531, 6775.719084455444, 7500.0691819423155, 7601.2462267579685, 8087.095554840151, 5377.797552966582, 5776.210554893969, 7362.749388859256, 7636.449434249429, 7715.232495894395, 6586.70107443713, 5872.586324627913, 5426.405292661152, 5269.51946131929, 5223.500100767061, 4194.095237778564, 4790.705375636658, 6978.023224736347, 7002.1374517773975, 5111.845582178958, 5152.220400061541, 207.6332995650758, 87.0677762181008, 5686.0216161758935, 5580.630500948655, 6781.281716557636, 6533.456895967633, 4960.483938690106, 4865.441895647774, 5293.593210739008, 5499.5098718094905, 8011.0539789509385, 7548.003970661568, 5365.964114716513, 4905.5427292110135, 5807.594894028457, 4789.1576254392085, 755.6696462577867, 900.8433202047418, 5558.585686318793, 6215.100616979779, 5996.320905077595, 6329.024396682355, 6666.89567433134, 6589.975260085742, 5137.444944891943, 4948.007996667824, 7891.459108908958, 8584.125178792097, 6014.5749505003705, 6059.607330574631, 6088.591444760293, 5744.284918816011, 5749.196929264382, 7184.702724667069, 6182.908529460917, 5097.682863381635, 7135.265539388728, 7041.554386880169, 8005.9638660465625, 8307.022806006207, 4903.546197370443, 6101.2922633851085, 6536.86221649302, 6132.676027236311, 6097.852073558169, 6712.970985216604, 4151.555628479104, 4734.894342131741, 4544.174952574168, 4919.5865011761325, 6336.466260764263, 5815.702820782001, 1889.3672383640642, 1762.3902947251283, 4707.140134944997, 5173.470955549764, 6954.655029565716, 6198.820352030295, 6430.294829230817, 5903.2609495412435, 4450.489129596685, 4971.071902173731, 4298.303126538971, 5054.27799507715, 6311.664883343069, 5884.263400563001, 4977.8593935926565, 6046.523750936676, 4167.169804145704, 4712.349925321922, 4803.126451443574, 4630.810902251209, 5173.149697803053, 5693.876671596466, 5345.793833619916, 4946.372808906642, 6267.190646318824, 6293.75051323199, 4343.8872869825, 3878.3888814421193, 7321.050516242843, 6091.451524081735, 5835.970130366651, 6159.67122891961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3975128957368143, "mean_inference_ms": 0.9876941461186438, "mean_action_processing_ms": 0.16709845691422187, "mean_env_wait_ms": 0.0539167254626517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240052223205566, "StateBufferConnector_ms": 0.002599477767944336, "ViewRequirementAgentConnector_ms": 0.06872665882110596}, "num_episodes": 22, "episode_return_max": 22436.86683873443, "episode_return_min": 299.19981057406505, "episode_return_mean": 18975.32899569229}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.548653377749, "num_env_steps_trained_throughput_per_sec": 546.548653377749, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1548000, "timers": {"training_iteration_time_ms": 7281.168, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7281.134, "sample_time_ms": 742.461, "learn_time_ms": 6527.517, "learn_throughput": 612.79, "synch_weights_time_ms": 10.696}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "done": false, "training_iteration": 129, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-04", "timestamp": 1723236364, "time_this_iter_s": 7.323753118515015, "time_total_s": 982.0874788761139, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b25af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 982.0874788761139, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 25.54, "ram_util_percent": 82.57}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 799132301.6571429, "cur_kl_coeff": 4417198301.72969, "cur_lr": 5.0000000000000016e-05, "total_loss": 147575570.85714287, "policy_loss": 0.03138435749834768, "vf_loss": 10.0, "vf_explained_var": 2.1681362989718322e-05, "kl": 0.033409314114777815, "entropy": 1.1430911259045677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8976643212605268, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.022620341181755, "policy_loss": 0.003476191574494199, "vf_loss": 9.990659670035045, "vf_explained_var": -0.0001673353835940361, "kl": 0.01756316478034326, "entropy": 1.2454217301060757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 22436.86683873443, "episode_reward_min": 299.19981057406505, "episode_reward_mean": 18779.733767610673, "episode_len_mean": 190.89, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19089, "policy_reward_min": {"agent_policy": 4.498734790888472, "adversary_policy": 87.0677762181008}, "policy_reward_max": {"agent_policy": 10802.213238417467, "adversary_policy": 9261.745662731102}, "policy_reward_mean": {"agent_policy": 7622.737738185927, "adversary_policy": 5578.49801471239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18856.126360792718, 18650.20282700789, 19191.64801140808, 19574.974024265626, 18542.495403384666, 21579.631921531407, 18894.896504651533, 18951.923749029527, 19267.78278439179, 22436.86683873443, 20797.00118629676, 18696.186340057564, 18827.085115653434, 19246.124400953297, 20527.770666440345, 21493.421791113044, 18465.27779780401, 20266.83537368006, 17440.03153022408, 19144.315430426643, 20094.005268716755, 18574.83381249927, 19038.30705822233, 18747.588730507036, 20142.75215462005, 19216.803299553918, 18620.63522520528, 18922.343184816822, 20914.523645378376, 21737.261377481533, 19395.61810459685, 21299.312168867367, 20724.846398906488, 19521.740579854308, 19334.892785895667, 18329.174413187862, 20817.491032353868, 19243.30062919839, 299.19981057406505, 19704.352170585804, 20622.30649759085, 18881.745113188692, 19264.849676313344, 21677.9174092886, 19016.147061999178, 18924.503723067137, 1745.619139918953, 19691.046019586596, 20128.028274604665, 20501.571883973185, 18933.902358613876, 21932.331597350378, 20110.013025510576, 19744.425947121315, 19878.028260451334, 19182.43532069206, 20968.77944222173, 22137.086833707894, 18983.15143762514, 20266.431536867465, 20141.850855640565, 18278.10723671777, 18553.530408167575, 19903.95755368747, 3800.4495956388496, 18847.505059711424, 20332.108570990134, 19760.739513145818, 18579.4514628688, 18432.17550056726, 20015.906963693502, 19109.153345583996, 18274.632485847946, 18768.491349064618, 19253.53960638454, 19084.428949649388, 20255.810073387758, 18016.601897633554, 20204.73660077059, 19973.116347790583, 19143.358053512144, 20827.582357430038, 20535.731306355945, 18132.18993825238, 18382.18553697375, 19302.5809607786, 19797.92591619244, 20461.075934617762, 21765.817791581227, 18619.766720218766, 20387.935142624072, 18147.323417899064, 22389.540559615038, 18557.888480938174, 20138.743143288346, 19444.762309451096, 4039.1240522231965, 19627.748962120608, 1114.2869104941951, 19451.615420996386], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 9, 200], "policy_agent_policy_reward": [9224.468154693026, 8042.341104355308, 8611.065934605285, 8595.393197980466, 8692.711638264136, 6533.496361648762, 9192.312613282915, 8029.556125830105, 8205.85361771563, 4925.206046926051, 6966.2274979326385, 9441.458883892521, 8897.872566031168, 8784.004560031533, 6823.105580056546, 6387.130915772442, 9163.176037393783, 7827.376780777675, 10802.213238417467, 8722.625479537131, 8021.7474536805585, 8875.563888612165, 8942.516237240763, 8633.317872022084, 7741.084392713813, 8669.291681489147, 8460.637940596074, 8720.458965408141, 6638.735378980562, 6048.919595883407, 8241.609996736366, 6300.1133457586575, 6422.912828574972, 8222.748962565276, 8841.873223809434, 9344.37379977265, 6837.3303558401085, 8979.23464695795, 4.498734790888472, 8437.700053461333, 7307.567885065563, 9055.819278850848, 8471.746593764876, 6118.859459675993, 8744.640218071734, 8327.751203599551, 89.10617345642484, 7917.359716287988, 7802.6829728448165, 7244.700949556038, 8848.449417054178, 5456.747309649267, 8035.830744435632, 7911.5495835450765, 6944.128606519893, 7901.843927849633, 6791.959515952861, 5824.100161655036, 7978.312976869656, 7596.8932931382105, 7331.027796865826, 9391.657266106959, 9089.768954417383, 7751.788472141283, 148.692062549653, 8966.89396921668, 7178.633189394184, 7427.183734373816, 9157.890431098433, 9079.59437895124, 7819.978679787412, 8084.770201054667, 9395.112756380408, 9334.553995369906, 8386.513236985174, 8792.262307122994, 7694.868913837005, 9794.325729208991, 6792.234560445988, 7977.474988504345, 8801.876970159188, 6927.050845763118, 7214.069047012028, 9435.414853637716, 9669.491236259535, 8244.880589863977, 7928.5931845657005, 7200.099875598594, 4880.231969380345, 8965.133996822693, 6958.6779965963, 9944.422551568929, 5547.503384972563, 8857.240495166498, 7616.836143298189, 7880.2635277705995, 215.06716904592736, 7726.458580105741, 41.42876419445746, 8001.491335115818], "policy_adversary_policy_reward": [4718.3504697185235, 4913.3077363812445, 4521.101425941139, 6086.760296711457, 5518.40294525111, 5062.179131551644, 5517.804543202398, 5461.776283082774, 5448.0708682751365, 4401.71289684542, 7450.080099432771, 7596.0554604498, 4938.806433121137, 4763.777458247501, 6069.430767007906, 4852.936856191574, 5141.152870963341, 5920.7762957128725, 9189.267025159837, 8322.39376664849, 6688.410401375568, 7142.363286988573, 4667.39761697363, 4587.329839191485, 5241.034966239693, 4688.17758338261, 5126.8705049131895, 5335.249336008566, 6401.738046388915, 7302.927039994885, 7684.324243263904, 7421.966632076706, 4325.599252752708, 4976.502507657566, 6271.245760282472, 6168.212832619921, 3326.2396207054308, 3311.57867110121, 5141.5843628881, 5280.105588001459, 5969.11298455561, 6103.144830480597, 5259.150789865459, 4440.119134021726, 5187.925514579233, 4907.865306402314, 4647.08163517002, 5467.189223315001, 6008.160773702428, 6393.506988203866, 5080.267562824652, 5467.244055240181, 4481.19142384981, 5678.80586075943, 5048.657588976238, 5153.226630432531, 6775.719084455444, 7500.0691819423155, 7601.2462267579685, 8087.095554840151, 5377.797552966582, 5776.210554893969, 7362.749388859256, 7636.449434249429, 7715.232495894395, 6586.70107443713, 5872.586324627913, 5426.405292661152, 5269.51946131929, 5223.500100767061, 4194.095237778564, 4790.705375636658, 6978.023224736347, 7002.1374517773975, 5111.845582178958, 5152.220400061541, 207.6332995650758, 87.0677762181008, 5686.0216161758935, 5580.630500948655, 6781.281716557636, 6533.456895967633, 4960.483938690106, 4865.441895647774, 5293.593210739008, 5499.5098718094905, 8011.0539789509385, 7548.003970661568, 5365.964114716513, 4905.5427292110135, 5807.594894028457, 4789.1576254392085, 755.6696462577867, 900.8433202047418, 5558.585686318793, 6215.100616979779, 5996.320905077595, 6329.024396682355, 6666.89567433134, 6589.975260085742, 5137.444944891943, 4948.007996667824, 7891.459108908958, 8584.125178792097, 6014.5749505003705, 6059.607330574631, 6088.591444760293, 5744.284918816011, 5749.196929264382, 7184.702724667069, 6182.908529460917, 5097.682863381635, 7135.265539388728, 7041.554386880169, 8005.9638660465625, 8307.022806006207, 4903.546197370443, 6101.2922633851085, 6536.86221649302, 6132.676027236311, 6097.852073558169, 6712.970985216604, 4151.555628479104, 4734.894342131741, 4544.174952574168, 4919.5865011761325, 6336.466260764263, 5815.702820782001, 1889.3672383640642, 1762.3902947251283, 4707.140134944997, 5173.470955549764, 6954.655029565716, 6198.820352030295, 6430.294829230817, 5903.2609495412435, 4450.489129596685, 4971.071902173731, 4298.303126538971, 5054.27799507715, 6311.664883343069, 5884.263400563001, 4977.8593935926565, 6046.523750936676, 4167.169804145704, 4712.349925321922, 4803.126451443574, 4630.810902251209, 5173.149697803053, 5693.876671596466, 5345.793833619916, 4946.372808906642, 6267.190646318824, 6293.75051323199, 4343.8872869825, 3878.3888814421193, 7321.050516242843, 6091.451524081735, 5835.970130366651, 6159.67122891961, 5007.104236246979, 5334.37684710613, 6963.701115511924, 6936.830396154925, 6770.39324204356, 6551.269017300383, 4697.288522138555, 3999.486562476195, 4467.691271384254, 4245.003029330089, 5357.519556801125, 5700.180814113552, 5659.893056573921, 6209.439675052796, 6799.813463161888, 6461.162595857342, 9261.745662731102, 7623.840159469768, 4507.89727449624, 5146.7354488999035, 7163.312826916737, 6265.94431911105, 4184.738640188531, 4018.1622261416937, 8252.30945620249, 8589.727718439826, 4427.998526478978, 5272.649459292753, 6415.556902649539, 6106.350097340643, 5592.690244995658, 5971.808536684869, 2113.498456178962, 1710.558426998308, 6345.1875422325875, 5556.10283978232, 594.9673388734353, 477.89080742630233, 5541.08032619099, 5909.043759689618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39742464935963157, "mean_inference_ms": 0.9875589954507924, "mean_action_processing_ms": 0.16703583532817273, "mean_env_wait_ms": 0.05387039639571152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226961612701416, "StateBufferConnector_ms": 0.0026003122329711914, "ViewRequirementAgentConnector_ms": 0.06805980205535889}, "num_episodes": 20, "episode_return_max": 22436.86683873443, "episode_return_min": 299.19981057406505, "episode_return_mean": 18779.733767610673}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 570.4591060517325, "num_env_steps_trained_throughput_per_sec": 570.4591060517325, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 7251.897, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7251.863, "sample_time_ms": 745.949, "learn_time_ms": 6494.396, "learn_throughput": 615.916, "synch_weights_time_ms": 11.062}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 130, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-12", "timestamp": 1723236372, "time_this_iter_s": 7.017445087432861, "time_total_s": 989.1049239635468, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b25b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 989.1049239635468, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 25.563636363636363, "ram_util_percent": 81.99090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1431891915.1915343, "cur_kl_coeff": 6625797452.594532, "cur_lr": 5.0000000000000016e-05, "total_loss": 265354969.39259258, "policy_loss": 0.034868604290698255, "vf_loss": 10.0, "vf_explained_var": 3.898175305159634e-06, "kl": 0.0400487571984293, "entropy": 1.1517057932243144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8762777030157546, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.018958806991577, "policy_loss": -0.0030988854031117324, "vf_loss": 10.0, "vf_explained_var": -0.00014412241677443186, "kl": 0.013600506648072042, "entropy": 1.2122410734494526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "env_runners": {"episode_reward_max": 22689.311497715502, "episode_reward_min": 299.19981057406505, "episode_reward_mean": 18778.02825842086, "episode_len_mean": 190.89, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19089, "policy_reward_min": {"agent_policy": 4.498734790888472, "adversary_policy": 87.0677762181008}, "policy_reward_max": {"agent_policy": 10228.777034376879, "adversary_policy": 9508.78217432008}, "policy_reward_mean": {"agent_policy": 7609.510045211001, "adversary_policy": 5584.259106604946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19038.30705822233, 18747.588730507036, 20142.75215462005, 19216.803299553918, 18620.63522520528, 18922.343184816822, 20914.523645378376, 21737.261377481533, 19395.61810459685, 21299.312168867367, 20724.846398906488, 19521.740579854308, 19334.892785895667, 18329.174413187862, 20817.491032353868, 19243.30062919839, 299.19981057406505, 19704.352170585804, 20622.30649759085, 18881.745113188692, 19264.849676313344, 21677.9174092886, 19016.147061999178, 18924.503723067137, 1745.619139918953, 19691.046019586596, 20128.028274604665, 20501.571883973185, 18933.902358613876, 21932.331597350378, 20110.013025510576, 19744.425947121315, 19878.028260451334, 19182.43532069206, 20968.77944222173, 22137.086833707894, 18983.15143762514, 20266.431536867465, 20141.850855640565, 18278.10723671777, 18553.530408167575, 19903.95755368747, 3800.4495956388496, 18847.505059711424, 20332.108570990134, 19760.739513145818, 18579.4514628688, 18432.17550056726, 20015.906963693502, 19109.153345583996, 18274.632485847946, 18768.491349064618, 19253.53960638454, 19084.428949649388, 20255.810073387758, 18016.601897633554, 20204.73660077059, 19973.116347790583, 19143.358053512144, 20827.582357430038, 20535.731306355945, 18132.18993825238, 18382.18553697375, 19302.5809607786, 19797.92591619244, 20461.075934617762, 21765.817791581227, 18619.766720218766, 20387.935142624072, 18147.323417899064, 22389.540559615038, 18557.888480938174, 20138.743143288346, 19444.762309451096, 4039.1240522231965, 19627.748962120608, 1114.2869104941951, 19451.615420996386, 21775.459417453738, 18005.23494358165, 22689.311497715502, 19474.301292382388, 18380.05695787037, 19383.309979404115, 20693.13476053435, 18560.74266099709, 19956.79005919198, 19324.578003305433, 19260.223951977263, 20818.528483441052, 19231.921333907077, 19405.85254638597, 19051.852571134972, 18425.891122816, 18179.741429778132, 18516.276562160896, 18677.408871823107, 19154.720160669676, 20880.802538564585, 19502.74707498637], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8942.516237240763, 8633.317872022084, 7741.084392713813, 8669.291681489147, 8460.637940596074, 8720.458965408141, 6638.735378980562, 6048.919595883407, 8241.609996736366, 6300.1133457586575, 6422.912828574972, 8222.748962565276, 8841.873223809434, 9344.37379977265, 6837.3303558401085, 8979.23464695795, 4.498734790888472, 8437.700053461333, 7307.567885065563, 9055.819278850848, 8471.746593764876, 6118.859459675993, 8744.640218071734, 8327.751203599551, 89.10617345642484, 7917.359716287988, 7802.6829728448165, 7244.700949556038, 8848.449417054178, 5456.747309649267, 8035.830744435632, 7911.5495835450765, 6944.128606519893, 7901.843927849633, 6791.959515952861, 5824.100161655036, 7978.312976869656, 7596.8932931382105, 7331.027796865826, 9391.657266106959, 9089.768954417383, 7751.788472141283, 148.692062549653, 8966.89396921668, 7178.633189394184, 7427.183734373816, 9157.890431098433, 9079.59437895124, 7819.978679787412, 8084.770201054667, 9395.112756380408, 9334.553995369906, 8386.513236985174, 8792.262307122994, 7694.868913837005, 9794.325729208991, 6792.234560445988, 7977.474988504345, 8801.876970159188, 6927.050845763118, 7214.069047012028, 9435.414853637716, 9669.491236259535, 8244.880589863977, 7928.5931845657005, 7200.099875598594, 4880.231969380345, 8965.133996822693, 6958.6779965963, 9944.422551568929, 5547.503384972563, 8857.240495166498, 7616.836143298189, 7880.2635277705995, 215.06716904592736, 7726.458580105741, 41.42876419445746, 8001.491335115818, 5933.109425759062, 10228.777034376879, 4619.714878222863, 8180.627731241964, 8483.210055624855, 8499.758721389162, 6853.256992440968, 9328.588127472478, 7977.692027402156, 8536.617550693101, 8121.5121878310965, 7303.155900626167, 7628.884143615632, 8038.351256464206, 9092.773801684063, 9476.168394049866, 9719.608708991826, 9095.633018859666, 8910.46193551345, 8976.807067257516, 6219.550637837802, 8217.878782590129], "policy_adversary_policy_reward": [5187.925514579233, 4907.865306402314, 4647.08163517002, 5467.189223315001, 6008.160773702428, 6393.506988203866, 5080.267562824652, 5467.244055240181, 4481.19142384981, 5678.80586075943, 5048.657588976238, 5153.226630432531, 6775.719084455444, 7500.0691819423155, 7601.2462267579685, 8087.095554840151, 5377.797552966582, 5776.210554893969, 7362.749388859256, 7636.449434249429, 7715.232495894395, 6586.70107443713, 5872.586324627913, 5426.405292661152, 5269.51946131929, 5223.500100767061, 4194.095237778564, 4790.705375636658, 6978.023224736347, 7002.1374517773975, 5111.845582178958, 5152.220400061541, 207.6332995650758, 87.0677762181008, 5686.0216161758935, 5580.630500948655, 6781.281716557636, 6533.456895967633, 4960.483938690106, 4865.441895647774, 5293.593210739008, 5499.5098718094905, 8011.0539789509385, 7548.003970661568, 5365.964114716513, 4905.5427292110135, 5807.594894028457, 4789.1576254392085, 755.6696462577867, 900.8433202047418, 5558.585686318793, 6215.100616979779, 5996.320905077595, 6329.024396682355, 6666.89567433134, 6589.975260085742, 5137.444944891943, 4948.007996667824, 7891.459108908958, 8584.125178792097, 6014.5749505003705, 6059.607330574631, 6088.591444760293, 5744.284918816011, 5749.196929264382, 7184.702724667069, 6182.908529460917, 5097.682863381635, 7135.265539388728, 7041.554386880169, 8005.9638660465625, 8307.022806006207, 4903.546197370443, 6101.2922633851085, 6536.86221649302, 6132.676027236311, 6097.852073558169, 6712.970985216604, 4151.555628479104, 4734.894342131741, 4544.174952574168, 4919.5865011761325, 6336.466260764263, 5815.702820782001, 1889.3672383640642, 1762.3902947251283, 4707.140134944997, 5173.470955549764, 6954.655029565716, 6198.820352030295, 6430.294829230817, 5903.2609495412435, 4450.489129596685, 4971.071902173731, 4298.303126538971, 5054.27799507715, 6311.664883343069, 5884.263400563001, 4977.8593935926565, 6046.523750936676, 4167.169804145704, 4712.349925321922, 4803.126451443574, 4630.810902251209, 5173.149697803053, 5693.876671596466, 5345.793833619916, 4946.372808906642, 6267.190646318824, 6293.75051323199, 4343.8872869825, 3878.3888814421193, 7321.050516242843, 6091.451524081735, 5835.970130366651, 6159.67122891961, 5007.104236246979, 5334.37684710613, 6963.701115511924, 6936.830396154925, 6770.39324204356, 6551.269017300383, 4697.288522138555, 3999.486562476195, 4467.691271384254, 4245.003029330089, 5357.519556801125, 5700.180814113552, 5659.893056573921, 6209.439675052796, 6799.813463161888, 6461.162595857342, 9261.745662731102, 7623.840159469768, 4507.89727449624, 5146.7354488999035, 7163.312826916737, 6265.94431911105, 4184.738640188531, 4018.1622261416937, 8252.30945620249, 8589.727718439826, 4427.998526478978, 5272.649459292753, 6415.556902649539, 6106.350097340643, 5592.690244995658, 5971.808536684869, 2113.498456178962, 1710.558426998308, 6345.1875422325875, 5556.10283978232, 594.9673388734353, 477.89080742630233, 5541.08032619099, 5909.043759689618, 7653.264895059187, 8189.085096635437, 3888.3223895331917, 3888.1355196716513, 9508.78217432008, 8560.814445172473, 5373.639765311524, 5920.033795828944, 5645.116431111249, 4251.730471134344, 5494.231619777527, 5389.31963823748, 6592.286374564549, 7247.591393528718, 4432.042313810346, 4800.112219714365, 5918.9961062949715, 6060.101925494853, 5561.67059935418, 5226.289853258175, 5176.807194430082, 5961.904569716146, 6749.117485753179, 6766.255097061693, 5113.017991488368, 6490.019198803064, 5289.283069609941, 6078.2182203118955, 4923.222834811959, 5035.855934638978, 4622.3205232636155, 4327.4022055025835, 4420.136917798683, 4039.9958029877316, 5035.669125118417, 4384.974418182909, 4823.62272839993, 4943.324207909738, 5021.711888458992, 5156.201204953226, 7915.264734574668, 6745.987166152049, 5397.05260803152, 5887.815684364715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39769682678266394, "mean_inference_ms": 0.9883847297808742, "mean_action_processing_ms": 0.1671566761924064, "mean_env_wait_ms": 0.0539474372906969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01256871223449707, "StateBufferConnector_ms": 0.002776622772216797, "ViewRequirementAgentConnector_ms": 0.07240653038024902}, "num_episodes": 22, "episode_return_max": 22689.311497715502, "episode_return_min": 299.19981057406505, "episode_return_mean": 18778.02825842086}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.8086793117853, "num_env_steps_trained_throughput_per_sec": 504.8086793117853, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 7317.248, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7317.212, "sample_time_ms": 802.246, "learn_time_ms": 6503.422, "learn_throughput": 615.061, "synch_weights_time_ms": 11.078}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "training_iteration": 131, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-20", "timestamp": 1723236380, "time_this_iter_s": 7.9285149574279785, "time_total_s": 997.0334389209747, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3aade50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 997.0334389209747, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 31.66363636363637, "ram_util_percent": 82.33636363636361}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2261960243.4031744, "cur_kl_coeff": 9938696178.891798, "cur_lr": 5.0000000000000016e-05, "total_loss": 481513529.43915343, "policy_loss": 0.0451056610850775, "vf_loss": 9.998733788444882, "vf_explained_var": 1.3428863394197333e-05, "kl": 0.0484483598184491, "entropy": 1.1600120282047008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8923143840394914, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.013089163104693, "policy_loss": -0.0024457342520084542, "vf_loss": 9.995347009102504, "vf_explained_var": -0.0002009167025486628, "kl": 0.012447618652367964, "entropy": 1.2255847830325366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 22689.311497715502, "episode_reward_min": 266.1071777233142, "episode_reward_mean": 18677.718152161437, "episode_len_mean": 190.88, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19088, "policy_reward_min": {"agent_policy": 2.1215050155242454, "adversary_policy": 124.68582148600467}, "policy_reward_max": {"agent_policy": 10228.777034376879, "adversary_policy": 9508.78217432008}, "policy_reward_mean": {"agent_policy": 7666.727914900801, "adversary_policy": 5505.495118630334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21677.9174092886, 19016.147061999178, 18924.503723067137, 1745.619139918953, 19691.046019586596, 20128.028274604665, 20501.571883973185, 18933.902358613876, 21932.331597350378, 20110.013025510576, 19744.425947121315, 19878.028260451334, 19182.43532069206, 20968.77944222173, 22137.086833707894, 18983.15143762514, 20266.431536867465, 20141.850855640565, 18278.10723671777, 18553.530408167575, 19903.95755368747, 3800.4495956388496, 18847.505059711424, 20332.108570990134, 19760.739513145818, 18579.4514628688, 18432.17550056726, 20015.906963693502, 19109.153345583996, 18274.632485847946, 18768.491349064618, 19253.53960638454, 19084.428949649388, 20255.810073387758, 18016.601897633554, 20204.73660077059, 19973.116347790583, 19143.358053512144, 20827.582357430038, 20535.731306355945, 18132.18993825238, 18382.18553697375, 19302.5809607786, 19797.92591619244, 20461.075934617762, 21765.817791581227, 18619.766720218766, 20387.935142624072, 18147.323417899064, 22389.540559615038, 18557.888480938174, 20138.743143288346, 19444.762309451096, 4039.1240522231965, 19627.748962120608, 1114.2869104941951, 19451.615420996386, 21775.459417453738, 18005.23494358165, 22689.311497715502, 19474.301292382388, 18380.05695787037, 19383.309979404115, 20693.13476053435, 18560.74266099709, 19956.79005919198, 19324.578003305433, 19260.223951977263, 20818.528483441052, 19231.921333907077, 19405.85254638597, 19051.852571134972, 18425.891122816, 18179.741429778132, 18516.276562160896, 18677.408871823107, 19154.720160669676, 20880.802538564585, 19502.74707498637, 18527.520066646885, 19535.57310205958, 19129.776489489213, 20738.744790492467, 19447.35495686682, 18249.43137377179, 18316.249462937485, 18768.9274597857, 20574.88022676129, 266.1071777233142, 20478.627366034205, 21033.470761065786, 20073.905925786235, 18552.089515054402, 18702.36259886871, 17952.112642534223, 19356.847455188243, 17723.326953611315, 18960.051375169798, 19309.66912087714, 19051.004610231965], "episode_lengths": [200, 200, 200, 14, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6118.859459675993, 8744.640218071734, 8327.751203599551, 89.10617345642484, 7917.359716287988, 7802.6829728448165, 7244.700949556038, 8848.449417054178, 5456.747309649267, 8035.830744435632, 7911.5495835450765, 6944.128606519893, 7901.843927849633, 6791.959515952861, 5824.100161655036, 7978.312976869656, 7596.8932931382105, 7331.027796865826, 9391.657266106959, 9089.768954417383, 7751.788472141283, 148.692062549653, 8966.89396921668, 7178.633189394184, 7427.183734373816, 9157.890431098433, 9079.59437895124, 7819.978679787412, 8084.770201054667, 9395.112756380408, 9334.553995369906, 8386.513236985174, 8792.262307122994, 7694.868913837005, 9794.325729208991, 6792.234560445988, 7977.474988504345, 8801.876970159188, 6927.050845763118, 7214.069047012028, 9435.414853637716, 9669.491236259535, 8244.880589863977, 7928.5931845657005, 7200.099875598594, 4880.231969380345, 8965.133996822693, 6958.6779965963, 9944.422551568929, 5547.503384972563, 8857.240495166498, 7616.836143298189, 7880.2635277705995, 215.06716904592736, 7726.458580105741, 41.42876419445746, 8001.491335115818, 5933.109425759062, 10228.777034376879, 4619.714878222863, 8180.627731241964, 8483.210055624855, 8499.758721389162, 6853.256992440968, 9328.588127472478, 7977.692027402156, 8536.617550693101, 8121.5121878310965, 7303.155900626167, 7628.884143615632, 8038.351256464206, 9092.773801684063, 9476.168394049866, 9719.608708991826, 9095.633018859666, 8910.46193551345, 8976.807067257516, 6219.550637837802, 8217.878782590129, 8758.94253827171, 8412.18707541713, 8422.821192334824, 6597.84255676613, 8160.3445809434415, 9331.995359216247, 8983.33695118514, 8474.419595462183, 6956.465574485073, 2.1215050155242454, 7404.606255852118, 6829.259355686212, 7647.726109769701, 9217.130416583452, 9218.989903215223, 8173.707900721286, 8443.063025775082, 8599.228562879092, 9056.858593852065, 8708.709166038165, 8644.52251979307], "policy_adversary_policy_reward": [8011.0539789509385, 7548.003970661568, 5365.964114716513, 4905.5427292110135, 5807.594894028457, 4789.1576254392085, 755.6696462577867, 900.8433202047418, 5558.585686318793, 6215.100616979779, 5996.320905077595, 6329.024396682355, 6666.89567433134, 6589.975260085742, 5137.444944891943, 4948.007996667824, 7891.459108908958, 8584.125178792097, 6014.5749505003705, 6059.607330574631, 6088.591444760293, 5744.284918816011, 5749.196929264382, 7184.702724667069, 6182.908529460917, 5097.682863381635, 7135.265539388728, 7041.554386880169, 8005.9638660465625, 8307.022806006207, 4903.546197370443, 6101.2922633851085, 6536.86221649302, 6132.676027236311, 6097.852073558169, 6712.970985216604, 4151.555628479104, 4734.894342131741, 4544.174952574168, 4919.5865011761325, 6336.466260764263, 5815.702820782001, 1889.3672383640642, 1762.3902947251283, 4707.140134944997, 5173.470955549764, 6954.655029565716, 6198.820352030295, 6430.294829230817, 5903.2609495412435, 4450.489129596685, 4971.071902173731, 4298.303126538971, 5054.27799507715, 6311.664883343069, 5884.263400563001, 4977.8593935926565, 6046.523750936676, 4167.169804145704, 4712.349925321922, 4803.126451443574, 4630.810902251209, 5173.149697803053, 5693.876671596466, 5345.793833619916, 4946.372808906642, 6267.190646318824, 6293.75051323199, 4343.8872869825, 3878.3888814421193, 7321.050516242843, 6091.451524081735, 5835.970130366651, 6159.67122891961, 5007.104236246979, 5334.37684710613, 6963.701115511924, 6936.830396154925, 6770.39324204356, 6551.269017300383, 4697.288522138555, 3999.486562476195, 4467.691271384254, 4245.003029330089, 5357.519556801125, 5700.180814113552, 5659.893056573921, 6209.439675052796, 6799.813463161888, 6461.162595857342, 9261.745662731102, 7623.840159469768, 4507.89727449624, 5146.7354488999035, 7163.312826916737, 6265.94431911105, 4184.738640188531, 4018.1622261416937, 8252.30945620249, 8589.727718439826, 4427.998526478978, 5272.649459292753, 6415.556902649539, 6106.350097340643, 5592.690244995658, 5971.808536684869, 2113.498456178962, 1710.558426998308, 6345.1875422325875, 5556.10283978232, 594.9673388734353, 477.89080742630233, 5541.08032619099, 5909.043759689618, 7653.264895059187, 8189.085096635437, 3888.3223895331917, 3888.1355196716513, 9508.78217432008, 8560.814445172473, 5373.639765311524, 5920.033795828944, 5645.116431111249, 4251.730471134344, 5494.231619777527, 5389.31963823748, 6592.286374564549, 7247.591393528718, 4432.042313810346, 4800.112219714365, 5918.9961062949715, 6060.101925494853, 5561.67059935418, 5226.289853258175, 5176.807194430082, 5961.904569716146, 6749.117485753179, 6766.255097061693, 5113.017991488368, 6490.019198803064, 5289.283069609941, 6078.2182203118955, 4923.222834811959, 5035.855934638978, 4622.3205232636155, 4327.4022055025835, 4420.136917798683, 4039.9958029877316, 5035.669125118417, 4384.974418182909, 4823.62272839993, 4943.324207909738, 5021.711888458992, 5156.201204953226, 7915.264734574668, 6745.987166152049, 5397.05260803152, 5887.815684364715, 4424.436356219477, 5344.141172155749, 5510.812147156311, 5612.573879486184, 4992.475967058441, 5714.479330096007, 7541.77392099929, 6599.128312726993, 5409.018968287969, 5877.9914076354535, 4176.774840170948, 4740.661174384566, 4198.771217629347, 5134.14129412308, 5616.184401391264, 4678.3234629323015, 7138.381293577237, 6480.03335869893, 124.68582148600467, 139.29985122178527, 6345.15545780671, 6728.86565237543, 6897.306553839719, 7306.90485153975, 5935.018585287366, 6491.161230729187, 4921.862750489981, 4413.096347981055, 4719.412380478605, 4763.960315174945, 3924.4965060432237, 5853.908235769728, 5698.563946912402, 5215.220482500797, 5521.058873533425, 3603.0395171987907, 4870.060410746975, 5033.132370570803, 5412.282007921053, 5188.677946917989, 5464.674014394698, 4941.808076044215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39806472220458744, "mean_inference_ms": 0.9891809172266303, "mean_action_processing_ms": 0.16727588770556143, "mean_env_wait_ms": 0.05402010155255473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272594928741455, "StateBufferConnector_ms": 0.00276339054107666, "ViewRequirementAgentConnector_ms": 0.07068026065826416}, "num_episodes": 21, "episode_return_max": 22689.311497715502, "episode_return_min": 266.1071777233142, "episode_return_mean": 18677.718152161437}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.9851303825589, "num_env_steps_trained_throughput_per_sec": 551.9851303825589, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 7310.421, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7310.385, "sample_time_ms": 802.797, "learn_time_ms": 6496.361, "learn_throughput": 615.729, "synch_weights_time_ms": 10.811}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 132, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-27", "timestamp": 1723236387, "time_this_iter_s": 7.259235858917236, "time_total_s": 1004.292674779892, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b25f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1004.292674779892, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 24.063636363636363, "ram_util_percent": 82.27272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3440375385.701587, "cur_kl_coeff": 14908044268.337704, "cur_lr": 5.0000000000000016e-05, "total_loss": 619578022.2730159, "policy_loss": 0.03570564888151628, "vf_loss": 10.0, "vf_explained_var": 2.6806510945476552e-05, "kl": 0.0415599800030351, "entropy": 1.168901616807968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8972090632499506, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002755348881086, "policy_loss": -0.0005284791739541105, "vf_loss": 9.987100992600123, "vf_explained_var": -0.0001145302007595698, "kl": 0.009978146206897994, "entropy": 1.2281528539955615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "env_runners": {"episode_reward_max": 22689.311497715502, "episode_reward_min": 266.1071777233142, "episode_reward_mean": 18292.624154667068, "episode_len_mean": 187.34, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 18734, "policy_reward_min": {"agent_policy": 2.1215050155242454, "adversary_policy": 124.68582148600467}, "policy_reward_max": {"agent_policy": 10228.777034376879, "adversary_policy": 9508.78217432008}, "policy_reward_mean": {"agent_policy": 7595.518146293582, "adversary_policy": 5348.553004186758}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3800.4495956388496, 18847.505059711424, 20332.108570990134, 19760.739513145818, 18579.4514628688, 18432.17550056726, 20015.906963693502, 19109.153345583996, 18274.632485847946, 18768.491349064618, 19253.53960638454, 19084.428949649388, 20255.810073387758, 18016.601897633554, 20204.73660077059, 19973.116347790583, 19143.358053512144, 20827.582357430038, 20535.731306355945, 18132.18993825238, 18382.18553697375, 19302.5809607786, 19797.92591619244, 20461.075934617762, 21765.817791581227, 18619.766720218766, 20387.935142624072, 18147.323417899064, 22389.540559615038, 18557.888480938174, 20138.743143288346, 19444.762309451096, 4039.1240522231965, 19627.748962120608, 1114.2869104941951, 19451.615420996386, 21775.459417453738, 18005.23494358165, 22689.311497715502, 19474.301292382388, 18380.05695787037, 19383.309979404115, 20693.13476053435, 18560.74266099709, 19956.79005919198, 19324.578003305433, 19260.223951977263, 20818.528483441052, 19231.921333907077, 19405.85254638597, 19051.852571134972, 18425.891122816, 18179.741429778132, 18516.276562160896, 18677.408871823107, 19154.720160669676, 20880.802538564585, 19502.74707498637, 18527.520066646885, 19535.57310205958, 19129.776489489213, 20738.744790492467, 19447.35495686682, 18249.43137377179, 18316.249462937485, 18768.9274597857, 20574.88022676129, 266.1071777233142, 20478.627366034205, 21033.470761065786, 20073.905925786235, 18552.089515054402, 18702.36259886871, 17952.112642534223, 19356.847455188243, 17723.326953611315, 18960.051375169798, 19309.66912087714, 19051.004610231965, 19128.423143028936, 5667.303033229777, 19397.6366637246, 22217.89009611311, 18891.778798638, 21761.438458930337, 19259.737511320945, 19802.094071924384, 20198.291254529817, 18883.44393314375, 18553.23983935828, 21344.207712223804, 20211.474432894855, 18984.052979696713, 18632.24715395769, 868.4256708145617, 20279.622069185316, 19252.974260165192, 440.64257065145955, 19014.66792528767, 19399.873998557487], "episode_lengths": [29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 4, 200, 200], "policy_agent_policy_reward": [148.692062549653, 8966.89396921668, 7178.633189394184, 7427.183734373816, 9157.890431098433, 9079.59437895124, 7819.978679787412, 8084.770201054667, 9395.112756380408, 9334.553995369906, 8386.513236985174, 8792.262307122994, 7694.868913837005, 9794.325729208991, 6792.234560445988, 7977.474988504345, 8801.876970159188, 6927.050845763118, 7214.069047012028, 9435.414853637716, 9669.491236259535, 8244.880589863977, 7928.5931845657005, 7200.099875598594, 4880.231969380345, 8965.133996822693, 6958.6779965963, 9944.422551568929, 5547.503384972563, 8857.240495166498, 7616.836143298189, 7880.2635277705995, 215.06716904592736, 7726.458580105741, 41.42876419445746, 8001.491335115818, 5933.109425759062, 10228.777034376879, 4619.714878222863, 8180.627731241964, 8483.210055624855, 8499.758721389162, 6853.256992440968, 9328.588127472478, 7977.692027402156, 8536.617550693101, 8121.5121878310965, 7303.155900626167, 7628.884143615632, 8038.351256464206, 9092.773801684063, 9476.168394049866, 9719.608708991826, 9095.633018859666, 8910.46193551345, 8976.807067257516, 6219.550637837802, 8217.878782590129, 8758.94253827171, 8412.18707541713, 8422.821192334824, 6597.84255676613, 8160.3445809434415, 9331.995359216247, 8983.33695118514, 8474.419595462183, 6956.465574485073, 2.1215050155242454, 7404.606255852118, 6829.259355686212, 7647.726109769701, 9217.130416583452, 9218.989903215223, 8173.707900721286, 8443.063025775082, 8599.228562879092, 9056.858593852065, 8708.709166038165, 8644.52251979307, 8713.442174222206, 950.6448232631838, 8418.024397041781, 5813.697782806601, 8639.760344980077, 5973.2518381328155, 8763.659916210647, 7855.748342368119, 7437.13324528045, 8812.106340653738, 9290.277339326363, 6663.7254149141245, 7294.739953757472, 8707.270408534823, 9237.6520020647, 19.77201693054867, 7650.933469383576, 8642.840492402745, 9.110111043365787, 8303.392829907758, 8780.998615746508], "policy_adversary_policy_reward": [1889.3672383640642, 1762.3902947251283, 4707.140134944997, 5173.470955549764, 6954.655029565716, 6198.820352030295, 6430.294829230817, 5903.2609495412435, 4450.489129596685, 4971.071902173731, 4298.303126538971, 5054.27799507715, 6311.664883343069, 5884.263400563001, 4977.8593935926565, 6046.523750936676, 4167.169804145704, 4712.349925321922, 4803.126451443574, 4630.810902251209, 5173.149697803053, 5693.876671596466, 5345.793833619916, 4946.372808906642, 6267.190646318824, 6293.75051323199, 4343.8872869825, 3878.3888814421193, 7321.050516242843, 6091.451524081735, 5835.970130366651, 6159.67122891961, 5007.104236246979, 5334.37684710613, 6963.701115511924, 6936.830396154925, 6770.39324204356, 6551.269017300383, 4697.288522138555, 3999.486562476195, 4467.691271384254, 4245.003029330089, 5357.519556801125, 5700.180814113552, 5659.893056573921, 6209.439675052796, 6799.813463161888, 6461.162595857342, 9261.745662731102, 7623.840159469768, 4507.89727449624, 5146.7354488999035, 7163.312826916737, 6265.94431911105, 4184.738640188531, 4018.1622261416937, 8252.30945620249, 8589.727718439826, 4427.998526478978, 5272.649459292753, 6415.556902649539, 6106.350097340643, 5592.690244995658, 5971.808536684869, 2113.498456178962, 1710.558426998308, 6345.1875422325875, 5556.10283978232, 594.9673388734353, 477.89080742630233, 5541.08032619099, 5909.043759689618, 7653.264895059187, 8189.085096635437, 3888.3223895331917, 3888.1355196716513, 9508.78217432008, 8560.814445172473, 5373.639765311524, 5920.033795828944, 5645.116431111249, 4251.730471134344, 5494.231619777527, 5389.31963823748, 6592.286374564549, 7247.591393528718, 4432.042313810346, 4800.112219714365, 5918.9961062949715, 6060.101925494853, 5561.67059935418, 5226.289853258175, 5176.807194430082, 5961.904569716146, 6749.117485753179, 6766.255097061693, 5113.017991488368, 6490.019198803064, 5289.283069609941, 6078.2182203118955, 4923.222834811959, 5035.855934638978, 4622.3205232636155, 4327.4022055025835, 4420.136917798683, 4039.9958029877316, 5035.669125118417, 4384.974418182909, 4823.62272839993, 4943.324207909738, 5021.711888458992, 5156.201204953226, 7915.264734574668, 6745.987166152049, 5397.05260803152, 5887.815684364715, 4424.436356219477, 5344.141172155749, 5510.812147156311, 5612.573879486184, 4992.475967058441, 5714.479330096007, 7541.77392099929, 6599.128312726993, 5409.018968287969, 5877.9914076354535, 4176.774840170948, 4740.661174384566, 4198.771217629347, 5134.14129412308, 5616.184401391264, 4678.3234629323015, 7138.381293577237, 6480.03335869893, 124.68582148600467, 139.29985122178527, 6345.15545780671, 6728.86565237543, 6897.306553839719, 7306.90485153975, 5935.018585287366, 6491.161230729187, 4921.862750489981, 4413.096347981055, 4719.412380478605, 4763.960315174945, 3924.4965060432237, 5853.908235769728, 5698.563946912402, 5215.220482500797, 5521.058873533425, 3603.0395171987907, 4870.060410746975, 5033.132370570803, 5412.282007921053, 5188.677946917989, 5464.674014394698, 4941.808076044215, 5372.8143041719595, 5042.166664634825, 2294.669573267319, 2421.9886366992705, 5469.992289789681, 5509.619976893099, 8126.939621056727, 8277.252692249729, 4848.559464165784, 5403.458989492161, 7946.203998493017, 7841.9826223044865, 5234.758320342391, 5261.319274767918, 5666.117534265845, 6280.228195290459, 6172.463504888225, 6588.694504361112, 4753.02664711587, 5318.310945374154, 4842.6660204049485, 4420.296479626968, 7209.646941886454, 7470.835355423159, 6647.451849169023, 6269.282629968344, 4842.9410610220175, 5433.841510139877, 4777.037351327915, 4617.557800565138, 373.45092398397844, 475.20272990003457, 6470.008811269677, 6158.679788532161, 5464.168471486142, 5145.965296276321, 273.7326014312532, 157.79985817684053, 4884.576467960038, 5826.698627419957, 5310.48003440709, 5308.395348403957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3982978676904272, "mean_inference_ms": 0.9898320296655847, "mean_action_processing_ms": 0.16740843598808944, "mean_env_wait_ms": 0.05407673695679234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003911375999450684, "StateBufferConnector_ms": 0.0026674270629882812, "ViewRequirementAgentConnector_ms": 0.06873059272766113}, "num_episodes": 21, "episode_return_max": 22689.311497715502, "episode_return_min": 266.1071777233142, "episode_return_mean": 18292.624154667068}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 558.1033976605999, "num_env_steps_trained_throughput_per_sec": 558.1033976605999, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 7290.924, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7290.888, "sample_time_ms": 804.485, "learn_time_ms": 6475.212, "learn_throughput": 617.74, "synch_weights_time_ms": 10.776}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "training_iteration": 133, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-35", "timestamp": 1723236395, "time_this_iter_s": 7.172982931137085, "time_total_s": 1011.465657711029, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1011.465657711029, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.16, "ram_util_percent": 82.28999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4078493536.4232802, "cur_kl_coeff": 22362066402.506546, "cur_lr": 5.0000000000000016e-05, "total_loss": 630916223.4497354, "policy_loss": 0.020842760916868295, "vf_loss": 10.0, "vf_explained_var": 5.590641309344579e-05, "kl": 0.028213680987665184, "entropy": 1.1826086691447666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.885208108369261, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.006989825765292, "policy_loss": 0.002490595092725319, "vf_loss": 9.990376432736715, "vf_explained_var": -0.00018303915858268737, "kl": 0.008707957598865808, "entropy": 1.220245745529731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": 23904.911528616234, "episode_reward_min": 131.62485146935234, "episode_reward_mean": 18179.769476808506, "episode_len_mean": 185.31, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18531, "policy_reward_min": {"agent_policy": 0.7947886639142173, "adversary_policy": 60.914173350697595}, "policy_reward_max": {"agent_policy": 10228.777034376879, "adversary_policy": 10798.828172084508}, "policy_reward_mean": {"agent_policy": 7416.689261963448, "adversary_policy": 5381.540107422538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19797.92591619244, 20461.075934617762, 21765.817791581227, 18619.766720218766, 20387.935142624072, 18147.323417899064, 22389.540559615038, 18557.888480938174, 20138.743143288346, 19444.762309451096, 4039.1240522231965, 19627.748962120608, 1114.2869104941951, 19451.615420996386, 21775.459417453738, 18005.23494358165, 22689.311497715502, 19474.301292382388, 18380.05695787037, 19383.309979404115, 20693.13476053435, 18560.74266099709, 19956.79005919198, 19324.578003305433, 19260.223951977263, 20818.528483441052, 19231.921333907077, 19405.85254638597, 19051.852571134972, 18425.891122816, 18179.741429778132, 18516.276562160896, 18677.408871823107, 19154.720160669676, 20880.802538564585, 19502.74707498637, 18527.520066646885, 19535.57310205958, 19129.776489489213, 20738.744790492467, 19447.35495686682, 18249.43137377179, 18316.249462937485, 18768.9274597857, 20574.88022676129, 266.1071777233142, 20478.627366034205, 21033.470761065786, 20073.905925786235, 18552.089515054402, 18702.36259886871, 17952.112642534223, 19356.847455188243, 17723.326953611315, 18960.051375169798, 19309.66912087714, 19051.004610231965, 19128.423143028936, 5667.303033229777, 19397.6366637246, 22217.89009611311, 18891.778798638, 21761.438458930337, 19259.737511320945, 19802.094071924384, 20198.291254529817, 18883.44393314375, 18553.23983935828, 21344.207712223804, 20211.474432894855, 18984.052979696713, 18632.24715395769, 868.4256708145617, 20279.622069185316, 19252.974260165192, 440.64257065145955, 19014.66792528767, 19399.873998557487, 18774.632891611585, 18763.10879139417, 131.62485146935234, 20589.182300784443, 19368.798296741385, 20879.5573938145, 20136.916237962898, 21563.265483262214, 20345.797878855377, 18340.99595286693, 18060.397622911663, 18296.053656124393, 2918.366840390722, 21623.73803046046, 18644.420063255777, 23904.911528616234, 18445.893907513684, 19076.049601924457, 19220.992945484668, 19409.91789346867, 18217.61760919638, 21034.76791206508], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 4, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7928.5931845657005, 7200.099875598594, 4880.231969380345, 8965.133996822693, 6958.6779965963, 9944.422551568929, 5547.503384972563, 8857.240495166498, 7616.836143298189, 7880.2635277705995, 215.06716904592736, 7726.458580105741, 41.42876419445746, 8001.491335115818, 5933.109425759062, 10228.777034376879, 4619.714878222863, 8180.627731241964, 8483.210055624855, 8499.758721389162, 6853.256992440968, 9328.588127472478, 7977.692027402156, 8536.617550693101, 8121.5121878310965, 7303.155900626167, 7628.884143615632, 8038.351256464206, 9092.773801684063, 9476.168394049866, 9719.608708991826, 9095.633018859666, 8910.46193551345, 8976.807067257516, 6219.550637837802, 8217.878782590129, 8758.94253827171, 8412.18707541713, 8422.821192334824, 6597.84255676613, 8160.3445809434415, 9331.995359216247, 8983.33695118514, 8474.419595462183, 6956.465574485073, 2.1215050155242454, 7404.606255852118, 6829.259355686212, 7647.726109769701, 9217.130416583452, 9218.989903215223, 8173.707900721286, 8443.063025775082, 8599.228562879092, 9056.858593852065, 8708.709166038165, 8644.52251979307, 8713.442174222206, 950.6448232631838, 8418.024397041781, 5813.697782806601, 8639.760344980077, 5973.2518381328155, 8763.659916210647, 7855.748342368119, 7437.13324528045, 8812.106340653738, 9290.277339326363, 6663.7254149141245, 7294.739953757472, 8707.270408534823, 9237.6520020647, 19.77201693054867, 7650.933469383576, 8642.840492402745, 9.110111043365787, 8303.392829907758, 8780.998615746508, 8218.190346561956, 9107.974382550752, 0.7947886639142173, 6782.400513716129, 8274.66813639556, 6679.084369130513, 7373.498159898216, 6351.182903776785, 6608.9514834291995, 9878.645269705195, 9587.759525087624, 9264.418577190558, 233.01343834931322, 6193.1959463481835, 8168.58786195808, 3342.2134016575615, 9302.68959227737, 9033.51068114395, 8713.745744152207, 8688.101627589584, 9829.527040597197, 6808.72445378322], "policy_adversary_policy_reward": [5659.893056573921, 6209.439675052796, 6799.813463161888, 6461.162595857342, 9261.745662731102, 7623.840159469768, 4507.89727449624, 5146.7354488999035, 7163.312826916737, 6265.94431911105, 4184.738640188531, 4018.1622261416937, 8252.30945620249, 8589.727718439826, 4427.998526478978, 5272.649459292753, 6415.556902649539, 6106.350097340643, 5592.690244995658, 5971.808536684869, 2113.498456178962, 1710.558426998308, 6345.1875422325875, 5556.10283978232, 594.9673388734353, 477.89080742630233, 5541.08032619099, 5909.043759689618, 7653.264895059187, 8189.085096635437, 3888.3223895331917, 3888.1355196716513, 9508.78217432008, 8560.814445172473, 5373.639765311524, 5920.033795828944, 5645.116431111249, 4251.730471134344, 5494.231619777527, 5389.31963823748, 6592.286374564549, 7247.591393528718, 4432.042313810346, 4800.112219714365, 5918.9961062949715, 6060.101925494853, 5561.67059935418, 5226.289853258175, 5176.807194430082, 5961.904569716146, 6749.117485753179, 6766.255097061693, 5113.017991488368, 6490.019198803064, 5289.283069609941, 6078.2182203118955, 4923.222834811959, 5035.855934638978, 4622.3205232636155, 4327.4022055025835, 4420.136917798683, 4039.9958029877316, 5035.669125118417, 4384.974418182909, 4823.62272839993, 4943.324207909738, 5021.711888458992, 5156.201204953226, 7915.264734574668, 6745.987166152049, 5397.05260803152, 5887.815684364715, 4424.436356219477, 5344.141172155749, 5510.812147156311, 5612.573879486184, 4992.475967058441, 5714.479330096007, 7541.77392099929, 6599.128312726993, 5409.018968287969, 5877.9914076354535, 4176.774840170948, 4740.661174384566, 4198.771217629347, 5134.14129412308, 5616.184401391264, 4678.3234629323015, 7138.381293577237, 6480.03335869893, 124.68582148600467, 139.29985122178527, 6345.15545780671, 6728.86565237543, 6897.306553839719, 7306.90485153975, 5935.018585287366, 6491.161230729187, 4921.862750489981, 4413.096347981055, 4719.412380478605, 4763.960315174945, 3924.4965060432237, 5853.908235769728, 5698.563946912402, 5215.220482500797, 5521.058873533425, 3603.0395171987907, 4870.060410746975, 5033.132370570803, 5412.282007921053, 5188.677946917989, 5464.674014394698, 4941.808076044215, 5372.8143041719595, 5042.166664634825, 2294.669573267319, 2421.9886366992705, 5469.992289789681, 5509.619976893099, 8126.939621056727, 8277.252692249729, 4848.559464165784, 5403.458989492161, 7946.203998493017, 7841.9826223044865, 5234.758320342391, 5261.319274767918, 5666.117534265845, 6280.228195290459, 6172.463504888225, 6588.694504361112, 4753.02664711587, 5318.310945374154, 4842.6660204049485, 4420.296479626968, 7209.646941886454, 7470.835355423159, 6647.451849169023, 6269.282629968344, 4842.9410610220175, 5433.841510139877, 4777.037351327915, 4617.557800565138, 373.45092398397844, 475.20272990003457, 6470.008811269677, 6158.679788532161, 5464.168471486142, 5145.965296276321, 273.7326014312532, 157.79985817684053, 4884.576467960038, 5826.698627419957, 5310.48003440709, 5308.395348403957, 5683.44162116552, 4873.000923884134, 4639.044866801535, 5016.089542041931, 60.914173350697595, 69.91588945474054, 6962.636531499588, 6844.145255568753, 5780.314808284106, 5313.815352061711, 7311.182826585002, 6889.290198098985, 6310.333468319664, 6453.084609745002, 7681.568304111159, 7530.514275374277, 7531.161219667133, 6205.685175759041, 4212.541580565634, 4249.8091025962185, 3925.350906439408, 4547.287191384702, 4834.089957144644, 4197.545121789224, 1452.695582555607, 1232.6578194858007, 7896.907738591703, 7533.634345520542, 4507.596344818781, 5968.235856478881, 9763.869954874166, 10798.828172084508, 4665.81157492081, 4477.392740315556, 5071.456592147027, 4971.082328633543, 5422.345101678081, 5084.902099654415, 5388.120959586598, 5333.695306292572, 4114.65007729672, 4273.4404913025055, 7300.432585866414, 6925.61087241545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39857587231644687, "mean_inference_ms": 0.9905524937907544, "mean_action_processing_ms": 0.16755723939166992, "mean_env_wait_ms": 0.05414467784639468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004082679748535156, "StateBufferConnector_ms": 0.0027625560760498047, "ViewRequirementAgentConnector_ms": 0.07092428207397461}, "num_episodes": 22, "episode_return_max": 23904.911528616234, "episode_return_min": 131.62485146935234, "episode_return_mean": 18179.769476808506}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.7705559715134, "num_env_steps_trained_throughput_per_sec": 546.7705559715134, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 7288.492, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7288.456, "sample_time_ms": 798.982, "learn_time_ms": 6478.169, "learn_throughput": 617.458, "synch_weights_time_ms": 10.892}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 134, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-42", "timestamp": 1723236402, "time_this_iter_s": 7.321011066436768, "time_total_s": 1018.7866687774658, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1018.7866687774658, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 25.42, "ram_util_percent": 82.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6298043988.723809, "cur_kl_coeff": 33543099603.759823, "cur_lr": 5.0000000000000016e-05, "total_loss": 1074362919.0603175, "policy_loss": 0.022924207011730504, "vf_loss": 10.0, "vf_explained_var": 9.342624396874161e-05, "kl": 0.032029326636068244, "entropy": 1.1929010530628223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8590424550386767, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001030611991883, "policy_loss": -0.0026405398559290914, "vf_loss": 9.995430113871892, "vf_explained_var": -0.00030119617780049643, "kl": 0.005081315005615276, "entropy": 1.2128215505431095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "env_runners": {"episode_reward_max": 23904.911528616234, "episode_reward_min": 131.62485146935234, "episode_reward_mean": 18467.136405788624, "episode_len_mean": 188.88, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18888, "policy_reward_min": {"agent_policy": 0.7947886639142173, "adversary_policy": 60.914173350697595}, "policy_reward_max": {"agent_policy": 9878.645269705195, "adversary_policy": 10798.828172084508}, "policy_reward_mean": {"agent_policy": 7643.142560321493, "adversary_policy": 5411.996922733573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19956.79005919198, 19324.578003305433, 19260.223951977263, 20818.528483441052, 19231.921333907077, 19405.85254638597, 19051.852571134972, 18425.891122816, 18179.741429778132, 18516.276562160896, 18677.408871823107, 19154.720160669676, 20880.802538564585, 19502.74707498637, 18527.520066646885, 19535.57310205958, 19129.776489489213, 20738.744790492467, 19447.35495686682, 18249.43137377179, 18316.249462937485, 18768.9274597857, 20574.88022676129, 266.1071777233142, 20478.627366034205, 21033.470761065786, 20073.905925786235, 18552.089515054402, 18702.36259886871, 17952.112642534223, 19356.847455188243, 17723.326953611315, 18960.051375169798, 19309.66912087714, 19051.004610231965, 19128.423143028936, 5667.303033229777, 19397.6366637246, 22217.89009611311, 18891.778798638, 21761.438458930337, 19259.737511320945, 19802.094071924384, 20198.291254529817, 18883.44393314375, 18553.23983935828, 21344.207712223804, 20211.474432894855, 18984.052979696713, 18632.24715395769, 868.4256708145617, 20279.622069185316, 19252.974260165192, 440.64257065145955, 19014.66792528767, 19399.873998557487, 18774.632891611585, 18763.10879139417, 131.62485146935234, 20589.182300784443, 19368.798296741385, 20879.5573938145, 20136.916237962898, 21563.265483262214, 20345.797878855377, 18340.99595286693, 18060.397622911663, 18296.053656124393, 2918.366840390722, 21623.73803046046, 18644.420063255777, 23904.911528616234, 18445.893907513684, 19076.049601924457, 19220.992945484668, 19409.91789346867, 18217.61760919638, 21034.76791206508, 21704.462504965046, 18601.99730303062, 19697.190813653102, 23286.399717334374, 19312.972232067554, 19307.60371999654, 19284.543023158298, 18866.426253717156, 18533.17120507002, 18574.045373818848, 19016.693045850363, 18526.742626034335, 18638.484057030368, 19576.912669075897, 18939.205870973652, 21757.89332790087, 18469.951963417345, 20439.23116825473, 18832.924987079714, 22220.35047965867, 19213.700736368493, 18840.896091755134], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 4, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7977.692027402156, 8536.617550693101, 8121.5121878310965, 7303.155900626167, 7628.884143615632, 8038.351256464206, 9092.773801684063, 9476.168394049866, 9719.608708991826, 9095.633018859666, 8910.46193551345, 8976.807067257516, 6219.550637837802, 8217.878782590129, 8758.94253827171, 8412.18707541713, 8422.821192334824, 6597.84255676613, 8160.3445809434415, 9331.995359216247, 8983.33695118514, 8474.419595462183, 6956.465574485073, 2.1215050155242454, 7404.606255852118, 6829.259355686212, 7647.726109769701, 9217.130416583452, 9218.989903215223, 8173.707900721286, 8443.063025775082, 8599.228562879092, 9056.858593852065, 8708.709166038165, 8644.52251979307, 8713.442174222206, 950.6448232631838, 8418.024397041781, 5813.697782806601, 8639.760344980077, 5973.2518381328155, 8763.659916210647, 7855.748342368119, 7437.13324528045, 8812.106340653738, 9290.277339326363, 6663.7254149141245, 7294.739953757472, 8707.270408534823, 9237.6520020647, 19.77201693054867, 7650.933469383576, 8642.840492402745, 9.110111043365787, 8303.392829907758, 8780.998615746508, 8218.190346561956, 9107.974382550752, 0.7947886639142173, 6782.400513716129, 8274.66813639556, 6679.084369130513, 7373.498159898216, 6351.182903776785, 6608.9514834291995, 9878.645269705195, 9587.759525087624, 9264.418577190558, 233.01343834931322, 6193.1959463481835, 8168.58786195808, 3342.2134016575615, 9302.68959227737, 9033.51068114395, 8713.745744152207, 8688.101627589584, 9829.527040597197, 6808.72445378322, 5873.674159136803, 8631.606553827356, 7970.420580886408, 4241.158844445011, 8553.005696288385, 8590.276816250416, 8273.705244646873, 8827.252648392116, 9475.96522135034, 9100.827579287887, 8752.585652550182, 8962.65235757521, 9390.961866245822, 8236.386079947777, 9067.410535304112, 4576.198539937029, 8602.921410008656, 7243.079493916074, 8746.213142297807, 5710.399921540615, 8513.988635301386, 9195.130797398906], "policy_adversary_policy_reward": [5918.9961062949715, 6060.101925494853, 5561.67059935418, 5226.289853258175, 5176.807194430082, 5961.904569716146, 6749.117485753179, 6766.255097061693, 5113.017991488368, 6490.019198803064, 5289.283069609941, 6078.2182203118955, 4923.222834811959, 5035.855934638978, 4622.3205232636155, 4327.4022055025835, 4420.136917798683, 4039.9958029877316, 5035.669125118417, 4384.974418182909, 4823.62272839993, 4943.324207909738, 5021.711888458992, 5156.201204953226, 7915.264734574668, 6745.987166152049, 5397.05260803152, 5887.815684364715, 4424.436356219477, 5344.141172155749, 5510.812147156311, 5612.573879486184, 4992.475967058441, 5714.479330096007, 7541.77392099929, 6599.128312726993, 5409.018968287969, 5877.9914076354535, 4176.774840170948, 4740.661174384566, 4198.771217629347, 5134.14129412308, 5616.184401391264, 4678.3234629323015, 7138.381293577237, 6480.03335869893, 124.68582148600467, 139.29985122178527, 6345.15545780671, 6728.86565237543, 6897.306553839719, 7306.90485153975, 5935.018585287366, 6491.161230729187, 4921.862750489981, 4413.096347981055, 4719.412380478605, 4763.960315174945, 3924.4965060432237, 5853.908235769728, 5698.563946912402, 5215.220482500797, 5521.058873533425, 3603.0395171987907, 4870.060410746975, 5033.132370570803, 5412.282007921053, 5188.677946917989, 5464.674014394698, 4941.808076044215, 5372.8143041719595, 5042.166664634825, 2294.669573267319, 2421.9886366992705, 5469.992289789681, 5509.619976893099, 8126.939621056727, 8277.252692249729, 4848.559464165784, 5403.458989492161, 7946.203998493017, 7841.9826223044865, 5234.758320342391, 5261.319274767918, 5666.117534265845, 6280.228195290459, 6172.463504888225, 6588.694504361112, 4753.02664711587, 5318.310945374154, 4842.6660204049485, 4420.296479626968, 7209.646941886454, 7470.835355423159, 6647.451849169023, 6269.282629968344, 4842.9410610220175, 5433.841510139877, 4777.037351327915, 4617.557800565138, 373.45092398397844, 475.20272990003457, 6470.008811269677, 6158.679788532161, 5464.168471486142, 5145.965296276321, 273.7326014312532, 157.79985817684053, 4884.576467960038, 5826.698627419957, 5310.48003440709, 5308.395348403957, 5683.44162116552, 4873.000923884134, 4639.044866801535, 5016.089542041931, 60.914173350697595, 69.91588945474054, 6962.636531499588, 6844.145255568753, 5780.314808284106, 5313.815352061711, 7311.182826585002, 6889.290198098985, 6310.333468319664, 6453.084609745002, 7681.568304111159, 7530.514275374277, 7531.161219667133, 6205.685175759041, 4212.541580565634, 4249.8091025962185, 3925.350906439408, 4547.287191384702, 4834.089957144644, 4197.545121789224, 1452.695582555607, 1232.6578194858007, 7896.907738591703, 7533.634345520542, 4507.596344818781, 5968.235856478881, 9763.869954874166, 10798.828172084508, 4665.81157492081, 4477.392740315556, 5071.456592147027, 4971.082328633543, 5422.345101678081, 5084.902099654415, 5388.120959586598, 5333.695306292572, 4114.65007729672, 4273.4404913025055, 7300.432585866414, 6925.61087241545, 7796.740228596049, 8034.048117232126, 5191.869857512435, 4778.520891690862, 5986.540025675607, 5740.230207091084, 9429.616844375463, 9615.624028513805, 5548.324349799793, 5211.642185979481, 5543.240385814039, 5174.0865179320235, 5146.798771592293, 5864.039006919139, 4828.482426970974, 5210.691178354146, 4551.176534300381, 4506.029449419255, 4572.383007189692, 4900.834787341326, 4906.42675976013, 5357.680633540078, 5082.127888558421, 4481.96237990073, 4538.680538612336, 4708.841652172271, 5770.7448704161325, 5569.781718712007, 4984.199087854244, 4887.596247815321, 7651.166160732682, 9530.528627231231, 5460.146971836341, 4406.883581572451, 6766.702312499225, 6429.449361839425, 5185.885425479649, 4900.82641930232, 8415.711080873652, 8094.239477244386, 5558.330253758828, 5141.381847308242, 4759.485984817155, 4886.279309539115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39867348555701354, "mean_inference_ms": 0.9909328832789822, "mean_action_processing_ms": 0.1675763085110872, "mean_env_wait_ms": 0.05417553158293924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003945589065551758, "StateBufferConnector_ms": 0.002833843231201172, "ViewRequirementAgentConnector_ms": 0.06977975368499756}, "num_episodes": 22, "episode_return_max": 23904.911528616234, "episode_return_min": 131.62485146935234, "episode_return_mean": 18467.136405788624}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 566.1172539701848, "num_env_steps_trained_throughput_per_sec": 566.1172539701848, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1620000, "timers": {"training_iteration_time_ms": 7264.75, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7264.714, "sample_time_ms": 805.315, "learn_time_ms": 6447.935, "learn_throughput": 620.354, "synch_weights_time_ms": 11.007}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "done": false, "training_iteration": 135, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-49", "timestamp": 1723236409, "time_this_iter_s": 7.069403886795044, "time_total_s": 1025.8560726642609, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b25f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1025.8560726642609, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 24.663636363636364, "ram_util_percent": 82.10909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11407697471.796825, "cur_kl_coeff": 50314649405.63975, "cur_lr": 5.0000000000000016e-05, "total_loss": 2107160944.7280424, "policy_loss": 0.037534797612439705, "vf_loss": 10.0, "vf_explained_var": 7.443989395464539e-06, "kl": 0.04187967046188614, "entropy": 1.194074008767567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8419370736305912, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003181911508243, "policy_loss": -0.0017315502685960383, "vf_loss": 9.99447482128938, "vf_explained_var": -0.00032783163090546925, "kl": 0.006436349727785758, "entropy": 1.1787725711862247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 23904.911528616234, "episode_reward_min": 131.62485146935234, "episode_reward_mean": 18325.259576627428, "episode_len_mean": 186.91, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18691, "policy_reward_min": {"agent_policy": 0.7947886639142173, "adversary_policy": 60.914173350697595}, "policy_reward_max": {"agent_policy": 9878.645269705195, "adversary_policy": 10798.828172084508}, "policy_reward_mean": {"agent_policy": 7505.449918499924, "adversary_policy": 5409.904829063762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18316.249462937485, 18768.9274597857, 20574.88022676129, 266.1071777233142, 20478.627366034205, 21033.470761065786, 20073.905925786235, 18552.089515054402, 18702.36259886871, 17952.112642534223, 19356.847455188243, 17723.326953611315, 18960.051375169798, 19309.66912087714, 19051.004610231965, 19128.423143028936, 5667.303033229777, 19397.6366637246, 22217.89009611311, 18891.778798638, 21761.438458930337, 19259.737511320945, 19802.094071924384, 20198.291254529817, 18883.44393314375, 18553.23983935828, 21344.207712223804, 20211.474432894855, 18984.052979696713, 18632.24715395769, 868.4256708145617, 20279.622069185316, 19252.974260165192, 440.64257065145955, 19014.66792528767, 19399.873998557487, 18774.632891611585, 18763.10879139417, 131.62485146935234, 20589.182300784443, 19368.798296741385, 20879.5573938145, 20136.916237962898, 21563.265483262214, 20345.797878855377, 18340.99595286693, 18060.397622911663, 18296.053656124393, 2918.366840390722, 21623.73803046046, 18644.420063255777, 23904.911528616234, 18445.893907513684, 19076.049601924457, 19220.992945484668, 19409.91789346867, 18217.61760919638, 21034.76791206508, 21704.462504965046, 18601.99730303062, 19697.190813653102, 23286.399717334374, 19312.972232067554, 19307.60371999654, 19284.543023158298, 18866.426253717156, 18533.17120507002, 18574.045373818848, 19016.693045850363, 18526.742626034335, 18638.484057030368, 19576.912669075897, 18939.205870973652, 21757.89332790087, 18469.951963417345, 20439.23116825473, 18832.924987079714, 22220.35047965867, 19213.700736368493, 18840.896091755134, 18197.995430527768, 18704.996961962403, 371.7054343559287, 18441.79397842298, 22307.28235326369, 18882.986800896248, 19985.71758615067, 21192.842777757938, 18123.587245346236, 21724.622565552094, 21162.763506905238, 19314.40489212363, 19700.025437503584, 18762.89026466104, 18155.35774402212, 18702.20269668429, 18273.31446466109, 18839.95826280883, 22859.384426361656, 18124.219743382608], "episode_lengths": [200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 49, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 4, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8983.33695118514, 8474.419595462183, 6956.465574485073, 2.1215050155242454, 7404.606255852118, 6829.259355686212, 7647.726109769701, 9217.130416583452, 9218.989903215223, 8173.707900721286, 8443.063025775082, 8599.228562879092, 9056.858593852065, 8708.709166038165, 8644.52251979307, 8713.442174222206, 950.6448232631838, 8418.024397041781, 5813.697782806601, 8639.760344980077, 5973.2518381328155, 8763.659916210647, 7855.748342368119, 7437.13324528045, 8812.106340653738, 9290.277339326363, 6663.7254149141245, 7294.739953757472, 8707.270408534823, 9237.6520020647, 19.77201693054867, 7650.933469383576, 8642.840492402745, 9.110111043365787, 8303.392829907758, 8780.998615746508, 8218.190346561956, 9107.974382550752, 0.7947886639142173, 6782.400513716129, 8274.66813639556, 6679.084369130513, 7373.498159898216, 6351.182903776785, 6608.9514834291995, 9878.645269705195, 9587.759525087624, 9264.418577190558, 233.01343834931322, 6193.1959463481835, 8168.58786195808, 3342.2134016575615, 9302.68959227737, 9033.51068114395, 8713.745744152207, 8688.101627589584, 9829.527040597197, 6808.72445378322, 5873.674159136803, 8631.606553827356, 7970.420580886408, 4241.158844445011, 8553.005696288385, 8590.276816250416, 8273.705244646873, 8827.252648392116, 9475.96522135034, 9100.827579287887, 8752.585652550182, 8962.65235757521, 9390.961866245822, 8236.386079947777, 9067.410535304112, 4576.198539937029, 8602.921410008656, 7243.079493916074, 8746.213142297807, 5710.399921540615, 8513.988635301386, 9195.130797398906, 9746.716430126206, 8895.214235161635, 3.6037043838011327, 9767.32586921838, 4741.127774672555, 9041.354933976374, 7582.591211210896, 6256.287975316062, 8670.291020781522, 5347.293944581698, 6514.311093850204, 8376.462367317432, 8075.654156586003, 8940.480807044572, 9819.8726720792, 9207.698106573258, 8738.978649368146, 8970.06306508534, 5119.886350095982, 9414.750166779932], "policy_adversary_policy_reward": [4198.771217629347, 5134.14129412308, 5616.184401391264, 4678.3234629323015, 7138.381293577237, 6480.03335869893, 124.68582148600467, 139.29985122178527, 6345.15545780671, 6728.86565237543, 6897.306553839719, 7306.90485153975, 5935.018585287366, 6491.161230729187, 4921.862750489981, 4413.096347981055, 4719.412380478605, 4763.960315174945, 3924.4965060432237, 5853.908235769728, 5698.563946912402, 5215.220482500797, 5521.058873533425, 3603.0395171987907, 4870.060410746975, 5033.132370570803, 5412.282007921053, 5188.677946917989, 5464.674014394698, 4941.808076044215, 5372.8143041719595, 5042.166664634825, 2294.669573267319, 2421.9886366992705, 5469.992289789681, 5509.619976893099, 8126.939621056727, 8277.252692249729, 4848.559464165784, 5403.458989492161, 7946.203998493017, 7841.9826223044865, 5234.758320342391, 5261.319274767918, 5666.117534265845, 6280.228195290459, 6172.463504888225, 6588.694504361112, 4753.02664711587, 5318.310945374154, 4842.6660204049485, 4420.296479626968, 7209.646941886454, 7470.835355423159, 6647.451849169023, 6269.282629968344, 4842.9410610220175, 5433.841510139877, 4777.037351327915, 4617.557800565138, 373.45092398397844, 475.20272990003457, 6470.008811269677, 6158.679788532161, 5464.168471486142, 5145.965296276321, 273.7326014312532, 157.79985817684053, 4884.576467960038, 5826.698627419957, 5310.48003440709, 5308.395348403957, 5683.44162116552, 4873.000923884134, 4639.044866801535, 5016.089542041931, 60.914173350697595, 69.91588945474054, 6962.636531499588, 6844.145255568753, 5780.314808284106, 5313.815352061711, 7311.182826585002, 6889.290198098985, 6310.333468319664, 6453.084609745002, 7681.568304111159, 7530.514275374277, 7531.161219667133, 6205.685175759041, 4212.541580565634, 4249.8091025962185, 3925.350906439408, 4547.287191384702, 4834.089957144644, 4197.545121789224, 1452.695582555607, 1232.6578194858007, 7896.907738591703, 7533.634345520542, 4507.596344818781, 5968.235856478881, 9763.869954874166, 10798.828172084508, 4665.81157492081, 4477.392740315556, 5071.456592147027, 4971.082328633543, 5422.345101678081, 5084.902099654415, 5388.120959586598, 5333.695306292572, 4114.65007729672, 4273.4404913025055, 7300.432585866414, 6925.61087241545, 7796.740228596049, 8034.048117232126, 5191.869857512435, 4778.520891690862, 5986.540025675607, 5740.230207091084, 9429.616844375463, 9615.624028513805, 5548.324349799793, 5211.642185979481, 5543.240385814039, 5174.0865179320235, 5146.798771592293, 5864.039006919139, 4828.482426970974, 5210.691178354146, 4551.176534300381, 4506.029449419255, 4572.383007189692, 4900.834787341326, 4906.42675976013, 5357.680633540078, 5082.127888558421, 4481.96237990073, 4538.680538612336, 4708.841652172271, 5770.7448704161325, 5569.781718712007, 4984.199087854244, 4887.596247815321, 7651.166160732682, 9530.528627231231, 5460.146971836341, 4406.883581572451, 6766.702312499225, 6429.449361839425, 5185.885425479649, 4900.82641930232, 8415.711080873652, 8094.239477244386, 5558.330253758828, 5141.381847308242, 4759.485984817155, 4886.279309539115, 4057.249859841966, 4394.029140559707, 5114.3859758603185, 4695.396750940472, 208.52832997216314, 159.57339999996438, 4332.126307690487, 4342.341801514232, 8165.146729532623, 9401.007849058402, 5016.715952584447, 4824.915914335443, 6421.670146554569, 5981.45622838529, 7885.847648414896, 7050.707154026954, 5468.508946663899, 3984.787277900925, 8081.1221917529, 8296.206429217535, 7198.7425881454665, 7449.709824909611, 5755.425276240845, 5182.517248565337, 5704.057379557491, 5920.313901360093, 5102.788552132171, 4719.620905484357, 4026.359721367827, 4309.125350575154, 4560.067072953386, 4934.437517157705, 5352.282769245455, 4182.053046047462, 4862.027204167921, 5007.867993555577, 8790.493761731987, 8949.00431453371, 3989.346395104598, 4720.1231814982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39860885297972176, "mean_inference_ms": 0.9908010382847274, "mean_action_processing_ms": 0.16764415260788731, "mean_env_wait_ms": 0.05415628365008823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036710500717163086, "StateBufferConnector_ms": 0.002695441246032715, "ViewRequirementAgentConnector_ms": 0.06531190872192383}, "num_episodes": 20, "episode_return_max": 23904.911528616234, "episode_return_min": 131.62485146935234, "episode_return_mean": 18325.259576627428}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.7402653284291, "num_env_steps_trained_throughput_per_sec": 545.7402653284291, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 7281.2, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7281.164, "sample_time_ms": 812.02, "learn_time_ms": 6457.738, "learn_throughput": 619.412, "synch_weights_time_ms": 10.953}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 136, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-46-57", "timestamp": 1723236417, "time_this_iter_s": 7.33378005027771, "time_total_s": 1033.1898527145386, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1033.1898527145386, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 26.339999999999996, "ram_util_percent": 81.73}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15805437213.663492, "cur_kl_coeff": 75471974108.45961, "cur_lr": 5.0000000000000016e-05, "total_loss": 3024294267.1238093, "policy_loss": 0.03344744766924392, "vf_loss": 10.0, "vf_explained_var": -5.794205362834628e-05, "kl": 0.04007175455717419, "entropy": 1.2038098501149939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8561229619507988, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.015428468585014, "policy_loss": 0.0012083082658743175, "vf_loss": 10.0, "vf_explained_var": -0.000307924672961235, "kl": 0.008767989440336047, "entropy": 1.1285944246997437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "env_runners": {"episode_reward_max": 24885.563841696843, "episode_reward_min": 131.62485146935234, "episode_reward_mean": 18908.16325092717, "episode_len_mean": 190.4, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19040, "policy_reward_min": {"agent_policy": 0.7947886639142173, "adversary_policy": 60.914173350697595}, "policy_reward_max": {"agent_policy": 9878.645269705195, "adversary_policy": 11062.304574161502}, "policy_reward_mean": {"agent_policy": 7387.699800639246, "adversary_policy": 5760.231725143973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21761.438458930337, 19259.737511320945, 19802.094071924384, 20198.291254529817, 18883.44393314375, 18553.23983935828, 21344.207712223804, 20211.474432894855, 18984.052979696713, 18632.24715395769, 868.4256708145617, 20279.622069185316, 19252.974260165192, 440.64257065145955, 19014.66792528767, 19399.873998557487, 18774.632891611585, 18763.10879139417, 131.62485146935234, 20589.182300784443, 19368.798296741385, 20879.5573938145, 20136.916237962898, 21563.265483262214, 20345.797878855377, 18340.99595286693, 18060.397622911663, 18296.053656124393, 2918.366840390722, 21623.73803046046, 18644.420063255777, 23904.911528616234, 18445.893907513684, 19076.049601924457, 19220.992945484668, 19409.91789346867, 18217.61760919638, 21034.76791206508, 21704.462504965046, 18601.99730303062, 19697.190813653102, 23286.399717334374, 19312.972232067554, 19307.60371999654, 19284.543023158298, 18866.426253717156, 18533.17120507002, 18574.045373818848, 19016.693045850363, 18526.742626034335, 18638.484057030368, 19576.912669075897, 18939.205870973652, 21757.89332790087, 18469.951963417345, 20439.23116825473, 18832.924987079714, 22220.35047965867, 19213.700736368493, 18840.896091755134, 18197.995430527768, 18704.996961962403, 371.7054343559287, 18441.79397842298, 22307.28235326369, 18882.986800896248, 19985.71758615067, 21192.842777757938, 18123.587245346236, 21724.622565552094, 21162.763506905238, 19314.40489212363, 19700.025437503584, 18762.89026466104, 18155.35774402212, 18702.20269668429, 18273.31446466109, 18839.95826280883, 22859.384426361656, 18124.219743382608, 21441.737954244574, 19828.18151369006, 24885.563841696843, 20942.9769615624, 21466.363352909135, 20896.490318685584, 18650.907467915065, 18915.586842269422, 22252.690053316106, 20941.89875568395, 21107.485234939726, 18646.01413680921, 18965.389160890285, 23202.16119447174, 18895.157157823996, 20197.72160433276, 20394.68372839313, 19641.93881441519, 20301.63768011735, 21138.446042171923], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 4, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5973.2518381328155, 8763.659916210647, 7855.748342368119, 7437.13324528045, 8812.106340653738, 9290.277339326363, 6663.7254149141245, 7294.739953757472, 8707.270408534823, 9237.6520020647, 19.77201693054867, 7650.933469383576, 8642.840492402745, 9.110111043365787, 8303.392829907758, 8780.998615746508, 8218.190346561956, 9107.974382550752, 0.7947886639142173, 6782.400513716129, 8274.66813639556, 6679.084369130513, 7373.498159898216, 6351.182903776785, 6608.9514834291995, 9878.645269705195, 9587.759525087624, 9264.418577190558, 233.01343834931322, 6193.1959463481835, 8168.58786195808, 3342.2134016575615, 9302.68959227737, 9033.51068114395, 8713.745744152207, 8688.101627589584, 9829.527040597197, 6808.72445378322, 5873.674159136803, 8631.606553827356, 7970.420580886408, 4241.158844445011, 8553.005696288385, 8590.276816250416, 8273.705244646873, 8827.252648392116, 9475.96522135034, 9100.827579287887, 8752.585652550182, 8962.65235757521, 9390.961866245822, 8236.386079947777, 9067.410535304112, 4576.198539937029, 8602.921410008656, 7243.079493916074, 8746.213142297807, 5710.399921540615, 8513.988635301386, 9195.130797398906, 9746.716430126206, 8895.214235161635, 3.6037043838011327, 9767.32586921838, 4741.127774672555, 9041.354933976374, 7582.591211210896, 6256.287975316062, 8670.291020781522, 5347.293944581698, 6514.311093850204, 8376.462367317432, 8075.654156586003, 8940.480807044572, 9819.8726720792, 9207.698106573258, 8738.978649368146, 8970.06306508534, 5119.886350095982, 9414.750166779932, 6308.766692134217, 8133.5875675167, 2941.0084452930846, 6645.200435853551, 6600.930616584502, 6780.644791942916, 8919.145404403585, 8427.246078107308, 4802.3820977648165, 5923.1728696456785, 5425.6218564777155, 8191.873565093858, 8865.950599038943, 4498.925586316013, 8729.702051430084, 7829.91353540373, 7674.0876498376, 7878.559033279879, 7550.367194878459, 4993.6171015567725], "policy_adversary_policy_reward": [7946.203998493017, 7841.9826223044865, 5234.758320342391, 5261.319274767918, 5666.117534265845, 6280.228195290459, 6172.463504888225, 6588.694504361112, 4753.02664711587, 5318.310945374154, 4842.6660204049485, 4420.296479626968, 7209.646941886454, 7470.835355423159, 6647.451849169023, 6269.282629968344, 4842.9410610220175, 5433.841510139877, 4777.037351327915, 4617.557800565138, 373.45092398397844, 475.20272990003457, 6470.008811269677, 6158.679788532161, 5464.168471486142, 5145.965296276321, 273.7326014312532, 157.79985817684053, 4884.576467960038, 5826.698627419957, 5310.48003440709, 5308.395348403957, 5683.44162116552, 4873.000923884134, 4639.044866801535, 5016.089542041931, 60.914173350697595, 69.91588945474054, 6962.636531499588, 6844.145255568753, 5780.314808284106, 5313.815352061711, 7311.182826585002, 6889.290198098985, 6310.333468319664, 6453.084609745002, 7681.568304111159, 7530.514275374277, 7531.161219667133, 6205.685175759041, 4212.541580565634, 4249.8091025962185, 3925.350906439408, 4547.287191384702, 4834.089957144644, 4197.545121789224, 1452.695582555607, 1232.6578194858007, 7896.907738591703, 7533.634345520542, 4507.596344818781, 5968.235856478881, 9763.869954874166, 10798.828172084508, 4665.81157492081, 4477.392740315556, 5071.456592147027, 4971.082328633543, 5422.345101678081, 5084.902099654415, 5388.120959586598, 5333.695306292572, 4114.65007729672, 4273.4404913025055, 7300.432585866414, 6925.61087241545, 7796.740228596049, 8034.048117232126, 5191.869857512435, 4778.520891690862, 5986.540025675607, 5740.230207091084, 9429.616844375463, 9615.624028513805, 5548.324349799793, 5211.642185979481, 5543.240385814039, 5174.0865179320235, 5146.798771592293, 5864.039006919139, 4828.482426970974, 5210.691178354146, 4551.176534300381, 4506.029449419255, 4572.383007189692, 4900.834787341326, 4906.42675976013, 5357.680633540078, 5082.127888558421, 4481.96237990073, 4538.680538612336, 4708.841652172271, 5770.7448704161325, 5569.781718712007, 4984.199087854244, 4887.596247815321, 7651.166160732682, 9530.528627231231, 5460.146971836341, 4406.883581572451, 6766.702312499225, 6429.449361839425, 5185.885425479649, 4900.82641930232, 8415.711080873652, 8094.239477244386, 5558.330253758828, 5141.381847308242, 4759.485984817155, 4886.279309539115, 4057.249859841966, 4394.029140559707, 5114.3859758603185, 4695.396750940472, 208.52832997216314, 159.57339999996438, 4332.126307690487, 4342.341801514232, 8165.146729532623, 9401.007849058402, 5016.715952584447, 4824.915914335443, 6421.670146554569, 5981.45622838529, 7885.847648414896, 7050.707154026954, 5468.508946663899, 3984.787277900925, 8081.1221917529, 8296.206429217535, 7198.7425881454665, 7449.709824909611, 5755.425276240845, 5182.517248565337, 5704.057379557491, 5920.313901360093, 5102.788552132171, 4719.620905484357, 4026.359721367827, 4309.125350575154, 4560.067072953386, 4934.437517157705, 5352.282769245455, 4182.053046047462, 4862.027204167921, 5007.867993555577, 8790.493761731987, 8949.00431453371, 3989.346395104598, 4720.1231814982, 7734.088302548059, 7398.882959562288, 5894.3528288788675, 5800.241117294467, 10882.250822242282, 11062.304574161502, 7188.59015225446, 7109.186373454413, 7334.825769386942, 7530.606966937728, 6809.655450432847, 7306.190076309815, 5217.491937760999, 4514.2701257505005, 4773.451218538464, 5714.889545623655, 8170.676512717258, 9279.631442834052, 6799.783129953398, 8218.94275608487, 6965.422596449784, 8716.440782012243, 4600.144537410949, 5853.996034304397, 5165.884366902332, 4933.554194949022, 9435.548927215077, 9267.68668094075, 5362.806252818833, 4802.648853575179, 6251.8925442224145, 6115.915524706647, 6419.757133211354, 6300.838945344136, 6263.576590451084, 5499.803190684255, 6560.806336931654, 6190.464148307253, 6996.310418441, 9148.518522174174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3983893531467097, "mean_inference_ms": 0.9907646057082434, "mean_action_processing_ms": 0.16758114796615564, "mean_env_wait_ms": 0.05413415827284998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003581404685974121, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.06668365001678467}, "num_episodes": 20, "episode_return_max": 24885.563841696843, "episode_return_min": 131.62485146935234, "episode_return_mean": 18908.16325092717}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.125163825159, "num_env_steps_trained_throughput_per_sec": 554.125163825159, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 7285.302, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7285.267, "sample_time_ms": 808.647, "learn_time_ms": 6465.261, "learn_throughput": 618.691, "synch_weights_time_ms": 10.912}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "training_iteration": 137, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-04", "timestamp": 1723236424, "time_this_iter_s": 7.223224878311157, "time_total_s": 1040.4130775928497, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1040.4130775928497, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 23.40909090909091, "ram_util_percent": 81.77272727272725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22259084329.85397, "cur_kl_coeff": 113207961162.68945, "cur_lr": 5.0000000000000016e-05, "total_loss": 3869005099.7502646, "policy_loss": 0.02180822759536563, "vf_loss": 10.0, "vf_explained_var": -1.3582952438838899e-05, "kl": 0.034176087204524606, "entropy": 1.215817837803452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8182347625338783, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99437707165877, "policy_loss": -0.005421800999223099, "vf_loss": 9.993681716918946, "vf_explained_var": -0.0003708730141321818, "kl": 0.0037717569117376114, "entropy": 1.0980085430045923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": 24885.563841696843, "episode_reward_min": 371.7054343559287, "episode_reward_mean": 19467.313011805745, "episode_len_mean": 195.62, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19562, "policy_reward_min": {"agent_policy": 3.6037043838011327, "adversary_policy": 159.57339999996438}, "policy_reward_max": {"agent_policy": 10063.052248992935, "adversary_policy": 11062.304574161502}, "policy_reward_mean": {"agent_policy": 7504.010851006356, "adversary_policy": 5981.651080399705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19368.798296741385, 20879.5573938145, 20136.916237962898, 21563.265483262214, 20345.797878855377, 18340.99595286693, 18060.397622911663, 18296.053656124393, 2918.366840390722, 21623.73803046046, 18644.420063255777, 23904.911528616234, 18445.893907513684, 19076.049601924457, 19220.992945484668, 19409.91789346867, 18217.61760919638, 21034.76791206508, 21704.462504965046, 18601.99730303062, 19697.190813653102, 23286.399717334374, 19312.972232067554, 19307.60371999654, 19284.543023158298, 18866.426253717156, 18533.17120507002, 18574.045373818848, 19016.693045850363, 18526.742626034335, 18638.484057030368, 19576.912669075897, 18939.205870973652, 21757.89332790087, 18469.951963417345, 20439.23116825473, 18832.924987079714, 22220.35047965867, 19213.700736368493, 18840.896091755134, 18197.995430527768, 18704.996961962403, 371.7054343559287, 18441.79397842298, 22307.28235326369, 18882.986800896248, 19985.71758615067, 21192.842777757938, 18123.587245346236, 21724.622565552094, 21162.763506905238, 19314.40489212363, 19700.025437503584, 18762.89026466104, 18155.35774402212, 18702.20269668429, 18273.31446466109, 18839.95826280883, 22859.384426361656, 18124.219743382608, 21441.737954244574, 19828.18151369006, 24885.563841696843, 20942.9769615624, 21466.363352909135, 20896.490318685584, 18650.907467915065, 18915.586842269422, 22252.690053316106, 20941.89875568395, 21107.485234939726, 18646.01413680921, 18965.389160890285, 23202.16119447174, 18895.157157823996, 20197.72160433276, 20394.68372839313, 19641.93881441519, 20301.63768011735, 21138.446042171923, 18857.909502538736, 18699.095808722985, 15717.65419416326, 18909.500662273236, 23301.93213832716, 18354.30738962047, 20259.433639681745, 17862.431744939702, 18651.860965514305, 18196.779675797014, 20480.69381259321, 23595.614450415425, 19354.67504630103, 18495.860149291948, 22060.375659358797, 21975.65438245746, 18525.27988931085, 18409.763500556117, 20933.03696921341, 18418.099184682473], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 134, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8274.66813639556, 6679.084369130513, 7373.498159898216, 6351.182903776785, 6608.9514834291995, 9878.645269705195, 9587.759525087624, 9264.418577190558, 233.01343834931322, 6193.1959463481835, 8168.58786195808, 3342.2134016575615, 9302.68959227737, 9033.51068114395, 8713.745744152207, 8688.101627589584, 9829.527040597197, 6808.72445378322, 5873.674159136803, 8631.606553827356, 7970.420580886408, 4241.158844445011, 8553.005696288385, 8590.276816250416, 8273.705244646873, 8827.252648392116, 9475.96522135034, 9100.827579287887, 8752.585652550182, 8962.65235757521, 9390.961866245822, 8236.386079947777, 9067.410535304112, 4576.198539937029, 8602.921410008656, 7243.079493916074, 8746.213142297807, 5710.399921540615, 8513.988635301386, 9195.130797398906, 9746.716430126206, 8895.214235161635, 3.6037043838011327, 9767.32586921838, 4741.127774672555, 9041.354933976374, 7582.591211210896, 6256.287975316062, 8670.291020781522, 5347.293944581698, 6514.311093850204, 8376.462367317432, 8075.654156586003, 8940.480807044572, 9819.8726720792, 9207.698106573258, 8738.978649368146, 8970.06306508534, 5119.886350095982, 9414.750166779932, 6308.766692134217, 8133.5875675167, 2941.0084452930846, 6645.200435853551, 6600.930616584502, 6780.644791942916, 8919.145404403585, 8427.246078107308, 4802.3820977648165, 5923.1728696456785, 5425.6218564777155, 8191.873565093858, 8865.950599038943, 4498.925586316013, 8729.702051430084, 7829.91353540373, 7674.0876498376, 7878.559033279879, 7550.367194878459, 4993.6171015567725, 7986.3477264540315, 7887.60159663135, 1578.5905495393254, 8749.19768313006, 4701.358865429748, 8831.884250957406, 7464.6605657495265, 10063.052248992935, 9392.62494235846, 9908.035177985292, 6733.871807589429, 3938.7029901278247, 7706.842710357995, 9232.076870489109, 5732.488846052177, 4740.298719937004, 9409.674542282635, 8932.228993867722, 6775.120596488451, 9418.417720440977], "policy_adversary_policy_reward": [5780.314808284106, 5313.815352061711, 7311.182826585002, 6889.290198098985, 6310.333468319664, 6453.084609745002, 7681.568304111159, 7530.514275374277, 7531.161219667133, 6205.685175759041, 4212.541580565634, 4249.8091025962185, 3925.350906439408, 4547.287191384702, 4834.089957144644, 4197.545121789224, 1452.695582555607, 1232.6578194858007, 7896.907738591703, 7533.634345520542, 4507.596344818781, 5968.235856478881, 9763.869954874166, 10798.828172084508, 4665.81157492081, 4477.392740315556, 5071.456592147027, 4971.082328633543, 5422.345101678081, 5084.902099654415, 5388.120959586598, 5333.695306292572, 4114.65007729672, 4273.4404913025055, 7300.432585866414, 6925.61087241545, 7796.740228596049, 8034.048117232126, 5191.869857512435, 4778.520891690862, 5986.540025675607, 5740.230207091084, 9429.616844375463, 9615.624028513805, 5548.324349799793, 5211.642185979481, 5543.240385814039, 5174.0865179320235, 5146.798771592293, 5864.039006919139, 4828.482426970974, 5210.691178354146, 4551.176534300381, 4506.029449419255, 4572.383007189692, 4900.834787341326, 4906.42675976013, 5357.680633540078, 5082.127888558421, 4481.96237990073, 4538.680538612336, 4708.841652172271, 5770.7448704161325, 5569.781718712007, 4984.199087854244, 4887.596247815321, 7651.166160732682, 9530.528627231231, 5460.146971836341, 4406.883581572451, 6766.702312499225, 6429.449361839425, 5185.885425479649, 4900.82641930232, 8415.711080873652, 8094.239477244386, 5558.330253758828, 5141.381847308242, 4759.485984817155, 4886.279309539115, 4057.249859841966, 4394.029140559707, 5114.3859758603185, 4695.396750940472, 208.52832997216314, 159.57339999996438, 4332.126307690487, 4342.341801514232, 8165.146729532623, 9401.007849058402, 5016.715952584447, 4824.915914335443, 6421.670146554569, 5981.45622838529, 7885.847648414896, 7050.707154026954, 5468.508946663899, 3984.787277900925, 8081.1221917529, 8296.206429217535, 7198.7425881454665, 7449.709824909611, 5755.425276240845, 5182.517248565337, 5704.057379557491, 5920.313901360093, 5102.788552132171, 4719.620905484357, 4026.359721367827, 4309.125350575154, 4560.067072953386, 4934.437517157705, 5352.282769245455, 4182.053046047462, 4862.027204167921, 5007.867993555577, 8790.493761731987, 8949.00431453371, 3989.346395104598, 4720.1231814982, 7734.088302548059, 7398.882959562288, 5894.3528288788675, 5800.241117294467, 10882.250822242282, 11062.304574161502, 7188.59015225446, 7109.186373454413, 7334.825769386942, 7530.606966937728, 6809.655450432847, 7306.190076309815, 5217.491937760999, 4514.2701257505005, 4773.451218538464, 5714.889545623655, 8170.676512717258, 9279.631442834052, 6799.783129953398, 8218.94275608487, 6965.422596449784, 8716.440782012243, 4600.144537410949, 5853.996034304397, 5165.884366902332, 4933.554194949022, 9435.548927215077, 9267.68668094075, 5362.806252818833, 4802.648853575179, 6251.8925442224145, 6115.915524706647, 6419.757133211354, 6300.838945344136, 6263.576590451084, 5499.803190684255, 6560.806336931654, 6190.464148307253, 6996.310418441, 9148.518522174174, 4719.40385800565, 6152.157918079028, 6188.786551032984, 4622.707661058604, 6242.423326263522, 7896.640318360417, 4771.998653725218, 5388.304325418038, 9243.504877648737, 9357.068395248814, 4214.313172463904, 5308.109966199243, 6671.584571341868, 6123.188502590412, 3726.953324336256, 4072.4261716105716, 4713.462423605123, 4545.7735995507, 4077.6764955838435, 4211.068002227973, 7361.586310655703, 6385.2356943480445, 10203.432633603104, 9453.47882668444, 6152.0957989114, 5495.736537031647, 4359.640278464888, 4904.143000338033, 8409.187815055615, 7918.69899825094, 7833.5187587265245, 9401.836903793966, 4410.83835977981, 4704.7669872483275, 5085.016601680418, 4392.517905008038, 7195.496022652104, 6962.420350072802, 4718.250891775048, 4281.430572466444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39830218133320305, "mean_inference_ms": 0.990567719930701, "mean_action_processing_ms": 0.16758017550414014, "mean_env_wait_ms": 0.05408959333126244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003325343132019043, "StateBufferConnector_ms": 0.0025998353958129883, "ViewRequirementAgentConnector_ms": 0.06593835353851318}, "num_episodes": 20, "episode_return_max": 24885.563841696843, "episode_return_min": 371.7054343559287, "episode_return_mean": 19467.313011805745}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.5189189717066, "num_env_steps_trained_throughput_per_sec": 553.5189189717066, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 7282.404, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7282.369, "sample_time_ms": 798.175, "learn_time_ms": 6472.424, "learn_throughput": 618.006, "synch_weights_time_ms": 11.296}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 138, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-12", "timestamp": 1723236432, "time_this_iter_s": 7.231243133544922, "time_total_s": 1047.6443207263947, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c6e5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1047.6443207263947, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 24.29, "ram_util_percent": 81.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34130421532.986244, "cur_kl_coeff": 169811941744.03415, "cur_lr": 5.0000000000000016e-05, "total_loss": 6894551571.437037, "policy_loss": 0.04589433787617261, "vf_loss": 10.0, "vf_explained_var": 4.9988491825325776e-05, "kl": 0.040601101205019016, "entropy": 1.2244248197192238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8338819893542677, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999648105104765, "policy_loss": -0.001347291852289345, "vf_loss": 9.994650440414746, "vf_explained_var": -0.000340052197376887, "kl": 0.00782444559057088, "entropy": 1.0849050931632518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "env_runners": {"episode_reward_max": 24885.563841696843, "episode_reward_min": 371.7054343559287, "episode_reward_mean": 19592.263432080428, "episode_len_mean": 195.42, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19542, "policy_reward_min": {"agent_policy": 3.6037043838011327, "adversary_policy": 159.57339999996438}, "policy_reward_max": {"agent_policy": 10063.052248992935, "adversary_policy": 11062.304574161502}, "policy_reward_mean": {"agent_policy": 7322.557167695015, "adversary_policy": 6134.853132192716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23286.399717334374, 19312.972232067554, 19307.60371999654, 19284.543023158298, 18866.426253717156, 18533.17120507002, 18574.045373818848, 19016.693045850363, 18526.742626034335, 18638.484057030368, 19576.912669075897, 18939.205870973652, 21757.89332790087, 18469.951963417345, 20439.23116825473, 18832.924987079714, 22220.35047965867, 19213.700736368493, 18840.896091755134, 18197.995430527768, 18704.996961962403, 371.7054343559287, 18441.79397842298, 22307.28235326369, 18882.986800896248, 19985.71758615067, 21192.842777757938, 18123.587245346236, 21724.622565552094, 21162.763506905238, 19314.40489212363, 19700.025437503584, 18762.89026466104, 18155.35774402212, 18702.20269668429, 18273.31446466109, 18839.95826280883, 22859.384426361656, 18124.219743382608, 21441.737954244574, 19828.18151369006, 24885.563841696843, 20942.9769615624, 21466.363352909135, 20896.490318685584, 18650.907467915065, 18915.586842269422, 22252.690053316106, 20941.89875568395, 21107.485234939726, 18646.01413680921, 18965.389160890285, 23202.16119447174, 18895.157157823996, 20197.72160433276, 20394.68372839313, 19641.93881441519, 20301.63768011735, 21138.446042171923, 18857.909502538736, 18699.095808722985, 15717.65419416326, 18909.500662273236, 23301.93213832716, 18354.30738962047, 20259.433639681745, 17862.431744939702, 18651.860965514305, 18196.779675797014, 20480.69381259321, 23595.614450415425, 19354.67504630103, 18495.860149291948, 22060.375659358797, 21975.65438245746, 18525.27988931085, 18409.763500556117, 20933.03696921341, 18418.099184682473, 20625.277385114437, 20679.301099421657, 19331.829909149055, 18912.799370294037, 23289.875898585622, 578.7509091637127, 19713.6054154002, 21808.42541138038, 22026.96801730122, 18680.525670234638, 19943.893853790938, 19495.56340663969, 24786.378486816022, 21048.271703460567, 18321.000237850338, 20477.327041605935, 20078.997603124797, 19591.146674203057, 21529.81848194801, 19770.890052097373, 21296.504876450876], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 134, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4241.158844445011, 8553.005696288385, 8590.276816250416, 8273.705244646873, 8827.252648392116, 9475.96522135034, 9100.827579287887, 8752.585652550182, 8962.65235757521, 9390.961866245822, 8236.386079947777, 9067.410535304112, 4576.198539937029, 8602.921410008656, 7243.079493916074, 8746.213142297807, 5710.399921540615, 8513.988635301386, 9195.130797398906, 9746.716430126206, 8895.214235161635, 3.6037043838011327, 9767.32586921838, 4741.127774672555, 9041.354933976374, 7582.591211210896, 6256.287975316062, 8670.291020781522, 5347.293944581698, 6514.311093850204, 8376.462367317432, 8075.654156586003, 8940.480807044572, 9819.8726720792, 9207.698106573258, 8738.978649368146, 8970.06306508534, 5119.886350095982, 9414.750166779932, 6308.766692134217, 8133.5875675167, 2941.0084452930846, 6645.200435853551, 6600.930616584502, 6780.644791942916, 8919.145404403585, 8427.246078107308, 4802.3820977648165, 5923.1728696456785, 5425.6218564777155, 8191.873565093858, 8865.950599038943, 4498.925586316013, 8729.702051430084, 7829.91353540373, 7674.0876498376, 7878.559033279879, 7550.367194878459, 4993.6171015567725, 7986.3477264540315, 7887.60159663135, 1578.5905495393254, 8749.19768313006, 4701.358865429748, 8831.884250957406, 7464.6605657495265, 10063.052248992935, 9392.62494235846, 9908.035177985292, 6733.871807589429, 3938.7029901278247, 7706.842710357995, 9232.076870489109, 5732.488846052177, 4740.298719937004, 9409.674542282635, 8932.228993867722, 6775.120596488451, 9418.417720440977, 6926.638628457446, 6745.857671254565, 7429.359444190906, 8884.731552841235, 4531.6522750831455, 13.936932368907666, 8127.84480214133, 5722.408071690132, 4762.580393856797, 8473.419258964452, 7618.989123391844, 7768.801418794765, 3193.8061776184495, 6898.528762756129, 9184.027863034864, 6743.171517445251, 7500.471786106083, 7616.748632084904, 6446.673393534109, 8037.692828303101, 6034.5106412683], "policy_adversary_policy_reward": [9429.616844375463, 9615.624028513805, 5548.324349799793, 5211.642185979481, 5543.240385814039, 5174.0865179320235, 5146.798771592293, 5864.039006919139, 4828.482426970974, 5210.691178354146, 4551.176534300381, 4506.029449419255, 4572.383007189692, 4900.834787341326, 4906.42675976013, 5357.680633540078, 5082.127888558421, 4481.96237990073, 4538.680538612336, 4708.841652172271, 5770.7448704161325, 5569.781718712007, 4984.199087854244, 4887.596247815321, 7651.166160732682, 9530.528627231231, 5460.146971836341, 4406.883581572451, 6766.702312499225, 6429.449361839425, 5185.885425479649, 4900.82641930232, 8415.711080873652, 8094.239477244386, 5558.330253758828, 5141.381847308242, 4759.485984817155, 4886.279309539115, 4057.249859841966, 4394.029140559707, 5114.3859758603185, 4695.396750940472, 208.52832997216314, 159.57339999996438, 4332.126307690487, 4342.341801514232, 8165.146729532623, 9401.007849058402, 5016.715952584447, 4824.915914335443, 6421.670146554569, 5981.45622838529, 7885.847648414896, 7050.707154026954, 5468.508946663899, 3984.787277900925, 8081.1221917529, 8296.206429217535, 7198.7425881454665, 7449.709824909611, 5755.425276240845, 5182.517248565337, 5704.057379557491, 5920.313901360093, 5102.788552132171, 4719.620905484357, 4026.359721367827, 4309.125350575154, 4560.067072953386, 4934.437517157705, 5352.282769245455, 4182.053046047462, 4862.027204167921, 5007.867993555577, 8790.493761731987, 8949.00431453371, 3989.346395104598, 4720.1231814982, 7734.088302548059, 7398.882959562288, 5894.3528288788675, 5800.241117294467, 10882.250822242282, 11062.304574161502, 7188.59015225446, 7109.186373454413, 7334.825769386942, 7530.606966937728, 6809.655450432847, 7306.190076309815, 5217.491937760999, 4514.2701257505005, 4773.451218538464, 5714.889545623655, 8170.676512717258, 9279.631442834052, 6799.783129953398, 8218.94275608487, 6965.422596449784, 8716.440782012243, 4600.144537410949, 5853.996034304397, 5165.884366902332, 4933.554194949022, 9435.548927215077, 9267.68668094075, 5362.806252818833, 4802.648853575179, 6251.8925442224145, 6115.915524706647, 6419.757133211354, 6300.838945344136, 6263.576590451084, 5499.803190684255, 6560.806336931654, 6190.464148307253, 6996.310418441, 9148.518522174174, 4719.40385800565, 6152.157918079028, 6188.786551032984, 4622.707661058604, 6242.423326263522, 7896.640318360417, 4771.998653725218, 5388.304325418038, 9243.504877648737, 9357.068395248814, 4214.313172463904, 5308.109966199243, 6671.584571341868, 6123.188502590412, 3726.953324336256, 4072.4261716105716, 4713.462423605123, 4545.7735995507, 4077.6764955838435, 4211.068002227973, 7361.586310655703, 6385.2356943480445, 10203.432633603104, 9453.47882668444, 6152.0957989114, 5495.736537031647, 4359.640278464888, 4904.143000338033, 8409.187815055615, 7918.69899825094, 7833.5187587265245, 9401.836903793966, 4410.83835977981, 4704.7669872483275, 5085.016601680418, 4392.517905008038, 7195.496022652104, 6962.420350072802, 4718.250891775048, 4281.430572466444, 6647.442312880972, 7051.196443776087, 6560.1668625389075, 7373.2765656280635, 6467.102498387984, 5435.367966570155, 5249.101970858172, 4778.965846594737, 9230.645892969602, 9527.577730532917, 339.6164582243661, 225.19751857043897, 6003.380001567205, 5582.380611691708, 7670.6657558422785, 8415.351583847907, 7885.349725930115, 9379.037897514436, 5403.230910160492, 4803.875501109749, 6396.650615198068, 5928.254115201027, 5417.808738307316, 6308.9532495375925, 10680.680307974648, 10911.892001222832, 6910.504139216335, 7239.238801488067, 4928.608708776522, 4208.363666038941, 6401.751426820083, 7332.404097340613, 6328.367079746165, 6250.158737272501, 6468.794293640628, 5505.603748477552, 7484.93721278225, 7598.207875631651, 5948.291832844113, 5784.905390950154, 7333.773489568788, 7928.2207456137285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39855069991739256, "mean_inference_ms": 0.9914235539230813, "mean_action_processing_ms": 0.1677148936925912, "mean_env_wait_ms": 0.0541376445525499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032629966735839844, "StateBufferConnector_ms": 0.0037065744400024414, "ViewRequirementAgentConnector_ms": 0.0712810754776001}, "num_episodes": 21, "episode_return_max": 24885.563841696843, "episode_return_min": 371.7054343559287, "episode_return_mean": 19592.263432080428}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.2818335336666, "num_env_steps_trained_throughput_per_sec": 494.2818335336666, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1668000, "timers": {"training_iteration_time_ms": 7359.794, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7359.758, "sample_time_ms": 856.367, "learn_time_ms": 6491.837, "learn_throughput": 616.158, "synch_weights_time_ms": 11.064}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "done": false, "training_iteration": 139, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-20", "timestamp": 1723236440, "time_this_iter_s": 8.126323938369751, "time_total_s": 1055.7706446647644, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3a3d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1055.7706446647644, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 32.1, "ram_util_percent": 82.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48084394704.59259, "cur_kl_coeff": 254717912616.05127, "cur_lr": 5.0000000000000016e-05, "total_loss": 9250106995.267725, "policy_loss": 0.03730641622890881, "vf_loss": 10.0, "vf_explained_var": -1.7430101122174945e-05, "kl": 0.03631510111261849, "entropy": 1.2388934649487653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8726787139195948, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003902623057366, "policy_loss": 0.00010223960416624322, "vf_loss": 9.99470667541027, "vf_explained_var": -0.00017186875144640604, "kl": 0.0112141536155832, "entropy": 1.1142499063163995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 24885.563841696843, "episode_reward_min": 371.7054343559287, "episode_reward_mean": 19533.18502289775, "episode_len_mean": 193.76, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19376, "policy_reward_min": {"agent_policy": 3.6037043838011327, "adversary_policy": 159.57339999996438}, "policy_reward_max": {"agent_policy": 10063.052248992935, "adversary_policy": 11062.304574161502}, "policy_reward_mean": {"agent_policy": 7156.667980613342, "adversary_policy": 6188.258521142211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.7054343559287, 18441.79397842298, 22307.28235326369, 18882.986800896248, 19985.71758615067, 21192.842777757938, 18123.587245346236, 21724.622565552094, 21162.763506905238, 19314.40489212363, 19700.025437503584, 18762.89026466104, 18155.35774402212, 18702.20269668429, 18273.31446466109, 18839.95826280883, 22859.384426361656, 18124.219743382608, 21441.737954244574, 19828.18151369006, 24885.563841696843, 20942.9769615624, 21466.363352909135, 20896.490318685584, 18650.907467915065, 18915.586842269422, 22252.690053316106, 20941.89875568395, 21107.485234939726, 18646.01413680921, 18965.389160890285, 23202.16119447174, 18895.157157823996, 20197.72160433276, 20394.68372839313, 19641.93881441519, 20301.63768011735, 21138.446042171923, 18857.909502538736, 18699.095808722985, 15717.65419416326, 18909.500662273236, 23301.93213832716, 18354.30738962047, 20259.433639681745, 17862.431744939702, 18651.860965514305, 18196.779675797014, 20480.69381259321, 23595.614450415425, 19354.67504630103, 18495.860149291948, 22060.375659358797, 21975.65438245746, 18525.27988931085, 18409.763500556117, 20933.03696921341, 18418.099184682473, 20625.277385114437, 20679.301099421657, 19331.829909149055, 18912.799370294037, 23289.875898585622, 578.7509091637127, 19713.6054154002, 21808.42541138038, 22026.96801730122, 18680.525670234638, 19943.893853790938, 19495.56340663969, 24786.378486816022, 21048.271703460567, 18321.000237850338, 20477.327041605935, 20078.997603124797, 19591.146674203057, 21529.81848194801, 19770.890052097373, 21296.504876450876, 21745.513532049106, 19007.22400204926, 21218.690960968186, 18564.872828056436, 20630.673677654668, 19198.32570085646, 19228.20342753985, 3766.6095662823186, 19274.737785441972, 20586.87549839644, 20521.580882354796, 19825.550995058627, 19745.571749846855, 20716.50775166472, 18740.688239882933, 22390.797435756427, 20134.319489164962, 19292.348112805772, 19789.47053724601, 19579.51619959728, 18675.221650111594], "episode_lengths": [3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 134, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [3.6037043838011327, 9767.32586921838, 4741.127774672555, 9041.354933976374, 7582.591211210896, 6256.287975316062, 8670.291020781522, 5347.293944581698, 6514.311093850204, 8376.462367317432, 8075.654156586003, 8940.480807044572, 9819.8726720792, 9207.698106573258, 8738.978649368146, 8970.06306508534, 5119.886350095982, 9414.750166779932, 6308.766692134217, 8133.5875675167, 2941.0084452930846, 6645.200435853551, 6600.930616584502, 6780.644791942916, 8919.145404403585, 8427.246078107308, 4802.3820977648165, 5923.1728696456785, 5425.6218564777155, 8191.873565093858, 8865.950599038943, 4498.925586316013, 8729.702051430084, 7829.91353540373, 7674.0876498376, 7878.559033279879, 7550.367194878459, 4993.6171015567725, 7986.3477264540315, 7887.60159663135, 1578.5905495393254, 8749.19768313006, 4701.358865429748, 8831.884250957406, 7464.6605657495265, 10063.052248992935, 9392.62494235846, 9908.035177985292, 6733.871807589429, 3938.7029901278247, 7706.842710357995, 9232.076870489109, 5732.488846052177, 4740.298719937004, 9409.674542282635, 8932.228993867722, 6775.120596488451, 9418.417720440977, 6926.638628457446, 6745.857671254565, 7429.359444190906, 8884.731552841235, 4531.6522750831455, 13.936932368907666, 8127.84480214133, 5722.408071690132, 4762.580393856797, 8473.419258964452, 7618.989123391844, 7768.801418794765, 3193.8061776184495, 6898.528762756129, 9184.027863034864, 6743.171517445251, 7500.471786106083, 7616.748632084904, 6446.673393534109, 8037.692828303101, 6034.5106412683, 5707.2350307285715, 8859.34516023635, 6660.910523609633, 9382.163192808408, 7326.71205015244, 8518.783902853953, 8092.5113042689345, 567.8506441147513, 8309.387774685265, 6555.124115272624, 7408.258503840063, 8112.234422528734, 7640.451158225698, 7338.147009667068, 9089.65446290418, 5273.298434756837, 7691.738281917562, 8760.780550473304, 7866.244235503629, 8422.073947945451, 8530.227733311905], "policy_adversary_policy_reward": [208.52832997216314, 159.57339999996438, 4332.126307690487, 4342.341801514232, 8165.146729532623, 9401.007849058402, 5016.715952584447, 4824.915914335443, 6421.670146554569, 5981.45622838529, 7885.847648414896, 7050.707154026954, 5468.508946663899, 3984.787277900925, 8081.1221917529, 8296.206429217535, 7198.7425881454665, 7449.709824909611, 5755.425276240845, 5182.517248565337, 5704.057379557491, 5920.313901360093, 5102.788552132171, 4719.620905484357, 4026.359721367827, 4309.125350575154, 4560.067072953386, 4934.437517157705, 5352.282769245455, 4182.053046047462, 4862.027204167921, 5007.867993555577, 8790.493761731987, 8949.00431453371, 3989.346395104598, 4720.1231814982, 7734.088302548059, 7398.882959562288, 5894.3528288788675, 5800.241117294467, 10882.250822242282, 11062.304574161502, 7188.59015225446, 7109.186373454413, 7334.825769386942, 7530.606966937728, 6809.655450432847, 7306.190076309815, 5217.491937760999, 4514.2701257505005, 4773.451218538464, 5714.889545623655, 8170.676512717258, 9279.631442834052, 6799.783129953398, 8218.94275608487, 6965.422596449784, 8716.440782012243, 4600.144537410949, 5853.996034304397, 5165.884366902332, 4933.554194949022, 9435.548927215077, 9267.68668094075, 5362.806252818833, 4802.648853575179, 6251.8925442224145, 6115.915524706647, 6419.757133211354, 6300.838945344136, 6263.576590451084, 5499.803190684255, 6560.806336931654, 6190.464148307253, 6996.310418441, 9148.518522174174, 4719.40385800565, 6152.157918079028, 6188.786551032984, 4622.707661058604, 6242.423326263522, 7896.640318360417, 4771.998653725218, 5388.304325418038, 9243.504877648737, 9357.068395248814, 4214.313172463904, 5308.109966199243, 6671.584571341868, 6123.188502590412, 3726.953324336256, 4072.4261716105716, 4713.462423605123, 4545.7735995507, 4077.6764955838435, 4211.068002227973, 7361.586310655703, 6385.2356943480445, 10203.432633603104, 9453.47882668444, 6152.0957989114, 5495.736537031647, 4359.640278464888, 4904.143000338033, 8409.187815055615, 7918.69899825094, 7833.5187587265245, 9401.836903793966, 4410.83835977981, 4704.7669872483275, 5085.016601680418, 4392.517905008038, 7195.496022652104, 6962.420350072802, 4718.250891775048, 4281.430572466444, 6647.442312880972, 7051.196443776087, 6560.1668625389075, 7373.2765656280635, 6467.102498387984, 5435.367966570155, 5249.101970858172, 4778.965846594737, 9230.645892969602, 9527.577730532917, 339.6164582243661, 225.19751857043897, 6003.380001567205, 5582.380611691708, 7670.6657558422785, 8415.351583847907, 7885.349725930115, 9379.037897514436, 5403.230910160492, 4803.875501109749, 6396.650615198068, 5928.254115201027, 5417.808738307316, 6308.9532495375925, 10680.680307974648, 10911.892001222832, 6910.504139216335, 7239.238801488067, 4928.608708776522, 4208.363666038941, 6401.751426820083, 7332.404097340613, 6328.367079746165, 6250.158737272501, 6468.794293640628, 5505.603748477552, 7484.93721278225, 7598.207875631651, 5948.291832844113, 5784.905390950154, 7333.773489568788, 7928.2207456137285, 7920.226819747619, 8118.051681572809, 5251.9913191279065, 4895.88752268507, 7432.123827996653, 7125.656609361911, 4453.844911846339, 4728.8647234017035, 6519.534088957956, 6784.427538544179, 5080.928060266721, 5598.613737735815, 6046.4541730753635, 5089.237950195631, 1836.3124119195102, 1362.446510248056, 5193.727094154855, 5771.622916601875, 7587.011508458355, 6444.739874665421, 6391.838149860841, 6721.484228653844, 5826.063713733729, 5887.252858796225, 6291.7747846826205, 5813.3458069385815, 6619.320106963907, 6759.040635033699, 4828.809482300061, 4822.224294678717, 8353.691967246632, 8763.8070337529, 6347.499215402621, 6095.081991844788, 5359.7777578742525, 5171.789804458255, 6148.307689053437, 5774.918612688931, 5595.399646937152, 5562.042604714676, 5500.466763016789, 4644.527153782944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988008976527296, "mean_inference_ms": 0.9923265182104096, "mean_action_processing_ms": 0.16784001809451277, "mean_env_wait_ms": 0.05421022919548782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350344181060791, "StateBufferConnector_ms": 0.003650665283203125, "ViewRequirementAgentConnector_ms": 0.07266449928283691}, "num_episodes": 21, "episode_return_max": 24885.563841696843, "episode_return_min": 371.7054343559287, "episode_return_mean": 19533.18502289775}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.4925300082903, "num_env_steps_trained_throughput_per_sec": 533.4925300082903, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 7408.38, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7408.345, "sample_time_ms": 859.026, "learn_time_ms": 6537.784, "learn_throughput": 611.828, "synch_weights_time_ms": 11.041}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 140, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-28", "timestamp": 1723236448, "time_this_iter_s": 7.502714157104492, "time_total_s": 1063.273358821869, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3a3d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1063.273358821869, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 29.572727272727278, "ram_util_percent": 82.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65527120594.75979, "cur_kl_coeff": 382076868924.0768, "cur_lr": 5.0000000000000016e-05, "total_loss": 13787969637.99365, "policy_loss": 0.04392512377496888, "vf_loss": 10.0, "vf_explained_var": 0.000166957245932685, "kl": 0.036086898689557396, "entropy": 1.244087918914815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8484572092226396, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.015847492218018, "policy_loss": 0.005129876097877665, "vf_loss": 10.0, "vf_explained_var": -0.00011038898179928461, "kl": 0.013216680537637634, "entropy": 1.14084164823095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "env_runners": {"episode_reward_max": 24885.563841696843, "episode_reward_min": 578.7509091637127, "episode_reward_mean": 19642.22842946442, "episode_len_mean": 195.73, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19573, "policy_reward_min": {"agent_policy": 13.936932368907666, "adversary_policy": 225.19751857043897}, "policy_reward_max": {"agent_policy": 10063.052248992935, "adversary_policy": 11062.304574161502}, "policy_reward_mean": {"agent_policy": 7300.053905035358, "adversary_policy": 6171.087262214539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24885.563841696843, 20942.9769615624, 21466.363352909135, 20896.490318685584, 18650.907467915065, 18915.586842269422, 22252.690053316106, 20941.89875568395, 21107.485234939726, 18646.01413680921, 18965.389160890285, 23202.16119447174, 18895.157157823996, 20197.72160433276, 20394.68372839313, 19641.93881441519, 20301.63768011735, 21138.446042171923, 18857.909502538736, 18699.095808722985, 15717.65419416326, 18909.500662273236, 23301.93213832716, 18354.30738962047, 20259.433639681745, 17862.431744939702, 18651.860965514305, 18196.779675797014, 20480.69381259321, 23595.614450415425, 19354.67504630103, 18495.860149291948, 22060.375659358797, 21975.65438245746, 18525.27988931085, 18409.763500556117, 20933.03696921341, 18418.099184682473, 20625.277385114437, 20679.301099421657, 19331.829909149055, 18912.799370294037, 23289.875898585622, 578.7509091637127, 19713.6054154002, 21808.42541138038, 22026.96801730122, 18680.525670234638, 19943.893853790938, 19495.56340663969, 24786.378486816022, 21048.271703460567, 18321.000237850338, 20477.327041605935, 20078.997603124797, 19591.146674203057, 21529.81848194801, 19770.890052097373, 21296.504876450876, 21745.513532049106, 19007.22400204926, 21218.690960968186, 18564.872828056436, 20630.673677654668, 19198.32570085646, 19228.20342753985, 3766.6095662823186, 19274.737785441972, 20586.87549839644, 20521.580882354796, 19825.550995058627, 19745.571749846855, 20716.50775166472, 18740.688239882933, 22390.797435756427, 20134.319489164962, 19292.348112805772, 19789.47053724601, 19579.51619959728, 18675.221650111594, 19081.333576570563, 18421.71977873511, 19578.530224495502, 22429.791958083766, 18507.867379724892, 20441.851404589986, 19020.7520911249, 18727.21166296796, 20625.278561506788, 18831.649711380902, 18494.479629125537, 19578.9838132041, 18875.68959186012, 19356.47492704258, 20412.573593505327, 20538.197327571423, 18204.70448379274, 18880.36867608439, 18406.73144619166, 18685.130467903335], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 134, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [2941.0084452930846, 6645.200435853551, 6600.930616584502, 6780.644791942916, 8919.145404403585, 8427.246078107308, 4802.3820977648165, 5923.1728696456785, 5425.6218564777155, 8191.873565093858, 8865.950599038943, 4498.925586316013, 8729.702051430084, 7829.91353540373, 7674.0876498376, 7878.559033279879, 7550.367194878459, 4993.6171015567725, 7986.3477264540315, 7887.60159663135, 1578.5905495393254, 8749.19768313006, 4701.358865429748, 8831.884250957406, 7464.6605657495265, 10063.052248992935, 9392.62494235846, 9908.035177985292, 6733.871807589429, 3938.7029901278247, 7706.842710357995, 9232.076870489109, 5732.488846052177, 4740.298719937004, 9409.674542282635, 8932.228993867722, 6775.120596488451, 9418.417720440977, 6926.638628457446, 6745.857671254565, 7429.359444190906, 8884.731552841235, 4531.6522750831455, 13.936932368907666, 8127.84480214133, 5722.408071690132, 4762.580393856797, 8473.419258964452, 7618.989123391844, 7768.801418794765, 3193.8061776184495, 6898.528762756129, 9184.027863034864, 6743.171517445251, 7500.471786106083, 7616.748632084904, 6446.673393534109, 8037.692828303101, 6034.5106412683, 5707.2350307285715, 8859.34516023635, 6660.910523609633, 9382.163192808408, 7326.71205015244, 8518.783902853953, 8092.5113042689345, 567.8506441147513, 8309.387774685265, 6555.124115272624, 7408.258503840063, 8112.234422528734, 7640.451158225698, 7338.147009667068, 9089.65446290418, 5273.298434756837, 7691.738281917562, 8760.780550473304, 7866.244235503629, 8422.073947945451, 8530.227733311905, 8238.240663413624, 9147.40480125875, 7718.644439628335, 5356.672428327308, 9555.632320758445, 7268.263617348334, 8522.682334096935, 8482.332038416906, 7444.531468192765, 9143.09895989099, 9071.366396812526, 8042.1948185564615, 8187.253242032498, 8710.024919188178, 6771.39531848644, 6983.139402284302, 8492.940761332278, 8933.876321058615, 8187.445847931833, 9111.840471758445], "policy_adversary_policy_reward": [10882.250822242282, 11062.304574161502, 7188.59015225446, 7109.186373454413, 7334.825769386942, 7530.606966937728, 6809.655450432847, 7306.190076309815, 5217.491937760999, 4514.2701257505005, 4773.451218538464, 5714.889545623655, 8170.676512717258, 9279.631442834052, 6799.783129953398, 8218.94275608487, 6965.422596449784, 8716.440782012243, 4600.144537410949, 5853.996034304397, 5165.884366902332, 4933.554194949022, 9435.548927215077, 9267.68668094075, 5362.806252818833, 4802.648853575179, 6251.8925442224145, 6115.915524706647, 6419.757133211354, 6300.838945344136, 6263.576590451084, 5499.803190684255, 6560.806336931654, 6190.464148307253, 6996.310418441, 9148.518522174174, 4719.40385800565, 6152.157918079028, 6188.786551032984, 4622.707661058604, 6242.423326263522, 7896.640318360417, 4771.998653725218, 5388.304325418038, 9243.504877648737, 9357.068395248814, 4214.313172463904, 5308.109966199243, 6671.584571341868, 6123.188502590412, 3726.953324336256, 4072.4261716105716, 4713.462423605123, 4545.7735995507, 4077.6764955838435, 4211.068002227973, 7361.586310655703, 6385.2356943480445, 10203.432633603104, 9453.47882668444, 6152.0957989114, 5495.736537031647, 4359.640278464888, 4904.143000338033, 8409.187815055615, 7918.69899825094, 7833.5187587265245, 9401.836903793966, 4410.83835977981, 4704.7669872483275, 5085.016601680418, 4392.517905008038, 7195.496022652104, 6962.420350072802, 4718.250891775048, 4281.430572466444, 6647.442312880972, 7051.196443776087, 6560.1668625389075, 7373.2765656280635, 6467.102498387984, 5435.367966570155, 5249.101970858172, 4778.965846594737, 9230.645892969602, 9527.577730532917, 339.6164582243661, 225.19751857043897, 6003.380001567205, 5582.380611691708, 7670.6657558422785, 8415.351583847907, 7885.349725930115, 9379.037897514436, 5403.230910160492, 4803.875501109749, 6396.650615198068, 5928.254115201027, 5417.808738307316, 6308.9532495375925, 10680.680307974648, 10911.892001222832, 6910.504139216335, 7239.238801488067, 4928.608708776522, 4208.363666038941, 6401.751426820083, 7332.404097340613, 6328.367079746165, 6250.158737272501, 6468.794293640628, 5505.603748477552, 7484.93721278225, 7598.207875631651, 5948.291832844113, 5784.905390950154, 7333.773489568788, 7928.2207456137285, 7920.226819747619, 8118.051681572809, 5251.9913191279065, 4895.88752268507, 7432.123827996653, 7125.656609361911, 4453.844911846339, 4728.8647234017035, 6519.534088957956, 6784.427538544179, 5080.928060266721, 5598.613737735815, 6046.4541730753635, 5089.237950195631, 1836.3124119195102, 1362.446510248056, 5193.727094154855, 5771.622916601875, 7587.011508458355, 6444.739874665421, 6391.838149860841, 6721.484228653844, 5826.063713733729, 5887.252858796225, 6291.7747846826205, 5813.3458069385815, 6619.320106963907, 6759.040635033699, 4828.809482300061, 4822.224294678717, 8353.691967246632, 8763.8070337529, 6347.499215402621, 6095.081991844788, 5359.7777578742525, 5171.789804458255, 6148.307689053437, 5774.918612688931, 5595.399646937152, 5562.042604714676, 5500.466763016789, 4644.527153782944, 5797.369935631411, 5045.722977525576, 4281.8581452535755, 4992.456832222877, 6347.487806949616, 5512.397977917531, 8701.253138965689, 8371.866390790838, 4578.1192454834145, 4374.115813483129, 6770.682235766397, 6402.905551475269, 5573.585248200285, 4924.484508827714, 4756.624456121966, 5488.255168429135, 6554.515583468197, 6626.2315098457475, 4698.797990656375, 4989.752760833582, 5060.643094323102, 4362.470137990026, 5729.492895491695, 5807.296099155958, 4766.014074693483, 5922.422275134186, 5412.071659284724, 5234.378348569693, 7218.5031552365745, 6422.675119782335, 6627.286890679973, 6927.771034607161, 4223.529259784545, 5488.234462675973, 4788.442920674155, 5158.049434351732, 4376.932545492657, 5842.3530527672265, 4949.601346476219, 4623.688649668733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3990753125266413, "mean_inference_ms": 0.9931587442546576, "mean_action_processing_ms": 0.1679455235758395, "mean_env_wait_ms": 0.05427362121441186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035592317581176758, "StateBufferConnector_ms": 0.003702878952026367, "ViewRequirementAgentConnector_ms": 0.07538890838623047}, "num_episodes": 20, "episode_return_max": 24885.563841696843, "episode_return_min": 578.7509091637127, "episode_return_mean": 19642.22842946442}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.9712585542254, "num_env_steps_trained_throughput_per_sec": 552.9712585542254, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1692000, "timers": {"training_iteration_time_ms": 7339.366, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7339.332, "sample_time_ms": 805.409, "learn_time_ms": 6522.516, "learn_throughput": 613.26, "synch_weights_time_ms": 10.913}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "done": false, "training_iteration": 141, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-35", "timestamp": 1723236455, "time_this_iter_s": 7.239048004150391, "time_total_s": 1070.5124068260193, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3a3db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1070.5124068260193, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 24.580000000000002, "ram_util_percent": 82.28999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123362169797.48572, "cur_kl_coeff": 573115303386.1152, "cur_lr": 5.0000000000000016e-05, "total_loss": 26006653790.543915, "policy_loss": 0.04271949089782697, "vf_loss": 10.0, "vf_explained_var": -1.4042097424703932e-05, "kl": 0.045377696669665436, "entropy": 1.2561922624628379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8989456667099148, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.016699465115865, "policy_loss": 0.003951777455222327, "vf_loss": 9.994491503636043, "vf_explained_var": -0.00013686393698056538, "kl": 0.02251311740546953, "entropy": 1.2133611965924502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": 24786.378486816022, "episode_reward_min": 578.7509091637127, "episode_reward_mean": 19424.61703286535, "episode_len_mean": 194.15, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19415, "policy_reward_min": {"agent_policy": 13.936932368907666, "adversary_policy": 225.19751857043897}, "policy_reward_max": {"agent_policy": 10063.052248992935, "adversary_policy": 10911.892001222832}, "policy_reward_mean": {"agent_policy": 7325.068607769312, "adversary_policy": 6049.774212548027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15717.65419416326, 18909.500662273236, 23301.93213832716, 18354.30738962047, 20259.433639681745, 17862.431744939702, 18651.860965514305, 18196.779675797014, 20480.69381259321, 23595.614450415425, 19354.67504630103, 18495.860149291948, 22060.375659358797, 21975.65438245746, 18525.27988931085, 18409.763500556117, 20933.03696921341, 18418.099184682473, 20625.277385114437, 20679.301099421657, 19331.829909149055, 18912.799370294037, 23289.875898585622, 578.7509091637127, 19713.6054154002, 21808.42541138038, 22026.96801730122, 18680.525670234638, 19943.893853790938, 19495.56340663969, 24786.378486816022, 21048.271703460567, 18321.000237850338, 20477.327041605935, 20078.997603124797, 19591.146674203057, 21529.81848194801, 19770.890052097373, 21296.504876450876, 21745.513532049106, 19007.22400204926, 21218.690960968186, 18564.872828056436, 20630.673677654668, 19198.32570085646, 19228.20342753985, 3766.6095662823186, 19274.737785441972, 20586.87549839644, 20521.580882354796, 19825.550995058627, 19745.571749846855, 20716.50775166472, 18740.688239882933, 22390.797435756427, 20134.319489164962, 19292.348112805772, 19789.47053724601, 19579.51619959728, 18675.221650111594, 19081.333576570563, 18421.71977873511, 19578.530224495502, 22429.791958083766, 18507.867379724892, 20441.851404589986, 19020.7520911249, 18727.21166296796, 20625.278561506788, 18831.649711380902, 18494.479629125537, 19578.9838132041, 18875.68959186012, 19356.47492704258, 20412.573593505327, 20538.197327571423, 18204.70448379274, 18880.36867608439, 18406.73144619166, 18685.130467903335, 18569.731068314304, 20252.944290785694, 22155.857446020585, 4882.254101394404, 19868.882449919394, 18163.236676659002, 18118.227192830185, 21021.639424896075, 18814.91955248607, 20233.541092832296, 18962.295548156737, 19148.164767189217, 21013.32262910848, 18495.05143285712, 18175.63699784236, 21662.723059762266, 20870.959298226593, 24260.08872416124, 20442.799195963733, 22126.703050352968], "episode_lengths": [134, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [1578.5905495393254, 8749.19768313006, 4701.358865429748, 8831.884250957406, 7464.6605657495265, 10063.052248992935, 9392.62494235846, 9908.035177985292, 6733.871807589429, 3938.7029901278247, 7706.842710357995, 9232.076870489109, 5732.488846052177, 4740.298719937004, 9409.674542282635, 8932.228993867722, 6775.120596488451, 9418.417720440977, 6926.638628457446, 6745.857671254565, 7429.359444190906, 8884.731552841235, 4531.6522750831455, 13.936932368907666, 8127.84480214133, 5722.408071690132, 4762.580393856797, 8473.419258964452, 7618.989123391844, 7768.801418794765, 3193.8061776184495, 6898.528762756129, 9184.027863034864, 6743.171517445251, 7500.471786106083, 7616.748632084904, 6446.673393534109, 8037.692828303101, 6034.5106412683, 5707.2350307285715, 8859.34516023635, 6660.910523609633, 9382.163192808408, 7326.71205015244, 8518.783902853953, 8092.5113042689345, 567.8506441147513, 8309.387774685265, 6555.124115272624, 7408.258503840063, 8112.234422528734, 7640.451158225698, 7338.147009667068, 9089.65446290418, 5273.298434756837, 7691.738281917562, 8760.780550473304, 7866.244235503629, 8422.073947945451, 8530.227733311905, 8238.240663413624, 9147.40480125875, 7718.644439628335, 5356.672428327308, 9555.632320758445, 7268.263617348334, 8522.682334096935, 8482.332038416906, 7444.531468192765, 9143.09895989099, 9071.366396812526, 8042.1948185564615, 8187.253242032498, 8710.024919188178, 6771.39531848644, 6983.139402284302, 8492.940761332278, 8933.876321058615, 8187.445847931833, 9111.840471758445, 8636.11818016837, 7651.242107086543, 5459.92463641919, 552.3923493902474, 7817.757229097114, 8704.280046192087, 9805.75039584777, 6755.167078092428, 9139.554259305294, 7256.1475012346855, 7673.446995961231, 8750.963200868635, 6170.677628466942, 9116.547528381627, 8851.198283174414, 5741.25684528305, 7260.211646091206, 3256.2209666900453, 7031.118122139271, 5423.793509499037], "policy_adversary_policy_reward": [6242.423326263522, 7896.640318360417, 4771.998653725218, 5388.304325418038, 9243.504877648737, 9357.068395248814, 4214.313172463904, 5308.109966199243, 6671.584571341868, 6123.188502590412, 3726.953324336256, 4072.4261716105716, 4713.462423605123, 4545.7735995507, 4077.6764955838435, 4211.068002227973, 7361.586310655703, 6385.2356943480445, 10203.432633603104, 9453.47882668444, 6152.0957989114, 5495.736537031647, 4359.640278464888, 4904.143000338033, 8409.187815055615, 7918.69899825094, 7833.5187587265245, 9401.836903793966, 4410.83835977981, 4704.7669872483275, 5085.016601680418, 4392.517905008038, 7195.496022652104, 6962.420350072802, 4718.250891775048, 4281.430572466444, 6647.442312880972, 7051.196443776087, 6560.1668625389075, 7373.2765656280635, 6467.102498387984, 5435.367966570155, 5249.101970858172, 4778.965846594737, 9230.645892969602, 9527.577730532917, 339.6164582243661, 225.19751857043897, 6003.380001567205, 5582.380611691708, 7670.6657558422785, 8415.351583847907, 7885.349725930115, 9379.037897514436, 5403.230910160492, 4803.875501109749, 6396.650615198068, 5928.254115201027, 5417.808738307316, 6308.9532495375925, 10680.680307974648, 10911.892001222832, 6910.504139216335, 7239.238801488067, 4928.608708776522, 4208.363666038941, 6401.751426820083, 7332.404097340613, 6328.367079746165, 6250.158737272501, 6468.794293640628, 5505.603748477552, 7484.93721278225, 7598.207875631651, 5948.291832844113, 5784.905390950154, 7333.773489568788, 7928.2207456137285, 7920.226819747619, 8118.051681572809, 5251.9913191279065, 4895.88752268507, 7432.123827996653, 7125.656609361911, 4453.844911846339, 4728.8647234017035, 6519.534088957956, 6784.427538544179, 5080.928060266721, 5598.613737735815, 6046.4541730753635, 5089.237950195631, 1836.3124119195102, 1362.446510248056, 5193.727094154855, 5771.622916601875, 7587.011508458355, 6444.739874665421, 6391.838149860841, 6721.484228653844, 5826.063713733729, 5887.252858796225, 6291.7747846826205, 5813.3458069385815, 6619.320106963907, 6759.040635033699, 4828.809482300061, 4822.224294678717, 8353.691967246632, 8763.8070337529, 6347.499215402621, 6095.081991844788, 5359.7777578742525, 5171.789804458255, 6148.307689053437, 5774.918612688931, 5595.399646937152, 5562.042604714676, 5500.466763016789, 4644.527153782944, 5797.369935631411, 5045.722977525576, 4281.8581452535755, 4992.456832222877, 6347.487806949616, 5512.397977917531, 8701.253138965689, 8371.866390790838, 4578.1192454834145, 4374.115813483129, 6770.682235766397, 6402.905551475269, 5573.585248200285, 4924.484508827714, 4756.624456121966, 5488.255168429135, 6554.515583468197, 6626.2315098457475, 4698.797990656375, 4989.752760833582, 5060.643094323102, 4362.470137990026, 5729.492895491695, 5807.296099155958, 4766.014074693483, 5922.422275134186, 5412.071659284724, 5234.378348569693, 7218.5031552365745, 6422.675119782335, 6627.286890679973, 6927.771034607161, 4223.529259784545, 5488.234462675973, 4788.442920674155, 5158.049434351732, 4376.932545492657, 5842.3530527672265, 4949.601346476219, 4623.688649668733, 5501.258245878427, 4432.354642267613, 6186.529688836377, 6415.172494862793, 8487.172402331562, 8208.760407269914, 2417.456131593253, 1912.4056204109067, 5992.810710364388, 6058.31451045787, 4069.8325791894576, 5389.124051277518, 3980.624320159229, 4331.852476823209, 7023.014671578914, 7243.457675224689, 4988.693695156636, 4686.671598024166, 6839.998809726757, 6137.394781870845, 4945.781061920504, 6343.067490275017, 5010.7133560096045, 5386.488210311032, 7967.453745720994, 6875.191254920606, 5014.497692315449, 4364.006212160119, 5141.519187793961, 4182.91952687401, 8150.313301320352, 7771.152913158846, 6833.117397954911, 6777.630254180497, 10828.504110720973, 10175.363646750162, 6344.5986623367, 7067.08241148773, 8144.656062210878, 8558.253478643017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39938813909730597, "mean_inference_ms": 0.9936419533433539, "mean_action_processing_ms": 0.1680858879160299, "mean_env_wait_ms": 0.05431777799489706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560185432434082, "StateBufferConnector_ms": 0.00372469425201416, "ViewRequirementAgentConnector_ms": 0.07445681095123291}, "num_episodes": 20, "episode_return_max": 24786.378486816022, "episode_return_min": 578.7509091637127, "episode_return_mean": 19424.61703286535}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 556.0888626317769, "num_env_steps_trained_throughput_per_sec": 556.0888626317769, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 7334.018, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7333.985, "sample_time_ms": 804.246, "learn_time_ms": 6518.0, "learn_throughput": 613.685, "synch_weights_time_ms": 11.244}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 142, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-42", "timestamp": 1723236462, "time_this_iter_s": 7.198862075805664, "time_total_s": 1077.711268901825, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3a3dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1077.711268901825, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 24.936363636363634, "ram_util_percent": 82.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 203369884246.14603, "cur_kl_coeff": 859672955079.1727, "cur_lr": 5.0000000000000016e-05, "total_loss": 42708274123.4455, "policy_loss": 0.03884424392340912, "vf_loss": 10.0, "vf_explained_var": 1.0176625832048044e-05, "kl": 0.049679677413589265, "entropy": 1.270781958923138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8697886803497871, "cur_kl_coeff": 1.2163719177246093, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.023192962010702, "policy_loss": -0.001438177693732238, "vf_loss": 10.0, "vf_explained_var": -0.0005239962289730707, "kl": 0.02024971130595077, "entropy": 1.256714814528823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "env_runners": {"episode_reward_max": 26059.69099245987, "episode_reward_min": 578.7509091637127, "episode_reward_mean": 19731.63244138221, "episode_len_mean": 194.81, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19481, "policy_reward_min": {"agent_policy": 13.936932368907666, "adversary_policy": 225.19751857043897}, "policy_reward_max": {"agent_policy": 9805.75039584777, "adversary_policy": 12340.615965002875}, "policy_reward_mean": {"agent_policy": 7152.838468422437, "adversary_policy": 6289.396986479895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19331.829909149055, 18912.799370294037, 23289.875898585622, 578.7509091637127, 19713.6054154002, 21808.42541138038, 22026.96801730122, 18680.525670234638, 19943.893853790938, 19495.56340663969, 24786.378486816022, 21048.271703460567, 18321.000237850338, 20477.327041605935, 20078.997603124797, 19591.146674203057, 21529.81848194801, 19770.890052097373, 21296.504876450876, 21745.513532049106, 19007.22400204926, 21218.690960968186, 18564.872828056436, 20630.673677654668, 19198.32570085646, 19228.20342753985, 3766.6095662823186, 19274.737785441972, 20586.87549839644, 20521.580882354796, 19825.550995058627, 19745.571749846855, 20716.50775166472, 18740.688239882933, 22390.797435756427, 20134.319489164962, 19292.348112805772, 19789.47053724601, 19579.51619959728, 18675.221650111594, 19081.333576570563, 18421.71977873511, 19578.530224495502, 22429.791958083766, 18507.867379724892, 20441.851404589986, 19020.7520911249, 18727.21166296796, 20625.278561506788, 18831.649711380902, 18494.479629125537, 19578.9838132041, 18875.68959186012, 19356.47492704258, 20412.573593505327, 20538.197327571423, 18204.70448379274, 18880.36867608439, 18406.73144619166, 18685.130467903335, 18569.731068314304, 20252.944290785694, 22155.857446020585, 4882.254101394404, 19868.882449919394, 18163.236676659002, 18118.227192830185, 21021.639424896075, 18814.91955248607, 20233.541092832296, 18962.295548156737, 19148.164767189217, 21013.32262910848, 18495.05143285712, 18175.63699784236, 21662.723059762266, 20870.959298226593, 24260.08872416124, 20442.799195963733, 22126.703050352968, 19133.01258303324, 20475.209459980524, 20762.272640385378, 24394.132109261245, 18871.057314214126, 19942.957527224877, 20671.188840256462, 20888.80287823584, 24269.222023810467, 19007.80597460571, 26059.69099245987, 22039.1974429307, 18943.748676232495, 23699.125026576006, 23934.906252221208, 23704.985254027844, 20125.833742675954, 21516.628664140673, 18226.052950389287, 18843.242438057987], "episode_lengths": [200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7429.359444190906, 8884.731552841235, 4531.6522750831455, 13.936932368907666, 8127.84480214133, 5722.408071690132, 4762.580393856797, 8473.419258964452, 7618.989123391844, 7768.801418794765, 3193.8061776184495, 6898.528762756129, 9184.027863034864, 6743.171517445251, 7500.471786106083, 7616.748632084904, 6446.673393534109, 8037.692828303101, 6034.5106412683, 5707.2350307285715, 8859.34516023635, 6660.910523609633, 9382.163192808408, 7326.71205015244, 8518.783902853953, 8092.5113042689345, 567.8506441147513, 8309.387774685265, 6555.124115272624, 7408.258503840063, 8112.234422528734, 7640.451158225698, 7338.147009667068, 9089.65446290418, 5273.298434756837, 7691.738281917562, 8760.780550473304, 7866.244235503629, 8422.073947945451, 8530.227733311905, 8238.240663413624, 9147.40480125875, 7718.644439628335, 5356.672428327308, 9555.632320758445, 7268.263617348334, 8522.682334096935, 8482.332038416906, 7444.531468192765, 9143.09895989099, 9071.366396812526, 8042.1948185564615, 8187.253242032498, 8710.024919188178, 6771.39531848644, 6983.139402284302, 8492.940761332278, 8933.876321058615, 8187.445847931833, 9111.840471758445, 8636.11818016837, 7651.242107086543, 5459.92463641919, 552.3923493902474, 7817.757229097114, 8704.280046192087, 9805.75039584777, 6755.167078092428, 9139.554259305294, 7256.1475012346855, 7673.446995961231, 8750.963200868635, 6170.677628466942, 9116.547528381627, 8851.198283174414, 5741.25684528305, 7260.211646091206, 3256.2209666900453, 7031.118122139271, 5423.793509499037, 8838.848061426936, 7419.645205202548, 7307.500948042494, 2896.10446664513, 8978.991490897186, 7380.1636016442935, 7168.432603027985, 6969.2553971421385, 3761.51787286061, 8685.083920550993, 1733.7671971916775, 5786.1887409637075, 8855.855435059422, 4107.469518977239, 3584.4541511193834, 4037.1890608027024, 7785.098140032174, 6237.863967471797, 9390.57758582163, 8834.60308192054], "policy_adversary_policy_reward": [6467.102498387984, 5435.367966570155, 5249.101970858172, 4778.965846594737, 9230.645892969602, 9527.577730532917, 339.6164582243661, 225.19751857043897, 6003.380001567205, 5582.380611691708, 7670.6657558422785, 8415.351583847907, 7885.349725930115, 9379.037897514436, 5403.230910160492, 4803.875501109749, 6396.650615198068, 5928.254115201027, 5417.808738307316, 6308.9532495375925, 10680.680307974648, 10911.892001222832, 6910.504139216335, 7239.238801488067, 4928.608708776522, 4208.363666038941, 6401.751426820083, 7332.404097340613, 6328.367079746165, 6250.158737272501, 6468.794293640628, 5505.603748477552, 7484.93721278225, 7598.207875631651, 5948.291832844113, 5784.905390950154, 7333.773489568788, 7928.2207456137285, 7920.226819747619, 8118.051681572809, 5251.9913191279065, 4895.88752268507, 7432.123827996653, 7125.656609361911, 4453.844911846339, 4728.8647234017035, 6519.534088957956, 6784.427538544179, 5080.928060266721, 5598.613737735815, 6046.4541730753635, 5089.237950195631, 1836.3124119195102, 1362.446510248056, 5193.727094154855, 5771.622916601875, 7587.011508458355, 6444.739874665421, 6391.838149860841, 6721.484228653844, 5826.063713733729, 5887.252858796225, 6291.7747846826205, 5813.3458069385815, 6619.320106963907, 6759.040635033699, 4828.809482300061, 4822.224294678717, 8353.691967246632, 8763.8070337529, 6347.499215402621, 6095.081991844788, 5359.7777578742525, 5171.789804458255, 6148.307689053437, 5774.918612688931, 5595.399646937152, 5562.042604714676, 5500.466763016789, 4644.527153782944, 5797.369935631411, 5045.722977525576, 4281.8581452535755, 4992.456832222877, 6347.487806949616, 5512.397977917531, 8701.253138965689, 8371.866390790838, 4578.1192454834145, 4374.115813483129, 6770.682235766397, 6402.905551475269, 5573.585248200285, 4924.484508827714, 4756.624456121966, 5488.255168429135, 6554.515583468197, 6626.2315098457475, 4698.797990656375, 4989.752760833582, 5060.643094323102, 4362.470137990026, 5729.492895491695, 5807.296099155958, 4766.014074693483, 5922.422275134186, 5412.071659284724, 5234.378348569693, 7218.5031552365745, 6422.675119782335, 6627.286890679973, 6927.771034607161, 4223.529259784545, 5488.234462675973, 4788.442920674155, 5158.049434351732, 4376.932545492657, 5842.3530527672265, 4949.601346476219, 4623.688649668733, 5501.258245878427, 4432.354642267613, 6186.529688836377, 6415.172494862793, 8487.172402331562, 8208.760407269914, 2417.456131593253, 1912.4056204109067, 5992.810710364388, 6058.31451045787, 4069.8325791894576, 5389.124051277518, 3980.624320159229, 4331.852476823209, 7023.014671578914, 7243.457675224689, 4988.693695156636, 4686.671598024166, 6839.998809726757, 6137.394781870845, 4945.781061920504, 6343.067490275017, 5010.7133560096045, 5386.488210311032, 7967.453745720994, 6875.191254920606, 5014.497692315449, 4364.006212160119, 5141.519187793961, 4182.91952687401, 8150.313301320352, 7771.152913158846, 6833.117397954911, 6777.630254180497, 10828.504110720973, 10175.363646750162, 6344.5986623367, 7067.08241148773, 8144.656062210878, 8558.253478643017, 5214.578379566623, 5079.586142039705, 6381.786149481882, 6673.77810529614, 6623.65431998157, 6831.117372361231, 11244.903348831092, 10253.124293785027, 5061.8664630508165, 4830.1993602661605, 5899.434423139435, 6663.359502441179, 6788.3583654121485, 6714.397871816306, 7036.445599166851, 6883.101881926869, 10273.858985192166, 10233.845165757628, 5065.183110571731, 5257.538943483027, 11985.307830265212, 12340.615965002875, 8183.722090223866, 8069.286611743173, 5045.679541255413, 5042.213699917667, 9610.852289576367, 9980.803218022373, 10121.220986230319, 10229.23111487158, 9972.317983589073, 9695.47820963617, 6086.686950847787, 6254.04865179595, 7778.5043649949575, 7500.26033167396, 4599.446483395162, 4236.028881172433, 5303.737346038477, 4704.902010098957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996700809393458, "mean_inference_ms": 0.9942189738148909, "mean_action_processing_ms": 0.1681879405448334, "mean_env_wait_ms": 0.0543942446024451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003563404083251953, "StateBufferConnector_ms": 0.003728032112121582, "ViewRequirementAgentConnector_ms": 0.0751500129699707}, "num_episodes": 20, "episode_return_max": 26059.69099245987, "episode_return_min": 578.7509091637127, "episode_return_mean": 19731.63244138221}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.493993774549, "num_env_steps_trained_throughput_per_sec": 545.493993774549, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 7350.585, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7350.552, "sample_time_ms": 800.022, "learn_time_ms": 6538.622, "learn_throughput": 611.75, "synch_weights_time_ms": 11.35}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "training_iteration": 143, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-50", "timestamp": 1723236470, "time_this_iter_s": 7.337187051773071, "time_total_s": 1085.048455953598, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b25f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1085.048455953598, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 82.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225879994250.97144, "cur_kl_coeff": 1289509432618.7595, "cur_lr": 5.0000000000000016e-05, "total_loss": 42424275447.87302, "policy_loss": 0.027803710081846154, "vf_loss": 10.0, "vf_explained_var": 4.3939534949247166e-05, "kl": 0.03289954716477681, "entropy": 1.2793996863264256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9398293503249685, "cur_kl_coeff": 1.8245578765869146, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.013263570268949, "policy_loss": 0.0024290187158233795, "vf_loss": 9.995086920261382, "vf_explained_var": -0.0003119040280580521, "kl": 0.008630950472919115, "entropy": 1.280978661775589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 26059.69099245987, "episode_reward_min": 559.1884027663241, "episode_reward_mean": 19812.614103202275, "episode_len_mean": 194.81, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19481, "policy_reward_min": {"agent_policy": 13.887432678063094, "adversary_policy": 205.63501217305026}, "policy_reward_max": {"agent_policy": 9805.75039584777, "adversary_policy": 12340.615965002875}, "policy_reward_mean": {"agent_policy": 7028.760034165943, "adversary_policy": 6391.927034518174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18564.872828056436, 20630.673677654668, 19198.32570085646, 19228.20342753985, 3766.6095662823186, 19274.737785441972, 20586.87549839644, 20521.580882354796, 19825.550995058627, 19745.571749846855, 20716.50775166472, 18740.688239882933, 22390.797435756427, 20134.319489164962, 19292.348112805772, 19789.47053724601, 19579.51619959728, 18675.221650111594, 19081.333576570563, 18421.71977873511, 19578.530224495502, 22429.791958083766, 18507.867379724892, 20441.851404589986, 19020.7520911249, 18727.21166296796, 20625.278561506788, 18831.649711380902, 18494.479629125537, 19578.9838132041, 18875.68959186012, 19356.47492704258, 20412.573593505327, 20538.197327571423, 18204.70448379274, 18880.36867608439, 18406.73144619166, 18685.130467903335, 18569.731068314304, 20252.944290785694, 22155.857446020585, 4882.254101394404, 19868.882449919394, 18163.236676659002, 18118.227192830185, 21021.639424896075, 18814.91955248607, 20233.541092832296, 18962.295548156737, 19148.164767189217, 21013.32262910848, 18495.05143285712, 18175.63699784236, 21662.723059762266, 20870.959298226593, 24260.08872416124, 20442.799195963733, 22126.703050352968, 19133.01258303324, 20475.209459980524, 20762.272640385378, 24394.132109261245, 18871.057314214126, 19942.957527224877, 20671.188840256462, 20888.80287823584, 24269.222023810467, 19007.80597460571, 26059.69099245987, 22039.1974429307, 18943.748676232495, 23699.125026576006, 23934.906252221208, 23704.985254027844, 20125.833742675954, 21516.628664140673, 18226.052950389287, 18843.242438057987, 18950.32362908236, 20655.26943286864, 19471.561519135965, 21031.693823157562, 20161.796719842077, 19014.886029297024, 20762.89982071927, 22904.90829142565, 21434.028226743376, 21249.5795754223, 23444.60924587859, 19133.0424311157, 18799.62629321148, 23909.294786555434, 20138.905861607014, 20402.930302842076, 24055.210379133645, 22999.475929610893, 22331.71329658692, 21316.58768297592, 18024.636016590994, 559.1884027663241], "episode_lengths": [200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5], "policy_agent_policy_reward": [9382.163192808408, 7326.71205015244, 8518.783902853953, 8092.5113042689345, 567.8506441147513, 8309.387774685265, 6555.124115272624, 7408.258503840063, 8112.234422528734, 7640.451158225698, 7338.147009667068, 9089.65446290418, 5273.298434756837, 7691.738281917562, 8760.780550473304, 7866.244235503629, 8422.073947945451, 8530.227733311905, 8238.240663413624, 9147.40480125875, 7718.644439628335, 5356.672428327308, 9555.632320758445, 7268.263617348334, 8522.682334096935, 8482.332038416906, 7444.531468192765, 9143.09895989099, 9071.366396812526, 8042.1948185564615, 8187.253242032498, 8710.024919188178, 6771.39531848644, 6983.139402284302, 8492.940761332278, 8933.876321058615, 8187.445847931833, 9111.840471758445, 8636.11818016837, 7651.242107086543, 5459.92463641919, 552.3923493902474, 7817.757229097114, 8704.280046192087, 9805.75039584777, 6755.167078092428, 9139.554259305294, 7256.1475012346855, 7673.446995961231, 8750.963200868635, 6170.677628466942, 9116.547528381627, 8851.198283174414, 5741.25684528305, 7260.211646091206, 3256.2209666900453, 7031.118122139271, 5423.793509499037, 8838.848061426936, 7419.645205202548, 7307.500948042494, 2896.10446664513, 8978.991490897186, 7380.1636016442935, 7168.432603027985, 6969.2553971421385, 3761.51787286061, 8685.083920550993, 1733.7671971916775, 5786.1887409637075, 8855.855435059422, 4107.469518977239, 3584.4541511193834, 4037.1890608027024, 7785.098140032174, 6237.863967471797, 9390.57758582163, 8834.60308192054, 7972.487845141528, 6857.96938772882, 8342.25896362415, 6890.570221196775, 7669.612672047731, 8249.559850946513, 5518.429931231769, 5158.504447141943, 6203.089430458255, 5577.840204497651, 2629.3267067833276, 8716.333009538084, 8015.057672596302, 3718.826867226235, 7541.256761684867, 7188.590956435733, 3707.15476882268, 4111.683245816022, 4422.283684969141, 6427.976964357402, 8876.301139476545, 13.887432678063094], "policy_adversary_policy_reward": [4453.844911846339, 4728.8647234017035, 6519.534088957956, 6784.427538544179, 5080.928060266721, 5598.613737735815, 6046.4541730753635, 5089.237950195631, 1836.3124119195102, 1362.446510248056, 5193.727094154855, 5771.622916601875, 7587.011508458355, 6444.739874665421, 6391.838149860841, 6721.484228653844, 5826.063713733729, 5887.252858796225, 6291.7747846826205, 5813.3458069385815, 6619.320106963907, 6759.040635033699, 4828.809482300061, 4822.224294678717, 8353.691967246632, 8763.8070337529, 6347.499215402621, 6095.081991844788, 5359.7777578742525, 5171.789804458255, 6148.307689053437, 5774.918612688931, 5595.399646937152, 5562.042604714676, 5500.466763016789, 4644.527153782944, 5797.369935631411, 5045.722977525576, 4281.8581452535755, 4992.456832222877, 6347.487806949616, 5512.397977917531, 8701.253138965689, 8371.866390790838, 4578.1192454834145, 4374.115813483129, 6770.682235766397, 6402.905551475269, 5573.585248200285, 4924.484508827714, 4756.624456121966, 5488.255168429135, 6554.515583468197, 6626.2315098457475, 4698.797990656375, 4989.752760833582, 5060.643094323102, 4362.470137990026, 5729.492895491695, 5807.296099155958, 4766.014074693483, 5922.422275134186, 5412.071659284724, 5234.378348569693, 7218.5031552365745, 6422.675119782335, 6627.286890679973, 6927.771034607161, 4223.529259784545, 5488.234462675973, 4788.442920674155, 5158.049434351732, 4376.932545492657, 5842.3530527672265, 4949.601346476219, 4623.688649668733, 5501.258245878427, 4432.354642267613, 6186.529688836377, 6415.172494862793, 8487.172402331562, 8208.760407269914, 2417.456131593253, 1912.4056204109067, 5992.810710364388, 6058.31451045787, 4069.8325791894576, 5389.124051277518, 3980.624320159229, 4331.852476823209, 7023.014671578914, 7243.457675224689, 4988.693695156636, 4686.671598024166, 6839.998809726757, 6137.394781870845, 4945.781061920504, 6343.067490275017, 5010.7133560096045, 5386.488210311032, 7967.453745720994, 6875.191254920606, 5014.497692315449, 4364.006212160119, 5141.519187793961, 4182.91952687401, 8150.313301320352, 7771.152913158846, 6833.117397954911, 6777.630254180497, 10828.504110720973, 10175.363646750162, 6344.5986623367, 7067.08241148773, 8144.656062210878, 8558.253478643017, 5214.578379566623, 5079.586142039705, 6381.786149481882, 6673.77810529614, 6623.65431998157, 6831.117372361231, 11244.903348831092, 10253.124293785027, 5061.8664630508165, 4830.1993602661605, 5899.434423139435, 6663.359502441179, 6788.3583654121485, 6714.397871816306, 7036.445599166851, 6883.101881926869, 10273.858985192166, 10233.845165757628, 5065.183110571731, 5257.538943483027, 11985.307830265212, 12340.615965002875, 8183.722090223866, 8069.286611743173, 5045.679541255413, 5042.213699917667, 9610.852289576367, 9980.803218022373, 10121.220986230319, 10229.23111487158, 9972.317983589073, 9695.47820963617, 6086.686950847787, 6254.04865179595, 7778.5043649949575, 7500.26033167396, 4599.446483395162, 4236.028881172433, 5303.737346038477, 4704.902010098957, 4845.77511234391, 6132.060671596918, 6529.324697240769, 7267.975347899093, 5338.161107281763, 5791.14144823006, 7179.540456055988, 6961.583145904813, 6131.636055940604, 6360.547991853788, 4886.352356629125, 5878.973821721379, 6620.764196988286, 8623.705692499174, 8890.745515000419, 8855.658329283178, 7342.124717677445, 7888.814078607653, 8560.778209121896, 7110.961161802779, 9303.774881740996, 11511.507657354303, 5025.812484292012, 5390.8969372856445, 5813.939050484401, 4970.629570130847, 10418.574554940727, 9771.893364388383, 6455.116373589029, 6142.5327263330755, 6368.3887380526685, 6845.950608353683, 9967.564419572787, 10380.491190738196, 8857.656333489516, 10030.136350305413, 8300.01706490959, 9609.412546708198, 7182.447379373805, 7706.16333924471, 4124.2331898050215, 5024.101687309438, 205.63501217305026, 339.6659579152107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399572716768079, "mean_inference_ms": 0.9941112972331855, "mean_action_processing_ms": 0.16811628452449467, "mean_env_wait_ms": 0.05439379731022132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350344181060791, "StateBufferConnector_ms": 0.0026111602783203125, "ViewRequirementAgentConnector_ms": 0.06866645812988281}, "num_episodes": 22, "episode_return_max": 26059.69099245987, "episode_return_min": 559.1884027663241, "episode_return_mean": 19812.614103202275}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 556.4442525789899, "num_env_steps_trained_throughput_per_sec": 556.4442525789899, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 7337.867, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7337.833, "sample_time_ms": 798.134, "learn_time_ms": 6527.822, "learn_throughput": 612.762, "synch_weights_time_ms": 11.314}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 144, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-47-57", "timestamp": 1723236477, "time_this_iter_s": 7.193840265274048, "time_total_s": 1092.242296218872, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3a3df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1092.242296218872, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 23.91818181818182, "ram_util_percent": 82.49090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 399186701930.7344, "cur_kl_coeff": 1934264148928.1396, "cur_lr": 5.0000000000000016e-05, "total_loss": 62778036838.4, "policy_loss": 0.026564894840318376, "vf_loss": 10.0, "vf_explained_var": 2.9746943680697647e-05, "kl": 0.03245577299770303, "entropy": 1.2852495559939632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9351113916374743, "cur_kl_coeff": 1.8245578765869146, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003457741936048, "policy_loss": 0.0009338077220794124, "vf_loss": 9.993881204724312, "vf_explained_var": -0.0003336142748594284, "kl": 0.004736907344825643, "entropy": 1.2714719920108715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "env_runners": {"episode_reward_max": 26059.69099245987, "episode_reward_min": 559.1884027663241, "episode_reward_mean": 20063.645606798567, "episode_len_mean": 194.95, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19495, "policy_reward_min": {"agent_policy": 13.887432678063094, "adversary_policy": 205.63501217305026}, "policy_reward_max": {"agent_policy": 9805.75039584777, "adversary_policy": 12340.615965002875}, "policy_reward_mean": {"agent_policy": 6730.250169825399, "adversary_policy": 6666.69771848659}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22429.791958083766, 18507.867379724892, 20441.851404589986, 19020.7520911249, 18727.21166296796, 20625.278561506788, 18831.649711380902, 18494.479629125537, 19578.9838132041, 18875.68959186012, 19356.47492704258, 20412.573593505327, 20538.197327571423, 18204.70448379274, 18880.36867608439, 18406.73144619166, 18685.130467903335, 18569.731068314304, 20252.944290785694, 22155.857446020585, 4882.254101394404, 19868.882449919394, 18163.236676659002, 18118.227192830185, 21021.639424896075, 18814.91955248607, 20233.541092832296, 18962.295548156737, 19148.164767189217, 21013.32262910848, 18495.05143285712, 18175.63699784236, 21662.723059762266, 20870.959298226593, 24260.08872416124, 20442.799195963733, 22126.703050352968, 19133.01258303324, 20475.209459980524, 20762.272640385378, 24394.132109261245, 18871.057314214126, 19942.957527224877, 20671.188840256462, 20888.80287823584, 24269.222023810467, 19007.80597460571, 26059.69099245987, 22039.1974429307, 18943.748676232495, 23699.125026576006, 23934.906252221208, 23704.985254027844, 20125.833742675954, 21516.628664140673, 18226.052950389287, 18843.242438057987, 18950.32362908236, 20655.26943286864, 19471.561519135965, 21031.693823157562, 20161.796719842077, 19014.886029297024, 20762.89982071927, 22904.90829142565, 21434.028226743376, 21249.5795754223, 23444.60924587859, 19133.0424311157, 18799.62629321148, 23909.294786555434, 20138.905861607014, 20402.930302842076, 24055.210379133645, 22999.475929610893, 22331.71329658692, 21316.58768297592, 18024.636016590994, 559.1884027663241, 20400.931698421122, 24194.260569189322, 21030.05903005153, 19292.52283559857, 22378.66788148961, 5480.629287768185, 19842.498158161263, 22558.048774038445, 21313.80335449419, 21182.75926899391, 24050.11422884223, 18860.526051438897, 21910.73767425522, 23661.735829775087, 18646.540588496555, 18375.57346186237, 18095.13803081987, 17846.33793783079, 23092.81025560639, 20328.906718770864, 20304.00383124418], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5356.672428327308, 9555.632320758445, 7268.263617348334, 8522.682334096935, 8482.332038416906, 7444.531468192765, 9143.09895989099, 9071.366396812526, 8042.1948185564615, 8187.253242032498, 8710.024919188178, 6771.39531848644, 6983.139402284302, 8492.940761332278, 8933.876321058615, 8187.445847931833, 9111.840471758445, 8636.11818016837, 7651.242107086543, 5459.92463641919, 552.3923493902474, 7817.757229097114, 8704.280046192087, 9805.75039584777, 6755.167078092428, 9139.554259305294, 7256.1475012346855, 7673.446995961231, 8750.963200868635, 6170.677628466942, 9116.547528381627, 8851.198283174414, 5741.25684528305, 7260.211646091206, 3256.2209666900453, 7031.118122139271, 5423.793509499037, 8838.848061426936, 7419.645205202548, 7307.500948042494, 2896.10446664513, 8978.991490897186, 7380.1636016442935, 7168.432603027985, 6969.2553971421385, 3761.51787286061, 8685.083920550993, 1733.7671971916775, 5786.1887409637075, 8855.855435059422, 4107.469518977239, 3584.4541511193834, 4037.1890608027024, 7785.098140032174, 6237.863967471797, 9390.57758582163, 8834.60308192054, 7972.487845141528, 6857.96938772882, 8342.25896362415, 6890.570221196775, 7669.612672047731, 8249.559850946513, 5518.429931231769, 5158.504447141943, 6203.089430458255, 5577.840204497651, 2629.3267067833276, 8716.333009538084, 8015.057672596302, 3718.826867226235, 7541.256761684867, 7188.590956435733, 3707.15476882268, 4111.683245816022, 4422.283684969141, 6427.976964357402, 8876.301139476545, 13.887432678063094, 7643.320083151937, 3169.753752225507, 6377.542044654387, 8644.759377232087, 4604.202084905817, 932.5095723693103, 8074.230939758611, 5055.524819855575, 6030.867598219724, 5938.100448257122, 3566.5494508537827, 8651.663339183937, 4675.4108456737, 3743.7000373733204, 7871.461710869088, 8637.705373314582, 9439.549958222173, 9330.24696491367, 4307.192049976823, 6917.127477788397, 6527.527266677766], "policy_adversary_policy_reward": [8701.253138965689, 8371.866390790838, 4578.1192454834145, 4374.115813483129, 6770.682235766397, 6402.905551475269, 5573.585248200285, 4924.484508827714, 4756.624456121966, 5488.255168429135, 6554.515583468197, 6626.2315098457475, 4698.797990656375, 4989.752760833582, 5060.643094323102, 4362.470137990026, 5729.492895491695, 5807.296099155958, 4766.014074693483, 5922.422275134186, 5412.071659284724, 5234.378348569693, 7218.5031552365745, 6422.675119782335, 6627.286890679973, 6927.771034607161, 4223.529259784545, 5488.234462675973, 4788.442920674155, 5158.049434351732, 4376.932545492657, 5842.3530527672265, 4949.601346476219, 4623.688649668733, 5501.258245878427, 4432.354642267613, 6186.529688836377, 6415.172494862793, 8487.172402331562, 8208.760407269914, 2417.456131593253, 1912.4056204109067, 5992.810710364388, 6058.31451045787, 4069.8325791894576, 5389.124051277518, 3980.624320159229, 4331.852476823209, 7023.014671578914, 7243.457675224689, 4988.693695156636, 4686.671598024166, 6839.998809726757, 6137.394781870845, 4945.781061920504, 6343.067490275017, 5010.7133560096045, 5386.488210311032, 7967.453745720994, 6875.191254920606, 5014.497692315449, 4364.006212160119, 5141.519187793961, 4182.91952687401, 8150.313301320352, 7771.152913158846, 6833.117397954911, 6777.630254180497, 10828.504110720973, 10175.363646750162, 6344.5986623367, 7067.08241148773, 8144.656062210878, 8558.253478643017, 5214.578379566623, 5079.586142039705, 6381.786149481882, 6673.77810529614, 6623.65431998157, 6831.117372361231, 11244.903348831092, 10253.124293785027, 5061.8664630508165, 4830.1993602661605, 5899.434423139435, 6663.359502441179, 6788.3583654121485, 6714.397871816306, 7036.445599166851, 6883.101881926869, 10273.858985192166, 10233.845165757628, 5065.183110571731, 5257.538943483027, 11985.307830265212, 12340.615965002875, 8183.722090223866, 8069.286611743173, 5045.679541255413, 5042.213699917667, 9610.852289576367, 9980.803218022373, 10121.220986230319, 10229.23111487158, 9972.317983589073, 9695.47820963617, 6086.686950847787, 6254.04865179595, 7778.5043649949575, 7500.26033167396, 4599.446483395162, 4236.028881172433, 5303.737346038477, 4704.902010098957, 4845.77511234391, 6132.060671596918, 6529.324697240769, 7267.975347899093, 5338.161107281763, 5791.14144823006, 7179.540456055988, 6961.583145904813, 6131.636055940604, 6360.547991853788, 4886.352356629125, 5878.973821721379, 6620.764196988286, 8623.705692499174, 8890.745515000419, 8855.658329283178, 7342.124717677445, 7888.814078607653, 8560.778209121896, 7110.961161802779, 9303.774881740996, 11511.507657354303, 5025.812484292012, 5390.8969372856445, 5813.939050484401, 4970.629570130847, 10418.574554940727, 9771.893364388383, 6455.116373589029, 6142.5327263330755, 6368.3887380526685, 6845.950608353683, 9967.564419572787, 10380.491190738196, 8857.656333489516, 10030.136350305413, 8300.01706490959, 9609.412546708198, 7182.447379373805, 7706.16333924471, 4124.2331898050215, 5024.101687309438, 205.63501217305026, 339.6659579152107, 6280.068286095811, 6477.543329173313, 10619.727483046796, 10404.779333917066, 7071.531086952134, 7580.985898445014, 5206.094491317747, 5441.668967048732, 9485.998333610707, 8288.467462973102, 2294.285076646512, 2253.8346387523657, 5990.049285399204, 5778.217933003412, 9086.026927782805, 8416.497026400133, 7892.645049979642, 7390.29070629477, 7863.020372113634, 7381.638448623164, 10313.636743422087, 10169.928034566297, 4856.095429463503, 5352.767282791534, 9466.541683028914, 7768.785145552566, 9950.193491850936, 9967.842300550787, 4639.875501999823, 6135.203375627634, 4243.856290475655, 5494.011798072148, 3953.6791149227593, 4701.908957674976, 3797.0912543752784, 4718.999718541873, 9360.119054353887, 9425.499151275639, 6186.7710950399505, 7225.008145942554, 7568.059440025616, 6208.417124540825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39952489240248035, "mean_inference_ms": 0.9935844386927002, "mean_action_processing_ms": 0.16814009644264089, "mean_env_wait_ms": 0.05434201212530155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032050609588623047, "StateBufferConnector_ms": 0.0024946928024291992, "ViewRequirementAgentConnector_ms": 0.06713485717773438}, "num_episodes": 21, "episode_return_max": 26059.69099245987, "episode_return_min": 559.1884027663241, "episode_return_mean": 20063.645606798567}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.3745323589452, "num_env_steps_trained_throughput_per_sec": 551.3745323589452, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1740000, "timers": {"training_iteration_time_ms": 7356.759, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7356.725, "sample_time_ms": 790.951, "learn_time_ms": 6554.246, "learn_throughput": 610.291, "synch_weights_time_ms": 11.007}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "done": false, "training_iteration": 145, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-48-05", "timestamp": 1723236485, "time_this_iter_s": 7.2590651512146, "time_total_s": 1099.5013613700867, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1099.5013613700867, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 24.599999999999998, "ram_util_percent": 82.21000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 442104171659.7841, "cur_kl_coeff": 2901396223392.2085, "cur_lr": 5.0000000000000016e-05, "total_loss": 67971450715.29312, "policy_loss": 0.019801310101208627, "vf_loss": 10.0, "vf_explained_var": -9.290598056934498e-05, "kl": 0.023427152661015353, "entropy": 1.287178635408008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9382093866510938, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99495172003905, "policy_loss": -0.0049513145442081925, "vf_loss": 9.994146052996317, "vf_explained_var": -0.0003383657584587733, "kl": 0.00631052184762666, "entropy": 1.2640341052164634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": 26059.69099245987, "episode_reward_min": 307.9731448358136, "episode_reward_mean": 20112.23718567125, "episode_len_mean": 194.56, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19456, "policy_reward_min": {"agent_policy": 3.8901474233138362, "adversary_policy": 95.8411104798494}, "policy_reward_max": {"agent_policy": 10065.285365476228, "adversary_policy": 12340.615965002875}, "policy_reward_mean": {"agent_policy": 6561.491479842699, "adversary_policy": 6775.372852914277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19868.882449919394, 18163.236676659002, 18118.227192830185, 21021.639424896075, 18814.91955248607, 20233.541092832296, 18962.295548156737, 19148.164767189217, 21013.32262910848, 18495.05143285712, 18175.63699784236, 21662.723059762266, 20870.959298226593, 24260.08872416124, 20442.799195963733, 22126.703050352968, 19133.01258303324, 20475.209459980524, 20762.272640385378, 24394.132109261245, 18871.057314214126, 19942.957527224877, 20671.188840256462, 20888.80287823584, 24269.222023810467, 19007.80597460571, 26059.69099245987, 22039.1974429307, 18943.748676232495, 23699.125026576006, 23934.906252221208, 23704.985254027844, 20125.833742675954, 21516.628664140673, 18226.052950389287, 18843.242438057987, 18950.32362908236, 20655.26943286864, 19471.561519135965, 21031.693823157562, 20161.796719842077, 19014.886029297024, 20762.89982071927, 22904.90829142565, 21434.028226743376, 21249.5795754223, 23444.60924587859, 19133.0424311157, 18799.62629321148, 23909.294786555434, 20138.905861607014, 20402.930302842076, 24055.210379133645, 22999.475929610893, 22331.71329658692, 21316.58768297592, 18024.636016590994, 559.1884027663241, 20400.931698421122, 24194.260569189322, 21030.05903005153, 19292.52283559857, 22378.66788148961, 5480.629287768185, 19842.498158161263, 22558.048774038445, 21313.80335449419, 21182.75926899391, 24050.11422884223, 18860.526051438897, 21910.73767425522, 23661.735829775087, 18646.540588496555, 18375.57346186237, 18095.13803081987, 17846.33793783079, 23092.81025560639, 20328.906718770864, 20304.00383124418, 18231.787609447005, 20544.023588701268, 18354.57328084139, 19048.581910219753, 22655.714397106498, 19663.309110671504, 18496.414405182946, 18719.260036771746, 18314.444921110735, 17686.79866921553, 22477.08981622327, 19449.87302459543, 22675.00423750721, 18516.160236170806, 18470.527968748556, 20593.149720386697, 307.9731448358136, 25079.050115287264, 18595.06687717522, 24388.93124023291, 18469.947209012207], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200], "policy_agent_policy_reward": [7817.757229097114, 8704.280046192087, 9805.75039584777, 6755.167078092428, 9139.554259305294, 7256.1475012346855, 7673.446995961231, 8750.963200868635, 6170.677628466942, 9116.547528381627, 8851.198283174414, 5741.25684528305, 7260.211646091206, 3256.2209666900453, 7031.118122139271, 5423.793509499037, 8838.848061426936, 7419.645205202548, 7307.500948042494, 2896.10446664513, 8978.991490897186, 7380.1636016442935, 7168.432603027985, 6969.2553971421385, 3761.51787286061, 8685.083920550993, 1733.7671971916775, 5786.1887409637075, 8855.855435059422, 4107.469518977239, 3584.4541511193834, 4037.1890608027024, 7785.098140032174, 6237.863967471797, 9390.57758582163, 8834.60308192054, 7972.487845141528, 6857.96938772882, 8342.25896362415, 6890.570221196775, 7669.612672047731, 8249.559850946513, 5518.429931231769, 5158.504447141943, 6203.089430458255, 5577.840204497651, 2629.3267067833276, 8716.333009538084, 8015.057672596302, 3718.826867226235, 7541.256761684867, 7188.590956435733, 3707.15476882268, 4111.683245816022, 4422.283684969141, 6427.976964357402, 8876.301139476545, 13.887432678063094, 7643.320083151937, 3169.753752225507, 6377.542044654387, 8644.759377232087, 4604.202084905817, 932.5095723693103, 8074.230939758611, 5055.524819855575, 6030.867598219724, 5938.100448257122, 3566.5494508537827, 8651.663339183937, 4675.4108456737, 3743.7000373733204, 7871.461710869088, 8637.705373314582, 9439.549958222173, 9330.24696491367, 4307.192049976823, 6917.127477788397, 6527.527266677766, 9457.026713281153, 5791.494459052715, 7827.900973471185, 8722.052900779805, 3208.031265693112, 8195.154267531689, 9226.811545577955, 8603.000097765706, 8842.819764234508, 10065.285365476228, 3713.373044045487, 8090.277844098321, 5254.535131939989, 8585.14652879253, 8221.039802702957, 7048.335258224373, 3.8901474233138362, 1805.335802921865, 8268.620882540177, 3495.7920828212673, 9262.575062893315], "policy_adversary_policy_reward": [5992.810710364388, 6058.31451045787, 4069.8325791894576, 5389.124051277518, 3980.624320159229, 4331.852476823209, 7023.014671578914, 7243.457675224689, 4988.693695156636, 4686.671598024166, 6839.998809726757, 6137.394781870845, 4945.781061920504, 6343.067490275017, 5010.7133560096045, 5386.488210311032, 7967.453745720994, 6875.191254920606, 5014.497692315449, 4364.006212160119, 5141.519187793961, 4182.91952687401, 8150.313301320352, 7771.152913158846, 6833.117397954911, 6777.630254180497, 10828.504110720973, 10175.363646750162, 6344.5986623367, 7067.08241148773, 8144.656062210878, 8558.253478643017, 5214.578379566623, 5079.586142039705, 6381.786149481882, 6673.77810529614, 6623.65431998157, 6831.117372361231, 11244.903348831092, 10253.124293785027, 5061.8664630508165, 4830.1993602661605, 5899.434423139435, 6663.359502441179, 6788.3583654121485, 6714.397871816306, 7036.445599166851, 6883.101881926869, 10273.858985192166, 10233.845165757628, 5065.183110571731, 5257.538943483027, 11985.307830265212, 12340.615965002875, 8183.722090223866, 8069.286611743173, 5045.679541255413, 5042.213699917667, 9610.852289576367, 9980.803218022373, 10121.220986230319, 10229.23111487158, 9972.317983589073, 9695.47820963617, 6086.686950847787, 6254.04865179595, 7778.5043649949575, 7500.26033167396, 4599.446483395162, 4236.028881172433, 5303.737346038477, 4704.902010098957, 4845.77511234391, 6132.060671596918, 6529.324697240769, 7267.975347899093, 5338.161107281763, 5791.14144823006, 7179.540456055988, 6961.583145904813, 6131.636055940604, 6360.547991853788, 4886.352356629125, 5878.973821721379, 6620.764196988286, 8623.705692499174, 8890.745515000419, 8855.658329283178, 7342.124717677445, 7888.814078607653, 8560.778209121896, 7110.961161802779, 9303.774881740996, 11511.507657354303, 5025.812484292012, 5390.8969372856445, 5813.939050484401, 4970.629570130847, 10418.574554940727, 9771.893364388383, 6455.116373589029, 6142.5327263330755, 6368.3887380526685, 6845.950608353683, 9967.564419572787, 10380.491190738196, 8857.656333489516, 10030.136350305413, 8300.01706490959, 9609.412546708198, 7182.447379373805, 7706.16333924471, 4124.2331898050215, 5024.101687309438, 205.63501217305026, 339.6659579152107, 6280.068286095811, 6477.543329173313, 10619.727483046796, 10404.779333917066, 7071.531086952134, 7580.985898445014, 5206.094491317747, 5441.668967048732, 9485.998333610707, 8288.467462973102, 2294.285076646512, 2253.8346387523657, 5990.049285399204, 5778.217933003412, 9086.026927782805, 8416.497026400133, 7892.645049979642, 7390.29070629477, 7863.020372113634, 7381.638448623164, 10313.636743422087, 10169.928034566297, 4856.095429463503, 5352.767282791534, 9466.541683028914, 7768.785145552566, 9950.193491850936, 9967.842300550787, 4639.875501999823, 6135.203375627634, 4243.856290475655, 5494.011798072148, 3953.6791149227593, 4701.908957674976, 3797.0912543752784, 4718.999718541873, 9360.119054353887, 9425.499151275639, 6186.7710950399505, 7225.008145942554, 7568.059440025616, 6208.417124540825, 4233.9615090168445, 4540.799387149071, 6401.887964970291, 8350.641164678225, 6302.848337316054, 4223.823970054162, 5333.450198599769, 4993.078810840219, 10934.104358037843, 8513.578773375437, 5527.818643942647, 5940.3361991971915, 4812.398911232418, 4457.203948372607, 5527.829960817893, 4588.429978188134, 4246.548822265558, 5225.076334610643, 3650.5645914159236, 3970.948712323353, 8334.954192492407, 10428.762579685466, 6042.521226574165, 5317.073953922965, 8537.395021845878, 8883.074083721282, 4663.9562118735375, 5267.057495504794, 5780.055512709824, 4469.432653335779, 6571.941402691595, 6972.87305947076, 95.8411104798494, 208.24188693265043, 12332.27179321957, 10941.44251914576, 4819.528909394872, 5506.917085240194, 10248.720582220134, 10644.418575191417, 4867.205736004769, 4340.166410114202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39931494228537323, "mean_inference_ms": 0.993115374041741, "mean_action_processing_ms": 0.16806403488292773, "mean_env_wait_ms": 0.05432783274428114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030711889266967773, "StateBufferConnector_ms": 0.0024667978286743164, "ViewRequirementAgentConnector_ms": 0.06440305709838867}, "num_episodes": 21, "episode_return_max": 26059.69099245987, "episode_return_min": 307.9731448358136, "episode_return_mean": 20112.23718567125}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.4981813542121, "num_env_steps_trained_throughput_per_sec": 546.4981813542121, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 7355.743, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7355.709, "sample_time_ms": 786.43, "learn_time_ms": 6557.579, "learn_throughput": 609.981, "synch_weights_time_ms": 11.153}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 146, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-48-12", "timestamp": 1723236492, "time_this_iter_s": 7.3232927322387695, "time_total_s": 1106.8246541023254, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3a3dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1106.8246541023254, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 26.09090909090909, "ram_util_percent": 82.2090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 648456759519.2212, "cur_kl_coeff": 4352094335088.312, "cur_lr": 5.0000000000000016e-05, "total_loss": 102555573899.24232, "policy_loss": 0.018553211917686795, "vf_loss": 10.0, "vf_explained_var": -2.2787738729406288e-05, "kl": 0.023564649169781692, "entropy": 1.2908548742375046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.940590931288898, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001135929425557, "policy_loss": -0.0002614911475878519, "vf_loss": 9.994866635402044, "vf_explained_var": -0.00040331905086835225, "kl": 0.007158744252228644, "entropy": 1.272326592852672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "env_runners": {"episode_reward_max": 26059.69099245987, "episode_reward_min": 307.9731448358136, "episode_reward_mean": 19987.69775185468, "episode_len_mean": 192.85, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19285, "policy_reward_min": {"agent_policy": 3.8901474233138362, "adversary_policy": 95.8411104798494}, "policy_reward_max": {"agent_policy": 10065.285365476228, "adversary_policy": 12340.615965002875}, "policy_reward_mean": {"agent_policy": 6434.056797143855, "adversary_policy": 6776.8204773554135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18871.057314214126, 19942.957527224877, 20671.188840256462, 20888.80287823584, 24269.222023810467, 19007.80597460571, 26059.69099245987, 22039.1974429307, 18943.748676232495, 23699.125026576006, 23934.906252221208, 23704.985254027844, 20125.833742675954, 21516.628664140673, 18226.052950389287, 18843.242438057987, 18950.32362908236, 20655.26943286864, 19471.561519135965, 21031.693823157562, 20161.796719842077, 19014.886029297024, 20762.89982071927, 22904.90829142565, 21434.028226743376, 21249.5795754223, 23444.60924587859, 19133.0424311157, 18799.62629321148, 23909.294786555434, 20138.905861607014, 20402.930302842076, 24055.210379133645, 22999.475929610893, 22331.71329658692, 21316.58768297592, 18024.636016590994, 559.1884027663241, 20400.931698421122, 24194.260569189322, 21030.05903005153, 19292.52283559857, 22378.66788148961, 5480.629287768185, 19842.498158161263, 22558.048774038445, 21313.80335449419, 21182.75926899391, 24050.11422884223, 18860.526051438897, 21910.73767425522, 23661.735829775087, 18646.540588496555, 18375.57346186237, 18095.13803081987, 17846.33793783079, 23092.81025560639, 20328.906718770864, 20304.00383124418, 18231.787609447005, 20544.023588701268, 18354.57328084139, 19048.581910219753, 22655.714397106498, 19663.309110671504, 18496.414405182946, 18719.260036771746, 18314.444921110735, 17686.79866921553, 22477.08981622327, 19449.87302459543, 22675.00423750721, 18516.160236170806, 18470.527968748556, 20593.149720386697, 307.9731448358136, 25079.050115287264, 18595.06687717522, 24388.93124023291, 18469.947209012207, 18159.912816353124, 19609.29689891668, 18567.910371057424, 19040.318910721613, 22128.763399517557, 23677.473661534477, 19867.29809262731, 17837.061347452887, 19879.41343638324, 22771.515017076166, 18315.1802336382, 21650.446701938283, 18365.135474983414, 24222.012915819447, 3481.5886834411053, 22257.23611552509, 21021.364648948434, 24766.77496313031, 19582.21127912787, 18487.95953605448], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8978.991490897186, 7380.1636016442935, 7168.432603027985, 6969.2553971421385, 3761.51787286061, 8685.083920550993, 1733.7671971916775, 5786.1887409637075, 8855.855435059422, 4107.469518977239, 3584.4541511193834, 4037.1890608027024, 7785.098140032174, 6237.863967471797, 9390.57758582163, 8834.60308192054, 7972.487845141528, 6857.96938772882, 8342.25896362415, 6890.570221196775, 7669.612672047731, 8249.559850946513, 5518.429931231769, 5158.504447141943, 6203.089430458255, 5577.840204497651, 2629.3267067833276, 8716.333009538084, 8015.057672596302, 3718.826867226235, 7541.256761684867, 7188.590956435733, 3707.15476882268, 4111.683245816022, 4422.283684969141, 6427.976964357402, 8876.301139476545, 13.887432678063094, 7643.320083151937, 3169.753752225507, 6377.542044654387, 8644.759377232087, 4604.202084905817, 932.5095723693103, 8074.230939758611, 5055.524819855575, 6030.867598219724, 5938.100448257122, 3566.5494508537827, 8651.663339183937, 4675.4108456737, 3743.7000373733204, 7871.461710869088, 8637.705373314582, 9439.549958222173, 9330.24696491367, 4307.192049976823, 6917.127477788397, 6527.527266677766, 9457.026713281153, 5791.494459052715, 7827.900973471185, 8722.052900779805, 3208.031265693112, 8195.154267531689, 9226.811545577955, 8603.000097765706, 8842.819764234508, 10065.285365476228, 3713.373044045487, 8090.277844098321, 5254.535131939989, 8585.14652879253, 8221.039802702957, 7048.335258224373, 3.8901474233138362, 1805.335802921865, 8268.620882540177, 3495.7920828212673, 9262.575062893315, 9454.153324184077, 7871.582040379551, 8075.230545167516, 8426.454053291221, 5244.829993218508, 3206.856625158055, 6975.998737512432, 9782.510618093673, 7869.35621946043, 5125.322126422705, 9479.248388198814, 6308.157137096849, 9476.916097909247, 2925.249957411135, 279.25029903827567, 5609.7700986792925, 6722.542927646451, 3197.357607601064, 8413.64943828311, 8028.2854130053265], "policy_adversary_policy_reward": [5061.8664630508165, 4830.1993602661605, 5899.434423139435, 6663.359502441179, 6788.3583654121485, 6714.397871816306, 7036.445599166851, 6883.101881926869, 10273.858985192166, 10233.845165757628, 5065.183110571731, 5257.538943483027, 11985.307830265212, 12340.615965002875, 8183.722090223866, 8069.286611743173, 5045.679541255413, 5042.213699917667, 9610.852289576367, 9980.803218022373, 10121.220986230319, 10229.23111487158, 9972.317983589073, 9695.47820963617, 6086.686950847787, 6254.04865179595, 7778.5043649949575, 7500.26033167396, 4599.446483395162, 4236.028881172433, 5303.737346038477, 4704.902010098957, 4845.77511234391, 6132.060671596918, 6529.324697240769, 7267.975347899093, 5338.161107281763, 5791.14144823006, 7179.540456055988, 6961.583145904813, 6131.636055940604, 6360.547991853788, 4886.352356629125, 5878.973821721379, 6620.764196988286, 8623.705692499174, 8890.745515000419, 8855.658329283178, 7342.124717677445, 7888.814078607653, 8560.778209121896, 7110.961161802779, 9303.774881740996, 11511.507657354303, 5025.812484292012, 5390.8969372856445, 5813.939050484401, 4970.629570130847, 10418.574554940727, 9771.893364388383, 6455.116373589029, 6142.5327263330755, 6368.3887380526685, 6845.950608353683, 9967.564419572787, 10380.491190738196, 8857.656333489516, 10030.136350305413, 8300.01706490959, 9609.412546708198, 7182.447379373805, 7706.16333924471, 4124.2331898050215, 5024.101687309438, 205.63501217305026, 339.6659579152107, 6280.068286095811, 6477.543329173313, 10619.727483046796, 10404.779333917066, 7071.531086952134, 7580.985898445014, 5206.094491317747, 5441.668967048732, 9485.998333610707, 8288.467462973102, 2294.285076646512, 2253.8346387523657, 5990.049285399204, 5778.217933003412, 9086.026927782805, 8416.497026400133, 7892.645049979642, 7390.29070629477, 7863.020372113634, 7381.638448623164, 10313.636743422087, 10169.928034566297, 4856.095429463503, 5352.767282791534, 9466.541683028914, 7768.785145552566, 9950.193491850936, 9967.842300550787, 4639.875501999823, 6135.203375627634, 4243.856290475655, 5494.011798072148, 3953.6791149227593, 4701.908957674976, 3797.0912543752784, 4718.999718541873, 9360.119054353887, 9425.499151275639, 6186.7710950399505, 7225.008145942554, 7568.059440025616, 6208.417124540825, 4233.9615090168445, 4540.799387149071, 6401.887964970291, 8350.641164678225, 6302.848337316054, 4223.823970054162, 5333.450198599769, 4993.078810840219, 10934.104358037843, 8513.578773375437, 5527.818643942647, 5940.3361991971915, 4812.398911232418, 4457.203948372607, 5527.829960817893, 4588.429978188134, 4246.548822265558, 5225.076334610643, 3650.5645914159236, 3970.948712323353, 8334.954192492407, 10428.762579685466, 6042.521226574165, 5317.073953922965, 8537.395021845878, 8883.074083721282, 4663.9562118735375, 5267.057495504794, 5780.055512709824, 4469.432653335779, 6571.941402691595, 6972.87305947076, 95.8411104798494, 208.24188693265043, 12332.27179321957, 10941.44251914576, 4819.528909394872, 5506.917085240194, 10248.720582220134, 10644.418575191417, 4867.205736004769, 4340.166410114202, 4280.02023755285, 4425.739254616207, 6252.6349120550885, 5485.079946482047, 5957.332756354723, 4535.347069535176, 5238.188232937756, 5375.676624492636, 8123.353790891246, 8760.579615407769, 10572.034792266631, 9898.582244109748, 7166.136886218529, 5725.162468896358, 4358.24550905025, 3696.305220309034, 5847.827734703094, 6162.229482219706, 8673.771691016507, 8972.421199636936, 4533.7669745103785, 4302.164870929012, 7828.106561230327, 7514.183003611067, 4540.650170677825, 4347.569206396395, 10280.34935573298, 11016.413602675302, 1430.9790180001164, 1771.3593664027123, 8294.152083791008, 8353.313933054775, 6999.799504657312, 7299.022216644639, 10667.118113802362, 10902.299241726856, 5622.118047235357, 5546.443793609404, 6012.205891493938, 4447.468231555302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399143035480447, "mean_inference_ms": 0.9927807768787676, "mean_action_processing_ms": 0.16801339100918128, "mean_env_wait_ms": 0.054306167360781324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003084540367126465, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.06550633907318115}, "num_episodes": 20, "episode_return_max": 26059.69099245987, "episode_return_min": 307.9731448358136, "episode_return_mean": 19987.69775185468}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.4776778718921, "num_env_steps_trained_throughput_per_sec": 486.4776778718921, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 7456.123, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7456.087, "sample_time_ms": 794.836, "learn_time_ms": 6649.424, "learn_throughput": 601.556, "synch_weights_time_ms": 11.236}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "training_iteration": 147, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-48-21", "timestamp": 1723236501, "time_this_iter_s": 8.271586656570435, "time_total_s": 1115.0962407588959, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1115.0962407588959, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 30.483333333333334, "ram_util_percent": 83.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 975488762566.8402, "cur_kl_coeff": 6528141502632.468, "cur_lr": 5.0000000000000016e-05, "total_loss": 152815324581.51956, "policy_loss": 0.018935921505862284, "vf_loss": 10.0, "vf_explained_var": -6.912852090502542e-05, "kl": 0.02340870240343508, "entropy": 1.288215411340118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9028190107240032, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005678270260493, "policy_loss": -0.00261960657662712, "vf_loss": 10.0, "vf_explained_var": -0.0004896553854147593, "kl": 0.009095773226969564, "entropy": 1.2947859207789103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 25079.050115287264, "episode_reward_min": 307.9731448358136, "episode_reward_mean": 19881.586504287206, "episode_len_mean": 192.85, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19285, "policy_reward_min": {"agent_policy": 3.8901474233138362, "adversary_policy": 95.8411104798494}, "policy_reward_max": {"agent_policy": 10205.561687119689, "adversary_policy": 12332.27179321957}, "policy_reward_mean": {"agent_policy": 6369.648239456118, "adversary_policy": 6755.969132415546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20161.796719842077, 19014.886029297024, 20762.89982071927, 22904.90829142565, 21434.028226743376, 21249.5795754223, 23444.60924587859, 19133.0424311157, 18799.62629321148, 23909.294786555434, 20138.905861607014, 20402.930302842076, 24055.210379133645, 22999.475929610893, 22331.71329658692, 21316.58768297592, 18024.636016590994, 559.1884027663241, 20400.931698421122, 24194.260569189322, 21030.05903005153, 19292.52283559857, 22378.66788148961, 5480.629287768185, 19842.498158161263, 22558.048774038445, 21313.80335449419, 21182.75926899391, 24050.11422884223, 18860.526051438897, 21910.73767425522, 23661.735829775087, 18646.540588496555, 18375.57346186237, 18095.13803081987, 17846.33793783079, 23092.81025560639, 20328.906718770864, 20304.00383124418, 18231.787609447005, 20544.023588701268, 18354.57328084139, 19048.581910219753, 22655.714397106498, 19663.309110671504, 18496.414405182946, 18719.260036771746, 18314.444921110735, 17686.79866921553, 22477.08981622327, 19449.87302459543, 22675.00423750721, 18516.160236170806, 18470.527968748556, 20593.149720386697, 307.9731448358136, 25079.050115287264, 18595.06687717522, 24388.93124023291, 18469.947209012207, 18159.912816353124, 19609.29689891668, 18567.910371057424, 19040.318910721613, 22128.763399517557, 23677.473661534477, 19867.29809262731, 17837.061347452887, 19879.41343638324, 22771.515017076166, 18315.1802336382, 21650.446701938283, 18365.135474983414, 24222.012915819447, 3481.5886834411053, 22257.23611552509, 21021.364648948434, 24766.77496313031, 19582.21127912787, 18487.95953605448, 24405.75617204082, 18701.245479127534, 22829.710057919652, 19876.703851543247, 18836.643417239407, 21503.41546988294, 23475.32183469076, 20635.768483783984, 21684.59270691299, 21609.162177641938, 20119.829067781153, 19084.758434300154, 16010.487399442049, 25049.862137033982, 18380.180861302528, 17650.629766588983, 19808.56110363241, 17242.208369772667, 24097.99187843086, 19239.340976488522], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7669.612672047731, 8249.559850946513, 5518.429931231769, 5158.504447141943, 6203.089430458255, 5577.840204497651, 2629.3267067833276, 8716.333009538084, 8015.057672596302, 3718.826867226235, 7541.256761684867, 7188.590956435733, 3707.15476882268, 4111.683245816022, 4422.283684969141, 6427.976964357402, 8876.301139476545, 13.887432678063094, 7643.320083151937, 3169.753752225507, 6377.542044654387, 8644.759377232087, 4604.202084905817, 932.5095723693103, 8074.230939758611, 5055.524819855575, 6030.867598219724, 5938.100448257122, 3566.5494508537827, 8651.663339183937, 4675.4108456737, 3743.7000373733204, 7871.461710869088, 8637.705373314582, 9439.549958222173, 9330.24696491367, 4307.192049976823, 6917.127477788397, 6527.527266677766, 9457.026713281153, 5791.494459052715, 7827.900973471185, 8722.052900779805, 3208.031265693112, 8195.154267531689, 9226.811545577955, 8603.000097765706, 8842.819764234508, 10065.285365476228, 3713.373044045487, 8090.277844098321, 5254.535131939989, 8585.14652879253, 8221.039802702957, 7048.335258224373, 3.8901474233138362, 1805.335802921865, 8268.620882540177, 3495.7920828212673, 9262.575062893315, 9454.153324184077, 7871.582040379551, 8075.230545167516, 8426.454053291221, 5244.829993218508, 3206.856625158055, 6975.998737512432, 9782.510618093673, 7869.35621946043, 5125.322126422705, 9479.248388198814, 6308.157137096849, 9476.916097909247, 2925.249957411135, 279.25029903827567, 5609.7700986792925, 6722.542927646451, 3197.357607601064, 8413.64943828311, 8028.2854130053265, 3226.7009031981197, 6545.187876826885, 3571.665428205599, 7526.19912073817, 7301.70926968394, 2572.1750858243518, 4289.165426271982, 6716.801050569162, 5787.031328811171, 5835.050834233211, 6852.89446604166, 7540.425592564919, 9305.39949889698, 2787.702460638291, 9078.615579448711, 9490.350641256819, 6082.544019867867, 10205.561687119689, 3729.8767362211206, 8473.885407982294], "policy_adversary_policy_reward": [6131.636055940604, 6360.547991853788, 4886.352356629125, 5878.973821721379, 6620.764196988286, 8623.705692499174, 8890.745515000419, 8855.658329283178, 7342.124717677445, 7888.814078607653, 8560.778209121896, 7110.961161802779, 9303.774881740996, 11511.507657354303, 5025.812484292012, 5390.8969372856445, 5813.939050484401, 4970.629570130847, 10418.574554940727, 9771.893364388383, 6455.116373589029, 6142.5327263330755, 6368.3887380526685, 6845.950608353683, 9967.564419572787, 10380.491190738196, 8857.656333489516, 10030.136350305413, 8300.01706490959, 9609.412546708198, 7182.447379373805, 7706.16333924471, 4124.2331898050215, 5024.101687309438, 205.63501217305026, 339.6659579152107, 6280.068286095811, 6477.543329173313, 10619.727483046796, 10404.779333917066, 7071.531086952134, 7580.985898445014, 5206.094491317747, 5441.668967048732, 9485.998333610707, 8288.467462973102, 2294.285076646512, 2253.8346387523657, 5990.049285399204, 5778.217933003412, 9086.026927782805, 8416.497026400133, 7892.645049979642, 7390.29070629477, 7863.020372113634, 7381.638448623164, 10313.636743422087, 10169.928034566297, 4856.095429463503, 5352.767282791534, 9466.541683028914, 7768.785145552566, 9950.193491850936, 9967.842300550787, 4639.875501999823, 6135.203375627634, 4243.856290475655, 5494.011798072148, 3953.6791149227593, 4701.908957674976, 3797.0912543752784, 4718.999718541873, 9360.119054353887, 9425.499151275639, 6186.7710950399505, 7225.008145942554, 7568.059440025616, 6208.417124540825, 4233.9615090168445, 4540.799387149071, 6401.887964970291, 8350.641164678225, 6302.848337316054, 4223.823970054162, 5333.450198599769, 4993.078810840219, 10934.104358037843, 8513.578773375437, 5527.818643942647, 5940.3361991971915, 4812.398911232418, 4457.203948372607, 5527.829960817893, 4588.429978188134, 4246.548822265558, 5225.076334610643, 3650.5645914159236, 3970.948712323353, 8334.954192492407, 10428.762579685466, 6042.521226574165, 5317.073953922965, 8537.395021845878, 8883.074083721282, 4663.9562118735375, 5267.057495504794, 5780.055512709824, 4469.432653335779, 6571.941402691595, 6972.87305947076, 95.8411104798494, 208.24188693265043, 12332.27179321957, 10941.44251914576, 4819.528909394872, 5506.917085240194, 10248.720582220134, 10644.418575191417, 4867.205736004769, 4340.166410114202, 4280.02023755285, 4425.739254616207, 6252.6349120550885, 5485.079946482047, 5957.332756354723, 4535.347069535176, 5238.188232937756, 5375.676624492636, 8123.353790891246, 8760.579615407769, 10572.034792266631, 9898.582244109748, 7166.136886218529, 5725.162468896358, 4358.24550905025, 3696.305220309034, 5847.827734703094, 6162.229482219706, 8673.771691016507, 8972.421199636936, 4533.7669745103785, 4302.164870929012, 7828.106561230327, 7514.183003611067, 4540.650170677825, 4347.569206396395, 10280.34935573298, 11016.413602675302, 1430.9790180001164, 1771.3593664027123, 8294.152083791008, 8353.313933054775, 6999.799504657312, 7299.022216644639, 10667.118113802362, 10902.299241726856, 5622.118047235357, 5546.443793609404, 6012.205891493938, 4447.468231555302, 10813.01641087572, 10366.038857966916, 4562.650757236488, 7593.406845064186, 8688.633319013476, 10569.411310700569, 6260.176812900362, 6090.327917904747, 6492.141980845518, 5042.792166709958, 11203.42848315936, 7727.811900899214, 9837.838641588507, 9348.31776683026, 7416.37723493134, 6502.590198283492, 8321.670463761686, 7575.890914340034, 7897.882055349247, 7876.229288059533, 6236.751089697042, 7030.183512042427, 6498.604820110826, 5045.728021624438, 1868.351775711114, 4836.736124833979, 11327.659783142188, 10934.499893253354, 4996.08341083664, 4305.481871017189, 4651.784982474134, 3508.4941428581087, 5666.42547990152, 8059.591603863083, 3498.6148933005315, 3538.0317893524557, 9958.582279631526, 10409.532862578299, 5098.129350824318, 5667.326217681915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3990900505683986, "mean_inference_ms": 0.9925259281282447, "mean_action_processing_ms": 0.1679909820793301, "mean_env_wait_ms": 0.05430508453878387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719925880432129, "StateBufferConnector_ms": 0.002553105354309082, "ViewRequirementAgentConnector_ms": 0.06903636455535889}, "num_episodes": 20, "episode_return_max": 25079.050115287264, "episode_return_min": 307.9731448358136, "episode_return_mean": 19881.586504287206}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.70918494523806, "num_env_steps_trained_throughput_per_sec": 507.70918494523806, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 7521.327, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7521.29, "sample_time_ms": 801.833, "learn_time_ms": 6707.815, "learn_throughput": 596.319, "synch_weights_time_ms": 11.031}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 148, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-48-29", "timestamp": 1723236509, "time_this_iter_s": 7.88274621963501, "time_total_s": 1122.9789869785309, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1122.9789869785309, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 27.727272727272727, "ram_util_percent": 82.95454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1155188249854.6455, "cur_kl_coeff": 9792212253948.703, "cur_lr": 5.0000000000000016e-05, "total_loss": 159015775090.04868, "policy_loss": 0.019982039528435698, "vf_loss": 10.0, "vf_explained_var": 2.524660377906113e-05, "kl": 0.016239004666306, "entropy": 1.2920192125613097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9064096972656747, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996899603803952, "policy_loss": -0.005191990827734116, "vf_loss": 9.994455696145694, "vf_explained_var": -0.0003868619600931803, "kl": 0.008370136589413353, "entropy": 1.2891438552488883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "env_runners": {"episode_reward_max": 25079.050115287264, "episode_reward_min": 307.9731448358136, "episode_reward_mean": 19728.083728827434, "episode_len_mean": 192.88, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19288, "policy_reward_min": {"agent_policy": 3.8901474233138362, "adversary_policy": 95.8411104798494}, "policy_reward_max": {"agent_policy": 10205.561687119689, "adversary_policy": 12332.27179321957}, "policy_reward_mean": {"agent_policy": 6482.105668980758, "adversary_policy": 6622.98902992334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22378.66788148961, 5480.629287768185, 19842.498158161263, 22558.048774038445, 21313.80335449419, 21182.75926899391, 24050.11422884223, 18860.526051438897, 21910.73767425522, 23661.735829775087, 18646.540588496555, 18375.57346186237, 18095.13803081987, 17846.33793783079, 23092.81025560639, 20328.906718770864, 20304.00383124418, 18231.787609447005, 20544.023588701268, 18354.57328084139, 19048.581910219753, 22655.714397106498, 19663.309110671504, 18496.414405182946, 18719.260036771746, 18314.444921110735, 17686.79866921553, 22477.08981622327, 19449.87302459543, 22675.00423750721, 18516.160236170806, 18470.527968748556, 20593.149720386697, 307.9731448358136, 25079.050115287264, 18595.06687717522, 24388.93124023291, 18469.947209012207, 18159.912816353124, 19609.29689891668, 18567.910371057424, 19040.318910721613, 22128.763399517557, 23677.473661534477, 19867.29809262731, 17837.061347452887, 19879.41343638324, 22771.515017076166, 18315.1802336382, 21650.446701938283, 18365.135474983414, 24222.012915819447, 3481.5886834411053, 22257.23611552509, 21021.364648948434, 24766.77496313031, 19582.21127912787, 18487.95953605448, 24405.75617204082, 18701.245479127534, 22829.710057919652, 19876.703851543247, 18836.643417239407, 21503.41546988294, 23475.32183469076, 20635.768483783984, 21684.59270691299, 21609.162177641938, 20119.829067781153, 19084.758434300154, 16010.487399442049, 25049.862137033982, 18380.180861302528, 17650.629766588983, 19808.56110363241, 17242.208369772667, 24097.99187843086, 19239.340976488522, 19022.71219764415, 19376.777336504914, 21266.733602133172, 1052.9615969635638, 22028.801916459804, 18343.749316627367, 22927.820076607633, 17243.983595904203, 21993.36808348798, 19064.654844499386, 19760.41782355378, 21050.59899013305, 22572.493012928055, 23245.12177980985, 18258.10921248928, 19368.56227985773, 23319.787934181357, 17689.57977940379, 18711.732892081676, 21637.42774289715, 24132.327908903942, 18143.093956536297], "episode_lengths": [200, 48, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4604.202084905817, 932.5095723693103, 8074.230939758611, 5055.524819855575, 6030.867598219724, 5938.100448257122, 3566.5494508537827, 8651.663339183937, 4675.4108456737, 3743.7000373733204, 7871.461710869088, 8637.705373314582, 9439.549958222173, 9330.24696491367, 4307.192049976823, 6917.127477788397, 6527.527266677766, 9457.026713281153, 5791.494459052715, 7827.900973471185, 8722.052900779805, 3208.031265693112, 8195.154267531689, 9226.811545577955, 8603.000097765706, 8842.819764234508, 10065.285365476228, 3713.373044045487, 8090.277844098321, 5254.535131939989, 8585.14652879253, 8221.039802702957, 7048.335258224373, 3.8901474233138362, 1805.335802921865, 8268.620882540177, 3495.7920828212673, 9262.575062893315, 9454.153324184077, 7871.582040379551, 8075.230545167516, 8426.454053291221, 5244.829993218508, 3206.856625158055, 6975.998737512432, 9782.510618093673, 7869.35621946043, 5125.322126422705, 9479.248388198814, 6308.157137096849, 9476.916097909247, 2925.249957411135, 279.25029903827567, 5609.7700986792925, 6722.542927646451, 3197.357607601064, 8413.64943828311, 8028.2854130053265, 3226.7009031981197, 6545.187876826885, 3571.665428205599, 7526.19912073817, 7301.70926968394, 2572.1750858243518, 4289.165426271982, 6716.801050569162, 5787.031328811171, 5835.050834233211, 6852.89446604166, 7540.425592564919, 9305.39949889698, 2787.702460638291, 9078.615579448711, 9490.350641256819, 6082.544019867867, 10205.561687119689, 3729.8767362211206, 8473.885407982294, 8731.474174414685, 7884.462928293747, 6179.778977279201, 25.623108572958497, 5355.547738673362, 9273.038196714979, 4001.9235216000056, 9241.718496469555, 5790.817167823642, 5922.092191113552, 7825.373070535084, 6012.340845342399, 5038.413180470865, 4443.607762315446, 7720.25838839566, 7976.6264004881305, 4424.155974729119, 8881.895150025148, 7871.329671126504, 5783.315620353116, 2908.3263248165463, 9534.715066882403], "policy_adversary_policy_reward": [9485.998333610707, 8288.467462973102, 2294.285076646512, 2253.8346387523657, 5990.049285399204, 5778.217933003412, 9086.026927782805, 8416.497026400133, 7892.645049979642, 7390.29070629477, 7863.020372113634, 7381.638448623164, 10313.636743422087, 10169.928034566297, 4856.095429463503, 5352.767282791534, 9466.541683028914, 7768.785145552566, 9950.193491850936, 9967.842300550787, 4639.875501999823, 6135.203375627634, 4243.856290475655, 5494.011798072148, 3953.6791149227593, 4701.908957674976, 3797.0912543752784, 4718.999718541873, 9360.119054353887, 9425.499151275639, 6186.7710950399505, 7225.008145942554, 7568.059440025616, 6208.417124540825, 4233.9615090168445, 4540.799387149071, 6401.887964970291, 8350.641164678225, 6302.848337316054, 4223.823970054162, 5333.450198599769, 4993.078810840219, 10934.104358037843, 8513.578773375437, 5527.818643942647, 5940.3361991971915, 4812.398911232418, 4457.203948372607, 5527.829960817893, 4588.429978188134, 4246.548822265558, 5225.076334610643, 3650.5645914159236, 3970.948712323353, 8334.954192492407, 10428.762579685466, 6042.521226574165, 5317.073953922965, 8537.395021845878, 8883.074083721282, 4663.9562118735375, 5267.057495504794, 5780.055512709824, 4469.432653335779, 6571.941402691595, 6972.87305947076, 95.8411104798494, 208.24188693265043, 12332.27179321957, 10941.44251914576, 4819.528909394872, 5506.917085240194, 10248.720582220134, 10644.418575191417, 4867.205736004769, 4340.166410114202, 4280.02023755285, 4425.739254616207, 6252.6349120550885, 5485.079946482047, 5957.332756354723, 4535.347069535176, 5238.188232937756, 5375.676624492636, 8123.353790891246, 8760.579615407769, 10572.034792266631, 9898.582244109748, 7166.136886218529, 5725.162468896358, 4358.24550905025, 3696.305220309034, 5847.827734703094, 6162.229482219706, 8673.771691016507, 8972.421199636936, 4533.7669745103785, 4302.164870929012, 7828.106561230327, 7514.183003611067, 4540.650170677825, 4347.569206396395, 10280.34935573298, 11016.413602675302, 1430.9790180001164, 1771.3593664027123, 8294.152083791008, 8353.313933054775, 6999.799504657312, 7299.022216644639, 10667.118113802362, 10902.299241726856, 5622.118047235357, 5546.443793609404, 6012.205891493938, 4447.468231555302, 10813.01641087572, 10366.038857966916, 4562.650757236488, 7593.406845064186, 8688.633319013476, 10569.411310700569, 6260.176812900362, 6090.327917904747, 6492.141980845518, 5042.792166709958, 11203.42848315936, 7727.811900899214, 9837.838641588507, 9348.31776683026, 7416.37723493134, 6502.590198283492, 8321.670463761686, 7575.890914340034, 7897.882055349247, 7876.229288059533, 6236.751089697042, 7030.183512042427, 6498.604820110826, 5045.728021624438, 1868.351775711114, 4836.736124833979, 11327.659783142188, 10934.499893253354, 4996.08341083664, 4305.481871017189, 4651.784982474134, 3508.4941428581087, 5666.42547990152, 8059.591603863083, 3498.6148933005315, 3538.0317893524557, 9958.582279631526, 10409.532862578299, 5098.129350824318, 5667.326217681915, 5371.352636913337, 4919.885386316103, 5868.413187983742, 5623.901220227445, 7134.756568160465, 7952.198056693469, 487.2761720143253, 540.0623163762796, 8675.35109171859, 7997.903086067777, 4227.299220183106, 4843.411899729329, 8786.633823423917, 10139.262731583683, 4900.417127261394, 3101.8479721733065, 7993.13457496335, 8209.416340700953, 8220.043432617395, 4922.519220768459, 6194.100156117975, 5740.944596900681, 6922.432373611497, 8115.825771179143, 9065.40356843125, 8468.67626402604, 9164.565208441229, 9636.948809053212, 4115.973588758328, 6421.877235335273, 5226.4464042611935, 6165.4894751084485, 9398.65653058509, 9496.975428867128, 3547.444155672788, 5260.240473705789, 4606.360039684062, 6234.043181271087, 7646.915729034287, 8207.19639350979, 11233.809298914372, 9990.192285172938, 4106.100429186469, 4502.278460467423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39904060906768507, "mean_inference_ms": 0.9922399924242719, "mean_action_processing_ms": 0.16796701868756814, "mean_env_wait_ms": 0.05428060387462653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003736257553100586, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06959748268127441}, "num_episodes": 22, "episode_return_max": 25079.050115287264, "episode_return_min": 307.9731448358136, "episode_return_mean": 19728.083728827434}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.4004793677386, "num_env_steps_trained_throughput_per_sec": 540.4004793677386, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1788000, "timers": {"training_iteration_time_ms": 7452.264, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7452.227, "sample_time_ms": 746.505, "learn_time_ms": 6694.087, "learn_throughput": 597.542, "synch_weights_time_ms": 11.045}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "done": false, "training_iteration": 149, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-48-36", "timestamp": 1723236516, "time_this_iter_s": 7.407013893127441, "time_total_s": 1130.3860008716583, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1130.3860008716583, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 25.136363636363637, "ram_util_percent": 82.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1035341691020.8677, "cur_kl_coeff": 9792212253948.703, "cur_lr": 5.0000000000000016e-05, "total_loss": 152833503775.96613, "policy_loss": 0.020315895514395187, "vf_loss": 9.998760720409413, "vf_explained_var": -5.529043535706858e-05, "kl": 0.01560765893972188, "entropy": 1.2854925918831397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8784217658142249, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00082437992096, "policy_loss": -0.0015704031951221016, "vf_loss": 9.995795755585034, "vf_explained_var": -0.00026548082629839577, "kl": 0.007233607659388023, "entropy": 1.2661080535501241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 25079.050115287264, "episode_reward_min": 307.9731448358136, "episode_reward_mean": 19593.004297969, "episode_len_mean": 192.76, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19276, "policy_reward_min": {"agent_policy": 3.8901474233138362, "adversary_policy": 95.8411104798494}, "policy_reward_max": {"agent_policy": 10205.561687119689, "adversary_policy": 12332.27179321957}, "policy_reward_mean": {"agent_policy": 6584.786315189833, "adversary_policy": 6504.108991389587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19048.581910219753, 22655.714397106498, 19663.309110671504, 18496.414405182946, 18719.260036771746, 18314.444921110735, 17686.79866921553, 22477.08981622327, 19449.87302459543, 22675.00423750721, 18516.160236170806, 18470.527968748556, 20593.149720386697, 307.9731448358136, 25079.050115287264, 18595.06687717522, 24388.93124023291, 18469.947209012207, 18159.912816353124, 19609.29689891668, 18567.910371057424, 19040.318910721613, 22128.763399517557, 23677.473661534477, 19867.29809262731, 17837.061347452887, 19879.41343638324, 22771.515017076166, 18315.1802336382, 21650.446701938283, 18365.135474983414, 24222.012915819447, 3481.5886834411053, 22257.23611552509, 21021.364648948434, 24766.77496313031, 19582.21127912787, 18487.95953605448, 24405.75617204082, 18701.245479127534, 22829.710057919652, 19876.703851543247, 18836.643417239407, 21503.41546988294, 23475.32183469076, 20635.768483783984, 21684.59270691299, 21609.162177641938, 20119.829067781153, 19084.758434300154, 16010.487399442049, 25049.862137033982, 18380.180861302528, 17650.629766588983, 19808.56110363241, 17242.208369772667, 24097.99187843086, 19239.340976488522, 19022.71219764415, 19376.777336504914, 21266.733602133172, 1052.9615969635638, 22028.801916459804, 18343.749316627367, 22927.820076607633, 17243.983595904203, 21993.36808348798, 19064.654844499386, 19760.41782355378, 21050.59899013305, 22572.493012928055, 23245.12177980985, 18258.10921248928, 19368.56227985773, 23319.787934181357, 17689.57977940379, 18711.732892081676, 21637.42774289715, 24132.327908903942, 18143.093956536297, 20125.194690127402, 4319.707213227842, 20776.622734832312, 21888.665681912982, 18727.02996371819, 18833.602947589374, 19807.429922086474, 19973.510792264267, 19945.011731234466, 17932.027829468945, 21177.58750803371, 21122.481924838317, 17646.699135260053, 24028.903765013452, 18474.017991825207, 20439.813994735345, 17902.543308149176, 20854.156232333997, 17934.59313705936, 19641.672223323512], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8722.052900779805, 3208.031265693112, 8195.154267531689, 9226.811545577955, 8603.000097765706, 8842.819764234508, 10065.285365476228, 3713.373044045487, 8090.277844098321, 5254.535131939989, 8585.14652879253, 8221.039802702957, 7048.335258224373, 3.8901474233138362, 1805.335802921865, 8268.620882540177, 3495.7920828212673, 9262.575062893315, 9454.153324184077, 7871.582040379551, 8075.230545167516, 8426.454053291221, 5244.829993218508, 3206.856625158055, 6975.998737512432, 9782.510618093673, 7869.35621946043, 5125.322126422705, 9479.248388198814, 6308.157137096849, 9476.916097909247, 2925.249957411135, 279.25029903827567, 5609.7700986792925, 6722.542927646451, 3197.357607601064, 8413.64943828311, 8028.2854130053265, 3226.7009031981197, 6545.187876826885, 3571.665428205599, 7526.19912073817, 7301.70926968394, 2572.1750858243518, 4289.165426271982, 6716.801050569162, 5787.031328811171, 5835.050834233211, 6852.89446604166, 7540.425592564919, 9305.39949889698, 2787.702460638291, 9078.615579448711, 9490.350641256819, 6082.544019867867, 10205.561687119689, 3729.8767362211206, 8473.885407982294, 8731.474174414685, 7884.462928293747, 6179.778977279201, 25.623108572958497, 5355.547738673362, 9273.038196714979, 4001.9235216000056, 9241.718496469555, 5790.817167823642, 5922.092191113552, 7825.373070535084, 6012.340845342399, 5038.413180470865, 4443.607762315446, 7720.25838839566, 7976.6264004881305, 4424.155974729119, 8881.895150025148, 7871.329671126504, 5783.315620353116, 2908.3263248165463, 9534.715066882403, 7305.783163548381, 493.74617583804246, 6342.551408329422, 5504.290791833274, 8320.972615000886, 8510.805643177384, 7317.972594238699, 4921.0116162237155, 7284.46451526212, 9323.68603918971, 6221.869762160719, 5269.042938456673, 9760.79920659431, 3536.9670602835827, 8067.5073705891555, 7447.954717646926, 8884.350822627897, 7164.938678523366, 8640.297614796156, 7329.043970605435], "policy_adversary_policy_reward": [5333.450198599769, 4993.078810840219, 10934.104358037843, 8513.578773375437, 5527.818643942647, 5940.3361991971915, 4812.398911232418, 4457.203948372607, 5527.829960817893, 4588.429978188134, 4246.548822265558, 5225.076334610643, 3650.5645914159236, 3970.948712323353, 8334.954192492407, 10428.762579685466, 6042.521226574165, 5317.073953922965, 8537.395021845878, 8883.074083721282, 4663.9562118735375, 5267.057495504794, 5780.055512709824, 4469.432653335779, 6571.941402691595, 6972.87305947076, 95.8411104798494, 208.24188693265043, 12332.27179321957, 10941.44251914576, 4819.528909394872, 5506.917085240194, 10248.720582220134, 10644.418575191417, 4867.205736004769, 4340.166410114202, 4280.02023755285, 4425.739254616207, 6252.6349120550885, 5485.079946482047, 5957.332756354723, 4535.347069535176, 5238.188232937756, 5375.676624492636, 8123.353790891246, 8760.579615407769, 10572.034792266631, 9898.582244109748, 7166.136886218529, 5725.162468896358, 4358.24550905025, 3696.305220309034, 5847.827734703094, 6162.229482219706, 8673.771691016507, 8972.421199636936, 4533.7669745103785, 4302.164870929012, 7828.106561230327, 7514.183003611067, 4540.650170677825, 4347.569206396395, 10280.34935573298, 11016.413602675302, 1430.9790180001164, 1771.3593664027123, 8294.152083791008, 8353.313933054775, 6999.799504657312, 7299.022216644639, 10667.118113802362, 10902.299241726856, 5622.118047235357, 5546.443793609404, 6012.205891493938, 4447.468231555302, 10813.01641087572, 10366.038857966916, 4562.650757236488, 7593.406845064186, 8688.633319013476, 10569.411310700569, 6260.176812900362, 6090.327917904747, 6492.141980845518, 5042.792166709958, 11203.42848315936, 7727.811900899214, 9837.838641588507, 9348.31776683026, 7416.37723493134, 6502.590198283492, 8321.670463761686, 7575.890914340034, 7897.882055349247, 7876.229288059533, 6236.751089697042, 7030.183512042427, 6498.604820110826, 5045.728021624438, 1868.351775711114, 4836.736124833979, 11327.659783142188, 10934.499893253354, 4996.08341083664, 4305.481871017189, 4651.784982474134, 3508.4941428581087, 5666.42547990152, 8059.591603863083, 3498.6148933005315, 3538.0317893524557, 9958.582279631526, 10409.532862578299, 5098.129350824318, 5667.326217681915, 5371.352636913337, 4919.885386316103, 5868.413187983742, 5623.901220227445, 7134.756568160465, 7952.198056693469, 487.2761720143253, 540.0623163762796, 8675.35109171859, 7997.903086067777, 4227.299220183106, 4843.411899729329, 8786.633823423917, 10139.262731583683, 4900.417127261394, 3101.8479721733065, 7993.13457496335, 8209.416340700953, 8220.043432617395, 4922.519220768459, 6194.100156117975, 5740.944596900681, 6922.432373611497, 8115.825771179143, 9065.40356843125, 8468.67626402604, 9164.565208441229, 9636.948809053212, 4115.973588758328, 6421.877235335273, 5226.4464042611935, 6165.4894751084485, 9398.65653058509, 9496.975428867128, 3547.444155672788, 5260.240473705789, 4606.360039684062, 6234.043181271087, 7646.915729034287, 8207.19639350979, 11233.809298914372, 9990.192285172938, 4106.100429186469, 4502.278460467423, 6836.352460182569, 5983.059066396554, 2051.8382364335284, 1774.122800956272, 6677.41557197773, 7756.655754525189, 8490.896696573971, 7893.478193505733, 5077.810127643532, 5328.247221073837, 5622.344217462666, 4700.453086949334, 5948.674622101469, 6540.782705746291, 9221.12400750723, 5831.375168533294, 6058.218689186352, 6602.32852678598, 3789.8922057379814, 4818.449584541246, 7036.546255125244, 7919.171490747811, 8815.312899529627, 7038.1260868520285, 3593.227114825481, 4292.672813840273, 10109.59011373571, 10382.346590994144, 6022.468019282094, 4384.042601953898, 6321.769844345176, 6670.089432743251, 4906.950429263382, 4111.242056257955, 6779.710239788656, 6909.507314022028, 3797.4546457415345, 5496.8408765217255, 5499.536599592569, 6813.091653125519]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3989815409976653, "mean_inference_ms": 0.9922789704754318, "mean_action_processing_ms": 0.1679554084644838, "mean_env_wait_ms": 0.05429391296851556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037459135055541992, "StateBufferConnector_ms": 0.0025229454040527344, "ViewRequirementAgentConnector_ms": 0.0685727596282959}, "num_episodes": 20, "episode_return_max": 25079.050115287264, "episode_return_min": 307.9731448358136, "episode_return_mean": 19593.004297969}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.3353051727507, "num_env_steps_trained_throughput_per_sec": 510.3353051727507, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 7486.286, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7486.249, "sample_time_ms": 742.843, "learn_time_ms": 6731.862, "learn_throughput": 594.189, "synch_weights_time_ms": 10.955}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 150, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-48-44", "timestamp": 1723236524, "time_this_iter_s": 7.84323787689209, "time_total_s": 1138.2292387485504, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bae3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1138.2292387485504, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 26.181818181818183, "ram_util_percent": 82.88181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1299277100069.926, "cur_kl_coeff": 9792212253948.703, "cur_lr": 5.0000000000000016e-05, "total_loss": 211686228892.309, "policy_loss": 0.02526353471185618, "vf_loss": 10.0, "vf_explained_var": -5.609207052402395e-06, "kl": 0.021617815346412717, "entropy": 1.2797666265850975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.894724658721437, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.988401262958844, "policy_loss": -0.0028216649036039597, "vf_loss": 9.985750576853752, "vf_explained_var": -0.00024008775750796, "kl": 0.005998559677391313, "entropy": 1.2471986662596464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "env_runners": {"episode_reward_max": 25049.862137033982, "episode_reward_min": 789.5082366562999, "episode_reward_mean": 19158.4139319712, "episode_len_mean": 189.33, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 18933, "policy_reward_min": {"agent_policy": 12.861663945562583, "adversary_policy": 365.2441679443714}, "policy_reward_max": {"agent_policy": 10205.561687119689, "adversary_policy": 11327.659783142188}, "policy_reward_mean": {"agent_policy": 6506.70701980186, "adversary_policy": 6325.853456084675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19867.29809262731, 17837.061347452887, 19879.41343638324, 22771.515017076166, 18315.1802336382, 21650.446701938283, 18365.135474983414, 24222.012915819447, 3481.5886834411053, 22257.23611552509, 21021.364648948434, 24766.77496313031, 19582.21127912787, 18487.95953605448, 24405.75617204082, 18701.245479127534, 22829.710057919652, 19876.703851543247, 18836.643417239407, 21503.41546988294, 23475.32183469076, 20635.768483783984, 21684.59270691299, 21609.162177641938, 20119.829067781153, 19084.758434300154, 16010.487399442049, 25049.862137033982, 18380.180861302528, 17650.629766588983, 19808.56110363241, 17242.208369772667, 24097.99187843086, 19239.340976488522, 19022.71219764415, 19376.777336504914, 21266.733602133172, 1052.9615969635638, 22028.801916459804, 18343.749316627367, 22927.820076607633, 17243.983595904203, 21993.36808348798, 19064.654844499386, 19760.41782355378, 21050.59899013305, 22572.493012928055, 23245.12177980985, 18258.10921248928, 19368.56227985773, 23319.787934181357, 17689.57977940379, 18711.732892081676, 21637.42774289715, 24132.327908903942, 18143.093956536297, 20125.194690127402, 4319.707213227842, 20776.622734832312, 21888.665681912982, 18727.02996371819, 18833.602947589374, 19807.429922086474, 19973.510792264267, 19945.011731234466, 17932.027829468945, 21177.58750803371, 21122.481924838317, 17646.699135260053, 24028.903765013452, 18474.017991825207, 20439.813994735345, 17902.543308149176, 20854.156232333997, 17934.59313705936, 19641.672223323512, 20109.94930954777, 20947.91453966026, 18851.760957847993, 19305.38316342183, 4445.440050571273, 18163.98724768987, 17603.385233813926, 17708.352230923167, 21634.380823751384, 20291.77052464465, 17300.25177226833, 22183.126756338585, 22039.93407631943, 789.5082366562999, 18551.180092442613, 20651.32698044372, 21815.40763016326, 20220.373139642306, 18859.03348408832, 18167.059123718234, 20038.1543006281, 1543.8553254745757, 18470.523171389523, 21639.87832732976], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 29, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200], "policy_agent_policy_reward": [6975.998737512432, 9782.510618093673, 7869.35621946043, 5125.322126422705, 9479.248388198814, 6308.157137096849, 9476.916097909247, 2925.249957411135, 279.25029903827567, 5609.7700986792925, 6722.542927646451, 3197.357607601064, 8413.64943828311, 8028.2854130053265, 3226.7009031981197, 6545.187876826885, 3571.665428205599, 7526.19912073817, 7301.70926968394, 2572.1750858243518, 4289.165426271982, 6716.801050569162, 5787.031328811171, 5835.050834233211, 6852.89446604166, 7540.425592564919, 9305.39949889698, 2787.702460638291, 9078.615579448711, 9490.350641256819, 6082.544019867867, 10205.561687119689, 3729.8767362211206, 8473.885407982294, 8731.474174414685, 7884.462928293747, 6179.778977279201, 25.623108572958497, 5355.547738673362, 9273.038196714979, 4001.9235216000056, 9241.718496469555, 5790.817167823642, 5922.092191113552, 7825.373070535084, 6012.340845342399, 5038.413180470865, 4443.607762315446, 7720.25838839566, 7976.6264004881305, 4424.155974729119, 8881.895150025148, 7871.329671126504, 5783.315620353116, 2908.3263248165463, 9534.715066882403, 7305.783163548381, 493.74617583804246, 6342.551408329422, 5504.290791833274, 8320.972615000886, 8510.805643177384, 7317.972594238699, 4921.0116162237155, 7284.46451526212, 9323.68603918971, 6221.869762160719, 5269.042938456673, 9760.79920659431, 3536.9670602835827, 8067.5073705891555, 7447.954717646926, 8884.350822627897, 7164.938678523366, 8640.297614796156, 7329.043970605435, 6959.376919570734, 6936.936817683149, 7238.710500820924, 6610.90902035125, 791.3537278124743, 8633.361669247257, 9765.49323839834, 8286.920117645193, 6049.570756856262, 7555.167378325172, 7165.507395783175, 5344.057137105445, 5673.3580061674365, 12.861663945562583, 8544.475049927734, 5918.018041571283, 4716.977746433927, 6982.839685746667, 8649.081535403031, 9947.848487071224, 7965.143977863751, 69.02849049041905, 8933.5878520682, 6332.668621775766], "policy_adversary_policy_reward": [7166.136886218529, 5725.162468896358, 4358.24550905025, 3696.305220309034, 5847.827734703094, 6162.229482219706, 8673.771691016507, 8972.421199636936, 4533.7669745103785, 4302.164870929012, 7828.106561230327, 7514.183003611067, 4540.650170677825, 4347.569206396395, 10280.34935573298, 11016.413602675302, 1430.9790180001164, 1771.3593664027123, 8294.152083791008, 8353.313933054775, 6999.799504657312, 7299.022216644639, 10667.118113802362, 10902.299241726856, 5622.118047235357, 5546.443793609404, 6012.205891493938, 4447.468231555302, 10813.01641087572, 10366.038857966916, 4562.650757236488, 7593.406845064186, 8688.633319013476, 10569.411310700569, 6260.176812900362, 6090.327917904747, 6492.141980845518, 5042.792166709958, 11203.42848315936, 7727.811900899214, 9837.838641588507, 9348.31776683026, 7416.37723493134, 6502.590198283492, 8321.670463761686, 7575.890914340034, 7897.882055349247, 7876.229288059533, 6236.751089697042, 7030.183512042427, 6498.604820110826, 5045.728021624438, 1868.351775711114, 4836.736124833979, 11327.659783142188, 10934.499893253354, 4996.08341083664, 4305.481871017189, 4651.784982474134, 3508.4941428581087, 5666.42547990152, 8059.591603863083, 3498.6148933005315, 3538.0317893524557, 9958.582279631526, 10409.532862578299, 5098.129350824318, 5667.326217681915, 5371.352636913337, 4919.885386316103, 5868.413187983742, 5623.901220227445, 7134.756568160465, 7952.198056693469, 487.2761720143253, 540.0623163762796, 8675.35109171859, 7997.903086067777, 4227.299220183106, 4843.411899729329, 8786.633823423917, 10139.262731583683, 4900.417127261394, 3101.8479721733065, 7993.13457496335, 8209.416340700953, 8220.043432617395, 4922.519220768459, 6194.100156117975, 5740.944596900681, 6922.432373611497, 8115.825771179143, 9065.40356843125, 8468.67626402604, 9164.565208441229, 9636.948809053212, 4115.973588758328, 6421.877235335273, 5226.4464042611935, 6165.4894751084485, 9398.65653058509, 9496.975428867128, 3547.444155672788, 5260.240473705789, 4606.360039684062, 6234.043181271087, 7646.915729034287, 8207.19639350979, 11233.809298914372, 9990.192285172938, 4106.100429186469, 4502.278460467423, 6836.352460182569, 5983.059066396554, 2051.8382364335284, 1774.122800956272, 6677.41557197773, 7756.655754525189, 8490.896696573971, 7893.478193505733, 5077.810127643532, 5328.247221073837, 5622.344217462666, 4700.453086949334, 5948.674622101469, 6540.782705746291, 9221.12400750723, 5831.375168533294, 6058.218689186352, 6602.32852678598, 3789.8922057379814, 4818.449584541246, 7036.546255125244, 7919.171490747811, 8815.312899529627, 7038.1260868520285, 3593.227114825481, 4292.672813840273, 10109.59011373571, 10382.346590994144, 6022.468019282094, 4384.042601953898, 6321.769844345176, 6670.089432743251, 4906.950429263382, 4111.242056257955, 6779.710239788656, 6909.507314022028, 3797.4546457415345, 5496.8408765217255, 5499.536599592569, 6813.091653125519, 6544.840399133824, 6605.731990843189, 6891.5761916488445, 7119.4015303282695, 6466.970606116278, 5146.0798509107835, 7530.620276519439, 5163.853866551136, 2178.494753171026, 1475.5915695877754, 4021.851623958898, 5508.773954483693, 4338.780167751285, 3499.1118276642806, 3566.784786017661, 5854.647327260284, 7923.89076510436, 7660.919301790746, 6584.0778635962915, 6152.525282723143, 3158.1161485373796, 6976.6282279477755, 8300.843790362687, 8538.22582887044, 8192.820112807727, 8173.755957344279, 411.402404766366, 365.2441679443714, 5037.880525428834, 4968.824517086043, 8224.117582159668, 6509.191356712779, 9425.157877297024, 7673.272006432374, 6491.625337581408, 6745.908116314251, 5398.250366173461, 4811.701582511738, 4144.924520152335, 4074.286116494625, 6120.664792124974, 5952.345530639353, 695.3271880507189, 779.4996469334379, 4542.99576626709, 4993.9395530543325, 7733.647226068155, 7573.56247948581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39903146098990866, "mean_inference_ms": 0.992041043837128, "mean_action_processing_ms": 0.16798924340930416, "mean_env_wait_ms": 0.054289961184646164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038671493530273438, "StateBufferConnector_ms": 0.002486109733581543, "ViewRequirementAgentConnector_ms": 0.07072138786315918}, "num_episodes": 24, "episode_return_max": 25049.862137033982, "episode_return_min": 789.5082366562999, "episode_return_mean": 19158.4139319712}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.5254784010622, "num_env_steps_trained_throughput_per_sec": 517.5254784010622, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1812000, "timers": {"training_iteration_time_ms": 7535.83, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7535.793, "sample_time_ms": 746.719, "learn_time_ms": 6777.425, "learn_throughput": 590.195, "synch_weights_time_ms": 11.07}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "done": false, "training_iteration": 151, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-48-52", "timestamp": 1723236532, "time_this_iter_s": 7.733108997344971, "time_total_s": 1145.9623477458954, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320701280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1145.9623477458954, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 26.063636363636366, "ram_util_percent": 82.57272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1514403024804.9778, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 193626843100.78308, "policy_loss": 0.015789365606806265, "vf_loss": 9.993108896225218, "vf_explained_var": -5.0861967934502494e-05, "kl": 0.013182369679909831, "entropy": 1.2721946231902592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8730935833261658, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993267119924228, "policy_loss": -0.0028267259023171693, "vf_loss": 9.99367332359155, "vf_explained_var": -0.00014334321022033692, "kl": 0.0026532887260448963, "entropy": 1.2418280236423016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 25049.862137033982, "episode_reward_min": 105.5614492810968, "episode_reward_mean": 18617.117423755393, "episode_len_mean": 187.44, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18744, "policy_reward_min": {"agent_policy": 0.5461919676050055, "adversary_policy": 34.850771162442044}, "policy_reward_max": {"agent_policy": 11920.018890038722, "adversary_policy": 11327.659783142188}, "policy_reward_mean": {"agent_policy": 6762.389712073417, "adversary_policy": 5927.3638558409875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23475.32183469076, 20635.768483783984, 21684.59270691299, 21609.162177641938, 20119.829067781153, 19084.758434300154, 16010.487399442049, 25049.862137033982, 18380.180861302528, 17650.629766588983, 19808.56110363241, 17242.208369772667, 24097.99187843086, 19239.340976488522, 19022.71219764415, 19376.777336504914, 21266.733602133172, 1052.9615969635638, 22028.801916459804, 18343.749316627367, 22927.820076607633, 17243.983595904203, 21993.36808348798, 19064.654844499386, 19760.41782355378, 21050.59899013305, 22572.493012928055, 23245.12177980985, 18258.10921248928, 19368.56227985773, 23319.787934181357, 17689.57977940379, 18711.732892081676, 21637.42774289715, 24132.327908903942, 18143.093956536297, 20125.194690127402, 4319.707213227842, 20776.622734832312, 21888.665681912982, 18727.02996371819, 18833.602947589374, 19807.429922086474, 19973.510792264267, 19945.011731234466, 17932.027829468945, 21177.58750803371, 21122.481924838317, 17646.699135260053, 24028.903765013452, 18474.017991825207, 20439.813994735345, 17902.543308149176, 20854.156232333997, 17934.59313705936, 19641.672223323512, 20109.94930954777, 20947.91453966026, 18851.760957847993, 19305.38316342183, 4445.440050571273, 18163.98724768987, 17603.385233813926, 17708.352230923167, 21634.380823751384, 20291.77052464465, 17300.25177226833, 22183.126756338585, 22039.93407631943, 789.5082366562999, 18551.180092442613, 20651.32698044372, 21815.40763016326, 20220.373139642306, 18859.03348408832, 18167.059123718234, 20038.1543006281, 1543.8553254745757, 18470.523171389523, 21639.87832732976, 17791.315217815343, 21281.448525872624, 20064.45193724602, 18630.90917963494, 21661.187182520913, 17983.372152732685, 21324.70176498255, 18687.001121461908, 19740.219273348626, 15452.673101804066, 20218.45485888232, 18555.670613645787, 18235.686991721625, 16925.8828785611, 18675.020742416018, 105.5614492810968, 18473.516652887723, 18431.572262248475, 17713.663508791204, 4576.712656463206], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 39], "policy_agent_policy_reward": [4289.165426271982, 6716.801050569162, 5787.031328811171, 5835.050834233211, 6852.89446604166, 7540.425592564919, 9305.39949889698, 2787.702460638291, 9078.615579448711, 9490.350641256819, 6082.544019867867, 10205.561687119689, 3729.8767362211206, 8473.885407982294, 8731.474174414685, 7884.462928293747, 6179.778977279201, 25.623108572958497, 5355.547738673362, 9273.038196714979, 4001.9235216000056, 9241.718496469555, 5790.817167823642, 5922.092191113552, 7825.373070535084, 6012.340845342399, 5038.413180470865, 4443.607762315446, 7720.25838839566, 7976.6264004881305, 4424.155974729119, 8881.895150025148, 7871.329671126504, 5783.315620353116, 2908.3263248165463, 9534.715066882403, 7305.783163548381, 493.74617583804246, 6342.551408329422, 5504.290791833274, 8320.972615000886, 8510.805643177384, 7317.972594238699, 4921.0116162237155, 7284.46451526212, 9323.68603918971, 6221.869762160719, 5269.042938456673, 9760.79920659431, 3536.9670602835827, 8067.5073705891555, 7447.954717646926, 8884.350822627897, 7164.938678523366, 8640.297614796156, 7329.043970605435, 6959.376919570734, 6936.936817683149, 7238.710500820924, 6610.90902035125, 791.3537278124743, 8633.361669247257, 9765.49323839834, 8286.920117645193, 6049.570756856262, 7555.167378325172, 7165.507395783175, 5344.057137105445, 5673.3580061674365, 12.861663945562583, 8544.475049927734, 5918.018041571283, 4716.977746433927, 6982.839685746667, 8649.081535403031, 9947.848487071224, 7965.143977863751, 69.02849049041905, 8933.5878520682, 6332.668621775766, 8833.826838894081, 6176.283504055228, 7629.415380394246, 8589.490315697887, 5457.88523709678, 9437.113920071906, 5492.95422459167, 7291.979229326424, 7856.384645680068, 11920.018890038722, 7113.693114912028, 9345.799882709056, 8206.587012520413, 9327.379161719999, 7922.530927885332, 0.5461919676050055, 8469.16284466316, 9084.782714480025, 7949.371164685483, 400.3167766014944], "policy_adversary_policy_reward": [9837.838641588507, 9348.31776683026, 7416.37723493134, 6502.590198283492, 8321.670463761686, 7575.890914340034, 7897.882055349247, 7876.229288059533, 6236.751089697042, 7030.183512042427, 6498.604820110826, 5045.728021624438, 1868.351775711114, 4836.736124833979, 11327.659783142188, 10934.499893253354, 4996.08341083664, 4305.481871017189, 4651.784982474134, 3508.4941428581087, 5666.42547990152, 8059.591603863083, 3498.6148933005315, 3538.0317893524557, 9958.582279631526, 10409.532862578299, 5098.129350824318, 5667.326217681915, 5371.352636913337, 4919.885386316103, 5868.413187983742, 5623.901220227445, 7134.756568160465, 7952.198056693469, 487.2761720143253, 540.0623163762796, 8675.35109171859, 7997.903086067777, 4227.299220183106, 4843.411899729329, 8786.633823423917, 10139.262731583683, 4900.417127261394, 3101.8479721733065, 7993.13457496335, 8209.416340700953, 8220.043432617395, 4922.519220768459, 6194.100156117975, 5740.944596900681, 6922.432373611497, 8115.825771179143, 9065.40356843125, 8468.67626402604, 9164.565208441229, 9636.948809053212, 4115.973588758328, 6421.877235335273, 5226.4464042611935, 6165.4894751084485, 9398.65653058509, 9496.975428867128, 3547.444155672788, 5260.240473705789, 4606.360039684062, 6234.043181271087, 7646.915729034287, 8207.19639350979, 11233.809298914372, 9990.192285172938, 4106.100429186469, 4502.278460467423, 6836.352460182569, 5983.059066396554, 2051.8382364335284, 1774.122800956272, 6677.41557197773, 7756.655754525189, 8490.896696573971, 7893.478193505733, 5077.810127643532, 5328.247221073837, 5622.344217462666, 4700.453086949334, 5948.674622101469, 6540.782705746291, 9221.12400750723, 5831.375168533294, 6058.218689186352, 6602.32852678598, 3789.8922057379814, 4818.449584541246, 7036.546255125244, 7919.171490747811, 8815.312899529627, 7038.1260868520285, 3593.227114825481, 4292.672813840273, 10109.59011373571, 10382.346590994144, 6022.468019282094, 4384.042601953898, 6321.769844345176, 6670.089432743251, 4906.950429263382, 4111.242056257955, 6779.710239788656, 6909.507314022028, 3797.4546457415345, 5496.8408765217255, 5499.536599592569, 6813.091653125519, 6544.840399133824, 6605.731990843189, 6891.5761916488445, 7119.4015303282695, 6466.970606116278, 5146.0798509107835, 7530.620276519439, 5163.853866551136, 2178.494753171026, 1475.5915695877754, 4021.851623958898, 5508.773954483693, 4338.780167751285, 3499.1118276642806, 3566.784786017661, 5854.647327260284, 7923.89076510436, 7660.919301790746, 6584.0778635962915, 6152.525282723143, 3158.1161485373796, 6976.6282279477755, 8300.843790362687, 8538.22582887044, 8192.820112807727, 8173.755957344279, 411.402404766366, 365.2441679443714, 5037.880525428834, 4968.824517086043, 8224.117582159668, 6509.191356712779, 9425.157877297024, 7673.272006432374, 6491.625337581408, 6745.908116314251, 5398.250366173461, 4811.701582511738, 4144.924520152335, 4074.286116494625, 6120.664792124974, 5952.345530639353, 695.3271880507189, 779.4996469334379, 4542.99576626709, 4993.9395530543325, 7733.647226068155, 7573.56247948581, 5308.30878483687, 3649.1795940844063, 7177.226415884997, 7927.938605932407, 6323.583076788813, 6111.453480062967, 4517.153444543187, 5524.265419393868, 8468.618030548445, 7734.683914875666, 3881.6623168881238, 4664.595915772658, 8570.684798582743, 7261.062741808122, 6850.156394404523, 4544.865497730955, 6243.021061185444, 5640.813566483158, 1411.6853892027052, 2120.968822562698, 6079.6643680866355, 7025.097375883724, 4794.836407165509, 4415.03432377129, 5935.548611210539, 4093.551367990703, 2783.747254830196, 4814.756462010964, 6219.604695845626, 4532.8851186850925, 70.16448615104974, 34.850771162442044, 5154.76274272207, 4849.591065502505, 5025.947766881965, 4320.841780886462, 3571.5278850602413, 6192.764459045473, 1968.6519501523514, 2207.7439297093597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39896328980673795, "mean_inference_ms": 0.9919631314512241, "mean_action_processing_ms": 0.16796703083051226, "mean_env_wait_ms": 0.05429848008754102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039054155349731445, "StateBufferConnector_ms": 0.0024836063385009766, "ViewRequirementAgentConnector_ms": 0.06937265396118164}, "num_episodes": 20, "episode_return_max": 25049.862137033982, "episode_return_min": 105.5614492810968, "episode_return_mean": 18617.117423755393}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.4080689005169, "num_env_steps_trained_throughput_per_sec": 534.4080689005169, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 7565.012, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7564.975, "sample_time_ms": 747.537, "learn_time_ms": 6805.796, "learn_throughput": 587.734, "synch_weights_time_ms": 11.056}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 152, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-00", "timestamp": 1723236540, "time_this_iter_s": 7.490238904953003, "time_total_s": 1153.4525866508484, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bae430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1153.4525866508484, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 24.936363636363637, "ram_util_percent": 82.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1741753368177.236, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 220113249350.43387, "policy_loss": 0.019136374561786258, "vf_loss": 10.0, "vf_explained_var": -2.505690963179977e-05, "kl": 0.014985598998868631, "entropy": 1.270258818480073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8329659322897593, "cur_kl_coeff": 0.45613946914672865, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996763264139494, "policy_loss": -0.004352325812942581, "vf_loss": 9.996006911993026, "vf_explained_var": -0.00012586495528618495, "kl": 0.011199770011201812, "entropy": 1.1895237108071646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "env_runners": {"episode_reward_max": 24132.327908903942, "episode_reward_min": 105.5614492810968, "episode_reward_mean": 18401.105594633293, "episode_len_mean": 187.61, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18761, "policy_reward_min": {"agent_policy": 0.5461919676050055, "adversary_policy": 34.850771162442044}, "policy_reward_max": {"agent_policy": 11920.018890038722, "adversary_policy": 11233.809298914372}, "policy_reward_mean": {"agent_policy": 6961.335194320933, "adversary_policy": 5719.885200156183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21993.36808348798, 19064.654844499386, 19760.41782355378, 21050.59899013305, 22572.493012928055, 23245.12177980985, 18258.10921248928, 19368.56227985773, 23319.787934181357, 17689.57977940379, 18711.732892081676, 21637.42774289715, 24132.327908903942, 18143.093956536297, 20125.194690127402, 4319.707213227842, 20776.622734832312, 21888.665681912982, 18727.02996371819, 18833.602947589374, 19807.429922086474, 19973.510792264267, 19945.011731234466, 17932.027829468945, 21177.58750803371, 21122.481924838317, 17646.699135260053, 24028.903765013452, 18474.017991825207, 20439.813994735345, 17902.543308149176, 20854.156232333997, 17934.59313705936, 19641.672223323512, 20109.94930954777, 20947.91453966026, 18851.760957847993, 19305.38316342183, 4445.440050571273, 18163.98724768987, 17603.385233813926, 17708.352230923167, 21634.380823751384, 20291.77052464465, 17300.25177226833, 22183.126756338585, 22039.93407631943, 789.5082366562999, 18551.180092442613, 20651.32698044372, 21815.40763016326, 20220.373139642306, 18859.03348408832, 18167.059123718234, 20038.1543006281, 1543.8553254745757, 18470.523171389523, 21639.87832732976, 17791.315217815343, 21281.448525872624, 20064.45193724602, 18630.90917963494, 21661.187182520913, 17983.372152732685, 21324.70176498255, 18687.001121461908, 19740.219273348626, 15452.673101804066, 20218.45485888232, 18555.670613645787, 18235.686991721625, 16925.8828785611, 18675.020742416018, 105.5614492810968, 18473.516652887723, 18431.572262248475, 17713.663508791204, 4576.712656463206, 17454.03285793985, 17292.201249548256, 20939.42278595377, 20801.722630022072, 17651.487500696963, 18216.065297275225, 18177.97697265469, 19264.673395632253, 3150.571738074696, 23587.152299971473, 18089.384831899206, 18587.61781096379, 21455.580244286535, 16780.417428809422, 22514.823434082005, 18349.87687373821, 19425.812303847528, 16757.558740720397, 21570.71680836634, 18010.31424195045, 19412.38400868501, 16261.258469320215], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 39, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5790.817167823642, 5922.092191113552, 7825.373070535084, 6012.340845342399, 5038.413180470865, 4443.607762315446, 7720.25838839566, 7976.6264004881305, 4424.155974729119, 8881.895150025148, 7871.329671126504, 5783.315620353116, 2908.3263248165463, 9534.715066882403, 7305.783163548381, 493.74617583804246, 6342.551408329422, 5504.290791833274, 8320.972615000886, 8510.805643177384, 7317.972594238699, 4921.0116162237155, 7284.46451526212, 9323.68603918971, 6221.869762160719, 5269.042938456673, 9760.79920659431, 3536.9670602835827, 8067.5073705891555, 7447.954717646926, 8884.350822627897, 7164.938678523366, 8640.297614796156, 7329.043970605435, 6959.376919570734, 6936.936817683149, 7238.710500820924, 6610.90902035125, 791.3537278124743, 8633.361669247257, 9765.49323839834, 8286.920117645193, 6049.570756856262, 7555.167378325172, 7165.507395783175, 5344.057137105445, 5673.3580061674365, 12.861663945562583, 8544.475049927734, 5918.018041571283, 4716.977746433927, 6982.839685746667, 8649.081535403031, 9947.848487071224, 7965.143977863751, 69.02849049041905, 8933.5878520682, 6332.668621775766, 8833.826838894081, 6176.283504055228, 7629.415380394246, 8589.490315697887, 5457.88523709678, 9437.113920071906, 5492.95422459167, 7291.979229326424, 7856.384645680068, 11920.018890038722, 7113.693114912028, 9345.799882709056, 8206.587012520413, 9327.379161719999, 7922.530927885332, 0.5461919676050055, 8469.16284466316, 9084.782714480025, 7949.371164685483, 400.3167766014944, 8087.660830728407, 9862.543392876887, 6343.527904247378, 6849.603845391682, 10006.916604019647, 9617.925328104544, 9973.450757716773, 6865.510854280855, 167.14403873752045, 4088.0777640782, 9153.500807440128, 5969.679578061647, 5826.115652726834, 10778.46904066531, 4753.414093992147, 9532.150890395813, 7974.886696287187, 10278.925296835443, 5504.026854705411, 8745.705863244691, 7274.633959896861, 9109.550042260453], "policy_adversary_policy_reward": [7993.13457496335, 8209.416340700953, 8220.043432617395, 4922.519220768459, 6194.100156117975, 5740.944596900681, 6922.432373611497, 8115.825771179143, 9065.40356843125, 8468.67626402604, 9164.565208441229, 9636.948809053212, 4115.973588758328, 6421.877235335273, 5226.4464042611935, 6165.4894751084485, 9398.65653058509, 9496.975428867128, 3547.444155672788, 5260.240473705789, 4606.360039684062, 6234.043181271087, 7646.915729034287, 8207.19639350979, 11233.809298914372, 9990.192285172938, 4106.100429186469, 4502.278460467423, 6836.352460182569, 5983.059066396554, 2051.8382364335284, 1774.122800956272, 6677.41557197773, 7756.655754525189, 8490.896696573971, 7893.478193505733, 5077.810127643532, 5328.247221073837, 5622.344217462666, 4700.453086949334, 5948.674622101469, 6540.782705746291, 9221.12400750723, 5831.375168533294, 6058.218689186352, 6602.32852678598, 3789.8922057379814, 4818.449584541246, 7036.546255125244, 7919.171490747811, 8815.312899529627, 7038.1260868520285, 3593.227114825481, 4292.672813840273, 10109.59011373571, 10382.346590994144, 6022.468019282094, 4384.042601953898, 6321.769844345176, 6670.089432743251, 4906.950429263382, 4111.242056257955, 6779.710239788656, 6909.507314022028, 3797.4546457415345, 5496.8408765217255, 5499.536599592569, 6813.091653125519, 6544.840399133824, 6605.731990843189, 6891.5761916488445, 7119.4015303282695, 6466.970606116278, 5146.0798509107835, 7530.620276519439, 5163.853866551136, 2178.494753171026, 1475.5915695877754, 4021.851623958898, 5508.773954483693, 4338.780167751285, 3499.1118276642806, 3566.784786017661, 5854.647327260284, 7923.89076510436, 7660.919301790746, 6584.0778635962915, 6152.525282723143, 3158.1161485373796, 6976.6282279477755, 8300.843790362687, 8538.22582887044, 8192.820112807727, 8173.755957344279, 411.402404766366, 365.2441679443714, 5037.880525428834, 4968.824517086043, 8224.117582159668, 6509.191356712779, 9425.157877297024, 7673.272006432374, 6491.625337581408, 6745.908116314251, 5398.250366173461, 4811.701582511738, 4144.924520152335, 4074.286116494625, 6120.664792124974, 5952.345530639353, 695.3271880507189, 779.4996469334379, 4542.99576626709, 4993.9395530543325, 7733.647226068155, 7573.56247948581, 5308.30878483687, 3649.1795940844063, 7177.226415884997, 7927.938605932407, 6323.583076788813, 6111.453480062967, 4517.153444543187, 5524.265419393868, 8468.618030548445, 7734.683914875666, 3881.6623168881238, 4664.595915772658, 8570.684798582743, 7261.062741808122, 6850.156394404523, 4544.865497730955, 6243.021061185444, 5640.813566483158, 1411.6853892027052, 2120.968822562698, 6079.6643680866355, 7025.097375883724, 4794.836407165509, 4415.03432377129, 5935.548611210539, 4093.551367990703, 2783.747254830196, 4814.756462010964, 6219.604695845626, 4532.8851186850925, 70.16448615104974, 34.850771162442044, 5154.76274272207, 4849.591065502505, 5025.947766881965, 4320.841780886462, 3571.5278850602413, 6192.764459045473, 1968.6519501523514, 2207.7439297093597, 3311.8972342088914, 6054.4747930025405, 3189.9006419151597, 4239.757214756204, 6797.287162222868, 7798.607719483576, 6713.332527653026, 7238.786256977381, 4114.710585024005, 3529.8603116533122, 4128.630777314249, 4469.50919185644, 4074.2956322429136, 4130.230582695082, 5122.53777190127, 7276.624769450091, 1441.7251830539908, 1541.7025162831847, 9607.554343493235, 9891.520192399985, 3947.249208168203, 4988.634816290824, 8144.074168852425, 4473.864064049663, 8296.879309156511, 7332.585282403128, 3333.7248926769357, 2668.223495467191, 9388.620053503098, 8372.789286586758, 4251.125850268424, 4566.600133073937, 6014.012150925148, 5436.913456635244, 2787.8830193547624, 3690.7504245301425, 8619.105870201829, 7447.584083459131, 3868.178618219528, 5396.4297604862695, 6863.972096416734, 5273.777952371444, 2119.1228455892956, 5032.585581470502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39873698453679396, "mean_inference_ms": 0.9917319080803944, "mean_action_processing_ms": 0.1678644135968834, "mean_env_wait_ms": 0.054300032739568224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003299713134765625, "StateBufferConnector_ms": 0.002389192581176758, "ViewRequirementAgentConnector_ms": 0.06624937057495117}, "num_episodes": 22, "episode_return_max": 24132.327908903942, "episode_return_min": 105.5614492810968, "episode_return_mean": 18401.105594633293}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.1322161653941, "num_env_steps_trained_throughput_per_sec": 536.1322161653941, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1836000, "timers": {"training_iteration_time_ms": 7577.817, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7577.78, "sample_time_ms": 744.475, "learn_time_ms": 6821.755, "learn_throughput": 586.359, "synch_weights_time_ms": 11.028}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "done": false, "training_iteration": 153, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-07", "timestamp": 1723236547, "time_this_iter_s": 7.4652369022369385, "time_total_s": 1160.9178235530853, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3baeaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1160.9178235530853, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 25.563636363636363, "ram_util_percent": 81.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1402546714868.893, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 235595776394.42963, "policy_loss": 0.01980112935342486, "vf_loss": 10.0, "vf_explained_var": 4.028226963426701e-05, "kl": 0.016039669771910344, "entropy": 1.2680854654185987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8096117005605872, "cur_kl_coeff": 0.45613946914672865, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99678702354431, "policy_loss": -0.0026517364133421023, "vf_loss": 9.995060885945955, "vf_explained_var": -4.923635472853978e-05, "kl": 0.009597678936552256, "entropy": 1.1377750186870494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": 24028.903765013452, "episode_reward_min": 105.5614492810968, "episode_reward_mean": 18095.73777568899, "episode_len_mean": 187.31, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18731, "policy_reward_min": {"agent_policy": 0.5461919676050055, "adversary_policy": 34.850771162442044}, "policy_reward_max": {"agent_policy": 11920.018890038722, "adversary_policy": 10382.346590994144}, "policy_reward_mean": {"agent_policy": 7209.56594249612, "adversary_policy": 5443.085916596437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19807.429922086474, 19973.510792264267, 19945.011731234466, 17932.027829468945, 21177.58750803371, 21122.481924838317, 17646.699135260053, 24028.903765013452, 18474.017991825207, 20439.813994735345, 17902.543308149176, 20854.156232333997, 17934.59313705936, 19641.672223323512, 20109.94930954777, 20947.91453966026, 18851.760957847993, 19305.38316342183, 4445.440050571273, 18163.98724768987, 17603.385233813926, 17708.352230923167, 21634.380823751384, 20291.77052464465, 17300.25177226833, 22183.126756338585, 22039.93407631943, 789.5082366562999, 18551.180092442613, 20651.32698044372, 21815.40763016326, 20220.373139642306, 18859.03348408832, 18167.059123718234, 20038.1543006281, 1543.8553254745757, 18470.523171389523, 21639.87832732976, 17791.315217815343, 21281.448525872624, 20064.45193724602, 18630.90917963494, 21661.187182520913, 17983.372152732685, 21324.70176498255, 18687.001121461908, 19740.219273348626, 15452.673101804066, 20218.45485888232, 18555.670613645787, 18235.686991721625, 16925.8828785611, 18675.020742416018, 105.5614492810968, 18473.516652887723, 18431.572262248475, 17713.663508791204, 4576.712656463206, 17454.03285793985, 17292.201249548256, 20939.42278595377, 20801.722630022072, 17651.487500696963, 18216.065297275225, 18177.97697265469, 19264.673395632253, 3150.571738074696, 23587.152299971473, 18089.384831899206, 18587.61781096379, 21455.580244286535, 16780.417428809422, 22514.823434082005, 18349.87687373821, 19425.812303847528, 16757.558740720397, 21570.71680836634, 18010.31424195045, 19412.38400868501, 16261.258469320215, 19877.047780657176, 18848.70560510658, 19762.335531886278, 20992.752599405878, 18341.97850721064, 17831.060875321316, 20510.642941787344, 20631.64465239352, 18429.172766273943, 20627.395200241965, 579.2222521705618, 17066.045681651274, 18414.11547003329, 17972.557025309667, 18646.47177940007, 20178.26066608495, 19165.58680345477, 17330.55699876115, 19866.595796073718, 18009.16864451705], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 42, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 39, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7317.972594238699, 4921.0116162237155, 7284.46451526212, 9323.68603918971, 6221.869762160719, 5269.042938456673, 9760.79920659431, 3536.9670602835827, 8067.5073705891555, 7447.954717646926, 8884.350822627897, 7164.938678523366, 8640.297614796156, 7329.043970605435, 6959.376919570734, 6936.936817683149, 7238.710500820924, 6610.90902035125, 791.3537278124743, 8633.361669247257, 9765.49323839834, 8286.920117645193, 6049.570756856262, 7555.167378325172, 7165.507395783175, 5344.057137105445, 5673.3580061674365, 12.861663945562583, 8544.475049927734, 5918.018041571283, 4716.977746433927, 6982.839685746667, 8649.081535403031, 9947.848487071224, 7965.143977863751, 69.02849049041905, 8933.5878520682, 6332.668621775766, 8833.826838894081, 6176.283504055228, 7629.415380394246, 8589.490315697887, 5457.88523709678, 9437.113920071906, 5492.95422459167, 7291.979229326424, 7856.384645680068, 11920.018890038722, 7113.693114912028, 9345.799882709056, 8206.587012520413, 9327.379161719999, 7922.530927885332, 0.5461919676050055, 8469.16284466316, 9084.782714480025, 7949.371164685483, 400.3167766014944, 8087.660830728407, 9862.543392876887, 6343.527904247378, 6849.603845391682, 10006.916604019647, 9617.925328104544, 9973.450757716773, 6865.510854280855, 167.14403873752045, 4088.0777640782, 9153.500807440128, 5969.679578061647, 5826.115652726834, 10778.46904066531, 4753.414093992147, 9532.150890395813, 7974.886696287187, 10278.925296835443, 5504.026854705411, 8745.705863244691, 7274.633959896861, 9109.550042260453, 6768.691443685507, 8143.387353871205, 8366.33376697459, 6281.510314498055, 7283.510084116256, 8615.481913240706, 6865.706905329285, 6454.622060503069, 9056.131717094826, 5184.983249481781, 23.548078873996435, 10772.47864868694, 7189.259198497585, 9384.979320487213, 9093.89165230009, 6451.982331840026, 8400.235901556976, 9980.097749205865, 7613.589864589243, 9504.069874830571], "policy_adversary_policy_reward": [5948.674622101469, 6540.782705746291, 9221.12400750723, 5831.375168533294, 6058.218689186352, 6602.32852678598, 3789.8922057379814, 4818.449584541246, 7036.546255125244, 7919.171490747811, 8815.312899529627, 7038.1260868520285, 3593.227114825481, 4292.672813840273, 10109.59011373571, 10382.346590994144, 6022.468019282094, 4384.042601953898, 6321.769844345176, 6670.089432743251, 4906.950429263382, 4111.242056257955, 6779.710239788656, 6909.507314022028, 3797.4546457415345, 5496.8408765217255, 5499.536599592569, 6813.091653125519, 6544.840399133824, 6605.731990843189, 6891.5761916488445, 7119.4015303282695, 6466.970606116278, 5146.0798509107835, 7530.620276519439, 5163.853866551136, 2178.494753171026, 1475.5915695877754, 4021.851623958898, 5508.773954483693, 4338.780167751285, 3499.1118276642806, 3566.784786017661, 5854.647327260284, 7923.89076510436, 7660.919301790746, 6584.0778635962915, 6152.525282723143, 3158.1161485373796, 6976.6282279477755, 8300.843790362687, 8538.22582887044, 8192.820112807727, 8173.755957344279, 411.402404766366, 365.2441679443714, 5037.880525428834, 4968.824517086043, 8224.117582159668, 6509.191356712779, 9425.157877297024, 7673.272006432374, 6491.625337581408, 6745.908116314251, 5398.250366173461, 4811.701582511738, 4144.924520152335, 4074.286116494625, 6120.664792124974, 5952.345530639353, 695.3271880507189, 779.4996469334379, 4542.99576626709, 4993.9395530543325, 7733.647226068155, 7573.56247948581, 5308.30878483687, 3649.1795940844063, 7177.226415884997, 7927.938605932407, 6323.583076788813, 6111.453480062967, 4517.153444543187, 5524.265419393868, 8468.618030548445, 7734.683914875666, 3881.6623168881238, 4664.595915772658, 8570.684798582743, 7261.062741808122, 6850.156394404523, 4544.865497730955, 6243.021061185444, 5640.813566483158, 1411.6853892027052, 2120.968822562698, 6079.6643680866355, 7025.097375883724, 4794.836407165509, 4415.03432377129, 5935.548611210539, 4093.551367990703, 2783.747254830196, 4814.756462010964, 6219.604695845626, 4532.8851186850925, 70.16448615104974, 34.850771162442044, 5154.76274272207, 4849.591065502505, 5025.947766881965, 4320.841780886462, 3571.5278850602413, 6192.764459045473, 1968.6519501523514, 2207.7439297093597, 3311.8972342088914, 6054.4747930025405, 3189.9006419151597, 4239.757214756204, 6797.287162222868, 7798.607719483576, 6713.332527653026, 7238.786256977381, 4114.710585024005, 3529.8603116533122, 4128.630777314249, 4469.50919185644, 4074.2956322429136, 4130.230582695082, 5122.53777190127, 7276.624769450091, 1441.7251830539908, 1541.7025162831847, 9607.554343493235, 9891.520192399985, 3947.249208168203, 4988.634816290824, 8144.074168852425, 4473.864064049663, 8296.879309156511, 7332.585282403128, 3333.7248926769357, 2668.223495467191, 9388.620053503098, 8372.789286586758, 4251.125850268424, 4566.600133073937, 6014.012150925148, 5436.913456635244, 2787.8830193547624, 3690.7504245301425, 8619.105870201829, 7447.584083459131, 3868.178618219528, 5396.4297604862695, 6863.972096416734, 5273.777952371444, 2119.1228455892956, 5032.585581470502, 7373.44418004545, 5734.912156926208, 4706.569981375595, 5998.748269859743, 5629.134582244583, 5766.867182667125, 7614.436335608358, 7096.805949299417, 6858.625539614687, 4199.842883479686, 5502.756962575811, 3712.8219995048235, 6377.1045646061975, 7267.831471851894, 6768.301212395621, 7408.721379494764, 4529.40601086037, 4843.635038318781, 6665.288695541503, 8777.123255218656, 400.7159898379321, 154.95818345863336, 3256.701914922424, 3036.865118041916, 6952.876425233371, 4271.979846302374, 4743.127048049328, 3844.450656773117, 4507.560719547008, 5045.0194075530035, 6036.125042354009, 7690.153291890924, 5178.556493367592, 5586.7944085301715, 3970.280033747072, 3380.17921580824, 6190.1296711663335, 6062.876260318137, 3935.5777290064207, 4569.5210406800325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3985983779393649, "mean_inference_ms": 0.9914175293390467, "mean_action_processing_ms": 0.16783751882731995, "mean_env_wait_ms": 0.054286681744837105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033304691314697266, "StateBufferConnector_ms": 0.0024199485778808594, "ViewRequirementAgentConnector_ms": 0.0653829574584961}, "num_episodes": 20, "episode_return_max": 24028.903765013452, "episode_return_min": 105.5614492810968, "episode_return_mean": 18095.73777568899}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.439535518404, "num_env_steps_trained_throughput_per_sec": 542.439535518404, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 7596.376, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7596.339, "sample_time_ms": 748.82, "learn_time_ms": 6835.807, "learn_throughput": 585.154, "synch_weights_time_ms": 11.19}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 154, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-15", "timestamp": 1723236555, "time_this_iter_s": 7.378859996795654, "time_total_s": 1168.296683549881, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3baeee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1168.296683549881, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 25.5, "ram_util_percent": 81.81818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1165555118171.0222, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 179399925948.54602, "policy_loss": 0.015377565983574462, "vf_loss": 10.0, "vf_explained_var": -2.5932183341374473e-05, "kl": 0.01221378249370015, "entropy": 1.2619733699415097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.78080999632366, "cur_kl_coeff": 0.45613946914672865, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999897278348605, "policy_loss": -0.007178092353084745, "vf_loss": 10.0, "vf_explained_var": -2.3444058994452157e-05, "kl": 0.015511406988177137, "entropy": 1.1187094006687404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "env_runners": {"episode_reward_max": 23587.152299971473, "episode_reward_min": 105.5614492810968, "episode_reward_mean": 17968.686569094603, "episode_len_mean": 188.89, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 18889, "policy_reward_min": {"agent_policy": 0.5461919676050055, "adversary_policy": 34.850771162442044}, "policy_reward_max": {"agent_policy": 11920.018890038722, "adversary_policy": 9891.520192399985}, "policy_reward_mean": {"agent_policy": 7608.946995501036, "adversary_policy": 5179.869786796785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17603.385233813926, 17708.352230923167, 21634.380823751384, 20291.77052464465, 17300.25177226833, 22183.126756338585, 22039.93407631943, 789.5082366562999, 18551.180092442613, 20651.32698044372, 21815.40763016326, 20220.373139642306, 18859.03348408832, 18167.059123718234, 20038.1543006281, 1543.8553254745757, 18470.523171389523, 21639.87832732976, 17791.315217815343, 21281.448525872624, 20064.45193724602, 18630.90917963494, 21661.187182520913, 17983.372152732685, 21324.70176498255, 18687.001121461908, 19740.219273348626, 15452.673101804066, 20218.45485888232, 18555.670613645787, 18235.686991721625, 16925.8828785611, 18675.020742416018, 105.5614492810968, 18473.516652887723, 18431.572262248475, 17713.663508791204, 4576.712656463206, 17454.03285793985, 17292.201249548256, 20939.42278595377, 20801.722630022072, 17651.487500696963, 18216.065297275225, 18177.97697265469, 19264.673395632253, 3150.571738074696, 23587.152299971473, 18089.384831899206, 18587.61781096379, 21455.580244286535, 16780.417428809422, 22514.823434082005, 18349.87687373821, 19425.812303847528, 16757.558740720397, 21570.71680836634, 18010.31424195045, 19412.38400868501, 16261.258469320215, 19877.047780657176, 18848.70560510658, 19762.335531886278, 20992.752599405878, 18341.97850721064, 17831.060875321316, 20510.642941787344, 20631.64465239352, 18429.172766273943, 20627.395200241965, 579.2222521705618, 17066.045681651274, 18414.11547003329, 17972.557025309667, 18646.47177940007, 20178.26066608495, 19165.58680345477, 17330.55699876115, 19866.595796073718, 18009.16864451705, 21495.06256178147, 17997.49077782278, 17851.692395058908, 17368.45373594158, 17125.59033820075, 20252.42255372996, 20131.00097611084, 20695.240221415603, 17989.896672386334, 18831.907173512063, 18034.366581587095, 15973.309737542502, 18363.753955016695, 17260.384381911295, 18666.271423857834, 17499.307705648243, 18132.1440346022, 17696.78417507434, 17500.27057318523, 17134.41413054054], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 12, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 39, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9765.49323839834, 8286.920117645193, 6049.570756856262, 7555.167378325172, 7165.507395783175, 5344.057137105445, 5673.3580061674365, 12.861663945562583, 8544.475049927734, 5918.018041571283, 4716.977746433927, 6982.839685746667, 8649.081535403031, 9947.848487071224, 7965.143977863751, 69.02849049041905, 8933.5878520682, 6332.668621775766, 8833.826838894081, 6176.283504055228, 7629.415380394246, 8589.490315697887, 5457.88523709678, 9437.113920071906, 5492.95422459167, 7291.979229326424, 7856.384645680068, 11920.018890038722, 7113.693114912028, 9345.799882709056, 8206.587012520413, 9327.379161719999, 7922.530927885332, 0.5461919676050055, 8469.16284466316, 9084.782714480025, 7949.371164685483, 400.3167766014944, 8087.660830728407, 9862.543392876887, 6343.527904247378, 6849.603845391682, 10006.916604019647, 9617.925328104544, 9973.450757716773, 6865.510854280855, 167.14403873752045, 4088.0777640782, 9153.500807440128, 5969.679578061647, 5826.115652726834, 10778.46904066531, 4753.414093992147, 9532.150890395813, 7974.886696287187, 10278.925296835443, 5504.026854705411, 8745.705863244691, 7274.633959896861, 9109.550042260453, 6768.691443685507, 8143.387353871205, 8366.33376697459, 6281.510314498055, 7283.510084116256, 8615.481913240706, 6865.706905329285, 6454.622060503069, 9056.131717094826, 5184.983249481781, 23.548078873996435, 10772.47864868694, 7189.259198497585, 9384.979320487213, 9093.89165230009, 6451.982331840026, 8400.235901556976, 9980.097749205865, 7613.589864589243, 9504.069874830571, 6376.360454370177, 9633.379076274969, 9890.375293007884, 9505.281313533618, 10204.137625239711, 7302.27127695156, 7352.569681639418, 7103.354073083229, 9275.32678324213, 8646.153004116624, 9109.222024986926, 8838.985064968574, 8523.48869596593, 9848.344286430915, 9211.537008823854, 9757.879172559784, 8703.424610546273, 9945.60864487557, 9854.658782470307, 9196.303990088238], "policy_adversary_policy_reward": [4338.780167751285, 3499.1118276642806, 3566.784786017661, 5854.647327260284, 7923.89076510436, 7660.919301790746, 6584.0778635962915, 6152.525282723143, 3158.1161485373796, 6976.6282279477755, 8300.843790362687, 8538.22582887044, 8192.820112807727, 8173.755957344279, 411.402404766366, 365.2441679443714, 5037.880525428834, 4968.824517086043, 8224.117582159668, 6509.191356712779, 9425.157877297024, 7673.272006432374, 6491.625337581408, 6745.908116314251, 5398.250366173461, 4811.701582511738, 4144.924520152335, 4074.286116494625, 6120.664792124974, 5952.345530639353, 695.3271880507189, 779.4996469334379, 4542.99576626709, 4993.9395530543325, 7733.647226068155, 7573.56247948581, 5308.30878483687, 3649.1795940844063, 7177.226415884997, 7927.938605932407, 6323.583076788813, 6111.453480062967, 4517.153444543187, 5524.265419393868, 8468.618030548445, 7734.683914875666, 3881.6623168881238, 4664.595915772658, 8570.684798582743, 7261.062741808122, 6850.156394404523, 4544.865497730955, 6243.021061185444, 5640.813566483158, 1411.6853892027052, 2120.968822562698, 6079.6643680866355, 7025.097375883724, 4794.836407165509, 4415.03432377129, 5935.548611210539, 4093.551367990703, 2783.747254830196, 4814.756462010964, 6219.604695845626, 4532.8851186850925, 70.16448615104974, 34.850771162442044, 5154.76274272207, 4849.591065502505, 5025.947766881965, 4320.841780886462, 3571.5278850602413, 6192.764459045473, 1968.6519501523514, 2207.7439297093597, 3311.8972342088914, 6054.4747930025405, 3189.9006419151597, 4239.757214756204, 6797.287162222868, 7798.607719483576, 6713.332527653026, 7238.786256977381, 4114.710585024005, 3529.8603116533122, 4128.630777314249, 4469.50919185644, 4074.2956322429136, 4130.230582695082, 5122.53777190127, 7276.624769450091, 1441.7251830539908, 1541.7025162831847, 9607.554343493235, 9891.520192399985, 3947.249208168203, 4988.634816290824, 8144.074168852425, 4473.864064049663, 8296.879309156511, 7332.585282403128, 3333.7248926769357, 2668.223495467191, 9388.620053503098, 8372.789286586758, 4251.125850268424, 4566.600133073937, 6014.012150925148, 5436.913456635244, 2787.8830193547624, 3690.7504245301425, 8619.105870201829, 7447.584083459131, 3868.178618219528, 5396.4297604862695, 6863.972096416734, 5273.777952371444, 2119.1228455892956, 5032.585581470502, 7373.44418004545, 5734.912156926208, 4706.569981375595, 5998.748269859743, 5629.134582244583, 5766.867182667125, 7614.436335608358, 7096.805949299417, 6858.625539614687, 4199.842883479686, 5502.756962575811, 3712.8219995048235, 6377.1045646061975, 7267.831471851894, 6768.301212395621, 7408.721379494764, 4529.40601086037, 4843.635038318781, 6665.288695541503, 8777.123255218656, 400.7159898379321, 154.95818345863336, 3256.701914922424, 3036.865118041916, 6952.876425233371, 4271.979846302374, 4743.127048049328, 3844.450656773117, 4507.560719547008, 5045.0194075530035, 6036.125042354009, 7690.153291890924, 5178.556493367592, 5586.7944085301715, 3970.280033747072, 3380.17921580824, 6190.1296711663335, 6062.876260318137, 3935.5777290064207, 4569.5210406800325, 7584.637809061261, 7534.064298350083, 4169.99644107181, 4194.115260475951, 3748.696616695296, 4212.620485355713, 3755.5297689628383, 4107.642653445098, 2997.308848099459, 3924.143864861561, 6784.770143956376, 6165.381132822054, 6729.731808008047, 6048.699486463365, 6716.786313145626, 6875.099835186729, 4112.353193849711, 4602.216695294529, 5304.737970990145, 4881.016198405302, 4035.293031022832, 4889.851525577378, 5303.1505587623815, 1831.174113811419, 4756.737065027848, 5083.528194022938, 3943.575721385754, 3468.464374094614, 4752.042509636715, 4702.691905397284, 3848.353038676642, 3893.0754944118885, 5224.566832846176, 4204.152591209736, 4104.903780903532, 3646.271749295189, 3596.1009134799397, 4049.510877235038, 2992.2785068096205, 4945.831633642719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3984346494821136, "mean_inference_ms": 0.9909990916593281, "mean_action_processing_ms": 0.16779031668509328, "mean_env_wait_ms": 0.05427084766734775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034246444702148438, "StateBufferConnector_ms": 0.00251615047454834, "ViewRequirementAgentConnector_ms": 0.06570839881896973}, "num_episodes": 20, "episode_return_max": 23587.152299971473, "episode_return_min": 105.5614492810968, "episode_return_mean": 17968.686569094603}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.0450325156983, "num_env_steps_trained_throughput_per_sec": 523.0450325156983, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1860000, "timers": {"training_iteration_time_ms": 7635.668, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7635.632, "sample_time_ms": 750.535, "learn_time_ms": 6872.97, "learn_throughput": 581.99, "synch_weights_time_ms": 11.544}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "done": false, "training_iteration": 155, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-23", "timestamp": 1723236563, "time_this_iter_s": 7.6519081592559814, "time_total_s": 1175.948591709137, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b3dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1175.948591709137, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 32.800000000000004, "ram_util_percent": 81.80909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1250292042974.1375, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 221937564852.96085, "policy_loss": 0.01980102137950737, "vf_loss": 9.98768237431844, "vf_explained_var": 6.899001106383309e-06, "kl": 0.015109800796945969, "entropy": 1.2538753618008245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8183121258703371, "cur_kl_coeff": 0.45613946914672865, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.009020574887593, "policy_loss": -0.0005900526477489621, "vf_loss": 10.0, "vf_explained_var": -0.0001037535568078359, "kl": 0.02106952323859635, "entropy": 1.146726561834415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 23587.152299971473, "episode_reward_min": 105.5614492810968, "episode_reward_mean": 18109.450063865526, "episode_len_mean": 192.71, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19271, "policy_reward_min": {"agent_policy": 0.5461919676050055, "adversary_policy": 34.850771162442044}, "policy_reward_max": {"agent_policy": 11920.018890038722, "adversary_policy": 9891.520192399985}, "policy_reward_mean": {"agent_policy": 7888.508456830896, "adversary_policy": 5110.470803517314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18630.90917963494, 21661.187182520913, 17983.372152732685, 21324.70176498255, 18687.001121461908, 19740.219273348626, 15452.673101804066, 20218.45485888232, 18555.670613645787, 18235.686991721625, 16925.8828785611, 18675.020742416018, 105.5614492810968, 18473.516652887723, 18431.572262248475, 17713.663508791204, 4576.712656463206, 17454.03285793985, 17292.201249548256, 20939.42278595377, 20801.722630022072, 17651.487500696963, 18216.065297275225, 18177.97697265469, 19264.673395632253, 3150.571738074696, 23587.152299971473, 18089.384831899206, 18587.61781096379, 21455.580244286535, 16780.417428809422, 22514.823434082005, 18349.87687373821, 19425.812303847528, 16757.558740720397, 21570.71680836634, 18010.31424195045, 19412.38400868501, 16261.258469320215, 19877.047780657176, 18848.70560510658, 19762.335531886278, 20992.752599405878, 18341.97850721064, 17831.060875321316, 20510.642941787344, 20631.64465239352, 18429.172766273943, 20627.395200241965, 579.2222521705618, 17066.045681651274, 18414.11547003329, 17972.557025309667, 18646.47177940007, 20178.26066608495, 19165.58680345477, 17330.55699876115, 19866.595796073718, 18009.16864451705, 21495.06256178147, 17997.49077782278, 17851.692395058908, 17368.45373594158, 17125.59033820075, 20252.42255372996, 20131.00097611084, 20695.240221415603, 17989.896672386334, 18831.907173512063, 18034.366581587095, 15973.309737542502, 18363.753955016695, 17260.384381911295, 18666.271423857834, 17499.307705648243, 18132.1440346022, 17696.78417507434, 17500.27057318523, 17134.41413054054, 17959.0883932652, 17878.081483764036, 17902.398345700913, 19509.481958757446, 16591.864442555816, 17273.63290600816, 17725.658694246802, 16234.198126731928, 16646.91815096789, 18055.2730625999, 20020.57531514723, 18710.276858256253, 18050.056352989042, 17642.541927075123, 20142.46071390576, 21894.143255955267, 21175.42391433017, 20096.87191253121, 17142.47553276926, 21336.041450040142, 20733.603590464667], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 39, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8589.490315697887, 5457.88523709678, 9437.113920071906, 5492.95422459167, 7291.979229326424, 7856.384645680068, 11920.018890038722, 7113.693114912028, 9345.799882709056, 8206.587012520413, 9327.379161719999, 7922.530927885332, 0.5461919676050055, 8469.16284466316, 9084.782714480025, 7949.371164685483, 400.3167766014944, 8087.660830728407, 9862.543392876887, 6343.527904247378, 6849.603845391682, 10006.916604019647, 9617.925328104544, 9973.450757716773, 6865.510854280855, 167.14403873752045, 4088.0777640782, 9153.500807440128, 5969.679578061647, 5826.115652726834, 10778.46904066531, 4753.414093992147, 9532.150890395813, 7974.886696287187, 10278.925296835443, 5504.026854705411, 8745.705863244691, 7274.633959896861, 9109.550042260453, 6768.691443685507, 8143.387353871205, 8366.33376697459, 6281.510314498055, 7283.510084116256, 8615.481913240706, 6865.706905329285, 6454.622060503069, 9056.131717094826, 5184.983249481781, 23.548078873996435, 10772.47864868694, 7189.259198497585, 9384.979320487213, 9093.89165230009, 6451.982331840026, 8400.235901556976, 9980.097749205865, 7613.589864589243, 9504.069874830571, 6376.360454370177, 9633.379076274969, 9890.375293007884, 9505.281313533618, 10204.137625239711, 7302.27127695156, 7352.569681639418, 7103.354073083229, 9275.32678324213, 8646.153004116624, 9109.222024986926, 8838.985064968574, 8523.48869596593, 9848.344286430915, 9211.537008823854, 9757.879172559784, 8703.424610546273, 9945.60864487557, 9854.658782470307, 9196.303990088238, 9539.342068576243, 9180.657433606542, 8591.833635900859, 6968.0812419901895, 10312.203451046224, 9457.788993015103, 9175.571085535968, 8539.79187433891, 9100.587783122663, 8789.374598272792, 7405.3339986279025, 7591.146835489544, 9161.389205785143, 8400.431258147459, 6647.993877116435, 5393.406700914698, 5758.205868547421, 6467.743926497068, 9095.785073904297, 6208.076416936462, 6723.531711536209], "policy_adversary_policy_reward": [4517.153444543187, 5524.265419393868, 8468.618030548445, 7734.683914875666, 3881.6623168881238, 4664.595915772658, 8570.684798582743, 7261.062741808122, 6850.156394404523, 4544.865497730955, 6243.021061185444, 5640.813566483158, 1411.6853892027052, 2120.968822562698, 6079.6643680866355, 7025.097375883724, 4794.836407165509, 4415.03432377129, 5935.548611210539, 4093.551367990703, 2783.747254830196, 4814.756462010964, 6219.604695845626, 4532.8851186850925, 70.16448615104974, 34.850771162442044, 5154.76274272207, 4849.591065502505, 5025.947766881965, 4320.841780886462, 3571.5278850602413, 6192.764459045473, 1968.6519501523514, 2207.7439297093597, 3311.8972342088914, 6054.4747930025405, 3189.9006419151597, 4239.757214756204, 6797.287162222868, 7798.607719483576, 6713.332527653026, 7238.786256977381, 4114.710585024005, 3529.8603116533122, 4128.630777314249, 4469.50919185644, 4074.2956322429136, 4130.230582695082, 5122.53777190127, 7276.624769450091, 1441.7251830539908, 1541.7025162831847, 9607.554343493235, 9891.520192399985, 3947.249208168203, 4988.634816290824, 8144.074168852425, 4473.864064049663, 8296.879309156511, 7332.585282403128, 3333.7248926769357, 2668.223495467191, 9388.620053503098, 8372.789286586758, 4251.125850268424, 4566.600133073937, 6014.012150925148, 5436.913456635244, 2787.8830193547624, 3690.7504245301425, 8619.105870201829, 7447.584083459131, 3868.178618219528, 5396.4297604862695, 6863.972096416734, 5273.777952371444, 2119.1228455892956, 5032.585581470502, 7373.44418004545, 5734.912156926208, 4706.569981375595, 5998.748269859743, 5629.134582244583, 5766.867182667125, 7614.436335608358, 7096.805949299417, 6858.625539614687, 4199.842883479686, 5502.756962575811, 3712.8219995048235, 6377.1045646061975, 7267.831471851894, 6768.301212395621, 7408.721379494764, 4529.40601086037, 4843.635038318781, 6665.288695541503, 8777.123255218656, 400.7159898379321, 154.95818345863336, 3256.701914922424, 3036.865118041916, 6952.876425233371, 4271.979846302374, 4743.127048049328, 3844.450656773117, 4507.560719547008, 5045.0194075530035, 6036.125042354009, 7690.153291890924, 5178.556493367592, 5586.7944085301715, 3970.280033747072, 3380.17921580824, 6190.1296711663335, 6062.876260318137, 3935.5777290064207, 4569.5210406800325, 7584.637809061261, 7534.064298350083, 4169.99644107181, 4194.115260475951, 3748.696616695296, 4212.620485355713, 3755.5297689628383, 4107.642653445098, 2997.308848099459, 3924.143864861561, 6784.770143956376, 6165.381132822054, 6729.731808008047, 6048.699486463365, 6716.786313145626, 6875.099835186729, 4112.353193849711, 4602.216695294529, 5304.737970990145, 4881.016198405302, 4035.293031022832, 4889.851525577378, 5303.1505587623815, 1831.174113811419, 4756.737065027848, 5083.528194022938, 3943.575721385754, 3468.464374094614, 4752.042509636715, 4702.691905397284, 3848.353038676642, 3893.0754944118885, 5224.566832846176, 4204.152591209736, 4104.903780903532, 3646.271749295189, 3596.1009134799397, 4049.510877235038, 2992.2785068096205, 4945.831633642719, 4551.396370486338, 3868.349954202529, 4888.949310434478, 3808.4747397230058, 3826.4608016314005, 5484.103908168705, 6870.175856645307, 5671.224860121964, 2459.154273392977, 3820.5067181165746, 3131.497282277186, 4684.3466307158515, 4246.284582890734, 4303.803025820132, 3669.2577924509233, 4025.148459942088, 5041.54784060829, 2504.78252723694, 4222.209924042967, 5043.688540284266, 5971.642272612555, 6643.599043906815, 6550.9887882414105, 4568.1412345252775, 4724.966922447831, 4163.700224756045, 5741.704365583497, 3500.4063033442044, 6725.697518291193, 6768.769318498121, 7755.897524889698, 8744.839030150852, 8373.189764740939, 7044.028281041826, 6175.7086300944475, 7453.419355939668, 3000.3399090382736, 5046.350549826642, 7735.868887087041, 7392.096146016654, 6652.7457429560445, 7357.326135972417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3983048556489055, "mean_inference_ms": 0.9908999196299872, "mean_action_processing_ms": 0.16774861537492036, "mean_env_wait_ms": 0.054248355847865255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003423333168029785, "StateBufferConnector_ms": 0.002500772476196289, "ViewRequirementAgentConnector_ms": 0.06660890579223633}, "num_episodes": 21, "episode_return_max": 23587.152299971473, "episode_return_min": 105.5614492810968, "episode_return_mean": 18109.450063865526}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.6726050286948, "num_env_steps_trained_throughput_per_sec": 530.6726050286948, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 7657.495, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7657.46, "sample_time_ms": 753.249, "learn_time_ms": 6892.292, "learn_throughput": 580.358, "synch_weights_time_ms": 11.362}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 156, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-30", "timestamp": 1723236570, "time_this_iter_s": 7.541542053222656, "time_total_s": 1183.4901337623596, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3baef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1183.4901337623596, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 25.318181818181817, "ram_util_percent": 81.75454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1307230540239.7798, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 235110880393.61694, "policy_loss": 0.024992714678159073, "vf_loss": 9.916170332671474, "vf_explained_var": 0.00023959916104715338, "kl": 0.016006657410974776, "entropy": 1.2505500907620426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8292813633568585, "cur_kl_coeff": 0.6842092037200926, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.011512000362078, "policy_loss": 0.00040052428715474283, "vf_loss": 9.995777332782746, "vf_explained_var": -7.043952743212382e-05, "kl": 0.022411470972777656, "entropy": 1.160207190240423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "env_runners": {"episode_reward_max": 23587.152299971473, "episode_reward_min": 579.2222521705618, "episode_reward_mean": 18219.74006129611, "episode_len_mean": 194.59, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19459, "policy_reward_min": {"agent_policy": 23.548078873996435, "adversary_policy": 154.95818345863336}, "policy_reward_max": {"agent_policy": 11084.367545764851, "adversary_policy": 9891.520192399985}, "policy_reward_mean": {"agent_policy": 8027.329806192804, "adversary_policy": 5096.205127551654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20801.722630022072, 17651.487500696963, 18216.065297275225, 18177.97697265469, 19264.673395632253, 3150.571738074696, 23587.152299971473, 18089.384831899206, 18587.61781096379, 21455.580244286535, 16780.417428809422, 22514.823434082005, 18349.87687373821, 19425.812303847528, 16757.558740720397, 21570.71680836634, 18010.31424195045, 19412.38400868501, 16261.258469320215, 19877.047780657176, 18848.70560510658, 19762.335531886278, 20992.752599405878, 18341.97850721064, 17831.060875321316, 20510.642941787344, 20631.64465239352, 18429.172766273943, 20627.395200241965, 579.2222521705618, 17066.045681651274, 18414.11547003329, 17972.557025309667, 18646.47177940007, 20178.26066608495, 19165.58680345477, 17330.55699876115, 19866.595796073718, 18009.16864451705, 21495.06256178147, 17997.49077782278, 17851.692395058908, 17368.45373594158, 17125.59033820075, 20252.42255372996, 20131.00097611084, 20695.240221415603, 17989.896672386334, 18831.907173512063, 18034.366581587095, 15973.309737542502, 18363.753955016695, 17260.384381911295, 18666.271423857834, 17499.307705648243, 18132.1440346022, 17696.78417507434, 17500.27057318523, 17134.41413054054, 17959.0883932652, 17878.081483764036, 17902.398345700913, 19509.481958757446, 16591.864442555816, 17273.63290600816, 17725.658694246802, 16234.198126731928, 16646.91815096789, 18055.2730625999, 20020.57531514723, 18710.276858256253, 18050.056352989042, 17642.541927075123, 20142.46071390576, 21894.143255955267, 21175.42391433017, 20096.87191253121, 17142.47553276926, 21336.041450040142, 20733.603590464667, 17856.37427706419, 20628.33950880992, 17974.328204457986, 14635.208748967429, 19631.81047287939, 18094.75376465518, 18540.88421054496, 3024.0671772913634, 18117.090770433962, 19224.005405956563, 19292.424890521317, 18440.93560194944, 22578.932447232266, 16727.633361468932, 18490.79084149903, 17492.51893794584, 17854.530805733346, 18483.19993532171, 19792.461629907564, 15226.172035244803], "episode_lengths": [200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6849.603845391682, 10006.916604019647, 9617.925328104544, 9973.450757716773, 6865.510854280855, 167.14403873752045, 4088.0777640782, 9153.500807440128, 5969.679578061647, 5826.115652726834, 10778.46904066531, 4753.414093992147, 9532.150890395813, 7974.886696287187, 10278.925296835443, 5504.026854705411, 8745.705863244691, 7274.633959896861, 9109.550042260453, 6768.691443685507, 8143.387353871205, 8366.33376697459, 6281.510314498055, 7283.510084116256, 8615.481913240706, 6865.706905329285, 6454.622060503069, 9056.131717094826, 5184.983249481781, 23.548078873996435, 10772.47864868694, 7189.259198497585, 9384.979320487213, 9093.89165230009, 6451.982331840026, 8400.235901556976, 9980.097749205865, 7613.589864589243, 9504.069874830571, 6376.360454370177, 9633.379076274969, 9890.375293007884, 9505.281313533618, 10204.137625239711, 7302.27127695156, 7352.569681639418, 7103.354073083229, 9275.32678324213, 8646.153004116624, 9109.222024986926, 8838.985064968574, 8523.48869596593, 9848.344286430915, 9211.537008823854, 9757.879172559784, 8703.424610546273, 9945.60864487557, 9854.658782470307, 9196.303990088238, 9539.342068576243, 9180.657433606542, 8591.833635900859, 6968.0812419901895, 10312.203451046224, 9457.788993015103, 9175.571085535968, 8539.79187433891, 9100.587783122663, 8789.374598272792, 7405.3339986279025, 7591.146835489544, 9161.389205785143, 8400.431258147459, 6647.993877116435, 5393.406700914698, 5758.205868547421, 6467.743926497068, 9095.785073904297, 6208.076416936462, 6723.531711536209, 9403.204196692335, 7274.173861827401, 8819.485751549868, 10588.167924250813, 7704.152910515299, 9091.590478594486, 9252.76644626283, 366.3607008278993, 9197.097065973747, 7997.508039675917, 8205.882257522493, 7179.227420870504, 5265.70334732305, 9188.666193424831, 9253.902490864686, 9337.297321096137, 8174.776417261301, 7438.857579199766, 7218.675369193393, 11084.367545764851], "policy_adversary_policy_reward": [6713.332527653026, 7238.786256977381, 4114.710585024005, 3529.8603116533122, 4128.630777314249, 4469.50919185644, 4074.2956322429136, 4130.230582695082, 5122.53777190127, 7276.624769450091, 1441.7251830539908, 1541.7025162831847, 9607.554343493235, 9891.520192399985, 3947.249208168203, 4988.634816290824, 8144.074168852425, 4473.864064049663, 8296.879309156511, 7332.585282403128, 3333.7248926769357, 2668.223495467191, 9388.620053503098, 8372.789286586758, 4251.125850268424, 4566.600133073937, 6014.012150925148, 5436.913456635244, 2787.8830193547624, 3690.7504245301425, 8619.105870201829, 7447.584083459131, 3868.178618219528, 5396.4297604862695, 6863.972096416734, 5273.777952371444, 2119.1228455892956, 5032.585581470502, 7373.44418004545, 5734.912156926208, 4706.569981375595, 5998.748269859743, 5629.134582244583, 5766.867182667125, 7614.436335608358, 7096.805949299417, 6858.625539614687, 4199.842883479686, 5502.756962575811, 3712.8219995048235, 6377.1045646061975, 7267.831471851894, 6768.301212395621, 7408.721379494764, 4529.40601086037, 4843.635038318781, 6665.288695541503, 8777.123255218656, 400.7159898379321, 154.95818345863336, 3256.701914922424, 3036.865118041916, 6952.876425233371, 4271.979846302374, 4743.127048049328, 3844.450656773117, 4507.560719547008, 5045.0194075530035, 6036.125042354009, 7690.153291890924, 5178.556493367592, 5586.7944085301715, 3970.280033747072, 3380.17921580824, 6190.1296711663335, 6062.876260318137, 3935.5777290064207, 4569.5210406800325, 7584.637809061261, 7534.064298350083, 4169.99644107181, 4194.115260475951, 3748.696616695296, 4212.620485355713, 3755.5297689628383, 4107.642653445098, 2997.308848099459, 3924.143864861561, 6784.770143956376, 6165.381132822054, 6729.731808008047, 6048.699486463365, 6716.786313145626, 6875.099835186729, 4112.353193849711, 4602.216695294529, 5304.737970990145, 4881.016198405302, 4035.293031022832, 4889.851525577378, 5303.1505587623815, 1831.174113811419, 4756.737065027848, 5083.528194022938, 3943.575721385754, 3468.464374094614, 4752.042509636715, 4702.691905397284, 3848.353038676642, 3893.0754944118885, 5224.566832846176, 4204.152591209736, 4104.903780903532, 3646.271749295189, 3596.1009134799397, 4049.510877235038, 2992.2785068096205, 4945.831633642719, 4551.396370486338, 3868.349954202529, 4888.949310434478, 3808.4747397230058, 3826.4608016314005, 5484.103908168705, 6870.175856645307, 5671.224860121964, 2459.154273392977, 3820.5067181165746, 3131.497282277186, 4684.3466307158515, 4246.284582890734, 4303.803025820132, 3669.2577924509233, 4025.148459942088, 5041.54784060829, 2504.78252723694, 4222.209924042967, 5043.688540284266, 5971.642272612555, 6643.599043906815, 6550.9887882414105, 4568.1412345252775, 4724.966922447831, 4163.700224756045, 5741.704365583497, 3500.4063033442044, 6725.697518291193, 6768.769318498121, 7755.897524889698, 8744.839030150852, 8373.189764740939, 7044.028281041826, 6175.7086300944475, 7453.419355939668, 3000.3399090382736, 5046.350549826642, 7735.868887087041, 7392.096146016654, 6652.7457429560445, 7357.326135972417, 4727.715597286969, 3725.454483084917, 6697.627020199609, 6656.538626782886, 3832.1925807269813, 5322.649872181089, 493.0731252364577, 3553.967699480155, 6434.788489267605, 5492.869073096472, 4964.264313119701, 4038.898972940982, 4831.881431667541, 4456.236332614545, 1044.1681899690316, 1613.538286494434, 4339.615420263054, 4580.378284197092, 5085.790730157925, 6140.706636122765, 5224.827147887824, 5861.715485111052, 6785.942315941625, 4475.765865137338, 8736.170816356745, 8577.058283552447, 3053.936713947323, 4485.030454096809, 4692.674594385714, 4544.21375624859, 3906.5126801335196, 4248.7089367162225, 5967.35920646965, 3712.395182002437, 6600.303468599026, 4444.038887522897, 6441.702652634639, 6132.083608079516, 1084.0364115138577, 3057.768077966096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39824782231445965, "mean_inference_ms": 0.9905371858643872, "mean_action_processing_ms": 0.16771959714968523, "mean_env_wait_ms": 0.05423973086452261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034357309341430664, "StateBufferConnector_ms": 0.0024869441986083984, "ViewRequirementAgentConnector_ms": 0.06998968124389648}, "num_episodes": 20, "episode_return_max": 23587.152299971473, "episode_return_min": 579.2222521705618, "episode_return_mean": 18219.74006129611}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.90283094456555, "num_env_steps_trained_throughput_per_sec": 511.90283094456555, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1884000, "timers": {"training_iteration_time_ms": 7616.656, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7616.622, "sample_time_ms": 755.421, "learn_time_ms": 6849.365, "learn_throughput": 583.996, "synch_weights_time_ms": 11.318}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "done": false, "training_iteration": 157, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-38", "timestamp": 1723236578, "time_this_iter_s": 7.817466735839844, "time_total_s": 1191.3076004981995, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b92310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1191.3076004981995, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 30.55454545454545, "ram_util_percent": 81.81818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1143452746031.4075, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 164463658017.59152, "policy_loss": 0.013567063347904612, "vf_loss": 9.982560593741281, "vf_explained_var": 0.0002856665502780329, "kl": 0.011196901761217131, "entropy": 1.245849800362158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8453361525355528, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.012035724520683, "policy_loss": 0.003223953577495801, "vf_loss": 9.994627647598584, "vf_explained_var": -0.0001260103036959966, "kl": 0.013820468810930226, "entropy": 1.1583248810221751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": 22578.932447232266, "episode_reward_min": 579.2222521705618, "episode_reward_mean": 18030.580305660224, "episode_len_mean": 194.5, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19450, "policy_reward_min": {"agent_policy": 23.548078873996435, "adversary_policy": 154.95818345863336}, "policy_reward_max": {"agent_policy": 11084.367545764851, "adversary_policy": 8977.673274034842}, "policy_reward_mean": {"agent_policy": 8115.795551657674, "adversary_policy": 4957.392377001276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20992.752599405878, 18341.97850721064, 17831.060875321316, 20510.642941787344, 20631.64465239352, 18429.172766273943, 20627.395200241965, 579.2222521705618, 17066.045681651274, 18414.11547003329, 17972.557025309667, 18646.47177940007, 20178.26066608495, 19165.58680345477, 17330.55699876115, 19866.595796073718, 18009.16864451705, 21495.06256178147, 17997.49077782278, 17851.692395058908, 17368.45373594158, 17125.59033820075, 20252.42255372996, 20131.00097611084, 20695.240221415603, 17989.896672386334, 18831.907173512063, 18034.366581587095, 15973.309737542502, 18363.753955016695, 17260.384381911295, 18666.271423857834, 17499.307705648243, 18132.1440346022, 17696.78417507434, 17500.27057318523, 17134.41413054054, 17959.0883932652, 17878.081483764036, 17902.398345700913, 19509.481958757446, 16591.864442555816, 17273.63290600816, 17725.658694246802, 16234.198126731928, 16646.91815096789, 18055.2730625999, 20020.57531514723, 18710.276858256253, 18050.056352989042, 17642.541927075123, 20142.46071390576, 21894.143255955267, 21175.42391433017, 20096.87191253121, 17142.47553276926, 21336.041450040142, 20733.603590464667, 17856.37427706419, 20628.33950880992, 17974.328204457986, 14635.208748967429, 19631.81047287939, 18094.75376465518, 18540.88421054496, 3024.0671772913634, 18117.090770433962, 19224.005405956563, 19292.424890521317, 18440.93560194944, 22578.932447232266, 16727.633361468932, 18490.79084149903, 17492.51893794584, 17854.530805733346, 18483.19993532171, 19792.461629907564, 15226.172035244803, 19735.255118104018, 18002.924614806972, 17315.529147998786, 17302.346338764823, 20521.550588690276, 20615.467060282455, 16860.669002787625, 17612.921981473068, 16773.34195467832, 18367.829516979677, 20330.608186330726, 19628.895689006342, 18007.681303521786, 18867.047517046736, 18844.90169036932, 18458.088880811403, 16478.400462949987, 16927.85743084664, 17952.111314417587, 1997.7062164843621, 18531.02425691922, 18505.35011178778], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 6, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200], "policy_agent_policy_reward": [6281.510314498055, 7283.510084116256, 8615.481913240706, 6865.706905329285, 6454.622060503069, 9056.131717094826, 5184.983249481781, 23.548078873996435, 10772.47864868694, 7189.259198497585, 9384.979320487213, 9093.89165230009, 6451.982331840026, 8400.235901556976, 9980.097749205865, 7613.589864589243, 9504.069874830571, 6376.360454370177, 9633.379076274969, 9890.375293007884, 9505.281313533618, 10204.137625239711, 7302.27127695156, 7352.569681639418, 7103.354073083229, 9275.32678324213, 8646.153004116624, 9109.222024986926, 8838.985064968574, 8523.48869596593, 9848.344286430915, 9211.537008823854, 9757.879172559784, 8703.424610546273, 9945.60864487557, 9854.658782470307, 9196.303990088238, 9539.342068576243, 9180.657433606542, 8591.833635900859, 6968.0812419901895, 10312.203451046224, 9457.788993015103, 9175.571085535968, 8539.79187433891, 9100.587783122663, 8789.374598272792, 7405.3339986279025, 7591.146835489544, 9161.389205785143, 8400.431258147459, 6647.993877116435, 5393.406700914698, 5758.205868547421, 6467.743926497068, 9095.785073904297, 6208.076416936462, 6723.531711536209, 9403.204196692335, 7274.173861827401, 8819.485751549868, 10588.167924250813, 7704.152910515299, 9091.590478594486, 9252.76644626283, 366.3607008278993, 9197.097065973747, 7997.508039675917, 8205.882257522493, 7179.227420870504, 5265.70334732305, 9188.666193424831, 9253.902490864686, 9337.297321096137, 8174.776417261301, 7438.857579199766, 7218.675369193393, 11084.367545764851, 6516.507436555542, 8972.383814397663, 9194.669894759105, 8993.480772711264, 5620.391258909067, 6729.07271924634, 10637.202810964765, 9898.4119577958, 10467.87587256935, 8573.264578802176, 5164.462349696115, 6390.977090967243, 9553.735061394169, 8619.30080633343, 5828.945076528138, 9128.82730596553, 8975.976014139907, 10631.393147400946, 9836.108430120456, 119.27564152710718, 8226.57980278032, 6515.833236294877], "policy_adversary_policy_reward": [7614.436335608358, 7096.805949299417, 6858.625539614687, 4199.842883479686, 5502.756962575811, 3712.8219995048235, 6377.1045646061975, 7267.831471851894, 6768.301212395621, 7408.721379494764, 4529.40601086037, 4843.635038318781, 6665.288695541503, 8777.123255218656, 400.7159898379321, 154.95818345863336, 3256.701914922424, 3036.865118041916, 6952.876425233371, 4271.979846302374, 4743.127048049328, 3844.450656773117, 4507.560719547008, 5045.0194075530035, 6036.125042354009, 7690.153291890924, 5178.556493367592, 5586.7944085301715, 3970.280033747072, 3380.17921580824, 6190.1296711663335, 6062.876260318137, 3935.5777290064207, 4569.5210406800325, 7584.637809061261, 7534.064298350083, 4169.99644107181, 4194.115260475951, 3748.696616695296, 4212.620485355713, 3755.5297689628383, 4107.642653445098, 2997.308848099459, 3924.143864861561, 6784.770143956376, 6165.381132822054, 6729.731808008047, 6048.699486463365, 6716.786313145626, 6875.099835186729, 4112.353193849711, 4602.216695294529, 5304.737970990145, 4881.016198405302, 4035.293031022832, 4889.851525577378, 5303.1505587623815, 1831.174113811419, 4756.737065027848, 5083.528194022938, 3943.575721385754, 3468.464374094614, 4752.042509636715, 4702.691905397284, 3848.353038676642, 3893.0754944118885, 5224.566832846176, 4204.152591209736, 4104.903780903532, 3646.271749295189, 3596.1009134799397, 4049.510877235038, 2992.2785068096205, 4945.831633642719, 4551.396370486338, 3868.349954202529, 4888.949310434478, 3808.4747397230058, 3826.4608016314005, 5484.103908168705, 6870.175856645307, 5671.224860121964, 2459.154273392977, 3820.5067181165746, 3131.497282277186, 4684.3466307158515, 4246.284582890734, 4303.803025820132, 3669.2577924509233, 4025.148459942088, 5041.54784060829, 2504.78252723694, 4222.209924042967, 5043.688540284266, 5971.642272612555, 6643.599043906815, 6550.9887882414105, 4568.1412345252775, 4724.966922447831, 4163.700224756045, 5741.704365583497, 3500.4063033442044, 6725.697518291193, 6768.769318498121, 7755.897524889698, 8744.839030150852, 8373.189764740939, 7044.028281041826, 6175.7086300944475, 7453.419355939668, 3000.3399090382736, 5046.350549826642, 7735.868887087041, 7392.096146016654, 6652.7457429560445, 7357.326135972417, 4727.715597286969, 3725.454483084917, 6697.627020199609, 6656.538626782886, 3832.1925807269813, 5322.649872181089, 493.0731252364577, 3553.967699480155, 6434.788489267605, 5492.869073096472, 4964.264313119701, 4038.898972940982, 4831.881431667541, 4456.236332614545, 1044.1681899690316, 1613.538286494434, 4339.615420263054, 4580.378284197092, 5085.790730157925, 6140.706636122765, 5224.827147887824, 5861.715485111052, 6785.942315941625, 4475.765865137338, 8736.170816356745, 8577.058283552447, 3053.936713947323, 4485.030454096809, 4692.674594385714, 4544.21375624859, 3906.5126801335196, 4248.7089367162225, 5967.35920646965, 3712.395182002437, 6600.303468599026, 4444.038887522897, 6441.702652634639, 6132.083608079516, 1084.0364115138577, 3057.768077966096, 7625.628187175409, 5593.119494373053, 3869.326067585252, 5161.214732824108, 4892.298595575756, 3228.5606576639116, 4828.118846750202, 3480.7467193034313, 8521.744364821872, 6379.414964959368, 7039.866424185564, 6846.527916850504, 3205.4607111704313, 3018.0054806524336, 3853.2162892882457, 3861.293734389006, 2631.20633094731, 3674.2597511616073, 5545.685946428417, 4248.878991749021, 8977.673274034842, 6188.472562599762, 7413.5858843964525, 5824.332713642631, 4204.578679794467, 4249.367562333084, 5223.1350395322415, 5024.611671181095, 4702.766066638359, 8313.1905472028, 4981.200093707602, 4348.061481138333, 3640.1078538480647, 3862.3165949620075, 3473.8665066830763, 2822.5977767625654, 3920.360572013059, 4195.642312284034, 1012.0952083713689, 866.3353665858864, 5562.326163331914, 4742.11829080703, 7626.30238743607, 4363.2144880568585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3981694623370153, "mean_inference_ms": 0.990369127314178, "mean_action_processing_ms": 0.16769019256235346, "mean_env_wait_ms": 0.05422918998230151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.002531886100769043, "ViewRequirementAgentConnector_ms": 0.07051265239715576}, "num_episodes": 22, "episode_return_max": 22578.932447232266, "episode_return_min": 579.2222521705618, "episode_return_mean": 18030.580305660224}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.9191571432794, "num_env_steps_trained_throughput_per_sec": 501.9191571432794, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 7625.744, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7625.71, "sample_time_ms": 750.549, "learn_time_ms": 6863.121, "learn_throughput": 582.825, "synch_weights_time_ms": 11.523}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 158, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-47", "timestamp": 1723236587, "time_this_iter_s": 7.982698917388916, "time_total_s": 1199.2902994155884, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b92a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1199.2902994155884, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 35.39166666666667, "ram_util_percent": 82.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1100755644775.7544, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 186119031757.0709, "policy_loss": 0.019478962673662753, "vf_loss": 9.94704419443847, "vf_explained_var": 0.00032871122713442203, "kl": 0.012671228037363598, "entropy": 1.240314383986135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8352749632981916, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.018095562855402, "policy_loss": 0.0034934498985724834, "vf_loss": 10.0, "vf_explained_var": -2.9937922954559325e-05, "kl": 0.014227733492346791, "entropy": 1.1779826826105515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "env_runners": {"episode_reward_max": 22578.932447232266, "episode_reward_min": 1997.7062164843621, "episode_reward_mean": 17981.87697132235, "episode_len_mean": 196.44, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19644, "policy_reward_min": {"agent_policy": 119.27564152710718, "adversary_policy": 493.0731252364577}, "policy_reward_max": {"agent_policy": 12019.08454517207, "adversary_policy": 8977.673274034842}, "policy_reward_mean": {"agent_policy": 8328.646098492103, "adversary_policy": 4826.615436415121}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17368.45373594158, 17125.59033820075, 20252.42255372996, 20131.00097611084, 20695.240221415603, 17989.896672386334, 18831.907173512063, 18034.366581587095, 15973.309737542502, 18363.753955016695, 17260.384381911295, 18666.271423857834, 17499.307705648243, 18132.1440346022, 17696.78417507434, 17500.27057318523, 17134.41413054054, 17959.0883932652, 17878.081483764036, 17902.398345700913, 19509.481958757446, 16591.864442555816, 17273.63290600816, 17725.658694246802, 16234.198126731928, 16646.91815096789, 18055.2730625999, 20020.57531514723, 18710.276858256253, 18050.056352989042, 17642.541927075123, 20142.46071390576, 21894.143255955267, 21175.42391433017, 20096.87191253121, 17142.47553276926, 21336.041450040142, 20733.603590464667, 17856.37427706419, 20628.33950880992, 17974.328204457986, 14635.208748967429, 19631.81047287939, 18094.75376465518, 18540.88421054496, 3024.0671772913634, 18117.090770433962, 19224.005405956563, 19292.424890521317, 18440.93560194944, 22578.932447232266, 16727.633361468932, 18490.79084149903, 17492.51893794584, 17854.530805733346, 18483.19993532171, 19792.461629907564, 15226.172035244803, 19735.255118104018, 18002.924614806972, 17315.529147998786, 17302.346338764823, 20521.550588690276, 20615.467060282455, 16860.669002787625, 17612.921981473068, 16773.34195467832, 18367.829516979677, 20330.608186330726, 19628.895689006342, 18007.681303521786, 18867.047517046736, 18844.90169036932, 18458.088880811403, 16478.400462949987, 16927.85743084664, 17952.111314417587, 1997.7062164843621, 18531.02425691922, 18505.35011178778, 17511.099867002187, 15660.66855919138, 18884.975461754024, 19902.123734319262, 15284.304076886376, 19488.451155539056, 18274.57705295294, 19229.743696976355, 18067.57254522556, 19324.861382348652, 19794.034418968033, 20428.45299633415, 15785.434976630395, 17658.749722150158, 17251.97219909304, 17133.927319578623, 15354.503912487848, 17089.41844968115, 17008.597712884395, 17933.671720962462], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9505.281313533618, 10204.137625239711, 7302.27127695156, 7352.569681639418, 7103.354073083229, 9275.32678324213, 8646.153004116624, 9109.222024986926, 8838.985064968574, 8523.48869596593, 9848.344286430915, 9211.537008823854, 9757.879172559784, 8703.424610546273, 9945.60864487557, 9854.658782470307, 9196.303990088238, 9539.342068576243, 9180.657433606542, 8591.833635900859, 6968.0812419901895, 10312.203451046224, 9457.788993015103, 9175.571085535968, 8539.79187433891, 9100.587783122663, 8789.374598272792, 7405.3339986279025, 7591.146835489544, 9161.389205785143, 8400.431258147459, 6647.993877116435, 5393.406700914698, 5758.205868547421, 6467.743926497068, 9095.785073904297, 6208.076416936462, 6723.531711536209, 9403.204196692335, 7274.173861827401, 8819.485751549868, 10588.167924250813, 7704.152910515299, 9091.590478594486, 9252.76644626283, 366.3607008278993, 9197.097065973747, 7997.508039675917, 8205.882257522493, 7179.227420870504, 5265.70334732305, 9188.666193424831, 9253.902490864686, 9337.297321096137, 8174.776417261301, 7438.857579199766, 7218.675369193393, 11084.367545764851, 6516.507436555542, 8972.383814397663, 9194.669894759105, 8993.480772711264, 5620.391258909067, 6729.07271924634, 10637.202810964765, 9898.4119577958, 10467.87587256935, 8573.264578802176, 5164.462349696115, 6390.977090967243, 9553.735061394169, 8619.30080633343, 5828.945076528138, 9128.82730596553, 8975.976014139907, 10631.393147400946, 9836.108430120456, 119.27564152710718, 8226.57980278032, 6515.833236294877, 9410.77943649143, 10790.065444220298, 8953.121947054584, 5546.209962600065, 10425.954102417554, 8396.248625744369, 6955.9263185318805, 7216.880784785846, 7877.828713722676, 8022.709546221636, 8021.430724842451, 6769.15955574849, 12019.08454517207, 8021.1150107446, 9667.519915600215, 10489.890422050383, 9734.155885821354, 10065.035228672277, 9758.99296019433, 7199.139241592078], "policy_adversary_policy_reward": [3755.5297689628383, 4107.642653445098, 2997.308848099459, 3924.143864861561, 6784.770143956376, 6165.381132822054, 6729.731808008047, 6048.699486463365, 6716.786313145626, 6875.099835186729, 4112.353193849711, 4602.216695294529, 5304.737970990145, 4881.016198405302, 4035.293031022832, 4889.851525577378, 5303.1505587623815, 1831.174113811419, 4756.737065027848, 5083.528194022938, 3943.575721385754, 3468.464374094614, 4752.042509636715, 4702.691905397284, 3848.353038676642, 3893.0754944118885, 5224.566832846176, 4204.152591209736, 4104.903780903532, 3646.271749295189, 3596.1009134799397, 4049.510877235038, 2992.2785068096205, 4945.831633642719, 4551.396370486338, 3868.349954202529, 4888.949310434478, 3808.4747397230058, 3826.4608016314005, 5484.103908168705, 6870.175856645307, 5671.224860121964, 2459.154273392977, 3820.5067181165746, 3131.497282277186, 4684.3466307158515, 4246.284582890734, 4303.803025820132, 3669.2577924509233, 4025.148459942088, 5041.54784060829, 2504.78252723694, 4222.209924042967, 5043.688540284266, 5971.642272612555, 6643.599043906815, 6550.9887882414105, 4568.1412345252775, 4724.966922447831, 4163.700224756045, 5741.704365583497, 3500.4063033442044, 6725.697518291193, 6768.769318498121, 7755.897524889698, 8744.839030150852, 8373.189764740939, 7044.028281041826, 6175.7086300944475, 7453.419355939668, 3000.3399090382736, 5046.350549826642, 7735.868887087041, 7392.096146016654, 6652.7457429560445, 7357.326135972417, 4727.715597286969, 3725.454483084917, 6697.627020199609, 6656.538626782886, 3832.1925807269813, 5322.649872181089, 493.0731252364577, 3553.967699480155, 6434.788489267605, 5492.869073096472, 4964.264313119701, 4038.898972940982, 4831.881431667541, 4456.236332614545, 1044.1681899690316, 1613.538286494434, 4339.615420263054, 4580.378284197092, 5085.790730157925, 6140.706636122765, 5224.827147887824, 5861.715485111052, 6785.942315941625, 4475.765865137338, 8736.170816356745, 8577.058283552447, 3053.936713947323, 4485.030454096809, 4692.674594385714, 4544.21375624859, 3906.5126801335196, 4248.7089367162225, 5967.35920646965, 3712.395182002437, 6600.303468599026, 4444.038887522897, 6441.702652634639, 6132.083608079516, 1084.0364115138577, 3057.768077966096, 7625.628187175409, 5593.119494373053, 3869.326067585252, 5161.214732824108, 4892.298595575756, 3228.5606576639116, 4828.118846750202, 3480.7467193034313, 8521.744364821872, 6379.414964959368, 7039.866424185564, 6846.527916850504, 3205.4607111704313, 3018.0054806524336, 3853.2162892882457, 3861.293734389006, 2631.20633094731, 3674.2597511616073, 5545.685946428417, 4248.878991749021, 8977.673274034842, 6188.472562599762, 7413.5858843964525, 5824.332713642631, 4204.578679794467, 4249.367562333084, 5223.1350395322415, 5024.611671181095, 4702.766066638359, 8313.1905472028, 4981.200093707602, 4348.061481138333, 3640.1078538480647, 3862.3165949620075, 3473.8665066830763, 2822.5977767625654, 3920.360572013059, 4195.642312284034, 1012.0952083713689, 866.3353665858864, 5562.326163331914, 4742.11829080703, 7626.30238743607, 4363.2144880568585, 4676.453282155456, 3423.8671483552553, 3332.9108201782446, 1537.692294792894, 5155.6634760578, 4776.190038641652, 8194.576131763071, 6161.337639956116, 1142.168453155426, 3716.181521313408, 5656.645336124238, 5435.557193670439, 7186.209305199069, 4132.441429222008, 5189.800444626977, 6823.0624675635245, 3925.4369214946814, 6264.306910008271, 6017.036150247451, 5285.115685879552, 5793.456852988665, 5979.14684113689, 6361.627516055658, 7297.6659245300225, 2092.7536243409227, 1673.5968071173952, 6119.696613709366, 3517.9380976961434, 4379.504075658945, 3204.948207833897, 3076.6559855134997, 3567.3809120147057, 4407.9797379095935, 1212.368288756903, 3231.0046680222426, 3793.378552986625, 4383.142663536622, 2866.4620891534237, 3944.907184121232, 6789.625295249165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39824200941053545, "mean_inference_ms": 0.9902413388136266, "mean_action_processing_ms": 0.1677136324824589, "mean_env_wait_ms": 0.054203113314166974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003564000129699707, "StateBufferConnector_ms": 0.0025696754455566406, "ViewRequirementAgentConnector_ms": 0.07131147384643555}, "num_episodes": 20, "episode_return_max": 22578.932447232266, "episode_return_min": 1997.7062164843621, "episode_return_mean": 17981.87697132235}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.95339101385696, "num_env_steps_trained_throughput_per_sec": 477.95339101385696, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1908000, "timers": {"training_iteration_time_ms": 7722.454, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7722.419, "sample_time_ms": 749.927, "learn_time_ms": 6960.121, "learn_throughput": 574.703, "synch_weights_time_ms": 11.795}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "done": false, "training_iteration": 159, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-49-55", "timestamp": 1723236595, "time_this_iter_s": 8.416563987731934, "time_total_s": 1207.7068634033203, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b92dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1207.7068634033203, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 43.6, "ram_util_percent": 83.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 995294088414.1376, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 157267057771.27618, "policy_loss": 0.016851608597096942, "vf_loss": 9.920874752064861, "vf_explained_var": 0.002480876256549169, "kl": 0.010706947768530832, "entropy": 1.2279459652446565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.83612199126898, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001041490832964, "policy_loss": 0.00034583378680205594, "vf_loss": 9.989939811825753, "vf_explained_var": -0.00010245231290658315, "kl": 0.010480073984945193, "entropy": 1.1419668522973856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 22578.932447232266, "episode_reward_min": 371.71284345289, "episode_reward_mean": 17477.92428196165, "episode_len_mean": 192.54, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19254, "policy_reward_min": {"agent_policy": 4.0912900685507765, "adversary_policy": 159.58080909692575}, "policy_reward_max": {"agent_policy": 12019.08454517207, "adversary_policy": 8977.673274034842}, "policy_reward_mean": {"agent_policy": 8214.45080779252, "adversary_policy": 4631.736737084564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17273.63290600816, 17725.658694246802, 16234.198126731928, 16646.91815096789, 18055.2730625999, 20020.57531514723, 18710.276858256253, 18050.056352989042, 17642.541927075123, 20142.46071390576, 21894.143255955267, 21175.42391433017, 20096.87191253121, 17142.47553276926, 21336.041450040142, 20733.603590464667, 17856.37427706419, 20628.33950880992, 17974.328204457986, 14635.208748967429, 19631.81047287939, 18094.75376465518, 18540.88421054496, 3024.0671772913634, 18117.090770433962, 19224.005405956563, 19292.424890521317, 18440.93560194944, 22578.932447232266, 16727.633361468932, 18490.79084149903, 17492.51893794584, 17854.530805733346, 18483.19993532171, 19792.461629907564, 15226.172035244803, 19735.255118104018, 18002.924614806972, 17315.529147998786, 17302.346338764823, 20521.550588690276, 20615.467060282455, 16860.669002787625, 17612.921981473068, 16773.34195467832, 18367.829516979677, 20330.608186330726, 19628.895689006342, 18007.681303521786, 18867.047517046736, 18844.90169036932, 18458.088880811403, 16478.400462949987, 16927.85743084664, 17952.111314417587, 1997.7062164843621, 18531.02425691922, 18505.35011178778, 17511.099867002187, 15660.66855919138, 18884.975461754024, 19902.123734319262, 15284.304076886376, 19488.451155539056, 18274.57705295294, 19229.743696976355, 18067.57254522556, 19324.861382348652, 19794.034418968033, 20428.45299633415, 15785.434976630395, 17658.749722150158, 17251.97219909304, 17133.927319578623, 15354.503912487848, 17089.41844968115, 17008.597712884395, 17933.671720962462, 18646.01050712331, 17219.86185443687, 15799.11153652274, 20768.85907258241, 17245.902080137457, 15806.080811442727, 821.2898790052884, 19452.138440184153, 20602.544206610954, 16994.71107900374, 17461.238496063987, 16510.37036706604, 15141.065442255811, 18020.365508139945, 17744.49483237321, 371.71284345289, 17324.93686177525, 16418.040311089255, 15874.126902363167, 16585.283222266607, 17409.40608168754, 15883.61372265355], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9457.788993015103, 9175.571085535968, 8539.79187433891, 9100.587783122663, 8789.374598272792, 7405.3339986279025, 7591.146835489544, 9161.389205785143, 8400.431258147459, 6647.993877116435, 5393.406700914698, 5758.205868547421, 6467.743926497068, 9095.785073904297, 6208.076416936462, 6723.531711536209, 9403.204196692335, 7274.173861827401, 8819.485751549868, 10588.167924250813, 7704.152910515299, 9091.590478594486, 9252.76644626283, 366.3607008278993, 9197.097065973747, 7997.508039675917, 8205.882257522493, 7179.227420870504, 5265.70334732305, 9188.666193424831, 9253.902490864686, 9337.297321096137, 8174.776417261301, 7438.857579199766, 7218.675369193393, 11084.367545764851, 6516.507436555542, 8972.383814397663, 9194.669894759105, 8993.480772711264, 5620.391258909067, 6729.07271924634, 10637.202810964765, 9898.4119577958, 10467.87587256935, 8573.264578802176, 5164.462349696115, 6390.977090967243, 9553.735061394169, 8619.30080633343, 5828.945076528138, 9128.82730596553, 8975.976014139907, 10631.393147400946, 9836.108430120456, 119.27564152710718, 8226.57980278032, 6515.833236294877, 9410.77943649143, 10790.065444220298, 8953.121947054584, 5546.209962600065, 10425.954102417554, 8396.248625744369, 6955.9263185318805, 7216.880784785846, 7877.828713722676, 8022.709546221636, 8021.430724842451, 6769.15955574849, 12019.08454517207, 8021.1150107446, 9667.519915600215, 10489.890422050383, 9734.155885821354, 10065.035228672277, 9758.99296019433, 7199.139241592078, 8016.084513116601, 9490.707364304022, 11138.984405397385, 6787.504014068163, 10338.70515150702, 9278.317831785393, 24.5142558954164, 8091.827463430971, 6270.2993863009215, 8762.76377787836, 9935.425599515038, 9290.74731145302, 10298.559547612029, 8793.945423209927, 7782.061951284518, 4.0912900685507765, 10203.169464087294, 10488.051087040414, 8992.58043864995, 10920.368785001956, 9358.26359143986, 11284.162147637659], "policy_adversary_policy_reward": [3131.497282277186, 4684.3466307158515, 4246.284582890734, 4303.803025820132, 3669.2577924509233, 4025.148459942088, 5041.54784060829, 2504.78252723694, 4222.209924042967, 5043.688540284266, 5971.642272612555, 6643.599043906815, 6550.9887882414105, 4568.1412345252775, 4724.966922447831, 4163.700224756045, 5741.704365583497, 3500.4063033442044, 6725.697518291193, 6768.769318498121, 7755.897524889698, 8744.839030150852, 8373.189764740939, 7044.028281041826, 6175.7086300944475, 7453.419355939668, 3000.3399090382736, 5046.350549826642, 7735.868887087041, 7392.096146016654, 6652.7457429560445, 7357.326135972417, 4727.715597286969, 3725.454483084917, 6697.627020199609, 6656.538626782886, 3832.1925807269813, 5322.649872181089, 493.0731252364577, 3553.967699480155, 6434.788489267605, 5492.869073096472, 4964.264313119701, 4038.898972940982, 4831.881431667541, 4456.236332614545, 1044.1681899690316, 1613.538286494434, 4339.615420263054, 4580.378284197092, 5085.790730157925, 6140.706636122765, 5224.827147887824, 5861.715485111052, 6785.942315941625, 4475.765865137338, 8736.170816356745, 8577.058283552447, 3053.936713947323, 4485.030454096809, 4692.674594385714, 4544.21375624859, 3906.5126801335196, 4248.7089367162225, 5967.35920646965, 3712.395182002437, 6600.303468599026, 4444.038887522897, 6441.702652634639, 6132.083608079516, 1084.0364115138577, 3057.768077966096, 7625.628187175409, 5593.119494373053, 3869.326067585252, 5161.214732824108, 4892.298595575756, 3228.5606576639116, 4828.118846750202, 3480.7467193034313, 8521.744364821872, 6379.414964959368, 7039.866424185564, 6846.527916850504, 3205.4607111704313, 3018.0054806524336, 3853.2162892882457, 3861.293734389006, 2631.20633094731, 3674.2597511616073, 5545.685946428417, 4248.878991749021, 8977.673274034842, 6188.472562599762, 7413.5858843964525, 5824.332713642631, 4204.578679794467, 4249.367562333084, 5223.1350395322415, 5024.611671181095, 4702.766066638359, 8313.1905472028, 4981.200093707602, 4348.061481138333, 3640.1078538480647, 3862.3165949620075, 3473.8665066830763, 2822.5977767625654, 3920.360572013059, 4195.642312284034, 1012.0952083713689, 866.3353665858864, 5562.326163331914, 4742.11829080703, 7626.30238743607, 4363.2144880568585, 4676.453282155456, 3423.8671483552553, 3332.9108201782446, 1537.692294792894, 5155.6634760578, 4776.190038641652, 8194.576131763071, 6161.337639956116, 1142.168453155426, 3716.181521313408, 5656.645336124238, 5435.557193670439, 7186.209305199069, 4132.441429222008, 5189.800444626977, 6823.0624675635245, 3925.4369214946814, 6264.306910008271, 6017.036150247451, 5285.115685879552, 5793.456852988665, 5979.14684113689, 6361.627516055658, 7297.6659245300225, 2092.7536243409227, 1673.5968071173952, 6119.696613709366, 3517.9380976961434, 4379.504075658945, 3204.948207833897, 3076.6559855134997, 3567.3809120147057, 4407.9797379095935, 1212.368288756903, 3231.0046680222426, 3793.378552986625, 4383.142663536622, 2866.4620891534237, 3944.907184121232, 6789.625295249165, 4503.874883392345, 6126.0511106143485, 3653.4940143791428, 4075.6604757537093, 2878.187195854516, 1781.9399352707835, 6982.679724726831, 6998.675333787453, 3108.997724153251, 3798.199204477242, 4863.817791945553, 1663.945187711824, 326.3151321747049, 470.46049093516683, 5895.556947636016, 5464.754029117196, 7025.953225143807, 7306.291595166214, 3892.660793473563, 4339.286507651789, 4134.7481214891395, 3391.064775059861, 4851.388312277932, 2368.2347433351024, 998.9298185248599, 3843.5760761189254, 3878.229884409023, 5348.190200521031, 6360.073672446441, 3602.3592086422486, 159.58080909692575, 208.04074428741347, 3938.051065272408, 3183.7163324155777, 3450.235533765774, 2479.7536902830852, 5149.555185081004, 1731.9912786322097, 2657.5333812663707, 3007.381055998278, 3336.7396383312234, 4714.402851916417, 1982.4413249957374, 2617.010250020144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3984078052027769, "mean_inference_ms": 0.9909595280729411, "mean_action_processing_ms": 0.16773420320237684, "mean_env_wait_ms": 0.05426941159366311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039032697677612305, "StateBufferConnector_ms": 0.0026742219924926758, "ViewRequirementAgentConnector_ms": 0.08149302005767822}, "num_episodes": 22, "episode_return_max": 22578.932447232266, "episode_return_min": 371.71284345289, "episode_return_mean": 17477.92428196165}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.5631834478547, "num_env_steps_trained_throughput_per_sec": 406.5631834478547, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 7922.513, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7922.477, "sample_time_ms": 782.817, "learn_time_ms": 7127.399, "learn_throughput": 561.215, "synch_weights_time_ms": 11.667}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 160, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-50-05", "timestamp": 1723236605, "time_this_iter_s": 9.895262002944946, "time_total_s": 1217.6021254062653, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b92e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1217.6021254062653, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 55.93333333333332, "ram_util_percent": 83.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1224602419919.509, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 277087803168.7788, "policy_loss": 0.024555447284950228, "vf_loss": 9.88714224901149, "vf_explained_var": 0.004473992535676906, "kl": 0.01886450144654465, "entropy": 1.2121530390290356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7981784405186773, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001593793431917, "policy_loss": 0.0010750702819980992, "vf_loss": 9.99383989572525, "vf_explained_var": -5.506190160910289e-05, "kl": 0.006507570885393458, "entropy": 1.118128522237142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "env_runners": {"episode_reward_max": 22578.932447232266, "episode_reward_min": 371.71284345289, "episode_reward_mean": 17055.820995827624, "episode_len_mean": 190.81, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19081, "policy_reward_min": {"agent_policy": 4.0912900685507765, "adversary_policy": 159.58080909692575}, "policy_reward_max": {"agent_policy": 12019.08454517207, "adversary_policy": 8977.673274034842}, "policy_reward_mean": {"agent_policy": 8371.930227934901, "adversary_policy": 4341.945383946359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14635.208748967429, 19631.81047287939, 18094.75376465518, 18540.88421054496, 3024.0671772913634, 18117.090770433962, 19224.005405956563, 19292.424890521317, 18440.93560194944, 22578.932447232266, 16727.633361468932, 18490.79084149903, 17492.51893794584, 17854.530805733346, 18483.19993532171, 19792.461629907564, 15226.172035244803, 19735.255118104018, 18002.924614806972, 17315.529147998786, 17302.346338764823, 20521.550588690276, 20615.467060282455, 16860.669002787625, 17612.921981473068, 16773.34195467832, 18367.829516979677, 20330.608186330726, 19628.895689006342, 18007.681303521786, 18867.047517046736, 18844.90169036932, 18458.088880811403, 16478.400462949987, 16927.85743084664, 17952.111314417587, 1997.7062164843621, 18531.02425691922, 18505.35011178778, 17511.099867002187, 15660.66855919138, 18884.975461754024, 19902.123734319262, 15284.304076886376, 19488.451155539056, 18274.57705295294, 19229.743696976355, 18067.57254522556, 19324.861382348652, 19794.034418968033, 20428.45299633415, 15785.434976630395, 17658.749722150158, 17251.97219909304, 17133.927319578623, 15354.503912487848, 17089.41844968115, 17008.597712884395, 17933.671720962462, 18646.01050712331, 17219.86185443687, 15799.11153652274, 20768.85907258241, 17245.902080137457, 15806.080811442727, 821.2898790052884, 19452.138440184153, 20602.544206610954, 16994.71107900374, 17461.238496063987, 16510.37036706604, 15141.065442255811, 18020.365508139945, 17744.49483237321, 371.71284345289, 17324.93686177525, 16418.040311089255, 15874.126902363167, 16585.283222266607, 17409.40608168754, 15883.61372265355, 16328.251357057126, 18698.041513775344, 16296.94634945271, 16171.08438035965, 19517.690962915465, 17407.674521589983, 18714.898566256426, 16679.03135368063, 3269.0672866987447, 16604.486903575416, 20368.94887199505, 17961.488346419785, 15976.630331450378, 16494.438777657713, 18213.770911345553, 17875.313539250616, 18031.93472202445, 16902.635512783818, 15616.530932659225], "episode_lengths": [200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [10588.167924250813, 7704.152910515299, 9091.590478594486, 9252.76644626283, 366.3607008278993, 9197.097065973747, 7997.508039675917, 8205.882257522493, 7179.227420870504, 5265.70334732305, 9188.666193424831, 9253.902490864686, 9337.297321096137, 8174.776417261301, 7438.857579199766, 7218.675369193393, 11084.367545764851, 6516.507436555542, 8972.383814397663, 9194.669894759105, 8993.480772711264, 5620.391258909067, 6729.07271924634, 10637.202810964765, 9898.4119577958, 10467.87587256935, 8573.264578802176, 5164.462349696115, 6390.977090967243, 9553.735061394169, 8619.30080633343, 5828.945076528138, 9128.82730596553, 8975.976014139907, 10631.393147400946, 9836.108430120456, 119.27564152710718, 8226.57980278032, 6515.833236294877, 9410.77943649143, 10790.065444220298, 8953.121947054584, 5546.209962600065, 10425.954102417554, 8396.248625744369, 6955.9263185318805, 7216.880784785846, 7877.828713722676, 8022.709546221636, 8021.430724842451, 6769.15955574849, 12019.08454517207, 8021.1150107446, 9667.519915600215, 10489.890422050383, 9734.155885821354, 10065.035228672277, 9758.99296019433, 7199.139241592078, 8016.084513116601, 9490.707364304022, 11138.984405397385, 6787.504014068163, 10338.70515150702, 9278.317831785393, 24.5142558954164, 8091.827463430971, 6270.2993863009215, 8762.76377787836, 9935.425599515038, 9290.74731145302, 10298.559547612029, 8793.945423209927, 7782.061951284518, 4.0912900685507765, 10203.169464087294, 10488.051087040414, 8992.58043864995, 10920.368785001956, 9358.26359143986, 11284.162147637659, 9277.09208685224, 8788.22503134325, 9295.576865810708, 11242.428862033992, 8206.012339347953, 9186.701859676476, 7277.665568843173, 9316.918527482376, 188.46653270665612, 11122.966181473626, 7086.548996798344, 9448.058978209094, 11351.228688832543, 10392.490679067556, 6835.009531854345, 7014.120999861586, 7849.344463556223, 10250.385633543407, 11031.72320480226], "policy_adversary_policy_reward": [493.0731252364577, 3553.967699480155, 6434.788489267605, 5492.869073096472, 4964.264313119701, 4038.898972940982, 4831.881431667541, 4456.236332614545, 1044.1681899690316, 1613.538286494434, 4339.615420263054, 4580.378284197092, 5085.790730157925, 6140.706636122765, 5224.827147887824, 5861.715485111052, 6785.942315941625, 4475.765865137338, 8736.170816356745, 8577.058283552447, 3053.936713947323, 4485.030454096809, 4692.674594385714, 4544.21375624859, 3906.5126801335196, 4248.7089367162225, 5967.35920646965, 3712.395182002437, 6600.303468599026, 4444.038887522897, 6441.702652634639, 6132.083608079516, 1084.0364115138577, 3057.768077966096, 7625.628187175409, 5593.119494373053, 3869.326067585252, 5161.214732824108, 4892.298595575756, 3228.5606576639116, 4828.118846750202, 3480.7467193034313, 8521.744364821872, 6379.414964959368, 7039.866424185564, 6846.527916850504, 3205.4607111704313, 3018.0054806524336, 3853.2162892882457, 3861.293734389006, 2631.20633094731, 3674.2597511616073, 5545.685946428417, 4248.878991749021, 8977.673274034842, 6188.472562599762, 7413.5858843964525, 5824.332713642631, 4204.578679794467, 4249.367562333084, 5223.1350395322415, 5024.611671181095, 4702.766066638359, 8313.1905472028, 4981.200093707602, 4348.061481138333, 3640.1078538480647, 3862.3165949620075, 3473.8665066830763, 2822.5977767625654, 3920.360572013059, 4195.642312284034, 1012.0952083713689, 866.3353665858864, 5562.326163331914, 4742.11829080703, 7626.30238743607, 4363.2144880568585, 4676.453282155456, 3423.8671483552553, 3332.9108201782446, 1537.692294792894, 5155.6634760578, 4776.190038641652, 8194.576131763071, 6161.337639956116, 1142.168453155426, 3716.181521313408, 5656.645336124238, 5435.557193670439, 7186.209305199069, 4132.441429222008, 5189.800444626977, 6823.0624675635245, 3925.4369214946814, 6264.306910008271, 6017.036150247451, 5285.115685879552, 5793.456852988665, 5979.14684113689, 6361.627516055658, 7297.6659245300225, 2092.7536243409227, 1673.5968071173952, 6119.696613709366, 3517.9380976961434, 4379.504075658945, 3204.948207833897, 3076.6559855134997, 3567.3809120147057, 4407.9797379095935, 1212.368288756903, 3231.0046680222426, 3793.378552986625, 4383.142663536622, 2866.4620891534237, 3944.907184121232, 6789.625295249165, 4503.874883392345, 6126.0511106143485, 3653.4940143791428, 4075.6604757537093, 2878.187195854516, 1781.9399352707835, 6982.679724726831, 6998.675333787453, 3108.997724153251, 3798.199204477242, 4863.817791945553, 1663.945187711824, 326.3151321747049, 470.46049093516683, 5895.556947636016, 5464.754029117196, 7025.953225143807, 7306.291595166214, 3892.660793473563, 4339.286507651789, 4134.7481214891395, 3391.064775059861, 4851.388312277932, 2368.2347433351024, 998.9298185248599, 3843.5760761189254, 3878.229884409023, 5348.190200521031, 6360.073672446441, 3602.3592086422486, 159.58080909692575, 208.04074428741347, 3938.051065272408, 3183.7163324155777, 3450.235533765774, 2479.7536902830852, 5149.555185081004, 1731.9912786322097, 2657.5333812663707, 3007.381055998278, 3336.7396383312234, 4714.402851916417, 1982.4413249957374, 2617.010250020144, 4861.1276360164675, 2190.0316341883768, 5338.489141868886, 4571.3273405631635, 2154.810725721776, 4846.558757920254, 2861.9311720229957, 2066.724346302646, 5409.603849664566, 5902.074773902966, 3387.996383901248, 4832.976278012281, 4572.762942525466, 6864.470054887778, 3845.557695220281, 3516.5551309779335, 1658.716400151591, 1421.884353840496, 2516.74672115031, 2964.7740009514782, 6367.888376017633, 6914.511499179071, 3827.538571691876, 4685.890796518795, 2765.615617667848, 1859.7860249500345, 3231.7378756437133, 2870.210222946463, 4071.635287614556, 7307.126091876596, 7128.014623869362, 3733.1779155196778, 3889.799098293498, 6292.7911601747355, 3418.229544022289, 3234.0203352181343, 2396.7940905614096, 2188.013637295535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.398707778710539, "mean_inference_ms": 0.9914389549845509, "mean_action_processing_ms": 0.16783182783712655, "mean_env_wait_ms": 0.054325121316358825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039020776748657227, "StateBufferConnector_ms": 0.0027295351028442383, "ViewRequirementAgentConnector_ms": 0.08211541175842285}, "num_episodes": 19, "episode_return_max": 22578.932447232266, "episode_return_min": 371.71284345289, "episode_return_mean": 17055.820995827624}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.1062418798848, "num_env_steps_trained_throughput_per_sec": 493.1062418798848, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 7960.791, "restore_workers_time_ms": 0.048, "training_step_time_ms": 7960.717, "sample_time_ms": 802.135, "learn_time_ms": 7146.481, "learn_throughput": 559.716, "synch_weights_time_ms": 11.496}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "training_iteration": 161, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-50-14", "timestamp": 1723236614, "time_this_iter_s": 8.116189002990723, "time_total_s": 1225.718314409256, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b9e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1225.718314409256, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 38.96666666666666, "ram_util_percent": 81.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1053976938090.7344, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 217303615524.84232, "policy_loss": 0.02344129371417381, "vf_loss": 9.753791720274265, "vf_explained_var": 0.008448603607359387, "kl": 0.014794315445537448, "entropy": 1.1905333144324166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7551497527320559, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.005909747878711, "policy_loss": -0.002135026257989618, "vf_loss": 10.0, "vf_explained_var": -2.951038380463918e-05, "kl": 0.007838513337871215, "entropy": 1.0728945266455412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": 20768.85907258241, "episode_reward_min": 371.71284345289, "episode_reward_mean": 16937.158826512645, "episode_len_mean": 192.53, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19253, "policy_reward_min": {"agent_policy": 4.0912900685507765, "adversary_policy": 159.58080909692575}, "policy_reward_max": {"agent_policy": 12636.35613423675, "adversary_policy": 8977.673274034842}, "policy_reward_mean": {"agent_policy": 8778.638199602368, "adversary_policy": 4079.2603134551377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20521.550588690276, 20615.467060282455, 16860.669002787625, 17612.921981473068, 16773.34195467832, 18367.829516979677, 20330.608186330726, 19628.895689006342, 18007.681303521786, 18867.047517046736, 18844.90169036932, 18458.088880811403, 16478.400462949987, 16927.85743084664, 17952.111314417587, 1997.7062164843621, 18531.02425691922, 18505.35011178778, 17511.099867002187, 15660.66855919138, 18884.975461754024, 19902.123734319262, 15284.304076886376, 19488.451155539056, 18274.57705295294, 19229.743696976355, 18067.57254522556, 19324.861382348652, 19794.034418968033, 20428.45299633415, 15785.434976630395, 17658.749722150158, 17251.97219909304, 17133.927319578623, 15354.503912487848, 17089.41844968115, 17008.597712884395, 17933.671720962462, 18646.01050712331, 17219.86185443687, 15799.11153652274, 20768.85907258241, 17245.902080137457, 15806.080811442727, 821.2898790052884, 19452.138440184153, 20602.544206610954, 16994.71107900374, 17461.238496063987, 16510.37036706604, 15141.065442255811, 18020.365508139945, 17744.49483237321, 371.71284345289, 17324.93686177525, 16418.040311089255, 15874.126902363167, 16585.283222266607, 17409.40608168754, 15883.61372265355, 16328.251357057126, 18698.041513775344, 16296.94634945271, 16171.08438035965, 19517.690962915465, 17407.674521589983, 18714.898566256426, 16679.03135368063, 3269.0672866987447, 16604.486903575416, 20368.94887199505, 17961.488346419785, 15976.630331450378, 16494.438777657713, 18213.770911345553, 17875.313539250616, 18031.93472202445, 16902.635512783818, 15616.530932659225, 16256.734475597099, 16322.342688073384, 17877.011994655593, 15719.985900218153, 19846.890333165466, 15538.31289837717, 19325.05182119175, 17886.275407003457, 18260.059917084513, 16877.930531492177, 17778.024920712058, 15435.03554202614, 15388.575894590036, 17154.954037959837, 16745.761194868694, 14936.633942853416, 19805.093627322767, 15185.218211465077, 17165.858816752472, 16235.773047934916, 16395.734122386155], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5620.391258909067, 6729.07271924634, 10637.202810964765, 9898.4119577958, 10467.87587256935, 8573.264578802176, 5164.462349696115, 6390.977090967243, 9553.735061394169, 8619.30080633343, 5828.945076528138, 9128.82730596553, 8975.976014139907, 10631.393147400946, 9836.108430120456, 119.27564152710718, 8226.57980278032, 6515.833236294877, 9410.77943649143, 10790.065444220298, 8953.121947054584, 5546.209962600065, 10425.954102417554, 8396.248625744369, 6955.9263185318805, 7216.880784785846, 7877.828713722676, 8022.709546221636, 8021.430724842451, 6769.15955574849, 12019.08454517207, 8021.1150107446, 9667.519915600215, 10489.890422050383, 9734.155885821354, 10065.035228672277, 9758.99296019433, 7199.139241592078, 8016.084513116601, 9490.707364304022, 11138.984405397385, 6787.504014068163, 10338.70515150702, 9278.317831785393, 24.5142558954164, 8091.827463430971, 6270.2993863009215, 8762.76377787836, 9935.425599515038, 9290.74731145302, 10298.559547612029, 8793.945423209927, 7782.061951284518, 4.0912900685507765, 10203.169464087294, 10488.051087040414, 8992.58043864995, 10920.368785001956, 9358.26359143986, 11284.162147637659, 9277.09208685224, 8788.22503134325, 9295.576865810708, 11242.428862033992, 8206.012339347953, 9186.701859676476, 7277.665568843173, 9316.918527482376, 188.46653270665612, 11122.966181473626, 7086.548996798344, 9448.058978209094, 11351.228688832543, 10392.490679067556, 6835.009531854345, 7014.120999861586, 7849.344463556223, 10250.385633543407, 11031.72320480226, 10255.775158697534, 10257.998926598675, 8870.51500893367, 12044.607796766297, 7299.885219305598, 10875.215373626563, 6592.756690727268, 9637.382086763422, 9186.490501661408, 10681.622571311635, 8962.838816169726, 12137.203042121904, 11470.589538309952, 8965.982499281632, 10075.913034385447, 12636.35613423675, 8125.669053573985, 12202.472893416765, 9354.467521433304, 10968.162902860331, 10290.933823610469], "policy_adversary_policy_reward": [8521.744364821872, 6379.414964959368, 7039.866424185564, 6846.527916850504, 3205.4607111704313, 3018.0054806524336, 3853.2162892882457, 3861.293734389006, 2631.20633094731, 3674.2597511616073, 5545.685946428417, 4248.878991749021, 8977.673274034842, 6188.472562599762, 7413.5858843964525, 5824.332713642631, 4204.578679794467, 4249.367562333084, 5223.1350395322415, 5024.611671181095, 4702.766066638359, 8313.1905472028, 4981.200093707602, 4348.061481138333, 3640.1078538480647, 3862.3165949620075, 3473.8665066830763, 2822.5977767625654, 3920.360572013059, 4195.642312284034, 1012.0952083713689, 866.3353665858864, 5562.326163331914, 4742.11829080703, 7626.30238743607, 4363.2144880568585, 4676.453282155456, 3423.8671483552553, 3332.9108201782446, 1537.692294792894, 5155.6634760578, 4776.190038641652, 8194.576131763071, 6161.337639956116, 1142.168453155426, 3716.181521313408, 5656.645336124238, 5435.557193670439, 7186.209305199069, 4132.441429222008, 5189.800444626977, 6823.0624675635245, 3925.4369214946814, 6264.306910008271, 6017.036150247451, 5285.115685879552, 5793.456852988665, 5979.14684113689, 6361.627516055658, 7297.6659245300225, 2092.7536243409227, 1673.5968071173952, 6119.696613709366, 3517.9380976961434, 4379.504075658945, 3204.948207833897, 3076.6559855134997, 3567.3809120147057, 4407.9797379095935, 1212.368288756903, 3231.0046680222426, 3793.378552986625, 4383.142663536622, 2866.4620891534237, 3944.907184121232, 6789.625295249165, 4503.874883392345, 6126.0511106143485, 3653.4940143791428, 4075.6604757537093, 2878.187195854516, 1781.9399352707835, 6982.679724726831, 6998.675333787453, 3108.997724153251, 3798.199204477242, 4863.817791945553, 1663.945187711824, 326.3151321747049, 470.46049093516683, 5895.556947636016, 5464.754029117196, 7025.953225143807, 7306.291595166214, 3892.660793473563, 4339.286507651789, 4134.7481214891395, 3391.064775059861, 4851.388312277932, 2368.2347433351024, 998.9298185248599, 3843.5760761189254, 3878.229884409023, 5348.190200521031, 6360.073672446441, 3602.3592086422486, 159.58080909692575, 208.04074428741347, 3938.051065272408, 3183.7163324155777, 3450.235533765774, 2479.7536902830852, 5149.555185081004, 1731.9912786322097, 2657.5333812663707, 3007.381055998278, 3336.7396383312234, 4714.402851916417, 1982.4413249957374, 2617.010250020144, 4861.1276360164675, 2190.0316341883768, 5338.489141868886, 4571.3273405631635, 2154.810725721776, 4846.558757920254, 2861.9311720229957, 2066.724346302646, 5409.603849664566, 5902.074773902966, 3387.996383901248, 4832.976278012281, 4572.762942525466, 6864.470054887778, 3845.557695220281, 3516.5551309779335, 1658.716400151591, 1421.884353840496, 2516.74672115031, 2964.7740009514782, 6367.888376017633, 6914.511499179071, 3827.538571691876, 4685.890796518795, 2765.615617667848, 1859.7860249500345, 3231.7378756437133, 2870.210222946463, 4071.635287614556, 7307.126091876596, 7128.014623869362, 3733.1779155196778, 3889.799098293498, 6292.7911601747355, 3418.229544022289, 3234.0203352181343, 2396.7940905614096, 2188.013637295535, 3886.3604650334364, 2114.5988518661043, 3884.136697132292, 2180.2070643424204, 5264.157688314745, 3742.339297407221, 1614.906616879377, 2060.471486572489, 6144.323415215522, 6402.681698644352, 3266.9202501043846, 1396.1772746462354, 5182.916197460792, 7549.378933003692, 3774.33263173921, 4474.56068850081, 4381.988811766012, 4691.580603657055, 2877.772148029812, 3318.5358121507247, 5153.064063341541, 3662.1220412007606, 1311.7469516919928, 1986.0855482122734, 2440.3118448258138, 1477.6745114542077, 4515.946092086696, 3673.0254465915555, 2823.21520810036, 3846.632952382921, 827.5508675273707, 1472.7269410892966, 5865.9602311576455, 5813.464342591105, 1448.5355342935948, 1534.2097837546885, 4692.356683756644, 3119.034611562466, 2816.9188109428937, 2450.6913341316863, 3845.746456760598, 2259.0538420150915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3990554618098882, "mean_inference_ms": 0.9922653846516112, "mean_action_processing_ms": 0.16789635639235, "mean_env_wait_ms": 0.05442556271075771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003952383995056152, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.07939350605010986}, "num_episodes": 21, "episode_return_max": 20768.85907258241, "episode_return_min": 371.71284345289, "episode_return_mean": 16937.158826512645}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.6359953676571, "num_env_steps_trained_throughput_per_sec": 491.6359953676571, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 8025.91, "restore_workers_time_ms": 0.048, "training_step_time_ms": 8025.834, "sample_time_ms": 813.6, "learn_time_ms": 7200.051, "learn_throughput": 555.552, "synch_weights_time_ms": 11.564}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 162, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-50-22", "timestamp": 1723236622, "time_this_iter_s": 8.142104148864746, "time_total_s": 1233.8604185581207, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320701f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1233.8604185581207, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 31.41818181818182, "ram_util_percent": 80.97272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 969101969761.2529, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 198477878435.6233, "policy_loss": 0.01611851558000559, "vf_loss": 9.676969587235224, "vf_explained_var": 0.0063180552903937285, "kl": 0.013512634551743903, "entropy": 1.1589319603783743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7589534486954411, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995577995975813, "policy_loss": -0.005737593525554985, "vf_loss": 9.993480133016904, "vf_explained_var": -3.0784557263056435e-05, "kl": 0.00763457243059141, "entropy": 0.9738195604334275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "env_runners": {"episode_reward_max": 20768.85907258241, "episode_reward_min": 371.71284345289, "episode_reward_mean": 16615.35523953255, "episode_len_mean": 192.46, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19246, "policy_reward_min": {"agent_policy": 4.0912900685507765, "adversary_policy": 159.58080909692575}, "policy_reward_max": {"agent_policy": 12636.35613423675, "adversary_policy": 8194.576131763071}, "policy_reward_mean": {"agent_policy": 9089.41286787679, "adversary_policy": 3762.9711858278806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19902.123734319262, 15284.304076886376, 19488.451155539056, 18274.57705295294, 19229.743696976355, 18067.57254522556, 19324.861382348652, 19794.034418968033, 20428.45299633415, 15785.434976630395, 17658.749722150158, 17251.97219909304, 17133.927319578623, 15354.503912487848, 17089.41844968115, 17008.597712884395, 17933.671720962462, 18646.01050712331, 17219.86185443687, 15799.11153652274, 20768.85907258241, 17245.902080137457, 15806.080811442727, 821.2898790052884, 19452.138440184153, 20602.544206610954, 16994.71107900374, 17461.238496063987, 16510.37036706604, 15141.065442255811, 18020.365508139945, 17744.49483237321, 371.71284345289, 17324.93686177525, 16418.040311089255, 15874.126902363167, 16585.283222266607, 17409.40608168754, 15883.61372265355, 16328.251357057126, 18698.041513775344, 16296.94634945271, 16171.08438035965, 19517.690962915465, 17407.674521589983, 18714.898566256426, 16679.03135368063, 3269.0672866987447, 16604.486903575416, 20368.94887199505, 17961.488346419785, 15976.630331450378, 16494.438777657713, 18213.770911345553, 17875.313539250616, 18031.93472202445, 16902.635512783818, 15616.530932659225, 16256.734475597099, 16322.342688073384, 17877.011994655593, 15719.985900218153, 19846.890333165466, 15538.31289837717, 19325.05182119175, 17886.275407003457, 18260.059917084513, 16877.930531492177, 17778.024920712058, 15435.03554202614, 15388.575894590036, 17154.954037959837, 16745.761194868694, 14936.633942853416, 19805.093627322767, 15185.218211465077, 17165.858816752472, 16235.773047934916, 16395.734122386155, 15779.389403719686, 16823.200378047582, 18545.45989933304, 15465.705655401633, 16647.228173294076, 17114.25276943696, 15067.502986698364, 16576.020998594806, 17284.888127332157, 15318.736263209474, 15245.210999402085, 17901.768335913595, 18055.321438471583, 1131.5886468327203, 16146.52181882751, 16573.526368857645, 15869.394153362317, 18057.088180031973, 15466.553720478943, 16056.168221047772, 20032.31181702722], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [5546.209962600065, 10425.954102417554, 8396.248625744369, 6955.9263185318805, 7216.880784785846, 7877.828713722676, 8022.709546221636, 8021.430724842451, 6769.15955574849, 12019.08454517207, 8021.1150107446, 9667.519915600215, 10489.890422050383, 9734.155885821354, 10065.035228672277, 9758.99296019433, 7199.139241592078, 8016.084513116601, 9490.707364304022, 11138.984405397385, 6787.504014068163, 10338.70515150702, 9278.317831785393, 24.5142558954164, 8091.827463430971, 6270.2993863009215, 8762.76377787836, 9935.425599515038, 9290.74731145302, 10298.559547612029, 8793.945423209927, 7782.061951284518, 4.0912900685507765, 10203.169464087294, 10488.051087040414, 8992.58043864995, 10920.368785001956, 9358.26359143986, 11284.162147637659, 9277.09208685224, 8788.22503134325, 9295.576865810708, 11242.428862033992, 8206.012339347953, 9186.701859676476, 7277.665568843173, 9316.918527482376, 188.46653270665612, 11122.966181473626, 7086.548996798344, 9448.058978209094, 11351.228688832543, 10392.490679067556, 6835.009531854345, 7014.120999861586, 7849.344463556223, 10250.385633543407, 11031.72320480226, 10255.775158697534, 10257.998926598675, 8870.51500893367, 12044.607796766297, 7299.885219305598, 10875.215373626563, 6592.756690727268, 9637.382086763422, 9186.490501661408, 10681.622571311635, 8962.838816169726, 12137.203042121904, 11470.589538309952, 8965.982499281632, 10075.913034385447, 12636.35613423675, 8125.669053573985, 12202.472893416765, 9354.467521433304, 10968.162902860331, 10290.933823610469, 11201.34415687602, 9602.411808291956, 9099.198894254587, 11578.55128456472, 9650.71625217826, 10807.658615365322, 11308.205330540244, 10463.012578530517, 8485.390770149288, 12575.254840226422, 12044.335978051144, 6689.85131769313, 7287.225006972245, 40.88857654833752, 10499.537673207204, 11192.834375917186, 9811.200017393465, 8767.282548823809, 12116.245467199864, 10843.5912367101, 7084.330087150317], "policy_adversary_policy_reward": [8194.576131763071, 6161.337639956116, 1142.168453155426, 3716.181521313408, 5656.645336124238, 5435.557193670439, 7186.209305199069, 4132.441429222008, 5189.800444626977, 6823.0624675635245, 3925.4369214946814, 6264.306910008271, 6017.036150247451, 5285.115685879552, 5793.456852988665, 5979.14684113689, 6361.627516055658, 7297.6659245300225, 2092.7536243409227, 1673.5968071173952, 6119.696613709366, 3517.9380976961434, 4379.504075658945, 3204.948207833897, 3076.6559855134997, 3567.3809120147057, 4407.9797379095935, 1212.368288756903, 3231.0046680222426, 3793.378552986625, 4383.142663536622, 2866.4620891534237, 3944.907184121232, 6789.625295249165, 4503.874883392345, 6126.0511106143485, 3653.4940143791428, 4075.6604757537093, 2878.187195854516, 1781.9399352707835, 6982.679724726831, 6998.675333787453, 3108.997724153251, 3798.199204477242, 4863.817791945553, 1663.945187711824, 326.3151321747049, 470.46049093516683, 5895.556947636016, 5464.754029117196, 7025.953225143807, 7306.291595166214, 3892.660793473563, 4339.286507651789, 4134.7481214891395, 3391.064775059861, 4851.388312277932, 2368.2347433351024, 998.9298185248599, 3843.5760761189254, 3878.229884409023, 5348.190200521031, 6360.073672446441, 3602.3592086422486, 159.58080909692575, 208.04074428741347, 3938.051065272408, 3183.7163324155777, 3450.235533765774, 2479.7536902830852, 5149.555185081004, 1731.9912786322097, 2657.5333812663707, 3007.381055998278, 3336.7396383312234, 4714.402851916417, 1982.4413249957374, 2617.010250020144, 4861.1276360164675, 2190.0316341883768, 5338.489141868886, 4571.3273405631635, 2154.810725721776, 4846.558757920254, 2861.9311720229957, 2066.724346302646, 5409.603849664566, 5902.074773902966, 3387.996383901248, 4832.976278012281, 4572.762942525466, 6864.470054887778, 3845.557695220281, 3516.5551309779335, 1658.716400151591, 1421.884353840496, 2516.74672115031, 2964.7740009514782, 6367.888376017633, 6914.511499179071, 3827.538571691876, 4685.890796518795, 2765.615617667848, 1859.7860249500345, 3231.7378756437133, 2870.210222946463, 4071.635287614556, 7307.126091876596, 7128.014623869362, 3733.1779155196778, 3889.799098293498, 6292.7911601747355, 3418.229544022289, 3234.0203352181343, 2396.7940905614096, 2188.013637295535, 3886.3604650334364, 2114.5988518661043, 3884.136697132292, 2180.2070643424204, 5264.157688314745, 3742.339297407221, 1614.906616879377, 2060.471486572489, 6144.323415215522, 6402.681698644352, 3266.9202501043846, 1396.1772746462354, 5182.916197460792, 7549.378933003692, 3774.33263173921, 4474.56068850081, 4381.988811766012, 4691.580603657055, 2877.772148029812, 3318.5358121507247, 5153.064063341541, 3662.1220412007606, 1311.7469516919928, 1986.0855482122734, 2440.3118448258138, 1477.6745114542077, 4515.946092086696, 3673.0254465915555, 2823.21520810036, 3846.632952382921, 827.5508675273707, 1472.7269410892966, 5865.9602311576455, 5813.464342591105, 1448.5355342935948, 1534.2097837546885, 4692.356683756644, 3119.034611562466, 2816.9188109428937, 2450.6913341316863, 3845.746456760598, 2259.0538420150915, 2902.0540254212447, 1675.9912214224178, 4539.723815438987, 2681.0647543166097, 5022.679518171322, 4423.581486907125, 2457.0580141399955, 1430.0963566969217, 3111.8996492940378, 3884.6122718218394, 3048.7225625075243, 3257.8715915641073, 936.5119950667124, 2822.7856610914546, 3112.6223489003246, 3000.386071163993, 5650.575317414283, 3148.9220397685745, 1427.8801007139157, 1315.601322269178, 1110.6563224046004, 2090.218698946356, 7452.051355878123, 3759.865662342255, 6854.661348984676, 3913.435082514662, 495.1925437648276, 595.5075265195553, 3590.9136830566244, 2056.07046256363, 2544.4199771197955, 2836.2720158206685, 2644.8048297914884, 3413.389306177393, 3914.9525563010334, 5374.853074907145, 1389.4959444556443, 1960.8123088234602, 1914.5448846275692, 3298.032099710182, 6028.503095871318, 6919.478634005625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995336120397215, "mean_inference_ms": 0.9931558476390737, "mean_action_processing_ms": 0.1680179697281861, "mean_env_wait_ms": 0.05449248824798327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363894462585449, "StateBufferConnector_ms": 0.0027015209197998047, "ViewRequirementAgentConnector_ms": 0.0786358118057251}, "num_episodes": 21, "episode_return_max": 20768.85907258241, "episode_return_min": 371.71284345289, "episode_return_mean": 16615.35523953255}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.41887526018445, "num_env_steps_trained_throughput_per_sec": 499.41887526018445, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1956000, "timers": {"training_iteration_time_ms": 8080.756, "restore_workers_time_ms": 0.048, "training_step_time_ms": 8080.68, "sample_time_ms": 816.431, "learn_time_ms": 7251.724, "learn_throughput": 551.593, "synch_weights_time_ms": 11.902}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "done": false, "training_iteration": 163, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-50-30", "timestamp": 1723236630, "time_this_iter_s": 8.014784097671509, "time_total_s": 1241.8752026557922, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b9e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1241.8752026557922, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 30.78333333333333, "ram_util_percent": 80.68333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 884948601614.3577, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 194236337469.49417, "policy_loss": 0.01716068010400271, "vf_loss": 9.84057081616114, "vf_explained_var": 0.001591865410880437, "kl": 0.013223864861995612, "entropy": 1.1266587488865727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7885189359386762, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.008538932601612, "policy_loss": 0.0012173677857693595, "vf_loss": 10.0, "vf_explained_var": 3.866789241631826e-06, "kl": 0.007133852088494071, "entropy": 0.9245360149691503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 20768.85907258241, "episode_reward_min": 371.71284345289, "episode_reward_mean": 16599.47938187071, "episode_len_mean": 192.46, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19246, "policy_reward_min": {"agent_policy": 4.0912900685507765, "adversary_policy": 159.58080909692575}, "policy_reward_max": {"agent_policy": 12636.35613423675, "adversary_policy": 7549.378933003692}, "policy_reward_mean": {"agent_policy": 9222.857970553563, "adversary_policy": 3688.3107056585745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20768.85907258241, 17245.902080137457, 15806.080811442727, 821.2898790052884, 19452.138440184153, 20602.544206610954, 16994.71107900374, 17461.238496063987, 16510.37036706604, 15141.065442255811, 18020.365508139945, 17744.49483237321, 371.71284345289, 17324.93686177525, 16418.040311089255, 15874.126902363167, 16585.283222266607, 17409.40608168754, 15883.61372265355, 16328.251357057126, 18698.041513775344, 16296.94634945271, 16171.08438035965, 19517.690962915465, 17407.674521589983, 18714.898566256426, 16679.03135368063, 3269.0672866987447, 16604.486903575416, 20368.94887199505, 17961.488346419785, 15976.630331450378, 16494.438777657713, 18213.770911345553, 17875.313539250616, 18031.93472202445, 16902.635512783818, 15616.530932659225, 16256.734475597099, 16322.342688073384, 17877.011994655593, 15719.985900218153, 19846.890333165466, 15538.31289837717, 19325.05182119175, 17886.275407003457, 18260.059917084513, 16877.930531492177, 17778.024920712058, 15435.03554202614, 15388.575894590036, 17154.954037959837, 16745.761194868694, 14936.633942853416, 19805.093627322767, 15185.218211465077, 17165.858816752472, 16235.773047934916, 16395.734122386155, 15779.389403719686, 16823.200378047582, 18545.45989933304, 15465.705655401633, 16647.228173294076, 17114.25276943696, 15067.502986698364, 16576.020998594806, 17284.888127332157, 15318.736263209474, 15245.210999402085, 17901.768335913595, 18055.321438471583, 1131.5886468327203, 16146.52181882751, 16573.526368857645, 15869.394153362317, 18057.088180031973, 15466.553720478943, 16056.168221047772, 20032.31181702722, 17439.411008784973, 15427.487187061879, 19782.824468126473, 18462.478072880025, 18705.909615315006, 19228.41165686875, 15672.718755053404, 17673.540367418915, 17873.811130802387, 20115.443882772495, 17704.787957318233, 17326.512810902183, 18519.572565683964, 18729.355618084093, 17578.232582932844, 15785.903814453324, 17829.684832066134, 18401.212791653543, 15412.66799005687, 17417.828096682268], "episode_lengths": [200, 200, 200, 7, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6787.504014068163, 10338.70515150702, 9278.317831785393, 24.5142558954164, 8091.827463430971, 6270.2993863009215, 8762.76377787836, 9935.425599515038, 9290.74731145302, 10298.559547612029, 8793.945423209927, 7782.061951284518, 4.0912900685507765, 10203.169464087294, 10488.051087040414, 8992.58043864995, 10920.368785001956, 9358.26359143986, 11284.162147637659, 9277.09208685224, 8788.22503134325, 9295.576865810708, 11242.428862033992, 8206.012339347953, 9186.701859676476, 7277.665568843173, 9316.918527482376, 188.46653270665612, 11122.966181473626, 7086.548996798344, 9448.058978209094, 11351.228688832543, 10392.490679067556, 6835.009531854345, 7014.120999861586, 7849.344463556223, 10250.385633543407, 11031.72320480226, 10255.775158697534, 10257.998926598675, 8870.51500893367, 12044.607796766297, 7299.885219305598, 10875.215373626563, 6592.756690727268, 9637.382086763422, 9186.490501661408, 10681.622571311635, 8962.838816169726, 12137.203042121904, 11470.589538309952, 8965.982499281632, 10075.913034385447, 12636.35613423675, 8125.669053573985, 12202.472893416765, 9354.467521433304, 10968.162902860331, 10290.933823610469, 11201.34415687602, 9602.411808291956, 9099.198894254587, 11578.55128456472, 9650.71625217826, 10807.658615365322, 11308.205330540244, 10463.012578530517, 8485.390770149288, 12575.254840226422, 12044.335978051144, 6689.85131769313, 7287.225006972245, 40.88857654833752, 10499.537673207204, 11192.834375917186, 9811.200017393465, 8767.282548823809, 12116.245467199864, 10843.5912367101, 7084.330087150317, 9977.187079762745, 10737.125218620995, 7687.834218541795, 7468.331541915161, 8941.216696459309, 7768.107237444225, 12232.14717684986, 9953.66789075515, 9494.877201750222, 7911.855452326108, 10199.193654435361, 9910.3255611138, 9065.494174393874, 9018.472914434038, 9603.078234911172, 10453.870882006302, 9616.005918959112, 7461.391017220352, 12295.538487206075, 8381.847535851912], "policy_adversary_policy_reward": [6982.679724726831, 6998.675333787453, 3108.997724153251, 3798.199204477242, 4863.817791945553, 1663.945187711824, 326.3151321747049, 470.46049093516683, 5895.556947636016, 5464.754029117196, 7025.953225143807, 7306.291595166214, 3892.660793473563, 4339.286507651789, 4134.7481214891395, 3391.064775059861, 4851.388312277932, 2368.2347433351024, 998.9298185248599, 3843.5760761189254, 3878.229884409023, 5348.190200521031, 6360.073672446441, 3602.3592086422486, 159.58080909692575, 208.04074428741347, 3938.051065272408, 3183.7163324155777, 3450.235533765774, 2479.7536902830852, 5149.555185081004, 1731.9912786322097, 2657.5333812663707, 3007.381055998278, 3336.7396383312234, 4714.402851916417, 1982.4413249957374, 2617.010250020144, 4861.1276360164675, 2190.0316341883768, 5338.489141868886, 4571.3273405631635, 2154.810725721776, 4846.558757920254, 2861.9311720229957, 2066.724346302646, 5409.603849664566, 5902.074773902966, 3387.996383901248, 4832.976278012281, 4572.762942525466, 6864.470054887778, 3845.557695220281, 3516.5551309779335, 1658.716400151591, 1421.884353840496, 2516.74672115031, 2964.7740009514782, 6367.888376017633, 6914.511499179071, 3827.538571691876, 4685.890796518795, 2765.615617667848, 1859.7860249500345, 3231.7378756437133, 2870.210222946463, 4071.635287614556, 7307.126091876596, 7128.014623869362, 3733.1779155196778, 3889.799098293498, 6292.7911601747355, 3418.229544022289, 3234.0203352181343, 2396.7940905614096, 2188.013637295535, 3886.3604650334364, 2114.5988518661043, 3884.136697132292, 2180.2070643424204, 5264.157688314745, 3742.339297407221, 1614.906616879377, 2060.471486572489, 6144.323415215522, 6402.681698644352, 3266.9202501043846, 1396.1772746462354, 5182.916197460792, 7549.378933003692, 3774.33263173921, 4474.56068850081, 4381.988811766012, 4691.580603657055, 2877.772148029812, 3318.5358121507247, 5153.064063341541, 3662.1220412007606, 1311.7469516919928, 1986.0855482122734, 2440.3118448258138, 1477.6745114542077, 4515.946092086696, 3673.0254465915555, 2823.21520810036, 3846.632952382921, 827.5508675273707, 1472.7269410892966, 5865.9602311576455, 5813.464342591105, 1448.5355342935948, 1534.2097837546885, 4692.356683756644, 3119.034611562466, 2816.9188109428937, 2450.6913341316863, 3845.746456760598, 2259.0538420150915, 2902.0540254212447, 1675.9912214224178, 4539.723815438987, 2681.0647543166097, 5022.679518171322, 4423.581486907125, 2457.0580141399955, 1430.0963566969217, 3111.8996492940378, 3884.6122718218394, 3048.7225625075243, 3257.8715915641073, 936.5119950667124, 2822.7856610914546, 3112.6223489003246, 3000.386071163993, 5650.575317414283, 3148.9220397685745, 1427.8801007139157, 1315.601322269178, 1110.6563224046004, 2090.218698946356, 7452.051355878123, 3759.865662342255, 6854.661348984676, 3913.435082514662, 495.1925437648276, 595.5075265195553, 3590.9136830566244, 2056.07046256363, 2544.4199771197955, 2836.2720158206685, 2644.8048297914884, 3413.389306177393, 3914.9525563010334, 5374.853074907145, 1389.4959444556443, 1960.8123088234602, 1914.5448846275692, 3298.032099710182, 6028.503095871318, 6919.478634005625, 3891.036959883777, 3571.186969138444, 3405.010405109959, 1285.3515633309044, 6395.365804833163, 5699.624444751499, 4358.9728271875065, 6635.173703777362, 4614.695689824474, 5149.997229031268, 6216.151091886025, 5244.153327538463, 1789.210578493086, 1651.3609997104945, 3561.328778166685, 4158.543698497074, 4356.745641222072, 4022.188287830061, 6193.275943745394, 6010.312486700998, 3905.552973802006, 3600.041329080849, 3303.7709012106498, 4112.416348577688, 4900.732632967717, 4553.345758322407, 5028.5345290883615, 4682.348174561616, 4509.183921462201, 3465.9704265593855, 3258.0829458737935, 2073.949986573262, 4442.836479447803, 3770.8424336591806, 4270.855942691432, 6668.965831741744, 1315.0740967776494, 1802.0554060731565, 3275.692472951291, 5760.288087879038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998761354156956, "mean_inference_ms": 0.9939771060921943, "mean_action_processing_ms": 0.16812695996795873, "mean_env_wait_ms": 0.05457084045233433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004262447357177734, "StateBufferConnector_ms": 0.0028656721115112305, "ViewRequirementAgentConnector_ms": 0.07837224006652832}, "num_episodes": 20, "episode_return_max": 20768.85907258241, "episode_return_min": 371.71284345289, "episode_return_mean": 16599.47938187071}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.4195261170645, "num_env_steps_trained_throughput_per_sec": 487.4195261170645, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 8163.995, "restore_workers_time_ms": 0.048, "training_step_time_ms": 8163.918, "sample_time_ms": 824.274, "learn_time_ms": 7327.215, "learn_throughput": 545.91, "synch_weights_time_ms": 11.799}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 164, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-50-39", "timestamp": 1723236639, "time_this_iter_s": 8.212604999542236, "time_total_s": 1250.0878076553345, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b9e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1250.0878076553345, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 29.633333333333336, "ram_util_percent": 80.19166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 761102831893.401, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 161506277456.18625, "policy_loss": 0.011978582732216825, "vf_loss": 9.66374062734937, "vf_explained_var": 0.014003255884483378, "kl": 0.010995559414316501, "entropy": 1.0940781069811059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7500607890387376, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000369724631309, "policy_loss": -0.0036315089790150525, "vf_loss": 10.0, "vf_explained_var": -3.1054082016150156e-05, "kl": 0.003898655060644766, "entropy": 0.9018320605158806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "env_runners": {"episode_reward_max": 20368.94887199505, "episode_reward_min": 1131.5886468327203, "episode_reward_mean": 16802.84395379162, "episode_len_mean": 196.36, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19636, "policy_reward_min": {"agent_policy": 40.88857654833752, "adversary_policy": 493.09598858261404}, "policy_reward_max": {"agent_policy": 12917.34223483506, "adversary_policy": 7549.378933003692}, "policy_reward_mean": {"agent_policy": 9600.756915988419, "adversary_policy": 3601.0435189015975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18698.041513775344, 16296.94634945271, 16171.08438035965, 19517.690962915465, 17407.674521589983, 18714.898566256426, 16679.03135368063, 3269.0672866987447, 16604.486903575416, 20368.94887199505, 17961.488346419785, 15976.630331450378, 16494.438777657713, 18213.770911345553, 17875.313539250616, 18031.93472202445, 16902.635512783818, 15616.530932659225, 16256.734475597099, 16322.342688073384, 17877.011994655593, 15719.985900218153, 19846.890333165466, 15538.31289837717, 19325.05182119175, 17886.275407003457, 18260.059917084513, 16877.930531492177, 17778.024920712058, 15435.03554202614, 15388.575894590036, 17154.954037959837, 16745.761194868694, 14936.633942853416, 19805.093627322767, 15185.218211465077, 17165.858816752472, 16235.773047934916, 16395.734122386155, 15779.389403719686, 16823.200378047582, 18545.45989933304, 15465.705655401633, 16647.228173294076, 17114.25276943696, 15067.502986698364, 16576.020998594806, 17284.888127332157, 15318.736263209474, 15245.210999402085, 17901.768335913595, 18055.321438471583, 1131.5886468327203, 16146.52181882751, 16573.526368857645, 15869.394153362317, 18057.088180031973, 15466.553720478943, 16056.168221047772, 20032.31181702722, 17439.411008784973, 15427.487187061879, 19782.824468126473, 18462.478072880025, 18705.909615315006, 19228.41165686875, 15672.718755053404, 17673.540367418915, 17873.811130802387, 20115.443882772495, 17704.787957318233, 17326.512810902183, 18519.572565683964, 18729.355618084093, 17578.232582932844, 15785.903814453324, 17829.684832066134, 18401.212791653543, 15412.66799005687, 17417.828096682268, 18260.42046041393, 18034.242196534975, 16119.161656540115, 18915.086315882916, 15805.390432603619, 15396.763545255078, 17251.35256308955, 14577.554466754937, 15047.253240380516, 16003.534633136924, 17801.756300985107, 15479.213311545293, 17952.00647123973, 15921.04641946704, 16919.658756798937, 15894.911842843745, 17518.06353102032, 17256.381609051172, 18044.786370584443, 14902.304585173339], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8788.22503134325, 9295.576865810708, 11242.428862033992, 8206.012339347953, 9186.701859676476, 7277.665568843173, 9316.918527482376, 188.46653270665612, 11122.966181473626, 7086.548996798344, 9448.058978209094, 11351.228688832543, 10392.490679067556, 6835.009531854345, 7014.120999861586, 7849.344463556223, 10250.385633543407, 11031.72320480226, 10255.775158697534, 10257.998926598675, 8870.51500893367, 12044.607796766297, 7299.885219305598, 10875.215373626563, 6592.756690727268, 9637.382086763422, 9186.490501661408, 10681.622571311635, 8962.838816169726, 12137.203042121904, 11470.589538309952, 8965.982499281632, 10075.913034385447, 12636.35613423675, 8125.669053573985, 12202.472893416765, 9354.467521433304, 10968.162902860331, 10290.933823610469, 11201.34415687602, 9602.411808291956, 9099.198894254587, 11578.55128456472, 9650.71625217826, 10807.658615365322, 11308.205330540244, 10463.012578530517, 8485.390770149288, 12575.254840226422, 12044.335978051144, 6689.85131769313, 7287.225006972245, 40.88857654833752, 10499.537673207204, 11192.834375917186, 9811.200017393465, 8767.282548823809, 12116.245467199864, 10843.5912367101, 7084.330087150317, 9977.187079762745, 10737.125218620995, 7687.834218541795, 7468.331541915161, 8941.216696459309, 7768.107237444225, 12232.14717684986, 9953.66789075515, 9494.877201750222, 7911.855452326108, 10199.193654435361, 9910.3255611138, 9065.494174393874, 9018.472914434038, 9603.078234911172, 10453.870882006302, 9616.005918959112, 7461.391017220352, 12295.538487206075, 8381.847535851912, 7981.588510925467, 8301.662382334758, 10908.807877859208, 7796.044004611467, 10320.442569745139, 12258.226031669356, 10465.81838221326, 12917.34223483506, 9973.510510301274, 9800.392005293354, 8835.733010995946, 11634.32691307205, 9681.57752078511, 10097.81851849231, 10792.931676135842, 11276.65109501838, 9373.688229127602, 9049.995506686755, 9872.53613727308, 12633.252030828964], "policy_adversary_policy_reward": [5338.489141868886, 4571.3273405631635, 2154.810725721776, 4846.558757920254, 2861.9311720229957, 2066.724346302646, 5409.603849664566, 5902.074773902966, 3387.996383901248, 4832.976278012281, 4572.762942525466, 6864.470054887778, 3845.557695220281, 3516.5551309779335, 1658.716400151591, 1421.884353840496, 2516.74672115031, 2964.7740009514782, 6367.888376017633, 6914.511499179071, 3827.538571691876, 4685.890796518795, 2765.615617667848, 1859.7860249500345, 3231.7378756437133, 2870.210222946463, 4071.635287614556, 7307.126091876596, 7128.014623869362, 3733.1779155196778, 3889.799098293498, 6292.7911601747355, 3418.229544022289, 3234.0203352181343, 2396.7940905614096, 2188.013637295535, 3886.3604650334364, 2114.5988518661043, 3884.136697132292, 2180.2070643424204, 5264.157688314745, 3742.339297407221, 1614.906616879377, 2060.471486572489, 6144.323415215522, 6402.681698644352, 3266.9202501043846, 1396.1772746462354, 5182.916197460792, 7549.378933003692, 3774.33263173921, 4474.56068850081, 4381.988811766012, 4691.580603657055, 2877.772148029812, 3318.5358121507247, 5153.064063341541, 3662.1220412007606, 1311.7469516919928, 1986.0855482122734, 2440.3118448258138, 1477.6745114542077, 4515.946092086696, 3673.0254465915555, 2823.21520810036, 3846.632952382921, 827.5508675273707, 1472.7269410892966, 5865.9602311576455, 5813.464342591105, 1448.5355342935948, 1534.2097837546885, 4692.356683756644, 3119.034611562466, 2816.9188109428937, 2450.6913341316863, 3845.746456760598, 2259.0538420150915, 2902.0540254212447, 1675.9912214224178, 4539.723815438987, 2681.0647543166097, 5022.679518171322, 4423.581486907125, 2457.0580141399955, 1430.0963566969217, 3111.8996492940378, 3884.6122718218394, 3048.7225625075243, 3257.8715915641073, 936.5119950667124, 2822.7856610914546, 3112.6223489003246, 3000.386071163993, 5650.575317414283, 3148.9220397685745, 1427.8801007139157, 1315.601322269178, 1110.6563224046004, 2090.218698946356, 7452.051355878123, 3759.865662342255, 6854.661348984676, 3913.435082514662, 495.1925437648276, 595.5075265195553, 3590.9136830566244, 2056.07046256363, 2544.4199771197955, 2836.2720158206685, 2644.8048297914884, 3413.389306177393, 3914.9525563010334, 5374.853074907145, 1389.4959444556443, 1960.8123088234602, 1914.5448846275692, 3298.032099710182, 6028.503095871318, 6919.478634005625, 3891.036959883777, 3571.186969138444, 3405.010405109959, 1285.3515633309044, 6395.365804833163, 5699.624444751499, 4358.9728271875065, 6635.173703777362, 4614.695689824474, 5149.997229031268, 6216.151091886025, 5244.153327538463, 1789.210578493086, 1651.3609997104945, 3561.328778166685, 4158.543698497074, 4356.745641222072, 4022.188287830061, 6193.275943745394, 6010.312486700998, 3905.552973802006, 3600.041329080849, 3303.7709012106498, 4112.416348577688, 4900.732632967717, 4553.345758322407, 5028.5345290883615, 4682.348174561616, 4509.183921462201, 3465.9704265593855, 3258.0829458737935, 2073.949986573262, 4442.836479447803, 3770.8424336591806, 4270.855942691432, 6668.965831741744, 1315.0740967776494, 1802.0554060731565, 3275.692472951291, 5760.288087879038, 5830.138463513333, 4448.693485975127, 5767.696161029844, 3964.8836531703546, 1999.0987372860325, 3211.255041394855, 5681.599045374798, 5437.443265896627, 2067.58732630285, 3417.3605365556714, 1873.4602788012353, 1265.0772347844925, 3652.700370603724, 3132.8338102725334, 493.09598858261404, 1167.1162433372856, 4168.625113429671, 905.1176166495558, 1861.3990094059814, 4341.743618437593, 5295.690152123797, 3670.333137865361, 1355.5076727565256, 2489.3787257167546, 4395.399807306371, 3875.0291431482106, 4044.317105238651, 1778.9107957360914, 3332.26770872171, 2794.459371941365, 1757.729934109298, 2860.5308137160237, 3613.7493865358706, 4530.625915356817, 4742.3439075406795, 3464.042194823771, 4251.665105195779, 3920.5851281155165, 1481.4155394251939, 787.6370149192196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40007093698031226, "mean_inference_ms": 0.9942208211311843, "mean_action_processing_ms": 0.16820881384182318, "mean_env_wait_ms": 0.05460537325883018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037893056869506836, "StateBufferConnector_ms": 0.0027544498443603516, "ViewRequirementAgentConnector_ms": 0.06754815578460693}, "num_episodes": 20, "episode_return_max": 20368.94887199505, "episode_return_min": 1131.5886468327203, "episode_return_mean": 16802.84395379162}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 520.3035318128625, "num_env_steps_trained_throughput_per_sec": 520.3035318128625, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1980000, "timers": {"training_iteration_time_ms": 8168.025, "restore_workers_time_ms": 0.048, "training_step_time_ms": 8167.948, "sample_time_ms": 825.525, "learn_time_ms": 7330.252, "learn_throughput": 545.684, "synch_weights_time_ms": 11.602}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "done": false, "training_iteration": 165, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-50-47", "timestamp": 1723236647, "time_this_iter_s": 7.6918699741363525, "time_total_s": 1257.7796776294708, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b9ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1257.7796776294708, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 26.036363636363635, "ram_util_percent": 79.7090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 598086749124.4021, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 155424641791.1873, "policy_loss": 0.011622346952932064, "vf_loss": 9.694065002158837, "vf_explained_var": 0.007138726698658454, "kl": 0.010581513659328853, "entropy": 1.0526838976870139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7654898650323351, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999267758925756, "policy_loss": -0.003198593223351054, "vf_loss": 10.0, "vf_explained_var": -3.7323993941148124e-05, "kl": 0.00480625489387118, "entropy": 0.9267538600290816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": 20128.447342542586, "episode_reward_min": 1131.5886468327203, "episode_reward_mean": 16941.15023623764, "episode_len_mean": 198.09, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19809, "policy_reward_min": {"agent_policy": 40.88857654833752, "adversary_policy": 493.09598858261404}, "policy_reward_max": {"agent_policy": 12917.34223483506, "adversary_policy": 7549.378933003692}, "policy_reward_mean": {"agent_policy": 9778.570053361222, "adversary_policy": 3581.2900914382085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16322.342688073384, 17877.011994655593, 15719.985900218153, 19846.890333165466, 15538.31289837717, 19325.05182119175, 17886.275407003457, 18260.059917084513, 16877.930531492177, 17778.024920712058, 15435.03554202614, 15388.575894590036, 17154.954037959837, 16745.761194868694, 14936.633942853416, 19805.093627322767, 15185.218211465077, 17165.858816752472, 16235.773047934916, 16395.734122386155, 15779.389403719686, 16823.200378047582, 18545.45989933304, 15465.705655401633, 16647.228173294076, 17114.25276943696, 15067.502986698364, 16576.020998594806, 17284.888127332157, 15318.736263209474, 15245.210999402085, 17901.768335913595, 18055.321438471583, 1131.5886468327203, 16146.52181882751, 16573.526368857645, 15869.394153362317, 18057.088180031973, 15466.553720478943, 16056.168221047772, 20032.31181702722, 17439.411008784973, 15427.487187061879, 19782.824468126473, 18462.478072880025, 18705.909615315006, 19228.41165686875, 15672.718755053404, 17673.540367418915, 17873.811130802387, 20115.443882772495, 17704.787957318233, 17326.512810902183, 18519.572565683964, 18729.355618084093, 17578.232582932844, 15785.903814453324, 17829.684832066134, 18401.212791653543, 15412.66799005687, 17417.828096682268, 18260.42046041393, 18034.242196534975, 16119.161656540115, 18915.086315882916, 15805.390432603619, 15396.763545255078, 17251.35256308955, 14577.554466754937, 15047.253240380516, 16003.534633136924, 17801.756300985107, 15479.213311545293, 17952.00647123973, 15921.04641946704, 16919.658756798937, 15894.911842843745, 17518.06353102032, 17256.381609051172, 18044.786370584443, 14902.304585173339, 18702.334660944518, 19293.906064698593, 18115.206575602308, 16296.014234637956, 15873.14761923344, 16474.939265530713, 16237.350495379062, 16552.919864003026, 16069.975587682693, 16243.18384242868, 16967.46832469151, 19550.181307333703, 16889.27740240462, 16940.284367685817, 16109.772306839588, 17725.40203146701, 20128.447342542586, 18839.5944271273, 17878.570783856914], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [10257.998926598675, 8870.51500893367, 12044.607796766297, 7299.885219305598, 10875.215373626563, 6592.756690727268, 9637.382086763422, 9186.490501661408, 10681.622571311635, 8962.838816169726, 12137.203042121904, 11470.589538309952, 8965.982499281632, 10075.913034385447, 12636.35613423675, 8125.669053573985, 12202.472893416765, 9354.467521433304, 10968.162902860331, 10290.933823610469, 11201.34415687602, 9602.411808291956, 9099.198894254587, 11578.55128456472, 9650.71625217826, 10807.658615365322, 11308.205330540244, 10463.012578530517, 8485.390770149288, 12575.254840226422, 12044.335978051144, 6689.85131769313, 7287.225006972245, 40.88857654833752, 10499.537673207204, 11192.834375917186, 9811.200017393465, 8767.282548823809, 12116.245467199864, 10843.5912367101, 7084.330087150317, 9977.187079762745, 10737.125218620995, 7687.834218541795, 7468.331541915161, 8941.216696459309, 7768.107237444225, 12232.14717684986, 9953.66789075515, 9494.877201750222, 7911.855452326108, 10199.193654435361, 9910.3255611138, 9065.494174393874, 9018.472914434038, 9603.078234911172, 10453.870882006302, 9616.005918959112, 7461.391017220352, 12295.538487206075, 8381.847535851912, 7981.588510925467, 8301.662382334758, 10908.807877859208, 7796.044004611467, 10320.442569745139, 12258.226031669356, 10465.81838221326, 12917.34223483506, 9973.510510301274, 9800.392005293354, 8835.733010995946, 11634.32691307205, 9681.57752078511, 10097.81851849231, 10792.931676135842, 11276.65109501838, 9373.688229127602, 9049.995506686755, 9872.53613727308, 12633.252030828964, 6778.466516623106, 7948.857547066343, 9337.245846193238, 10991.264414610141, 12239.017155036005, 10983.068604639944, 11637.411411996922, 11582.835800892268, 10164.524043609577, 11346.94672940963, 10034.455264948767, 7996.415069878581, 9795.556355970853, 7623.7040673413285, 11756.073328198761, 9508.253969136633, 7268.936287277429, 8674.099258930844, 8253.830169460889], "policy_adversary_policy_reward": [3884.136697132292, 2180.2070643424204, 5264.157688314745, 3742.339297407221, 1614.906616879377, 2060.471486572489, 6144.323415215522, 6402.681698644352, 3266.9202501043846, 1396.1772746462354, 5182.916197460792, 7549.378933003692, 3774.33263173921, 4474.56068850081, 4381.988811766012, 4691.580603657055, 2877.772148029812, 3318.5358121507247, 5153.064063341541, 3662.1220412007606, 1311.7469516919928, 1986.0855482122734, 2440.3118448258138, 1477.6745114542077, 4515.946092086696, 3673.0254465915555, 2823.21520810036, 3846.632952382921, 827.5508675273707, 1472.7269410892966, 5865.9602311576455, 5813.464342591105, 1448.5355342935948, 1534.2097837546885, 4692.356683756644, 3119.034611562466, 2816.9188109428937, 2450.6913341316863, 3845.746456760598, 2259.0538420150915, 2902.0540254212447, 1675.9912214224178, 4539.723815438987, 2681.0647543166097, 5022.679518171322, 4423.581486907125, 2457.0580141399955, 1430.0963566969217, 3111.8996492940378, 3884.6122718218394, 3048.7225625075243, 3257.8715915641073, 936.5119950667124, 2822.7856610914546, 3112.6223489003246, 3000.386071163993, 5650.575317414283, 3148.9220397685745, 1427.8801007139157, 1315.601322269178, 1110.6563224046004, 2090.218698946356, 7452.051355878123, 3759.865662342255, 6854.661348984676, 3913.435082514662, 495.1925437648276, 595.5075265195553, 3590.9136830566244, 2056.07046256363, 2544.4199771197955, 2836.2720158206685, 2644.8048297914884, 3413.389306177393, 3914.9525563010334, 5374.853074907145, 1389.4959444556443, 1960.8123088234602, 1914.5448846275692, 3298.032099710182, 6028.503095871318, 6919.478634005625, 3891.036959883777, 3571.186969138444, 3405.010405109959, 1285.3515633309044, 6395.365804833163, 5699.624444751499, 4358.9728271875065, 6635.173703777362, 4614.695689824474, 5149.997229031268, 6216.151091886025, 5244.153327538463, 1789.210578493086, 1651.3609997104945, 3561.328778166685, 4158.543698497074, 4356.745641222072, 4022.188287830061, 6193.275943745394, 6010.312486700998, 3905.552973802006, 3600.041329080849, 3303.7709012106498, 4112.416348577688, 4900.732632967717, 4553.345758322407, 5028.5345290883615, 4682.348174561616, 4509.183921462201, 3465.9704265593855, 3258.0829458737935, 2073.949986573262, 4442.836479447803, 3770.8424336591806, 4270.855942691432, 6668.965831741744, 1315.0740967776494, 1802.0554060731565, 3275.692472951291, 5760.288087879038, 5830.138463513333, 4448.693485975127, 5767.696161029844, 3964.8836531703546, 1999.0987372860325, 3211.255041394855, 5681.599045374798, 5437.443265896627, 2067.58732630285, 3417.3605365556714, 1873.4602788012353, 1265.0772347844925, 3652.700370603724, 3132.8338102725334, 493.09598858261404, 1167.1162433372856, 4168.625113429671, 905.1176166495558, 1861.3990094059814, 4341.743618437593, 5295.690152123797, 3670.333137865361, 1355.5076727565256, 2489.3787257167546, 4395.399807306371, 3875.0291431482106, 4044.317105238651, 1778.9107957360914, 3332.26770872171, 2794.459371941365, 1757.729934109298, 2860.5308137160237, 3613.7493865358706, 4530.625915356817, 4742.3439075406795, 3464.042194823771, 4251.665105195779, 3920.5851281155165, 1481.4155394251939, 787.6370149192196, 7241.111144674587, 4682.756999646815, 5161.44228820081, 6183.60622943137, 4018.8215682816285, 4759.139161127502, 2258.4838158798234, 3046.26600414804, 1800.1714704367027, 1833.9589937607286, 3139.1942436512563, 2352.6764172395497, 2475.4032730364806, 2124.535810345716, 2428.85580063988, 2541.2282624709383, 3882.101946962862, 2023.3495971102539, 2212.129443727241, 2684.1076692918487, 3526.3634251609833, 3406.649634581803, 6143.5730940422045, 5410.1931434128865, 4346.487011144076, 2747.2340352896763, 6518.431556389616, 2798.1487439549214, 2270.4015186772804, 2083.297459963545, 4630.51038818134, 3586.6376741490885, 5991.440204761791, 6868.070850503312, 5441.144526414368, 4724.350641782061, 5521.015181040592, 4103.725433355429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001198066890152, "mean_inference_ms": 0.9940834145948304, "mean_action_processing_ms": 0.1681956897960633, "mean_env_wait_ms": 0.054636554165613166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037016868591308594, "StateBufferConnector_ms": 0.0026880502700805664, "ViewRequirementAgentConnector_ms": 0.065421462059021}, "num_episodes": 19, "episode_return_max": 20128.447342542586, "episode_return_min": 1131.5886468327203, "episode_return_mean": 16941.15023623764}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.1532215868097, "num_env_steps_trained_throughput_per_sec": 536.1532215868097, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 8160.32, "restore_workers_time_ms": 0.049, "training_step_time_ms": 8160.242, "sample_time_ms": 820.996, "learn_time_ms": 7327.163, "learn_throughput": 545.914, "synch_weights_time_ms": 11.514}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 166, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-50-54", "timestamp": 1723236654, "time_this_iter_s": 7.464612007141113, "time_total_s": 1265.244289636612, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bb13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1265.244289636612, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 25.990909090909096, "ram_util_percent": 79.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 549026837214.6794, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 110951159870.84868, "policy_loss": 0.008247529524600223, "vf_loss": 9.800970889903882, "vf_explained_var": 0.0033689516562002675, "kl": 0.007553700629927257, "entropy": 1.0150348416711918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8061956073002269, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.993029840787251, "policy_loss": -0.0018535542961520453, "vf_loss": 9.99296788573265, "vf_explained_var": -3.478595366080602e-05, "kl": 0.007465615821517228, "entropy": 0.9416914698978265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "env_runners": {"episode_reward_max": 20128.447342542586, "episode_reward_min": 103.91997987077968, "episode_reward_mean": 16659.854673710488, "episode_len_mean": 194.34, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 19434, "policy_reward_min": {"agent_policy": 0.9205226997950144, "adversary_policy": 33.20930175212494}, "policy_reward_max": {"agent_policy": 12917.34223483506, "adversary_policy": 7452.051355878123}, "policy_reward_mean": {"agent_policy": 9499.58990382827, "adversary_policy": 3580.1323849411115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16647.228173294076, 17114.25276943696, 15067.502986698364, 16576.020998594806, 17284.888127332157, 15318.736263209474, 15245.210999402085, 17901.768335913595, 18055.321438471583, 1131.5886468327203, 16146.52181882751, 16573.526368857645, 15869.394153362317, 18057.088180031973, 15466.553720478943, 16056.168221047772, 20032.31181702722, 17439.411008784973, 15427.487187061879, 19782.824468126473, 18462.478072880025, 18705.909615315006, 19228.41165686875, 15672.718755053404, 17673.540367418915, 17873.811130802387, 20115.443882772495, 17704.787957318233, 17326.512810902183, 18519.572565683964, 18729.355618084093, 17578.232582932844, 15785.903814453324, 17829.684832066134, 18401.212791653543, 15412.66799005687, 17417.828096682268, 18260.42046041393, 18034.242196534975, 16119.161656540115, 18915.086315882916, 15805.390432603619, 15396.763545255078, 17251.35256308955, 14577.554466754937, 15047.253240380516, 16003.534633136924, 17801.756300985107, 15479.213311545293, 17952.00647123973, 15921.04641946704, 16919.658756798937, 15894.911842843745, 17518.06353102032, 17256.381609051172, 18044.786370584443, 14902.304585173339, 18702.334660944518, 19293.906064698593, 18115.206575602308, 16296.014234637956, 15873.14761923344, 16474.939265530713, 16237.350495379062, 16552.919864003026, 16069.975587682693, 16243.18384242868, 16967.46832469151, 19550.181307333703, 16889.27740240462, 16940.284367685817, 16109.772306839588, 17725.40203146701, 20128.447342542586, 18839.5944271273, 17878.570783856914, 15602.19707477861, 2855.7003301378204, 18673.37629824192, 19211.92758829667, 17589.855327909223, 15657.252032140617, 17355.231662653496, 17146.131234267537, 15801.989791397966, 16050.680413172433, 18227.735065379733, 17633.23186339591, 19176.764196178552, 16183.404892031993, 18065.06058448783, 15824.379520051314, 15144.171322580207, 16890.140760938146, 17889.254660658276, 15343.37312731097, 17218.961325244265, 17420.04177732796, 103.91997987077968, 17299.943105468017], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 9, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200], "policy_agent_policy_reward": [9650.71625217826, 10807.658615365322, 11308.205330540244, 10463.012578530517, 8485.390770149288, 12575.254840226422, 12044.335978051144, 6689.85131769313, 7287.225006972245, 40.88857654833752, 10499.537673207204, 11192.834375917186, 9811.200017393465, 8767.282548823809, 12116.245467199864, 10843.5912367101, 7084.330087150317, 9977.187079762745, 10737.125218620995, 7687.834218541795, 7468.331541915161, 8941.216696459309, 7768.107237444225, 12232.14717684986, 9953.66789075515, 9494.877201750222, 7911.855452326108, 10199.193654435361, 9910.3255611138, 9065.494174393874, 9018.472914434038, 9603.078234911172, 10453.870882006302, 9616.005918959112, 7461.391017220352, 12295.538487206075, 8381.847535851912, 7981.588510925467, 8301.662382334758, 10908.807877859208, 7796.044004611467, 10320.442569745139, 12258.226031669356, 10465.81838221326, 12917.34223483506, 9973.510510301274, 9800.392005293354, 8835.733010995946, 11634.32691307205, 9681.57752078511, 10097.81851849231, 10792.931676135842, 11276.65109501838, 9373.688229127602, 9049.995506686755, 9872.53613727308, 12633.252030828964, 6778.466516623106, 7948.857547066343, 9337.245846193238, 10991.264414610141, 12239.017155036005, 10983.068604639944, 11637.411411996922, 11582.835800892268, 10164.524043609577, 11346.94672940963, 10034.455264948767, 7996.415069878581, 9795.556355970853, 7623.7040673413285, 11756.073328198761, 9508.253969136633, 7268.936287277429, 8674.099258930844, 8253.830169460889, 10856.313105648138, 372.4042156903809, 6992.754144761181, 6885.18633347449, 7778.804274469507, 11460.110650065853, 10484.95015349492, 10608.092143884123, 10547.888788663377, 9791.850721165505, 9534.39807386686, 9657.450111069968, 8674.003953173651, 11649.885131663643, 7447.467930460653, 11856.598750727508, 11478.26506017985, 8462.954499057845, 8706.869050258776, 12778.932720404333, 8359.634064040267, 9401.024832172858, 0.9205226997950144, 10433.795394693336], "policy_adversary_policy_reward": [3111.8996492940378, 3884.6122718218394, 3048.7225625075243, 3257.8715915641073, 936.5119950667124, 2822.7856610914546, 3112.6223489003246, 3000.386071163993, 5650.575317414283, 3148.9220397685745, 1427.8801007139157, 1315.601322269178, 1110.6563224046004, 2090.218698946356, 7452.051355878123, 3759.865662342255, 6854.661348984676, 3913.435082514662, 495.1925437648276, 595.5075265195553, 3590.9136830566244, 2056.07046256363, 2544.4199771197955, 2836.2720158206685, 2644.8048297914884, 3413.389306177393, 3914.9525563010334, 5374.853074907145, 1389.4959444556443, 1960.8123088234602, 1914.5448846275692, 3298.032099710182, 6028.503095871318, 6919.478634005625, 3891.036959883777, 3571.186969138444, 3405.010405109959, 1285.3515633309044, 6395.365804833163, 5699.624444751499, 4358.9728271875065, 6635.173703777362, 4614.695689824474, 5149.997229031268, 6216.151091886025, 5244.153327538463, 1789.210578493086, 1651.3609997104945, 3561.328778166685, 4158.543698497074, 4356.745641222072, 4022.188287830061, 6193.275943745394, 6010.312486700998, 3905.552973802006, 3600.041329080849, 3303.7709012106498, 4112.416348577688, 4900.732632967717, 4553.345758322407, 5028.5345290883615, 4682.348174561616, 4509.183921462201, 3465.9704265593855, 3258.0829458737935, 2073.949986573262, 4442.836479447803, 3770.8424336591806, 4270.855942691432, 6668.965831741744, 1315.0740967776494, 1802.0554060731565, 3275.692472951291, 5760.288087879038, 5830.138463513333, 4448.693485975127, 5767.696161029844, 3964.8836531703546, 1999.0987372860325, 3211.255041394855, 5681.599045374798, 5437.443265896627, 2067.58732630285, 3417.3605365556714, 1873.4602788012353, 1265.0772347844925, 3652.700370603724, 3132.8338102725334, 493.09598858261404, 1167.1162433372856, 4168.625113429671, 905.1176166495558, 1861.3990094059814, 4341.743618437593, 5295.690152123797, 3670.333137865361, 1355.5076727565256, 2489.3787257167546, 4395.399807306371, 3875.0291431482106, 4044.317105238651, 1778.9107957360914, 3332.26770872171, 2794.459371941365, 1757.729934109298, 2860.5308137160237, 3613.7493865358706, 4530.625915356817, 4742.3439075406795, 3464.042194823771, 4251.665105195779, 3920.5851281155165, 1481.4155394251939, 787.6370149192196, 7241.111144674587, 4682.756999646815, 5161.44228820081, 6183.60622943137, 4018.8215682816285, 4759.139161127502, 2258.4838158798234, 3046.26600414804, 1800.1714704367027, 1833.9589937607286, 3139.1942436512563, 2352.6764172395497, 2475.4032730364806, 2124.535810345716, 2428.85580063988, 2541.2282624709383, 3882.101946962862, 2023.3495971102539, 2212.129443727241, 2684.1076692918487, 3526.3634251609833, 3406.649634581803, 6143.5730940422045, 5410.1931434128865, 4346.487011144076, 2747.2340352896763, 6518.431556389616, 2798.1487439549214, 2270.4015186772804, 2083.297459963545, 4630.51038818134, 3586.6376741490885, 5991.440204761791, 6868.070850503312, 5441.144526414368, 4724.350641782061, 5521.015181040592, 4103.725433355429, 2561.4084374052504, 2184.475531725254, 1158.6440552901063, 1324.6520591573333, 4531.240674510966, 7149.381478969767, 5395.978476275712, 6930.76277854652, 6363.331349261444, 3447.7197041782415, 2661.279806886174, 1535.8615751886427, 3585.7210075172607, 3284.5605016413283, 3015.1299406744215, 3522.9091497089807, 1671.3005088150908, 3582.8004939194925, 2815.315549640564, 3443.514142366384, 4434.300118613926, 4259.036872898945, 4350.846912526827, 3624.9348397991193, 5115.12129245173, 5387.638950553111, 2044.3705497552346, 2489.1492106131514, 4255.884551741068, 6361.7081022861, 1687.1686457017809, 2280.612123622059, 2661.7672436111634, 1004.1390187892214, 5679.181124673107, 2748.005137207191, 3760.897859678439, 5421.48775072103, 1300.0881417544788, 1264.3522651521885, 5675.011798820677, 3184.3154623833093, 3987.77438480349, 4031.24256035163, 33.20930175212494, 69.79015541885974, 3660.83200674253, 3205.315704032179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3999157667864673, "mean_inference_ms": 0.9941100969983688, "mean_action_processing_ms": 0.1681460790254918, "mean_env_wait_ms": 0.0546358884532572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003556966781616211, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.06466305255889893}, "num_episodes": 24, "episode_return_max": 20128.447342542586, "episode_return_min": 103.91997987077968, "episode_return_mean": 16659.854673710488}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.9053702273682, "num_env_steps_trained_throughput_per_sec": 539.9053702273682, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2004000, "timers": {"training_iteration_time_ms": 8119.792, "restore_workers_time_ms": 0.049, "training_step_time_ms": 8119.714, "sample_time_ms": 817.835, "learn_time_ms": 7290.112, "learn_throughput": 548.688, "synch_weights_time_ms": 11.199}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "done": false, "training_iteration": 167, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-02", "timestamp": 1723236662, "time_this_iter_s": 7.412853002548218, "time_total_s": 1272.6571426391602, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b92e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1272.6571426391602, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 25.19090909090909, "ram_util_percent": 79.58181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 394641191537.23596, "cur_kl_coeff": 14688318380923.06, "cur_lr": 5.0000000000000016e-05, "total_loss": 57303289201.50688, "policy_loss": 0.002084955016013097, "vf_loss": 9.741034858945817, "vf_explained_var": 0.008429730190801872, "kl": 0.003901283159142449, "entropy": 0.9961042440757549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8645545777864754, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.990806427597999, "policy_loss": -0.005706742294326735, "vf_loss": 9.994032112757365, "vf_explained_var": -3.6290536324183144e-05, "kl": 0.00966981040207126, "entropy": 0.9907238690182567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 20128.447342542586, "episode_reward_min": 103.91997987077968, "episode_reward_mean": 16592.130606494855, "episode_len_mean": 194.28, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19428, "policy_reward_min": {"agent_policy": 0.9205226997950144, "adversary_policy": 33.20930175212494}, "policy_reward_max": {"agent_policy": 12917.34223483506, "adversary_policy": 7905.039010086514}, "policy_reward_mean": {"agent_policy": 9596.489200453094, "adversary_policy": 3497.8207030208814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18462.478072880025, 18705.909615315006, 19228.41165686875, 15672.718755053404, 17673.540367418915, 17873.811130802387, 20115.443882772495, 17704.787957318233, 17326.512810902183, 18519.572565683964, 18729.355618084093, 17578.232582932844, 15785.903814453324, 17829.684832066134, 18401.212791653543, 15412.66799005687, 17417.828096682268, 18260.42046041393, 18034.242196534975, 16119.161656540115, 18915.086315882916, 15805.390432603619, 15396.763545255078, 17251.35256308955, 14577.554466754937, 15047.253240380516, 16003.534633136924, 17801.756300985107, 15479.213311545293, 17952.00647123973, 15921.04641946704, 16919.658756798937, 15894.911842843745, 17518.06353102032, 17256.381609051172, 18044.786370584443, 14902.304585173339, 18702.334660944518, 19293.906064698593, 18115.206575602308, 16296.014234637956, 15873.14761923344, 16474.939265530713, 16237.350495379062, 16552.919864003026, 16069.975587682693, 16243.18384242868, 16967.46832469151, 19550.181307333703, 16889.27740240462, 16940.284367685817, 16109.772306839588, 17725.40203146701, 20128.447342542586, 18839.5944271273, 17878.570783856914, 15602.19707477861, 2855.7003301378204, 18673.37629824192, 19211.92758829667, 17589.855327909223, 15657.252032140617, 17355.231662653496, 17146.131234267537, 15801.989791397966, 16050.680413172433, 18227.735065379733, 17633.23186339591, 19176.764196178552, 16183.404892031993, 18065.06058448783, 15824.379520051314, 15144.171322580207, 16890.140760938146, 17889.254660658276, 15343.37312731097, 17218.961325244265, 17420.04177732796, 103.91997987077968, 17299.943105468017, 18328.19568829288, 17876.724245341877, 18458.201334206122, 15826.109007552623, 14815.124262112904, 15374.169947224023, 15495.226356873467, 15487.75701427189, 14356.46874946329, 320.2842196998547, 14472.5602045246, 17101.30552405371, 14980.296636220604, 16297.166050694457, 17840.23984927195, 14407.591061151561, 19198.466106793072, 17840.857232378872, 15977.081610780147, 19967.57386032108], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7468.331541915161, 8941.216696459309, 7768.107237444225, 12232.14717684986, 9953.66789075515, 9494.877201750222, 7911.855452326108, 10199.193654435361, 9910.3255611138, 9065.494174393874, 9018.472914434038, 9603.078234911172, 10453.870882006302, 9616.005918959112, 7461.391017220352, 12295.538487206075, 8381.847535851912, 7981.588510925467, 8301.662382334758, 10908.807877859208, 7796.044004611467, 10320.442569745139, 12258.226031669356, 10465.81838221326, 12917.34223483506, 9973.510510301274, 9800.392005293354, 8835.733010995946, 11634.32691307205, 9681.57752078511, 10097.81851849231, 10792.931676135842, 11276.65109501838, 9373.688229127602, 9049.995506686755, 9872.53613727308, 12633.252030828964, 6778.466516623106, 7948.857547066343, 9337.245846193238, 10991.264414610141, 12239.017155036005, 10983.068604639944, 11637.411411996922, 11582.835800892268, 10164.524043609577, 11346.94672940963, 10034.455264948767, 7996.415069878581, 9795.556355970853, 7623.7040673413285, 11756.073328198761, 9508.253969136633, 7268.936287277429, 8674.099258930844, 8253.830169460889, 10856.313105648138, 372.4042156903809, 6992.754144761181, 6885.18633347449, 7778.804274469507, 11460.110650065853, 10484.95015349492, 10608.092143884123, 10547.888788663377, 9791.850721165505, 9534.39807386686, 9657.450111069968, 8674.003953173651, 11649.885131663643, 7447.467930460653, 11856.598750727508, 11478.26506017985, 8462.954499057845, 8706.869050258776, 12778.932720404333, 8359.634064040267, 9401.024832172858, 0.9205226997950144, 10433.795394693336, 8514.067012888067, 9875.915421901815, 9033.346326887344, 11345.611291773479, 11317.925998679842, 11971.787519468417, 11880.223984111131, 11563.409251185238, 11595.02082288766, 4.225109425510276, 10884.019385418713, 11143.571123429047, 10481.056198788701, 11520.840815849502, 10082.892690402698, 12873.7291179317, 6235.428324339856, 8394.5557229108, 10797.395800044333, 8244.614933741119], "policy_adversary_policy_reward": [4358.9728271875065, 6635.173703777362, 4614.695689824474, 5149.997229031268, 6216.151091886025, 5244.153327538463, 1789.210578493086, 1651.3609997104945, 3561.328778166685, 4158.543698497074, 4356.745641222072, 4022.188287830061, 6193.275943745394, 6010.312486700998, 3905.552973802006, 3600.041329080849, 3303.7709012106498, 4112.416348577688, 4900.732632967717, 4553.345758322407, 5028.5345290883615, 4682.348174561616, 4509.183921462201, 3465.9704265593855, 3258.0829458737935, 2073.949986573262, 4442.836479447803, 3770.8424336591806, 4270.855942691432, 6668.965831741744, 1315.0740967776494, 1802.0554060731565, 3275.692472951291, 5760.288087879038, 5830.138463513333, 4448.693485975127, 5767.696161029844, 3964.8836531703546, 1999.0987372860325, 3211.255041394855, 5681.599045374798, 5437.443265896627, 2067.58732630285, 3417.3605365556714, 1873.4602788012353, 1265.0772347844925, 3652.700370603724, 3132.8338102725334, 493.09598858261404, 1167.1162433372856, 4168.625113429671, 905.1176166495558, 1861.3990094059814, 4341.743618437593, 5295.690152123797, 3670.333137865361, 1355.5076727565256, 2489.3787257167546, 4395.399807306371, 3875.0291431482106, 4044.317105238651, 1778.9107957360914, 3332.26770872171, 2794.459371941365, 1757.729934109298, 2860.5308137160237, 3613.7493865358706, 4530.625915356817, 4742.3439075406795, 3464.042194823771, 4251.665105195779, 3920.5851281155165, 1481.4155394251939, 787.6370149192196, 7241.111144674587, 4682.756999646815, 5161.44228820081, 6183.60622943137, 4018.8215682816285, 4759.139161127502, 2258.4838158798234, 3046.26600414804, 1800.1714704367027, 1833.9589937607286, 3139.1942436512563, 2352.6764172395497, 2475.4032730364806, 2124.535810345716, 2428.85580063988, 2541.2282624709383, 3882.101946962862, 2023.3495971102539, 2212.129443727241, 2684.1076692918487, 3526.3634251609833, 3406.649634581803, 6143.5730940422045, 5410.1931434128865, 4346.487011144076, 2747.2340352896763, 6518.431556389616, 2798.1487439549214, 2270.4015186772804, 2083.297459963545, 4630.51038818134, 3586.6376741490885, 5991.440204761791, 6868.070850503312, 5441.144526414368, 4724.350641782061, 5521.015181040592, 4103.725433355429, 2561.4084374052504, 2184.475531725254, 1158.6440552901063, 1324.6520591573333, 4531.240674510966, 7149.381478969767, 5395.978476275712, 6930.76277854652, 6363.331349261444, 3447.7197041782415, 2661.279806886174, 1535.8615751886427, 3585.7210075172607, 3284.5605016413283, 3015.1299406744215, 3522.9091497089807, 1671.3005088150908, 3582.8004939194925, 2815.315549640564, 3443.514142366384, 4434.300118613926, 4259.036872898945, 4350.846912526827, 3624.9348397991193, 5115.12129245173, 5387.638950553111, 2044.3705497552346, 2489.1492106131514, 4255.884551741068, 6361.7081022861, 1687.1686457017809, 2280.612123622059, 2661.7672436111634, 1004.1390187892214, 5679.181124673107, 2748.005137207191, 3760.897859678439, 5421.48775072103, 1300.0881417544788, 1264.3522651521885, 5675.011798820677, 3184.3154623833093, 3987.77438480349, 4031.24256035163, 33.20930175212494, 69.79015541885974, 3660.83200674253, 3205.315704032179, 5628.068610842887, 4186.060064561942, 3858.1962383812497, 4142.612585058841, 5086.310788852215, 4338.544218466637, 1685.718916474511, 2794.7787993046554, 2824.2096250510926, 672.9886383819576, 1234.144930370835, 2168.237497384779, 1418.3435383738738, 2196.658834388493, 1608.3920968533157, 2315.955666233331, 2544.3079452774323, 217.13998129820484, 207.90692493045398, 108.15218534389048, 3258.1162383122314, 330.42458079361984, 2970.249186973611, 2987.4852136510344, 3661.0794249422215, 838.1610124897089, 2542.884376246352, 2233.4408585986002, 3731.3186456044723, 4026.0285132648078, 1263.5038390341333, 270.3581041857658, 5057.998772366713, 7905.039010086514, 5744.646842147385, 3701.654667320694, 1836.3530583010204, 3343.332752434782, 5837.670901595709, 5885.288024984315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3999422325612464, "mean_inference_ms": 0.9939796772527261, "mean_action_processing_ms": 0.16820096519418562, "mean_env_wait_ms": 0.05459149482292238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003004312515258789, "StateBufferConnector_ms": 0.002547144889831543, "ViewRequirementAgentConnector_ms": 0.06430435180664062}, "num_episodes": 20, "episode_return_max": 20128.447342542586, "episode_return_min": 103.91997987077968, "episode_return_mean": 16592.130606494855}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.5086869759881, "num_env_steps_trained_throughput_per_sec": 541.5086869759881, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 8061.528, "restore_workers_time_ms": 0.049, "training_step_time_ms": 8061.45, "sample_time_ms": 821.906, "learn_time_ms": 7228.017, "learn_throughput": 553.402, "synch_weights_time_ms": 11.004}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 168, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-09", "timestamp": 1723236669, "time_this_iter_s": 7.392199993133545, "time_total_s": 1280.0493426322937, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bb1790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1280.0493426322937, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 30.090909090909086, "ram_util_percent": 79.64545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109886266683.32698, "cur_kl_coeff": 7344159190461.53, "cur_lr": 5.0000000000000016e-05, "total_loss": 14038071674.175661, "policy_loss": 0.0017379993062821173, "vf_loss": 9.56275386406631, "vf_explained_var": 0.008418393324291895, "kl": 0.0019114607006986502, "entropy": 0.9831755731471632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8753099878008167, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003106500705083, "policy_loss": -0.0008329915920815741, "vf_loss": 10.0, "vf_explained_var": -8.292930821577708e-06, "kl": 0.015354007563049284, "entropy": 1.062744143915673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "env_runners": {"episode_reward_max": 20128.447342542586, "episode_reward_min": 103.91997987077968, "episode_reward_mean": 16361.045455392064, "episode_len_mean": 194.28, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19428, "policy_reward_min": {"agent_policy": 0.9205226997950144, "adversary_policy": 33.20930175212494}, "policy_reward_max": {"agent_policy": 13044.961284922894, "adversary_policy": 7905.039010086514}, "policy_reward_mean": {"agent_policy": 9881.600755085872, "adversary_policy": 3239.7223501531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18915.086315882916, 15805.390432603619, 15396.763545255078, 17251.35256308955, 14577.554466754937, 15047.253240380516, 16003.534633136924, 17801.756300985107, 15479.213311545293, 17952.00647123973, 15921.04641946704, 16919.658756798937, 15894.911842843745, 17518.06353102032, 17256.381609051172, 18044.786370584443, 14902.304585173339, 18702.334660944518, 19293.906064698593, 18115.206575602308, 16296.014234637956, 15873.14761923344, 16474.939265530713, 16237.350495379062, 16552.919864003026, 16069.975587682693, 16243.18384242868, 16967.46832469151, 19550.181307333703, 16889.27740240462, 16940.284367685817, 16109.772306839588, 17725.40203146701, 20128.447342542586, 18839.5944271273, 17878.570783856914, 15602.19707477861, 2855.7003301378204, 18673.37629824192, 19211.92758829667, 17589.855327909223, 15657.252032140617, 17355.231662653496, 17146.131234267537, 15801.989791397966, 16050.680413172433, 18227.735065379733, 17633.23186339591, 19176.764196178552, 16183.404892031993, 18065.06058448783, 15824.379520051314, 15144.171322580207, 16890.140760938146, 17889.254660658276, 15343.37312731097, 17218.961325244265, 17420.04177732796, 103.91997987077968, 17299.943105468017, 18328.19568829288, 17876.724245341877, 18458.201334206122, 15826.109007552623, 14815.124262112904, 15374.169947224023, 15495.226356873467, 15487.75701427189, 14356.46874946329, 320.2842196998547, 14472.5602045246, 17101.30552405371, 14980.296636220604, 16297.166050694457, 17840.23984927195, 14407.591061151561, 19198.466106793072, 17840.857232378872, 15977.081610780147, 19967.57386032108, 15786.896476204076, 15865.634167363212, 16595.96523529374, 17164.97953890524, 15147.542441577998, 16334.74541837395, 17639.477479975998, 16518.651957923823, 16893.226615462372, 16947.310921694178, 17104.877461780117, 16409.054378665427, 15124.37573268843, 17099.560636425394, 17942.751686196363, 16637.72180745935, 16746.11954534038, 18051.48248438526, 15722.478103821759, 16010.529654617318], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7796.044004611467, 10320.442569745139, 12258.226031669356, 10465.81838221326, 12917.34223483506, 9973.510510301274, 9800.392005293354, 8835.733010995946, 11634.32691307205, 9681.57752078511, 10097.81851849231, 10792.931676135842, 11276.65109501838, 9373.688229127602, 9049.995506686755, 9872.53613727308, 12633.252030828964, 6778.466516623106, 7948.857547066343, 9337.245846193238, 10991.264414610141, 12239.017155036005, 10983.068604639944, 11637.411411996922, 11582.835800892268, 10164.524043609577, 11346.94672940963, 10034.455264948767, 7996.415069878581, 9795.556355970853, 7623.7040673413285, 11756.073328198761, 9508.253969136633, 7268.936287277429, 8674.099258930844, 8253.830169460889, 10856.313105648138, 372.4042156903809, 6992.754144761181, 6885.18633347449, 7778.804274469507, 11460.110650065853, 10484.95015349492, 10608.092143884123, 10547.888788663377, 9791.850721165505, 9534.39807386686, 9657.450111069968, 8674.003953173651, 11649.885131663643, 7447.467930460653, 11856.598750727508, 11478.26506017985, 8462.954499057845, 8706.869050258776, 12778.932720404333, 8359.634064040267, 9401.024832172858, 0.9205226997950144, 10433.795394693336, 8514.067012888067, 9875.915421901815, 9033.346326887344, 11345.611291773479, 11317.925998679842, 11971.787519468417, 11880.223984111131, 11563.409251185238, 11595.02082288766, 4.225109425510276, 10884.019385418713, 11143.571123429047, 10481.056198788701, 11520.840815849502, 10082.892690402698, 12873.7291179317, 6235.428324339856, 8394.5557229108, 10797.395800044333, 8244.614933741119, 12273.129525980989, 12328.448228174924, 10764.63507373971, 8551.605555383332, 13044.961284922894, 11870.229392278587, 10229.099224318072, 8608.452386846599, 10768.097904201664, 10794.72804614603, 10637.371904726098, 10541.520673886263, 11665.999780592307, 11014.438718822494, 10315.725376944643, 10538.560706326994, 11359.660571503206, 9425.873737665746, 10310.724963095969, 10435.37275687279], "policy_adversary_policy_reward": [5681.599045374798, 5437.443265896627, 2067.58732630285, 3417.3605365556714, 1873.4602788012353, 1265.0772347844925, 3652.700370603724, 3132.8338102725334, 493.09598858261404, 1167.1162433372856, 4168.625113429671, 905.1176166495558, 1861.3990094059814, 4341.743618437593, 5295.690152123797, 3670.333137865361, 1355.5076727565256, 2489.3787257167546, 4395.399807306371, 3875.0291431482106, 4044.317105238651, 1778.9107957360914, 3332.26770872171, 2794.459371941365, 1757.729934109298, 2860.5308137160237, 3613.7493865358706, 4530.625915356817, 4742.3439075406795, 3464.042194823771, 4251.665105195779, 3920.5851281155165, 1481.4155394251939, 787.6370149192196, 7241.111144674587, 4682.756999646815, 5161.44228820081, 6183.60622943137, 4018.8215682816285, 4759.139161127502, 2258.4838158798234, 3046.26600414804, 1800.1714704367027, 1833.9589937607286, 3139.1942436512563, 2352.6764172395497, 2475.4032730364806, 2124.535810345716, 2428.85580063988, 2541.2282624709383, 3882.101946962862, 2023.3495971102539, 2212.129443727241, 2684.1076692918487, 3526.3634251609833, 3406.649634581803, 6143.5730940422045, 5410.1931434128865, 4346.487011144076, 2747.2340352896763, 6518.431556389616, 2798.1487439549214, 2270.4015186772804, 2083.297459963545, 4630.51038818134, 3586.6376741490885, 5991.440204761791, 6868.070850503312, 5441.144526414368, 4724.350641782061, 5521.015181040592, 4103.725433355429, 2561.4084374052504, 2184.475531725254, 1158.6440552901063, 1324.6520591573333, 4531.240674510966, 7149.381478969767, 5395.978476275712, 6930.76277854652, 6363.331349261444, 3447.7197041782415, 2661.279806886174, 1535.8615751886427, 3585.7210075172607, 3284.5605016413283, 3015.1299406744215, 3522.9091497089807, 1671.3005088150908, 3582.8004939194925, 2815.315549640564, 3443.514142366384, 4434.300118613926, 4259.036872898945, 4350.846912526827, 3624.9348397991193, 5115.12129245173, 5387.638950553111, 2044.3705497552346, 2489.1492106131514, 4255.884551741068, 6361.7081022861, 1687.1686457017809, 2280.612123622059, 2661.7672436111634, 1004.1390187892214, 5679.181124673107, 2748.005137207191, 3760.897859678439, 5421.48775072103, 1300.0881417544788, 1264.3522651521885, 5675.011798820677, 3184.3154623833093, 3987.77438480349, 4031.24256035163, 33.20930175212494, 69.79015541885974, 3660.83200674253, 3205.315704032179, 5628.068610842887, 4186.060064561942, 3858.1962383812497, 4142.612585058841, 5086.310788852215, 4338.544218466637, 1685.718916474511, 2794.7787993046554, 2824.2096250510926, 672.9886383819576, 1234.144930370835, 2168.237497384779, 1418.3435383738738, 2196.658834388493, 1608.3920968533157, 2315.955666233331, 2544.3079452774323, 217.13998129820484, 207.90692493045398, 108.15218534389048, 3258.1162383122314, 330.42458079361984, 2970.249186973611, 2987.4852136510344, 3661.0794249422215, 838.1610124897089, 2542.884376246352, 2233.4408585986002, 3731.3186456044723, 4026.0285132648078, 1263.5038390341333, 270.3581041857658, 5057.998772366713, 7905.039010086514, 5744.646842147385, 3701.654667320694, 1836.3530583010204, 3343.332752434782, 5837.670901595709, 5885.288024984315, 1650.4542303222945, 1863.312719900865, 1724.6052465654707, 1812.5806926228802, 3367.195754397007, 2464.1344071570584, 3064.1133127426606, 5549.260670779274, 1089.8212210718082, 1012.7599355833289, 2222.103044729508, 2242.412981365848, 3572.6951179546722, 3837.683137703217, 5533.6832368843525, 2376.516334192886, 3234.132469714467, 2890.996241546263, 3037.2461664975194, 3115.3367090506217, 3274.2965664960625, 3193.2089905579555, 3054.545381904686, 2812.9883228745402, 983.3044629036698, 2475.0714891924863, 3125.4250341887932, 2959.6968834141335, 3821.28104085299, 3805.7452683987062, 3602.8904329528505, 2496.2706681795366, 2636.2716761268607, 2750.1872977102676, 4185.285987969621, 4440.322758749877, 1580.342480090891, 3831.4106606349624, 1977.4808715270863, 3597.6760262174425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997485718522039, "mean_inference_ms": 0.9938499434208131, "mean_action_processing_ms": 0.16815117666335308, "mean_env_wait_ms": 0.05460524393476355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002912759780883789, "StateBufferConnector_ms": 0.002489447593688965, "ViewRequirementAgentConnector_ms": 0.06399750709533691}, "num_episodes": 20, "episode_return_max": 20128.447342542586, "episode_return_min": 103.91997987077968, "episode_return_mean": 16361.045455392064}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.8014088463725, "num_env_steps_trained_throughput_per_sec": 541.8014088463725, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2028000, "timers": {"training_iteration_time_ms": 7962.904, "restore_workers_time_ms": 0.049, "training_step_time_ms": 7962.827, "sample_time_ms": 822.187, "learn_time_ms": 7129.287, "learn_throughput": 561.066, "synch_weights_time_ms": 10.889}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "done": false, "training_iteration": 169, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-17", "timestamp": 1723236677, "time_this_iter_s": 7.387424945831299, "time_total_s": 1287.436767578125, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bb1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1287.436767578125, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 29.919999999999998, "ram_util_percent": 79.74000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58027285246.916405, "cur_kl_coeff": 3672079595230.765, "cur_lr": 5.0000000000000016e-05, "total_loss": 4920694831.813757, "policy_loss": 0.0015787986129344928, "vf_loss": 9.468591376208755, "vf_explained_var": 0.006796548890058326, "kl": 0.0013400294578685943, "entropy": 0.9746218615108067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8287223767954857, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997160039345424, "policy_loss": -0.006261238156002946, "vf_loss": 10.0, "vf_explained_var": 2.4395684401194255e-06, "kl": 0.013334178545240624, "entropy": 1.0879449057082335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 20128.447342542586, "episode_reward_min": 103.91997987077968, "episode_reward_mean": 16311.782375012872, "episode_len_mean": 194.28, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19428, "policy_reward_min": {"agent_policy": 0.9205226997950144, "adversary_policy": 33.20930175212494}, "policy_reward_max": {"agent_policy": 13044.961284922894, "adversary_policy": 7905.039010086514}, "policy_reward_mean": {"agent_policy": 9943.244149983038, "adversary_policy": 3184.269112514923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18115.206575602308, 16296.014234637956, 15873.14761923344, 16474.939265530713, 16237.350495379062, 16552.919864003026, 16069.975587682693, 16243.18384242868, 16967.46832469151, 19550.181307333703, 16889.27740240462, 16940.284367685817, 16109.772306839588, 17725.40203146701, 20128.447342542586, 18839.5944271273, 17878.570783856914, 15602.19707477861, 2855.7003301378204, 18673.37629824192, 19211.92758829667, 17589.855327909223, 15657.252032140617, 17355.231662653496, 17146.131234267537, 15801.989791397966, 16050.680413172433, 18227.735065379733, 17633.23186339591, 19176.764196178552, 16183.404892031993, 18065.06058448783, 15824.379520051314, 15144.171322580207, 16890.140760938146, 17889.254660658276, 15343.37312731097, 17218.961325244265, 17420.04177732796, 103.91997987077968, 17299.943105468017, 18328.19568829288, 17876.724245341877, 18458.201334206122, 15826.109007552623, 14815.124262112904, 15374.169947224023, 15495.226356873467, 15487.75701427189, 14356.46874946329, 320.2842196998547, 14472.5602045246, 17101.30552405371, 14980.296636220604, 16297.166050694457, 17840.23984927195, 14407.591061151561, 19198.466106793072, 17840.857232378872, 15977.081610780147, 19967.57386032108, 15786.896476204076, 15865.634167363212, 16595.96523529374, 17164.97953890524, 15147.542441577998, 16334.74541837395, 17639.477479975998, 16518.651957923823, 16893.226615462372, 16947.310921694178, 17104.877461780117, 16409.054378665427, 15124.37573268843, 17099.560636425394, 17942.751686196363, 16637.72180745935, 16746.11954534038, 18051.48248438526, 15722.478103821759, 16010.529654617318, 15591.73542233862, 16902.283040711467, 15588.030104876543, 15728.040752326133, 18959.832608759538, 18623.8001662094, 18702.365299232242, 17766.40615119114, 15086.671547068388, 16446.988350248517, 15252.87874428726, 16702.898128946537, 16603.729410878706, 16321.028272387142, 17609.802341556715, 15501.919198097998, 15394.024995088585, 15181.974166139025, 15792.58838319259], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 24, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9337.245846193238, 10991.264414610141, 12239.017155036005, 10983.068604639944, 11637.411411996922, 11582.835800892268, 10164.524043609577, 11346.94672940963, 10034.455264948767, 7996.415069878581, 9795.556355970853, 7623.7040673413285, 11756.073328198761, 9508.253969136633, 7268.936287277429, 8674.099258930844, 8253.830169460889, 10856.313105648138, 372.4042156903809, 6992.754144761181, 6885.18633347449, 7778.804274469507, 11460.110650065853, 10484.95015349492, 10608.092143884123, 10547.888788663377, 9791.850721165505, 9534.39807386686, 9657.450111069968, 8674.003953173651, 11649.885131663643, 7447.467930460653, 11856.598750727508, 11478.26506017985, 8462.954499057845, 8706.869050258776, 12778.932720404333, 8359.634064040267, 9401.024832172858, 0.9205226997950144, 10433.795394693336, 8514.067012888067, 9875.915421901815, 9033.346326887344, 11345.611291773479, 11317.925998679842, 11971.787519468417, 11880.223984111131, 11563.409251185238, 11595.02082288766, 4.225109425510276, 10884.019385418713, 11143.571123429047, 10481.056198788701, 11520.840815849502, 10082.892690402698, 12873.7291179317, 6235.428324339856, 8394.5557229108, 10797.395800044333, 8244.614933741119, 12273.129525980989, 12328.448228174924, 10764.63507373971, 8551.605555383332, 13044.961284922894, 11870.229392278587, 10229.099224318072, 8608.452386846599, 10768.097904201664, 10794.72804614603, 10637.371904726098, 10541.520673886263, 11665.999780592307, 11014.438718822494, 10315.725376944643, 10538.560706326994, 11359.660571503206, 9425.873737665746, 10310.724963095969, 10435.37275687279, 10480.936030154464, 9922.17790886339, 11806.861743854017, 12441.635335985382, 8541.964547605185, 8064.278394726541, 9266.605284054633, 9129.30972651225, 10949.535024795869, 9625.58974985166, 10782.550699820216, 10939.345388954342, 10266.602662151447, 9751.958862032287, 9177.601854952569, 9986.984517182382, 12270.519928613872, 12122.024242104957, 12145.468028275329], "policy_adversary_policy_reward": [4018.8215682816285, 4759.139161127502, 2258.4838158798234, 3046.26600414804, 1800.1714704367027, 1833.9589937607286, 3139.1942436512563, 2352.6764172395497, 2475.4032730364806, 2124.535810345716, 2428.85580063988, 2541.2282624709383, 3882.101946962862, 2023.3495971102539, 2212.129443727241, 2684.1076692918487, 3526.3634251609833, 3406.649634581803, 6143.5730940422045, 5410.1931434128865, 4346.487011144076, 2747.2340352896763, 6518.431556389616, 2798.1487439549214, 2270.4015186772804, 2083.297459963545, 4630.51038818134, 3586.6376741490885, 5991.440204761791, 6868.070850503312, 5441.144526414368, 4724.350641782061, 5521.015181040592, 4103.725433355429, 2561.4084374052504, 2184.475531725254, 1158.6440552901063, 1324.6520591573333, 4531.240674510966, 7149.381478969767, 5395.978476275712, 6930.76277854652, 6363.331349261444, 3447.7197041782415, 2661.279806886174, 1535.8615751886427, 3585.7210075172607, 3284.5605016413283, 3015.1299406744215, 3522.9091497089807, 1671.3005088150908, 3582.8004939194925, 2815.315549640564, 3443.514142366384, 4434.300118613926, 4259.036872898945, 4350.846912526827, 3624.9348397991193, 5115.12129245173, 5387.638950553111, 2044.3705497552346, 2489.1492106131514, 4255.884551741068, 6361.7081022861, 1687.1686457017809, 2280.612123622059, 2661.7672436111634, 1004.1390187892214, 5679.181124673107, 2748.005137207191, 3760.897859678439, 5421.48775072103, 1300.0881417544788, 1264.3522651521885, 5675.011798820677, 3184.3154623833093, 3987.77438480349, 4031.24256035163, 33.20930175212494, 69.79015541885974, 3660.83200674253, 3205.315704032179, 5628.068610842887, 4186.060064561942, 3858.1962383812497, 4142.612585058841, 5086.310788852215, 4338.544218466637, 1685.718916474511, 2794.7787993046554, 2824.2096250510926, 672.9886383819576, 1234.144930370835, 2168.237497384779, 1418.3435383738738, 2196.658834388493, 1608.3920968533157, 2315.955666233331, 2544.3079452774323, 217.13998129820484, 207.90692493045398, 108.15218534389048, 3258.1162383122314, 330.42458079361984, 2970.249186973611, 2987.4852136510344, 3661.0794249422215, 838.1610124897089, 2542.884376246352, 2233.4408585986002, 3731.3186456044723, 4026.0285132648078, 1263.5038390341333, 270.3581041857658, 5057.998772366713, 7905.039010086514, 5744.646842147385, 3701.654667320694, 1836.3530583010204, 3343.332752434782, 5837.670901595709, 5885.288024984315, 1650.4542303222945, 1863.312719900865, 1724.6052465654707, 1812.5806926228802, 3367.195754397007, 2464.1344071570584, 3064.1133127426606, 5549.260670779274, 1089.8212210718082, 1012.7599355833289, 2222.103044729508, 2242.412981365848, 3572.6951179546722, 3837.683137703217, 5533.6832368843525, 2376.516334192886, 3234.132469714467, 2890.996241546263, 3037.2461664975194, 3115.3367090506217, 3274.2965664960625, 3193.2089905579555, 3054.545381904686, 2812.9883228745402, 983.3044629036698, 2475.0714891924863, 3125.4250341887932, 2959.6968834141335, 3821.28104085299, 3805.7452683987062, 3602.8904329528505, 2496.2706681795366, 2636.2716761268607, 2750.1872977102676, 4185.285987969621, 4440.322758749877, 1580.342480090891, 3831.4106606349624, 1977.4808715270863, 3597.6760262174425, 1453.0808202454114, 3657.7185719388053, 2762.5690723461084, 4217.536059501992, 2083.615949949818, 1697.552411072692, 1689.6083498147311, 1596.7970665260714, 5299.358618681743, 5118.509442472577, 5706.574349805554, 4852.94742167725, 4691.33350197993, 4744.426513197663, 5009.7399672365755, 3627.3564574423053, 3192.600598935059, 944.5359233375123, 4512.354029677911, 2309.044570718967, 3359.5849239107247, 1110.743120556339, 2606.5080870368333, 3157.0446529553788, 3875.5329615794885, 2461.5937871477736, 2219.5414228542454, 4349.527987500641, 3467.6667178257685, 4964.533768778377, 1359.783574367038, 4155.151106548562, 1258.5625006077225, 1864.9425658670302, 1142.7643175880876, 1917.1856064460112, 1995.8318633145109, 1651.2884916027729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996666089509418, "mean_inference_ms": 0.9934418525365111, "mean_action_processing_ms": 0.16812804939051573, "mean_env_wait_ms": 0.054579615955895486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002858400344848633, "StateBufferConnector_ms": 0.0024454593658447266, "ViewRequirementAgentConnector_ms": 0.06356322765350342}, "num_episodes": 19, "episode_return_max": 20128.447342542586, "episode_return_min": 103.91997987077968, "episode_return_mean": 16311.782375012872}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.3816511177102, "num_env_steps_trained_throughput_per_sec": 534.3816511177102, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 7727.576, "restore_workers_time_ms": 0.048, "training_step_time_ms": 7727.5, "sample_time_ms": 784.9, "learn_time_ms": 6931.207, "learn_throughput": 577.1, "synch_weights_time_ms": 10.947}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 170, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-25", "timestamp": 1723236685, "time_this_iter_s": 7.489696025848389, "time_total_s": 1294.9264636039734, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bb1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1294.9264636039734, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 31.41818181818182, "ram_util_percent": 79.89090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22926944894.577778, "cur_kl_coeff": 1836039797615.3826, "cur_lr": 5.0000000000000016e-05, "total_loss": 1483376330.9714286, "policy_loss": 0.0011149308597422623, "vf_loss": 9.642439627268958, "vf_explained_var": 0.009294410357399592, "kl": 0.0008079216644296019, "entropy": 0.9656007135986651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8675710543990135, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003560607632002, "policy_loss": -0.003539844170154538, "vf_loss": 10.0, "vf_explained_var": 8.822108308474223e-07, "kl": 0.027673538327023076, "entropy": 1.1793716419488192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "env_runners": {"episode_reward_max": 19967.57386032108, "episode_reward_min": 103.91997987077968, "episode_reward_mean": 16354.076535272647, "episode_len_mean": 196.04, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19604, "policy_reward_min": {"agent_policy": 0.9205226997950144, "adversary_policy": 33.20930175212494}, "policy_reward_max": {"agent_policy": 13044.961284922894, "adversary_policy": 7905.039010086514}, "policy_reward_mean": {"agent_policy": 10100.263043317475, "adversary_policy": 3126.9067459775943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19211.92758829667, 17589.855327909223, 15657.252032140617, 17355.231662653496, 17146.131234267537, 15801.989791397966, 16050.680413172433, 18227.735065379733, 17633.23186339591, 19176.764196178552, 16183.404892031993, 18065.06058448783, 15824.379520051314, 15144.171322580207, 16890.140760938146, 17889.254660658276, 15343.37312731097, 17218.961325244265, 17420.04177732796, 103.91997987077968, 17299.943105468017, 18328.19568829288, 17876.724245341877, 18458.201334206122, 15826.109007552623, 14815.124262112904, 15374.169947224023, 15495.226356873467, 15487.75701427189, 14356.46874946329, 320.2842196998547, 14472.5602045246, 17101.30552405371, 14980.296636220604, 16297.166050694457, 17840.23984927195, 14407.591061151561, 19198.466106793072, 17840.857232378872, 15977.081610780147, 19967.57386032108, 15786.896476204076, 15865.634167363212, 16595.96523529374, 17164.97953890524, 15147.542441577998, 16334.74541837395, 17639.477479975998, 16518.651957923823, 16893.226615462372, 16947.310921694178, 17104.877461780117, 16409.054378665427, 15124.37573268843, 17099.560636425394, 17942.751686196363, 16637.72180745935, 16746.11954534038, 18051.48248438526, 15722.478103821759, 16010.529654617318, 15591.73542233862, 16902.283040711467, 15588.030104876543, 15728.040752326133, 18959.832608759538, 18623.8001662094, 18702.365299232242, 17766.40615119114, 15086.671547068388, 16446.988350248517, 15252.87874428726, 16702.898128946537, 16603.729410878706, 16321.028272387142, 17609.802341556715, 15501.919198097998, 15394.024995088585, 15181.974166139025, 15792.58838319259, 15146.986098274647, 19023.571713149668, 16983.007527522746, 15809.741022354445, 16140.332847009531, 17567.90513064127, 16172.8439175922, 15435.729772092014, 17172.460233168942, 17968.365439508503, 17788.738346785904, 16184.846758411673, 16361.77497706156, 15298.052699754802, 17559.95843885763, 17234.53511990526, 15508.589414551927, 17755.908351946746, 17515.092846392363, 15623.98485260105], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6885.18633347449, 7778.804274469507, 11460.110650065853, 10484.95015349492, 10608.092143884123, 10547.888788663377, 9791.850721165505, 9534.39807386686, 9657.450111069968, 8674.003953173651, 11649.885131663643, 7447.467930460653, 11856.598750727508, 11478.26506017985, 8462.954499057845, 8706.869050258776, 12778.932720404333, 8359.634064040267, 9401.024832172858, 0.9205226997950144, 10433.795394693336, 8514.067012888067, 9875.915421901815, 9033.346326887344, 11345.611291773479, 11317.925998679842, 11971.787519468417, 11880.223984111131, 11563.409251185238, 11595.02082288766, 4.225109425510276, 10884.019385418713, 11143.571123429047, 10481.056198788701, 11520.840815849502, 10082.892690402698, 12873.7291179317, 6235.428324339856, 8394.5557229108, 10797.395800044333, 8244.614933741119, 12273.129525980989, 12328.448228174924, 10764.63507373971, 8551.605555383332, 13044.961284922894, 11870.229392278587, 10229.099224318072, 8608.452386846599, 10768.097904201664, 10794.72804614603, 10637.371904726098, 10541.520673886263, 11665.999780592307, 11014.438718822494, 10315.725376944643, 10538.560706326994, 11359.660571503206, 9425.873737665746, 10310.724963095969, 10435.37275687279, 10480.936030154464, 9922.17790886339, 11806.861743854017, 12441.635335985382, 8541.964547605185, 8064.278394726541, 9266.605284054633, 9129.30972651225, 10949.535024795869, 9625.58974985166, 10782.550699820216, 10939.345388954342, 10266.602662151447, 9751.958862032287, 9177.601854952569, 9986.984517182382, 12270.519928613872, 12122.024242104957, 12145.468028275329, 11592.331468923694, 8543.328969962542, 9907.781088770573, 9945.741573656465, 10918.508880591358, 10599.884832629743, 11525.430255546933, 12465.800345357562, 9473.242345945077, 8838.03724862382, 6391.708613295393, 11622.66570410587, 11708.025872607577, 12581.891252318203, 9246.253292997124, 8208.287689160772, 11298.447317105249, 6936.847192713255, 10216.65269709957, 11096.131935664293], "policy_adversary_policy_reward": [5395.978476275712, 6930.76277854652, 6363.331349261444, 3447.7197041782415, 2661.279806886174, 1535.8615751886427, 3585.7210075172607, 3284.5605016413283, 3015.1299406744215, 3522.9091497089807, 1671.3005088150908, 3582.8004939194925, 2815.315549640564, 3443.514142366384, 4434.300118613926, 4259.036872898945, 4350.846912526827, 3624.9348397991193, 5115.12129245173, 5387.638950553111, 2044.3705497552346, 2489.1492106131514, 4255.884551741068, 6361.7081022861, 1687.1686457017809, 2280.612123622059, 2661.7672436111634, 1004.1390187892214, 5679.181124673107, 2748.005137207191, 3760.897859678439, 5421.48775072103, 1300.0881417544788, 1264.3522651521885, 5675.011798820677, 3184.3154623833093, 3987.77438480349, 4031.24256035163, 33.20930175212494, 69.79015541885974, 3660.83200674253, 3205.315704032179, 5628.068610842887, 4186.060064561942, 3858.1962383812497, 4142.612585058841, 5086.310788852215, 4338.544218466637, 1685.718916474511, 2794.7787993046554, 2824.2096250510926, 672.9886383819576, 1234.144930370835, 2168.237497384779, 1418.3435383738738, 2196.658834388493, 1608.3920968533157, 2315.955666233331, 2544.3079452774323, 217.13998129820484, 207.90692493045398, 108.15218534389048, 3258.1162383122314, 330.42458079361984, 2970.249186973611, 2987.4852136510344, 3661.0794249422215, 838.1610124897089, 2542.884376246352, 2233.4408585986002, 3731.3186456044723, 4026.0285132648078, 1263.5038390341333, 270.3581041857658, 5057.998772366713, 7905.039010086514, 5744.646842147385, 3701.654667320694, 1836.3530583010204, 3343.332752434782, 5837.670901595709, 5885.288024984315, 1650.4542303222945, 1863.312719900865, 1724.6052465654707, 1812.5806926228802, 3367.195754397007, 2464.1344071570584, 3064.1133127426606, 5549.260670779274, 1089.8212210718082, 1012.7599355833289, 2222.103044729508, 2242.412981365848, 3572.6951179546722, 3837.683137703217, 5533.6832368843525, 2376.516334192886, 3234.132469714467, 2890.996241546263, 3037.2461664975194, 3115.3367090506217, 3274.2965664960625, 3193.2089905579555, 3054.545381904686, 2812.9883228745402, 983.3044629036698, 2475.0714891924863, 3125.4250341887932, 2959.6968834141335, 3821.28104085299, 3805.7452683987062, 3602.8904329528505, 2496.2706681795366, 2636.2716761268607, 2750.1872977102676, 4185.285987969621, 4440.322758749877, 1580.342480090891, 3831.4106606349624, 1977.4808715270863, 3597.6760262174425, 1453.0808202454114, 3657.7185719388053, 2762.5690723461084, 4217.536059501992, 2083.615949949818, 1697.552411072692, 1689.6083498147311, 1596.7970665260714, 5299.358618681743, 5118.509442472577, 5706.574349805554, 4852.94742167725, 4691.33350197993, 4744.426513197663, 5009.7399672365755, 3627.3564574423053, 3192.600598935059, 944.5359233375123, 4512.354029677911, 2309.044570718967, 3359.5849239107247, 1110.743120556339, 2606.5080870368333, 3157.0446529553788, 3875.5329615794885, 2461.5937871477736, 2219.5414228542454, 4349.527987500641, 3467.6667178257685, 4964.533768778377, 1359.783574367038, 4155.151106548562, 1258.5625006077225, 1864.9425658670302, 1142.7643175880876, 1917.1856064460112, 1995.8318633145109, 1651.2884916027729, 1004.8504745437648, 2549.804154807229, 4932.517365349788, 5547.725377837418, 3367.172002742797, 3708.05443600941, 4196.394050074486, 1667.6053986235117, 3023.282054653548, 2198.5419117646697, 3531.865758130918, 3436.1545398806006, 2602.163416484976, 2045.2502455602935, 1580.9661616178787, 1388.9632651166144, 3206.42998984615, 4492.787897377745, 3826.2298157775112, 5304.09837510713, 3646.6027230549516, 7750.427010435555, 2291.8263378692004, 2270.354716436646, 2416.438565065864, 2237.310539388157, 1560.244371412707, 1155.917076023934, 4723.8444479235195, 3589.8606979370006, 3682.200804797474, 5344.046625947049, 1780.6309377915695, 2429.5111596551433, 7205.288431017688, 3613.772728215802, 3528.2876024153848, 3770.152546877413, 1481.8492288701568, 3046.003688066625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995584828807636, "mean_inference_ms": 0.993295109666781, "mean_action_processing_ms": 0.168097913062499, "mean_env_wait_ms": 0.05455664337997817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029859542846679688, "StateBufferConnector_ms": 0.002491593360900879, "ViewRequirementAgentConnector_ms": 0.06601643562316895}, "num_episodes": 20, "episode_return_max": 19967.57386032108, "episode_return_min": 103.91997987077968, "episode_return_mean": 16354.076535272647}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.6361500013511, "num_env_steps_trained_throughput_per_sec": 534.6361500013511, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2052000, "timers": {"training_iteration_time_ms": 7664.561, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7664.524, "sample_time_ms": 764.226, "learn_time_ms": 6888.947, "learn_throughput": 580.64, "synch_weights_time_ms": 10.913}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "done": false, "training_iteration": 171, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-32", "timestamp": 1723236692, "time_this_iter_s": 7.487317085266113, "time_total_s": 1302.4137806892395, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b9eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1302.4137806892395, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 26.6, "ram_util_percent": 80.12727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14859303627.039154, "cur_kl_coeff": 918019898807.6913, "cur_lr": 5.0000000000000016e-05, "total_loss": 534928219.784127, "policy_loss": 0.0010220480541989366, "vf_loss": 9.754208289252388, "vf_explained_var": 0.0023739745377232787, "kl": 0.0005826978485510197, "entropy": 0.9607601573227574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9591201063245535, "cur_kl_coeff": 0.38486767709255226, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.001858471830685, "policy_loss": -0.0043600874244778725, "vf_loss": 10.0, "vf_explained_var": 3.3468070129553476e-05, "kl": 0.01615770656693106, "entropy": 1.355647274106741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 19967.57386032108, "episode_reward_min": 320.2842196998547, "episode_reward_mean": 16639.037836300264, "episode_len_mean": 198.03, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19803, "policy_reward_min": {"agent_policy": 4.225109425510276, "adversary_policy": 108.15218534389048}, "policy_reward_max": {"agent_policy": 13044.961284922894, "adversary_policy": 8364.776957723969}, "policy_reward_mean": {"agent_policy": 9981.328141942859, "adversary_policy": 3328.8548471787117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18328.19568829288, 17876.724245341877, 18458.201334206122, 15826.109007552623, 14815.124262112904, 15374.169947224023, 15495.226356873467, 15487.75701427189, 14356.46874946329, 320.2842196998547, 14472.5602045246, 17101.30552405371, 14980.296636220604, 16297.166050694457, 17840.23984927195, 14407.591061151561, 19198.466106793072, 17840.857232378872, 15977.081610780147, 19967.57386032108, 15786.896476204076, 15865.634167363212, 16595.96523529374, 17164.97953890524, 15147.542441577998, 16334.74541837395, 17639.477479975998, 16518.651957923823, 16893.226615462372, 16947.310921694178, 17104.877461780117, 16409.054378665427, 15124.37573268843, 17099.560636425394, 17942.751686196363, 16637.72180745935, 16746.11954534038, 18051.48248438526, 15722.478103821759, 16010.529654617318, 15591.73542233862, 16902.283040711467, 15588.030104876543, 15728.040752326133, 18959.832608759538, 18623.8001662094, 18702.365299232242, 17766.40615119114, 15086.671547068388, 16446.988350248517, 15252.87874428726, 16702.898128946537, 16603.729410878706, 16321.028272387142, 17609.802341556715, 15501.919198097998, 15394.024995088585, 15181.974166139025, 15792.58838319259, 15146.986098274647, 19023.571713149668, 16983.007527522746, 15809.741022354445, 16140.332847009531, 17567.90513064127, 16172.8439175922, 15435.729772092014, 17172.460233168942, 17968.365439508503, 17788.738346785904, 16184.846758411673, 16361.77497706156, 15298.052699754802, 17559.95843885763, 17234.53511990526, 15508.589414551927, 17755.908351946746, 17515.092846392363, 15623.98485260105, 18213.14690985974, 18282.9844566181, 15305.453603247668, 14828.317610586673, 17142.01733434696, 19287.01316392602, 16610.99090642246, 18405.871928098382, 18565.47787220801, 18973.883515778525, 17978.456951341093, 15913.54226743448, 14706.80128017548, 18343.891514165738, 16578.28491825939, 19612.276216463073, 18403.593718719876, 19641.92706098014, 16824.969915901947, 16472.180040059553, 19638.499148930467], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8514.067012888067, 9875.915421901815, 9033.346326887344, 11345.611291773479, 11317.925998679842, 11971.787519468417, 11880.223984111131, 11563.409251185238, 11595.02082288766, 4.225109425510276, 10884.019385418713, 11143.571123429047, 10481.056198788701, 11520.840815849502, 10082.892690402698, 12873.7291179317, 6235.428324339856, 8394.5557229108, 10797.395800044333, 8244.614933741119, 12273.129525980989, 12328.448228174924, 10764.63507373971, 8551.605555383332, 13044.961284922894, 11870.229392278587, 10229.099224318072, 8608.452386846599, 10768.097904201664, 10794.72804614603, 10637.371904726098, 10541.520673886263, 11665.999780592307, 11014.438718822494, 10315.725376944643, 10538.560706326994, 11359.660571503206, 9425.873737665746, 10310.724963095969, 10435.37275687279, 10480.936030154464, 9922.17790886339, 11806.861743854017, 12441.635335985382, 8541.964547605185, 8064.278394726541, 9266.605284054633, 9129.30972651225, 10949.535024795869, 9625.58974985166, 10782.550699820216, 10939.345388954342, 10266.602662151447, 9751.958862032287, 9177.601854952569, 9986.984517182382, 12270.519928613872, 12122.024242104957, 12145.468028275329, 11592.331468923694, 8543.328969962542, 9907.781088770573, 9945.741573656465, 10918.508880591358, 10599.884832629743, 11525.430255546933, 12465.800345357562, 9473.242345945077, 8838.03724862382, 6391.708613295393, 11622.66570410587, 11708.025872607577, 12581.891252318203, 9246.253292997124, 8208.287689160772, 11298.447317105249, 6936.847192713255, 10216.65269709957, 11096.131935664293, 8576.663031619511, 8387.030336640935, 11738.171403670625, 12496.046267113457, 10719.313962998323, 8574.089936643179, 7771.287771537965, 7146.808303375915, 5873.045407786426, 7321.966917333738, 5777.35866600699, 11509.102492945349, 12126.515289093153, 8461.787963095469, 10259.058599317257, 6358.617304414908, 6924.6567320787335, 7525.775488146601, 10251.744586712308, 9887.051572172168, 6419.500989522572], "policy_adversary_policy_reward": [5628.068610842887, 4186.060064561942, 3858.1962383812497, 4142.612585058841, 5086.310788852215, 4338.544218466637, 1685.718916474511, 2794.7787993046554, 2824.2096250510926, 672.9886383819576, 1234.144930370835, 2168.237497384779, 1418.3435383738738, 2196.658834388493, 1608.3920968533157, 2315.955666233331, 2544.3079452774323, 217.13998129820484, 207.90692493045398, 108.15218534389048, 3258.1162383122314, 330.42458079361984, 2970.249186973611, 2987.4852136510344, 3661.0794249422215, 838.1610124897089, 2542.884376246352, 2233.4408585986002, 3731.3186456044723, 4026.0285132648078, 1263.5038390341333, 270.3581041857658, 5057.998772366713, 7905.039010086514, 5744.646842147385, 3701.654667320694, 1836.3530583010204, 3343.332752434782, 5837.670901595709, 5885.288024984315, 1650.4542303222945, 1863.312719900865, 1724.6052465654707, 1812.5806926228802, 3367.195754397007, 2464.1344071570584, 3064.1133127426606, 5549.260670779274, 1089.8212210718082, 1012.7599355833289, 2222.103044729508, 2242.412981365848, 3572.6951179546722, 3837.683137703217, 5533.6832368843525, 2376.516334192886, 3234.132469714467, 2890.996241546263, 3037.2461664975194, 3115.3367090506217, 3274.2965664960625, 3193.2089905579555, 3054.545381904686, 2812.9883228745402, 983.3044629036698, 2475.0714891924863, 3125.4250341887932, 2959.6968834141335, 3821.28104085299, 3805.7452683987062, 3602.8904329528505, 2496.2706681795366, 2636.2716761268607, 2750.1872977102676, 4185.285987969621, 4440.322758749877, 1580.342480090891, 3831.4106606349624, 1977.4808715270863, 3597.6760262174425, 1453.0808202454114, 3657.7185719388053, 2762.5690723461084, 4217.536059501992, 2083.615949949818, 1697.552411072692, 1689.6083498147311, 1596.7970665260714, 5299.358618681743, 5118.509442472577, 5706.574349805554, 4852.94742167725, 4691.33350197993, 4744.426513197663, 5009.7399672365755, 3627.3564574423053, 3192.600598935059, 944.5359233375123, 4512.354029677911, 2309.044570718967, 3359.5849239107247, 1110.743120556339, 2606.5080870368333, 3157.0446529553788, 3875.5329615794885, 2461.5937871477736, 2219.5414228542454, 4349.527987500641, 3467.6667178257685, 4964.533768778377, 1359.783574367038, 4155.151106548562, 1258.5625006077225, 1864.9425658670302, 1142.7643175880876, 1917.1856064460112, 1995.8318633145109, 1651.2884916027729, 1004.8504745437648, 2549.804154807229, 4932.517365349788, 5547.725377837418, 3367.172002742797, 3708.05443600941, 4196.394050074486, 1667.6053986235117, 3023.282054653548, 2198.5419117646697, 3531.865758130918, 3436.1545398806006, 2602.163416484976, 2045.2502455602935, 1580.9661616178787, 1388.9632651166144, 3206.42998984615, 4492.787897377745, 3826.2298157775112, 5304.09837510713, 3646.6027230549516, 7750.427010435555, 2291.8263378692004, 2270.354716436646, 2416.438565065864, 2237.310539388157, 1560.244371412707, 1155.917076023934, 4723.8444479235195, 3589.8606979370006, 3682.200804797474, 5344.046625947049, 1780.6309377915695, 2429.5111596551433, 7205.288431017688, 3613.772728215802, 3528.2876024153848, 3770.152546877413, 1481.8492288701568, 3046.003688066625, 5561.8904949693915, 4074.5933832708924, 5755.105287089986, 4140.8488328871845, 1806.6249416862747, 1760.6572578907308, 1645.3858209915502, 686.8855224817065, 3257.057791866616, 3165.645579482018, 5326.052717470656, 5386.870509812266, 6370.847852192989, 2468.8552826914693, 6986.483081125217, 4272.580543597193, 4423.342248477057, 8269.090215944527, 4841.403256178253, 6810.5133422665285, 3836.321327610136, 8364.776957723969, 1772.7776857027447, 2631.6620887864055, 2009.4427802868922, 570.8432107954673, 4201.755890434841, 5680.347660635469, 3507.3639344820913, 2811.8623844601075, 7183.054076596458, 6070.604835451716, 7217.4788916522175, 4261.458094988948, 6612.2460712512, 5503.905501582389, 2685.8600794077124, 3887.3652497819585, 2330.0444163286406, 4255.08405155876, 6018.555814405129, 7200.4423450027225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399506699866949, "mean_inference_ms": 0.9929468047603018, "mean_action_processing_ms": 0.16809095611758224, "mean_env_wait_ms": 0.05456218903429333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031147003173828125, "StateBufferConnector_ms": 0.002524733543395996, "ViewRequirementAgentConnector_ms": 0.06714522838592529}, "num_episodes": 21, "episode_return_max": 19967.57386032108, "episode_return_min": 320.2842196998547, "episode_return_mean": 16639.037836300264}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.5636621339664, "num_env_steps_trained_throughput_per_sec": 516.5636621339664, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 7625.298, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7625.263, "sample_time_ms": 758.034, "learn_time_ms": 6855.945, "learn_throughput": 583.435, "synch_weights_time_ms": 10.862}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 172, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-40", "timestamp": 1723236700, "time_this_iter_s": 7.748085975646973, "time_total_s": 1310.1618666648865, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bba3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1310.1618666648865, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 26.472727272727273, "ram_util_percent": 80.13636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5933309312.812698, "cur_kl_coeff": 459009949403.84564, "cur_lr": 5.0000000000000016e-05, "total_loss": 169120404.84656084, "policy_loss": 0.00048768402634080123, "vf_loss": 9.70783463785888, "vf_explained_var": 0.006846106052398682, "kl": 0.00036844601945535196, "entropy": 0.9569984020694854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.000895904749632, "cur_kl_coeff": 0.38486767709255226, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992725191513697, "policy_loss": -0.010674398370368484, "vf_loss": 9.994457960128784, "vf_explained_var": -3.894294301668803e-05, "kl": 0.02323304607028452, "entropy": 1.3944357606271902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "env_runners": {"episode_reward_max": 19871.16998309832, "episode_reward_min": 4518.612594263792, "episode_reward_mean": 16913.99035877054, "episode_len_mean": 198.45, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19845, "policy_reward_min": {"agent_policy": 919.3291457315291, "adversary_policy": 570.8432107954673}, "policy_reward_max": {"agent_policy": 13044.961284922894, "adversary_policy": 8364.776957723969}, "policy_reward_mean": {"agent_policy": 9762.737516825211, "adversary_policy": 3575.626420972672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15786.896476204076, 15865.634167363212, 16595.96523529374, 17164.97953890524, 15147.542441577998, 16334.74541837395, 17639.477479975998, 16518.651957923823, 16893.226615462372, 16947.310921694178, 17104.877461780117, 16409.054378665427, 15124.37573268843, 17099.560636425394, 17942.751686196363, 16637.72180745935, 16746.11954534038, 18051.48248438526, 15722.478103821759, 16010.529654617318, 15591.73542233862, 16902.283040711467, 15588.030104876543, 15728.040752326133, 18959.832608759538, 18623.8001662094, 18702.365299232242, 17766.40615119114, 15086.671547068388, 16446.988350248517, 15252.87874428726, 16702.898128946537, 16603.729410878706, 16321.028272387142, 17609.802341556715, 15501.919198097998, 15394.024995088585, 15181.974166139025, 15792.58838319259, 15146.986098274647, 19023.571713149668, 16983.007527522746, 15809.741022354445, 16140.332847009531, 17567.90513064127, 16172.8439175922, 15435.729772092014, 17172.460233168942, 17968.365439508503, 17788.738346785904, 16184.846758411673, 16361.77497706156, 15298.052699754802, 17559.95843885763, 17234.53511990526, 15508.589414551927, 17755.908351946746, 17515.092846392363, 15623.98485260105, 18213.14690985974, 18282.9844566181, 15305.453603247668, 14828.317610586673, 17142.01733434696, 19287.01316392602, 16610.99090642246, 18405.871928098382, 18565.47787220801, 18973.883515778525, 17978.456951341093, 15913.54226743448, 14706.80128017548, 18343.891514165738, 16578.28491825939, 19612.276216463073, 18403.593718719876, 19641.92706098014, 16824.969915901947, 16472.180040059553, 19638.499148930467, 16854.151486504135, 4518.612594263792, 17767.9010286902, 16442.48856847865, 19360.374843232024, 19557.062144478456, 18549.041989815603, 15747.386160343063, 18590.138383664093, 15656.735432307958, 16314.613079756524, 18955.606452227137, 15864.852188469858, 19871.16998309832, 19277.7827612284, 18067.396815481177, 16185.324221805075, 19598.273370817893, 17764.015122418095, 16973.72458117615], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [12273.129525980989, 12328.448228174924, 10764.63507373971, 8551.605555383332, 13044.961284922894, 11870.229392278587, 10229.099224318072, 8608.452386846599, 10768.097904201664, 10794.72804614603, 10637.371904726098, 10541.520673886263, 11665.999780592307, 11014.438718822494, 10315.725376944643, 10538.560706326994, 11359.660571503206, 9425.873737665746, 10310.724963095969, 10435.37275687279, 10480.936030154464, 9922.17790886339, 11806.861743854017, 12441.635335985382, 8541.964547605185, 8064.278394726541, 9266.605284054633, 9129.30972651225, 10949.535024795869, 9625.58974985166, 10782.550699820216, 10939.345388954342, 10266.602662151447, 9751.958862032287, 9177.601854952569, 9986.984517182382, 12270.519928613872, 12122.024242104957, 12145.468028275329, 11592.331468923694, 8543.328969962542, 9907.781088770573, 9945.741573656465, 10918.508880591358, 10599.884832629743, 11525.430255546933, 12465.800345357562, 9473.242345945077, 8838.03724862382, 6391.708613295393, 11622.66570410587, 11708.025872607577, 12581.891252318203, 9246.253292997124, 8208.287689160772, 11298.447317105249, 6936.847192713255, 10216.65269709957, 11096.131935664293, 8576.663031619511, 8387.030336640935, 11738.171403670625, 12496.046267113457, 10719.313962998323, 8574.089936643179, 7771.287771537965, 7146.808303375915, 5873.045407786426, 7321.966917333738, 5777.35866600699, 11509.102492945349, 12126.515289093153, 8461.787963095469, 10259.058599317257, 6358.617304414908, 6924.6567320787335, 7525.775488146601, 10251.744586712308, 9887.051572172168, 6419.500989522572, 10578.502029793197, 919.3291457315291, 8915.900278512836, 10030.72196462277, 6643.315408810758, 8270.80996728121, 7852.368112664268, 10143.730563836081, 9290.642466683266, 10411.994644127913, 11462.062134518234, 7899.185785523815, 11605.858442407316, 7016.658266805731, 8778.020498473568, 7449.3858716787, 11720.94442286096, 8508.416800509249, 8299.781414169242, 10102.94612128974], "policy_adversary_policy_reward": [1650.4542303222945, 1863.312719900865, 1724.6052465654707, 1812.5806926228802, 3367.195754397007, 2464.1344071570584, 3064.1133127426606, 5549.260670779274, 1089.8212210718082, 1012.7599355833289, 2222.103044729508, 2242.412981365848, 3572.6951179546722, 3837.683137703217, 5533.6832368843525, 2376.516334192886, 3234.132469714467, 2890.996241546263, 3037.2461664975194, 3115.3367090506217, 3274.2965664960625, 3193.2089905579555, 3054.545381904686, 2812.9883228745402, 983.3044629036698, 2475.0714891924863, 3125.4250341887932, 2959.6968834141335, 3821.28104085299, 3805.7452683987062, 3602.8904329528505, 2496.2706681795366, 2636.2716761268607, 2750.1872977102676, 4185.285987969621, 4440.322758749877, 1580.342480090891, 3831.4106606349624, 1977.4808715270863, 3597.6760262174425, 1453.0808202454114, 3657.7185719388053, 2762.5690723461084, 4217.536059501992, 2083.615949949818, 1697.552411072692, 1689.6083498147311, 1596.7970665260714, 5299.358618681743, 5118.509442472577, 5706.574349805554, 4852.94742167725, 4691.33350197993, 4744.426513197663, 5009.7399672365755, 3627.3564574423053, 3192.600598935059, 944.5359233375123, 4512.354029677911, 2309.044570718967, 3359.5849239107247, 1110.743120556339, 2606.5080870368333, 3157.0446529553788, 3875.5329615794885, 2461.5937871477736, 2219.5414228542454, 4349.527987500641, 3467.6667178257685, 4964.533768778377, 1359.783574367038, 4155.151106548562, 1258.5625006077225, 1864.9425658670302, 1142.7643175880876, 1917.1856064460112, 1995.8318633145109, 1651.2884916027729, 1004.8504745437648, 2549.804154807229, 4932.517365349788, 5547.725377837418, 3367.172002742797, 3708.05443600941, 4196.394050074486, 1667.6053986235117, 3023.282054653548, 2198.5419117646697, 3531.865758130918, 3436.1545398806006, 2602.163416484976, 2045.2502455602935, 1580.9661616178787, 1388.9632651166144, 3206.42998984615, 4492.787897377745, 3826.2298157775112, 5304.09837510713, 3646.6027230549516, 7750.427010435555, 2291.8263378692004, 2270.354716436646, 2416.438565065864, 2237.310539388157, 1560.244371412707, 1155.917076023934, 4723.8444479235195, 3589.8606979370006, 3682.200804797474, 5344.046625947049, 1780.6309377915695, 2429.5111596551433, 7205.288431017688, 3613.772728215802, 3528.2876024153848, 3770.152546877413, 1481.8492288701568, 3046.003688066625, 5561.8904949693915, 4074.5933832708924, 5755.105287089986, 4140.8488328871845, 1806.6249416862747, 1760.6572578907308, 1645.3858209915502, 686.8855224817065, 3257.057791866616, 3165.645579482018, 5326.052717470656, 5386.870509812266, 6370.847852192989, 2468.8552826914693, 6986.483081125217, 4272.580543597193, 4423.342248477057, 8269.090215944527, 4841.403256178253, 6810.5133422665285, 3836.321327610136, 8364.776957723969, 1772.7776857027447, 2631.6620887864055, 2009.4427802868922, 570.8432107954673, 4201.755890434841, 5680.347660635469, 3507.3639344820913, 2811.8623844601075, 7183.054076596458, 6070.604835451716, 7217.4788916522175, 4261.458094988948, 6612.2460712512, 5503.905501582389, 2685.8600794077124, 3887.3652497819585, 2330.0444163286406, 4255.08405155876, 6018.555814405129, 7200.4423450027225, 3559.3784388914887, 2716.2710178194716, 2262.6513696079346, 1336.6320789243275, 3959.746164646395, 4892.2545855309645, 2300.3529447477313, 4111.41365910817, 5532.491582058808, 7184.5678523624665, 5861.61667561578, 5424.635501581494, 6289.568542634571, 4407.105334516729, 1605.250536612191, 3998.4050598948506, 4618.683431702381, 4680.812485278403, 1514.5998085770286, 3730.1409796030084, 2172.477456025628, 2680.073489212717, 5225.959240459251, 5830.46142624402, 1722.7165647389975, 2536.277181323597, 6999.282049818651, 5855.229666473927, 5352.206791991372, 5147.555470763453, 6692.749752052254, 3925.2611917501886, 2297.692993531565, 2166.6868054125225, 5589.691250779064, 5500.165319529545, 5138.7284096103895, 4325.505298638433, 3596.06723745008, 3274.711222436325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3994685669922653, "mean_inference_ms": 0.9928035777815805, "mean_action_processing_ms": 0.16808405538591323, "mean_env_wait_ms": 0.05456794186379024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032188892364501953, "StateBufferConnector_ms": 0.0024619102478027344, "ViewRequirementAgentConnector_ms": 0.06796741485595703}, "num_episodes": 20, "episode_return_max": 19871.16998309832, "episode_return_min": 4518.612594263792, "episode_return_mean": 16913.99035877054}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 515.305674579795, "num_env_steps_trained_throughput_per_sec": 515.305674579795, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2076000, "timers": {"training_iteration_time_ms": 7600.606, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7600.57, "sample_time_ms": 761.749, "learn_time_ms": 6827.619, "learn_throughput": 585.856, "synch_weights_time_ms": 10.785}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "done": false, "training_iteration": 173, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-48", "timestamp": 1723236708, "time_this_iter_s": 7.76711893081665, "time_total_s": 1317.9289855957031, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bba430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1317.9289855957031, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 26.50833333333333, "ram_util_percent": 79.99166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2874284211.3862433, "cur_kl_coeff": 229504974701.92282, "cur_lr": 5.0000000000000016e-05, "total_loss": 51975216.99047619, "policy_loss": -1.5714771986480742e-05, "vf_loss": 9.732890516614157, "vf_explained_var": 0.0028440246821711305, "kl": 0.00022646658917582253, "entropy": 0.9560557270806933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0005770841923853, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.003341889381408, "policy_loss": -0.005435817517718533, "vf_loss": 10.0, "vf_explained_var": 3.6902849872907e-05, "kl": 0.015204763567696015, "entropy": 1.4129876896739006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": 20565.718008199987, "episode_reward_min": 4518.612594263792, "episode_reward_mean": 17162.334016177625, "episode_len_mean": 198.45, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19845, "policy_reward_min": {"agent_policy": 919.3291457315291, "adversary_policy": 355.96337912279375}, "policy_reward_max": {"agent_policy": 13006.094586633577, "adversary_policy": 8377.320402759855}, "policy_reward_mean": {"agent_policy": 9427.708123546587, "adversary_policy": 3867.312946315527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16902.283040711467, 15588.030104876543, 15728.040752326133, 18959.832608759538, 18623.8001662094, 18702.365299232242, 17766.40615119114, 15086.671547068388, 16446.988350248517, 15252.87874428726, 16702.898128946537, 16603.729410878706, 16321.028272387142, 17609.802341556715, 15501.919198097998, 15394.024995088585, 15181.974166139025, 15792.58838319259, 15146.986098274647, 19023.571713149668, 16983.007527522746, 15809.741022354445, 16140.332847009531, 17567.90513064127, 16172.8439175922, 15435.729772092014, 17172.460233168942, 17968.365439508503, 17788.738346785904, 16184.846758411673, 16361.77497706156, 15298.052699754802, 17559.95843885763, 17234.53511990526, 15508.589414551927, 17755.908351946746, 17515.092846392363, 15623.98485260105, 18213.14690985974, 18282.9844566181, 15305.453603247668, 14828.317610586673, 17142.01733434696, 19287.01316392602, 16610.99090642246, 18405.871928098382, 18565.47787220801, 18973.883515778525, 17978.456951341093, 15913.54226743448, 14706.80128017548, 18343.891514165738, 16578.28491825939, 19612.276216463073, 18403.593718719876, 19641.92706098014, 16824.969915901947, 16472.180040059553, 19638.499148930467, 16854.151486504135, 4518.612594263792, 17767.9010286902, 16442.48856847865, 19360.374843232024, 19557.062144478456, 18549.041989815603, 15747.386160343063, 18590.138383664093, 15656.735432307958, 16314.613079756524, 18955.606452227137, 15864.852188469858, 19871.16998309832, 19277.7827612284, 18067.396815481177, 16185.324221805075, 19598.273370817893, 17764.015122418095, 16973.72458117615, 17108.51048993648, 19291.761953653935, 19147.684658585924, 20565.718008199987, 18866.90335082813, 15370.553305695203, 18339.986143740873, 18925.420234858004, 19582.81813640243, 16059.097766494162, 15899.39161769408, 14498.099002853669, 15245.840950704991, 15385.623644456351, 19021.41835047997, 19888.226336154163, 16157.756037248364, 19955.630332453627, 16257.29376350535, 17345.636537943843, 19256.112285312138], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9922.17790886339, 11806.861743854017, 12441.635335985382, 8541.964547605185, 8064.278394726541, 9266.605284054633, 9129.30972651225, 10949.535024795869, 9625.58974985166, 10782.550699820216, 10939.345388954342, 10266.602662151447, 9751.958862032287, 9177.601854952569, 9986.984517182382, 12270.519928613872, 12122.024242104957, 12145.468028275329, 11592.331468923694, 8543.328969962542, 9907.781088770573, 9945.741573656465, 10918.508880591358, 10599.884832629743, 11525.430255546933, 12465.800345357562, 9473.242345945077, 8838.03724862382, 6391.708613295393, 11622.66570410587, 11708.025872607577, 12581.891252318203, 9246.253292997124, 8208.287689160772, 11298.447317105249, 6936.847192713255, 10216.65269709957, 11096.131935664293, 8576.663031619511, 8387.030336640935, 11738.171403670625, 12496.046267113457, 10719.313962998323, 8574.089936643179, 7771.287771537965, 7146.808303375915, 5873.045407786426, 7321.966917333738, 5777.35866600699, 11509.102492945349, 12126.515289093153, 8461.787963095469, 10259.058599317257, 6358.617304414908, 6924.6567320787335, 7525.775488146601, 10251.744586712308, 9887.051572172168, 6419.500989522572, 10578.502029793197, 919.3291457315291, 8915.900278512836, 10030.72196462277, 6643.315408810758, 8270.80996728121, 7852.368112664268, 10143.730563836081, 9290.642466683266, 10411.994644127913, 11462.062134518234, 7899.185785523815, 11605.858442407316, 7016.658266805731, 8778.020498473568, 7449.3858716787, 11720.94442286096, 8508.416800509249, 8299.781414169242, 10102.94612128974, 7991.562194749379, 5764.815220971103, 8170.596153283749, 6252.283978004459, 9087.067795839124, 11612.232242489068, 8801.592057206917, 9000.66002152942, 7459.934322456812, 12198.177110807568, 11593.360404435718, 13006.094586633577, 11719.14264228179, 11099.994734513852, 7834.424233863103, 7844.723079998697, 8644.32719014179, 6788.633346849344, 11010.794527119577, 10166.031367645897, 6410.18530390019], "policy_adversary_policy_reward": [2762.5690723461084, 4217.536059501992, 2083.615949949818, 1697.552411072692, 1689.6083498147311, 1596.7970665260714, 5299.358618681743, 5118.509442472577, 5706.574349805554, 4852.94742167725, 4691.33350197993, 4744.426513197663, 5009.7399672365755, 3627.3564574423053, 3192.600598935059, 944.5359233375123, 4512.354029677911, 2309.044570718967, 3359.5849239107247, 1110.743120556339, 2606.5080870368333, 3157.0446529553788, 3875.5329615794885, 2461.5937871477736, 2219.5414228542454, 4349.527987500641, 3467.6667178257685, 4964.533768778377, 1359.783574367038, 4155.151106548562, 1258.5625006077225, 1864.9425658670302, 1142.7643175880876, 1917.1856064460112, 1995.8318633145109, 1651.2884916027729, 1004.8504745437648, 2549.804154807229, 4932.517365349788, 5547.725377837418, 3367.172002742797, 3708.05443600941, 4196.394050074486, 1667.6053986235117, 3023.282054653548, 2198.5419117646697, 3531.865758130918, 3436.1545398806006, 2602.163416484976, 2045.2502455602935, 1580.9661616178787, 1388.9632651166144, 3206.42998984615, 4492.787897377745, 3826.2298157775112, 5304.09837510713, 3646.6027230549516, 7750.427010435555, 2291.8263378692004, 2270.354716436646, 2416.438565065864, 2237.310539388157, 1560.244371412707, 1155.917076023934, 4723.8444479235195, 3589.8606979370006, 3682.200804797474, 5344.046625947049, 1780.6309377915695, 2429.5111596551433, 7205.288431017688, 3613.772728215802, 3528.2876024153848, 3770.152546877413, 1481.8492288701568, 3046.003688066625, 5561.8904949693915, 4074.5933832708924, 5755.105287089986, 4140.8488328871845, 1806.6249416862747, 1760.6572578907308, 1645.3858209915502, 686.8855224817065, 3257.057791866616, 3165.645579482018, 5326.052717470656, 5386.870509812266, 6370.847852192989, 2468.8552826914693, 6986.483081125217, 4272.580543597193, 4423.342248477057, 8269.090215944527, 4841.403256178253, 6810.5133422665285, 3836.321327610136, 8364.776957723969, 1772.7776857027447, 2631.6620887864055, 2009.4427802868922, 570.8432107954673, 4201.755890434841, 5680.347660635469, 3507.3639344820913, 2811.8623844601075, 7183.054076596458, 6070.604835451716, 7217.4788916522175, 4261.458094988948, 6612.2460712512, 5503.905501582389, 2685.8600794077124, 3887.3652497819585, 2330.0444163286406, 4255.08405155876, 6018.555814405129, 7200.4423450027225, 3559.3784388914887, 2716.2710178194716, 2262.6513696079346, 1336.6320789243275, 3959.746164646395, 4892.2545855309645, 2300.3529447477313, 4111.41365910817, 5532.491582058808, 7184.5678523624665, 5861.61667561578, 5424.635501581494, 6289.568542634571, 4407.105334516729, 1605.250536612191, 3998.4050598948506, 4618.683431702381, 4680.812485278403, 1514.5998085770286, 3730.1409796030084, 2172.477456025628, 2680.073489212717, 5225.959240459251, 5830.46142624402, 1722.7165647389975, 2536.277181323597, 6999.282049818651, 5855.229666473927, 5352.206791991372, 5147.555470763453, 6692.749752052254, 3925.2611917501886, 2297.692993531565, 2166.6868054125225, 5589.691250779064, 5500.165319529545, 5138.7284096103895, 4325.505298638433, 3596.06723745008, 3274.711222436325, 6150.573428981572, 2966.374866205531, 5149.6263299229995, 8377.320402759855, 5095.628784667547, 5881.459720634586, 6740.709698278818, 7572.7243319166855, 4724.767727097136, 5055.06782789183, 1228.4176819643035, 2529.9033812418393, 5186.8142878866665, 4351.579798647216, 4936.329509516544, 4988.430703812111, 6682.20130127414, 5440.682512671489, 1920.1541443845415, 1940.7665113020475, 2436.2780815725428, 1869.7531316858397, 355.96337912279375, 1136.041037097326, 2422.992981449122, 1103.7053269741132, 3042.140889217087, 1243.488020725387, 6307.71138986785, 4879.282726748996, 5755.6165688448755, 6287.886687310665, 2015.620413517431, 5497.808433589156, 6945.107773679412, 6221.889211924978, 2130.9724537719417, 3115.5267826138665, 3222.3310408545162, 3957.274129443423, 7310.364322393888, 5535.56265901802]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39944504693516303, "mean_inference_ms": 0.9928333513127618, "mean_action_processing_ms": 0.16807192749254743, "mean_env_wait_ms": 0.054557154052198326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033402442932128906, "StateBufferConnector_ms": 0.002521038055419922, "ViewRequirementAgentConnector_ms": 0.06890153884887695}, "num_episodes": 21, "episode_return_max": 20565.718008199987, "episode_return_min": 4518.612594263792, "episode_return_mean": 17162.334016177625}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.746371721845, "num_env_steps_trained_throughput_per_sec": 543.746371721845, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 7515.594, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7515.56, "sample_time_ms": 754.683, "learn_time_ms": 6749.84, "learn_throughput": 592.607, "synch_weights_time_ms": 10.632}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 174, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-51-56", "timestamp": 1723236716, "time_this_iter_s": 7.362130880355835, "time_total_s": 1325.291116476059, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bba790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1325.291116476059, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 25.35, "ram_util_percent": 79.91}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1855720674.4592593, "cur_kl_coeff": 114752487350.96141, "cur_lr": 5.0000000000000016e-05, "total_loss": 24255904.56084656, "policy_loss": 0.00014066982942894496, "vf_loss": 9.885754768936723, "vf_explained_var": 0.0046652529290113496, "kl": 0.00021137576469786284, "entropy": 0.9544839715516126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0102598175096016, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.995103997985522, "policy_loss": -0.007036467813547157, "vf_loss": 9.994983630379041, "vf_explained_var": 2.3575499653816223e-05, "kl": 0.012397015914029908, "entropy": 1.397464245557785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "env_runners": {"episode_reward_max": 21381.139218811655, "episode_reward_min": 1563.013086060436, "episode_reward_mean": 17315.688590129717, "episode_len_mean": 196.61, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19661, "policy_reward_min": {"agent_policy": 111.5308490205481, "adversary_policy": 355.96337912279375}, "policy_reward_max": {"agent_policy": 13006.094586633577, "adversary_policy": 9275.694679374414}, "policy_reward_mean": {"agent_policy": 9017.398104614142, "adversary_policy": 4149.1452427577915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16983.007527522746, 15809.741022354445, 16140.332847009531, 17567.90513064127, 16172.8439175922, 15435.729772092014, 17172.460233168942, 17968.365439508503, 17788.738346785904, 16184.846758411673, 16361.77497706156, 15298.052699754802, 17559.95843885763, 17234.53511990526, 15508.589414551927, 17755.908351946746, 17515.092846392363, 15623.98485260105, 18213.14690985974, 18282.9844566181, 15305.453603247668, 14828.317610586673, 17142.01733434696, 19287.01316392602, 16610.99090642246, 18405.871928098382, 18565.47787220801, 18973.883515778525, 17978.456951341093, 15913.54226743448, 14706.80128017548, 18343.891514165738, 16578.28491825939, 19612.276216463073, 18403.593718719876, 19641.92706098014, 16824.969915901947, 16472.180040059553, 19638.499148930467, 16854.151486504135, 4518.612594263792, 17767.9010286902, 16442.48856847865, 19360.374843232024, 19557.062144478456, 18549.041989815603, 15747.386160343063, 18590.138383664093, 15656.735432307958, 16314.613079756524, 18955.606452227137, 15864.852188469858, 19871.16998309832, 19277.7827612284, 18067.396815481177, 16185.324221805075, 19598.273370817893, 17764.015122418095, 16973.72458117615, 17108.51048993648, 19291.761953653935, 19147.684658585924, 20565.718008199987, 18866.90335082813, 15370.553305695203, 18339.986143740873, 18925.420234858004, 19582.81813640243, 16059.097766494162, 15899.39161769408, 14498.099002853669, 15245.840950704991, 15385.623644456351, 19021.41835047997, 19888.226336154163, 16157.756037248364, 19955.630332453627, 16257.29376350535, 17345.636537943843, 19256.112285312138, 19360.61725026711, 16144.068588148688, 19940.795725058888, 21381.139218811655, 18790.44275512122, 19541.463844829068, 19921.81940286128, 1563.013086060436, 19744.11034588041, 19597.589645451513, 17827.777830645413, 14934.1417443106, 18700.357702045563, 16076.84124949323, 18506.22380774585, 15665.38481986352, 14728.949583704967, 19399.919729261925, 18915.03174198186, 16931.58879628781], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9907.781088770573, 9945.741573656465, 10918.508880591358, 10599.884832629743, 11525.430255546933, 12465.800345357562, 9473.242345945077, 8838.03724862382, 6391.708613295393, 11622.66570410587, 11708.025872607577, 12581.891252318203, 9246.253292997124, 8208.287689160772, 11298.447317105249, 6936.847192713255, 10216.65269709957, 11096.131935664293, 8576.663031619511, 8387.030336640935, 11738.171403670625, 12496.046267113457, 10719.313962998323, 8574.089936643179, 7771.287771537965, 7146.808303375915, 5873.045407786426, 7321.966917333738, 5777.35866600699, 11509.102492945349, 12126.515289093153, 8461.787963095469, 10259.058599317257, 6358.617304414908, 6924.6567320787335, 7525.775488146601, 10251.744586712308, 9887.051572172168, 6419.500989522572, 10578.502029793197, 919.3291457315291, 8915.900278512836, 10030.72196462277, 6643.315408810758, 8270.80996728121, 7852.368112664268, 10143.730563836081, 9290.642466683266, 10411.994644127913, 11462.062134518234, 7899.185785523815, 11605.858442407316, 7016.658266805731, 8778.020498473568, 7449.3858716787, 11720.94442286096, 8508.416800509249, 8299.781414169242, 10102.94612128974, 7991.562194749379, 5764.815220971103, 8170.596153283749, 6252.283978004459, 9087.067795839124, 11612.232242489068, 8801.592057206917, 9000.66002152942, 7459.934322456812, 12198.177110807568, 11593.360404435718, 13006.094586633577, 11719.14264228179, 11099.994734513852, 7834.424233863103, 7844.723079998697, 8644.32719014179, 6788.633346849344, 11010.794527119577, 10166.031367645897, 6410.18530390019, 8088.809816858759, 11427.093604347016, 4475.151667234898, 6422.48802000094, 8517.597870517608, 8507.078562070124, 6949.928939565046, 111.5308490205481, 8144.397998726158, 7863.482227228023, 9174.173024044392, 12380.033818885357, 7486.962041351249, 10749.082114232773, 7195.199608512004, 12072.916143849505, 11540.766785996544, 8379.3740658209, 8401.94278468704, 8407.662503029364], "policy_adversary_policy_reward": [3367.172002742797, 3708.05443600941, 4196.394050074486, 1667.6053986235117, 3023.282054653548, 2198.5419117646697, 3531.865758130918, 3436.1545398806006, 2602.163416484976, 2045.2502455602935, 1580.9661616178787, 1388.9632651166144, 3206.42998984615, 4492.787897377745, 3826.2298157775112, 5304.09837510713, 3646.6027230549516, 7750.427010435555, 2291.8263378692004, 2270.354716436646, 2416.438565065864, 2237.310539388157, 1560.244371412707, 1155.917076023934, 4723.8444479235195, 3589.8606979370006, 3682.200804797474, 5344.046625947049, 1780.6309377915695, 2429.5111596551433, 7205.288431017688, 3613.772728215802, 3528.2876024153848, 3770.152546877413, 1481.8492288701568, 3046.003688066625, 5561.8904949693915, 4074.5933832708924, 5755.105287089986, 4140.8488328871845, 1806.6249416862747, 1760.6572578907308, 1645.3858209915502, 686.8855224817065, 3257.057791866616, 3165.645579482018, 5326.052717470656, 5386.870509812266, 6370.847852192989, 2468.8552826914693, 6986.483081125217, 4272.580543597193, 4423.342248477057, 8269.090215944527, 4841.403256178253, 6810.5133422665285, 3836.321327610136, 8364.776957723969, 1772.7776857027447, 2631.6620887864055, 2009.4427802868922, 570.8432107954673, 4201.755890434841, 5680.347660635469, 3507.3639344820913, 2811.8623844601075, 7183.054076596458, 6070.604835451716, 7217.4788916522175, 4261.458094988948, 6612.2460712512, 5503.905501582389, 2685.8600794077124, 3887.3652497819585, 2330.0444163286406, 4255.08405155876, 6018.555814405129, 7200.4423450027225, 3559.3784388914887, 2716.2710178194716, 2262.6513696079346, 1336.6320789243275, 3959.746164646395, 4892.2545855309645, 2300.3529447477313, 4111.41365910817, 5532.491582058808, 7184.5678523624665, 5861.61667561578, 5424.635501581494, 6289.568542634571, 4407.105334516729, 1605.250536612191, 3998.4050598948506, 4618.683431702381, 4680.812485278403, 1514.5998085770286, 3730.1409796030084, 2172.477456025628, 2680.073489212717, 5225.959240459251, 5830.46142624402, 1722.7165647389975, 2536.277181323597, 6999.282049818651, 5855.229666473927, 5352.206791991372, 5147.555470763453, 6692.749752052254, 3925.2611917501886, 2297.692993531565, 2166.6868054125225, 5589.691250779064, 5500.165319529545, 5138.7284096103895, 4325.505298638433, 3596.06723745008, 3274.711222436325, 6150.573428981572, 2966.374866205531, 5149.6263299229995, 8377.320402759855, 5095.628784667547, 5881.459720634586, 6740.709698278818, 7572.7243319166855, 4724.767727097136, 5055.06782789183, 1228.4176819643035, 2529.9033812418393, 5186.8142878866665, 4351.579798647216, 4936.329509516544, 4988.430703812111, 6682.20130127414, 5440.682512671489, 1920.1541443845415, 1940.7665113020475, 2436.2780815725428, 1869.7531316858397, 355.96337912279375, 1136.041037097326, 2422.992981449122, 1103.7053269741132, 3042.140889217087, 1243.488020725387, 6307.71138986785, 4879.282726748996, 5755.6165688448755, 6287.886687310665, 2015.620413517431, 5497.808433589156, 6945.107773679412, 6221.889211924978, 2130.9724537719417, 3115.5267826138665, 3222.3310408545162, 3957.274129443423, 7310.364322393888, 5535.56265901802, 6047.558838380293, 5224.248595028071, 2547.5184778835746, 2169.4565059180954, 9275.694679374414, 6189.949378449601, 7613.098174576916, 7345.553024233826, 5624.537753213346, 4648.307131390274, 5473.97942949792, 5560.405853261012, 6074.498587460819, 6897.39187583537, 1019.840000877928, 431.64223616196034, 5997.5770715832405, 5602.135275570974, 6278.653396502937, 5455.454021720626, 4967.962599686553, 3685.6422069145274, 1762.1018048455537, 792.0061205797278, 6655.113612354532, 4558.2820483397745, 3379.6349056342506, 1948.1242296261926, 4364.0881840149295, 6946.936015218952, 1993.0523479075591, 1599.4163281064737, 2601.3688377344115, 586.8139599739733, 5736.193472293686, 5284.352191147383, 5104.021485600008, 5409.067471694761, 2789.4531725569095, 5734.473120701587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993962780444278, "mean_inference_ms": 0.9926860804291263, "mean_action_processing_ms": 0.16805955594244756, "mean_env_wait_ms": 0.054557087043776605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522515296936035, "StateBufferConnector_ms": 0.0025396347045898438, "ViewRequirementAgentConnector_ms": 0.06937694549560547}, "num_episodes": 20, "episode_return_max": 21381.139218811655, "episode_return_min": 1563.013086060436, "episode_return_mean": 17315.688590129717}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.8615603192264, "num_env_steps_trained_throughput_per_sec": 523.8615603192264, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 7510.372, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7510.339, "sample_time_ms": 751.839, "learn_time_ms": 6747.339, "learn_throughput": 592.826, "synch_weights_time_ms": 10.758}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "training_iteration": 175, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-52-04", "timestamp": 1723236724, "time_this_iter_s": 7.639894008636475, "time_total_s": 1332.9310104846954, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3b9eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1332.9310104846954, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 26.072727272727274, "ram_util_percent": 79.85454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1117807794.5269842, "cur_kl_coeff": 57376243675.480705, "cur_lr": 5.0000000000000016e-05, "total_loss": 13602517.411640212, "policy_loss": 0.00037737351142500756, "vf_loss": 9.630368579884685, "vf_explained_var": 0.01111083535290269, "kl": 0.0002370756030330316, "entropy": 0.95107732598113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9897847912274301, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99037747780482, "policy_loss": -0.002213775288449445, "vf_loss": 9.987154398361842, "vf_explained_var": -2.515514691670736e-05, "kl": 0.009417659036504726, "entropy": 1.3889521868278583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 21654.755322874636, "episode_reward_min": 1563.013086060436, "episode_reward_mean": 17364.187931234817, "episode_len_mean": 193.3, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19330, "policy_reward_min": {"agent_policy": 111.5308490205481, "adversary_policy": 355.96337912279375}, "policy_reward_max": {"agent_policy": 13006.094586633577, "adversary_policy": 9275.694679374414}, "policy_reward_mean": {"agent_policy": 8563.056853865472, "adversary_policy": 4400.565538684676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19287.01316392602, 16610.99090642246, 18405.871928098382, 18565.47787220801, 18973.883515778525, 17978.456951341093, 15913.54226743448, 14706.80128017548, 18343.891514165738, 16578.28491825939, 19612.276216463073, 18403.593718719876, 19641.92706098014, 16824.969915901947, 16472.180040059553, 19638.499148930467, 16854.151486504135, 4518.612594263792, 17767.9010286902, 16442.48856847865, 19360.374843232024, 19557.062144478456, 18549.041989815603, 15747.386160343063, 18590.138383664093, 15656.735432307958, 16314.613079756524, 18955.606452227137, 15864.852188469858, 19871.16998309832, 19277.7827612284, 18067.396815481177, 16185.324221805075, 19598.273370817893, 17764.015122418095, 16973.72458117615, 17108.51048993648, 19291.761953653935, 19147.684658585924, 20565.718008199987, 18866.90335082813, 15370.553305695203, 18339.986143740873, 18925.420234858004, 19582.81813640243, 16059.097766494162, 15899.39161769408, 14498.099002853669, 15245.840950704991, 15385.623644456351, 19021.41835047997, 19888.226336154163, 16157.756037248364, 19955.630332453627, 16257.29376350535, 17345.636537943843, 19256.112285312138, 19360.61725026711, 16144.068588148688, 19940.795725058888, 21381.139218811655, 18790.44275512122, 19541.463844829068, 19921.81940286128, 1563.013086060436, 19744.11034588041, 19597.589645451513, 17827.777830645413, 14934.1417443106, 18700.357702045563, 16076.84124949323, 18506.22380774585, 15665.38481986352, 14728.949583704967, 19399.919729261925, 18915.03174198186, 16931.58879628781, 18944.881477236333, 17462.388819489286, 18935.498904960743, 16531.158324014268, 16155.582065912136, 15336.418070115658, 21639.749804503634, 21654.755322874636, 3969.2159727989692, 17099.511598704106, 4500.995647241428, 20075.353056997996, 19152.956206958836, 16877.62108816657, 17555.662196945344, 19435.73693952859, 15791.588213452089, 18656.30844450664, 19820.0230481876, 16000.939060783385, 20089.972675939513, 16660.348709910148, 16357.0560721], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 45, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8574.089936643179, 7771.287771537965, 7146.808303375915, 5873.045407786426, 7321.966917333738, 5777.35866600699, 11509.102492945349, 12126.515289093153, 8461.787963095469, 10259.058599317257, 6358.617304414908, 6924.6567320787335, 7525.775488146601, 10251.744586712308, 9887.051572172168, 6419.500989522572, 10578.502029793197, 919.3291457315291, 8915.900278512836, 10030.72196462277, 6643.315408810758, 8270.80996728121, 7852.368112664268, 10143.730563836081, 9290.642466683266, 10411.994644127913, 11462.062134518234, 7899.185785523815, 11605.858442407316, 7016.658266805731, 8778.020498473568, 7449.3858716787, 11720.94442286096, 8508.416800509249, 8299.781414169242, 10102.94612128974, 7991.562194749379, 5764.815220971103, 8170.596153283749, 6252.283978004459, 9087.067795839124, 11612.232242489068, 8801.592057206917, 9000.66002152942, 7459.934322456812, 12198.177110807568, 11593.360404435718, 13006.094586633577, 11719.14264228179, 11099.994734513852, 7834.424233863103, 7844.723079998697, 8644.32719014179, 6788.633346849344, 11010.794527119577, 10166.031367645897, 6410.18530390019, 8088.809816858759, 11427.093604347016, 4475.151667234898, 6422.48802000094, 8517.597870517608, 8507.078562070124, 6949.928939565046, 111.5308490205481, 8144.397998726158, 7863.482227228023, 9174.173024044392, 12380.033818885357, 7486.962041351249, 10749.082114232773, 7195.199608512004, 12072.916143849505, 11540.766785996544, 8379.3740658209, 8401.94278468704, 8407.662503029364, 9073.744174102327, 10369.225134352928, 9292.933296740921, 9482.429653228195, 10490.577238938802, 11820.381411549304, 4953.134006676084, 5362.166230044474, 230.50240478263282, 10007.010391205968, 655.1010916853883, 7863.454935423531, 8890.32327971705, 10693.032029702601, 8522.171670668757, 8350.323490656569, 11333.877075357948, 6372.270119838674, 6528.932852618265, 10489.227661963727, 7167.967956376756, 10789.367428833644, 10726.284530900144], "policy_adversary_policy_reward": [5326.052717470656, 5386.870509812266, 6370.847852192989, 2468.8552826914693, 6986.483081125217, 4272.580543597193, 4423.342248477057, 8269.090215944527, 4841.403256178253, 6810.5133422665285, 3836.321327610136, 8364.776957723969, 1772.7776857027447, 2631.6620887864055, 2009.4427802868922, 570.8432107954673, 4201.755890434841, 5680.347660635469, 3507.3639344820913, 2811.8623844601075, 7183.054076596458, 6070.604835451716, 7217.4788916522175, 4261.458094988948, 6612.2460712512, 5503.905501582389, 2685.8600794077124, 3887.3652497819585, 2330.0444163286406, 4255.08405155876, 6018.555814405129, 7200.4423450027225, 3559.3784388914887, 2716.2710178194716, 2262.6513696079346, 1336.6320789243275, 3959.746164646395, 4892.2545855309645, 2300.3529447477313, 4111.41365910817, 5532.491582058808, 7184.5678523624665, 5861.61667561578, 5424.635501581494, 6289.568542634571, 4407.105334516729, 1605.250536612191, 3998.4050598948506, 4618.683431702381, 4680.812485278403, 1514.5998085770286, 3730.1409796030084, 2172.477456025628, 2680.073489212717, 5225.959240459251, 5830.46142624402, 1722.7165647389975, 2536.277181323597, 6999.282049818651, 5855.229666473927, 5352.206791991372, 5147.555470763453, 6692.749752052254, 3925.2611917501886, 2297.692993531565, 2166.6868054125225, 5589.691250779064, 5500.165319529545, 5138.7284096103895, 4325.505298638433, 3596.06723745008, 3274.711222436325, 6150.573428981572, 2966.374866205531, 5149.6263299229995, 8377.320402759855, 5095.628784667547, 5881.459720634586, 6740.709698278818, 7572.7243319166855, 4724.767727097136, 5055.06782789183, 1228.4176819643035, 2529.9033812418393, 5186.8142878866665, 4351.579798647216, 4936.329509516544, 4988.430703812111, 6682.20130127414, 5440.682512671489, 1920.1541443845415, 1940.7665113020475, 2436.2780815725428, 1869.7531316858397, 355.96337912279375, 1136.041037097326, 2422.992981449122, 1103.7053269741132, 3042.140889217087, 1243.488020725387, 6307.71138986785, 4879.282726748996, 5755.6165688448755, 6287.886687310665, 2015.620413517431, 5497.808433589156, 6945.107773679412, 6221.889211924978, 2130.9724537719417, 3115.5267826138665, 3222.3310408545162, 3957.274129443423, 7310.364322393888, 5535.56265901802, 6047.558838380293, 5224.248595028071, 2547.5184778835746, 2169.4565059180954, 9275.694679374414, 6189.949378449601, 7613.098174576916, 7345.553024233826, 5624.537753213346, 4648.307131390274, 5473.97942949792, 5560.405853261012, 6074.498587460819, 6897.39187583537, 1019.840000877928, 431.64223616196034, 5997.5770715832405, 5602.135275570974, 6278.653396502937, 5455.454021720626, 4967.962599686553, 3685.6422069145274, 1762.1018048455537, 792.0061205797278, 6655.113612354532, 4558.2820483397745, 3379.6349056342506, 1948.1242296261926, 4364.0881840149295, 6946.936015218952, 1993.0523479075591, 1599.4163281064737, 2601.3688377344115, 586.8139599739733, 5736.193472293686, 5284.352191147383, 5104.021485600008, 5409.067471694761, 2789.4531725569095, 5734.473120701587, 4802.745853505451, 5068.39144962862, 3329.7423162349355, 3763.4213689013545, 4849.202326990024, 4793.363281229717, 2728.6194099354866, 4320.109260850565, 2571.7046757287694, 3093.3001512446112, 2321.7542121816236, 1194.282446384788, 7602.746453801759, 9083.869344025741, 8779.969393686486, 7512.619699143609, 1840.62364565019, 1898.089922366148, 2957.8307532587683, 4134.670454239415, 1813.9898787325483, 2031.9046768234928, 6254.806949634807, 5957.091171939591, 5117.93964776431, 5144.693279477428, 2735.485464435658, 3449.1035940283377, 5619.963953062189, 3413.5265732144217, 5791.812133074391, 5293.601315797769, 1650.1561253470745, 2807.555012747062, 7622.101082318911, 4661.937242349096, 7228.490474313276, 6062.599721255985, 3652.907961767212, 1858.8034370524401, 6553.400560419254, 6368.604159143538, 2518.213086179205, 3352.7681948973036, 3272.012076141442, 2358.759465058408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39929142562999265, "mean_inference_ms": 0.9926616846203586, "mean_action_processing_ms": 0.16798753455418897, "mean_env_wait_ms": 0.05457130303245911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711360931396484, "StateBufferConnector_ms": 0.0025583505630493164, "ViewRequirementAgentConnector_ms": 0.06841135025024414}, "num_episodes": 23, "episode_return_max": 21654.755322874636, "episode_return_min": 1563.013086060436, "episode_return_mean": 17364.187931234817}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.5995776741929, "num_env_steps_trained_throughput_per_sec": 527.5995776741929, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 7522.468, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7522.434, "sample_time_ms": 768.133, "learn_time_ms": 6742.928, "learn_throughput": 593.214, "synch_weights_time_ms": 10.929}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 176, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-52-11", "timestamp": 1723236731, "time_this_iter_s": 7.585700035095215, "time_total_s": 1340.5167105197906, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bbaaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1340.5167105197906, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 25.96363636363636, "ram_util_percent": 79.68181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 533595580.77671957, "cur_kl_coeff": 28688121837.740353, "cur_lr": 5.0000000000000016e-05, "total_loss": 6296605.130687831, "policy_loss": 0.00024512086393774815, "vf_loss": 9.775776715757985, "vf_explained_var": 0.0011776349531910407, "kl": 0.00021948440290644713, "entropy": 0.9471917223362696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0066621029749512, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004451757669448, "policy_loss": -0.003089359970666313, "vf_loss": 10.0, "vf_explained_var": -2.9835415383179982e-05, "kl": 0.013062685833817037, "entropy": 1.409899452701211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "env_runners": {"episode_reward_max": 21654.755322874636, "episode_reward_min": 1563.013086060436, "episode_reward_mean": 17566.608349226703, "episode_len_mean": 194.85, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19485, "policy_reward_min": {"agent_policy": 111.5308490205481, "adversary_policy": 249.07351331024435}, "policy_reward_max": {"agent_policy": 13006.094586633577, "adversary_policy": 9275.694679374414}, "policy_reward_mean": {"agent_policy": 8742.814871386514, "adversary_policy": 4411.896738920096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19360.374843232024, 19557.062144478456, 18549.041989815603, 15747.386160343063, 18590.138383664093, 15656.735432307958, 16314.613079756524, 18955.606452227137, 15864.852188469858, 19871.16998309832, 19277.7827612284, 18067.396815481177, 16185.324221805075, 19598.273370817893, 17764.015122418095, 16973.72458117615, 17108.51048993648, 19291.761953653935, 19147.684658585924, 20565.718008199987, 18866.90335082813, 15370.553305695203, 18339.986143740873, 18925.420234858004, 19582.81813640243, 16059.097766494162, 15899.39161769408, 14498.099002853669, 15245.840950704991, 15385.623644456351, 19021.41835047997, 19888.226336154163, 16157.756037248364, 19955.630332453627, 16257.29376350535, 17345.636537943843, 19256.112285312138, 19360.61725026711, 16144.068588148688, 19940.795725058888, 21381.139218811655, 18790.44275512122, 19541.463844829068, 19921.81940286128, 1563.013086060436, 19744.11034588041, 19597.589645451513, 17827.777830645413, 14934.1417443106, 18700.357702045563, 16076.84124949323, 18506.22380774585, 15665.38481986352, 14728.949583704967, 19399.919729261925, 18915.03174198186, 16931.58879628781, 18944.881477236333, 17462.388819489286, 18935.498904960743, 16531.158324014268, 16155.582065912136, 15336.418070115658, 21639.749804503634, 21654.755322874636, 3969.2159727989692, 17099.511598704106, 4500.995647241428, 20075.353056997996, 19152.956206958836, 16877.62108816657, 17555.662196945344, 19435.73693952859, 15791.588213452089, 18656.30844450664, 19820.0230481876, 16000.939060783385, 20089.972675939513, 16660.348709910148, 16357.0560721, 16801.852490610454, 18572.20888244594, 18428.793526466645, 19304.790637109552, 14391.20913704115, 18303.282913264808, 15662.893954477424, 18460.95895681809, 18375.450565592262, 17864.459918719593, 19350.123982434678, 20148.990978845963, 19113.899587120777, 19638.50971640067, 15422.095778524812, 15966.856416775108, 19276.285827580832, 18278.33862977437, 19368.10555144755, 19053.74844453932], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6643.315408810758, 8270.80996728121, 7852.368112664268, 10143.730563836081, 9290.642466683266, 10411.994644127913, 11462.062134518234, 7899.185785523815, 11605.858442407316, 7016.658266805731, 8778.020498473568, 7449.3858716787, 11720.94442286096, 8508.416800509249, 8299.781414169242, 10102.94612128974, 7991.562194749379, 5764.815220971103, 8170.596153283749, 6252.283978004459, 9087.067795839124, 11612.232242489068, 8801.592057206917, 9000.66002152942, 7459.934322456812, 12198.177110807568, 11593.360404435718, 13006.094586633577, 11719.14264228179, 11099.994734513852, 7834.424233863103, 7844.723079998697, 8644.32719014179, 6788.633346849344, 11010.794527119577, 10166.031367645897, 6410.18530390019, 8088.809816858759, 11427.093604347016, 4475.151667234898, 6422.48802000094, 8517.597870517608, 8507.078562070124, 6949.928939565046, 111.5308490205481, 8144.397998726158, 7863.482227228023, 9174.173024044392, 12380.033818885357, 7486.962041351249, 10749.082114232773, 7195.199608512004, 12072.916143849505, 11540.766785996544, 8379.3740658209, 8401.94278468704, 8407.662503029364, 9073.744174102327, 10369.225134352928, 9292.933296740921, 9482.429653228195, 10490.577238938802, 11820.381411549304, 4953.134006676084, 5362.166230044474, 230.50240478263282, 10007.010391205968, 655.1010916853883, 7863.454935423531, 8890.32327971705, 10693.032029702601, 8522.171670668757, 8350.323490656569, 11333.877075357948, 6372.270119838674, 6528.932852618265, 10489.227661963727, 7167.967956376756, 10789.367428833644, 10726.284530900144, 10183.589409108838, 8824.225176078791, 9536.552002741328, 7101.97993623126, 11569.769505373024, 9441.030005258444, 11534.162444343017, 7133.252462971567, 9448.502976656939, 9487.109721916555, 8196.947723107147, 5720.654365229199, 8572.749500092637, 7887.991758196585, 12562.588997994093, 10185.746489308282, 7017.938674723322, 9860.961186297636, 7764.521215328692, 8578.349639989889], "policy_adversary_policy_reward": [5532.491582058808, 7184.5678523624665, 5861.61667561578, 5424.635501581494, 6289.568542634571, 4407.105334516729, 1605.250536612191, 3998.4050598948506, 4618.683431702381, 4680.812485278403, 1514.5998085770286, 3730.1409796030084, 2172.477456025628, 2680.073489212717, 5225.959240459251, 5830.46142624402, 1722.7165647389975, 2536.277181323597, 6999.282049818651, 5855.229666473927, 5352.206791991372, 5147.555470763453, 6692.749752052254, 3925.2611917501886, 2297.692993531565, 2166.6868054125225, 5589.691250779064, 5500.165319529545, 5138.7284096103895, 4325.505298638433, 3596.06723745008, 3274.711222436325, 6150.573428981572, 2966.374866205531, 5149.6263299229995, 8377.320402759855, 5095.628784667547, 5881.459720634586, 6740.709698278818, 7572.7243319166855, 4724.767727097136, 5055.06782789183, 1228.4176819643035, 2529.9033812418393, 5186.8142878866665, 4351.579798647216, 4936.329509516544, 4988.430703812111, 6682.20130127414, 5440.682512671489, 1920.1541443845415, 1940.7665113020475, 2436.2780815725428, 1869.7531316858397, 355.96337912279375, 1136.041037097326, 2422.992981449122, 1103.7053269741132, 3042.140889217087, 1243.488020725387, 6307.71138986785, 4879.282726748996, 5755.6165688448755, 6287.886687310665, 2015.620413517431, 5497.808433589156, 6945.107773679412, 6221.889211924978, 2130.9724537719417, 3115.5267826138665, 3222.3310408545162, 3957.274129443423, 7310.364322393888, 5535.56265901802, 6047.558838380293, 5224.248595028071, 2547.5184778835746, 2169.4565059180954, 9275.694679374414, 6189.949378449601, 7613.098174576916, 7345.553024233826, 5624.537753213346, 4648.307131390274, 5473.97942949792, 5560.405853261012, 6074.498587460819, 6897.39187583537, 1019.840000877928, 431.64223616196034, 5997.5770715832405, 5602.135275570974, 6278.653396502937, 5455.454021720626, 4967.962599686553, 3685.6422069145274, 1762.1018048455537, 792.0061205797278, 6655.113612354532, 4558.2820483397745, 3379.6349056342506, 1948.1242296261926, 4364.0881840149295, 6946.936015218952, 1993.0523479075591, 1599.4163281064737, 2601.3688377344115, 586.8139599739733, 5736.193472293686, 5284.352191147383, 5104.021485600008, 5409.067471694761, 2789.4531725569095, 5734.473120701587, 4802.745853505451, 5068.39144962862, 3329.7423162349355, 3763.4213689013545, 4849.202326990024, 4793.363281229717, 2728.6194099354866, 4320.109260850565, 2571.7046757287694, 3093.3001512446112, 2321.7542121816236, 1194.282446384788, 7602.746453801759, 9083.869344025741, 8779.969393686486, 7512.619699143609, 1840.62364565019, 1898.089922366148, 2957.8307532587683, 4134.670454239415, 1813.9898787325483, 2031.9046768234928, 6254.806949634807, 5957.091171939591, 5117.93964776431, 5144.693279477428, 2735.485464435658, 3449.1035940283377, 5619.963953062189, 3413.5265732144217, 5791.812133074391, 5293.601315797769, 1650.1561253470745, 2807.555012747062, 7622.101082318911, 4661.937242349096, 7228.490474313276, 6062.599721255985, 3652.907961767212, 1858.8034370524401, 6553.400560419254, 6368.604159143538, 2518.213086179205, 3352.7681948973036, 3272.012076141442, 2358.759465058408, 2853.550595572522, 3764.712485929116, 4430.073258715043, 5317.910447652165, 4298.044009892625, 4594.197513832678, 6142.117197857995, 6060.6935030203895, 2572.3661183578984, 249.07351331024435, 4161.147289533765, 4701.105618472503, 2060.330928922268, 2068.400581212168, 7005.899969752967, 4321.8065240935175, 4672.227654085129, 4254.719934850143, 4655.0259018143925, 3722.3242949886344, 5924.375655057817, 5228.800604269699, 6006.855355114992, 8421.48125850175, 4971.7639633898125, 5569.38612363832, 6254.143865534367, 5496.374092669681, 1281.8805853368012, 1577.6261951939491, 3956.38913442266, 1824.720793044146, 5147.844678728595, 7110.502474128891, 4280.788696170902, 4136.5887473058865, 5230.818468548069, 6372.765867570793, 4940.824862019304, 5534.573942530196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992998975167616, "mean_inference_ms": 0.9931129077147678, "mean_action_processing_ms": 0.16805375175657275, "mean_env_wait_ms": 0.054541918653772364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035598278045654297, "StateBufferConnector_ms": 0.002591252326965332, "ViewRequirementAgentConnector_ms": 0.07245087623596191}, "num_episodes": 20, "episode_return_max": 21654.755322874636, "episode_return_min": 1563.013086060436, "episode_return_mean": 17566.608349226703}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.19289700684203, "num_env_steps_trained_throughput_per_sec": 509.19289700684203, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2124000, "timers": {"training_iteration_time_ms": 7567.154, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7567.121, "sample_time_ms": 786.345, "learn_time_ms": 6769.246, "learn_throughput": 590.908, "synch_weights_time_ms": 11.081}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "done": false, "training_iteration": 177, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-52-19", "timestamp": 1723236739, "time_this_iter_s": 7.86042332649231, "time_total_s": 1348.377133846283, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bbaee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1348.377133846283, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 27.641666666666666, "ram_util_percent": 78.94166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 323152485.44021165, "cur_kl_coeff": 14344060918.870176, "cur_lr": 5.0000000000000016e-05, "total_loss": 4818447.888690476, "policy_loss": 0.000631295094049718, "vf_loss": 9.861949190008577, "vf_explained_var": 0.016125850040445883, "kl": 0.00033591867866648715, "entropy": 0.9410879509158866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0638755835903189, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997345250844955, "policy_loss": -0.0038163924153195696, "vf_loss": 9.99552618265152, "vf_explained_var": -1.5383027493953706e-05, "kl": 0.009761636684318849, "entropy": 1.437499097486337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": 21654.755322874636, "episode_reward_min": 1563.013086060436, "episode_reward_mean": 17483.91961010623, "episode_len_mean": 193.1, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19310, "policy_reward_min": {"agent_policy": 111.5308490205481, "adversary_policy": 249.07351331024435}, "policy_reward_max": {"agent_policy": 13006.094586633577, "adversary_policy": 9275.694679374414}, "policy_reward_mean": {"agent_policy": 8606.986446164612, "adversary_policy": 4438.466581970811}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20565.718008199987, 18866.90335082813, 15370.553305695203, 18339.986143740873, 18925.420234858004, 19582.81813640243, 16059.097766494162, 15899.39161769408, 14498.099002853669, 15245.840950704991, 15385.623644456351, 19021.41835047997, 19888.226336154163, 16157.756037248364, 19955.630332453627, 16257.29376350535, 17345.636537943843, 19256.112285312138, 19360.61725026711, 16144.068588148688, 19940.795725058888, 21381.139218811655, 18790.44275512122, 19541.463844829068, 19921.81940286128, 1563.013086060436, 19744.11034588041, 19597.589645451513, 17827.777830645413, 14934.1417443106, 18700.357702045563, 16076.84124949323, 18506.22380774585, 15665.38481986352, 14728.949583704967, 19399.919729261925, 18915.03174198186, 16931.58879628781, 18944.881477236333, 17462.388819489286, 18935.498904960743, 16531.158324014268, 16155.582065912136, 15336.418070115658, 21639.749804503634, 21654.755322874636, 3969.2159727989692, 17099.511598704106, 4500.995647241428, 20075.353056997996, 19152.956206958836, 16877.62108816657, 17555.662196945344, 19435.73693952859, 15791.588213452089, 18656.30844450664, 19820.0230481876, 16000.939060783385, 20089.972675939513, 16660.348709910148, 16357.0560721, 16801.852490610454, 18572.20888244594, 18428.793526466645, 19304.790637109552, 14391.20913704115, 18303.282913264808, 15662.893954477424, 18460.95895681809, 18375.450565592262, 17864.459918719593, 19350.123982434678, 20148.990978845963, 19113.899587120777, 19638.50971640067, 15422.095778524812, 15966.856416775108, 19276.285827580832, 18278.33862977437, 19368.10555144755, 19053.74844453932, 15860.055467609218, 18573.84259890095, 21036.526927961037, 19302.97119141257, 17468.934948914368, 19764.872857377726, 16021.291247703595, 19977.8745333056, 16153.547435650979, 19829.998450685784, 15051.592185527463, 16116.030762644003, 20101.181635322213, 18777.12065901208, 19831.241330679386, 17718.07255328443, 18683.950939278653, 2889.6442222453616, 20453.830772933332], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200], "policy_agent_policy_reward": [6252.283978004459, 9087.067795839124, 11612.232242489068, 8801.592057206917, 9000.66002152942, 7459.934322456812, 12198.177110807568, 11593.360404435718, 13006.094586633577, 11719.14264228179, 11099.994734513852, 7834.424233863103, 7844.723079998697, 8644.32719014179, 6788.633346849344, 11010.794527119577, 10166.031367645897, 6410.18530390019, 8088.809816858759, 11427.093604347016, 4475.151667234898, 6422.48802000094, 8517.597870517608, 8507.078562070124, 6949.928939565046, 111.5308490205481, 8144.397998726158, 7863.482227228023, 9174.173024044392, 12380.033818885357, 7486.962041351249, 10749.082114232773, 7195.199608512004, 12072.916143849505, 11540.766785996544, 8379.3740658209, 8401.94278468704, 8407.662503029364, 9073.744174102327, 10369.225134352928, 9292.933296740921, 9482.429653228195, 10490.577238938802, 11820.381411549304, 4953.134006676084, 5362.166230044474, 230.50240478263282, 10007.010391205968, 655.1010916853883, 7863.454935423531, 8890.32327971705, 10693.032029702601, 8522.171670668757, 8350.323490656569, 11333.877075357948, 6372.270119838674, 6528.932852618265, 10489.227661963727, 7167.967956376756, 10789.367428833644, 10726.284530900144, 10183.589409108838, 8824.225176078791, 9536.552002741328, 7101.97993623126, 11569.769505373024, 9441.030005258444, 11534.162444343017, 7133.252462971567, 9448.502976656939, 9487.109721916555, 8196.947723107147, 5720.654365229199, 8572.749500092637, 7887.991758196585, 12562.588997994093, 10185.746489308282, 7017.938674723322, 9860.961186297636, 7764.521215328692, 8578.349639989889, 11285.297241369533, 8942.470105940609, 6235.008237257435, 7789.10022877722, 10734.801019900066, 8186.22362552908, 11317.27381324988, 5225.694652664781, 10758.373547256422, 8039.284016053504, 10067.855633382072, 10601.70449701547, 7742.985823009053, 8659.340684049354, 5866.194244692771, 8757.613319846383, 7056.733897036149, 260.60623127842905, 6273.69115014579], "policy_adversary_policy_reward": [6740.709698278818, 7572.7243319166855, 4724.767727097136, 5055.06782789183, 1228.4176819643035, 2529.9033812418393, 5186.8142878866665, 4351.579798647216, 4936.329509516544, 4988.430703812111, 6682.20130127414, 5440.682512671489, 1920.1541443845415, 1940.7665113020475, 2436.2780815725428, 1869.7531316858397, 355.96337912279375, 1136.041037097326, 2422.992981449122, 1103.7053269741132, 3042.140889217087, 1243.488020725387, 6307.71138986785, 4879.282726748996, 5755.6165688448755, 6287.886687310665, 2015.620413517431, 5497.808433589156, 6945.107773679412, 6221.889211924978, 2130.9724537719417, 3115.5267826138665, 3222.3310408545162, 3957.274129443423, 7310.364322393888, 5535.56265901802, 6047.558838380293, 5224.248595028071, 2547.5184778835746, 2169.4565059180954, 9275.694679374414, 6189.949378449601, 7613.098174576916, 7345.553024233826, 5624.537753213346, 4648.307131390274, 5473.97942949792, 5560.405853261012, 6074.498587460819, 6897.39187583537, 1019.840000877928, 431.64223616196034, 5997.5770715832405, 5602.135275570974, 6278.653396502937, 5455.454021720626, 4967.962599686553, 3685.6422069145274, 1762.1018048455537, 792.0061205797278, 6655.113612354532, 4558.2820483397745, 3379.6349056342506, 1948.1242296261926, 4364.0881840149295, 6946.936015218952, 1993.0523479075591, 1599.4163281064737, 2601.3688377344115, 586.8139599739733, 5736.193472293686, 5284.352191147383, 5104.021485600008, 5409.067471694761, 2789.4531725569095, 5734.473120701587, 4802.745853505451, 5068.39144962862, 3329.7423162349355, 3763.4213689013545, 4849.202326990024, 4793.363281229717, 2728.6194099354866, 4320.109260850565, 2571.7046757287694, 3093.3001512446112, 2321.7542121816236, 1194.282446384788, 7602.746453801759, 9083.869344025741, 8779.969393686486, 7512.619699143609, 1840.62364565019, 1898.089922366148, 2957.8307532587683, 4134.670454239415, 1813.9898787325483, 2031.9046768234928, 6254.806949634807, 5957.091171939591, 5117.93964776431, 5144.693279477428, 2735.485464435658, 3449.1035940283377, 5619.963953062189, 3413.5265732144217, 5791.812133074391, 5293.601315797769, 1650.1561253470745, 2807.555012747062, 7622.101082318911, 4661.937242349096, 7228.490474313276, 6062.599721255985, 3652.907961767212, 1858.8034370524401, 6553.400560419254, 6368.604159143538, 2518.213086179205, 3352.7681948973036, 3272.012076141442, 2358.759465058408, 2853.550595572522, 3764.712485929116, 4430.073258715043, 5317.910447652165, 4298.044009892625, 4594.197513832678, 6142.117197857995, 6060.6935030203895, 2572.3661183578984, 249.07351331024435, 4161.147289533765, 4701.105618472503, 2060.330928922268, 2068.400581212168, 7005.899969752967, 4321.8065240935175, 4672.227654085129, 4254.719934850143, 4655.0259018143925, 3722.3242949886344, 5924.375655057817, 5228.800604269699, 6006.855355114992, 8421.48125850175, 4971.7639633898125, 5569.38612363832, 6254.143865534367, 5496.374092669681, 1281.8805853368012, 1577.6261951939491, 3956.38913442266, 1824.720793044146, 5147.844678728595, 7110.502474128891, 4280.788696170902, 4136.5887473058865, 5230.818468548069, 6372.765867570793, 4940.824862019304, 5534.573942530196, 1722.3229103136982, 2852.4353159260195, 5186.43896009473, 4444.933532865612, 7876.665934515969, 6924.85275618759, 5160.835567681596, 6353.035394953739, 3407.334603830884, 3326.7993251834196, 5647.101841650116, 5931.5473901985215, 2824.8618104810607, 1879.1556239726472, 8572.472424091031, 6179.707456549774, 2476.6895299669973, 2918.4843584275595, 6057.834132519856, 5732.880302112388, 909.4565617965383, 4074.2799903488626, 2104.5792757030613, 3409.746989925471, 6295.722931255764, 6062.472881057378, 4649.826901534277, 5467.953073428455, 8254.48520225017, 5710.561883736408, 3575.9369295534284, 5384.522303884563, 4827.517311084483, 6799.699731158053, 1121.8772692789923, 1507.16072168794, 6351.210379086063, 7828.9292437015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39926323505264427, "mean_inference_ms": 0.9937185039758694, "mean_action_processing_ms": 0.16805167749050068, "mean_env_wait_ms": 0.05454397815797156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00351560115814209, "StateBufferConnector_ms": 0.002604961395263672, "ViewRequirementAgentConnector_ms": 0.07032966613769531}, "num_episodes": 19, "episode_return_max": 21654.755322874636, "episode_return_min": 1563.013086060436, "episode_return_mean": 17483.91961010623}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.9042429388895, "num_env_steps_trained_throughput_per_sec": 488.9042429388895, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 7646.633, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7646.6, "sample_time_ms": 799.302, "learn_time_ms": 6835.655, "learn_throughput": 585.167, "synch_weights_time_ms": 11.189}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 178, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-52-28", "timestamp": 1723236748, "time_this_iter_s": 8.187794923782349, "time_total_s": 1356.5649287700653, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bcf280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1356.5649287700653, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 27.83333333333333, "ram_util_percent": 78.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178253410.74973544, "cur_kl_coeff": 7172030459.435088, "cur_lr": 5.0000000000000016e-05, "total_loss": 3108376.693584656, "policy_loss": 0.0008787599027590461, "vf_loss": 9.92964382020254, "vf_explained_var": 0.0013607391920039263, "kl": 0.0004334012204602548, "entropy": 0.9354172301040125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0698504207345347, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004054737091064, "policy_loss": -0.001237789155372108, "vf_loss": 10.0, "vf_explained_var": -6.134311358133951e-07, "kl": 0.009167686762521044, "entropy": 1.4581944461911918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "env_runners": {"episode_reward_max": 21654.755322874636, "episode_reward_min": 1563.013086060436, "episode_reward_mean": 17664.41175655579, "episode_len_mean": 193.1, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19310, "policy_reward_min": {"agent_policy": 111.5308490205481, "adversary_policy": 249.07351331024435}, "policy_reward_max": {"agent_policy": 12562.588997994093, "adversary_policy": 9083.869344025741}, "policy_reward_mean": {"agent_policy": 8418.42751819315, "adversary_policy": 4622.992119181323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21381.139218811655, 18790.44275512122, 19541.463844829068, 19921.81940286128, 1563.013086060436, 19744.11034588041, 19597.589645451513, 17827.777830645413, 14934.1417443106, 18700.357702045563, 16076.84124949323, 18506.22380774585, 15665.38481986352, 14728.949583704967, 19399.919729261925, 18915.03174198186, 16931.58879628781, 18944.881477236333, 17462.388819489286, 18935.498904960743, 16531.158324014268, 16155.582065912136, 15336.418070115658, 21639.749804503634, 21654.755322874636, 3969.2159727989692, 17099.511598704106, 4500.995647241428, 20075.353056997996, 19152.956206958836, 16877.62108816657, 17555.662196945344, 19435.73693952859, 15791.588213452089, 18656.30844450664, 19820.0230481876, 16000.939060783385, 20089.972675939513, 16660.348709910148, 16357.0560721, 16801.852490610454, 18572.20888244594, 18428.793526466645, 19304.790637109552, 14391.20913704115, 18303.282913264808, 15662.893954477424, 18460.95895681809, 18375.450565592262, 17864.459918719593, 19350.123982434678, 20148.990978845963, 19113.899587120777, 19638.50971640067, 15422.095778524812, 15966.856416775108, 19276.285827580832, 18278.33862977437, 19368.10555144755, 19053.74844453932, 15860.055467609218, 18573.84259890095, 21036.526927961037, 19302.97119141257, 17468.934948914368, 19764.872857377726, 16021.291247703595, 19977.8745333056, 16153.547435650979, 19829.998450685784, 15051.592185527463, 16116.030762644003, 20101.181635322213, 18777.12065901208, 19831.241330679386, 17718.07255328443, 18683.950939278653, 2889.6442222453616, 20453.830772933332, 17330.969174465394, 17827.135156540364, 19683.329231216743, 18867.42395987718, 17401.92879888831, 17544.317343934254, 16972.983002425706, 19090.5958109591, 18246.813366810617, 17258.365788754203, 19104.282125297887, 18883.14532826573, 20287.600480721376, 20069.63709428766, 18073.28720081743, 18759.483096070227, 20149.049002139353, 15010.297839322879, 17258.138855611007, 21156.88979147657, 21140.549565574252], "episode_lengths": [200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 31, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6422.48802000094, 8517.597870517608, 8507.078562070124, 6949.928939565046, 111.5308490205481, 8144.397998726158, 7863.482227228023, 9174.173024044392, 12380.033818885357, 7486.962041351249, 10749.082114232773, 7195.199608512004, 12072.916143849505, 11540.766785996544, 8379.3740658209, 8401.94278468704, 8407.662503029364, 9073.744174102327, 10369.225134352928, 9292.933296740921, 9482.429653228195, 10490.577238938802, 11820.381411549304, 4953.134006676084, 5362.166230044474, 230.50240478263282, 10007.010391205968, 655.1010916853883, 7863.454935423531, 8890.32327971705, 10693.032029702601, 8522.171670668757, 8350.323490656569, 11333.877075357948, 6372.270119838674, 6528.932852618265, 10489.227661963727, 7167.967956376756, 10789.367428833644, 10726.284530900144, 10183.589409108838, 8824.225176078791, 9536.552002741328, 7101.97993623126, 11569.769505373024, 9441.030005258444, 11534.162444343017, 7133.252462971567, 9448.502976656939, 9487.109721916555, 8196.947723107147, 5720.654365229199, 8572.749500092637, 7887.991758196585, 12562.588997994093, 10185.746489308282, 7017.938674723322, 9860.961186297636, 7764.521215328692, 8578.349639989889, 11285.297241369533, 8942.470105940609, 6235.008237257435, 7789.10022877722, 10734.801019900066, 8186.22362552908, 11317.27381324988, 5225.694652664781, 10758.373547256422, 8039.284016053504, 10067.855633382072, 10601.70449701547, 7742.985823009053, 8659.340684049354, 5866.194244692771, 8757.613319846383, 7056.733897036149, 260.60623127842905, 6273.69115014579, 8504.25686794925, 10021.836523140088, 8011.898536181371, 8950.180916181314, 10712.549947752867, 8189.911862326529, 6895.498081797185, 8359.491750436104, 9301.907909391368, 10122.82118841274, 6993.694134251992, 7000.651495601349, 7761.103333111867, 7883.288977109593, 8872.676000595964, 7213.618068359286, 7013.948745741488, 10583.407068699604, 10405.663501411014, 6039.425630541036, 6826.990698019554], "policy_adversary_policy_reward": [7613.098174576916, 7345.553024233826, 5624.537753213346, 4648.307131390274, 5473.97942949792, 5560.405853261012, 6074.498587460819, 6897.39187583537, 1019.840000877928, 431.64223616196034, 5997.5770715832405, 5602.135275570974, 6278.653396502937, 5455.454021720626, 4967.962599686553, 3685.6422069145274, 1762.1018048455537, 792.0061205797278, 6655.113612354532, 4558.2820483397745, 3379.6349056342506, 1948.1242296261926, 4364.0881840149295, 6946.936015218952, 1993.0523479075591, 1599.4163281064737, 2601.3688377344115, 586.8139599739733, 5736.193472293686, 5284.352191147383, 5104.021485600008, 5409.067471694761, 2789.4531725569095, 5734.473120701587, 4802.745853505451, 5068.39144962862, 3329.7423162349355, 3763.4213689013545, 4849.202326990024, 4793.363281229717, 2728.6194099354866, 4320.109260850565, 2571.7046757287694, 3093.3001512446112, 2321.7542121816236, 1194.282446384788, 7602.746453801759, 9083.869344025741, 8779.969393686486, 7512.619699143609, 1840.62364565019, 1898.089922366148, 2957.8307532587683, 4134.670454239415, 1813.9898787325483, 2031.9046768234928, 6254.806949634807, 5957.091171939591, 5117.93964776431, 5144.693279477428, 2735.485464435658, 3449.1035940283377, 5619.963953062189, 3413.5265732144217, 5791.812133074391, 5293.601315797769, 1650.1561253470745, 2807.555012747062, 7622.101082318911, 4661.937242349096, 7228.490474313276, 6062.599721255985, 3652.907961767212, 1858.8034370524401, 6553.400560419254, 6368.604159143538, 2518.213086179205, 3352.7681948973036, 3272.012076141442, 2358.759465058408, 2853.550595572522, 3764.712485929116, 4430.073258715043, 5317.910447652165, 4298.044009892625, 4594.197513832678, 6142.117197857995, 6060.6935030203895, 2572.3661183578984, 249.07351331024435, 4161.147289533765, 4701.105618472503, 2060.330928922268, 2068.400581212168, 7005.899969752967, 4321.8065240935175, 4672.227654085129, 4254.719934850143, 4655.0259018143925, 3722.3242949886344, 5924.375655057817, 5228.800604269699, 6006.855355114992, 8421.48125850175, 4971.7639633898125, 5569.38612363832, 6254.143865534367, 5496.374092669681, 1281.8805853368012, 1577.6261951939491, 3956.38913442266, 1824.720793044146, 5147.844678728595, 7110.502474128891, 4280.788696170902, 4136.5887473058865, 5230.818468548069, 6372.765867570793, 4940.824862019304, 5534.573942530196, 1722.3229103136982, 2852.4353159260195, 5186.43896009473, 4444.933532865612, 7876.665934515969, 6924.85275618759, 5160.835567681596, 6353.035394953739, 3407.334603830884, 3326.7993251834196, 5647.101841650116, 5931.5473901985215, 2824.8618104810607, 1879.1556239726472, 8572.472424091031, 6179.707456549774, 2476.6895299669973, 2918.4843584275595, 6057.834132519856, 5732.880302112388, 909.4565617965383, 4074.2799903488626, 2104.5792757030613, 3409.746989925471, 6295.722931255764, 6062.472881057378, 4649.826901534277, 5467.953073428455, 8254.48520225017, 5710.561883736408, 3575.9369295534284, 5384.522303884563, 4827.517311084483, 6799.699731158053, 1121.8772692789923, 1507.16072168794, 6351.210379086063, 7828.9292437015, 5635.6086884724355, 3191.103618043713, 4113.963824876695, 3691.3348085235734, 5679.648362943418, 5991.782332091967, 5191.95470754965, 4725.288336146264, 3427.762947614449, 3261.615903521037, 5952.223761404427, 3402.181720203281, 2830.847378694796, 7246.6375419337555, 4963.932467989947, 5767.171592533025, 4110.482851088084, 4834.422606331144, 3116.2301650232903, 4019.314435318206, 4962.146501566928, 7148.441489478963, 7094.472965975223, 4788.02086668918, 6242.67364769887, 6283.823499910602, 6108.788208514164, 6077.559908663853, 5269.459623134986, 3931.151577086543, 4617.347472339334, 6928.517555371675, 6246.184753487137, 6888.915502910815, 868.1622155919835, 3558.72855503132, 3116.0032318800995, 3736.47212231994, 8043.047921525616, 7074.416239409923, 7049.374048053191, 7264.184819501528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399207500749197, "mean_inference_ms": 0.9942266068622871, "mean_action_processing_ms": 0.16805580099537162, "mean_env_wait_ms": 0.05455567269824631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035625696182250977, "StateBufferConnector_ms": 0.0026407241821289062, "ViewRequirementAgentConnector_ms": 0.07398545742034912}, "num_episodes": 21, "episode_return_max": 21654.755322874636, "episode_return_min": 1563.013086060436, "episode_return_mean": 17664.41175655579}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.0322485834375, "num_env_steps_trained_throughput_per_sec": 521.0322485834375, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2148000, "timers": {"training_iteration_time_ms": 7676.062, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7676.028, "sample_time_ms": 801.113, "learn_time_ms": 6863.363, "learn_throughput": 582.805, "synch_weights_time_ms": 11.085}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "done": false, "training_iteration": 179, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-52-36", "timestamp": 1723236756, "time_this_iter_s": 7.6825621128082275, "time_total_s": 1364.2474908828735, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bcf8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1364.2474908828735, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 28.099999999999998, "ram_util_percent": 79.04545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 78896401.06031746, "cur_kl_coeff": 3586015229.717544, "cur_lr": 5.0000000000000016e-05, "total_loss": 1362103.2316468253, "policy_loss": 0.0006909353743558602, "vf_loss": 9.757995297669103, "vf_explained_var": -0.00421161102870154, "kl": 0.00037983482656292077, "entropy": 0.9279812486398787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0407901113852858, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.99579914410909, "policy_loss": -0.004655979209686242, "vf_loss": 9.993657696247102, "vf_explained_var": -2.06028421719869e-05, "kl": 0.011774562432644112, "entropy": 1.421918947249651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 21654.755322874636, "episode_reward_min": 2889.6442222453616, "episode_reward_mean": 17644.342341559743, "episode_len_mean": 193.22, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19322, "policy_reward_min": {"agent_policy": 213.7507587867007, "adversary_policy": 249.07351331024435}, "policy_reward_max": {"agent_policy": 12562.588997994093, "adversary_policy": 9083.869344025741}, "policy_reward_mean": {"agent_policy": 8453.75602333426, "adversary_policy": 4595.293159112745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18935.498904960743, 16531.158324014268, 16155.582065912136, 15336.418070115658, 21639.749804503634, 21654.755322874636, 3969.2159727989692, 17099.511598704106, 4500.995647241428, 20075.353056997996, 19152.956206958836, 16877.62108816657, 17555.662196945344, 19435.73693952859, 15791.588213452089, 18656.30844450664, 19820.0230481876, 16000.939060783385, 20089.972675939513, 16660.348709910148, 16357.0560721, 16801.852490610454, 18572.20888244594, 18428.793526466645, 19304.790637109552, 14391.20913704115, 18303.282913264808, 15662.893954477424, 18460.95895681809, 18375.450565592262, 17864.459918719593, 19350.123982434678, 20148.990978845963, 19113.899587120777, 19638.50971640067, 15422.095778524812, 15966.856416775108, 19276.285827580832, 18278.33862977437, 19368.10555144755, 19053.74844453932, 15860.055467609218, 18573.84259890095, 21036.526927961037, 19302.97119141257, 17468.934948914368, 19764.872857377726, 16021.291247703595, 19977.8745333056, 16153.547435650979, 19829.998450685784, 15051.592185527463, 16116.030762644003, 20101.181635322213, 18777.12065901208, 19831.241330679386, 17718.07255328443, 18683.950939278653, 2889.6442222453616, 20453.830772933332, 17330.969174465394, 17827.135156540364, 19683.329231216743, 18867.42395987718, 17401.92879888831, 17544.317343934254, 16972.983002425706, 19090.5958109591, 18246.813366810617, 17258.365788754203, 19104.282125297887, 18883.14532826573, 20287.600480721376, 20069.63709428766, 18073.28720081743, 18759.483096070227, 20149.049002139353, 15010.297839322879, 17258.138855611007, 21156.88979147657, 21140.549565574252, 17416.84781646903, 19804.062953411438, 16656.087199637863, 18173.104142532382, 16361.111844027459, 17819.674783999915, 16444.35730423386, 19764.760324919942, 18289.752683417533, 19957.289890835455, 16854.56005187743, 16446.053311883374, 20255.80903504129, 19340.445815867737, 15938.866723136158, 3525.7214160612098, 15853.897603092131, 17748.399806358673, 19975.32139467437], "episode_lengths": [200, 200, 200, 200, 200, 200, 31, 200, 38, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200], "policy_agent_policy_reward": [9292.933296740921, 9482.429653228195, 10490.577238938802, 11820.381411549304, 4953.134006676084, 5362.166230044474, 230.50240478263282, 10007.010391205968, 655.1010916853883, 7863.454935423531, 8890.32327971705, 10693.032029702601, 8522.171670668757, 8350.323490656569, 11333.877075357948, 6372.270119838674, 6528.932852618265, 10489.227661963727, 7167.967956376756, 10789.367428833644, 10726.284530900144, 10183.589409108838, 8824.225176078791, 9536.552002741328, 7101.97993623126, 11569.769505373024, 9441.030005258444, 11534.162444343017, 7133.252462971567, 9448.502976656939, 9487.109721916555, 8196.947723107147, 5720.654365229199, 8572.749500092637, 7887.991758196585, 12562.588997994093, 10185.746489308282, 7017.938674723322, 9860.961186297636, 7764.521215328692, 8578.349639989889, 11285.297241369533, 8942.470105940609, 6235.008237257435, 7789.10022877722, 10734.801019900066, 8186.22362552908, 11317.27381324988, 5225.694652664781, 10758.373547256422, 8039.284016053504, 10067.855633382072, 10601.70449701547, 7742.985823009053, 8659.340684049354, 5866.194244692771, 8757.613319846383, 7056.733897036149, 260.60623127842905, 6273.69115014579, 8504.25686794925, 10021.836523140088, 8011.898536181371, 8950.180916181314, 10712.549947752867, 8189.911862326529, 6895.498081797185, 8359.491750436104, 9301.907909391368, 10122.82118841274, 6993.694134251992, 7000.651495601349, 7761.103333111867, 7883.288977109593, 8872.676000595964, 7213.618068359286, 7013.948745741488, 10583.407068699604, 10405.663501411014, 6039.425630541036, 6826.990698019554, 9896.18419473233, 7283.4252221075385, 8642.868411238074, 9719.505273142757, 11837.489113652036, 8226.811464306023, 10115.940163781615, 8346.178782029394, 8478.537855006874, 6807.758323257252, 10601.75076467096, 11121.064844977285, 7565.740359066647, 7005.434418984333, 10719.322169894764, 213.7507587867007, 11155.907329046253, 9858.44002521652, 7684.327706206268], "policy_adversary_policy_reward": [4849.202326990024, 4793.363281229717, 2728.6194099354866, 4320.109260850565, 2571.7046757287694, 3093.3001512446112, 2321.7542121816236, 1194.282446384788, 7602.746453801759, 9083.869344025741, 8779.969393686486, 7512.619699143609, 1840.62364565019, 1898.089922366148, 2957.8307532587683, 4134.670454239415, 1813.9898787325483, 2031.9046768234928, 6254.806949634807, 5957.091171939591, 5117.93964776431, 5144.693279477428, 2735.485464435658, 3449.1035940283377, 5619.963953062189, 3413.5265732144217, 5791.812133074391, 5293.601315797769, 1650.1561253470745, 2807.555012747062, 7622.101082318911, 4661.937242349096, 7228.490474313276, 6062.599721255985, 3652.907961767212, 1858.8034370524401, 6553.400560419254, 6368.604159143538, 2518.213086179205, 3352.7681948973036, 3272.012076141442, 2358.759465058408, 2853.550595572522, 3764.712485929116, 4430.073258715043, 5317.910447652165, 4298.044009892625, 4594.197513832678, 6142.117197857995, 6060.6935030203895, 2572.3661183578984, 249.07351331024435, 4161.147289533765, 4701.105618472503, 2060.330928922268, 2068.400581212168, 7005.899969752967, 4321.8065240935175, 4672.227654085129, 4254.719934850143, 4655.0259018143925, 3722.3242949886344, 5924.375655057817, 5228.800604269699, 6006.855355114992, 8421.48125850175, 4971.7639633898125, 5569.38612363832, 6254.143865534367, 5496.374092669681, 1281.8805853368012, 1577.6261951939491, 3956.38913442266, 1824.720793044146, 5147.844678728595, 7110.502474128891, 4280.788696170902, 4136.5887473058865, 5230.818468548069, 6372.765867570793, 4940.824862019304, 5534.573942530196, 1722.3229103136982, 2852.4353159260195, 5186.43896009473, 4444.933532865612, 7876.665934515969, 6924.85275618759, 5160.835567681596, 6353.035394953739, 3407.334603830884, 3326.7993251834196, 5647.101841650116, 5931.5473901985215, 2824.8618104810607, 1879.1556239726472, 8572.472424091031, 6179.707456549774, 2476.6895299669973, 2918.4843584275595, 6057.834132519856, 5732.880302112388, 909.4565617965383, 4074.2799903488626, 2104.5792757030613, 3409.746989925471, 6295.722931255764, 6062.472881057378, 4649.826901534277, 5467.953073428455, 8254.48520225017, 5710.561883736408, 3575.9369295534284, 5384.522303884563, 4827.517311084483, 6799.699731158053, 1121.8772692789923, 1507.16072168794, 6351.210379086063, 7828.9292437015, 5635.6086884724355, 3191.103618043713, 4113.963824876695, 3691.3348085235734, 5679.648362943418, 5991.782332091967, 5191.95470754965, 4725.288336146264, 3427.762947614449, 3261.615903521037, 5952.223761404427, 3402.181720203281, 2830.847378694796, 7246.6375419337555, 4963.932467989947, 5767.171592533025, 4110.482851088084, 4834.422606331144, 3116.2301650232903, 4019.314435318206, 4962.146501566928, 7148.441489478963, 7094.472965975223, 4788.02086668918, 6242.67364769887, 6283.823499910602, 6108.788208514164, 6077.559908663853, 5269.459623134986, 3931.151577086543, 4617.347472339334, 6928.517555371675, 6246.184753487137, 6888.915502910815, 868.1622155919835, 3558.72855503132, 3116.0032318800995, 3736.47212231994, 8043.047921525616, 7074.416239409923, 7049.374048053191, 7264.184819501528, 4245.951428998615, 3274.7121927380626, 6196.95098554236, 6323.686745761588, 2513.9515759069022, 5499.267212492867, 4382.119175888004, 4071.4796935016448, 2304.054738418806, 2219.5679919566537, 5915.324159424925, 3677.5391602689638, 3385.7634330202523, 2942.6537074319735, 5787.108112375332, 5631.473430515266, 4147.617059686564, 5663.597768724061, 7305.931723784859, 5843.599843793353, 3241.370424279718, 3011.438862926744, 2719.320652425876, 2605.667814480215, 6113.673411310326, 6576.395264664309, 7136.701204746621, 5198.3101921368, 3422.8134538361646, 1796.731099405226, 1727.1857555797337, 1584.7849016947748, 2986.228294684673, 1711.7619793612491, 4283.695598514431, 3606.264182627722, 5957.996453617018, 6332.997234851095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39924371963281596, "mean_inference_ms": 0.9948347612450289, "mean_action_processing_ms": 0.16809003894848154, "mean_env_wait_ms": 0.05454442721425632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035190582275390625, "StateBufferConnector_ms": 0.0026786327362060547, "ViewRequirementAgentConnector_ms": 0.07526922225952148}, "num_episodes": 19, "episode_return_max": 21654.755322874636, "episode_return_min": 2889.6442222453616, "episode_return_mean": 17644.342341559743}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.0856659509947, "num_env_steps_trained_throughput_per_sec": 495.0856659509947, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 7735.475, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7735.44, "sample_time_ms": 820.067, "learn_time_ms": 6903.85, "learn_throughput": 579.387, "synch_weights_time_ms": 11.046}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 180, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-52-44", "timestamp": 1723236764, "time_this_iter_s": 8.083308935165405, "time_total_s": 1372.330799818039, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bbaca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1372.330799818039, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 31.96666666666667, "ram_util_percent": 79.09166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36852716.402645506, "cur_kl_coeff": 1793007614.858772, "cur_lr": 5.0000000000000016e-05, "total_loss": 590119.9542658731, "policy_loss": -0.000227809908908235, "vf_loss": 9.89987531238132, "vf_explained_var": 0.012551939802825766, "kl": 0.00032911742781011744, "entropy": 0.9203988023535915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0195209580784044, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002667528390884, "policy_loss": -0.0028292417618407248, "vf_loss": 10.0, "vf_explained_var": 3.602728247642517e-06, "kl": 0.009521512490755413, "entropy": 1.426871370524168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "env_runners": {"episode_reward_max": 21156.88979147657, "episode_reward_min": 2889.6442222453616, "episode_reward_mean": 17947.613975389526, "episode_len_mean": 196.53, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 19653, "policy_reward_min": {"agent_policy": 213.7507587867007, "adversary_policy": 249.07351331024435}, "policy_reward_max": {"agent_policy": 12562.588997994093, "adversary_policy": 9282.02014037333}, "policy_reward_mean": {"agent_policy": 8505.07471007041, "adversary_policy": 4721.269632659561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19304.790637109552, 14391.20913704115, 18303.282913264808, 15662.893954477424, 18460.95895681809, 18375.450565592262, 17864.459918719593, 19350.123982434678, 20148.990978845963, 19113.899587120777, 19638.50971640067, 15422.095778524812, 15966.856416775108, 19276.285827580832, 18278.33862977437, 19368.10555144755, 19053.74844453932, 15860.055467609218, 18573.84259890095, 21036.526927961037, 19302.97119141257, 17468.934948914368, 19764.872857377726, 16021.291247703595, 19977.8745333056, 16153.547435650979, 19829.998450685784, 15051.592185527463, 16116.030762644003, 20101.181635322213, 18777.12065901208, 19831.241330679386, 17718.07255328443, 18683.950939278653, 2889.6442222453616, 20453.830772933332, 17330.969174465394, 17827.135156540364, 19683.329231216743, 18867.42395987718, 17401.92879888831, 17544.317343934254, 16972.983002425706, 19090.5958109591, 18246.813366810617, 17258.365788754203, 19104.282125297887, 18883.14532826573, 20287.600480721376, 20069.63709428766, 18073.28720081743, 18759.483096070227, 20149.049002139353, 15010.297839322879, 17258.138855611007, 21156.88979147657, 21140.549565574252, 17416.84781646903, 19804.062953411438, 16656.087199637863, 18173.104142532382, 16361.111844027459, 17819.674783999915, 16444.35730423386, 19764.760324919942, 18289.752683417533, 19957.289890835455, 16854.56005187743, 16446.053311883374, 20255.80903504129, 19340.445815867737, 15938.866723136158, 3525.7214160612098, 15853.897603092131, 17748.399806358673, 19975.32139467437, 15429.680452391158, 17600.36728623124, 17883.120502307, 20510.373651130285, 18485.033692760964, 19390.317235019775, 18495.68559101045, 18137.403440317434, 19377.44486096418, 19787.914780458574, 18026.24631055117, 16714.720907119838, 19888.31871231583, 18747.311788687224, 18329.540965161836, 17472.502399006917, 17176.167272991217, 16400.774434595965, 19608.574865824437, 16531.7351827036, 17942.154504127488, 19320.82558556122, 17166.1795394773, 18004.07574638866], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7101.97993623126, 11569.769505373024, 9441.030005258444, 11534.162444343017, 7133.252462971567, 9448.502976656939, 9487.109721916555, 8196.947723107147, 5720.654365229199, 8572.749500092637, 7887.991758196585, 12562.588997994093, 10185.746489308282, 7017.938674723322, 9860.961186297636, 7764.521215328692, 8578.349639989889, 11285.297241369533, 8942.470105940609, 6235.008237257435, 7789.10022877722, 10734.801019900066, 8186.22362552908, 11317.27381324988, 5225.694652664781, 10758.373547256422, 8039.284016053504, 10067.855633382072, 10601.70449701547, 7742.985823009053, 8659.340684049354, 5866.194244692771, 8757.613319846383, 7056.733897036149, 260.60623127842905, 6273.69115014579, 8504.25686794925, 10021.836523140088, 8011.898536181371, 8950.180916181314, 10712.549947752867, 8189.911862326529, 6895.498081797185, 8359.491750436104, 9301.907909391368, 10122.82118841274, 6993.694134251992, 7000.651495601349, 7761.103333111867, 7883.288977109593, 8872.676000595964, 7213.618068359286, 7013.948745741488, 10583.407068699604, 10405.663501411014, 6039.425630541036, 6826.990698019554, 9896.18419473233, 7283.4252221075385, 8642.868411238074, 9719.505273142757, 11837.489113652036, 8226.811464306023, 10115.940163781615, 8346.178782029394, 8478.537855006874, 6807.758323257252, 10601.75076467096, 11121.064844977285, 7565.740359066647, 7005.434418984333, 10719.322169894764, 213.7507587867007, 11155.907329046253, 9858.44002521652, 7684.327706206268, 9561.413557543756, 9322.859523438827, 9304.381053885747, 7054.108351217695, 6940.826292787569, 8395.667049764425, 9458.54595970669, 9862.073309227377, 8486.258361609285, 6972.74329965183, 9345.63175566696, 9793.05886702032, 5341.603889947435, 9304.057430075207, 6608.783705529881, 4860.115483357633, 9150.14949076724, 10362.65857881827, 7870.605671539111, 9566.392934602183, 9055.724198117145, 7604.940692470065, 9512.054254153161, 9963.050307555712], "policy_adversary_policy_reward": [6142.117197857995, 6060.6935030203895, 2572.3661183578984, 249.07351331024435, 4161.147289533765, 4701.105618472503, 2060.330928922268, 2068.400581212168, 7005.899969752967, 4321.8065240935175, 4672.227654085129, 4254.719934850143, 4655.0259018143925, 3722.3242949886344, 5924.375655057817, 5228.800604269699, 6006.855355114992, 8421.48125850175, 4971.7639633898125, 5569.38612363832, 6254.143865534367, 5496.374092669681, 1281.8805853368012, 1577.6261951939491, 3956.38913442266, 1824.720793044146, 5147.844678728595, 7110.502474128891, 4280.788696170902, 4136.5887473058865, 5230.818468548069, 6372.765867570793, 4940.824862019304, 5534.573942530196, 1722.3229103136982, 2852.4353159260195, 5186.43896009473, 4444.933532865612, 7876.665934515969, 6924.85275618759, 5160.835567681596, 6353.035394953739, 3407.334603830884, 3326.7993251834196, 5647.101841650116, 5931.5473901985215, 2824.8618104810607, 1879.1556239726472, 8572.472424091031, 6179.707456549774, 2476.6895299669973, 2918.4843584275595, 6057.834132519856, 5732.880302112388, 909.4565617965383, 4074.2799903488626, 2104.5792757030613, 3409.746989925471, 6295.722931255764, 6062.472881057378, 4649.826901534277, 5467.953073428455, 8254.48520225017, 5710.561883736408, 3575.9369295534284, 5384.522303884563, 4827.517311084483, 6799.699731158053, 1121.8772692789923, 1507.16072168794, 6351.210379086063, 7828.9292437015, 5635.6086884724355, 3191.103618043713, 4113.963824876695, 3691.3348085235734, 5679.648362943418, 5991.782332091967, 5191.95470754965, 4725.288336146264, 3427.762947614449, 3261.615903521037, 5952.223761404427, 3402.181720203281, 2830.847378694796, 7246.6375419337555, 4963.932467989947, 5767.171592533025, 4110.482851088084, 4834.422606331144, 3116.2301650232903, 4019.314435318206, 4962.146501566928, 7148.441489478963, 7094.472965975223, 4788.02086668918, 6242.67364769887, 6283.823499910602, 6108.788208514164, 6077.559908663853, 5269.459623134986, 3931.151577086543, 4617.347472339334, 6928.517555371675, 6246.184753487137, 6888.915502910815, 868.1622155919835, 3558.72855503132, 3116.0032318800995, 3736.47212231994, 8043.047921525616, 7074.416239409923, 7049.374048053191, 7264.184819501528, 4245.951428998615, 3274.7121927380626, 6196.95098554236, 6323.686745761588, 2513.9515759069022, 5499.267212492867, 4382.119175888004, 4071.4796935016448, 2304.054738418806, 2219.5679919566537, 5915.324159424925, 3677.5391602689638, 3385.7634330202523, 2942.6537074319735, 5787.108112375332, 5631.473430515266, 4147.617059686564, 5663.597768724061, 7305.931723784859, 5843.599843793353, 3241.370424279718, 3011.438862926744, 2719.320652425876, 2605.667814480215, 6113.673411310326, 6576.395264664309, 7136.701204746621, 5198.3101921368, 3422.8134538361646, 1796.731099405226, 1727.1857555797337, 1584.7849016947748, 2986.228294684673, 1711.7619793612491, 4283.695598514431, 3606.264182627722, 5957.996453617018, 6332.997234851095, 4580.722066187194, 1287.5448286601904, 3458.2316625003104, 4819.27610029214, 4074.715148156918, 4504.024300264315, 6936.982168094773, 6519.283131817817, 6599.217203711031, 4944.99019626236, 5248.478275200119, 5746.17191005516, 4533.022424621834, 4504.11720668192, 3999.383054712375, 4275.9470763777645, 5237.382014706325, 5653.804484648593, 5715.237210288257, 7099.934270518504, 4588.658809940213, 4091.955744943979, 3218.3811331950415, 3703.2809069045124, 6329.940058696128, 8216.774763672234, 4664.172991787797, 4779.081366824203, 7533.351918201078, 4187.405341430892, 9282.02014037333, 3330.3667752759507, 3070.363822937002, 4955.653959286915, 3779.477044912672, 2258.6388108649667, 5916.552138044221, 5821.417056241107, 4575.742689128766, 2389.5995589726754, 3882.0726006368704, 5004.357705373423, 6537.194931260887, 5178.689961830243, 3102.475083447916, 4551.650201876207, 3886.988742256385, 4154.03669657656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993321460206616, "mean_inference_ms": 0.9956797425685282, "mean_action_processing_ms": 0.16814289731826146, "mean_env_wait_ms": 0.054562801081408915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550887107849121, "StateBufferConnector_ms": 0.0027208328247070312, "ViewRequirementAgentConnector_ms": 0.07573831081390381}, "num_episodes": 24, "episode_return_max": 21156.88979147657, "episode_return_min": 2889.6442222453616, "episode_return_mean": 17947.613975389526}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.15938183343843, "num_env_steps_trained_throughput_per_sec": 466.15938183343843, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2172000, "timers": {"training_iteration_time_ms": 7845.378, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7845.343, "sample_time_ms": 834.298, "learn_time_ms": 6999.312, "learn_throughput": 571.485, "synch_weights_time_ms": 11.256}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "done": false, "training_iteration": 181, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-52-53", "timestamp": 1723236773, "time_this_iter_s": 8.585438013076782, "time_total_s": 1380.9162378311157, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bbaee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1380.9162378311157, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 32.225, "ram_util_percent": 80.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18462083.80793651, "cur_kl_coeff": 896503807.429386, "cur_lr": 5.0000000000000016e-05, "total_loss": 260505.17853009258, "policy_loss": -0.00023165471413266406, "vf_loss": 9.924138891633856, "vf_explained_var": 0.027115161109853674, "kl": 0.0002905679283902005, "entropy": 0.9136830870751982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0142898529147109, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999090188741684, "policy_loss": -0.001626477778093734, "vf_loss": 9.995745142300924, "vf_explained_var": -2.0841571191946666e-05, "kl": 0.008611651851727705, "entropy": 1.452720521762967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": 21994.85093020493, "episode_reward_min": 315.7873830764967, "episode_reward_mean": 17828.054950816648, "episode_len_mean": 194.56, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 19456, "policy_reward_min": {"agent_policy": 5.6258380746779615, "adversary_policy": 103.65534872053249}, "policy_reward_max": {"agent_policy": 11837.489113652036, "adversary_policy": 10009.876278641179}, "policy_reward_mean": {"agent_policy": 8296.481561535817, "adversary_policy": 4765.786694640416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21036.526927961037, 19302.97119141257, 17468.934948914368, 19764.872857377726, 16021.291247703595, 19977.8745333056, 16153.547435650979, 19829.998450685784, 15051.592185527463, 16116.030762644003, 20101.181635322213, 18777.12065901208, 19831.241330679386, 17718.07255328443, 18683.950939278653, 2889.6442222453616, 20453.830772933332, 17330.969174465394, 17827.135156540364, 19683.329231216743, 18867.42395987718, 17401.92879888831, 17544.317343934254, 16972.983002425706, 19090.5958109591, 18246.813366810617, 17258.365788754203, 19104.282125297887, 18883.14532826573, 20287.600480721376, 20069.63709428766, 18073.28720081743, 18759.483096070227, 20149.049002139353, 15010.297839322879, 17258.138855611007, 21156.88979147657, 21140.549565574252, 17416.84781646903, 19804.062953411438, 16656.087199637863, 18173.104142532382, 16361.111844027459, 17819.674783999915, 16444.35730423386, 19764.760324919942, 18289.752683417533, 19957.289890835455, 16854.56005187743, 16446.053311883374, 20255.80903504129, 19340.445815867737, 15938.866723136158, 3525.7214160612098, 15853.897603092131, 17748.399806358673, 19975.32139467437, 15429.680452391158, 17600.36728623124, 17883.120502307, 20510.373651130285, 18485.033692760964, 19390.317235019775, 18495.68559101045, 18137.403440317434, 19377.44486096418, 19787.914780458574, 18026.24631055117, 16714.720907119838, 19888.31871231583, 18747.311788687224, 18329.540965161836, 17472.502399006917, 17176.167272991217, 16400.774434595965, 19608.574865824437, 16531.7351827036, 17942.154504127488, 19320.82558556122, 17166.1795394773, 18004.07574638866, 18503.94791536296, 315.7873830764967, 18539.36569121455, 17674.960853350905, 16792.311783171797, 21994.85093020493, 15132.307399477073, 18844.024474988222, 19750.484773650456, 17902.813106147056, 17036.918466503554, 19237.433400195274, 17923.8343929133, 18892.956019164754, 18094.175050309874, 20156.226029205947, 16985.710524401667, 19556.951680477203, 17122.936731872996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 25, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6235.008237257435, 7789.10022877722, 10734.801019900066, 8186.22362552908, 11317.27381324988, 5225.694652664781, 10758.373547256422, 8039.284016053504, 10067.855633382072, 10601.70449701547, 7742.985823009053, 8659.340684049354, 5866.194244692771, 8757.613319846383, 7056.733897036149, 260.60623127842905, 6273.69115014579, 8504.25686794925, 10021.836523140088, 8011.898536181371, 8950.180916181314, 10712.549947752867, 8189.911862326529, 6895.498081797185, 8359.491750436104, 9301.907909391368, 10122.82118841274, 6993.694134251992, 7000.651495601349, 7761.103333111867, 7883.288977109593, 8872.676000595964, 7213.618068359286, 7013.948745741488, 10583.407068699604, 10405.663501411014, 6039.425630541036, 6826.990698019554, 9896.18419473233, 7283.4252221075385, 8642.868411238074, 9719.505273142757, 11837.489113652036, 8226.811464306023, 10115.940163781615, 8346.178782029394, 8478.537855006874, 6807.758323257252, 10601.75076467096, 11121.064844977285, 7565.740359066647, 7005.434418984333, 10719.322169894764, 213.7507587867007, 11155.907329046253, 9858.44002521652, 7684.327706206268, 9561.413557543756, 9322.859523438827, 9304.381053885747, 7054.108351217695, 6940.826292787569, 8395.667049764425, 9458.54595970669, 9862.073309227377, 8486.258361609285, 6972.74329965183, 9345.63175566696, 9793.05886702032, 5341.603889947435, 9304.057430075207, 6608.783705529881, 4860.115483357633, 9150.14949076724, 10362.65857881827, 7870.605671539111, 9566.392934602183, 9055.724198117145, 7604.940692470065, 9512.054254153161, 9963.050307555712, 8586.33131051973, 5.6258380746779615, 8393.581046769425, 9493.379314657946, 9412.773331102831, 4132.259345089768, 10950.516724888428, 7413.344523462005, 7602.372402345913, 8652.774680455848, 9805.150098149397, 5614.384832174373, 9618.302867623848, 8270.022376621226, 7816.2661238379005, 6872.742708210001, 10943.56001817113, 8119.465129277256, 9729.856425437456], "policy_adversary_policy_reward": [7876.665934515969, 6924.85275618759, 5160.835567681596, 6353.035394953739, 3407.334603830884, 3326.7993251834196, 5647.101841650116, 5931.5473901985215, 2824.8618104810607, 1879.1556239726472, 8572.472424091031, 6179.707456549774, 2476.6895299669973, 2918.4843584275595, 6057.834132519856, 5732.880302112388, 909.4565617965383, 4074.2799903488626, 2104.5792757030613, 3409.746989925471, 6295.722931255764, 6062.472881057378, 4649.826901534277, 5467.953073428455, 8254.48520225017, 5710.561883736408, 3575.9369295534284, 5384.522303884563, 4827.517311084483, 6799.699731158053, 1121.8772692789923, 1507.16072168794, 6351.210379086063, 7828.9292437015, 5635.6086884724355, 3191.103618043713, 4113.963824876695, 3691.3348085235734, 5679.648362943418, 5991.782332091967, 5191.95470754965, 4725.288336146264, 3427.762947614449, 3261.615903521037, 5952.223761404427, 3402.181720203281, 2830.847378694796, 7246.6375419337555, 4963.932467989947, 5767.171592533025, 4110.482851088084, 4834.422606331144, 3116.2301650232903, 4019.314435318206, 4962.146501566928, 7148.441489478963, 7094.472965975223, 4788.02086668918, 6242.67364769887, 6283.823499910602, 6108.788208514164, 6077.559908663853, 5269.459623134986, 3931.151577086543, 4617.347472339334, 6928.517555371675, 6246.184753487137, 6888.915502910815, 868.1622155919835, 3558.72855503132, 3116.0032318800995, 3736.47212231994, 8043.047921525616, 7074.416239409923, 7049.374048053191, 7264.184819501528, 4245.951428998615, 3274.7121927380626, 6196.95098554236, 6323.686745761588, 2513.9515759069022, 5499.267212492867, 4382.119175888004, 4071.4796935016448, 2304.054738418806, 2219.5679919566537, 5915.324159424925, 3677.5391602689638, 3385.7634330202523, 2942.6537074319735, 5787.108112375332, 5631.473430515266, 4147.617059686564, 5663.597768724061, 7305.931723784859, 5843.599843793353, 3241.370424279718, 3011.438862926744, 2719.320652425876, 2605.667814480215, 6113.673411310326, 6576.395264664309, 7136.701204746621, 5198.3101921368, 3422.8134538361646, 1796.731099405226, 1727.1857555797337, 1584.7849016947748, 2986.228294684673, 1711.7619793612491, 4283.695598514431, 3606.264182627722, 5957.996453617018, 6332.997234851095, 4580.722066187194, 1287.5448286601904, 3458.2316625003104, 4819.27610029214, 4074.715148156918, 4504.024300264315, 6936.982168094773, 6519.283131817817, 6599.217203711031, 4944.99019626236, 5248.478275200119, 5746.17191005516, 4533.022424621834, 4504.11720668192, 3999.383054712375, 4275.9470763777645, 5237.382014706325, 5653.804484648593, 5715.237210288257, 7099.934270518504, 4588.658809940213, 4091.955744943979, 3218.3811331950415, 3703.2809069045124, 6329.940058696128, 8216.774763672234, 4664.172991787797, 4779.081366824203, 7533.351918201078, 4187.405341430892, 9282.02014037333, 3330.3667752759507, 3070.363822937002, 4955.653959286915, 3779.477044912672, 2258.6388108649667, 5916.552138044221, 5821.417056241107, 4575.742689128766, 2389.5995589726754, 3882.0726006368704, 5004.357705373423, 6537.194931260887, 5178.689961830243, 3102.475083447916, 4551.650201876207, 3886.988742256385, 4154.03669657656, 5555.804313211216, 4361.81229163204, 206.5061962812863, 103.65534872053249, 4397.2300674836315, 5748.5545769615355, 3532.8252296200126, 4648.756309073012, 4593.280016703318, 2786.2584353656507, 10009.876278641179, 7852.715306473965, 3191.6188988425133, 990.1717757461383, 4701.88885125727, 6728.791100268947, 5950.761813311578, 6197.350557992927, 3760.677482416124, 5489.360943275102, 4100.367597242616, 3131.400771111537, 8050.274143719986, 5572.774424300942, 4522.258120298054, 3783.2734049913693, 4763.866130461365, 5859.06751208212, 6303.197627790701, 3974.71129868121, 6014.762033308939, 7268.721287686934, 2871.743784537404, 3170.406721693141, 5485.808099794727, 5951.678451405215, 3111.150277481224, 4281.9300289542925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39942118289265593, "mean_inference_ms": 0.9960974681746743, "mean_action_processing_ms": 0.16817726463123223, "mean_env_wait_ms": 0.0545894590976361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036388635635375977, "StateBufferConnector_ms": 0.0028499364852905273, "ViewRequirementAgentConnector_ms": 0.07343745231628418}, "num_episodes": 19, "episode_return_max": 21994.85093020493, "episode_return_min": 315.7873830764967, "episode_return_mean": 17828.054950816648}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.9340371256789, "num_env_steps_trained_throughput_per_sec": 492.9340371256789, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 7882.498, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7882.463, "sample_time_ms": 839.92, "learn_time_ms": 7030.986, "learn_throughput": 568.91, "synch_weights_time_ms": 11.083}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 182, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-01", "timestamp": 1723236781, "time_this_iter_s": 8.119433879852295, "time_total_s": 1389.035671710968, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bcfca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1389.035671710968, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 27.26666666666667, "ram_util_percent": 80.79166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8273073.385267857, "cur_kl_coeff": 448251903.714693, "cur_lr": 5.0000000000000016e-05, "total_loss": 112448.5908234127, "policy_loss": 0.0004002722502543182, "vf_loss": 9.843902652982681, "vf_explained_var": 0.03105396300396591, "kl": 0.00025083830233795136, "entropy": 0.9073713956686554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0030858481613298, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.992158271869023, "policy_loss": -0.00685276180205013, "vf_loss": 9.993694911400476, "vf_explained_var": -2.23045547803243e-06, "kl": 0.009208564095994612, "entropy": 1.424318331728379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "env_runners": {"episode_reward_max": 21994.85093020493, "episode_reward_min": 315.7873830764967, "episode_reward_mean": 17694.227090394932, "episode_len_mean": 194.65, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19465, "policy_reward_min": {"agent_policy": 5.6258380746779615, "adversary_policy": 103.65534872053249}, "policy_reward_max": {"agent_policy": 12939.581223979647, "adversary_policy": 10009.876278641179}, "policy_reward_mean": {"agent_policy": 8437.412765865854, "adversary_policy": 4628.407162264539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17401.92879888831, 17544.317343934254, 16972.983002425706, 19090.5958109591, 18246.813366810617, 17258.365788754203, 19104.282125297887, 18883.14532826573, 20287.600480721376, 20069.63709428766, 18073.28720081743, 18759.483096070227, 20149.049002139353, 15010.297839322879, 17258.138855611007, 21156.88979147657, 21140.549565574252, 17416.84781646903, 19804.062953411438, 16656.087199637863, 18173.104142532382, 16361.111844027459, 17819.674783999915, 16444.35730423386, 19764.760324919942, 18289.752683417533, 19957.289890835455, 16854.56005187743, 16446.053311883374, 20255.80903504129, 19340.445815867737, 15938.866723136158, 3525.7214160612098, 15853.897603092131, 17748.399806358673, 19975.32139467437, 15429.680452391158, 17600.36728623124, 17883.120502307, 20510.373651130285, 18485.033692760964, 19390.317235019775, 18495.68559101045, 18137.403440317434, 19377.44486096418, 19787.914780458574, 18026.24631055117, 16714.720907119838, 19888.31871231583, 18747.311788687224, 18329.540965161836, 17472.502399006917, 17176.167272991217, 16400.774434595965, 19608.574865824437, 16531.7351827036, 17942.154504127488, 19320.82558556122, 17166.1795394773, 18004.07574638866, 18503.94791536296, 315.7873830764967, 18539.36569121455, 17674.960853350905, 16792.311783171797, 21994.85093020493, 15132.307399477073, 18844.024474988222, 19750.484773650456, 17902.813106147056, 17036.918466503554, 19237.433400195274, 17923.8343929133, 18892.956019164754, 18094.175050309874, 20156.226029205947, 16985.710524401667, 19556.951680477203, 17122.936731872996, 18921.058624430596, 14742.313562520805, 18745.895385391173, 17590.946536877243, 15609.978705385049, 19347.5658830862, 16028.50730493819, 16469.49915681037, 17679.735712880753, 19113.465545978746, 18724.97443926857, 18269.57929820137, 17247.14961187252, 19552.043642604414, 19670.908203989744, 16180.146233453983, 15583.615534325756, 18567.626867940806, 18743.170978750568, 18733.26832886787, 3983.304576291695], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34], "policy_agent_policy_reward": [10712.549947752867, 8189.911862326529, 6895.498081797185, 8359.491750436104, 9301.907909391368, 10122.82118841274, 6993.694134251992, 7000.651495601349, 7761.103333111867, 7883.288977109593, 8872.676000595964, 7213.618068359286, 7013.948745741488, 10583.407068699604, 10405.663501411014, 6039.425630541036, 6826.990698019554, 9896.18419473233, 7283.4252221075385, 8642.868411238074, 9719.505273142757, 11837.489113652036, 8226.811464306023, 10115.940163781615, 8346.178782029394, 8478.537855006874, 6807.758323257252, 10601.75076467096, 11121.064844977285, 7565.740359066647, 7005.434418984333, 10719.322169894764, 213.7507587867007, 11155.907329046253, 9858.44002521652, 7684.327706206268, 9561.413557543756, 9322.859523438827, 9304.381053885747, 7054.108351217695, 6940.826292787569, 8395.667049764425, 9458.54595970669, 9862.073309227377, 8486.258361609285, 6972.74329965183, 9345.63175566696, 9793.05886702032, 5341.603889947435, 9304.057430075207, 6608.783705529881, 4860.115483357633, 9150.14949076724, 10362.65857881827, 7870.605671539111, 9566.392934602183, 9055.724198117145, 7604.940692470065, 9512.054254153161, 9963.050307555712, 8586.33131051973, 5.6258380746779615, 8393.581046769425, 9493.379314657946, 9412.773331102831, 4132.259345089768, 10950.516724888428, 7413.344523462005, 7602.372402345913, 8652.774680455848, 9805.150098149397, 5614.384832174373, 9618.302867623848, 8270.022376621226, 7816.2661238379005, 6872.742708210001, 10943.56001817113, 8119.465129277256, 9729.856425437456, 8669.600004746555, 12939.581223979647, 8576.05961675865, 9608.286330085004, 11874.659171558487, 8171.447316275367, 11152.52018564425, 9552.041627077879, 10321.246478695559, 6941.927997724954, 6880.534582307629, 9739.935723386647, 10071.559435110024, 8006.167262742178, 7913.037462173882, 11416.608434747503, 8969.39788710265, 7369.371704338924, 9242.270677683657, 5041.353866832803, 696.1709086272751], "policy_adversary_policy_reward": [3427.762947614449, 3261.615903521037, 5952.223761404427, 3402.181720203281, 2830.847378694796, 7246.6375419337555, 4963.932467989947, 5767.171592533025, 4110.482851088084, 4834.422606331144, 3116.2301650232903, 4019.314435318206, 4962.146501566928, 7148.441489478963, 7094.472965975223, 4788.02086668918, 6242.67364769887, 6283.823499910602, 6108.788208514164, 6077.559908663853, 5269.459623134986, 3931.151577086543, 4617.347472339334, 6928.517555371675, 6246.184753487137, 6888.915502910815, 868.1622155919835, 3558.72855503132, 3116.0032318800995, 3736.47212231994, 8043.047921525616, 7074.416239409923, 7049.374048053191, 7264.184819501528, 4245.951428998615, 3274.7121927380626, 6196.95098554236, 6323.686745761588, 2513.9515759069022, 5499.267212492867, 4382.119175888004, 4071.4796935016448, 2304.054738418806, 2219.5679919566537, 5915.324159424925, 3677.5391602689638, 3385.7634330202523, 2942.6537074319735, 5787.108112375332, 5631.473430515266, 4147.617059686564, 5663.597768724061, 7305.931723784859, 5843.599843793353, 3241.370424279718, 3011.438862926744, 2719.320652425876, 2605.667814480215, 6113.673411310326, 6576.395264664309, 7136.701204746621, 5198.3101921368, 3422.8134538361646, 1796.731099405226, 1727.1857555797337, 1584.7849016947748, 2986.228294684673, 1711.7619793612491, 4283.695598514431, 3606.264182627722, 5957.996453617018, 6332.997234851095, 4580.722066187194, 1287.5448286601904, 3458.2316625003104, 4819.27610029214, 4074.715148156918, 4504.024300264315, 6936.982168094773, 6519.283131817817, 6599.217203711031, 4944.99019626236, 5248.478275200119, 5746.17191005516, 4533.022424621834, 4504.11720668192, 3999.383054712375, 4275.9470763777645, 5237.382014706325, 5653.804484648593, 5715.237210288257, 7099.934270518504, 4588.658809940213, 4091.955744943979, 3218.3811331950415, 3703.2809069045124, 6329.940058696128, 8216.774763672234, 4664.172991787797, 4779.081366824203, 7533.351918201078, 4187.405341430892, 9282.02014037333, 3330.3667752759507, 3070.363822937002, 4955.653959286915, 3779.477044912672, 2258.6388108649667, 5916.552138044221, 5821.417056241107, 4575.742689128766, 2389.5995589726754, 3882.0726006368704, 5004.357705373423, 6537.194931260887, 5178.689961830243, 3102.475083447916, 4551.650201876207, 3886.988742256385, 4154.03669657656, 5555.804313211216, 4361.81229163204, 206.5061962812863, 103.65534872053249, 4397.2300674836315, 5748.5545769615355, 3532.8252296200126, 4648.756309073012, 4593.280016703318, 2786.2584353656507, 10009.876278641179, 7852.715306473965, 3191.6188988425133, 990.1717757461383, 4701.88885125727, 6728.791100268947, 5950.761813311578, 6197.350557992927, 3760.677482416124, 5489.360943275102, 4100.367597242616, 3131.400771111537, 8050.274143719986, 5572.774424300942, 4522.258120298054, 3783.2734049913693, 4763.866130461365, 5859.06751208212, 6303.197627790701, 3974.71129868121, 6014.762033308939, 7268.721287686934, 2871.743784537404, 3170.406721693141, 5485.808099794727, 5951.678451405215, 3111.150277481224, 4281.9300289542925, 5461.386060440908, 4790.072559243127, 1202.5543997512768, 600.1779387899113, 4669.144017912512, 5500.691750720005, 3448.8109131463098, 4533.849293645947, 2267.476452172464, 1467.8430816540688, 5221.692398497237, 5954.426168313572, 2989.6154380866788, 1886.3716812072194, 3426.0210126222782, 3491.4365171102354, 3769.6799279895704, 3588.8093061956515, 5043.496588270524, 7128.040959983299, 6692.307888130826, 5152.131968830165, 4402.199900344282, 4127.443674470434, 3105.0139881415275, 4070.576188620916, 6135.931179652724, 5409.945200209489, 5658.324148833473, 6099.546592982347, 2725.527188983442, 2038.0106097230275, 1441.4799105947905, 5172.737736628303, 4427.528909787535, 6770.726253814321, 4899.86494604729, 4601.035355019592, 9100.78175689815, 4591.132705136937, 1703.660132909531, 1583.473534754889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39947192054641667, "mean_inference_ms": 0.9964893320381438, "mean_action_processing_ms": 0.16819540801608596, "mean_env_wait_ms": 0.054609893382008626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036197900772094727, "StateBufferConnector_ms": 0.0027905702590942383, "ViewRequirementAgentConnector_ms": 0.07281172275543213}, "num_episodes": 21, "episode_return_max": 21994.85093020493, "episode_return_min": 315.7873830764967, "episode_return_mean": 17694.227090394932}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.8281465586805, "num_env_steps_trained_throughput_per_sec": 488.8281465586805, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2196000, "timers": {"training_iteration_time_ms": 7924.543, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7924.508, "sample_time_ms": 836.855, "learn_time_ms": 7076.105, "learn_throughput": 565.283, "synch_weights_time_ms": 11.071}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "done": false, "training_iteration": 183, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-09", "timestamp": 1723236789, "time_this_iter_s": 8.190332889556885, "time_total_s": 1397.226004600525, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bd70d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1397.226004600525, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 27.49166666666667, "ram_util_percent": 80.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3164018.6668568123, "cur_kl_coeff": 224125951.8573465, "cur_lr": 5.0000000000000016e-05, "total_loss": 35191.974849123675, "policy_loss": -0.0003882547024952829, "vf_loss": 9.895373634560398, "vf_explained_var": 0.024801232922014107, "kl": 0.0001569745917217843, "entropy": 0.899715679663199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0386831983923912, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996519000331562, "policy_loss": -0.0028202449184997628, "vf_loss": 9.990547224879265, "vf_explained_var": 4.590799411137899e-07, "kl": 0.015229498154561346, "entropy": 1.4570885916550955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 21994.85093020493, "episode_reward_min": 315.7873830764967, "episode_reward_mean": 17267.350785556817, "episode_len_mean": 191.11, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19111, "policy_reward_min": {"agent_policy": 4.8545895737298865, "adversary_policy": 103.65534872053249}, "policy_reward_max": {"agent_policy": 12939.581223979647, "adversary_policy": 10009.876278641179}, "policy_reward_mean": {"agent_policy": 8382.226010066828, "adversary_policy": 4442.562387744993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18173.104142532382, 16361.111844027459, 17819.674783999915, 16444.35730423386, 19764.760324919942, 18289.752683417533, 19957.289890835455, 16854.56005187743, 16446.053311883374, 20255.80903504129, 19340.445815867737, 15938.866723136158, 3525.7214160612098, 15853.897603092131, 17748.399806358673, 19975.32139467437, 15429.680452391158, 17600.36728623124, 17883.120502307, 20510.373651130285, 18485.033692760964, 19390.317235019775, 18495.68559101045, 18137.403440317434, 19377.44486096418, 19787.914780458574, 18026.24631055117, 16714.720907119838, 19888.31871231583, 18747.311788687224, 18329.540965161836, 17472.502399006917, 17176.167272991217, 16400.774434595965, 19608.574865824437, 16531.7351827036, 17942.154504127488, 19320.82558556122, 17166.1795394773, 18004.07574638866, 18503.94791536296, 315.7873830764967, 18539.36569121455, 17674.960853350905, 16792.311783171797, 21994.85093020493, 15132.307399477073, 18844.024474988222, 19750.484773650456, 17902.813106147056, 17036.918466503554, 19237.433400195274, 17923.8343929133, 18892.956019164754, 18094.175050309874, 20156.226029205947, 16985.710524401667, 19556.951680477203, 17122.936731872996, 18921.058624430596, 14742.313562520805, 18745.895385391173, 17590.946536877243, 15609.978705385049, 19347.5658830862, 16028.50730493819, 16469.49915681037, 17679.735712880753, 19113.465545978746, 18724.97443926857, 18269.57929820137, 17247.14961187252, 19552.043642604414, 19670.908203989744, 16180.146233453983, 15583.615534325756, 18567.626867940806, 18743.170978750568, 18733.26832886787, 3983.304576291695, 21207.705153567014, 16488.697385242627, 18018.870478881498, 16698.517533973692, 19964.606116207942, 16591.635134646287, 15859.549438560178, 18539.080551621173, 16696.00844647446, 21072.720634380632, 16001.358285272818, 17941.16026962633, 15381.53619530724, 17040.836156124486, 18914.853365524094, 18455.935355745958, 17467.894587472023, 320.48657420335235, 5136.586158662608, 19798.69415556913], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 28, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 43, 200], "policy_agent_policy_reward": [9719.505273142757, 11837.489113652036, 8226.811464306023, 10115.940163781615, 8346.178782029394, 8478.537855006874, 6807.758323257252, 10601.75076467096, 11121.064844977285, 7565.740359066647, 7005.434418984333, 10719.322169894764, 213.7507587867007, 11155.907329046253, 9858.44002521652, 7684.327706206268, 9561.413557543756, 9322.859523438827, 9304.381053885747, 7054.108351217695, 6940.826292787569, 8395.667049764425, 9458.54595970669, 9862.073309227377, 8486.258361609285, 6972.74329965183, 9345.63175566696, 9793.05886702032, 5341.603889947435, 9304.057430075207, 6608.783705529881, 4860.115483357633, 9150.14949076724, 10362.65857881827, 7870.605671539111, 9566.392934602183, 9055.724198117145, 7604.940692470065, 9512.054254153161, 9963.050307555712, 8586.33131051973, 5.6258380746779615, 8393.581046769425, 9493.379314657946, 9412.773331102831, 4132.259345089768, 10950.516724888428, 7413.344523462005, 7602.372402345913, 8652.774680455848, 9805.150098149397, 5614.384832174373, 9618.302867623848, 8270.022376621226, 7816.2661238379005, 6872.742708210001, 10943.56001817113, 8119.465129277256, 9729.856425437456, 8669.600004746555, 12939.581223979647, 8576.05961675865, 9608.286330085004, 11874.659171558487, 8171.447316275367, 11152.52018564425, 9552.041627077879, 10321.246478695559, 6941.927997724954, 6880.534582307629, 9739.935723386647, 10071.559435110024, 8006.167262742178, 7913.037462173882, 11416.608434747503, 8969.39788710265, 7369.371704338924, 9242.270677683657, 5041.353866832803, 696.1709086272751, 6490.964848114387, 9513.433021708677, 9910.56622856075, 9418.55422713693, 7746.678240258219, 9201.624774213948, 10256.494382509269, 8921.181534949003, 8921.570396465593, 6357.312500821454, 10541.657135766627, 9745.252126674926, 11666.34229363926, 9510.346490300648, 6054.527429006591, 8607.531952470505, 9431.77921549823, 4.8545895737298865, 479.54135539470894, 7700.237898671456], "policy_adversary_policy_reward": [4382.119175888004, 4071.4796935016448, 2304.054738418806, 2219.5679919566537, 5915.324159424925, 3677.5391602689638, 3385.7634330202523, 2942.6537074319735, 5787.108112375332, 5631.473430515266, 4147.617059686564, 5663.597768724061, 7305.931723784859, 5843.599843793353, 3241.370424279718, 3011.438862926744, 2719.320652425876, 2605.667814480215, 6113.673411310326, 6576.395264664309, 7136.701204746621, 5198.3101921368, 3422.8134538361646, 1796.731099405226, 1727.1857555797337, 1584.7849016947748, 2986.228294684673, 1711.7619793612491, 4283.695598514431, 3606.264182627722, 5957.996453617018, 6332.997234851095, 4580.722066187194, 1287.5448286601904, 3458.2316625003104, 4819.27610029214, 4074.715148156918, 4504.024300264315, 6936.982168094773, 6519.283131817817, 6599.217203711031, 4944.99019626236, 5248.478275200119, 5746.17191005516, 4533.022424621834, 4504.11720668192, 3999.383054712375, 4275.9470763777645, 5237.382014706325, 5653.804484648593, 5715.237210288257, 7099.934270518504, 4588.658809940213, 4091.955744943979, 3218.3811331950415, 3703.2809069045124, 6329.940058696128, 8216.774763672234, 4664.172991787797, 4779.081366824203, 7533.351918201078, 4187.405341430892, 9282.02014037333, 3330.3667752759507, 3070.363822937002, 4955.653959286915, 3779.477044912672, 2258.6388108649667, 5916.552138044221, 5821.417056241107, 4575.742689128766, 2389.5995589726754, 3882.0726006368704, 5004.357705373423, 6537.194931260887, 5178.689961830243, 3102.475083447916, 4551.650201876207, 3886.988742256385, 4154.03669657656, 5555.804313211216, 4361.81229163204, 206.5061962812863, 103.65534872053249, 4397.2300674836315, 5748.5545769615355, 3532.8252296200126, 4648.756309073012, 4593.280016703318, 2786.2584353656507, 10009.876278641179, 7852.715306473965, 3191.6188988425133, 990.1717757461383, 4701.88885125727, 6728.791100268947, 5950.761813311578, 6197.350557992927, 3760.677482416124, 5489.360943275102, 4100.367597242616, 3131.400771111537, 8050.274143719986, 5572.774424300942, 4522.258120298054, 3783.2734049913693, 4763.866130461365, 5859.06751208212, 6303.197627790701, 3974.71129868121, 6014.762033308939, 7268.721287686934, 2871.743784537404, 3170.406721693141, 5485.808099794727, 5951.678451405215, 3111.150277481224, 4281.9300289542925, 5461.386060440908, 4790.072559243127, 1202.5543997512768, 600.1779387899113, 4669.144017912512, 5500.691750720005, 3448.8109131463098, 4533.849293645947, 2267.476452172464, 1467.8430816540688, 5221.692398497237, 5954.426168313572, 2989.6154380866788, 1886.3716812072194, 3426.0210126222782, 3491.4365171102354, 3769.6799279895704, 3588.8093061956515, 5043.496588270524, 7128.040959983299, 6692.307888130826, 5152.131968830165, 4402.199900344282, 4127.443674470434, 3105.0139881415275, 4070.576188620916, 6135.931179652724, 5409.945200209489, 5658.324148833473, 6099.546592982347, 2725.527188983442, 2038.0106097230275, 1441.4799105947905, 5172.737736628303, 4427.528909787535, 6770.726253814321, 4899.86494604729, 4601.035355019592, 9100.78175689815, 4591.132705136937, 1703.660132909531, 1583.473534754889, 7580.272767428684, 7136.46753802399, 2429.483312712464, 4545.781050821466, 3996.664855194659, 4111.639395126031, 2575.2152630570786, 4704.748043779671, 6063.874213242555, 6154.053662707158, 2449.4995109153137, 4940.510849516996, 1717.4138148292786, 3885.6412412216764, 4411.77318659309, 5206.125830079056, 5220.565227265362, 2553.8728227435217, 7518.213996416587, 7197.194137142647, 1859.2226615418188, 3600.4784879643385, 3926.526407734846, 4269.381735216514, 1307.5354894983507, 2407.6584121695973, 4076.8511834131677, 3453.6384824106945, 7478.241579522998, 5382.084356994514, 4509.992777266187, 5338.410626009322, 4693.785084559321, 3342.330287414471, 207.2774447822344, 108.35453984738805, 2114.0053042877153, 2543.039498980186, 5954.9728752087385, 6143.483381688929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995192972173268, "mean_inference_ms": 0.9968332143136788, "mean_action_processing_ms": 0.16822376163205138, "mean_env_wait_ms": 0.054632720399650996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543376922607422, "StateBufferConnector_ms": 0.002766251564025879, "ViewRequirementAgentConnector_ms": 0.07476401329040527}, "num_episodes": 20, "episode_return_max": 21994.85093020493, "episode_return_min": 315.7873830764967, "episode_return_mean": 17267.350785556817}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.480747764094, "num_env_steps_trained_throughput_per_sec": 508.480747764094, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 7975.563, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7975.528, "sample_time_ms": 840.803, "learn_time_ms": 7122.893, "learn_throughput": 561.57, "synch_weights_time_ms": 11.348}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 184, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-17", "timestamp": 1723236797, "time_this_iter_s": 7.871521711349487, "time_total_s": 1405.0975263118744, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bd7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1405.0975263118744, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 29.354545454545452, "ram_util_percent": 80.60909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1253309.304265873, "cur_kl_coeff": 112062975.92867325, "cur_lr": 5.0000000000000016e-05, "total_loss": 11045.984585555143, "policy_loss": 0.00024074994553639382, "vf_loss": 9.803361957792252, "vf_explained_var": 0.01421181010821509, "kl": 9.848195511266274e-05, "entropy": 0.8969830874412779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0220330367796122, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.000255007545153, "policy_loss": -0.0024765251106146024, "vf_loss": 9.99334346652031, "vf_explained_var": 5.9819469849268595e-06, "kl": 0.016262035361918, "entropy": 1.4829186997065942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "env_runners": {"episode_reward_max": 21994.85093020493, "episode_reward_min": 315.7873830764967, "episode_reward_mean": 17392.503748200885, "episode_len_mean": 191.24, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 19124, "policy_reward_min": {"agent_policy": 4.8545895737298865, "adversary_policy": 103.65534872053249}, "policy_reward_max": {"agent_policy": 12939.581223979647, "adversary_policy": 10009.876278641179}, "policy_reward_mean": {"agent_policy": 8193.196879440173, "adversary_policy": 4599.653434380356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18495.68559101045, 18137.403440317434, 19377.44486096418, 19787.914780458574, 18026.24631055117, 16714.720907119838, 19888.31871231583, 18747.311788687224, 18329.540965161836, 17472.502399006917, 17176.167272991217, 16400.774434595965, 19608.574865824437, 16531.7351827036, 17942.154504127488, 19320.82558556122, 17166.1795394773, 18004.07574638866, 18503.94791536296, 315.7873830764967, 18539.36569121455, 17674.960853350905, 16792.311783171797, 21994.85093020493, 15132.307399477073, 18844.024474988222, 19750.484773650456, 17902.813106147056, 17036.918466503554, 19237.433400195274, 17923.8343929133, 18892.956019164754, 18094.175050309874, 20156.226029205947, 16985.710524401667, 19556.951680477203, 17122.936731872996, 18921.058624430596, 14742.313562520805, 18745.895385391173, 17590.946536877243, 15609.978705385049, 19347.5658830862, 16028.50730493819, 16469.49915681037, 17679.735712880753, 19113.465545978746, 18724.97443926857, 18269.57929820137, 17247.14961187252, 19552.043642604414, 19670.908203989744, 16180.146233453983, 15583.615534325756, 18567.626867940806, 18743.170978750568, 18733.26832886787, 3983.304576291695, 21207.705153567014, 16488.697385242627, 18018.870478881498, 16698.517533973692, 19964.606116207942, 16591.635134646287, 15859.549438560178, 18539.080551621173, 16696.00844647446, 21072.720634380632, 16001.358285272818, 17941.16026962633, 15381.53619530724, 17040.836156124486, 18914.853365524094, 18455.935355745958, 17467.894587472023, 320.48657420335235, 5136.586158662608, 19798.69415556913, 17059.927499878286, 19426.66514901733, 20644.841046374106, 15367.770991091782, 18834.398651979078, 19545.41946066302, 18040.56374755499, 17869.427514192117, 18987.10354701081, 4529.0457918202, 18330.16131940834, 17908.802850243064, 19028.107765748864, 21048.692465443703, 18366.637968913543, 18596.28398901026, 18459.99756237401, 20741.471620077213, 17633.457377923296, 17070.01543894917, 18965.097796293736, 18109.425662239348], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9458.54595970669, 9862.073309227377, 8486.258361609285, 6972.74329965183, 9345.63175566696, 9793.05886702032, 5341.603889947435, 9304.057430075207, 6608.783705529881, 4860.115483357633, 9150.14949076724, 10362.65857881827, 7870.605671539111, 9566.392934602183, 9055.724198117145, 7604.940692470065, 9512.054254153161, 9963.050307555712, 8586.33131051973, 5.6258380746779615, 8393.581046769425, 9493.379314657946, 9412.773331102831, 4132.259345089768, 10950.516724888428, 7413.344523462005, 7602.372402345913, 8652.774680455848, 9805.150098149397, 5614.384832174373, 9618.302867623848, 8270.022376621226, 7816.2661238379005, 6872.742708210001, 10943.56001817113, 8119.465129277256, 9729.856425437456, 8669.600004746555, 12939.581223979647, 8576.05961675865, 9608.286330085004, 11874.659171558487, 8171.447316275367, 11152.52018564425, 9552.041627077879, 10321.246478695559, 6941.927997724954, 6880.534582307629, 9739.935723386647, 10071.559435110024, 8006.167262742178, 7913.037462173882, 11416.608434747503, 8969.39788710265, 7369.371704338924, 9242.270677683657, 5041.353866832803, 696.1709086272751, 6490.964848114387, 9513.433021708677, 9910.56622856075, 9418.55422713693, 7746.678240258219, 9201.624774213948, 10256.494382509269, 8921.181534949003, 8921.570396465593, 6357.312500821454, 10541.657135766627, 9745.252126674926, 11666.34229363926, 9510.346490300648, 6054.527429006591, 8607.531952470505, 9431.77921549823, 4.8545895737298865, 479.54135539470894, 7700.237898671456, 6862.2603521093215, 6110.77472101246, 6749.625875673654, 11577.707200362376, 5027.31010205133, 6176.492664349544, 8537.1398489221, 10219.990842536106, 8844.264689551683, 766.1331952617383, 7503.918742674455, 9203.321934520622, 8122.397587437828, 6352.929157657583, 9008.096488938443, 9076.495184502655, 7585.871641074315, 7046.128138218651, 8955.41262479725, 10456.976035850268, 7381.382393832146, 9569.672696663602], "policy_adversary_policy_reward": [4533.022424621834, 4504.11720668192, 3999.383054712375, 4275.9470763777645, 5237.382014706325, 5653.804484648593, 5715.237210288257, 7099.934270518504, 4588.658809940213, 4091.955744943979, 3218.3811331950415, 3703.2809069045124, 6329.940058696128, 8216.774763672234, 4664.172991787797, 4779.081366824203, 7533.351918201078, 4187.405341430892, 9282.02014037333, 3330.3667752759507, 3070.363822937002, 4955.653959286915, 3779.477044912672, 2258.6388108649667, 5916.552138044221, 5821.417056241107, 4575.742689128766, 2389.5995589726754, 3882.0726006368704, 5004.357705373423, 6537.194931260887, 5178.689961830243, 3102.475083447916, 4551.650201876207, 3886.988742256385, 4154.03669657656, 5555.804313211216, 4361.81229163204, 206.5061962812863, 103.65534872053249, 4397.2300674836315, 5748.5545769615355, 3532.8252296200126, 4648.756309073012, 4593.280016703318, 2786.2584353656507, 10009.876278641179, 7852.715306473965, 3191.6188988425133, 990.1717757461383, 4701.88885125727, 6728.791100268947, 5950.761813311578, 6197.350557992927, 3760.677482416124, 5489.360943275102, 4100.367597242616, 3131.400771111537, 8050.274143719986, 5572.774424300942, 4522.258120298054, 3783.2734049913693, 4763.866130461365, 5859.06751208212, 6303.197627790701, 3974.71129868121, 6014.762033308939, 7268.721287686934, 2871.743784537404, 3170.406721693141, 5485.808099794727, 5951.678451405215, 3111.150277481224, 4281.9300289542925, 5461.386060440908, 4790.072559243127, 1202.5543997512768, 600.1779387899113, 4669.144017912512, 5500.691750720005, 3448.8109131463098, 4533.849293645947, 2267.476452172464, 1467.8430816540688, 5221.692398497237, 5954.426168313572, 2989.6154380866788, 1886.3716812072194, 3426.0210126222782, 3491.4365171102354, 3769.6799279895704, 3588.8093061956515, 5043.496588270524, 7128.040959983299, 6692.307888130826, 5152.131968830165, 4402.199900344282, 4127.443674470434, 3105.0139881415275, 4070.576188620916, 6135.931179652724, 5409.945200209489, 5658.324148833473, 6099.546592982347, 2725.527188983442, 2038.0106097230275, 1441.4799105947905, 5172.737736628303, 4427.528909787535, 6770.726253814321, 4899.86494604729, 4601.035355019592, 9100.78175689815, 4591.132705136937, 1703.660132909531, 1583.473534754889, 7580.272767428684, 7136.46753802399, 2429.483312712464, 4545.781050821466, 3996.664855194659, 4111.639395126031, 2575.2152630570786, 4704.748043779671, 6063.874213242555, 6154.053662707158, 2449.4995109153137, 4940.510849516996, 1717.4138148292786, 3885.6412412216764, 4411.77318659309, 5206.125830079056, 5220.565227265362, 2553.8728227435217, 7518.213996416587, 7197.194137142647, 1859.2226615418188, 3600.4784879643385, 3926.526407734846, 4269.381735216514, 1307.5354894983507, 2407.6584121695973, 4076.8511834131677, 3453.6384824106945, 7478.241579522998, 5382.084356994514, 4509.992777266187, 5338.410626009322, 4693.785084559321, 3342.330287414471, 207.2774447822344, 108.35453984738805, 2114.0053042877153, 2543.039498980186, 5954.9728752087385, 6143.483381688929, 7279.875271621622, 2917.7918761473925, 8031.360902718486, 5284.529525286303, 6557.987979915606, 7337.227190784853, 1225.6353673608887, 2564.428423368551, 4692.263028248135, 9114.825521679626, 6314.985035173236, 7053.941761140245, 4208.818836036764, 5294.605062596082, 3922.144781194841, 3727.291890461201, 4859.602526840522, 5283.236330618617, 2131.7556763426333, 1631.1569202158294, 4344.410678417336, 6481.831898316559, 4522.739030436944, 4182.741885285504, 5994.026112561208, 4911.684065749874, 7283.917602365795, 7411.845705420392, 4631.6366639079, 4726.904816067186, 4480.939102304492, 5038.849702203156, 5149.92915285727, 5724.196768442387, 6707.481188200709, 6987.862293657851, 4066.964535047389, 4611.0802180786395, 3685.15958788067, 2927.879815218239, 4872.6022701519405, 6711.1131323096215, 4441.959648851004, 4097.793316724733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39949216166741297, "mean_inference_ms": 0.9969193922010449, "mean_action_processing_ms": 0.16817626705506733, "mean_env_wait_ms": 0.05467404219572161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003413081169128418, "StateBufferConnector_ms": 0.0026813745498657227, "ViewRequirementAgentConnector_ms": 0.0717545747756958}, "num_episodes": 22, "episode_return_max": 21994.85093020493, "episode_return_min": 315.7873830764967, "episode_return_mean": 17392.503748200885}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.9588558396741, "num_env_steps_trained_throughput_per_sec": 510.9588558396741, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2220000, "timers": {"training_iteration_time_ms": 7994.845, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7994.808, "sample_time_ms": 840.451, "learn_time_ms": 7142.847, "learn_throughput": 560.001, "synch_weights_time_ms": 11.028}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "done": false, "training_iteration": 185, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-25", "timestamp": 1723236805, "time_this_iter_s": 7.834007024765015, "time_total_s": 1412.9315333366394, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bd7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1412.9315333366394, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 32.945454545454545, "ram_util_percent": 80.98181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 461688.8855716766, "cur_kl_coeff": 56031487.964336626, "cur_lr": 5.0000000000000016e-05, "total_loss": 3323.218299308656, "policy_loss": -0.00011357051091239092, "vf_loss": 9.756238029621265, "vf_explained_var": 0.015892758918186974, "kl": 5.9135716248189084e-05, "entropy": 0.8961916859187777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0396866396379967, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.999960427482923, "policy_loss": -0.005048559303880514, "vf_loss": 9.995786703626315, "vf_explained_var": -5.727323393026988e-06, "kl": 0.01597479089687113, "entropy": 1.5087785682330528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": 24811.252836264208, "episode_reward_min": 231.27269658122793, "episode_reward_mean": 17520.851080287313, "episode_len_mean": 191.23, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19123, "policy_reward_min": {"agent_policy": 3.1200875027320367, "adversary_policy": 89.85134034391842}, "policy_reward_max": {"agent_policy": 12939.581223979647, "adversary_policy": 12308.023589427261}, "policy_reward_mean": {"agent_policy": 8050.1077090122435, "adversary_policy": 4735.371685637533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21994.85093020493, 15132.307399477073, 18844.024474988222, 19750.484773650456, 17902.813106147056, 17036.918466503554, 19237.433400195274, 17923.8343929133, 18892.956019164754, 18094.175050309874, 20156.226029205947, 16985.710524401667, 19556.951680477203, 17122.936731872996, 18921.058624430596, 14742.313562520805, 18745.895385391173, 17590.946536877243, 15609.978705385049, 19347.5658830862, 16028.50730493819, 16469.49915681037, 17679.735712880753, 19113.465545978746, 18724.97443926857, 18269.57929820137, 17247.14961187252, 19552.043642604414, 19670.908203989744, 16180.146233453983, 15583.615534325756, 18567.626867940806, 18743.170978750568, 18733.26832886787, 3983.304576291695, 21207.705153567014, 16488.697385242627, 18018.870478881498, 16698.517533973692, 19964.606116207942, 16591.635134646287, 15859.549438560178, 18539.080551621173, 16696.00844647446, 21072.720634380632, 16001.358285272818, 17941.16026962633, 15381.53619530724, 17040.836156124486, 18914.853365524094, 18455.935355745958, 17467.894587472023, 320.48657420335235, 5136.586158662608, 19798.69415556913, 17059.927499878286, 19426.66514901733, 20644.841046374106, 15367.770991091782, 18834.398651979078, 19545.41946066302, 18040.56374755499, 17869.427514192117, 18987.10354701081, 4529.0457918202, 18330.16131940834, 17908.802850243064, 19028.107765748864, 21048.692465443703, 18366.637968913543, 18596.28398901026, 18459.99756237401, 20741.471620077213, 17633.457377923296, 17070.01543894917, 18965.097796293736, 18109.425662239348, 20557.010517488852, 23665.692608081426, 17518.47466477136, 16356.535549315686, 17754.201865988427, 18553.53826777293, 24811.252836264208, 17278.991521100023, 21040.771051642525, 17430.76581927075, 231.27269658122793, 17955.55632472824, 16591.150083659206, 17939.90162020422, 20917.308721134654, 17172.606000020245, 14940.734090887761, 15776.499705946833, 18072.729366663803, 19426.17073729934, 19338.19447393709, 18829.47793610697, 19629.84726321701], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [4132.259345089768, 10950.516724888428, 7413.344523462005, 7602.372402345913, 8652.774680455848, 9805.150098149397, 5614.384832174373, 9618.302867623848, 8270.022376621226, 7816.2661238379005, 6872.742708210001, 10943.56001817113, 8119.465129277256, 9729.856425437456, 8669.600004746555, 12939.581223979647, 8576.05961675865, 9608.286330085004, 11874.659171558487, 8171.447316275367, 11152.52018564425, 9552.041627077879, 10321.246478695559, 6941.927997724954, 6880.534582307629, 9739.935723386647, 10071.559435110024, 8006.167262742178, 7913.037462173882, 11416.608434747503, 8969.39788710265, 7369.371704338924, 9242.270677683657, 5041.353866832803, 696.1709086272751, 6490.964848114387, 9513.433021708677, 9910.56622856075, 9418.55422713693, 7746.678240258219, 9201.624774213948, 10256.494382509269, 8921.181534949003, 8921.570396465593, 6357.312500821454, 10541.657135766627, 9745.252126674926, 11666.34229363926, 9510.346490300648, 6054.527429006591, 8607.531952470505, 9431.77921549823, 4.8545895737298865, 479.54135539470894, 7700.237898671456, 6862.2603521093215, 6110.77472101246, 6749.625875673654, 11577.707200362376, 5027.31010205133, 6176.492664349544, 8537.1398489221, 10219.990842536106, 8844.264689551683, 766.1331952617383, 7503.918742674455, 9203.321934520622, 8122.397587437828, 6352.929157657583, 9008.096488938443, 9076.495184502655, 7585.871641074315, 7046.128138218651, 8955.41262479725, 10456.976035850268, 7381.382393832146, 9569.672696663602, 6879.294255651579, 3837.5282080522875, 9905.762564803057, 10753.797365060336, 8190.5947273504935, 8878.050013119131, 1813.6666348852934, 10532.798436345844, 4657.97540778448, 7699.549120182865, 3.1200875027320367, 8104.537410680197, 8988.740738237688, 9398.323773530876, 6884.823291161491, 8410.40032473176, 12782.28315971628, 9306.91216922899, 9021.117367968916, 4644.816626932845, 8867.774969909939, 8077.344372179981, 7062.010963130245], "policy_adversary_policy_reward": [10009.876278641179, 7852.715306473965, 3191.6188988425133, 990.1717757461383, 4701.88885125727, 6728.791100268947, 5950.761813311578, 6197.350557992927, 3760.677482416124, 5489.360943275102, 4100.367597242616, 3131.400771111537, 8050.274143719986, 5572.774424300942, 4522.258120298054, 3783.2734049913693, 4763.866130461365, 5859.06751208212, 6303.197627790701, 3974.71129868121, 6014.762033308939, 7268.721287686934, 2871.743784537404, 3170.406721693141, 5485.808099794727, 5951.678451405215, 3111.150277481224, 4281.9300289542925, 5461.386060440908, 4790.072559243127, 1202.5543997512768, 600.1779387899113, 4669.144017912512, 5500.691750720005, 3448.8109131463098, 4533.849293645947, 2267.476452172464, 1467.8430816540688, 5221.692398497237, 5954.426168313572, 2989.6154380866788, 1886.3716812072194, 3426.0210126222782, 3491.4365171102354, 3769.6799279895704, 3588.8093061956515, 5043.496588270524, 7128.040959983299, 6692.307888130826, 5152.131968830165, 4402.199900344282, 4127.443674470434, 3105.0139881415275, 4070.576188620916, 6135.931179652724, 5409.945200209489, 5658.324148833473, 6099.546592982347, 2725.527188983442, 2038.0106097230275, 1441.4799105947905, 5172.737736628303, 4427.528909787535, 6770.726253814321, 4899.86494604729, 4601.035355019592, 9100.78175689815, 4591.132705136937, 1703.660132909531, 1583.473534754889, 7580.272767428684, 7136.46753802399, 2429.483312712464, 4545.781050821466, 3996.664855194659, 4111.639395126031, 2575.2152630570786, 4704.748043779671, 6063.874213242555, 6154.053662707158, 2449.4995109153137, 4940.510849516996, 1717.4138148292786, 3885.6412412216764, 4411.77318659309, 5206.125830079056, 5220.565227265362, 2553.8728227435217, 7518.213996416587, 7197.194137142647, 1859.2226615418188, 3600.4784879643385, 3926.526407734846, 4269.381735216514, 1307.5354894983507, 2407.6584121695973, 4076.8511834131677, 3453.6384824106945, 7478.241579522998, 5382.084356994514, 4509.992777266187, 5338.410626009322, 4693.785084559321, 3342.330287414471, 207.2774447822344, 108.35453984738805, 2114.0053042877153, 2543.039498980186, 5954.9728752087385, 6143.483381688929, 7279.875271621622, 2917.7918761473925, 8031.360902718486, 5284.529525286303, 6557.987979915606, 7337.227190784853, 1225.6353673608887, 2564.428423368551, 4692.263028248135, 9114.825521679626, 6314.985035173236, 7053.941761140245, 4208.818836036764, 5294.605062596082, 3922.144781194841, 3727.291890461201, 4859.602526840522, 5283.236330618617, 2131.7556763426333, 1631.1569202158294, 4344.410678417336, 6481.831898316559, 4522.739030436944, 4182.741885285504, 5994.026112561208, 4911.684065749874, 7283.917602365795, 7411.845705420392, 4631.6366639079, 4726.904816067186, 4480.939102304492, 5038.849702203156, 5149.92915285727, 5724.196768442387, 6707.481188200709, 6987.862293657851, 4066.964535047389, 4611.0802180786395, 3685.15958788067, 2927.879815218239, 4872.6022701519405, 6711.1131323096215, 4441.959648851004, 4097.793316724733, 7043.380726042486, 6634.335535794735, 10045.096317043617, 9783.068082985581, 4213.328710847613, 3399.3833891206345, 3388.338258670628, 2214.3999255847702, 3626.1343944931214, 5937.472744144832, 5077.31091020262, 4598.177344451176, 10689.562611951655, 12308.023589427261, 3272.451443125293, 3473.7416416288725, 6898.635427911557, 9484.160215946464, 3288.6301955397967, 6442.586503548087, 89.85134034391842, 138.3012687345775, 3861.137499839048, 5989.881414209004, 3885.4718636661214, 3716.9374817553967, 4729.920296860491, 3811.6575498128136, 6798.295949347289, 7234.189480625913, 3030.4703762893027, 5731.735298999187, 1359.8524640146338, 798.5984671568567, 4835.223454501956, 1634.36408221591, 4041.4844238948667, 5010.127574800026, 9497.060602853535, 5284.293507512939, 5270.286143445058, 5200.133360582125, 4742.858905282018, 6009.27465864496, 5487.711639486012, 7080.124660600706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39944711295938434, "mean_inference_ms": 0.9969817336926396, "mean_action_processing_ms": 0.16820422357561882, "mean_env_wait_ms": 0.0546260652166385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033559799194335938, "StateBufferConnector_ms": 0.0025604963302612305, "ViewRequirementAgentConnector_ms": 0.07072925567626953}, "num_episodes": 23, "episode_return_max": 24811.252836264208, "episode_return_min": 231.27269658122793, "episode_return_mean": 17520.851080287313}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.2793749320695, "num_env_steps_trained_throughput_per_sec": 534.2793749320695, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 7985.367, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7985.33, "sample_time_ms": 828.21, "learn_time_ms": 7145.953, "learn_throughput": 559.757, "synch_weights_time_ms": 10.663}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 186, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-33", "timestamp": 1723236813, "time_this_iter_s": 7.490838050842285, "time_total_s": 1420.4223713874817, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bcff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1420.4223713874817, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 27.08181818181818, "ram_util_percent": 80.90909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201173.59272796792, "cur_kl_coeff": 28015743.982168313, "cur_lr": 5.0000000000000016e-05, "total_loss": 1038.2062851678756, "policy_loss": -7.660044369499676e-05, "vf_loss": 9.777133938622853, "vf_explained_var": 0.011860776010644499, "kl": 3.6708974369469584e-05, "entropy": 0.8973136663752258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.04355249752601, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00147335032622, "policy_loss": -0.0011861151302582583, "vf_loss": 9.994101628661156, "vf_explained_var": -4.662517458200455e-05, "kl": 0.014823823004068497, "entropy": 1.4940494142472744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "env_runners": {"episode_reward_max": 24811.252836264208, "episode_reward_min": 231.27269658122793, "episode_reward_mean": 17570.233682887443, "episode_len_mean": 189.8, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 18980, "policy_reward_min": {"agent_policy": 3.1200875027320367, "adversary_policy": 89.85134034391842}, "policy_reward_max": {"agent_policy": 12782.28315971628, "adversary_policy": 12308.023589427261}, "policy_reward_mean": {"agent_policy": 7830.931876891708, "adversary_policy": 4869.650902997869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19347.5658830862, 16028.50730493819, 16469.49915681037, 17679.735712880753, 19113.465545978746, 18724.97443926857, 18269.57929820137, 17247.14961187252, 19552.043642604414, 19670.908203989744, 16180.146233453983, 15583.615534325756, 18567.626867940806, 18743.170978750568, 18733.26832886787, 3983.304576291695, 21207.705153567014, 16488.697385242627, 18018.870478881498, 16698.517533973692, 19964.606116207942, 16591.635134646287, 15859.549438560178, 18539.080551621173, 16696.00844647446, 21072.720634380632, 16001.358285272818, 17941.16026962633, 15381.53619530724, 17040.836156124486, 18914.853365524094, 18455.935355745958, 17467.894587472023, 320.48657420335235, 5136.586158662608, 19798.69415556913, 17059.927499878286, 19426.66514901733, 20644.841046374106, 15367.770991091782, 18834.398651979078, 19545.41946066302, 18040.56374755499, 17869.427514192117, 18987.10354701081, 4529.0457918202, 18330.16131940834, 17908.802850243064, 19028.107765748864, 21048.692465443703, 18366.637968913543, 18596.28398901026, 18459.99756237401, 20741.471620077213, 17633.457377923296, 17070.01543894917, 18965.097796293736, 18109.425662239348, 20557.010517488852, 23665.692608081426, 17518.47466477136, 16356.535549315686, 17754.201865988427, 18553.53826777293, 24811.252836264208, 17278.991521100023, 21040.771051642525, 17430.76581927075, 231.27269658122793, 17955.55632472824, 16591.150083659206, 17939.90162020422, 20917.308721134654, 17172.606000020245, 14940.734090887761, 15776.499705946833, 18072.729366663803, 19426.17073729934, 19338.19447393709, 18829.47793610697, 19629.84726321701, 18437.242102795462, 21836.879120610945, 16226.263957694364, 21047.451500332783, 18319.253448541862, 20311.29119214192, 16905.09188987215, 16704.11162500699, 18413.06130879503, 16781.30911346493, 22185.886348996504, 16428.38777226842, 6526.755362573708, 16749.376037784572, 19029.2907313394, 23612.928029830764, 20945.414567300842, 22265.852981459142, 16454.228963320667], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 34, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8171.447316275367, 11152.52018564425, 9552.041627077879, 10321.246478695559, 6941.927997724954, 6880.534582307629, 9739.935723386647, 10071.559435110024, 8006.167262742178, 7913.037462173882, 11416.608434747503, 8969.39788710265, 7369.371704338924, 9242.270677683657, 5041.353866832803, 696.1709086272751, 6490.964848114387, 9513.433021708677, 9910.56622856075, 9418.55422713693, 7746.678240258219, 9201.624774213948, 10256.494382509269, 8921.181534949003, 8921.570396465593, 6357.312500821454, 10541.657135766627, 9745.252126674926, 11666.34229363926, 9510.346490300648, 6054.527429006591, 8607.531952470505, 9431.77921549823, 4.8545895737298865, 479.54135539470894, 7700.237898671456, 6862.2603521093215, 6110.77472101246, 6749.625875673654, 11577.707200362376, 5027.31010205133, 6176.492664349544, 8537.1398489221, 10219.990842536106, 8844.264689551683, 766.1331952617383, 7503.918742674455, 9203.321934520622, 8122.397587437828, 6352.929157657583, 9008.096488938443, 9076.495184502655, 7585.871641074315, 7046.128138218651, 8955.41262479725, 10456.976035850268, 7381.382393832146, 9569.672696663602, 6879.294255651579, 3837.5282080522875, 9905.762564803057, 10753.797365060336, 8190.5947273504935, 8878.050013119131, 1813.6666348852934, 10532.798436345844, 4657.97540778448, 7699.549120182865, 3.1200875027320367, 8104.537410680197, 8988.740738237688, 9398.323773530876, 6884.823291161491, 8410.40032473176, 12782.28315971628, 9306.91216922899, 9021.117367968916, 4644.816626932845, 8867.774969909939, 8077.344372179981, 7062.010963130245, 7858.4138029641845, 4546.14810757969, 9375.054910406963, 6071.426455621754, 9367.833345236348, 7714.922109221688, 8886.331196455216, 9319.817651668227, 8224.055447747152, 10726.325057257369, 5463.68422284737, 9786.68852540485, 1114.4624698323619, 11069.004069543442, 8472.876862285271, 3762.6317693225415, 6915.178464804528, 5634.850804413947, 10981.91611820633], "policy_adversary_policy_reward": [5221.692398497237, 5954.426168313572, 2989.6154380866788, 1886.3716812072194, 3426.0210126222782, 3491.4365171102354, 3769.6799279895704, 3588.8093061956515, 5043.496588270524, 7128.040959983299, 6692.307888130826, 5152.131968830165, 4402.199900344282, 4127.443674470434, 3105.0139881415275, 4070.576188620916, 6135.931179652724, 5409.945200209489, 5658.324148833473, 6099.546592982347, 2725.527188983442, 2038.0106097230275, 1441.4799105947905, 5172.737736628303, 4427.528909787535, 6770.726253814321, 4899.86494604729, 4601.035355019592, 9100.78175689815, 4591.132705136937, 1703.660132909531, 1583.473534754889, 7580.272767428684, 7136.46753802399, 2429.483312712464, 4545.781050821466, 3996.664855194659, 4111.639395126031, 2575.2152630570786, 4704.748043779671, 6063.874213242555, 6154.053662707158, 2449.4995109153137, 4940.510849516996, 1717.4138148292786, 3885.6412412216764, 4411.77318659309, 5206.125830079056, 5220.565227265362, 2553.8728227435217, 7518.213996416587, 7197.194137142647, 1859.2226615418188, 3600.4784879643385, 3926.526407734846, 4269.381735216514, 1307.5354894983507, 2407.6584121695973, 4076.8511834131677, 3453.6384824106945, 7478.241579522998, 5382.084356994514, 4509.992777266187, 5338.410626009322, 4693.785084559321, 3342.330287414471, 207.2774447822344, 108.35453984738805, 2114.0053042877153, 2543.039498980186, 5954.9728752087385, 6143.483381688929, 7279.875271621622, 2917.7918761473925, 8031.360902718486, 5284.529525286303, 6557.987979915606, 7337.227190784853, 1225.6353673608887, 2564.428423368551, 4692.263028248135, 9114.825521679626, 6314.985035173236, 7053.941761140245, 4208.818836036764, 5294.605062596082, 3922.144781194841, 3727.291890461201, 4859.602526840522, 5283.236330618617, 2131.7556763426333, 1631.1569202158294, 4344.410678417336, 6481.831898316559, 4522.739030436944, 4182.741885285504, 5994.026112561208, 4911.684065749874, 7283.917602365795, 7411.845705420392, 4631.6366639079, 4726.904816067186, 4480.939102304492, 5038.849702203156, 5149.92915285727, 5724.196768442387, 6707.481188200709, 6987.862293657851, 4066.964535047389, 4611.0802180786395, 3685.15958788067, 2927.879815218239, 4872.6022701519405, 6711.1131323096215, 4441.959648851004, 4097.793316724733, 7043.380726042486, 6634.335535794735, 10045.096317043617, 9783.068082985581, 4213.328710847613, 3399.3833891206345, 3388.338258670628, 2214.3999255847702, 3626.1343944931214, 5937.472744144832, 5077.31091020262, 4598.177344451176, 10689.562611951655, 12308.023589427261, 3272.451443125293, 3473.7416416288725, 6898.635427911557, 9484.160215946464, 3288.6301955397967, 6442.586503548087, 89.85134034391842, 138.3012687345775, 3861.137499839048, 5989.881414209004, 3885.4718636661214, 3716.9374817553967, 4729.920296860491, 3811.6575498128136, 6798.295949347289, 7234.189480625913, 3030.4703762893027, 5731.735298999187, 1359.8524640146338, 798.5984671568567, 4835.223454501956, 1634.36408221591, 4041.4844238948667, 5010.127574800026, 9497.060602853535, 5284.293507512939, 5270.286143445058, 5200.133360582125, 4742.858905282018, 6009.27465864496, 5487.711639486012, 7080.124660600706, 4618.641988575352, 5960.18631125589, 8593.348540778896, 8697.3824722523, 4680.290058725777, 2170.9189885616197, 8069.770750951631, 6906.254293759406, 4762.601390690487, 4188.818712615022, 6218.993579700146, 6377.375503220124, 5247.085775213721, 2771.6749182032104, 3790.985325961824, 3593.308647376915, 4270.925685064069, 5918.080175983802, 3088.977339797044, 2966.0067164104657, 8542.427682156036, 8179.774443993167, 4355.447098326116, 2286.252148537479, 2741.203497733486, 2671.08939500786, 3073.1315541874824, 2607.2404140536546, 4940.861065157069, 5615.55280389705, 9552.086366576503, 10298.209893931667, 7191.963624815853, 6838.272477680461, 8395.92618581879, 8235.075991226362, 3017.484380574645, 2454.828464539695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39941743607659375, "mean_inference_ms": 0.9969300803605441, "mean_action_processing_ms": 0.16816517421638616, "mean_env_wait_ms": 0.054631088385497545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033763647079467773, "StateBufferConnector_ms": 0.002545952796936035, "ViewRequirementAgentConnector_ms": 0.07168924808502197}, "num_episodes": 19, "episode_return_max": 24811.252836264208, "episode_return_min": 231.27269658122793, "episode_return_mean": 17570.233682887443}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.3731715083567, "num_env_steps_trained_throughput_per_sec": 509.3731715083567, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2244000, "timers": {"training_iteration_time_ms": 7985.089, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7985.052, "sample_time_ms": 825.993, "learn_time_ms": 7147.799, "learn_throughput": 559.613, "synch_weights_time_ms": 10.766}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "done": false, "training_iteration": 187, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-41", "timestamp": 1723236821, "time_this_iter_s": 7.857571125030518, "time_total_s": 1428.2799425125122, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bd7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1428.2799425125122, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 26.075, "ram_util_percent": 80.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87609.30401333602, "cur_kl_coeff": 14007871.991084157, "cur_lr": 5.0000000000000016e-05, "total_loss": 363.7862372100669, "policy_loss": 0.00025552994073935284, "vf_loss": 9.91595113340509, "vf_explained_var": 0.017876965785152698, "kl": 2.526222616185406e-05, "entropy": 0.8978528973286745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9955891405853132, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004076113303503, "policy_loss": -0.0030027992174533817, "vf_loss": 10.0, "vf_explained_var": -7.75262713432312e-05, "kl": 0.012262058008733827, "entropy": 1.4781483384470144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 24811.252836264208, "episode_reward_min": 231.27269658122793, "episode_reward_mean": 17908.44799149609, "episode_len_mean": 191.46, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19146, "policy_reward_min": {"agent_policy": 3.1200875027320367, "adversary_policy": 89.85134034391842}, "policy_reward_max": {"agent_policy": 12782.28315971628, "adversary_policy": 12308.023589427261}, "policy_reward_mean": {"agent_policy": 7738.237135788029, "adversary_policy": 5085.1054278540305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19964.606116207942, 16591.635134646287, 15859.549438560178, 18539.080551621173, 16696.00844647446, 21072.720634380632, 16001.358285272818, 17941.16026962633, 15381.53619530724, 17040.836156124486, 18914.853365524094, 18455.935355745958, 17467.894587472023, 320.48657420335235, 5136.586158662608, 19798.69415556913, 17059.927499878286, 19426.66514901733, 20644.841046374106, 15367.770991091782, 18834.398651979078, 19545.41946066302, 18040.56374755499, 17869.427514192117, 18987.10354701081, 4529.0457918202, 18330.16131940834, 17908.802850243064, 19028.107765748864, 21048.692465443703, 18366.637968913543, 18596.28398901026, 18459.99756237401, 20741.471620077213, 17633.457377923296, 17070.01543894917, 18965.097796293736, 18109.425662239348, 20557.010517488852, 23665.692608081426, 17518.47466477136, 16356.535549315686, 17754.201865988427, 18553.53826777293, 24811.252836264208, 17278.991521100023, 21040.771051642525, 17430.76581927075, 231.27269658122793, 17955.55632472824, 16591.150083659206, 17939.90162020422, 20917.308721134654, 17172.606000020245, 14940.734090887761, 15776.499705946833, 18072.729366663803, 19426.17073729934, 19338.19447393709, 18829.47793610697, 19629.84726321701, 18437.242102795462, 21836.879120610945, 16226.263957694364, 21047.451500332783, 18319.253448541862, 20311.29119214192, 16905.09188987215, 16704.11162500699, 18413.06130879503, 16781.30911346493, 22185.886348996504, 16428.38777226842, 6526.755362573708, 16749.376037784572, 19029.2907313394, 23612.928029830764, 20945.414567300842, 22265.852981459142, 16454.228963320667, 16257.393513178447, 21101.936805545574, 16149.648545411244, 22283.547208138025, 19654.37285430729, 21436.36780183291, 18716.87590742853, 20684.98839480631, 16417.02526075901, 18607.207780305976, 20154.57550522935, 17643.757345265152, 16095.112753013535, 18865.939359392887, 21343.317803596663, 19583.883904859606, 22781.428879868225, 16634.85914548959, 15155.36701044861, 20562.176952913687], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 3, 43, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7746.678240258219, 9201.624774213948, 10256.494382509269, 8921.181534949003, 8921.570396465593, 6357.312500821454, 10541.657135766627, 9745.252126674926, 11666.34229363926, 9510.346490300648, 6054.527429006591, 8607.531952470505, 9431.77921549823, 4.8545895737298865, 479.54135539470894, 7700.237898671456, 6862.2603521093215, 6110.77472101246, 6749.625875673654, 11577.707200362376, 5027.31010205133, 6176.492664349544, 8537.1398489221, 10219.990842536106, 8844.264689551683, 766.1331952617383, 7503.918742674455, 9203.321934520622, 8122.397587437828, 6352.929157657583, 9008.096488938443, 9076.495184502655, 7585.871641074315, 7046.128138218651, 8955.41262479725, 10456.976035850268, 7381.382393832146, 9569.672696663602, 6879.294255651579, 3837.5282080522875, 9905.762564803057, 10753.797365060336, 8190.5947273504935, 8878.050013119131, 1813.6666348852934, 10532.798436345844, 4657.97540778448, 7699.549120182865, 3.1200875027320367, 8104.537410680197, 8988.740738237688, 9398.323773530876, 6884.823291161491, 8410.40032473176, 12782.28315971628, 9306.91216922899, 9021.117367968916, 4644.816626932845, 8867.774969909939, 8077.344372179981, 7062.010963130245, 7858.4138029641845, 4546.14810757969, 9375.054910406963, 6071.426455621754, 9367.833345236348, 7714.922109221688, 8886.331196455216, 9319.817651668227, 8224.055447747152, 10726.325057257369, 5463.68422284737, 9786.68852540485, 1114.4624698323619, 11069.004069543442, 8472.876862285271, 3762.6317693225415, 6915.178464804528, 5634.850804413947, 10981.91611820633, 8214.849234611082, 6561.638883692228, 10653.291054325677, 5669.0129047494975, 6902.716180121587, 5995.771167586421, 7864.069204680713, 6346.103254662607, 8973.90062897104, 8893.920977211032, 7593.582369326183, 9266.28391060236, 9299.154548781491, 8509.974119117152, 6125.535305299084, 8152.998610325936, 4710.529895988807, 8828.546435008566, 11474.387791344885, 7513.369289217698], "policy_adversary_policy_reward": [6063.874213242555, 6154.053662707158, 2449.4995109153137, 4940.510849516996, 1717.4138148292786, 3885.6412412216764, 4411.77318659309, 5206.125830079056, 5220.565227265362, 2553.8728227435217, 7518.213996416587, 7197.194137142647, 1859.2226615418188, 3600.4784879643385, 3926.526407734846, 4269.381735216514, 1307.5354894983507, 2407.6584121695973, 4076.8511834131677, 3453.6384824106945, 7478.241579522998, 5382.084356994514, 4509.992777266187, 5338.410626009322, 4693.785084559321, 3342.330287414471, 207.2774447822344, 108.35453984738805, 2114.0053042877153, 2543.039498980186, 5954.9728752087385, 6143.483381688929, 7279.875271621622, 2917.7918761473925, 8031.360902718486, 5284.529525286303, 6557.987979915606, 7337.227190784853, 1225.6353673608887, 2564.428423368551, 4692.263028248135, 9114.825521679626, 6314.985035173236, 7053.941761140245, 4208.818836036764, 5294.605062596082, 3922.144781194841, 3727.291890461201, 4859.602526840522, 5283.236330618617, 2131.7556763426333, 1631.1569202158294, 4344.410678417336, 6481.831898316559, 4522.739030436944, 4182.741885285504, 5994.026112561208, 4911.684065749874, 7283.917602365795, 7411.845705420392, 4631.6366639079, 4726.904816067186, 4480.939102304492, 5038.849702203156, 5149.92915285727, 5724.196768442387, 6707.481188200709, 6987.862293657851, 4066.964535047389, 4611.0802180786395, 3685.15958788067, 2927.879815218239, 4872.6022701519405, 6711.1131323096215, 4441.959648851004, 4097.793316724733, 7043.380726042486, 6634.335535794735, 10045.096317043617, 9783.068082985581, 4213.328710847613, 3399.3833891206345, 3388.338258670628, 2214.3999255847702, 3626.1343944931214, 5937.472744144832, 5077.31091020262, 4598.177344451176, 10689.562611951655, 12308.023589427261, 3272.451443125293, 3473.7416416288725, 6898.635427911557, 9484.160215946464, 3288.6301955397967, 6442.586503548087, 89.85134034391842, 138.3012687345775, 3861.137499839048, 5989.881414209004, 3885.4718636661214, 3716.9374817553967, 4729.920296860491, 3811.6575498128136, 6798.295949347289, 7234.189480625913, 3030.4703762893027, 5731.735298999187, 1359.8524640146338, 798.5984671568567, 4835.223454501956, 1634.36408221591, 4041.4844238948667, 5010.127574800026, 9497.060602853535, 5284.293507512939, 5270.286143445058, 5200.133360582125, 4742.858905282018, 6009.27465864496, 5487.711639486012, 7080.124660600706, 4618.641988575352, 5960.18631125589, 8593.348540778896, 8697.3824722523, 4680.290058725777, 2170.9189885616197, 8069.770750951631, 6906.254293759406, 4762.601390690487, 4188.818712615022, 6218.993579700146, 6377.375503220124, 5247.085775213721, 2771.6749182032104, 3790.985325961824, 3593.308647376915, 4270.925685064069, 5918.080175983802, 3088.977339797044, 2966.0067164104657, 8542.427682156036, 8179.774443993167, 4355.447098326116, 2286.252148537479, 2741.203497733486, 2671.08939500786, 3073.1315541874824, 2607.2404140536546, 4940.861065157069, 5615.55280389705, 9552.086366576503, 10298.209893931667, 7191.963624815853, 6838.272477680461, 8395.92618581879, 8235.075991226362, 3017.484380574645, 2454.828464539695, 5927.28638911987, 2115.257889447482, 7438.517993857391, 7101.779927995923, 2007.5129216803089, 3488.8445694052702, 8269.89618875428, 8344.638114634205, 5736.613901285847, 7015.042772899823, 7317.619983531998, 8122.976650714491, 5598.111520587855, 5254.695182159953, 6740.835193345094, 7598.049946798626, 5168.23499475992, 2274.8896370280986, 4465.187882126948, 5248.098920968075, 6283.733557535849, 6277.259578367388, 3501.6217215341835, 4875.851713128576, 4842.98107494946, 1952.9771292826156, 5628.392566493012, 4727.572673782729, 7947.964401297467, 7269.818097000107, 5988.166621100038, 5442.71867343361, 9189.125165620202, 8881.77381825925, 2492.7235217586476, 5313.589188722393, 1013.2313867176658, 2667.7478323860755, 6581.709945735339, 6467.097717960597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39935351693603566, "mean_inference_ms": 0.9966119466026019, "mean_action_processing_ms": 0.16818132605230218, "mean_env_wait_ms": 0.05461684815116518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033475160598754883, "StateBufferConnector_ms": 0.0025414228439331055, "ViewRequirementAgentConnector_ms": 0.07240402698516846}, "num_episodes": 20, "episode_return_max": 24811.252836264208, "episode_return_min": 231.27269658122793, "episode_return_mean": 17908.44799149609}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.48521508131, "num_env_steps_trained_throughput_per_sec": 541.48521508131, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 7905.642, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7905.605, "sample_time_ms": 808.846, "learn_time_ms": 7085.513, "learn_throughput": 564.532, "synch_weights_time_ms": 10.714}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 188, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-49", "timestamp": 1723236829, "time_this_iter_s": 7.392910003662109, "time_total_s": 1435.6728525161743, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bd7e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1435.6728525161743, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 25.381818181818186, "ram_util_percent": 80.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53344.15596026062, "cur_kl_coeff": 7003935.995542078, "cur_lr": 5.0000000000000016e-05, "total_loss": 199.05756305512926, "policy_loss": 0.0003340776588412977, "vf_loss": 9.904186345155908, "vf_explained_var": 0.0352449667832208, "kl": 2.700667780681258e-05, "entropy": 0.898249187734392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9609429023849467, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997899159789085, "policy_loss": -0.002675768187327776, "vf_loss": 9.99346433977286, "vf_explained_var": -8.583279947439829e-05, "kl": 0.012316929937029878, "entropy": 1.4492536659042041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "env_runners": {"episode_reward_max": 24811.252836264208, "episode_reward_min": 231.27269658122793, "episode_reward_mean": 18133.411331443487, "episode_len_mean": 193.08, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19308, "policy_reward_min": {"agent_policy": 3.1200875027320367, "adversary_policy": 89.85134034391842}, "policy_reward_max": {"agent_policy": 12959.387403493838, "adversary_policy": 12308.023589427261}, "policy_reward_mean": {"agent_policy": 7871.121236281403, "adversary_policy": 5131.145047581042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18834.398651979078, 19545.41946066302, 18040.56374755499, 17869.427514192117, 18987.10354701081, 4529.0457918202, 18330.16131940834, 17908.802850243064, 19028.107765748864, 21048.692465443703, 18366.637968913543, 18596.28398901026, 18459.99756237401, 20741.471620077213, 17633.457377923296, 17070.01543894917, 18965.097796293736, 18109.425662239348, 20557.010517488852, 23665.692608081426, 17518.47466477136, 16356.535549315686, 17754.201865988427, 18553.53826777293, 24811.252836264208, 17278.991521100023, 21040.771051642525, 17430.76581927075, 231.27269658122793, 17955.55632472824, 16591.150083659206, 17939.90162020422, 20917.308721134654, 17172.606000020245, 14940.734090887761, 15776.499705946833, 18072.729366663803, 19426.17073729934, 19338.19447393709, 18829.47793610697, 19629.84726321701, 18437.242102795462, 21836.879120610945, 16226.263957694364, 21047.451500332783, 18319.253448541862, 20311.29119214192, 16905.09188987215, 16704.11162500699, 18413.06130879503, 16781.30911346493, 22185.886348996504, 16428.38777226842, 6526.755362573708, 16749.376037784572, 19029.2907313394, 23612.928029830764, 20945.414567300842, 22265.852981459142, 16454.228963320667, 16257.393513178447, 21101.936805545574, 16149.648545411244, 22283.547208138025, 19654.37285430729, 21436.36780183291, 18716.87590742853, 20684.98839480631, 16417.02526075901, 18607.207780305976, 20154.57550522935, 17643.757345265152, 16095.112753013535, 18865.939359392887, 21343.317803596663, 19583.883904859606, 22781.428879868225, 16634.85914548959, 15155.36701044861, 20562.176952913687, 16338.64415007191, 20752.16500186794, 16524.326695947417, 18945.293959427792, 20363.629508612208, 14917.129589229107, 18058.085363524264, 20068.976891895, 15894.909219240397, 16537.768755832552, 18626.306154296708, 17419.78164710985, 20861.676609166414, 20142.06372239408, 18449.762967664792, 17590.08186024677, 19888.219787141956, 18252.22796665183, 954.7524549806847, 19592.67780119827], "episode_lengths": [200, 200, 200, 200, 200, 41, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200], "policy_agent_policy_reward": [5027.31010205133, 6176.492664349544, 8537.1398489221, 10219.990842536106, 8844.264689551683, 766.1331952617383, 7503.918742674455, 9203.321934520622, 8122.397587437828, 6352.929157657583, 9008.096488938443, 9076.495184502655, 7585.871641074315, 7046.128138218651, 8955.41262479725, 10456.976035850268, 7381.382393832146, 9569.672696663602, 6879.294255651579, 3837.5282080522875, 9905.762564803057, 10753.797365060336, 8190.5947273504935, 8878.050013119131, 1813.6666348852934, 10532.798436345844, 4657.97540778448, 7699.549120182865, 3.1200875027320367, 8104.537410680197, 8988.740738237688, 9398.323773530876, 6884.823291161491, 8410.40032473176, 12782.28315971628, 9306.91216922899, 9021.117367968916, 4644.816626932845, 8867.774969909939, 8077.344372179981, 7062.010963130245, 7858.4138029641845, 4546.14810757969, 9375.054910406963, 6071.426455621754, 9367.833345236348, 7714.922109221688, 8886.331196455216, 9319.817651668227, 8224.055447747152, 10726.325057257369, 5463.68422284737, 9786.68852540485, 1114.4624698323619, 11069.004069543442, 8472.876862285271, 3762.6317693225415, 6915.178464804528, 5634.850804413947, 10981.91611820633, 8214.849234611082, 6561.638883692228, 10653.291054325677, 5669.0129047494975, 6902.716180121587, 5995.771167586421, 7864.069204680713, 6346.103254662607, 8973.90062897104, 8893.920977211032, 7593.582369326183, 9266.28391060236, 9299.154548781491, 8509.974119117152, 6125.535305299084, 8152.998610325936, 4710.529895988807, 8828.546435008566, 11474.387791344885, 7513.369289217698, 10706.613937545617, 7080.202103919205, 10630.16563933679, 8549.814057601692, 4942.139947021987, 12959.387403493838, 9014.696403171383, 7670.194028792436, 9424.747830954053, 11132.894381635982, 9522.34144018266, 10238.511564198747, 6518.839634809598, 7569.179544686919, 9228.42489969539, 10445.121891536806, 7326.8120285248315, 8385.87232709017, 25.85245389234564, 8363.89899661904], "policy_adversary_policy_reward": [4692.263028248135, 9114.825521679626, 6314.985035173236, 7053.941761140245, 4208.818836036764, 5294.605062596082, 3922.144781194841, 3727.291890461201, 4859.602526840522, 5283.236330618617, 2131.7556763426333, 1631.1569202158294, 4344.410678417336, 6481.831898316559, 4522.739030436944, 4182.741885285504, 5994.026112561208, 4911.684065749874, 7283.917602365795, 7411.845705420392, 4631.6366639079, 4726.904816067186, 4480.939102304492, 5038.849702203156, 5149.92915285727, 5724.196768442387, 6707.481188200709, 6987.862293657851, 4066.964535047389, 4611.0802180786395, 3685.15958788067, 2927.879815218239, 4872.6022701519405, 6711.1131323096215, 4441.959648851004, 4097.793316724733, 7043.380726042486, 6634.335535794735, 10045.096317043617, 9783.068082985581, 4213.328710847613, 3399.3833891206345, 3388.338258670628, 2214.3999255847702, 3626.1343944931214, 5937.472744144832, 5077.31091020262, 4598.177344451176, 10689.562611951655, 12308.023589427261, 3272.451443125293, 3473.7416416288725, 6898.635427911557, 9484.160215946464, 3288.6301955397967, 6442.586503548087, 89.85134034391842, 138.3012687345775, 3861.137499839048, 5989.881414209004, 3885.4718636661214, 3716.9374817553967, 4729.920296860491, 3811.6575498128136, 6798.295949347289, 7234.189480625913, 3030.4703762893027, 5731.735298999187, 1359.8524640146338, 798.5984671568567, 4835.223454501956, 1634.36408221591, 4041.4844238948667, 5010.127574800026, 9497.060602853535, 5284.293507512939, 5270.286143445058, 5200.133360582125, 4742.858905282018, 6009.27465864496, 5487.711639486012, 7080.124660600706, 4618.641988575352, 5960.18631125589, 8593.348540778896, 8697.3824722523, 4680.290058725777, 2170.9189885616197, 8069.770750951631, 6906.254293759406, 4762.601390690487, 4188.818712615022, 6218.993579700146, 6377.375503220124, 5247.085775213721, 2771.6749182032104, 3790.985325961824, 3593.308647376915, 4270.925685064069, 5918.080175983802, 3088.977339797044, 2966.0067164104657, 8542.427682156036, 8179.774443993167, 4355.447098326116, 2286.252148537479, 2741.203497733486, 2671.08939500786, 3073.1315541874824, 2607.2404140536546, 4940.861065157069, 5615.55280389705, 9552.086366576503, 10298.209893931667, 7191.963624815853, 6838.272477680461, 8395.92618581879, 8235.075991226362, 3017.484380574645, 2454.828464539695, 5927.28638911987, 2115.257889447482, 7438.517993857391, 7101.779927995923, 2007.5129216803089, 3488.8445694052702, 8269.89618875428, 8344.638114634205, 5736.613901285847, 7015.042772899823, 7317.619983531998, 8122.976650714491, 5598.111520587855, 5254.695182159953, 6740.835193345094, 7598.049946798626, 5168.23499475992, 2274.8896370280986, 4465.187882126948, 5248.098920968075, 6283.733557535849, 6277.259578367388, 3501.6217215341835, 4875.851713128576, 4842.98107494946, 1952.9771292826156, 5628.392566493012, 4727.572673782729, 7947.964401297467, 7269.818097000107, 5988.166621100038, 5442.71867343361, 9189.125165620202, 8881.77381825925, 2492.7235217586476, 5313.589188722393, 1013.2313867176658, 2667.7478323860755, 6581.709945735339, 6467.097717960597, 2498.452255484536, 3133.577957041789, 6898.975569903893, 6772.987328044829, 2382.1910722164853, 3511.9699843941557, 5585.159211811189, 4810.32069001492, 9199.99567670896, 6221.493884881219, 782.727141179362, 1175.015044555923, 3917.7616100411306, 5125.627350311774, 6220.229746795543, 6178.553116307031, 1752.773595509477, 4717.387792776897, 2395.6331321016346, 3009.2412420949513, 4574.264437719726, 4529.700276394349, 3899.5080984182673, 3281.761984492845, 6721.119205602667, 7621.71776875416, 6140.5754609779315, 6432.308716729239, 4913.514513039705, 4307.823554929726, 3691.3989073780926, 3453.5610613318136, 6798.238770189737, 5763.168988427424, 4110.126186218781, 5756.229453342874, 389.0670300314467, 539.8329710568923, 5607.487529930544, 5621.291274648675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992559229895859, "mean_inference_ms": 0.9962829706230554, "mean_action_processing_ms": 0.16817650613597984, "mean_env_wait_ms": 0.054601537639748614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033576488494873047, "StateBufferConnector_ms": 0.0027250051498413086, "ViewRequirementAgentConnector_ms": 0.06829535961151123}, "num_episodes": 20, "episode_return_max": 24811.252836264208, "episode_return_min": 231.27269658122793, "episode_return_mean": 18133.411331443487}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.4939358604495, "num_env_steps_trained_throughput_per_sec": 554.4939358604495, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 2268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 7859.313, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7859.277, "sample_time_ms": 807.899, "learn_time_ms": 7040.301, "learn_throughput": 568.158, "synch_weights_time_ms": 10.555}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "training_iteration": 189, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-53-56", "timestamp": 1723236836, "time_this_iter_s": 7.219778776168823, "time_total_s": 1442.8926312923431, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c211f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1442.8926312923431, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 25.720000000000006, "ram_util_percent": 79.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32439.276668423445, "cur_kl_coeff": 3501967.997771039, "cur_lr": 5.0000000000000016e-05, "total_loss": 128.69757645218462, "policy_loss": 0.000457919535360166, "vf_loss": 9.808186362029383, "vf_explained_var": 0.03254433999616633, "kl": 3.394917717626427e-05, "entropy": 0.90135279815033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9713001588049034, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.985377798477808, "policy_loss": -0.009492290432050746, "vf_loss": 9.989381236831347, "vf_explained_var": -2.806031455596288e-05, "kl": 0.009507816917903256, "entropy": 1.463936837017536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 24811.252836264208, "episode_reward_min": 231.27269658122793, "episode_reward_mean": 17764.144825536172, "episode_len_mean": 191.19, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19119, "policy_reward_min": {"agent_policy": 3.1200875027320367, "adversary_policy": 89.85134034391842}, "policy_reward_max": {"agent_policy": 12959.387403493838, "adversary_policy": 12308.023589427261}, "policy_reward_mean": {"agent_policy": 7972.902534992618, "adversary_policy": 4895.621145271776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18553.53826777293, 24811.252836264208, 17278.991521100023, 21040.771051642525, 17430.76581927075, 231.27269658122793, 17955.55632472824, 16591.150083659206, 17939.90162020422, 20917.308721134654, 17172.606000020245, 14940.734090887761, 15776.499705946833, 18072.729366663803, 19426.17073729934, 19338.19447393709, 18829.47793610697, 19629.84726321701, 18437.242102795462, 21836.879120610945, 16226.263957694364, 21047.451500332783, 18319.253448541862, 20311.29119214192, 16905.09188987215, 16704.11162500699, 18413.06130879503, 16781.30911346493, 22185.886348996504, 16428.38777226842, 6526.755362573708, 16749.376037784572, 19029.2907313394, 23612.928029830764, 20945.414567300842, 22265.852981459142, 16454.228963320667, 16257.393513178447, 21101.936805545574, 16149.648545411244, 22283.547208138025, 19654.37285430729, 21436.36780183291, 18716.87590742853, 20684.98839480631, 16417.02526075901, 18607.207780305976, 20154.57550522935, 17643.757345265152, 16095.112753013535, 18865.939359392887, 21343.317803596663, 19583.883904859606, 22781.428879868225, 16634.85914548959, 15155.36701044861, 20562.176952913687, 16338.64415007191, 20752.16500186794, 16524.326695947417, 18945.293959427792, 20363.629508612208, 14917.129589229107, 18058.085363524264, 20068.976891895, 15894.909219240397, 16537.768755832552, 18626.306154296708, 17419.78164710985, 20861.676609166414, 20142.06372239408, 18449.762967664792, 17590.08186024677, 19888.219787141956, 18252.22796665183, 954.7524549806847, 19592.67780119827, 18441.073771148545, 19303.476765208674, 19294.775020804555, 18542.15033359176, 18617.606625319666, 19427.932159297365, 15956.249513983119, 16741.163553835195, 17593.84957609236, 1923.6059112735609, 18405.085745318636, 16885.333942093945, 16520.33052410458, 19435.419227320912, 18449.769719159372, 16759.403705764274, 18575.490685690944, 19522.0580534024, 4178.57226211275, 17202.384711160586, 15207.308241422048, 18595.540639368985, 15410.794457284997], "episode_lengths": [200, 200, 200, 200, 200, 2, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200], "policy_agent_policy_reward": [8878.050013119131, 1813.6666348852934, 10532.798436345844, 4657.97540778448, 7699.549120182865, 3.1200875027320367, 8104.537410680197, 8988.740738237688, 9398.323773530876, 6884.823291161491, 8410.40032473176, 12782.28315971628, 9306.91216922899, 9021.117367968916, 4644.816626932845, 8867.774969909939, 8077.344372179981, 7062.010963130245, 7858.4138029641845, 4546.14810757969, 9375.054910406963, 6071.426455621754, 9367.833345236348, 7714.922109221688, 8886.331196455216, 9319.817651668227, 8224.055447747152, 10726.325057257369, 5463.68422284737, 9786.68852540485, 1114.4624698323619, 11069.004069543442, 8472.876862285271, 3762.6317693225415, 6915.178464804528, 5634.850804413947, 10981.91611820633, 8214.849234611082, 6561.638883692228, 10653.291054325677, 5669.0129047494975, 6902.716180121587, 5995.771167586421, 7864.069204680713, 6346.103254662607, 8973.90062897104, 8893.920977211032, 7593.582369326183, 9266.28391060236, 9299.154548781491, 8509.974119117152, 6125.535305299084, 8152.998610325936, 4710.529895988807, 8828.546435008566, 11474.387791344885, 7513.369289217698, 10706.613937545617, 7080.202103919205, 10630.16563933679, 8549.814057601692, 4942.139947021987, 12959.387403493838, 9014.696403171383, 7670.194028792436, 9424.747830954053, 11132.894381635982, 9522.34144018266, 10238.511564198747, 6518.839634809598, 7569.179544686919, 9228.42489969539, 10445.121891536806, 7326.8120285248315, 8385.87232709017, 25.85245389234564, 8363.89899661904, 9113.965522963677, 7433.372855733464, 7746.0946018053955, 8922.584330906446, 8267.402270593797, 8072.921178146949, 11431.049650128794, 9850.501986570587, 10152.786311946316, 124.24661699548606, 7011.190977756333, 8739.289763160687, 10276.764700466225, 8423.615219771093, 8322.621697621827, 9696.428684255096, 8374.088578033236, 7401.906689684144, 380.48223880307546, 9137.50574778311, 11091.351171125814, 9014.072081605373, 10594.7980850226], "policy_adversary_policy_reward": [5077.31091020262, 4598.177344451176, 10689.562611951655, 12308.023589427261, 3272.451443125293, 3473.7416416288725, 6898.635427911557, 9484.160215946464, 3288.6301955397967, 6442.586503548087, 89.85134034391842, 138.3012687345775, 3861.137499839048, 5989.881414209004, 3885.4718636661214, 3716.9374817553967, 4729.920296860491, 3811.6575498128136, 6798.295949347289, 7234.189480625913, 3030.4703762893027, 5731.735298999187, 1359.8524640146338, 798.5984671568567, 4835.223454501956, 1634.36408221591, 4041.4844238948667, 5010.127574800026, 9497.060602853535, 5284.293507512939, 5270.286143445058, 5200.133360582125, 4742.858905282018, 6009.27465864496, 5487.711639486012, 7080.124660600706, 4618.641988575352, 5960.18631125589, 8593.348540778896, 8697.3824722523, 4680.290058725777, 2170.9189885616197, 8069.770750951631, 6906.254293759406, 4762.601390690487, 4188.818712615022, 6218.993579700146, 6377.375503220124, 5247.085775213721, 2771.6749182032104, 3790.985325961824, 3593.308647376915, 4270.925685064069, 5918.080175983802, 3088.977339797044, 2966.0067164104657, 8542.427682156036, 8179.774443993167, 4355.447098326116, 2286.252148537479, 2741.203497733486, 2671.08939500786, 3073.1315541874824, 2607.2404140536546, 4940.861065157069, 5615.55280389705, 9552.086366576503, 10298.209893931667, 7191.963624815853, 6838.272477680461, 8395.92618581879, 8235.075991226362, 3017.484380574645, 2454.828464539695, 5927.28638911987, 2115.257889447482, 7438.517993857391, 7101.779927995923, 2007.5129216803089, 3488.8445694052702, 8269.89618875428, 8344.638114634205, 5736.613901285847, 7015.042772899823, 7317.619983531998, 8122.976650714491, 5598.111520587855, 5254.695182159953, 6740.835193345094, 7598.049946798626, 5168.23499475992, 2274.8896370280986, 4465.187882126948, 5248.098920968075, 6283.733557535849, 6277.259578367388, 3501.6217215341835, 4875.851713128576, 4842.98107494946, 1952.9771292826156, 5628.392566493012, 4727.572673782729, 7947.964401297467, 7269.818097000107, 5988.166621100038, 5442.71867343361, 9189.125165620202, 8881.77381825925, 2492.7235217586476, 5313.589188722393, 1013.2313867176658, 2667.7478323860755, 6581.709945735339, 6467.097717960597, 2498.452255484536, 3133.577957041789, 6898.975569903893, 6772.987328044829, 2382.1910722164853, 3511.9699843941557, 5585.159211811189, 4810.32069001492, 9199.99567670896, 6221.493884881219, 782.727141179362, 1175.015044555923, 3917.7616100411306, 5125.627350311774, 6220.229746795543, 6178.553116307031, 1752.773595509477, 4717.387792776897, 2395.6331321016346, 3009.2412420949513, 4574.264437719726, 4529.700276394349, 3899.5080984182673, 3281.761984492845, 6721.119205602667, 7621.71776875416, 6140.5754609779315, 6432.308716729239, 4913.514513039705, 4307.823554929726, 3691.3989073780926, 3453.5610613318136, 6798.238770189737, 5763.168988427424, 4110.126186218781, 5756.229453342874, 389.0670300314467, 539.8329710568923, 5607.487529930544, 5621.291274648675, 4517.924099091689, 4809.184149093123, 5330.060595077299, 6540.043314397934, 5152.639397073613, 6396.0410219255455, 4595.779074667927, 5023.7869280174045, 4675.112622888352, 5675.091731837506, 5767.627466939164, 5587.383514211261, 1818.2333066834367, 2706.9665571708874, 2599.0279301042897, 4291.633637160366, 3645.8761545830753, 3795.187109562947, 1007.1242329029901, 792.2350613750846, 7130.9446459746205, 4262.95012158767, 5402.8458605702535, 2743.1983183629313, 3865.370923264711, 2378.1949003736395, 5666.5884551172185, 5345.215552432527, 4348.806820493947, 5778.341201043585, 2617.268082033323, 4445.706939475837, 4435.767509874171, 5765.634597783523, 6653.890436769269, 5466.260926948968, 1908.0136261703417, 1890.0763971393312, 4932.06729043337, 3132.81167294413, 1065.1726176910993, 3050.784452605144, 5026.680790274045, 4554.787767489574, 3547.3375387083624, 1268.6588335540139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39917700042477294, "mean_inference_ms": 0.9960199554121617, "mean_action_processing_ms": 0.16821368987471214, "mean_env_wait_ms": 0.05457669355761548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003375411033630371, "StateBufferConnector_ms": 0.002741575241088867, "ViewRequirementAgentConnector_ms": 0.07123637199401855}, "num_episodes": 23, "episode_return_max": 24811.252836264208, "episode_return_min": 231.27269658122793, "episode_return_mean": 17764.144825536172}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.5962483327247, "num_env_steps_trained_throughput_per_sec": 548.5962483327247, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 7780.505, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7780.47, "sample_time_ms": 792.377, "learn_time_ms": 6976.812, "learn_throughput": 573.328, "synch_weights_time_ms": 10.766}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 190, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-04", "timestamp": 1723236844, "time_this_iter_s": 7.296200752258301, "time_total_s": 1450.1888320446014, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bcfca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1450.1888320446014, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 25.563636363636363, "ram_util_percent": 80.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19097.02069524533, "cur_kl_coeff": 1750983.9988855196, "cur_lr": 5.0000000000000016e-05, "total_loss": 86.39917565905859, "policy_loss": -0.00024410253045735537, "vf_loss": 9.828832001660867, "vf_explained_var": 0.024666538156529583, "kl": 4.373003281630214e-05, "entropy": 0.9041883767912627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9609196663834154, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.997567453980446, "policy_loss": -0.008499606785092814, "vf_loss": 10.0, "vf_explained_var": -0.00010417960584163666, "kl": 0.010509310651589962, "entropy": 1.4631604071706534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "env_runners": {"episode_reward_max": 23612.928029830764, "episode_reward_min": 954.7524549806847, "episode_reward_mean": 17790.461306541398, "episode_len_mean": 193.17, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19317, "policy_reward_min": {"agent_policy": 25.85245389234564, "adversary_policy": 389.0670300314467}, "policy_reward_max": {"agent_policy": 12959.387403493838, "adversary_policy": 10298.209893931667}, "policy_reward_mean": {"agent_policy": 8308.130748243879, "adversary_policy": 4741.16527914876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21047.451500332783, 18319.253448541862, 20311.29119214192, 16905.09188987215, 16704.11162500699, 18413.06130879503, 16781.30911346493, 22185.886348996504, 16428.38777226842, 6526.755362573708, 16749.376037784572, 19029.2907313394, 23612.928029830764, 20945.414567300842, 22265.852981459142, 16454.228963320667, 16257.393513178447, 21101.936805545574, 16149.648545411244, 22283.547208138025, 19654.37285430729, 21436.36780183291, 18716.87590742853, 20684.98839480631, 16417.02526075901, 18607.207780305976, 20154.57550522935, 17643.757345265152, 16095.112753013535, 18865.939359392887, 21343.317803596663, 19583.883904859606, 22781.428879868225, 16634.85914548959, 15155.36701044861, 20562.176952913687, 16338.64415007191, 20752.16500186794, 16524.326695947417, 18945.293959427792, 20363.629508612208, 14917.129589229107, 18058.085363524264, 20068.976891895, 15894.909219240397, 16537.768755832552, 18626.306154296708, 17419.78164710985, 20861.676609166414, 20142.06372239408, 18449.762967664792, 17590.08186024677, 19888.219787141956, 18252.22796665183, 954.7524549806847, 19592.67780119827, 18441.073771148545, 19303.476765208674, 19294.775020804555, 18542.15033359176, 18617.606625319666, 19427.932159297365, 15956.249513983119, 16741.163553835195, 17593.84957609236, 1923.6059112735609, 18405.085745318636, 16885.333942093945, 16520.33052410458, 19435.419227320912, 18449.769719159372, 16759.403705764274, 18575.490685690944, 19522.0580534024, 4178.57226211275, 17202.384711160586, 15207.308241422048, 18595.540639368985, 15410.794457284997, 18186.806070072944, 18274.037343102395, 19553.076795131616, 18232.3491476858, 18098.490377862712, 17772.921276437395, 14767.97546671637, 18154.294340058197, 15727.86934676983, 17858.61204406781, 16537.622661882364, 17757.944715189125, 18361.186118138026, 20235.20399759124, 18772.427607166584, 20015.461449765946, 18304.39515587772, 14865.8000637999, 15354.68063992946, 15338.741970941566, 22898.90520987334], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 57, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6071.426455621754, 9367.833345236348, 7714.922109221688, 8886.331196455216, 9319.817651668227, 8224.055447747152, 10726.325057257369, 5463.68422284737, 9786.68852540485, 1114.4624698323619, 11069.004069543442, 8472.876862285271, 3762.6317693225415, 6915.178464804528, 5634.850804413947, 10981.91611820633, 8214.849234611082, 6561.638883692228, 10653.291054325677, 5669.0129047494975, 6902.716180121587, 5995.771167586421, 7864.069204680713, 6346.103254662607, 8973.90062897104, 8893.920977211032, 7593.582369326183, 9266.28391060236, 9299.154548781491, 8509.974119117152, 6125.535305299084, 8152.998610325936, 4710.529895988807, 8828.546435008566, 11474.387791344885, 7513.369289217698, 10706.613937545617, 7080.202103919205, 10630.16563933679, 8549.814057601692, 4942.139947021987, 12959.387403493838, 9014.696403171383, 7670.194028792436, 9424.747830954053, 11132.894381635982, 9522.34144018266, 10238.511564198747, 6518.839634809598, 7569.179544686919, 9228.42489969539, 10445.121891536806, 7326.8120285248315, 8385.87232709017, 25.85245389234564, 8363.89899661904, 9113.965522963677, 7433.372855733464, 7746.0946018053955, 8922.584330906446, 8267.402270593797, 8072.921178146949, 11431.049650128794, 9850.501986570587, 10152.786311946316, 124.24661699548606, 7011.190977756333, 8739.289763160687, 10276.764700466225, 8423.615219771093, 8322.621697621827, 9696.428684255096, 8374.088578033236, 7401.906689684144, 380.48223880307546, 9137.50574778311, 11091.351171125814, 9014.072081605373, 10594.7980850226, 9623.332748777475, 9372.126487545775, 6538.771640253038, 8744.185366081972, 9726.82283213558, 8724.50770411583, 12236.916547241459, 8005.908370380567, 10547.190324927145, 9005.673192993258, 9404.02134346823, 9566.638094172078, 7386.710574770224, 7849.093264028192, 7879.267861534943, 7446.304960934161, 8244.07807440006, 12620.52831501997, 11200.061790746706, 12687.205651873543, 3627.3378679061484], "policy_adversary_policy_reward": [8069.770750951631, 6906.254293759406, 4762.601390690487, 4188.818712615022, 6218.993579700146, 6377.375503220124, 5247.085775213721, 2771.6749182032104, 3790.985325961824, 3593.308647376915, 4270.925685064069, 5918.080175983802, 3088.977339797044, 2966.0067164104657, 8542.427682156036, 8179.774443993167, 4355.447098326116, 2286.252148537479, 2741.203497733486, 2671.08939500786, 3073.1315541874824, 2607.2404140536546, 4940.861065157069, 5615.55280389705, 9552.086366576503, 10298.209893931667, 7191.963624815853, 6838.272477680461, 8395.92618581879, 8235.075991226362, 3017.484380574645, 2454.828464539695, 5927.28638911987, 2115.257889447482, 7438.517993857391, 7101.779927995923, 2007.5129216803089, 3488.8445694052702, 8269.89618875428, 8344.638114634205, 5736.613901285847, 7015.042772899823, 7317.619983531998, 8122.976650714491, 5598.111520587855, 5254.695182159953, 6740.835193345094, 7598.049946798626, 5168.23499475992, 2274.8896370280986, 4465.187882126948, 5248.098920968075, 6283.733557535849, 6277.259578367388, 3501.6217215341835, 4875.851713128576, 4842.98107494946, 1952.9771292826156, 5628.392566493012, 4727.572673782729, 7947.964401297467, 7269.818097000107, 5988.166621100038, 5442.71867343361, 9189.125165620202, 8881.77381825925, 2492.7235217586476, 5313.589188722393, 1013.2313867176658, 2667.7478323860755, 6581.709945735339, 6467.097717960597, 2498.452255484536, 3133.577957041789, 6898.975569903893, 6772.987328044829, 2382.1910722164853, 3511.9699843941557, 5585.159211811189, 4810.32069001492, 9199.99567670896, 6221.493884881219, 782.727141179362, 1175.015044555923, 3917.7616100411306, 5125.627350311774, 6220.229746795543, 6178.553116307031, 1752.773595509477, 4717.387792776897, 2395.6331321016346, 3009.2412420949513, 4574.264437719726, 4529.700276394349, 3899.5080984182673, 3281.761984492845, 6721.119205602667, 7621.71776875416, 6140.5754609779315, 6432.308716729239, 4913.514513039705, 4307.823554929726, 3691.3989073780926, 3453.5610613318136, 6798.238770189737, 5763.168988427424, 4110.126186218781, 5756.229453342874, 389.0670300314467, 539.8329710568923, 5607.487529930544, 5621.291274648675, 4517.924099091689, 4809.184149093123, 5330.060595077299, 6540.043314397934, 5152.639397073613, 6396.0410219255455, 4595.779074667927, 5023.7869280174045, 4675.112622888352, 5675.091731837506, 5767.627466939164, 5587.383514211261, 1818.2333066834367, 2706.9665571708874, 2599.0279301042897, 4291.633637160366, 3645.8761545830753, 3795.187109562947, 1007.1242329029901, 792.2350613750846, 7130.9446459746205, 4262.95012158767, 5402.8458605702535, 2743.1983183629313, 3865.370923264711, 2378.1949003736395, 5666.5884551172185, 5345.215552432527, 4348.806820493947, 5778.341201043585, 2617.268082033323, 4445.706939475837, 4435.767509874171, 5765.634597783523, 6653.890436769269, 5466.260926948968, 1908.0136261703417, 1890.0763971393312, 4932.06729043337, 3132.81167294413, 1065.1726176910993, 3050.784452605144, 5026.680790274045, 4554.787767489574, 3547.3375387083624, 1268.6588335540139, 4509.388664997312, 4054.0846562981515, 4759.238916969437, 4142.671938587224, 7602.631783319587, 5411.67337155899, 4091.139610945358, 5397.024170658451, 4241.818436933054, 4129.849108794079, 4064.6196205468204, 4983.793951774708, 1905.2190764894904, 625.8398429854531, 6134.813113416208, 4013.572856261413, 3594.9452988038206, 1585.7337230388746, 4393.09513829237, 4459.84371278214, 2395.487038151385, 4738.114280262723, 4074.8417063265756, 4116.464914690534, 4219.050494407104, 6755.425048960723, 6129.118183725554, 6256.992549837459, 4720.139952714086, 6173.019792917586, 6501.8121874726785, 6067.344301359012, 5898.0575493308725, 4162.259532146767, 1521.6073087109567, 723.6644400690016, 1212.5450161984816, 2942.073832984261, 1201.2999461282911, 1450.2363729397835, 9202.319925380058, 10069.24741658717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39917385165167757, "mean_inference_ms": 0.9957438199452039, "mean_action_processing_ms": 0.16823288259492666, "mean_env_wait_ms": 0.05457924632900412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033445358276367188, "StateBufferConnector_ms": 0.002732396125793457, "ViewRequirementAgentConnector_ms": 0.07314276695251465}, "num_episodes": 21, "episode_return_max": 23612.928029830764, "episode_return_min": 954.7524549806847, "episode_return_mean": 17790.461306541398}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.9040178074822, "num_env_steps_trained_throughput_per_sec": 544.9040178074822, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 2292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2292000, "timers": {"training_iteration_time_ms": 7656.504, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7656.468, "sample_time_ms": 781.072, "learn_time_ms": 6864.17, "learn_throughput": 582.736, "synch_weights_time_ms": 10.715}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "done": false, "training_iteration": 191, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-11", "timestamp": 1723236851, "time_this_iter_s": 7.346290111541748, "time_total_s": 1457.5351221561432, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x320745a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1457.5351221561432, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 25.8, "ram_util_percent": 79.36363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8253.514046288547, "cur_kl_coeff": 875491.9994427598, "cur_lr": 5.0000000000000016e-05, "total_loss": 42.57675584661897, "policy_loss": 0.0004015379437496738, "vf_loss": 9.95940687492411, "vf_explained_var": 0.016615872408347155, "kl": 3.7255563102152094e-05, "entropy": 0.9057712725230626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9657377692560355, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.996850624680519, "policy_loss": -0.0036471952315575134, "vf_loss": 9.994117816289267, "vf_explained_var": -0.00016853287816047667, "kl": 0.011051380213272448, "entropy": 1.4701231030126414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 22898.90520987334, "episode_reward_min": 954.7524549806847, "episode_reward_mean": 17585.376276723702, "episode_len_mean": 193.16, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19316, "policy_reward_min": {"agent_policy": 25.85245389234564, "adversary_policy": 389.0670300314467}, "policy_reward_max": {"agent_policy": 12959.387403493838, "adversary_policy": 10069.24741658717}, "policy_reward_mean": {"agent_policy": 8470.046829658673, "adversary_policy": 4557.6647235325145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19654.37285430729, 21436.36780183291, 18716.87590742853, 20684.98839480631, 16417.02526075901, 18607.207780305976, 20154.57550522935, 17643.757345265152, 16095.112753013535, 18865.939359392887, 21343.317803596663, 19583.883904859606, 22781.428879868225, 16634.85914548959, 15155.36701044861, 20562.176952913687, 16338.64415007191, 20752.16500186794, 16524.326695947417, 18945.293959427792, 20363.629508612208, 14917.129589229107, 18058.085363524264, 20068.976891895, 15894.909219240397, 16537.768755832552, 18626.306154296708, 17419.78164710985, 20861.676609166414, 20142.06372239408, 18449.762967664792, 17590.08186024677, 19888.219787141956, 18252.22796665183, 954.7524549806847, 19592.67780119827, 18441.073771148545, 19303.476765208674, 19294.775020804555, 18542.15033359176, 18617.606625319666, 19427.932159297365, 15956.249513983119, 16741.163553835195, 17593.84957609236, 1923.6059112735609, 18405.085745318636, 16885.333942093945, 16520.33052410458, 19435.419227320912, 18449.769719159372, 16759.403705764274, 18575.490685690944, 19522.0580534024, 4178.57226211275, 17202.384711160586, 15207.308241422048, 18595.540639368985, 15410.794457284997, 18186.806070072944, 18274.037343102395, 19553.076795131616, 18232.3491476858, 18098.490377862712, 17772.921276437395, 14767.97546671637, 18154.294340058197, 15727.86934676983, 17858.61204406781, 16537.622661882364, 17757.944715189125, 18361.186118138026, 20235.20399759124, 18772.427607166584, 20015.461449765946, 18304.39515587772, 14865.8000637999, 15354.68063992946, 15338.741970941566, 22898.90520987334, 18712.053614148543, 17166.006788719093, 18323.187612354293, 16582.727050359947, 17947.704352808425, 19769.35598219859, 22469.168803175267, 18039.05354932369, 18208.984258718072, 18334.671679684157, 18085.644128541942, 17891.508092942426, 18458.54625004079, 19172.62496876405, 6440.567247974463, 17574.341584601065, 17329.979835054957, 16694.384007969184, 14777.73312320415, 15985.471032950009], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [6902.716180121587, 5995.771167586421, 7864.069204680713, 6346.103254662607, 8973.90062897104, 8893.920977211032, 7593.582369326183, 9266.28391060236, 9299.154548781491, 8509.974119117152, 6125.535305299084, 8152.998610325936, 4710.529895988807, 8828.546435008566, 11474.387791344885, 7513.369289217698, 10706.613937545617, 7080.202103919205, 10630.16563933679, 8549.814057601692, 4942.139947021987, 12959.387403493838, 9014.696403171383, 7670.194028792436, 9424.747830954053, 11132.894381635982, 9522.34144018266, 10238.511564198747, 6518.839634809598, 7569.179544686919, 9228.42489969539, 10445.121891536806, 7326.8120285248315, 8385.87232709017, 25.85245389234564, 8363.89899661904, 9113.965522963677, 7433.372855733464, 7746.0946018053955, 8922.584330906446, 8267.402270593797, 8072.921178146949, 11431.049650128794, 9850.501986570587, 10152.786311946316, 124.24661699548606, 7011.190977756333, 8739.289763160687, 10276.764700466225, 8423.615219771093, 8322.621697621827, 9696.428684255096, 8374.088578033236, 7401.906689684144, 380.48223880307546, 9137.50574778311, 11091.351171125814, 9014.072081605373, 10594.7980850226, 9623.332748777475, 9372.126487545775, 6538.771640253038, 8744.185366081972, 9726.82283213558, 8724.50770411583, 12236.916547241459, 8005.908370380567, 10547.190324927145, 9005.673192993258, 9404.02134346823, 9566.638094172078, 7386.710574770224, 7849.093264028192, 7879.267861534943, 7446.304960934161, 8244.07807440006, 12620.52831501997, 11200.061790746706, 12687.205651873543, 3627.3378679061484, 8407.774113466348, 9852.186329899498, 9702.87779706626, 9771.807515137101, 8486.550038081761, 6345.555466125517, 4078.2243007658026, 9384.219280087374, 9439.053886042357, 8181.636640743807, 9811.457344943758, 9108.518547367752, 8534.559909750753, 7737.902695909736, 533.3923936347762, 9291.520781781905, 9248.840963744035, 8359.022819806074, 12937.991844149808, 11589.312120221932], "policy_adversary_policy_reward": [5736.613901285847, 7015.042772899823, 7317.619983531998, 8122.976650714491, 5598.111520587855, 5254.695182159953, 6740.835193345094, 7598.049946798626, 5168.23499475992, 2274.8896370280986, 4465.187882126948, 5248.098920968075, 6283.733557535849, 6277.259578367388, 3501.6217215341835, 4875.851713128576, 4842.98107494946, 1952.9771292826156, 5628.392566493012, 4727.572673782729, 7947.964401297467, 7269.818097000107, 5988.166621100038, 5442.71867343361, 9189.125165620202, 8881.77381825925, 2492.7235217586476, 5313.589188722393, 1013.2313867176658, 2667.7478323860755, 6581.709945735339, 6467.097717960597, 2498.452255484536, 3133.577957041789, 6898.975569903893, 6772.987328044829, 2382.1910722164853, 3511.9699843941557, 5585.159211811189, 4810.32069001492, 9199.99567670896, 6221.493884881219, 782.727141179362, 1175.015044555923, 3917.7616100411306, 5125.627350311774, 6220.229746795543, 6178.553116307031, 1752.773595509477, 4717.387792776897, 2395.6331321016346, 3009.2412420949513, 4574.264437719726, 4529.700276394349, 3899.5080984182673, 3281.761984492845, 6721.119205602667, 7621.71776875416, 6140.5754609779315, 6432.308716729239, 4913.514513039705, 4307.823554929726, 3691.3989073780926, 3453.5610613318136, 6798.238770189737, 5763.168988427424, 4110.126186218781, 5756.229453342874, 389.0670300314467, 539.8329710568923, 5607.487529930544, 5621.291274648675, 4517.924099091689, 4809.184149093123, 5330.060595077299, 6540.043314397934, 5152.639397073613, 6396.0410219255455, 4595.779074667927, 5023.7869280174045, 4675.112622888352, 5675.091731837506, 5767.627466939164, 5587.383514211261, 1818.2333066834367, 2706.9665571708874, 2599.0279301042897, 4291.633637160366, 3645.8761545830753, 3795.187109562947, 1007.1242329029901, 792.2350613750846, 7130.9446459746205, 4262.95012158767, 5402.8458605702535, 2743.1983183629313, 3865.370923264711, 2378.1949003736395, 5666.5884551172185, 5345.215552432527, 4348.806820493947, 5778.341201043585, 2617.268082033323, 4445.706939475837, 4435.767509874171, 5765.634597783523, 6653.890436769269, 5466.260926948968, 1908.0136261703417, 1890.0763971393312, 4932.06729043337, 3132.81167294413, 1065.1726176910993, 3050.784452605144, 5026.680790274045, 4554.787767489574, 3547.3375387083624, 1268.6588335540139, 4509.388664997312, 4054.0846562981515, 4759.238916969437, 4142.671938587224, 7602.631783319587, 5411.67337155899, 4091.139610945358, 5397.024170658451, 4241.818436933054, 4129.849108794079, 4064.6196205468204, 4983.793951774708, 1905.2190764894904, 625.8398429854531, 6134.813113416208, 4013.572856261413, 3594.9452988038206, 1585.7337230388746, 4393.09513829237, 4459.84371278214, 2395.487038151385, 4738.114280262723, 4074.8417063265756, 4116.464914690534, 4219.050494407104, 6755.425048960723, 6129.118183725554, 6256.992549837459, 4720.139952714086, 6173.019792917586, 6501.8121874726785, 6067.344301359012, 5898.0575493308725, 4162.259532146767, 1521.6073087109567, 723.6644400690016, 1212.5450161984816, 2942.073832984261, 1201.2999461282911, 1450.2363729397835, 9202.319925380058, 10069.24741658717, 5733.39128166403, 4570.888219018193, 3282.9861016684567, 4030.8343571511386, 4402.803148192543, 4217.50666709552, 4370.3281085938415, 2440.591426628995, 5271.242159212993, 4189.912155513686, 5639.404359494343, 7784.396156578722, 8980.657147530983, 9410.287354878454, 3897.5870100808993, 4757.2472591554515, 4068.979438278037, 4700.950934397707, 5827.7211471887185, 4325.3138917515935, 3987.3608824529347, 4286.825901145276, 5033.617076363185, 3749.372469211478, 5257.128757154029, 4666.857583136054, 6233.94216827615, 5200.780104578158, 3294.219278873737, 2612.955575465946, 3432.9975971568324, 4849.823205662347, 4893.294659986904, 3187.8442113240035, 5783.112803924878, 2552.2483842382094, 1203.4477578096323, 636.2935212447055, 1845.6459993963174, 2550.5129133317514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39918166054664495, "mean_inference_ms": 0.9957674993448487, "mean_action_processing_ms": 0.16830247166182744, "mean_env_wait_ms": 0.05456958960429402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003350496292114258, "StateBufferConnector_ms": 0.002814769744873047, "ViewRequirementAgentConnector_ms": 0.07399094104766846}, "num_episodes": 20, "episode_return_max": 22898.90520987334, "episode_return_min": 954.7524549806847, "episode_return_mean": 17585.376276723702}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.93708984362473, "num_env_steps_trained_throughput_per_sec": 495.93708984362473, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 7651.59, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7651.555, "sample_time_ms": 783.698, "learn_time_ms": 6856.56, "learn_throughput": 583.383, "synch_weights_time_ms": 10.785}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 192, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-19", "timestamp": 1723236859, "time_this_iter_s": 8.070739984512329, "time_total_s": 1465.6058621406555, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3207459d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1465.6058621406555, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 30.327272727272728, "ram_util_percent": 79.08181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3877.7282073651672, "cur_kl_coeff": 437745.9997213799, "cur_lr": 5.0000000000000016e-05, "total_loss": 23.36596680948974, "policy_loss": 0.00012596595906726424, "vf_loss": 9.78075066924726, "vf_explained_var": 0.019543027909344465, "kl": 3.103418450635256e-05, "entropy": 0.9066499645432468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9892774409614503, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.010145788391432, "policy_loss": 0.00039833282038064985, "vf_loss": 10.0, "vf_explained_var": -7.753893733024597e-05, "kl": 0.016884506524850924, "entropy": 1.494510932515065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "env_runners": {"episode_reward_max": 22898.90520987334, "episode_reward_min": 954.7524549806847, "episode_reward_mean": 17502.932660360875, "episode_len_mean": 193.16, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 19316, "policy_reward_min": {"agent_policy": 25.85245389234564, "adversary_policy": 389.0670300314467}, "policy_reward_max": {"agent_policy": 12959.387403493838, "adversary_policy": 10069.24741658717}, "policy_reward_mean": {"agent_policy": 8588.98345784763, "adversary_policy": 4456.974601256623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16524.326695947417, 18945.293959427792, 20363.629508612208, 14917.129589229107, 18058.085363524264, 20068.976891895, 15894.909219240397, 16537.768755832552, 18626.306154296708, 17419.78164710985, 20861.676609166414, 20142.06372239408, 18449.762967664792, 17590.08186024677, 19888.219787141956, 18252.22796665183, 954.7524549806847, 19592.67780119827, 18441.073771148545, 19303.476765208674, 19294.775020804555, 18542.15033359176, 18617.606625319666, 19427.932159297365, 15956.249513983119, 16741.163553835195, 17593.84957609236, 1923.6059112735609, 18405.085745318636, 16885.333942093945, 16520.33052410458, 19435.419227320912, 18449.769719159372, 16759.403705764274, 18575.490685690944, 19522.0580534024, 4178.57226211275, 17202.384711160586, 15207.308241422048, 18595.540639368985, 15410.794457284997, 18186.806070072944, 18274.037343102395, 19553.076795131616, 18232.3491476858, 18098.490377862712, 17772.921276437395, 14767.97546671637, 18154.294340058197, 15727.86934676983, 17858.61204406781, 16537.622661882364, 17757.944715189125, 18361.186118138026, 20235.20399759124, 18772.427607166584, 20015.461449765946, 18304.39515587772, 14865.8000637999, 15354.68063992946, 15338.741970941566, 22898.90520987334, 18712.053614148543, 17166.006788719093, 18323.187612354293, 16582.727050359947, 17947.704352808425, 19769.35598219859, 22469.168803175267, 18039.05354932369, 18208.984258718072, 18334.671679684157, 18085.644128541942, 17891.508092942426, 18458.54625004079, 19172.62496876405, 6440.567247974463, 17574.341584601065, 17329.979835054957, 16694.384007969184, 14777.73312320415, 15985.471032950009, 18366.04631141362, 16534.881264457486, 19660.952880793153, 19699.10240969141, 15706.698483273958, 16338.646328424305, 18125.324241550563, 16127.818138918108, 19737.54712999056, 19769.939391848922, 21185.15536160246, 20162.73950341291, 18282.631041279026, 20085.576420336558, 20099.398269471378, 16701.624231981903, 16483.757520239098, 20115.8652464895], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [10630.16563933679, 8549.814057601692, 4942.139947021987, 12959.387403493838, 9014.696403171383, 7670.194028792436, 9424.747830954053, 11132.894381635982, 9522.34144018266, 10238.511564198747, 6518.839634809598, 7569.179544686919, 9228.42489969539, 10445.121891536806, 7326.8120285248315, 8385.87232709017, 25.85245389234564, 8363.89899661904, 9113.965522963677, 7433.372855733464, 7746.0946018053955, 8922.584330906446, 8267.402270593797, 8072.921178146949, 11431.049650128794, 9850.501986570587, 10152.786311946316, 124.24661699548606, 7011.190977756333, 8739.289763160687, 10276.764700466225, 8423.615219771093, 8322.621697621827, 9696.428684255096, 8374.088578033236, 7401.906689684144, 380.48223880307546, 9137.50574778311, 11091.351171125814, 9014.072081605373, 10594.7980850226, 9623.332748777475, 9372.126487545775, 6538.771640253038, 8744.185366081972, 9726.82283213558, 8724.50770411583, 12236.916547241459, 8005.908370380567, 10547.190324927145, 9005.673192993258, 9404.02134346823, 9566.638094172078, 7386.710574770224, 7849.093264028192, 7879.267861534943, 7446.304960934161, 8244.07807440006, 12620.52831501997, 11200.061790746706, 12687.205651873543, 3627.3378679061484, 8407.774113466348, 9852.186329899498, 9702.87779706626, 9771.807515137101, 8486.550038081761, 6345.555466125517, 4078.2243007658026, 9384.219280087374, 9439.053886042357, 8181.636640743807, 9811.457344943758, 9108.518547367752, 8534.559909750753, 7737.902695909736, 533.3923936347762, 9291.520781781905, 9248.840963744035, 8359.022819806074, 12937.991844149808, 11589.312120221932, 8121.554500392033, 11412.164667643143, 7883.264916805136, 8141.349310443792, 8916.96446515968, 11514.102370561292, 8636.69730565381, 11247.408791738468, 5639.721292332731, 8229.08860644312, 5727.677924916606, 7807.78679606526, 9794.92429165812, 6669.12986346478, 7928.132263205466, 9626.728149606995, 10967.734316749407, 7866.892715766451], "policy_adversary_policy_reward": [2382.1910722164853, 3511.9699843941557, 5585.159211811189, 4810.32069001492, 9199.99567670896, 6221.493884881219, 782.727141179362, 1175.015044555923, 3917.7616100411306, 5125.627350311774, 6220.229746795543, 6178.553116307031, 1752.773595509477, 4717.387792776897, 2395.6331321016346, 3009.2412420949513, 4574.264437719726, 4529.700276394349, 3899.5080984182673, 3281.761984492845, 6721.119205602667, 7621.71776875416, 6140.5754609779315, 6432.308716729239, 4913.514513039705, 4307.823554929726, 3691.3989073780926, 3453.5610613318136, 6798.238770189737, 5763.168988427424, 4110.126186218781, 5756.229453342874, 389.0670300314467, 539.8329710568923, 5607.487529930544, 5621.291274648675, 4517.924099091689, 4809.184149093123, 5330.060595077299, 6540.043314397934, 5152.639397073613, 6396.0410219255455, 4595.779074667927, 5023.7869280174045, 4675.112622888352, 5675.091731837506, 5767.627466939164, 5587.383514211261, 1818.2333066834367, 2706.9665571708874, 2599.0279301042897, 4291.633637160366, 3645.8761545830753, 3795.187109562947, 1007.1242329029901, 792.2350613750846, 7130.9446459746205, 4262.95012158767, 5402.8458605702535, 2743.1983183629313, 3865.370923264711, 2378.1949003736395, 5666.5884551172185, 5345.215552432527, 4348.806820493947, 5778.341201043585, 2617.268082033323, 4445.706939475837, 4435.767509874171, 5765.634597783523, 6653.890436769269, 5466.260926948968, 1908.0136261703417, 1890.0763971393312, 4932.06729043337, 3132.81167294413, 1065.1726176910993, 3050.784452605144, 5026.680790274045, 4554.787767489574, 3547.3375387083624, 1268.6588335540139, 4509.388664997312, 4054.0846562981515, 4759.238916969437, 4142.671938587224, 7602.631783319587, 5411.67337155899, 4091.139610945358, 5397.024170658451, 4241.818436933054, 4129.849108794079, 4064.6196205468204, 4983.793951774708, 1905.2190764894904, 625.8398429854531, 6134.813113416208, 4013.572856261413, 3594.9452988038206, 1585.7337230388746, 4393.09513829237, 4459.84371278214, 2395.487038151385, 4738.114280262723, 4074.8417063265756, 4116.464914690534, 4219.050494407104, 6755.425048960723, 6129.118183725554, 6256.992549837459, 4720.139952714086, 6173.019792917586, 6501.8121874726785, 6067.344301359012, 5898.0575493308725, 4162.259532146767, 1521.6073087109567, 723.6644400690016, 1212.5450161984816, 2942.073832984261, 1201.2999461282911, 1450.2363729397835, 9202.319925380058, 10069.24741658717, 5733.39128166403, 4570.888219018193, 3282.9861016684567, 4030.8343571511386, 4402.803148192543, 4217.50666709552, 4370.3281085938415, 2440.591426628995, 5271.242159212993, 4189.912155513686, 5639.404359494343, 7784.396156578722, 8980.657147530983, 9410.287354878454, 3897.5870100808993, 4757.2472591554515, 4068.979438278037, 4700.950934397707, 5827.7211471887185, 4325.3138917515935, 3987.3608824529347, 4286.825901145276, 5033.617076363185, 3749.372469211478, 5257.128757154029, 4666.857583136054, 6233.94216827615, 5200.780104578158, 3294.219278873737, 2612.955575465946, 3432.9975971568324, 4849.823205662347, 4893.294659986904, 3187.8442113240035, 5783.112803924878, 2552.2483842382094, 1203.4477578096323, 636.2935212447055, 1845.6459993963174, 2550.5129133317514, 5444.411938754588, 4800.079872267012, 2716.616449483329, 2406.100147331018, 5834.722549020465, 5942.965414967559, 5833.696495398542, 5724.056603849057, 1564.5628595430428, 5225.171158571282, 2272.5087177980313, 2552.03524006501, 5505.43831807715, 3983.18861781961, 1985.6825151871856, 2894.7268319924915, 5595.41150625962, 8502.414331398226, 5882.897415377912, 5657.9533700279035, 8288.036021331309, 7169.441415354568, 6069.438325202511, 6285.514382145121, 4194.312491224366, 4293.394258396521, 5943.440796605627, 7473.005760266164, 5988.416688542589, 6182.8493177233295, 3431.0728136195494, 3643.8232687553764, 3170.6747908262746, 2345.3484126634335, 5973.729622758532, 6275.242907964501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992127861449696, "mean_inference_ms": 0.9956933733405294, "mean_action_processing_ms": 0.1683348547411093, "mean_env_wait_ms": 0.054567895336502234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033565759658813477, "StateBufferConnector_ms": 0.0027998685836791992, "ViewRequirementAgentConnector_ms": 0.07289230823516846}, "num_episodes": 18, "episode_return_max": 22898.90520987334, "episode_return_min": 954.7524549806847, "episode_return_mean": 17502.932660360875}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.5073671026475, "num_env_steps_trained_throughput_per_sec": 546.5073671026475, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 2316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2316000, "timers": {"training_iteration_time_ms": 7565.227, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7565.191, "sample_time_ms": 788.74, "learn_time_ms": 6765.316, "learn_throughput": 591.251, "synch_weights_time_ms": 10.624}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "done": false, "training_iteration": 193, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-27", "timestamp": 1723236867, "time_this_iter_s": 7.323743104934692, "time_total_s": 1472.9296052455902, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c21e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1472.9296052455902, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 25.572727272727274, "ram_util_percent": 78.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1702.7259729133082, "cur_kl_coeff": 218872.99986068995, "cur_lr": 5.0000000000000016e-05, "total_loss": 15.709622076831797, "policy_loss": 0.0004464893208856069, "vf_loss": 9.73183317537661, "vf_explained_var": 0.024797602652241943, "kl": 2.730963792119746e-05, "entropy": 0.9072154560417095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9768214531863729, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.00167173643907, "policy_loss": -0.003636389353778213, "vf_loss": 10.0, "vf_explained_var": -9.48357085386912e-05, "kl": 0.009194685890785573, "entropy": 1.4789488224933545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": 22898.90520987334, "episode_reward_min": 1923.6059112735609, "episode_reward_mean": 17472.015184837288, "episode_len_mean": 195.08, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19508, "policy_reward_min": {"agent_policy": 124.24661699548606, "adversary_policy": 625.8398429854531}, "policy_reward_max": {"agent_policy": 12937.991844149808, "adversary_policy": 10069.24741658717}, "policy_reward_mean": {"agent_policy": 8781.359933020714, "adversary_policy": 4345.327625908289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19294.775020804555, 18542.15033359176, 18617.606625319666, 19427.932159297365, 15956.249513983119, 16741.163553835195, 17593.84957609236, 1923.6059112735609, 18405.085745318636, 16885.333942093945, 16520.33052410458, 19435.419227320912, 18449.769719159372, 16759.403705764274, 18575.490685690944, 19522.0580534024, 4178.57226211275, 17202.384711160586, 15207.308241422048, 18595.540639368985, 15410.794457284997, 18186.806070072944, 18274.037343102395, 19553.076795131616, 18232.3491476858, 18098.490377862712, 17772.921276437395, 14767.97546671637, 18154.294340058197, 15727.86934676983, 17858.61204406781, 16537.622661882364, 17757.944715189125, 18361.186118138026, 20235.20399759124, 18772.427607166584, 20015.461449765946, 18304.39515587772, 14865.8000637999, 15354.68063992946, 15338.741970941566, 22898.90520987334, 18712.053614148543, 17166.006788719093, 18323.187612354293, 16582.727050359947, 17947.704352808425, 19769.35598219859, 22469.168803175267, 18039.05354932369, 18208.984258718072, 18334.671679684157, 18085.644128541942, 17891.508092942426, 18458.54625004079, 19172.62496876405, 6440.567247974463, 17574.341584601065, 17329.979835054957, 16694.384007969184, 14777.73312320415, 15985.471032950009, 18366.04631141362, 16534.881264457486, 19660.952880793153, 19699.10240969141, 15706.698483273958, 16338.646328424305, 18125.324241550563, 16127.818138918108, 19737.54712999056, 19769.939391848922, 21185.15536160246, 20162.73950341291, 18282.631041279026, 20085.576420336558, 20099.398269471378, 16701.624231981903, 16483.757520239098, 20115.8652464895, 18058.227642085272, 16356.902260749095, 19644.24869034957, 19803.32195024239, 16701.082544427856, 18162.426372702022, 16957.19571363129, 15236.546410673407, 15621.49588391727, 16766.039692657225, 15723.816294333374, 15805.860658808413, 17233.67197254038, 20489.08106961823, 18785.641079800855, 18974.83597159629, 18654.505207451963, 15952.016511021995, 15128.212550241724, 17685.345461709865], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 16, 200, 200, 200, 200, 200, 200, 200, 200, 36, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [7746.0946018053955, 8922.584330906446, 8267.402270593797, 8072.921178146949, 11431.049650128794, 9850.501986570587, 10152.786311946316, 124.24661699548606, 7011.190977756333, 8739.289763160687, 10276.764700466225, 8423.615219771093, 8322.621697621827, 9696.428684255096, 8374.088578033236, 7401.906689684144, 380.48223880307546, 9137.50574778311, 11091.351171125814, 9014.072081605373, 10594.7980850226, 9623.332748777475, 9372.126487545775, 6538.771640253038, 8744.185366081972, 9726.82283213558, 8724.50770411583, 12236.916547241459, 8005.908370380567, 10547.190324927145, 9005.673192993258, 9404.02134346823, 9566.638094172078, 7386.710574770224, 7849.093264028192, 7879.267861534943, 7446.304960934161, 8244.07807440006, 12620.52831501997, 11200.061790746706, 12687.205651873543, 3627.3378679061484, 8407.774113466348, 9852.186329899498, 9702.87779706626, 9771.807515137101, 8486.550038081761, 6345.555466125517, 4078.2243007658026, 9384.219280087374, 9439.053886042357, 8181.636640743807, 9811.457344943758, 9108.518547367752, 8534.559909750753, 7737.902695909736, 533.3923936347762, 9291.520781781905, 9248.840963744035, 8359.022819806074, 12937.991844149808, 11589.312120221932, 8121.554500392033, 11412.164667643143, 7883.264916805136, 8141.349310443792, 8916.96446515968, 11514.102370561292, 8636.69730565381, 11247.408791738468, 5639.721292332731, 8229.08860644312, 5727.677924916606, 7807.78679606526, 9794.92429165812, 6669.12986346478, 7928.132263205466, 9626.728149606995, 10967.734316749407, 7866.892715766451, 9490.724159307394, 10136.299529223877, 7604.157618006463, 8097.543830722368, 11456.08630679198, 9465.7993325586, 8776.687287438102, 10093.831073651256, 12080.57560607464, 8563.688779809645, 10304.32416928135, 9616.437975710369, 10394.382974651437, 6960.736097741167, 7659.0734928497195, 8349.038605027527, 7417.385224299594, 9781.16591104786, 12711.65879331217, 8774.283601744395], "policy_adversary_policy_reward": [5152.639397073613, 6396.0410219255455, 4595.779074667927, 5023.7869280174045, 4675.112622888352, 5675.091731837506, 5767.627466939164, 5587.383514211261, 1818.2333066834367, 2706.9665571708874, 2599.0279301042897, 4291.633637160366, 3645.8761545830753, 3795.187109562947, 1007.1242329029901, 792.2350613750846, 7130.9446459746205, 4262.95012158767, 5402.8458605702535, 2743.1983183629313, 3865.370923264711, 2378.1949003736395, 5666.5884551172185, 5345.215552432527, 4348.806820493947, 5778.341201043585, 2617.268082033323, 4445.706939475837, 4435.767509874171, 5765.634597783523, 6653.890436769269, 5466.260926948968, 1908.0136261703417, 1890.0763971393312, 4932.06729043337, 3132.81167294413, 1065.1726176910993, 3050.784452605144, 5026.680790274045, 4554.787767489574, 3547.3375387083624, 1268.6588335540139, 4509.388664997312, 4054.0846562981515, 4759.238916969437, 4142.671938587224, 7602.631783319587, 5411.67337155899, 4091.139610945358, 5397.024170658451, 4241.818436933054, 4129.849108794079, 4064.6196205468204, 4983.793951774708, 1905.2190764894904, 625.8398429854531, 6134.813113416208, 4013.572856261413, 3594.9452988038206, 1585.7337230388746, 4393.09513829237, 4459.84371278214, 2395.487038151385, 4738.114280262723, 4074.8417063265756, 4116.464914690534, 4219.050494407104, 6755.425048960723, 6129.118183725554, 6256.992549837459, 4720.139952714086, 6173.019792917586, 6501.8121874726785, 6067.344301359012, 5898.0575493308725, 4162.259532146767, 1521.6073087109567, 723.6644400690016, 1212.5450161984816, 2942.073832984261, 1201.2999461282911, 1450.2363729397835, 9202.319925380058, 10069.24741658717, 5733.39128166403, 4570.888219018193, 3282.9861016684567, 4030.8343571511386, 4402.803148192543, 4217.50666709552, 4370.3281085938415, 2440.591426628995, 5271.242159212993, 4189.912155513686, 5639.404359494343, 7784.396156578722, 8980.657147530983, 9410.287354878454, 3897.5870100808993, 4757.2472591554515, 4068.979438278037, 4700.950934397707, 5827.7211471887185, 4325.3138917515935, 3987.3608824529347, 4286.825901145276, 5033.617076363185, 3749.372469211478, 5257.128757154029, 4666.857583136054, 6233.94216827615, 5200.780104578158, 3294.219278873737, 2612.955575465946, 3432.9975971568324, 4849.823205662347, 4893.294659986904, 3187.8442113240035, 5783.112803924878, 2552.2483842382094, 1203.4477578096323, 636.2935212447055, 1845.6459993963174, 2550.5129133317514, 5444.411938754588, 4800.079872267012, 2716.616449483329, 2406.100147331018, 5834.722549020465, 5942.965414967559, 5833.696495398542, 5724.056603849057, 1564.5628595430428, 5225.171158571282, 2272.5087177980313, 2552.03524006501, 5505.43831807715, 3983.18861781961, 1985.6825151871856, 2894.7268319924915, 5595.41150625962, 8502.414331398226, 5882.897415377912, 5657.9533700279035, 8288.036021331309, 7169.441415354568, 6069.438325202511, 6285.514382145121, 4194.312491224366, 4293.394258396521, 5943.440796605627, 7473.005760266164, 5988.416688542589, 6182.8493177233295, 3431.0728136195494, 3643.8232687553764, 3170.6747908262746, 2345.3484126634335, 5973.729622758532, 6275.242907964501, 4217.292666782247, 4350.2108159956115, 3930.606239200795, 2289.9964923244156, 5616.119833632818, 6423.97123871028, 5759.961691043809, 5945.816428476222, 2639.8747564513287, 2605.1214811845266, 4035.030493138738, 4661.596547004745, 5365.448336292847, 2815.0600899003252, 4048.304550079698, 1094.4107869424765, 1917.6274533863482, 1623.2928244563298, 5578.44684392131, 2623.904068926272, 1581.6806706024288, 3837.8114544495934, 1663.725035077524, 4525.697648020566, 3553.891457702652, 3285.3975401862813, 7123.593909700207, 6404.75106217693, 6445.66095486972, 4680.906632081358, 4912.931765289967, 5712.865601278753, 6724.7503994313665, 4512.369583720982, 1809.8808872910429, 4360.969712683109, 986.0769265108333, 1430.4768304187578, 4816.649436327704, 4094.412423637731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992421312304707, "mean_inference_ms": 0.9956721022801719, "mean_action_processing_ms": 0.16835749226048763, "mean_env_wait_ms": 0.054561160114511675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033510923385620117, "StateBufferConnector_ms": 0.0025595426559448242, "ViewRequirementAgentConnector_ms": 0.07113957405090332}, "num_episodes": 20, "episode_return_max": 22898.90520987334, "episode_return_min": 1923.6059112735609, "episode_return_mean": 17472.015184837288}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.4057132284497, "num_env_steps_trained_throughput_per_sec": 549.4057132284497, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 7506.629, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7506.594, "sample_time_ms": 781.375, "learn_time_ms": 6714.112, "learn_throughput": 595.76, "synch_weights_time_ms": 10.546}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 194, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-34", "timestamp": 1723236874, "time_this_iter_s": 7.285371780395508, "time_total_s": 1480.2149770259857, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bcfca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1480.2149770259857, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 24.700000000000003, "ram_util_percent": 78.93636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1119.7599859469783, "cur_kl_coeff": 109436.49993034497, "cur_lr": 5.0000000000000016e-05, "total_loss": 13.925106968450798, "policy_loss": 4.0236079730290586e-05, "vf_loss": 9.748768495125745, "vf_explained_var": 0.041460752928698504, "kl": 3.81618402145019e-05, "entropy": 0.9068087701128904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9663556238015493, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.002571875850359, "policy_loss": -0.003481768216685547, "vf_loss": 10.0, "vf_explained_var": -6.719672431548437e-05, "kl": 0.010486108321250262, "entropy": 1.467817941804727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "env_runners": {"episode_reward_max": 22898.90520987334, "episode_reward_min": 6440.567247974463, "episode_reward_mean": 17696.209863268898, "episode_len_mean": 198.56, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19856, "policy_reward_min": {"agent_policy": 533.3923936347762, "adversary_policy": 625.8398429854531}, "policy_reward_max": {"agent_policy": 12937.991844149808, "adversary_policy": 10069.24741658717}, "policy_reward_mean": {"agent_policy": 9080.67101190483, "adversary_policy": 4307.769425682036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18186.806070072944, 18274.037343102395, 19553.076795131616, 18232.3491476858, 18098.490377862712, 17772.921276437395, 14767.97546671637, 18154.294340058197, 15727.86934676983, 17858.61204406781, 16537.622661882364, 17757.944715189125, 18361.186118138026, 20235.20399759124, 18772.427607166584, 20015.461449765946, 18304.39515587772, 14865.8000637999, 15354.68063992946, 15338.741970941566, 22898.90520987334, 18712.053614148543, 17166.006788719093, 18323.187612354293, 16582.727050359947, 17947.704352808425, 19769.35598219859, 22469.168803175267, 18039.05354932369, 18208.984258718072, 18334.671679684157, 18085.644128541942, 17891.508092942426, 18458.54625004079, 19172.62496876405, 6440.567247974463, 17574.341584601065, 17329.979835054957, 16694.384007969184, 14777.73312320415, 15985.471032950009, 18366.04631141362, 16534.881264457486, 19660.952880793153, 19699.10240969141, 15706.698483273958, 16338.646328424305, 18125.324241550563, 16127.818138918108, 19737.54712999056, 19769.939391848922, 21185.15536160246, 20162.73950341291, 18282.631041279026, 20085.576420336558, 20099.398269471378, 16701.624231981903, 16483.757520239098, 20115.8652464895, 18058.227642085272, 16356.902260749095, 19644.24869034957, 19803.32195024239, 16701.082544427856, 18162.426372702022, 16957.19571363129, 15236.546410673407, 15621.49588391727, 16766.039692657225, 15723.816294333374, 15805.860658808413, 17233.67197254038, 20489.08106961823, 18785.641079800855, 18974.83597159629, 18654.505207451963, 15952.016511021995, 15128.212550241724, 17685.345461709865, 17670.140153108787, 16978.022762343382, 17212.78289414227, 17480.1036197888, 18187.235020643217, 16837.267614161858, 17080.167188186075, 22443.540665390312, 16558.08133743568, 17936.604741497504, 20248.127131227928, 18782.921038511555, 17206.250874852733, 17656.94919150429, 16290.170740327054, 16444.71069559629, 18673.618996873123, 15852.34436577028, 15023.290656397287, 15801.39180755636, 15300.570956248155], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [9623.332748777475, 9372.126487545775, 6538.771640253038, 8744.185366081972, 9726.82283213558, 8724.50770411583, 12236.916547241459, 8005.908370380567, 10547.190324927145, 9005.673192993258, 9404.02134346823, 9566.638094172078, 7386.710574770224, 7849.093264028192, 7879.267861534943, 7446.304960934161, 8244.07807440006, 12620.52831501997, 11200.061790746706, 12687.205651873543, 3627.3378679061484, 8407.774113466348, 9852.186329899498, 9702.87779706626, 9771.807515137101, 8486.550038081761, 6345.555466125517, 4078.2243007658026, 9384.219280087374, 9439.053886042357, 8181.636640743807, 9811.457344943758, 9108.518547367752, 8534.559909750753, 7737.902695909736, 533.3923936347762, 9291.520781781905, 9248.840963744035, 8359.022819806074, 12937.991844149808, 11589.312120221932, 8121.554500392033, 11412.164667643143, 7883.264916805136, 8141.349310443792, 8916.96446515968, 11514.102370561292, 8636.69730565381, 11247.408791738468, 5639.721292332731, 8229.08860644312, 5727.677924916606, 7807.78679606526, 9794.92429165812, 6669.12986346478, 7928.132263205466, 9626.728149606995, 10967.734316749407, 7866.892715766451, 9490.724159307394, 10136.299529223877, 7604.157618006463, 8097.543830722368, 11456.08630679198, 9465.7993325586, 8776.687287438102, 10093.831073651256, 12080.57560607464, 8563.688779809645, 10304.32416928135, 9616.437975710369, 10394.382974651437, 6960.736097741167, 7659.0734928497195, 8349.038605027527, 7417.385224299594, 9781.16591104786, 12711.65879331217, 8774.283601744395, 9009.669015432803, 9607.233260545154, 10273.528962993301, 10383.963600326879, 9038.344055640355, 10777.773480389387, 10027.367645711372, 4284.968972662647, 11434.731736363105, 8931.038528629535, 7038.354772450139, 9041.874990340964, 10612.128346433932, 8873.4656407033, 10423.876166296028, 9643.395758860052, 9023.590303579911, 9655.022063120114, 11805.73452279757, 11494.315440441927, 11582.433206875534], "policy_adversary_policy_reward": [4509.388664997312, 4054.0846562981515, 4759.238916969437, 4142.671938587224, 7602.631783319587, 5411.67337155899, 4091.139610945358, 5397.024170658451, 4241.818436933054, 4129.849108794079, 4064.6196205468204, 4983.793951774708, 1905.2190764894904, 625.8398429854531, 6134.813113416208, 4013.572856261413, 3594.9452988038206, 1585.7337230388746, 4393.09513829237, 4459.84371278214, 2395.487038151385, 4738.114280262723, 4074.8417063265756, 4116.464914690534, 4219.050494407104, 6755.425048960723, 6129.118183725554, 6256.992549837459, 4720.139952714086, 6173.019792917586, 6501.8121874726785, 6067.344301359012, 5898.0575493308725, 4162.259532146767, 1521.6073087109567, 723.6644400690016, 1212.5450161984816, 2942.073832984261, 1201.2999461282911, 1450.2363729397835, 9202.319925380058, 10069.24741658717, 5733.39128166403, 4570.888219018193, 3282.9861016684567, 4030.8343571511386, 4402.803148192543, 4217.50666709552, 4370.3281085938415, 2440.591426628995, 5271.242159212993, 4189.912155513686, 5639.404359494343, 7784.396156578722, 8980.657147530983, 9410.287354878454, 3897.5870100808993, 4757.2472591554515, 4068.979438278037, 4700.950934397707, 5827.7211471887185, 4325.3138917515935, 3987.3608824529347, 4286.825901145276, 5033.617076363185, 3749.372469211478, 5257.128757154029, 4666.857583136054, 6233.94216827615, 5200.780104578158, 3294.219278873737, 2612.955575465946, 3432.9975971568324, 4849.823205662347, 4893.294659986904, 3187.8442113240035, 5783.112803924878, 2552.2483842382094, 1203.4477578096323, 636.2935212447055, 1845.6459993963174, 2550.5129133317514, 5444.411938754588, 4800.079872267012, 2716.616449483329, 2406.100147331018, 5834.722549020465, 5942.965414967559, 5833.696495398542, 5724.056603849057, 1564.5628595430428, 5225.171158571282, 2272.5087177980313, 2552.03524006501, 5505.43831807715, 3983.18861781961, 1985.6825151871856, 2894.7268319924915, 5595.41150625962, 8502.414331398226, 5882.897415377912, 5657.9533700279035, 8288.036021331309, 7169.441415354568, 6069.438325202511, 6285.514382145121, 4194.312491224366, 4293.394258396521, 5943.440796605627, 7473.005760266164, 5988.416688542589, 6182.8493177233295, 3431.0728136195494, 3643.8232687553764, 3170.6747908262746, 2345.3484126634335, 5973.729622758532, 6275.242907964501, 4217.292666782247, 4350.2108159956115, 3930.606239200795, 2289.9964923244156, 5616.119833632818, 6423.97123871028, 5759.961691043809, 5945.816428476222, 2639.8747564513287, 2605.1214811845266, 4035.030493138738, 4661.596547004745, 5365.448336292847, 2815.0600899003252, 4048.304550079698, 1094.4107869424765, 1917.6274533863482, 1623.2928244563298, 5578.44684392131, 2623.904068926272, 1581.6806706024288, 3837.8114544495934, 1663.725035077524, 4525.697648020566, 3553.891457702652, 3285.3975401862813, 7123.593909700207, 6404.75106217693, 6445.66095486972, 4680.906632081358, 4912.931765289967, 5712.865601278753, 6724.7503994313665, 4512.369583720982, 1809.8808872910429, 4360.969712683109, 986.0769265108333, 1430.4768304187578, 4816.649436327704, 4094.412423637731, 3999.2253241782123, 4661.245813497776, 4534.902363185795, 2835.88713861246, 3857.3956804536756, 3081.8582506952825, 3471.1888228773005, 3624.9511965845827, 5103.791568090593, 4045.099396912275, 3160.7439252132567, 2898.7502085591846, 4087.6753672098525, 2965.1241752648602, 8973.45805537146, 9185.11363735619, 2425.113386414527, 2698.2362146580463, 3939.3272854948323, 5066.238927373085, 6298.744213866214, 6911.028144911558, 4935.8290923673085, 4805.216955803267, 3311.8665927894704, 3282.2559356293664, 3515.043935954967, 5268.439614845983, 3718.259457434918, 2148.0351165960865, 2327.620397632942, 4473.694539103322, 5114.484626575028, 4535.544066718166, 4487.113560610845, 1710.2087420393195, 938.0464856431453, 2279.509647956615, 2647.820183289031, 1659.256183825436, 2559.702416855407, 1158.4353325172376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39925775698625254, "mean_inference_ms": 0.9957319293237081, "mean_action_processing_ms": 0.1683908242877067, "mean_env_wait_ms": 0.05458260857519968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034302473068237305, "StateBufferConnector_ms": 0.002577066421508789, "ViewRequirementAgentConnector_ms": 0.06924557685852051}, "num_episodes": 21, "episode_return_max": 22898.90520987334, "episode_return_min": 6440.567247974463, "episode_return_mean": 17696.209863268898}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 555.0177547486952, "num_env_steps_trained_throughput_per_sec": 555.0177547486952, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 2340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2340000, "timers": {"training_iteration_time_ms": 7444.484, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7444.45, "sample_time_ms": 780.441, "learn_time_ms": 6652.598, "learn_throughput": 601.269, "synch_weights_time_ms": 10.8}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "done": false, "training_iteration": 195, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-42", "timestamp": 1723236882, "time_this_iter_s": 7.211855888366699, "time_total_s": 1487.4268329143524, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1487.4268329143524, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 25.54, "ram_util_percent": 78.91}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 531.0608017068691, "cur_kl_coeff": 54718.24996517249, "cur_lr": 5.0000000000000016e-05, "total_loss": 11.687467288970947, "policy_loss": -0.0001674557213114683, "vf_loss": 9.737495115572813, "vf_explained_var": 0.03283537184750592, "kl": 3.563965638407608e-05, "entropy": 0.9041378368460943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9486586715094745, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.998608934879304, "policy_loss": -0.006659828048820297, "vf_loss": 10.0, "vf_explained_var": -6.691192587216695e-05, "kl": 0.009126546950816798, "entropy": 1.426443613320589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 22469.168803175267, "episode_reward_min": 6440.567247974463, "episode_reward_mean": 17628.58045782353, "episode_len_mean": 198.56, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19856, "policy_reward_min": {"agent_policy": 533.3923936347762, "adversary_policy": 636.2935212447055}, "policy_reward_max": {"agent_policy": 12937.991844149808, "adversary_policy": 9410.287354878454}, "policy_reward_mean": {"agent_policy": 9146.664691209098, "adversary_policy": 4240.9578833072155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18712.053614148543, 17166.006788719093, 18323.187612354293, 16582.727050359947, 17947.704352808425, 19769.35598219859, 22469.168803175267, 18039.05354932369, 18208.984258718072, 18334.671679684157, 18085.644128541942, 17891.508092942426, 18458.54625004079, 19172.62496876405, 6440.567247974463, 17574.341584601065, 17329.979835054957, 16694.384007969184, 14777.73312320415, 15985.471032950009, 18366.04631141362, 16534.881264457486, 19660.952880793153, 19699.10240969141, 15706.698483273958, 16338.646328424305, 18125.324241550563, 16127.818138918108, 19737.54712999056, 19769.939391848922, 21185.15536160246, 20162.73950341291, 18282.631041279026, 20085.576420336558, 20099.398269471378, 16701.624231981903, 16483.757520239098, 20115.8652464895, 18058.227642085272, 16356.902260749095, 19644.24869034957, 19803.32195024239, 16701.082544427856, 18162.426372702022, 16957.19571363129, 15236.546410673407, 15621.49588391727, 16766.039692657225, 15723.816294333374, 15805.860658808413, 17233.67197254038, 20489.08106961823, 18785.641079800855, 18974.83597159629, 18654.505207451963, 15952.016511021995, 15128.212550241724, 17685.345461709865, 17670.140153108787, 16978.022762343382, 17212.78289414227, 17480.1036197888, 18187.235020643217, 16837.267614161858, 17080.167188186075, 22443.540665390312, 16558.08133743568, 17936.604741497504, 20248.127131227928, 18782.921038511555, 17206.250874852733, 17656.94919150429, 16290.170740327054, 16444.71069559629, 18673.618996873123, 15852.34436577028, 15023.290656397287, 15801.39180755636, 15300.570956248155, 15949.430226404973, 18980.988842988587, 16939.891073444014, 15615.292438094362, 16985.738132558472, 18741.9259467391, 19237.301873635966, 16833.78653404177, 19255.043995062944, 17789.456388630875, 15955.677412352446, 15998.037468832776, 17484.47811744788, 18566.6651869194, 15923.332892078182, 19128.499404544476, 18430.718220571867, 18057.468259558475, 16399.99502951837, 20329.701579357265, 15702.432230740977], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 56, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [8407.774113466348, 9852.186329899498, 9702.87779706626, 9771.807515137101, 8486.550038081761, 6345.555466125517, 4078.2243007658026, 9384.219280087374, 9439.053886042357, 8181.636640743807, 9811.457344943758, 9108.518547367752, 8534.559909750753, 7737.902695909736, 533.3923936347762, 9291.520781781905, 9248.840963744035, 8359.022819806074, 12937.991844149808, 11589.312120221932, 8121.554500392033, 11412.164667643143, 7883.264916805136, 8141.349310443792, 8916.96446515968, 11514.102370561292, 8636.69730565381, 11247.408791738468, 5639.721292332731, 8229.08860644312, 5727.677924916606, 7807.78679606526, 9794.92429165812, 6669.12986346478, 7928.132263205466, 9626.728149606995, 10967.734316749407, 7866.892715766451, 9490.724159307394, 10136.299529223877, 7604.157618006463, 8097.543830722368, 11456.08630679198, 9465.7993325586, 8776.687287438102, 10093.831073651256, 12080.57560607464, 8563.688779809645, 10304.32416928135, 9616.437975710369, 10394.382974651437, 6960.736097741167, 7659.0734928497195, 8349.038605027527, 7417.385224299594, 9781.16591104786, 12711.65879331217, 8774.283601744395, 9009.669015432803, 9607.233260545154, 10273.528962993301, 10383.963600326879, 9038.344055640355, 10777.773480389387, 10027.367645711372, 4284.968972662647, 11434.731736363105, 8931.038528629535, 7038.354772450139, 9041.874990340964, 10612.128346433932, 8873.4656407033, 10423.876166296028, 9643.395758860052, 9023.590303579911, 9655.022063120114, 11805.73452279757, 11494.315440441927, 11582.433206875534, 8292.452626898132, 8014.780880502459, 10095.699403674798, 10056.842738356507, 9468.687063722584, 8170.59160688784, 8310.725039194424, 10032.366359331529, 8374.59223293743, 8947.07812994297, 11008.398641735426, 12004.924756675775, 10137.25247193395, 8647.367346451505, 9718.263802320558, 7362.06231136685, 8836.820866885819, 9058.777643598136, 11539.750003324307, 6927.81886898426, 12030.798149008106], "policy_adversary_policy_reward": [5733.39128166403, 4570.888219018193, 3282.9861016684567, 4030.8343571511386, 4402.803148192543, 4217.50666709552, 4370.3281085938415, 2440.591426628995, 5271.242159212993, 4189.912155513686, 5639.404359494343, 7784.396156578722, 8980.657147530983, 9410.287354878454, 3897.5870100808993, 4757.2472591554515, 4068.979438278037, 4700.950934397707, 5827.7211471887185, 4325.3138917515935, 3987.3608824529347, 4286.825901145276, 5033.617076363185, 3749.372469211478, 5257.128757154029, 4666.857583136054, 6233.94216827615, 5200.780104578158, 3294.219278873737, 2612.955575465946, 3432.9975971568324, 4849.823205662347, 4893.294659986904, 3187.8442113240035, 5783.112803924878, 2552.2483842382094, 1203.4477578096323, 636.2935212447055, 1845.6459993963174, 2550.5129133317514, 5444.411938754588, 4800.079872267012, 2716.616449483329, 2406.100147331018, 5834.722549020465, 5942.965414967559, 5833.696495398542, 5724.056603849057, 1564.5628595430428, 5225.171158571282, 2272.5087177980313, 2552.03524006501, 5505.43831807715, 3983.18861781961, 1985.6825151871856, 2894.7268319924915, 5595.41150625962, 8502.414331398226, 5882.897415377912, 5657.9533700279035, 8288.036021331309, 7169.441415354568, 6069.438325202511, 6285.514382145121, 4194.312491224366, 4293.394258396521, 5943.440796605627, 7473.005760266164, 5988.416688542589, 6182.8493177233295, 3431.0728136195494, 3643.8232687553764, 3170.6747908262746, 2345.3484126634335, 5973.729622758532, 6275.242907964501, 4217.292666782247, 4350.2108159956115, 3930.606239200795, 2289.9964923244156, 5616.119833632818, 6423.97123871028, 5759.961691043809, 5945.816428476222, 2639.8747564513287, 2605.1214811845266, 4035.030493138738, 4661.596547004745, 5365.448336292847, 2815.0600899003252, 4048.304550079698, 1094.4107869424765, 1917.6274533863482, 1623.2928244563298, 5578.44684392131, 2623.904068926272, 1581.6806706024288, 3837.8114544495934, 1663.725035077524, 4525.697648020566, 3553.891457702652, 3285.3975401862813, 7123.593909700207, 6404.75106217693, 6445.66095486972, 4680.906632081358, 4912.931765289967, 5712.865601278753, 6724.7503994313665, 4512.369583720982, 1809.8808872910429, 4360.969712683109, 986.0769265108333, 1430.4768304187578, 4816.649436327704, 4094.412423637731, 3999.2253241782123, 4661.245813497776, 4534.902363185795, 2835.88713861246, 3857.3956804536756, 3081.8582506952825, 3471.1888228773005, 3624.9511965845827, 5103.791568090593, 4045.099396912275, 3160.7439252132567, 2898.7502085591846, 4087.6753672098525, 2965.1241752648602, 8973.45805537146, 9185.11363735619, 2425.113386414527, 2698.2362146580463, 3939.3272854948323, 5066.238927373085, 6298.744213866214, 6911.028144911558, 4935.8290923673085, 4805.216955803267, 3311.8665927894704, 3282.2559356293664, 3515.043935954967, 5268.439614845983, 3718.259457434918, 2148.0351165960865, 2327.620397632942, 4473.694539103322, 5114.484626575028, 4535.544066718166, 4487.113560610845, 1710.2087420393195, 938.0464856431453, 2279.509647956615, 2647.820183289031, 1659.256183825436, 2559.702416855407, 1158.4353325172376, 1807.2946026740344, 5849.682996832819, 5602.087848881583, 5364.120113604603, 2797.755449713027, 4046.4362200561573, 4085.292885374451, 1473.1568143634117, 2889.412344569824, 4627.638724266065, 4601.7659300759615, 5969.568409775333, 5818.604020294812, 5107.972814146709, 4109.769264399426, 2691.650910310809, 5757.8306805016055, 5122.621081623876, 5089.8027907127935, 3752.575467975087, 3133.7369819955384, 1813.5417886215032, 2134.559096938337, 1858.553615218692, 3749.408690470041, 3597.8169550438847, 5373.302652384512, 4545.995188083367, 4423.8718214103965, 1781.1972683472604, 5159.681749506642, 6606.755343671022, 4731.658898170085, 4862.238455515938, 3931.3202009875677, 5067.370414972792, 2518.9715169703613, 2341.2735092237413, 7053.557991613719, 6348.324718759286, 1563.352528500749, 2108.2815532320574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3992228593534104, "mean_inference_ms": 0.9956379163590076, "mean_action_processing_ms": 0.16838321852458749, "mean_env_wait_ms": 0.05457786637625947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00332796573638916, "StateBufferConnector_ms": 0.0025458335876464844, "ViewRequirementAgentConnector_ms": 0.06619739532470703}, "num_episodes": 21, "episode_return_max": 22469.168803175267, "episode_return_min": 6440.567247974463, "episode_return_mean": 17628.58045782353}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.2334807715647, "num_env_steps_trained_throughput_per_sec": 540.2334807715647, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 7436.233, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7436.199, "sample_time_ms": 782.05, "learn_time_ms": 6642.448, "learn_throughput": 602.188, "synch_weights_time_ms": 11.114}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 196, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-49", "timestamp": 1723236889, "time_this_iter_s": 7.409042835235596, "time_total_s": 1494.835875749588, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c185e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1494.835875749588, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 25.209090909090904, "ram_util_percent": 78.84545454545453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 289.17591560706893, "cur_kl_coeff": 27359.124982586243, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.947113563900903, "policy_loss": -4.379021412835865e-05, "vf_loss": 9.694290320078531, "vf_explained_var": 0.036372594417087616, "kl": 4.579338824225401e-05, "entropy": 0.9004475496118031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9314612592260043, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994227693478267, "policy_loss": -0.0015932390146190301, "vf_loss": 9.990640477339428, "vf_explained_var": -9.517334401607514e-05, "kl": 0.008973554790039391, "entropy": 1.407551416878899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "env_runners": {"episode_reward_max": 22443.540665390312, "episode_reward_min": 543.3511455676493, "episode_reward_mean": 17300.29711055603, "episode_len_mean": 196.4, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 19640, "policy_reward_min": {"agent_policy": 12.430466645717583, "adversary_policy": 189.79775497437538}, "policy_reward_max": {"agent_policy": 12711.65879331217, "adversary_policy": 9185.11363735619}, "policy_reward_mean": {"agent_policy": 9232.384468939743, "adversary_policy": 4033.9563208081463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16534.881264457486, 19660.952880793153, 19699.10240969141, 15706.698483273958, 16338.646328424305, 18125.324241550563, 16127.818138918108, 19737.54712999056, 19769.939391848922, 21185.15536160246, 20162.73950341291, 18282.631041279026, 20085.576420336558, 20099.398269471378, 16701.624231981903, 16483.757520239098, 20115.8652464895, 18058.227642085272, 16356.902260749095, 19644.24869034957, 19803.32195024239, 16701.082544427856, 18162.426372702022, 16957.19571363129, 15236.546410673407, 15621.49588391727, 16766.039692657225, 15723.816294333374, 15805.860658808413, 17233.67197254038, 20489.08106961823, 18785.641079800855, 18974.83597159629, 18654.505207451963, 15952.016511021995, 15128.212550241724, 17685.345461709865, 17670.140153108787, 16978.022762343382, 17212.78289414227, 17480.1036197888, 18187.235020643217, 16837.267614161858, 17080.167188186075, 22443.540665390312, 16558.08133743568, 17936.604741497504, 20248.127131227928, 18782.921038511555, 17206.250874852733, 17656.94919150429, 16290.170740327054, 16444.71069559629, 18673.618996873123, 15852.34436577028, 15023.290656397287, 15801.39180755636, 15300.570956248155, 15949.430226404973, 18980.988842988587, 16939.891073444014, 15615.292438094362, 16985.738132558472, 18741.9259467391, 19237.301873635966, 16833.78653404177, 19255.043995062944, 17789.456388630875, 15955.677412352446, 15998.037468832776, 17484.47811744788, 18566.6651869194, 15923.332892078182, 19128.499404544476, 18430.718220571867, 18057.468259558475, 16399.99502951837, 20329.701579357265, 15702.432230740977, 16010.117278731695, 18135.56087004632, 18415.294319046996, 14773.81132089565, 18661.106109790333, 16008.337055799311, 543.3511455676493, 17798.621085325576, 15115.567169320851, 16450.354005395857, 19033.953100183986, 19445.176476877736, 17431.778094723522, 17234.627748942494, 16046.937932406025, 3596.293774779171, 17289.491775275335, 17693.08090637609, 19211.389835519396, 19580.808689645557, 15025.766853547751], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [11412.164667643143, 7883.264916805136, 8141.349310443792, 8916.96446515968, 11514.102370561292, 8636.69730565381, 11247.408791738468, 5639.721292332731, 8229.08860644312, 5727.677924916606, 7807.78679606526, 9794.92429165812, 6669.12986346478, 7928.132263205466, 9626.728149606995, 10967.734316749407, 7866.892715766451, 9490.724159307394, 10136.299529223877, 7604.157618006463, 8097.543830722368, 11456.08630679198, 9465.7993325586, 8776.687287438102, 10093.831073651256, 12080.57560607464, 8563.688779809645, 10304.32416928135, 9616.437975710369, 10394.382974651437, 6960.736097741167, 7659.0734928497195, 8349.038605027527, 7417.385224299594, 9781.16591104786, 12711.65879331217, 8774.283601744395, 9009.669015432803, 9607.233260545154, 10273.528962993301, 10383.963600326879, 9038.344055640355, 10777.773480389387, 10027.367645711372, 4284.968972662647, 11434.731736363105, 8931.038528629535, 7038.354772450139, 9041.874990340964, 10612.128346433932, 8873.4656407033, 10423.876166296028, 9643.395758860052, 9023.590303579911, 9655.022063120114, 11805.73452279757, 11494.315440441927, 11582.433206875534, 8292.452626898132, 8014.780880502459, 10095.699403674798, 10056.842738356507, 9468.687063722584, 8170.59160688784, 8310.725039194424, 10032.366359331529, 8374.59223293743, 8947.07812994297, 11008.398641735426, 12004.924756675775, 10137.25247193395, 8647.367346451505, 9718.263802320558, 7362.06231136685, 8836.820866885819, 9058.777643598136, 11539.750003324307, 6927.81886898426, 12030.798149008106, 11076.40389271225, 9948.166676552659, 9449.989597555938, 9675.668437172662, 9256.38905882463, 11104.80161689661, 12.430466645717583, 9835.468956086204, 12513.93233644828, 11149.124042532938, 7742.597058760789, 8337.391522154614, 10251.7072689658, 9775.938631425684, 9277.507099719507, 633.1537162160198, 9884.780647554262, 9731.63792714337, 8215.909071254935, 7810.000754808743, 11812.93828275112], "policy_adversary_policy_reward": [2716.616449483329, 2406.100147331018, 5834.722549020465, 5942.965414967559, 5833.696495398542, 5724.056603849057, 1564.5628595430428, 5225.171158571282, 2272.5087177980313, 2552.03524006501, 5505.43831807715, 3983.18861781961, 1985.6825151871856, 2894.7268319924915, 5595.41150625962, 8502.414331398226, 5882.897415377912, 5657.9533700279035, 8288.036021331309, 7169.441415354568, 6069.438325202511, 6285.514382145121, 4194.312491224366, 4293.394258396521, 5943.440796605627, 7473.005760266164, 5988.416688542589, 6182.8493177233295, 3431.0728136195494, 3643.8232687553764, 3170.6747908262746, 2345.3484126634335, 5973.729622758532, 6275.242907964501, 4217.292666782247, 4350.2108159956115, 3930.606239200795, 2289.9964923244156, 5616.119833632818, 6423.97123871028, 5759.961691043809, 5945.816428476222, 2639.8747564513287, 2605.1214811845266, 4035.030493138738, 4661.596547004745, 5365.448336292847, 2815.0600899003252, 4048.304550079698, 1094.4107869424765, 1917.6274533863482, 1623.2928244563298, 5578.44684392131, 2623.904068926272, 1581.6806706024288, 3837.8114544495934, 1663.725035077524, 4525.697648020566, 3553.891457702652, 3285.3975401862813, 7123.593909700207, 6404.75106217693, 6445.66095486972, 4680.906632081358, 4912.931765289967, 5712.865601278753, 6724.7503994313665, 4512.369583720982, 1809.8808872910429, 4360.969712683109, 986.0769265108333, 1430.4768304187578, 4816.649436327704, 4094.412423637731, 3999.2253241782123, 4661.245813497776, 4534.902363185795, 2835.88713861246, 3857.3956804536756, 3081.8582506952825, 3471.1888228773005, 3624.9511965845827, 5103.791568090593, 4045.099396912275, 3160.7439252132567, 2898.7502085591846, 4087.6753672098525, 2965.1241752648602, 8973.45805537146, 9185.11363735619, 2425.113386414527, 2698.2362146580463, 3939.3272854948323, 5066.238927373085, 6298.744213866214, 6911.028144911558, 4935.8290923673085, 4805.216955803267, 3311.8665927894704, 3282.2559356293664, 3515.043935954967, 5268.439614845983, 3718.259457434918, 2148.0351165960865, 2327.620397632942, 4473.694539103322, 5114.484626575028, 4535.544066718166, 4487.113560610845, 1710.2087420393195, 938.0464856431453, 2279.509647956615, 2647.820183289031, 1659.256183825436, 2559.702416855407, 1158.4353325172376, 1807.2946026740344, 5849.682996832819, 5602.087848881583, 5364.120113604603, 2797.755449713027, 4046.4362200561573, 4085.292885374451, 1473.1568143634117, 2889.412344569824, 4627.638724266065, 4601.7659300759615, 5969.568409775333, 5818.604020294812, 5107.972814146709, 4109.769264399426, 2691.650910310809, 5757.8306805016055, 5122.621081623876, 5089.8027907127935, 3752.575467975087, 3133.7369819955384, 1813.5417886215032, 2134.559096938337, 1858.553615218692, 3749.408690470041, 3597.8169550438847, 5373.302652384512, 4545.995188083367, 4423.8718214103965, 1781.1972683472604, 5159.681749506642, 6606.755343671022, 4731.658898170085, 4862.238455515938, 3931.3202009875677, 5067.370414972792, 2518.9715169703613, 2341.2735092237413, 7053.557991613719, 6348.324718759286, 1563.352528500749, 2108.2815532320574, 3065.7317310186813, 1867.9816550007515, 4101.836119097463, 4085.5580743961837, 4406.565165860456, 4558.739555630632, 631.6756971646737, 4466.467186558301, 4708.747805068355, 4695.969245897342, 1866.2014320683668, 3037.334006834372, 189.79775497437538, 341.12292394755616, 4305.655582137889, 3657.496547101527, 1628.2032872826362, 973.4315455899748, 2993.0115811980127, 2308.218381664919, 6351.431819797862, 4939.9242216253315, 5464.729823767453, 5643.055130955639, 3875.148434825576, 3304.9223909321245, 3154.0049996636994, 4304.684117853061, 1904.8023086750816, 4864.628524011447, 1121.4200406262548, 1841.720017936897, 3919.2007975722895, 3485.5103301487416, 4287.912191441246, 3673.530787791495, 5264.508623930383, 5730.972140334082, 5516.472646022474, 6254.335288814363, 883.6312298167936, 2329.1973409798256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991106834518343, "mean_inference_ms": 0.9954641178090874, "mean_action_processing_ms": 0.1683404200684861, "mean_env_wait_ms": 0.054560563742965716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003346085548400879, "StateBufferConnector_ms": 0.002475142478942871, "ViewRequirementAgentConnector_ms": 0.06557178497314453}, "num_episodes": 21, "episode_return_max": 22443.540665390312, "episode_return_min": 543.3511455676493, "episode_return_mean": 17300.29711055603}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.0869636235932, "num_env_steps_trained_throughput_per_sec": 548.0869636235932, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 2364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2364000, "timers": {"training_iteration_time_ms": 7380.765, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7380.729, "sample_time_ms": 763.206, "learn_time_ms": 6605.885, "learn_throughput": 605.521, "synch_weights_time_ms": 11.047}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "done": false, "training_iteration": 197, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-54-57", "timestamp": 1723236897, "time_this_iter_s": 7.303447961807251, "time_total_s": 1502.1393237113953, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1502.1393237113953, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 24.754545454545454, "ram_util_percent": 78.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.83374547024883, "cur_kl_coeff": 13679.562491293122, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.596972525056708, "policy_loss": 0.00011990522508750911, "vf_loss": 9.921786120076659, "vf_explained_var": 0.028752709349627217, "kl": 4.934854496241314e-05, "entropy": 0.8971820369914726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8491805968340487, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.004651141166686, "policy_loss": -0.0007019897559075617, "vf_loss": 9.997591730952262, "vf_explained_var": -2.952354649702708e-06, "kl": 0.01344429573606855, "entropy": 1.347018080453078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": 22443.540665390312, "episode_reward_min": 107.14752375646324, "episode_reward_mean": 17063.68562118999, "episode_len_mean": 194.41, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 19441, "policy_reward_min": {"agent_policy": 0.9467168269709265, "adversary_policy": 36.43684563780848}, "policy_reward_max": {"agent_policy": 12711.65879331217, "adversary_policy": 9185.11363735619}, "policy_reward_mean": {"agent_policy": 9236.509673920504, "adversary_policy": 3913.587973634745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19803.32195024239, 16701.082544427856, 18162.426372702022, 16957.19571363129, 15236.546410673407, 15621.49588391727, 16766.039692657225, 15723.816294333374, 15805.860658808413, 17233.67197254038, 20489.08106961823, 18785.641079800855, 18974.83597159629, 18654.505207451963, 15952.016511021995, 15128.212550241724, 17685.345461709865, 17670.140153108787, 16978.022762343382, 17212.78289414227, 17480.1036197888, 18187.235020643217, 16837.267614161858, 17080.167188186075, 22443.540665390312, 16558.08133743568, 17936.604741497504, 20248.127131227928, 18782.921038511555, 17206.250874852733, 17656.94919150429, 16290.170740327054, 16444.71069559629, 18673.618996873123, 15852.34436577028, 15023.290656397287, 15801.39180755636, 15300.570956248155, 15949.430226404973, 18980.988842988587, 16939.891073444014, 15615.292438094362, 16985.738132558472, 18741.9259467391, 19237.301873635966, 16833.78653404177, 19255.043995062944, 17789.456388630875, 15955.677412352446, 15998.037468832776, 17484.47811744788, 18566.6651869194, 15923.332892078182, 19128.499404544476, 18430.718220571867, 18057.468259558475, 16399.99502951837, 20329.701579357265, 15702.432230740977, 16010.117278731695, 18135.56087004632, 18415.294319046996, 14773.81132089565, 18661.106109790333, 16008.337055799311, 543.3511455676493, 17798.621085325576, 15115.567169320851, 16450.354005395857, 19033.953100183986, 19445.176476877736, 17431.778094723522, 17234.627748942494, 16046.937932406025, 3596.293774779171, 17289.491775275335, 17693.08090637609, 19211.389835519396, 19580.808689645557, 15025.766853547751, 18795.513919299257, 17689.4406100088, 18321.040449663345, 18347.113632624703, 18758.589448651397, 17971.166535577602, 18776.395524615466, 17935.478339355202, 18724.67699304504, 18318.52275852643, 18676.05888664805, 17096.50720872985, 17353.519184698434, 17775.3894929672, 17741.366753779523, 107.14752375646324, 18834.98808977888, 17770.475640925586, 17113.89902390297, 19108.597503787012], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200], "policy_agent_policy_reward": [8097.543830722368, 11456.08630679198, 9465.7993325586, 8776.687287438102, 10093.831073651256, 12080.57560607464, 8563.688779809645, 10304.32416928135, 9616.437975710369, 10394.382974651437, 6960.736097741167, 7659.0734928497195, 8349.038605027527, 7417.385224299594, 9781.16591104786, 12711.65879331217, 8774.283601744395, 9009.669015432803, 9607.233260545154, 10273.528962993301, 10383.963600326879, 9038.344055640355, 10777.773480389387, 10027.367645711372, 4284.968972662647, 11434.731736363105, 8931.038528629535, 7038.354772450139, 9041.874990340964, 10612.128346433932, 8873.4656407033, 10423.876166296028, 9643.395758860052, 9023.590303579911, 9655.022063120114, 11805.73452279757, 11494.315440441927, 11582.433206875534, 8292.452626898132, 8014.780880502459, 10095.699403674798, 10056.842738356507, 9468.687063722584, 8170.59160688784, 8310.725039194424, 10032.366359331529, 8374.59223293743, 8947.07812994297, 11008.398641735426, 12004.924756675775, 10137.25247193395, 8647.367346451505, 9718.263802320558, 7362.06231136685, 8836.820866885819, 9058.777643598136, 11539.750003324307, 6927.81886898426, 12030.798149008106, 11076.40389271225, 9948.166676552659, 9449.989597555938, 9675.668437172662, 9256.38905882463, 11104.80161689661, 12.430466645717583, 9835.468956086204, 12513.93233644828, 11149.124042532938, 7742.597058760789, 8337.391522154614, 10251.7072689658, 9775.938631425684, 9277.507099719507, 633.1537162160198, 9884.780647554262, 9731.63792714337, 8215.909071254935, 7810.000754808743, 11812.93828275112, 9064.848227218336, 9726.579852249612, 9019.828367157876, 8904.510234417781, 8796.840491281031, 9312.22521534342, 9165.602962054114, 9518.659714118668, 8083.237579455937, 8960.073006552659, 8846.508923227526, 10190.188243656376, 8880.372509337367, 10089.260857461715, 9948.775133791081, 0.9467168269709265, 8782.108818174805, 9665.68319538147, 10377.77024361884, 8319.449561502439], "policy_adversary_policy_reward": [5759.961691043809, 5945.816428476222, 2639.8747564513287, 2605.1214811845266, 4035.030493138738, 4661.596547004745, 5365.448336292847, 2815.0600899003252, 4048.304550079698, 1094.4107869424765, 1917.6274533863482, 1623.2928244563298, 5578.44684392131, 2623.904068926272, 1581.6806706024288, 3837.8114544495934, 1663.725035077524, 4525.697648020566, 3553.891457702652, 3285.3975401862813, 7123.593909700207, 6404.75106217693, 6445.66095486972, 4680.906632081358, 4912.931765289967, 5712.865601278753, 6724.7503994313665, 4512.369583720982, 1809.8808872910429, 4360.969712683109, 986.0769265108333, 1430.4768304187578, 4816.649436327704, 4094.412423637731, 3999.2253241782123, 4661.245813497776, 4534.902363185795, 2835.88713861246, 3857.3956804536756, 3081.8582506952825, 3471.1888228773005, 3624.9511965845827, 5103.791568090593, 4045.099396912275, 3160.7439252132567, 2898.7502085591846, 4087.6753672098525, 2965.1241752648602, 8973.45805537146, 9185.11363735619, 2425.113386414527, 2698.2362146580463, 3939.3272854948323, 5066.238927373085, 6298.744213866214, 6911.028144911558, 4935.8290923673085, 4805.216955803267, 3311.8665927894704, 3282.2559356293664, 3515.043935954967, 5268.439614845983, 3718.259457434918, 2148.0351165960865, 2327.620397632942, 4473.694539103322, 5114.484626575028, 4535.544066718166, 4487.113560610845, 1710.2087420393195, 938.0464856431453, 2279.509647956615, 2647.820183289031, 1659.256183825436, 2559.702416855407, 1158.4353325172376, 1807.2946026740344, 5849.682996832819, 5602.087848881583, 5364.120113604603, 2797.755449713027, 4046.4362200561573, 4085.292885374451, 1473.1568143634117, 2889.412344569824, 4627.638724266065, 4601.7659300759615, 5969.568409775333, 5818.604020294812, 5107.972814146709, 4109.769264399426, 2691.650910310809, 5757.8306805016055, 5122.621081623876, 5089.8027907127935, 3752.575467975087, 3133.7369819955384, 1813.5417886215032, 2134.559096938337, 1858.553615218692, 3749.408690470041, 3597.8169550438847, 5373.302652384512, 4545.995188083367, 4423.8718214103965, 1781.1972683472604, 5159.681749506642, 6606.755343671022, 4731.658898170085, 4862.238455515938, 3931.3202009875677, 5067.370414972792, 2518.9715169703613, 2341.2735092237413, 7053.557991613719, 6348.324718759286, 1563.352528500749, 2108.2815532320574, 3065.7317310186813, 1867.9816550007515, 4101.836119097463, 4085.5580743961837, 4406.565165860456, 4558.739555630632, 631.6756971646737, 4466.467186558301, 4708.747805068355, 4695.969245897342, 1866.2014320683668, 3037.334006834372, 189.79775497437538, 341.12292394755616, 4305.655582137889, 3657.496547101527, 1628.2032872826362, 973.4315455899748, 2993.0115811980127, 2308.218381664919, 6351.431819797862, 4939.9242216253315, 5464.729823767453, 5643.055130955639, 3875.148434825576, 3304.9223909321245, 3154.0049996636994, 4304.684117853061, 1904.8023086750816, 4864.628524011447, 1121.4200406262548, 1841.720017936897, 3919.2007975722895, 3485.5103301487416, 4287.912191441246, 3673.530787791495, 5264.508623930383, 5730.972140334082, 5516.472646022474, 6254.335288814363, 883.6312298167936, 2329.1973409798256, 4681.270641841311, 5049.395050239536, 4402.63353317936, 3560.2272245798426, 4220.383127046263, 5080.828955459233, 5237.196885299698, 4205.4065129072205, 4635.40400599714, 5326.344951373222, 4777.011818481383, 3881.929501752815, 4634.259900884556, 4976.532661676846, 3794.19947150574, 4622.619153730774, 4961.8029827239025, 5679.636430865205, 5065.63083282159, 4292.8189191522315, 5214.621345370442, 4614.9286180500985, 3951.9473800745836, 2954.371584998883, 3211.3835609674597, 5261.763114393596, 4051.6309773343237, 3634.4976581711794, 3771.1464919450887, 4021.4451280433614, 69.76396129168383, 36.43684563780848, 5004.373847437402, 5048.505424166639, 3968.6739353605617, 4136.118510183529, 2971.763400172003, 3764.3653801121027, 5306.436082710049, 5482.711859574522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3989709313201246, "mean_inference_ms": 0.995316481520901, "mean_action_processing_ms": 0.16827649800955943, "mean_env_wait_ms": 0.05454901271375578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003396272659301758, "StateBufferConnector_ms": 0.0025053024291992188, "ViewRequirementAgentConnector_ms": 0.06457173824310303}, "num_episodes": 20, "episode_return_max": 22443.540665390312, "episode_return_min": 107.14752375646324, "episode_return_mean": 17063.68562118999}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.4214192564529, "num_env_steps_trained_throughput_per_sec": 542.4214192564529, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 7379.49, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7379.454, "sample_time_ms": 764.104, "learn_time_ms": 6603.773, "learn_throughput": 605.714, "synch_weights_time_ms": 11.028}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 198, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-55-04", "timestamp": 1723236904, "time_this_iter_s": 7.378370046615601, "time_total_s": 1509.5176937580109, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322241ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1509.5176937580109, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 26.060000000000002, "ram_util_percent": 78.42999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.13697512086738, "cur_kl_coeff": 6839.781245646561, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.163723976397641, "policy_loss": -0.000292035355232656, "vf_loss": 9.803878081286395, "vf_explained_var": 0.018213136801643978, "kl": 5.265342726161372e-05, "entropy": 0.8943988456297173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8866515946264069, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.994181872407596, "policy_loss": -0.0058192004992937045, "vf_loss": 9.994078776240348, "vf_explained_var": 2.8778923054536185e-05, "kl": 0.010258557045987497, "entropy": 1.3150625236332416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "env_runners": {"episode_reward_max": 22443.540665390312, "episode_reward_min": 107.14752375646324, "episode_reward_mean": 16882.069800573707, "episode_len_mean": 192.49, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 19249, "policy_reward_min": {"agent_policy": 0.9467168269709265, "adversary_policy": 36.43684563780848}, "policy_reward_max": {"agent_policy": 12513.93233644828, "adversary_policy": 9185.11363735619}, "policy_reward_mean": {"agent_policy": 9224.15339541687, "adversary_policy": 3828.958202578417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17080.167188186075, 22443.540665390312, 16558.08133743568, 17936.604741497504, 20248.127131227928, 18782.921038511555, 17206.250874852733, 17656.94919150429, 16290.170740327054, 16444.71069559629, 18673.618996873123, 15852.34436577028, 15023.290656397287, 15801.39180755636, 15300.570956248155, 15949.430226404973, 18980.988842988587, 16939.891073444014, 15615.292438094362, 16985.738132558472, 18741.9259467391, 19237.301873635966, 16833.78653404177, 19255.043995062944, 17789.456388630875, 15955.677412352446, 15998.037468832776, 17484.47811744788, 18566.6651869194, 15923.332892078182, 19128.499404544476, 18430.718220571867, 18057.468259558475, 16399.99502951837, 20329.701579357265, 15702.432230740977, 16010.117278731695, 18135.56087004632, 18415.294319046996, 14773.81132089565, 18661.106109790333, 16008.337055799311, 543.3511455676493, 17798.621085325576, 15115.567169320851, 16450.354005395857, 19033.953100183986, 19445.176476877736, 17431.778094723522, 17234.627748942494, 16046.937932406025, 3596.293774779171, 17289.491775275335, 17693.08090637609, 19211.389835519396, 19580.808689645557, 15025.766853547751, 18795.513919299257, 17689.4406100088, 18321.040449663345, 18347.113632624703, 18758.589448651397, 17971.166535577602, 18776.395524615466, 17935.478339355202, 18724.67699304504, 18318.52275852643, 18676.05888664805, 17096.50720872985, 17353.519184698434, 17775.3894929672, 17741.366753779523, 107.14752375646324, 18834.98808977888, 17770.475640925586, 17113.89902390297, 19108.597503787012, 16486.52792461875, 17762.316983438373, 14707.39394291297, 15194.373965107616, 17349.63024568541, 17992.16255364772, 918.7028101833112, 19795.12044713466, 14407.448447776123, 18560.59342884119, 18681.861253544976, 18039.801367558215, 18199.317370498575, 19014.895231753362, 18908.20017868575, 16743.358105845517, 18326.219663395186, 15819.288531443493, 16041.97955970048, 17543.135161054393, 17648.06045840357, 15524.336494153793, 16220.341222550936], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [10027.367645711372, 4284.968972662647, 11434.731736363105, 8931.038528629535, 7038.354772450139, 9041.874990340964, 10612.128346433932, 8873.4656407033, 10423.876166296028, 9643.395758860052, 9023.590303579911, 9655.022063120114, 11805.73452279757, 11494.315440441927, 11582.433206875534, 8292.452626898132, 8014.780880502459, 10095.699403674798, 10056.842738356507, 9468.687063722584, 8170.59160688784, 8310.725039194424, 10032.366359331529, 8374.59223293743, 8947.07812994297, 11008.398641735426, 12004.924756675775, 10137.25247193395, 8647.367346451505, 9718.263802320558, 7362.06231136685, 8836.820866885819, 9058.777643598136, 11539.750003324307, 6927.81886898426, 12030.798149008106, 11076.40389271225, 9948.166676552659, 9449.989597555938, 9675.668437172662, 9256.38905882463, 11104.80161689661, 12.430466645717583, 9835.468956086204, 12513.93233644828, 11149.124042532938, 7742.597058760789, 8337.391522154614, 10251.7072689658, 9775.938631425684, 9277.507099719507, 633.1537162160198, 9884.780647554262, 9731.63792714337, 8215.909071254935, 7810.000754808743, 11812.93828275112, 9064.848227218336, 9726.579852249612, 9019.828367157876, 8904.510234417781, 8796.840491281031, 9312.22521534342, 9165.602962054114, 9518.659714118668, 8083.237579455937, 8960.073006552659, 8846.508923227526, 10190.188243656376, 8880.372509337367, 10089.260857461715, 9948.775133791081, 0.9467168269709265, 8782.108818174805, 9665.68319538147, 10377.77024361884, 8319.449561502439, 10086.403049719316, 10177.438983014892, 9921.018852733772, 12103.969120723412, 10118.213389568358, 10066.550137425036, 48.750586043049886, 8014.746407347173, 10010.066169837684, 9109.203914914491, 8620.18181103602, 9144.419800351412, 8394.639894215437, 8469.829596360878, 8927.253470702264, 11035.890901669029, 9370.3765058892, 9225.522546367863, 11028.976642687885, 9968.129709973324, 10512.815901976637, 12176.237900240258, 11826.948294879396], "policy_adversary_policy_reward": [4087.6753672098525, 2965.1241752648602, 8973.45805537146, 9185.11363735619, 2425.113386414527, 2698.2362146580463, 3939.3272854948323, 5066.238927373085, 6298.744213866214, 6911.028144911558, 4935.8290923673085, 4805.216955803267, 3311.8665927894704, 3282.2559356293664, 3515.043935954967, 5268.439614845983, 3718.259457434918, 2148.0351165960865, 2327.620397632942, 4473.694539103322, 5114.484626575028, 4535.544066718166, 4487.113560610845, 1710.2087420393195, 938.0464856431453, 2279.509647956615, 2647.820183289031, 1659.256183825436, 2559.702416855407, 1158.4353325172376, 1807.2946026740344, 5849.682996832819, 5602.087848881583, 5364.120113604603, 2797.755449713027, 4046.4362200561573, 4085.292885374451, 1473.1568143634117, 2889.412344569824, 4627.638724266065, 4601.7659300759615, 5969.568409775333, 5818.604020294812, 5107.972814146709, 4109.769264399426, 2691.650910310809, 5757.8306805016055, 5122.621081623876, 5089.8027907127935, 3752.575467975087, 3133.7369819955384, 1813.5417886215032, 2134.559096938337, 1858.553615218692, 3749.408690470041, 3597.8169550438847, 5373.302652384512, 4545.995188083367, 4423.8718214103965, 1781.1972683472604, 5159.681749506642, 6606.755343671022, 4731.658898170085, 4862.238455515938, 3931.3202009875677, 5067.370414972792, 2518.9715169703613, 2341.2735092237413, 7053.557991613719, 6348.324718759286, 1563.352528500749, 2108.2815532320574, 3065.7317310186813, 1867.9816550007515, 4101.836119097463, 4085.5580743961837, 4406.565165860456, 4558.739555630632, 631.6756971646737, 4466.467186558301, 4708.747805068355, 4695.969245897342, 1866.2014320683668, 3037.334006834372, 189.79775497437538, 341.12292394755616, 4305.655582137889, 3657.496547101527, 1628.2032872826362, 973.4315455899748, 2993.0115811980127, 2308.218381664919, 6351.431819797862, 4939.9242216253315, 5464.729823767453, 5643.055130955639, 3875.148434825576, 3304.9223909321245, 3154.0049996636994, 4304.684117853061, 1904.8023086750816, 4864.628524011447, 1121.4200406262548, 1841.720017936897, 3919.2007975722895, 3485.5103301487416, 4287.912191441246, 3673.530787791495, 5264.508623930383, 5730.972140334082, 5516.472646022474, 6254.335288814363, 883.6312298167936, 2329.1973409798256, 4681.270641841311, 5049.395050239536, 4402.63353317936, 3560.2272245798426, 4220.383127046263, 5080.828955459233, 5237.196885299698, 4205.4065129072205, 4635.40400599714, 5326.344951373222, 4777.011818481383, 3881.929501752815, 4634.259900884556, 4976.532661676846, 3794.19947150574, 4622.619153730774, 4961.8029827239025, 5679.636430865205, 5065.63083282159, 4292.8189191522315, 5214.621345370442, 4614.9286180500985, 3951.9473800745836, 2954.371584998883, 3211.3835609674597, 5261.763114393596, 4051.6309773343237, 3634.4976581711794, 3771.1464919450887, 4021.4451280433614, 69.76396129168383, 36.43684563780848, 5004.373847437402, 5048.505424166639, 3968.6739353605617, 4136.118510183529, 2971.763400172003, 3764.3653801121027, 5306.436082710049, 5482.711859574522, 2426.5425766825224, 3973.5822982169025, 3853.3478403775553, 3731.5301600459275, 565.2583191820219, 4221.1167709971905, 1052.2383413766129, 2038.1665030075442, 3868.1787506296046, 3363.2381054874204, 3859.311034564559, 4066.301381658084, 353.01738523407323, 516.9348389061881, 5658.553597296677, 6121.820442490782, 265.3128240451708, 4132.069453893279, 4838.682379112628, 4612.70713481408, 4663.732590025108, 5397.946852483835, 3964.8805301666803, 4930.501037040156, 4066.793381321699, 5737.884094961462, 5117.08218108192, 5427.983454310521, 4766.06455495484, 5214.882153028686, 2817.8255527189253, 2889.6416514575008, 4676.322169443874, 4279.520988062115, 4916.613077363086, 1677.152907712514, 2879.4211755545284, 2133.581741458059, 4172.037816389202, 3402.967634691837, 3624.5948972584943, 3510.649659168391, 1965.2409239121325, 1382.8576700014137, 2094.4897093030213, 2298.9032183684585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39885593319161955, "mean_inference_ms": 0.9949902279062134, "mean_action_processing_ms": 0.16820984811705794, "mean_env_wait_ms": 0.0545560794929357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003380894660949707, "StateBufferConnector_ms": 0.002488255500793457, "ViewRequirementAgentConnector_ms": 0.06499648094177246}, "num_episodes": 23, "episode_return_max": 22443.540665390312, "episode_return_min": 107.14752375646324, "episode_return_mean": 16882.069800573707}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.684698493618, "num_env_steps_trained_throughput_per_sec": 539.684698493618, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 2388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2388000, "timers": {"training_iteration_time_ms": 7399.285, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7399.249, "sample_time_ms": 765.299, "learn_time_ms": 6622.01, "learn_throughput": 604.046, "synch_weights_time_ms": 11.392}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "done": false, "training_iteration": 199, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-55-12", "timestamp": 1723236912, "time_this_iter_s": 7.41684889793396, "time_total_s": 1516.9345426559448, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1516.9345426559448, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 25.62727272727273, "ram_util_percent": 78.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.657061037436996, "cur_kl_coeff": 3419.8906228232804, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.249652760621732, "policy_loss": 0.0003744430756245656, "vf_loss": 10.0, "vf_explained_var": -0.00448057698825049, "kl": 7.289072205562012e-05, "entropy": 0.8900942132271156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.865045749489218, "cur_kl_coeff": 0.5773015156388281, "cur_lr": 5.0000000000000016e-05, "total_loss": 10.006783718864122, "policy_loss": 0.0038261372389873332, "vf_loss": 9.989622874061267, "vf_explained_var": -1.592803746461868e-05, "kl": 0.023098379112586068, "entropy": 1.3141926822563013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 20478.287063642376, "episode_reward_min": 107.14752375646324, "episode_reward_mean": 16813.197702741858, "episode_len_mean": 188.87, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 18887, "policy_reward_min": {"agent_policy": 0.9467168269709265, "adversary_policy": 36.43684563780848}, "policy_reward_max": {"agent_policy": 12513.93233644828, "adversary_policy": 7053.557991613719}, "policy_reward_mean": {"agent_policy": 8895.987168428836, "adversary_policy": 3958.6052671565126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16833.78653404177, 19255.043995062944, 17789.456388630875, 15955.677412352446, 15998.037468832776, 17484.47811744788, 18566.6651869194, 15923.332892078182, 19128.499404544476, 18430.718220571867, 18057.468259558475, 16399.99502951837, 20329.701579357265, 15702.432230740977, 16010.117278731695, 18135.56087004632, 18415.294319046996, 14773.81132089565, 18661.106109790333, 16008.337055799311, 543.3511455676493, 17798.621085325576, 15115.567169320851, 16450.354005395857, 19033.953100183986, 19445.176476877736, 17431.778094723522, 17234.627748942494, 16046.937932406025, 3596.293774779171, 17289.491775275335, 17693.08090637609, 19211.389835519396, 19580.808689645557, 15025.766853547751, 18795.513919299257, 17689.4406100088, 18321.040449663345, 18347.113632624703, 18758.589448651397, 17971.166535577602, 18776.395524615466, 17935.478339355202, 18724.67699304504, 18318.52275852643, 18676.05888664805, 17096.50720872985, 17353.519184698434, 17775.3894929672, 17741.366753779523, 107.14752375646324, 18834.98808977888, 17770.475640925586, 17113.89902390297, 19108.597503787012, 16486.52792461875, 17762.316983438373, 14707.39394291297, 15194.373965107616, 17349.63024568541, 17992.16255364772, 918.7028101833112, 19795.12044713466, 14407.448447776123, 18560.59342884119, 18681.861253544976, 18039.801367558215, 18199.317370498575, 19014.895231753362, 18908.20017868575, 16743.358105845517, 18326.219663395186, 15819.288531443493, 16041.97955970048, 17543.135161054393, 17648.06045840357, 15524.336494153793, 16220.341222550936, 18994.568294378467, 18467.770697536303, 19286.337521978283, 18898.42727856494, 20478.287063642376, 18509.120533120302, 18318.767003393277, 19170.691925394156, 1324.6488421382946, 19714.514923540195, 17296.584360157813, 18231.04858549185, 18123.78482827392, 19146.327226008918, 2608.767868528214, 18295.36914857564, 18978.560740580273, 17826.200940215487, 19374.420535965903, 16882.99594012943, 17715.46668867862, 19219.43819176266], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 5, 200, 200, 200, 200, 200, 200, 200, 200, 35, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 1, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 8, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 11, 200, 200, 200, 200, 200, 27, 200, 200, 200, 200, 200, 200, 200], "policy_agent_policy_reward": [10032.366359331529, 8374.59223293743, 8947.07812994297, 11008.398641735426, 12004.924756675775, 10137.25247193395, 8647.367346451505, 9718.263802320558, 7362.06231136685, 8836.820866885819, 9058.777643598136, 11539.750003324307, 6927.81886898426, 12030.798149008106, 11076.40389271225, 9948.166676552659, 9449.989597555938, 9675.668437172662, 9256.38905882463, 11104.80161689661, 12.430466645717583, 9835.468956086204, 12513.93233644828, 11149.124042532938, 7742.597058760789, 8337.391522154614, 10251.7072689658, 9775.938631425684, 9277.507099719507, 633.1537162160198, 9884.780647554262, 9731.63792714337, 8215.909071254935, 7810.000754808743, 11812.93828275112, 9064.848227218336, 9726.579852249612, 9019.828367157876, 8904.510234417781, 8796.840491281031, 9312.22521534342, 9165.602962054114, 9518.659714118668, 8083.237579455937, 8960.073006552659, 8846.508923227526, 10190.188243656376, 8880.372509337367, 10089.260857461715, 9948.775133791081, 0.9467168269709265, 8782.108818174805, 9665.68319538147, 10377.77024361884, 8319.449561502439, 10086.403049719316, 10177.438983014892, 9921.018852733772, 12103.969120723412, 10118.213389568358, 10066.550137425036, 48.750586043049886, 8014.746407347173, 10010.066169837684, 9109.203914914491, 8620.18181103602, 9144.419800351412, 8394.639894215437, 8469.829596360878, 8927.253470702264, 11035.890901669029, 9370.3765058892, 9225.522546367863, 11028.976642687885, 9968.129709973324, 10512.815901976637, 12176.237900240258, 11826.948294879396, 8233.349868840227, 9287.232517375915, 8333.048045949745, 8096.291860629267, 7285.1530290934115, 8253.003450870516, 8999.564907125816, 8312.204154141617, 50.708054676685805, 8212.2991802206, 8725.473486321875, 8972.654451881266, 9360.094013446935, 8592.565133588794, 461.4327226383094, 8705.984897747016, 8814.51756553343, 9437.372294242688, 7865.567415915148, 9646.248609061995, 9249.853025963406, 8570.836070434656], "policy_adversary_policy_reward": [4109.769264399426, 2691.650910310809, 5757.8306805016055, 5122.621081623876, 5089.8027907127935, 3752.575467975087, 3133.7369819955384, 1813.5417886215032, 2134.559096938337, 1858.553615218692, 3749.408690470041, 3597.8169550438847, 5373.302652384512, 4545.995188083367, 4423.8718214103965, 1781.1972683472604, 5159.681749506642, 6606.755343671022, 4731.658898170085, 4862.238455515938, 3931.3202009875677, 5067.370414972792, 2518.9715169703613, 2341.2735092237413, 7053.557991613719, 6348.324718759286, 1563.352528500749, 2108.2815532320574, 3065.7317310186813, 1867.9816550007515, 4101.836119097463, 4085.5580743961837, 4406.565165860456, 4558.739555630632, 631.6756971646737, 4466.467186558301, 4708.747805068355, 4695.969245897342, 1866.2014320683668, 3037.334006834372, 189.79775497437538, 341.12292394755616, 4305.655582137889, 3657.496547101527, 1628.2032872826362, 973.4315455899748, 2993.0115811980127, 2308.218381664919, 6351.431819797862, 4939.9242216253315, 5464.729823767453, 5643.055130955639, 3875.148434825576, 3304.9223909321245, 3154.0049996636994, 4304.684117853061, 1904.8023086750816, 4864.628524011447, 1121.4200406262548, 1841.720017936897, 3919.2007975722895, 3485.5103301487416, 4287.912191441246, 3673.530787791495, 5264.508623930383, 5730.972140334082, 5516.472646022474, 6254.335288814363, 883.6312298167936, 2329.1973409798256, 4681.270641841311, 5049.395050239536, 4402.63353317936, 3560.2272245798426, 4220.383127046263, 5080.828955459233, 5237.196885299698, 4205.4065129072205, 4635.40400599714, 5326.344951373222, 4777.011818481383, 3881.929501752815, 4634.259900884556, 4976.532661676846, 3794.19947150574, 4622.619153730774, 4961.8029827239025, 5679.636430865205, 5065.63083282159, 4292.8189191522315, 5214.621345370442, 4614.9286180500985, 3951.9473800745836, 2954.371584998883, 3211.3835609674597, 5261.763114393596, 4051.6309773343237, 3634.4976581711794, 3771.1464919450887, 4021.4451280433614, 69.76396129168383, 36.43684563780848, 5004.373847437402, 5048.505424166639, 3968.6739353605617, 4136.118510183529, 2971.763400172003, 3764.3653801121027, 5306.436082710049, 5482.711859574522, 2426.5425766825224, 3973.5822982169025, 3853.3478403775553, 3731.5301600459275, 565.2583191820219, 4221.1167709971905, 1052.2383413766129, 2038.1665030075442, 3868.1787506296046, 3363.2381054874204, 3859.311034564559, 4066.301381658084, 353.01738523407323, 516.9348389061881, 5658.553597296677, 6121.820442490782, 265.3128240451708, 4132.069453893279, 4838.682379112628, 4612.70713481408, 4663.732590025108, 5397.946852483835, 3964.8805301666803, 4930.501037040156, 4066.793381321699, 5737.884094961462, 5117.08218108192, 5427.983454310521, 4766.06455495484, 5214.882153028686, 2817.8255527189253, 2889.6416514575008, 4676.322169443874, 4279.520988062115, 4916.613077363086, 1677.152907712514, 2879.4211755545284, 2133.581741458059, 4172.037816389202, 3402.967634691837, 3624.5948972584943, 3510.649659168391, 1965.2409239121325, 1382.8576700014137, 2094.4897093030213, 2298.9032183684585, 5883.849583022694, 4877.368842515603, 4392.516487391594, 4788.021692768836, 5210.825031882511, 5742.464444146058, 5854.789347261993, 4947.346070673665, 6508.832474576717, 6684.301559972175, 5835.691667833046, 4420.425414416754, 5142.57071660514, 4176.6313796623, 5028.556301663282, 5829.931469589325, 546.8313828330924, 727.1094046285165, 5572.379299809323, 5929.836443510341, 5416.662137409085, 3154.4487364268407, 4100.741902536824, 5157.652231073769, 3985.7038449941024, 4777.986969832923, 5467.053237698959, 5086.708854721153, 699.5795593245348, 1447.755586565369, 4154.278164285522, 5435.10608654312, 5310.076330027239, 4853.966845019739, 4646.381835021914, 3742.4468109508916, 5233.58313710595, 6275.269982944798, 2740.860316398535, 4495.887014668973, 4892.28259776753, 3573.331064947628, 5534.880754653946, 5113.721366674049]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3987225608408131, "mean_inference_ms": 0.9945065989881889, "mean_action_processing_ms": 0.168143935202473, "mean_env_wait_ms": 0.054500024818527726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033246278762817383, "StateBufferConnector_ms": 0.0024917125701904297, "ViewRequirementAgentConnector_ms": 0.06433045864105225}, "num_episodes": 22, "episode_return_max": 20478.287063642376, "episode_return_min": 107.14752375646324, "episode_return_mean": 16813.197702741858}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.2570337792916, "num_env_steps_trained_throughput_per_sec": 539.2570337792916, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 7411.913, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7411.876, "sample_time_ms": 763.737, "learn_time_ms": 6636.456, "learn_throughput": 602.731, "synch_weights_time_ms": 11.137}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": true, "training_iteration": 200, "trial_id": "0b9b4_00000", "date": "2024-08-09_16-55-20", "timestamp": 1723236920, "time_this_iter_s": 7.421969890594482, "time_total_s": 1524.3565125465393, "pid": 88263, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 50.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1524.3565125465393, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 29.745454545454546, "ram_util_percent": 78.63636363636364}}
